{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 4.434815883636475, "policy_loss": -0.01652781292796135, "vf_loss": 4.448220252990723, "vf_explained_var": 0.22735604643821716, "kl": 0.015618609264492989, "entropy": 1.0830830335617065, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 18.584666666666664, "episode_reward_min": 6.359, "episode_reward_mean": 8.868766025641024, "episode_len_mean": 18.923076923076923, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.361000000000001, 7.3453333333333335, 8.399999999999999, 7.948999999999999, 7.702666666666666, 7.361000000000001, 11.100999999999997, 6.891666666666666, 9.83233333333333, 10.36133333333333, 9.258, 12.001999999999999, 7.045999999999999, 7.429666666666666, 9.748000000000001, 6.888333333333333, 8.310333333333334, 11.597333333333331, 8.111333333333333, 10.37833333333333, 8.188666666666668, 13.738333333333332, 12.39433333333333, 7.444333333333332, 7.911333333333332, 9.156666666666666, 8.11533333333333, 6.545999999999999, 7.399333333333331, 8.273333333333333, 9.578666666666667, 9.996333333333336, 8.78233333333333, 9.287333333333331, 9.094666666666665, 9.222999999999999, 6.901666666666666, 8.803999999999998, 8.445999999999998, 12.010666666666665, 8.156, 8.372333333333332, 7.9479999999999995, 7.091999999999999, 7.388666666666666, 10.191666666666663, 8.466999999999999, 7.152333333333333, 9.788666666666664, 10.791999999999998, 6.892333333333331, 9.976666666666668, 7.567333333333332, 8.915, 10.368666666666664, 12.888666666666666, 9.590333333333332, 7.247666666666666, 7.491666666666666, 8.987333333333332, 11.351333333333333, 9.945999999999998, 12.20966666666666, 7.218999999999999, 7.117333333333331, 7.710333333333331, 8.123333333333331, 9.632, 7.009999999999999, 9.860666666666663, 9.372666666666666, 7.721, 9.090000000000003, 9.741999999999997, 9.266999999999998, 7.417999999999999, 8.107999999999997, 10.042666666666664, 7.936999999999998, 9.570666666666664, 7.363333333333332, 7.262666666666664, 9.555, 11.683, 9.159333333333334, 9.431333333333328, 7.732333333333331, 8.726999999999999, 8.452666666666666, 8.347666666666665, 6.374333333333331, 8.335333333333333, 8.544666666666664, 6.923333333333334, 7.652333333333332, 14.639333333333331, 7.747666666666665, 9.465666666666666, 8.396666666666665, 7.829333333333331, 8.636666666666665, 10.133333333333331, 7.836333333333331, 7.564333333333332, 9.434999999999999, 8.107666666666667, 8.853666666666665, 8.201999999999998, 8.553333333333331, 8.951333333333334, 8.269666666666666, 9.632666666666662, 10.525000000000004, 7.803333333333331, 7.237666666666665, 8.337, 9.104333333333336, 6.944666666666666, 8.039333333333332, 8.730666666666664, 6.764333333333332, 9.426999999999998, 8.356666666666664, 7.784666666666668, 9.186333333333332, 8.260999999999997, 9.94033333333333, 8.707666666666666, 6.359, 7.551333333333333, 11.379333333333335, 7.471333333333334, 8.68933333333333, 9.320666666666662, 18.584666666666664, 9.654999999999996, 9.153333333333334, 8.199333333333334, 7.188333333333331, 8.913666666666668, 7.788666666666665, 7.382, 6.826333333333333, 10.987999999999996, 8.19933333333333, 9.650666666666666, 7.8999999999999995, 10.851666666666665, 6.7143333333333315, 8.622333333333332, 8.198666666666666, 8.087666666666665, 10.09533333333333, 8.449666666666666, 10.047666666666663, 9.470333333333333, 8.719333333333333, 10.78233333333333, 9.857666666666667, 9.444666666666667, 8.442, 10.350333333333335, 8.747333333333334, 9.251666666666665, 6.609333333333332, 9.461999999999998, 11.288666666666668, 15.958999999999994, 7.190333333333333, 7.002666666666666, 9.160333333333332, 7.828666666666666, 11.232666666666667, 7.287666666666665, 12.798666666666668, 7.052666666666666, 9.589333333333329, 6.9593333333333325, 9.931333333333331, 11.849666666666664, 7.058999999999998, 9.479, 8.549666666666667, 7.2346666666666675, 8.08, 9.221333333333332, 8.955666666666666, 10.855333333333329, 8.304000000000002, 8.297333333333334, 8.147999999999998, 8.405333333333333, 7.603333333333333, 8.952, 12.047666666666668, 10.585333333333333, 7.823333333333332, 9.709333333333332, 8.618333333333329, 8.858666666666666, 10.268999999999997, 7.021333333333332, 7.505333333333333, 7.283333333333333, 8.048333333333332, 7.767999999999999, 8.175333333333333, 10.270666666666664], "episode_lengths": [16, 16, 17, 15, 16, 16, 24, 15, 21, 21, 20, 23, 18, 16, 19, 17, 17, 26, 16, 23, 17, 30, 25, 15, 20, 20, 20, 14, 16, 18, 19, 21, 18, 20, 18, 19, 15, 21, 17, 27, 18, 19, 17, 15, 16, 21, 19, 19, 21, 23, 15, 22, 16, 17, 20, 27, 23, 15, 19, 18, 24, 21, 25, 17, 16, 15, 17, 20, 15, 21, 19, 15, 19, 20, 21, 17, 21, 20, 18, 19, 17, 16, 19, 22, 18, 20, 15, 18, 20, 19, 14, 17, 17, 15, 18, 32, 15, 18, 21, 18, 21, 21, 17, 16, 20, 17, 19, 18, 17, 21, 18, 20, 20, 18, 16, 18, 20, 15, 17, 17, 15, 18, 21, 19, 17, 20, 19, 19, 15, 15, 24, 18, 20, 20, 33, 20, 20, 18, 15, 18, 16, 17, 18, 22, 18, 19, 18, 24, 15, 19, 17, 17, 21, 17, 21, 20, 17, 22, 20, 20, 18, 24, 20, 18, 16, 21, 23, 28, 17, 15, 19, 16, 21, 16, 24, 17, 20, 16, 21, 22, 16, 23, 20, 17, 18, 19, 19, 22, 19, 18, 17, 19, 17, 20, 23, 20, 16, 21, 18, 18, 23, 16, 16, 16, 17, 18, 17, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.578795792281119, "mean_inference_ms": 2.9077471486826023, "mean_action_processing_ms": 0.5848496679228126, "mean_env_wait_ms": 0.13637935774076426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021453087146465596, "StateBufferConnector_ms": 0.018016650126530573, "ViewRequirementAgentConnector_ms": 0.48274810497577375}}, "episode_reward_max": 18.584666666666664, "episode_reward_min": 6.359, "episode_reward_mean": 8.868766025641024, "episode_len_mean": 18.923076923076923, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.361000000000001, 7.3453333333333335, 8.399999999999999, 7.948999999999999, 7.702666666666666, 7.361000000000001, 11.100999999999997, 6.891666666666666, 9.83233333333333, 10.36133333333333, 9.258, 12.001999999999999, 7.045999999999999, 7.429666666666666, 9.748000000000001, 6.888333333333333, 8.310333333333334, 11.597333333333331, 8.111333333333333, 10.37833333333333, 8.188666666666668, 13.738333333333332, 12.39433333333333, 7.444333333333332, 7.911333333333332, 9.156666666666666, 8.11533333333333, 6.545999999999999, 7.399333333333331, 8.273333333333333, 9.578666666666667, 9.996333333333336, 8.78233333333333, 9.287333333333331, 9.094666666666665, 9.222999999999999, 6.901666666666666, 8.803999999999998, 8.445999999999998, 12.010666666666665, 8.156, 8.372333333333332, 7.9479999999999995, 7.091999999999999, 7.388666666666666, 10.191666666666663, 8.466999999999999, 7.152333333333333, 9.788666666666664, 10.791999999999998, 6.892333333333331, 9.976666666666668, 7.567333333333332, 8.915, 10.368666666666664, 12.888666666666666, 9.590333333333332, 7.247666666666666, 7.491666666666666, 8.987333333333332, 11.351333333333333, 9.945999999999998, 12.20966666666666, 7.218999999999999, 7.117333333333331, 7.710333333333331, 8.123333333333331, 9.632, 7.009999999999999, 9.860666666666663, 9.372666666666666, 7.721, 9.090000000000003, 9.741999999999997, 9.266999999999998, 7.417999999999999, 8.107999999999997, 10.042666666666664, 7.936999999999998, 9.570666666666664, 7.363333333333332, 7.262666666666664, 9.555, 11.683, 9.159333333333334, 9.431333333333328, 7.732333333333331, 8.726999999999999, 8.452666666666666, 8.347666666666665, 6.374333333333331, 8.335333333333333, 8.544666666666664, 6.923333333333334, 7.652333333333332, 14.639333333333331, 7.747666666666665, 9.465666666666666, 8.396666666666665, 7.829333333333331, 8.636666666666665, 10.133333333333331, 7.836333333333331, 7.564333333333332, 9.434999999999999, 8.107666666666667, 8.853666666666665, 8.201999999999998, 8.553333333333331, 8.951333333333334, 8.269666666666666, 9.632666666666662, 10.525000000000004, 7.803333333333331, 7.237666666666665, 8.337, 9.104333333333336, 6.944666666666666, 8.039333333333332, 8.730666666666664, 6.764333333333332, 9.426999999999998, 8.356666666666664, 7.784666666666668, 9.186333333333332, 8.260999999999997, 9.94033333333333, 8.707666666666666, 6.359, 7.551333333333333, 11.379333333333335, 7.471333333333334, 8.68933333333333, 9.320666666666662, 18.584666666666664, 9.654999999999996, 9.153333333333334, 8.199333333333334, 7.188333333333331, 8.913666666666668, 7.788666666666665, 7.382, 6.826333333333333, 10.987999999999996, 8.19933333333333, 9.650666666666666, 7.8999999999999995, 10.851666666666665, 6.7143333333333315, 8.622333333333332, 8.198666666666666, 8.087666666666665, 10.09533333333333, 8.449666666666666, 10.047666666666663, 9.470333333333333, 8.719333333333333, 10.78233333333333, 9.857666666666667, 9.444666666666667, 8.442, 10.350333333333335, 8.747333333333334, 9.251666666666665, 6.609333333333332, 9.461999999999998, 11.288666666666668, 15.958999999999994, 7.190333333333333, 7.002666666666666, 9.160333333333332, 7.828666666666666, 11.232666666666667, 7.287666666666665, 12.798666666666668, 7.052666666666666, 9.589333333333329, 6.9593333333333325, 9.931333333333331, 11.849666666666664, 7.058999999999998, 9.479, 8.549666666666667, 7.2346666666666675, 8.08, 9.221333333333332, 8.955666666666666, 10.855333333333329, 8.304000000000002, 8.297333333333334, 8.147999999999998, 8.405333333333333, 7.603333333333333, 8.952, 12.047666666666668, 10.585333333333333, 7.823333333333332, 9.709333333333332, 8.618333333333329, 8.858666666666666, 10.268999999999997, 7.021333333333332, 7.505333333333333, 7.283333333333333, 8.048333333333332, 7.767999999999999, 8.175333333333333, 10.270666666666664], "episode_lengths": [16, 16, 17, 15, 16, 16, 24, 15, 21, 21, 20, 23, 18, 16, 19, 17, 17, 26, 16, 23, 17, 30, 25, 15, 20, 20, 20, 14, 16, 18, 19, 21, 18, 20, 18, 19, 15, 21, 17, 27, 18, 19, 17, 15, 16, 21, 19, 19, 21, 23, 15, 22, 16, 17, 20, 27, 23, 15, 19, 18, 24, 21, 25, 17, 16, 15, 17, 20, 15, 21, 19, 15, 19, 20, 21, 17, 21, 20, 18, 19, 17, 16, 19, 22, 18, 20, 15, 18, 20, 19, 14, 17, 17, 15, 18, 32, 15, 18, 21, 18, 21, 21, 17, 16, 20, 17, 19, 18, 17, 21, 18, 20, 20, 18, 16, 18, 20, 15, 17, 17, 15, 18, 21, 19, 17, 20, 19, 19, 15, 15, 24, 18, 20, 20, 33, 20, 20, 18, 15, 18, 16, 17, 18, 22, 18, 19, 18, 24, 15, 19, 17, 17, 21, 17, 21, 20, 17, 22, 20, 20, 18, 24, 20, 18, 16, 21, 23, 28, 17, 15, 19, 16, 21, 16, 24, 17, 20, 16, 21, 22, 16, 23, 20, 17, 18, 19, 19, 22, 19, 18, 17, 19, 17, 20, 23, 20, 16, 21, 18, 18, 23, 16, 16, 16, 17, 18, 17, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.578795792281119, "mean_inference_ms": 2.9077471486826023, "mean_action_processing_ms": 0.5848496679228126, "mean_env_wait_ms": 0.13637935774076426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021453087146465596, "StateBufferConnector_ms": 0.018016650126530573, "ViewRequirementAgentConnector_ms": 0.48274810497577375}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.37843352461687, "num_env_steps_trained_throughput_per_sec": 439.37843352461687, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9102.754, "sample_time_ms": 3063.103, "load_time_ms": 1.0, "load_throughput": 3998383.222, "learn_time_ms": 5994.648, "learn_throughput": 667.262, "synch_weights_time_ms": 36.005}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 208, "training_iteration": 1, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-45-47", "timestamp": 1701996347, "time_this_iter_s": 9.148762464523315, "time_total_s": 9.148762464523315, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.148762464523315, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 70.75384615384615, "ram_util_percent": 96.73076923076921}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7657123804092407, "policy_loss": -0.025601737201213837, "vf_loss": 1.7862335443496704, "vf_explained_var": 0.7586687207221985, "kl": 0.025402680039405823, "entropy": 1.016796350479126, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 14.66499999999999, "episode_reward_min": 6.4736666666666665, "episode_reward_mean": 9.589027491408933, "episode_len_mean": 20.314432989690722, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.389999999999997, 11.281666666666665, 7.2219999999999995, 9.937333333333335, 7.978, 8.260666666666665, 7.369999999999998, 8.092999999999996, 14.07466666666666, 7.333666666666666, 11.84333333333333, 8.947000000000001, 13.829333333333336, 11.678333333333336, 8.096666666666666, 12.754, 7.527999999999999, 10.202666666666666, 8.662666666666665, 8.136333333333333, 11.09733333333333, 8.084666666666665, 12.134333333333334, 14.256666666666668, 7.0006666666666675, 10.085999999999999, 8.118333333333334, 9.898, 11.160333333333329, 9.464666666666666, 6.985999999999998, 10.022999999999998, 7.012333333333334, 9.923666666666666, 7.665666666666666, 10.514666666666669, 8.66833333333333, 9.099666666666668, 14.52566666666666, 11.587999999999997, 9.121000000000002, 8.588666666666667, 12.190999999999995, 9.513666666666667, 11.033666666666665, 9.220333333333333, 10.026666666666666, 9.757999999999996, 12.002333333333329, 8.316333333333334, 7.582666666666666, 9.94733333333333, 10.827, 8.754666666666665, 9.911999999999997, 10.469999999999995, 12.377999999999998, 12.983, 9.838333333333333, 9.917333333333332, 8.038666666666662, 9.089666666666663, 8.250666666666664, 9.823666666666663, 10.801666666666666, 10.569666666666665, 8.249333333333333, 7.598333333333332, 8.929999999999998, 11.548333333333332, 6.497333333333332, 8.461999999999998, 10.162666666666667, 8.346333333333332, 11.526999999999996, 10.493666666666664, 7.966666666666669, 9.307666666666666, 9.148333333333332, 8.399333333333333, 10.530666666666669, 7.8053333333333335, 13.958999999999996, 7.621333333333331, 10.520666666666665, 7.793999999999999, 7.7059999999999995, 7.930666666666665, 14.42533333333333, 8.767999999999997, 9.416666666666664, 9.472666666666667, 6.4736666666666665, 7.166666666666664, 9.939666666666668, 11.088333333333335, 8.874666666666666, 10.285999999999996, 8.47433333333333, 10.242666666666668, 9.963999999999999, 7.7843333333333335, 8.011333333333331, 10.342, 12.194666666666665, 10.253333333333332, 8.66433333333333, 6.9433333333333325, 11.723333333333327, 9.657333333333332, 8.240666666666664, 7.603666666666666, 10.064333333333327, 10.063999999999998, 12.100000000000001, 7.590666666666666, 8.363999999999999, 10.792333333333335, 12.425666666666661, 8.709999999999997, 6.983000000000001, 9.150666666666664, 14.66499999999999, 9.111999999999998, 11.816666666666665, 10.673333333333332, 12.753999999999998, 8.090333333333334, 11.064666666666668, 9.71633333333333, 10.655666666666663, 9.825333333333331, 10.158999999999997, 9.47433333333333, 8.781333333333333, 7.6683333333333294, 12.184999999999999, 10.397, 11.79733333333333, 6.802, 7.689999999999999, 8.236999999999998, 12.830333333333336, 9.247666666666662, 9.612666666666664, 10.549999999999995, 8.753333333333332, 8.103666666666665, 11.12733333333333, 10.379333333333333, 11.050333333333327, 7.941333333333332, 7.731333333333334, 7.606666666666665, 8.439999999999998, 10.204, 11.074000000000002, 7.952999999999999, 7.593333333333334, 7.407333333333332, 7.590666666666666, 12.908, 7.300999999999998, 9.877333333333336, 9.036999999999997, 9.054666666666664, 9.117999999999997, 10.571666666666665, 9.145999999999997, 11.330666666666664, 7.595000000000001, 9.264666666666665, 8.836666666666666, 10.118333333333334, 7.382, 9.149666666666665, 6.745000000000001, 10.906666666666663, 11.863333333333332, 9.576666666666666, 10.336666666666664, 7.347999999999997, 11.15133333333333, 10.219000000000001, 7.701999999999998, 7.692666666666665, 10.524999999999999, 9.308666666666667, 9.024666666666667, 8.732333333333333, 12.446666666666664, 7.529333333333332, 7.548666666666666, 11.51933333333333], "episode_lengths": [23, 23, 16, 19, 18, 17, 15, 19, 28, 17, 24, 19, 30, 24, 20, 29, 16, 23, 17, 18, 23, 16, 22, 28, 15, 22, 17, 23, 24, 21, 15, 19, 15, 20, 16, 21, 19, 18, 28, 26, 20, 21, 25, 19, 24, 19, 20, 21, 27, 17, 15, 21, 20, 18, 23, 22, 27, 24, 19, 22, 17, 20, 17, 21, 20, 23, 17, 16, 20, 23, 14, 18, 20, 18, 25, 22, 17, 19, 19, 17, 21, 18, 27, 18, 22, 18, 15, 16, 31, 21, 21, 20, 15, 14, 21, 26, 18, 20, 20, 18, 23, 18, 16, 20, 26, 20, 19, 17, 23, 22, 18, 16, 21, 19, 25, 16, 17, 22, 27, 19, 16, 18, 29, 20, 23, 23, 28, 20, 22, 25, 22, 20, 23, 21, 18, 15, 25, 24, 26, 14, 15, 21, 27, 19, 21, 20, 18, 18, 23, 22, 24, 16, 17, 18, 19, 20, 24, 18, 17, 15, 18, 26, 17, 25, 19, 19, 18, 24, 19, 24, 18, 18, 17, 21, 17, 20, 14, 21, 22, 20, 25, 18, 26, 22, 16, 16, 24, 21, 21, 19, 23, 17, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.758817027650815, "mean_inference_ms": 3.0468423515498313, "mean_action_processing_ms": 0.6369656488144634, "mean_env_wait_ms": 0.13854856984751487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03568671413303651, "StateBufferConnector_ms": 0.014509613980951998, "ViewRequirementAgentConnector_ms": 0.5533213467942071}}, "episode_reward_max": 14.66499999999999, "episode_reward_min": 6.4736666666666665, "episode_reward_mean": 9.589027491408933, "episode_len_mean": 20.314432989690722, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.389999999999997, 11.281666666666665, 7.2219999999999995, 9.937333333333335, 7.978, 8.260666666666665, 7.369999999999998, 8.092999999999996, 14.07466666666666, 7.333666666666666, 11.84333333333333, 8.947000000000001, 13.829333333333336, 11.678333333333336, 8.096666666666666, 12.754, 7.527999999999999, 10.202666666666666, 8.662666666666665, 8.136333333333333, 11.09733333333333, 8.084666666666665, 12.134333333333334, 14.256666666666668, 7.0006666666666675, 10.085999999999999, 8.118333333333334, 9.898, 11.160333333333329, 9.464666666666666, 6.985999999999998, 10.022999999999998, 7.012333333333334, 9.923666666666666, 7.665666666666666, 10.514666666666669, 8.66833333333333, 9.099666666666668, 14.52566666666666, 11.587999999999997, 9.121000000000002, 8.588666666666667, 12.190999999999995, 9.513666666666667, 11.033666666666665, 9.220333333333333, 10.026666666666666, 9.757999999999996, 12.002333333333329, 8.316333333333334, 7.582666666666666, 9.94733333333333, 10.827, 8.754666666666665, 9.911999999999997, 10.469999999999995, 12.377999999999998, 12.983, 9.838333333333333, 9.917333333333332, 8.038666666666662, 9.089666666666663, 8.250666666666664, 9.823666666666663, 10.801666666666666, 10.569666666666665, 8.249333333333333, 7.598333333333332, 8.929999999999998, 11.548333333333332, 6.497333333333332, 8.461999999999998, 10.162666666666667, 8.346333333333332, 11.526999999999996, 10.493666666666664, 7.966666666666669, 9.307666666666666, 9.148333333333332, 8.399333333333333, 10.530666666666669, 7.8053333333333335, 13.958999999999996, 7.621333333333331, 10.520666666666665, 7.793999999999999, 7.7059999999999995, 7.930666666666665, 14.42533333333333, 8.767999999999997, 9.416666666666664, 9.472666666666667, 6.4736666666666665, 7.166666666666664, 9.939666666666668, 11.088333333333335, 8.874666666666666, 10.285999999999996, 8.47433333333333, 10.242666666666668, 9.963999999999999, 7.7843333333333335, 8.011333333333331, 10.342, 12.194666666666665, 10.253333333333332, 8.66433333333333, 6.9433333333333325, 11.723333333333327, 9.657333333333332, 8.240666666666664, 7.603666666666666, 10.064333333333327, 10.063999999999998, 12.100000000000001, 7.590666666666666, 8.363999999999999, 10.792333333333335, 12.425666666666661, 8.709999999999997, 6.983000000000001, 9.150666666666664, 14.66499999999999, 9.111999999999998, 11.816666666666665, 10.673333333333332, 12.753999999999998, 8.090333333333334, 11.064666666666668, 9.71633333333333, 10.655666666666663, 9.825333333333331, 10.158999999999997, 9.47433333333333, 8.781333333333333, 7.6683333333333294, 12.184999999999999, 10.397, 11.79733333333333, 6.802, 7.689999999999999, 8.236999999999998, 12.830333333333336, 9.247666666666662, 9.612666666666664, 10.549999999999995, 8.753333333333332, 8.103666666666665, 11.12733333333333, 10.379333333333333, 11.050333333333327, 7.941333333333332, 7.731333333333334, 7.606666666666665, 8.439999999999998, 10.204, 11.074000000000002, 7.952999999999999, 7.593333333333334, 7.407333333333332, 7.590666666666666, 12.908, 7.300999999999998, 9.877333333333336, 9.036999999999997, 9.054666666666664, 9.117999999999997, 10.571666666666665, 9.145999999999997, 11.330666666666664, 7.595000000000001, 9.264666666666665, 8.836666666666666, 10.118333333333334, 7.382, 9.149666666666665, 6.745000000000001, 10.906666666666663, 11.863333333333332, 9.576666666666666, 10.336666666666664, 7.347999999999997, 11.15133333333333, 10.219000000000001, 7.701999999999998, 7.692666666666665, 10.524999999999999, 9.308666666666667, 9.024666666666667, 8.732333333333333, 12.446666666666664, 7.529333333333332, 7.548666666666666, 11.51933333333333], "episode_lengths": [23, 23, 16, 19, 18, 17, 15, 19, 28, 17, 24, 19, 30, 24, 20, 29, 16, 23, 17, 18, 23, 16, 22, 28, 15, 22, 17, 23, 24, 21, 15, 19, 15, 20, 16, 21, 19, 18, 28, 26, 20, 21, 25, 19, 24, 19, 20, 21, 27, 17, 15, 21, 20, 18, 23, 22, 27, 24, 19, 22, 17, 20, 17, 21, 20, 23, 17, 16, 20, 23, 14, 18, 20, 18, 25, 22, 17, 19, 19, 17, 21, 18, 27, 18, 22, 18, 15, 16, 31, 21, 21, 20, 15, 14, 21, 26, 18, 20, 20, 18, 23, 18, 16, 20, 26, 20, 19, 17, 23, 22, 18, 16, 21, 19, 25, 16, 17, 22, 27, 19, 16, 18, 29, 20, 23, 23, 28, 20, 22, 25, 22, 20, 23, 21, 18, 15, 25, 24, 26, 14, 15, 21, 27, 19, 21, 20, 18, 18, 23, 22, 24, 16, 17, 18, 19, 20, 24, 18, 17, 15, 18, 26, 17, 25, 19, 19, 18, 24, 19, 24, 18, 18, 17, 21, 17, 20, 14, 21, 22, 20, 25, 18, 26, 22, 16, 16, 24, 21, 21, 19, 23, 17, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.758817027650815, "mean_inference_ms": 3.0468423515498313, "mean_action_processing_ms": 0.6369656488144634, "mean_env_wait_ms": 0.13854856984751487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03568671413303651, "StateBufferConnector_ms": 0.014509613980951998, "ViewRequirementAgentConnector_ms": 0.5533213467942071}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.24144749554114, "num_env_steps_trained_throughput_per_sec": 313.24144749554114, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10936.228, "sample_time_ms": 3318.782, "load_time_ms": 0.5, "load_throughput": 7996766.444, "learn_time_ms": 7563.944, "learn_throughput": 528.825, "synch_weights_time_ms": 32.504}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 402, "training_iteration": 2, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-46-00", "timestamp": 1701996360, "time_this_iter_s": 12.797698497772217, "time_total_s": 21.946460962295532, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.946460962295532, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 72.34615384615384, "ram_util_percent": 96.58461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 2.41455078125, "policy_loss": -0.04148344695568085, "vf_loss": 2.4465830326080322, "vf_explained_var": 0.7216274738311768, "kl": 0.03150482475757599, "entropy": 0.8921398520469666, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 20.58566666666666, "episode_reward_min": 5.978666666666665, "episode_reward_mean": 10.687498168498166, "episode_len_mean": 22.274725274725274, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.120666666666665, 13.292666666666664, 10.097666666666667, 10.335999999999999, 7.872000000000001, 12.936666666666664, 8.41, 9.015666666666668, 6.5893333333333315, 9.396666666666667, 10.106666666666667, 12.360666666666667, 9.47333333333333, 18.176666666666662, 9.101333333333333, 10.479999999999999, 8.897333333333334, 12.05633333333333, 8.27, 14.889333333333333, 9.190666666666667, 14.611333333333333, 10.187999999999999, 7.430666666666666, 6.800999999999999, 14.108666666666666, 12.978999999999992, 11.067666666666668, 9.934666666666667, 11.811999999999998, 11.007666666666664, 11.444333333333327, 14.561999999999998, 9.932, 13.481333333333332, 8.393333333333333, 13.305999999999994, 12.869999999999996, 9.27533333333333, 13.826333333333325, 9.632666666666664, 8.806666666666665, 9.654333333333334, 13.984, 9.101333333333331, 6.445666666666668, 9.599333333333332, 11.496666666666663, 10.556, 7.069333333333333, 9.600333333333328, 10.480999999999998, 19.789333333333325, 12.885999999999996, 7.762666666666666, 8.912333333333331, 8.538666666666668, 8.173666666666666, 9.322, 8.155333333333333, 5.978666666666665, 12.45266666666666, 11.297999999999998, 8.541999999999996, 12.084666666666664, 7.4559999999999995, 10.126333333333331, 15.67266666666666, 8.939666666666666, 8.690999999999999, 8.762, 9.353999999999997, 9.047333333333333, 9.062, 11.958666666666662, 9.130333333333333, 13.602000000000002, 14.671999999999997, 9.814666666666666, 11.396666666666667, 9.684999999999997, 8.254999999999997, 12.387333333333338, 8.731, 11.743333333333327, 10.648000000000001, 9.303333333333331, 8.154, 13.800333333333333, 8.281666666666665, 16.026333333333326, 13.407333333333334, 10.179666666666664, 10.489333333333331, 13.33933333333333, 12.025999999999998, 7.2813333333333325, 13.821999999999996, 10.08733333333333, 13.317333333333327, 9.975999999999997, 11.343333333333327, 9.810666666666664, 15.965666666666662, 13.530000000000001, 16.623999999999995, 9.626666666666662, 9.501999999999997, 8.16033333333333, 12.962, 10.133333333333333, 8.837000000000002, 7.316666666666666, 12.76033333333333, 8.926, 10.840666666666662, 12.824666666666666, 9.479000000000001, 7.539666666666665, 10.700666666666665, 15.713333333333333, 10.015666666666663, 8.280666666666665, 9.197666666666667, 13.47933333333333, 11.348333333333333, 7.696666666666665, 9.285999999999998, 10.81533333333333, 10.966999999999997, 13.804333333333329, 11.357000000000001, 11.088666666666663, 10.801666666666666, 8.95733333333333, 19.682999999999996, 8.092666666666666, 10.415999999999999, 7.846666666666666, 10.935333333333332, 15.71133333333333, 9.600333333333333, 8.634999999999998, 13.114666666666666, 8.526, 8.001, 8.688999999999998, 9.64233333333333, 8.968666666666664, 8.830666666666666, 10.490999999999996, 8.775, 10.150999999999996, 6.755666666666667, 8.242666666666665, 7.662, 20.58566666666666, 14.07133333333333, 9.947999999999999, 12.043333333333337, 7.761999999999999, 12.908333333333335, 12.391999999999998, 9.743666666666668, 9.089333333333332, 11.474666666666664, 11.215000000000002, 12.556333333333331, 7.869333333333332, 11.247666666666664, 10.721666666666664, 7.010666666666666, 14.79866666666667, 12.837333333333332, 12.661333333333332, 8.332666666666665, 13.842333333333327, 9.632666666666667, 8.525333333333332, 11.30466666666666, 9.029666666666667, 9.008666666666663], "episode_lengths": [20, 26, 23, 22, 17, 24, 18, 20, 15, 21, 21, 27, 20, 38, 19, 22, 19, 27, 17, 30, 19, 27, 21, 16, 15, 25, 27, 24, 19, 26, 21, 25, 28, 21, 26, 18, 25, 29, 21, 29, 20, 21, 20, 30, 21, 15, 21, 24, 22, 16, 23, 23, 37, 23, 18, 19, 17, 16, 21, 16, 15, 26, 23, 16, 24, 15, 22, 31, 18, 20, 20, 20, 19, 18, 22, 22, 28, 27, 20, 23, 24, 17, 27, 19, 23, 20, 19, 18, 26, 19, 30, 32, 23, 24, 26, 23, 17, 28, 21, 26, 20, 24, 19, 34, 25, 33, 21, 19, 20, 25, 23, 18, 15, 24, 18, 22, 27, 20, 16, 20, 32, 23, 17, 20, 24, 26, 16, 20, 23, 23, 32, 24, 21, 24, 23, 39, 17, 23, 16, 22, 33, 19, 21, 24, 19, 17, 19, 20, 17, 18, 21, 18, 20, 15, 21, 17, 36, 31, 21, 25, 16, 25, 25, 22, 23, 25, 25, 25, 16, 25, 20, 16, 32, 29, 25, 17, 27, 18, 19, 23, 22, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7834544877560417, "mean_inference_ms": 3.018709571298364, "mean_action_processing_ms": 0.6405082888920098, "mean_env_wait_ms": 0.14718672039460295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022265282306042345, "StateBufferConnector_ms": 0.01655686032641065, "ViewRequirementAgentConnector_ms": 0.5421850707504775}}, "episode_reward_max": 20.58566666666666, "episode_reward_min": 5.978666666666665, "episode_reward_mean": 10.687498168498166, "episode_len_mean": 22.274725274725274, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.120666666666665, 13.292666666666664, 10.097666666666667, 10.335999999999999, 7.872000000000001, 12.936666666666664, 8.41, 9.015666666666668, 6.5893333333333315, 9.396666666666667, 10.106666666666667, 12.360666666666667, 9.47333333333333, 18.176666666666662, 9.101333333333333, 10.479999999999999, 8.897333333333334, 12.05633333333333, 8.27, 14.889333333333333, 9.190666666666667, 14.611333333333333, 10.187999999999999, 7.430666666666666, 6.800999999999999, 14.108666666666666, 12.978999999999992, 11.067666666666668, 9.934666666666667, 11.811999999999998, 11.007666666666664, 11.444333333333327, 14.561999999999998, 9.932, 13.481333333333332, 8.393333333333333, 13.305999999999994, 12.869999999999996, 9.27533333333333, 13.826333333333325, 9.632666666666664, 8.806666666666665, 9.654333333333334, 13.984, 9.101333333333331, 6.445666666666668, 9.599333333333332, 11.496666666666663, 10.556, 7.069333333333333, 9.600333333333328, 10.480999999999998, 19.789333333333325, 12.885999999999996, 7.762666666666666, 8.912333333333331, 8.538666666666668, 8.173666666666666, 9.322, 8.155333333333333, 5.978666666666665, 12.45266666666666, 11.297999999999998, 8.541999999999996, 12.084666666666664, 7.4559999999999995, 10.126333333333331, 15.67266666666666, 8.939666666666666, 8.690999999999999, 8.762, 9.353999999999997, 9.047333333333333, 9.062, 11.958666666666662, 9.130333333333333, 13.602000000000002, 14.671999999999997, 9.814666666666666, 11.396666666666667, 9.684999999999997, 8.254999999999997, 12.387333333333338, 8.731, 11.743333333333327, 10.648000000000001, 9.303333333333331, 8.154, 13.800333333333333, 8.281666666666665, 16.026333333333326, 13.407333333333334, 10.179666666666664, 10.489333333333331, 13.33933333333333, 12.025999999999998, 7.2813333333333325, 13.821999999999996, 10.08733333333333, 13.317333333333327, 9.975999999999997, 11.343333333333327, 9.810666666666664, 15.965666666666662, 13.530000000000001, 16.623999999999995, 9.626666666666662, 9.501999999999997, 8.16033333333333, 12.962, 10.133333333333333, 8.837000000000002, 7.316666666666666, 12.76033333333333, 8.926, 10.840666666666662, 12.824666666666666, 9.479000000000001, 7.539666666666665, 10.700666666666665, 15.713333333333333, 10.015666666666663, 8.280666666666665, 9.197666666666667, 13.47933333333333, 11.348333333333333, 7.696666666666665, 9.285999999999998, 10.81533333333333, 10.966999999999997, 13.804333333333329, 11.357000000000001, 11.088666666666663, 10.801666666666666, 8.95733333333333, 19.682999999999996, 8.092666666666666, 10.415999999999999, 7.846666666666666, 10.935333333333332, 15.71133333333333, 9.600333333333333, 8.634999999999998, 13.114666666666666, 8.526, 8.001, 8.688999999999998, 9.64233333333333, 8.968666666666664, 8.830666666666666, 10.490999999999996, 8.775, 10.150999999999996, 6.755666666666667, 8.242666666666665, 7.662, 20.58566666666666, 14.07133333333333, 9.947999999999999, 12.043333333333337, 7.761999999999999, 12.908333333333335, 12.391999999999998, 9.743666666666668, 9.089333333333332, 11.474666666666664, 11.215000000000002, 12.556333333333331, 7.869333333333332, 11.247666666666664, 10.721666666666664, 7.010666666666666, 14.79866666666667, 12.837333333333332, 12.661333333333332, 8.332666666666665, 13.842333333333327, 9.632666666666667, 8.525333333333332, 11.30466666666666, 9.029666666666667, 9.008666666666663], "episode_lengths": [20, 26, 23, 22, 17, 24, 18, 20, 15, 21, 21, 27, 20, 38, 19, 22, 19, 27, 17, 30, 19, 27, 21, 16, 15, 25, 27, 24, 19, 26, 21, 25, 28, 21, 26, 18, 25, 29, 21, 29, 20, 21, 20, 30, 21, 15, 21, 24, 22, 16, 23, 23, 37, 23, 18, 19, 17, 16, 21, 16, 15, 26, 23, 16, 24, 15, 22, 31, 18, 20, 20, 20, 19, 18, 22, 22, 28, 27, 20, 23, 24, 17, 27, 19, 23, 20, 19, 18, 26, 19, 30, 32, 23, 24, 26, 23, 17, 28, 21, 26, 20, 24, 19, 34, 25, 33, 21, 19, 20, 25, 23, 18, 15, 24, 18, 22, 27, 20, 16, 20, 32, 23, 17, 20, 24, 26, 16, 20, 23, 23, 32, 24, 21, 24, 23, 39, 17, 23, 16, 22, 33, 19, 21, 24, 19, 17, 19, 20, 17, 18, 21, 18, 20, 15, 21, 17, 36, 31, 21, 25, 16, 25, 25, 22, 23, 25, 25, 25, 16, 25, 20, 16, 32, 29, 25, 17, 27, 18, 19, 23, 22, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7834544877560417, "mean_inference_ms": 3.018709571298364, "mean_action_processing_ms": 0.6405082888920098, "mean_env_wait_ms": 0.14718672039460295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022265282306042345, "StateBufferConnector_ms": 0.01655686032641065, "ViewRequirementAgentConnector_ms": 0.5421850707504775}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.6751554738417, "num_env_steps_trained_throughput_per_sec": 429.6751554738417, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10393.938, "sample_time_ms": 3316.169, "load_time_ms": 0.333, "load_throughput": 11995149.666, "learn_time_ms": 7032.256, "learn_throughput": 568.807, "synch_weights_time_ms": 30.609}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 584, "training_iteration": 3, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-46-10", "timestamp": 1701996370, "time_this_iter_s": 9.339635372161865, "time_total_s": 31.286096334457397, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.286096334457397, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.28333333333335, "ram_util_percent": 96.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 4.999999873689376e-05, "total_loss": 4.139685153961182, "policy_loss": -0.017393359914422035, "vf_loss": 4.151590824127197, "vf_explained_var": 0.6363045573234558, "kl": 0.012194604612886906, "entropy": 0.7774696350097656, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 36.16366666666666, "episode_reward_min": 7.331, "episode_reward_mean": 13.859940476190472, "episode_len_mean": 28.457142857142856, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.213333333333333, 17.556333333333328, 19.489999999999988, 20.04466666666667, 13.692666666666666, 8.617333333333333, 12.131999999999998, 17.380999999999997, 15.09866666666666, 12.37033333333333, 9.981999999999996, 9.287999999999998, 10.065333333333331, 9.163999999999998, 12.61933333333333, 10.303333333333333, 9.71166666666667, 10.034666666666666, 19.06599999999999, 14.663666666666666, 10.649999999999997, 10.785666666666662, 15.487999999999998, 16.380666666666666, 9.896666666666665, 9.38233333333333, 10.914666666666665, 13.490666666666666, 17.959666666666664, 13.605, 15.30933333333333, 13.106666666666664, 8.901666666666667, 14.351999999999993, 9.629333333333332, 24.975666666666662, 17.136, 18.995999999999995, 7.865333333333334, 11.481999999999996, 18.381666666666668, 8.527999999999997, 9.093333333333332, 7.420666666666666, 35.05733333333335, 8.871000000000002, 16.305333333333326, 13.193999999999996, 11.033333333333331, 23.169, 13.156666666666666, 11.843333333333334, 19.17533333333333, 10.739333333333333, 11.182666666666663, 17.113, 10.147333333333334, 9.558666666666664, 9.198666666666668, 9.429, 9.858666666666664, 10.297999999999998, 12.08466666666666, 11.91866666666666, 10.204999999999997, 10.253333333333332, 11.854333333333331, 11.773, 19.89266666666667, 9.914666666666664, 16.502333333333326, 16.96699999999999, 13.297666666666665, 30.098999999999982, 10.323999999999998, 15.605666666666664, 10.248333333333333, 11.458999999999996, 12.103999999999997, 17.08166666666666, 14.069333333333326, 12.637999999999993, 15.113666666666656, 9.309333333333333, 17.57033333333333, 16.877333333333333, 11.295, 9.005666666666668, 11.904666666666664, 13.729999999999997, 36.16366666666666, 13.032666666666666, 14.577666666666664, 14.371666666666663, 21.24566666666667, 15.470666666666665, 10.236666666666666, 9.986999999999997, 18.398666666666664, 14.663333333333325, 9.243999999999998, 14.281999999999996, 16.516, 11.367999999999999, 10.682666666666663, 21.66599999999999, 14.263999999999998, 17.890999999999995, 8.795666666666667, 15.972666666666663, 11.199999999999996, 9.430333333333333, 19.825333333333326, 22.87566666666666, 9.546666666666667, 11.757666666666667, 9.829999999999997, 10.909999999999997, 12.106666666666664, 13.812666666666662, 11.614999999999997, 9.86666666666666, 11.677666666666665, 14.339000000000004, 34.84233333333334, 19.95433333333333, 13.502999999999995, 13.907999999999987, 13.340333333333334, 24.836000000000002, 12.627999999999997, 10.875999999999998, 9.768666666666665, 20.830666666666666, 11.523999999999992, 8.562666666666665, 7.331, 9.325666666666667, 14.090999999999998, 16.792666666666666], "episode_lengths": [26, 32, 42, 41, 27, 18, 24, 34, 33, 27, 19, 19, 21, 19, 25, 22, 19, 22, 31, 31, 22, 25, 37, 36, 22, 20, 21, 27, 33, 27, 31, 26, 22, 27, 20, 49, 31, 38, 17, 22, 38, 17, 21, 15, 65, 20, 34, 24, 22, 55, 24, 23, 37, 22, 24, 32, 21, 19, 23, 21, 20, 21, 27, 24, 21, 20, 26, 23, 40, 18, 39, 34, 30, 57, 21, 29, 23, 28, 25, 32, 34, 27, 28, 19, 31, 36, 22, 20, 23, 26, 79, 23, 31, 24, 53, 32, 22, 20, 36, 29, 19, 29, 35, 22, 23, 44, 29, 35, 20, 31, 21, 20, 39, 44, 19, 29, 22, 26, 24, 27, 28, 24, 25, 32, 82, 36, 30, 28, 36, 42, 25, 21, 21, 40, 23, 16, 16, 20, 31, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777514253800732, "mean_inference_ms": 3.0505634082849746, "mean_action_processing_ms": 0.6523184958760151, "mean_env_wait_ms": 0.1526098783712346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0231952326638358, "StateBufferConnector_ms": 0.015819413321358815, "ViewRequirementAgentConnector_ms": 0.5493376936231341}}, "episode_reward_max": 36.16366666666666, "episode_reward_min": 7.331, "episode_reward_mean": 13.859940476190472, "episode_len_mean": 28.457142857142856, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.213333333333333, 17.556333333333328, 19.489999999999988, 20.04466666666667, 13.692666666666666, 8.617333333333333, 12.131999999999998, 17.380999999999997, 15.09866666666666, 12.37033333333333, 9.981999999999996, 9.287999999999998, 10.065333333333331, 9.163999999999998, 12.61933333333333, 10.303333333333333, 9.71166666666667, 10.034666666666666, 19.06599999999999, 14.663666666666666, 10.649999999999997, 10.785666666666662, 15.487999999999998, 16.380666666666666, 9.896666666666665, 9.38233333333333, 10.914666666666665, 13.490666666666666, 17.959666666666664, 13.605, 15.30933333333333, 13.106666666666664, 8.901666666666667, 14.351999999999993, 9.629333333333332, 24.975666666666662, 17.136, 18.995999999999995, 7.865333333333334, 11.481999999999996, 18.381666666666668, 8.527999999999997, 9.093333333333332, 7.420666666666666, 35.05733333333335, 8.871000000000002, 16.305333333333326, 13.193999999999996, 11.033333333333331, 23.169, 13.156666666666666, 11.843333333333334, 19.17533333333333, 10.739333333333333, 11.182666666666663, 17.113, 10.147333333333334, 9.558666666666664, 9.198666666666668, 9.429, 9.858666666666664, 10.297999999999998, 12.08466666666666, 11.91866666666666, 10.204999999999997, 10.253333333333332, 11.854333333333331, 11.773, 19.89266666666667, 9.914666666666664, 16.502333333333326, 16.96699999999999, 13.297666666666665, 30.098999999999982, 10.323999999999998, 15.605666666666664, 10.248333333333333, 11.458999999999996, 12.103999999999997, 17.08166666666666, 14.069333333333326, 12.637999999999993, 15.113666666666656, 9.309333333333333, 17.57033333333333, 16.877333333333333, 11.295, 9.005666666666668, 11.904666666666664, 13.729999999999997, 36.16366666666666, 13.032666666666666, 14.577666666666664, 14.371666666666663, 21.24566666666667, 15.470666666666665, 10.236666666666666, 9.986999999999997, 18.398666666666664, 14.663333333333325, 9.243999999999998, 14.281999999999996, 16.516, 11.367999999999999, 10.682666666666663, 21.66599999999999, 14.263999999999998, 17.890999999999995, 8.795666666666667, 15.972666666666663, 11.199999999999996, 9.430333333333333, 19.825333333333326, 22.87566666666666, 9.546666666666667, 11.757666666666667, 9.829999999999997, 10.909999999999997, 12.106666666666664, 13.812666666666662, 11.614999999999997, 9.86666666666666, 11.677666666666665, 14.339000000000004, 34.84233333333334, 19.95433333333333, 13.502999999999995, 13.907999999999987, 13.340333333333334, 24.836000000000002, 12.627999999999997, 10.875999999999998, 9.768666666666665, 20.830666666666666, 11.523999999999992, 8.562666666666665, 7.331, 9.325666666666667, 14.090999999999998, 16.792666666666666], "episode_lengths": [26, 32, 42, 41, 27, 18, 24, 34, 33, 27, 19, 19, 21, 19, 25, 22, 19, 22, 31, 31, 22, 25, 37, 36, 22, 20, 21, 27, 33, 27, 31, 26, 22, 27, 20, 49, 31, 38, 17, 22, 38, 17, 21, 15, 65, 20, 34, 24, 22, 55, 24, 23, 37, 22, 24, 32, 21, 19, 23, 21, 20, 21, 27, 24, 21, 20, 26, 23, 40, 18, 39, 34, 30, 57, 21, 29, 23, 28, 25, 32, 34, 27, 28, 19, 31, 36, 22, 20, 23, 26, 79, 23, 31, 24, 53, 32, 22, 20, 36, 29, 19, 29, 35, 22, 23, 44, 29, 35, 20, 31, 21, 20, 39, 44, 19, 29, 22, 26, 24, 27, 28, 24, 25, 32, 82, 36, 30, 28, 36, 42, 25, 21, 21, 40, 23, 16, 16, 20, 31, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777514253800732, "mean_inference_ms": 3.0505634082849746, "mean_action_processing_ms": 0.6523184958760151, "mean_env_wait_ms": 0.1526098783712346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0231952326638358, "StateBufferConnector_ms": 0.015819413321358815, "ViewRequirementAgentConnector_ms": 0.5493376936231341}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.31770927187733, "num_env_steps_trained_throughput_per_sec": 445.31770927187733, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10041.041, "sample_time_ms": 3349.585, "load_time_ms": 0.485, "load_throughput": 8250413.573, "learn_time_ms": 6651.078, "learn_throughput": 601.406, "synch_weights_time_ms": 28.451}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 724, "training_iteration": 4, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-46-19", "timestamp": 1701996379, "time_this_iter_s": 9.017377614974976, "time_total_s": 40.30347394943237, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 40.30347394943237, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 76.16923076923077, "ram_util_percent": 96.00769230769228}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 4.999999873689376e-05, "total_loss": 4.846627235412598, "policy_loss": -0.015552575699985027, "vf_loss": 4.857674598693848, "vf_explained_var": 0.6039794683456421, "kl": 0.010011683218181133, "entropy": 0.6502699851989746, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 52.14133333333333, "episode_reward_min": 7.203333333333333, "episode_reward_mean": 16.635809116809114, "episode_len_mean": 33.94871794871795, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.824666666666662, 23.465333333333337, 25.246999999999996, 23.847333333333328, 10.436666666666664, 14.786999999999999, 10.074999999999998, 11.678666666666665, 11.607666666666665, 14.33633333333333, 21.955000000000002, 13.655333333333333, 24.19033333333332, 8.041999999999998, 9.129333333333332, 15.955666666666662, 8.735, 17.755666666666666, 14.521666666666667, 11.562666666666662, 7.203333333333333, 18.347, 14.129666666666665, 14.427333333333326, 19.81266666666667, 13.132999999999997, 20.261666666666663, 21.651000000000003, 30.223333333333333, 22.14533333333333, 17.96899999999999, 13.782, 26.34866666666666, 13.337333333333328, 11.677666666666665, 13.815, 15.03866666666666, 17.847333333333328, 10.426666666666668, 26.113000000000003, 17.600999999999996, 18.761333333333326, 17.55166666666665, 10.868333333333332, 21.54033333333333, 25.07799999999999, 12.208666666666662, 13.047333333333333, 12.686666666666662, 13.649999999999997, 10.564666666666664, 10.852666666666666, 23.868999999999993, 22.30633333333333, 21.538666666666668, 52.14133333333333, 27.004999999999992, 35.14133333333334, 15.525666666666663, 12.55933333333333, 9.56, 15.587999999999992, 22.736666666666657, 7.830333333333331, 10.675999999999997, 18.092333333333325, 12.628, 18.063999999999997, 9.486666666666665, 17.726666666666667, 11.49333333333333, 11.69533333333333, 10.658333333333333, 15.774333333333335, 18.560999999999993, 14.157999999999994, 20.036999999999995, 17.91, 12.177999999999999, 12.410666666666666, 14.575666666666665, 11.769999999999998, 20.421333333333333, 15.470666666666666, 22.75466666666666, 11.983999999999996, 33.733000000000004, 11.686, 14.535666666666666, 11.678666666666661, 14.042666666666662, 15.88666666666666, 9.41533333333333, 12.671999999999995, 19.875999999999998, 18.147999999999996, 32.44166666666666, 16.69133333333333, 14.51466666666666, 15.382000000000001, 15.125333333333325, 18.430666666666667, 27.716999999999995, 13.051333333333334, 12.225666666666665, 28.07366666666666, 8.485333333333333, 10.457666666666666, 18.845333333333333, 13.69433333333333, 21.099666666666664, 14.127, 8.427999999999999, 18.249666666666663, 19.585666666666658, 11.386666666666663, 16.466666666666658], "episode_lengths": [34, 58, 43, 47, 21, 28, 23, 23, 24, 32, 44, 27, 43, 17, 19, 27, 18, 48, 27, 26, 16, 35, 30, 28, 46, 26, 36, 51, 55, 57, 36, 29, 50, 30, 25, 27, 35, 37, 22, 45, 41, 45, 40, 25, 44, 60, 25, 28, 29, 27, 21, 24, 43, 39, 44, 85, 43, 71, 28, 26, 20, 33, 39, 16, 20, 33, 28, 41, 19, 34, 26, 23, 20, 37, 43, 30, 39, 33, 25, 25, 33, 21, 41, 33, 52, 24, 68, 27, 31, 24, 24, 29, 21, 23, 41, 59, 51, 40, 31, 30, 32, 38, 51, 27, 25, 51, 17, 23, 39, 32, 43, 26, 18, 37, 34, 23, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7621970879257738, "mean_inference_ms": 3.0791310947582597, "mean_action_processing_ms": 0.6514417728164795, "mean_env_wait_ms": 0.15074604990500495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05651498452211038, "StateBufferConnector_ms": 0.009184005932930188, "ViewRequirementAgentConnector_ms": 0.5549606095012437}}, "episode_reward_max": 52.14133333333333, "episode_reward_min": 7.203333333333333, "episode_reward_mean": 16.635809116809114, "episode_len_mean": 33.94871794871795, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.824666666666662, 23.465333333333337, 25.246999999999996, 23.847333333333328, 10.436666666666664, 14.786999999999999, 10.074999999999998, 11.678666666666665, 11.607666666666665, 14.33633333333333, 21.955000000000002, 13.655333333333333, 24.19033333333332, 8.041999999999998, 9.129333333333332, 15.955666666666662, 8.735, 17.755666666666666, 14.521666666666667, 11.562666666666662, 7.203333333333333, 18.347, 14.129666666666665, 14.427333333333326, 19.81266666666667, 13.132999999999997, 20.261666666666663, 21.651000000000003, 30.223333333333333, 22.14533333333333, 17.96899999999999, 13.782, 26.34866666666666, 13.337333333333328, 11.677666666666665, 13.815, 15.03866666666666, 17.847333333333328, 10.426666666666668, 26.113000000000003, 17.600999999999996, 18.761333333333326, 17.55166666666665, 10.868333333333332, 21.54033333333333, 25.07799999999999, 12.208666666666662, 13.047333333333333, 12.686666666666662, 13.649999999999997, 10.564666666666664, 10.852666666666666, 23.868999999999993, 22.30633333333333, 21.538666666666668, 52.14133333333333, 27.004999999999992, 35.14133333333334, 15.525666666666663, 12.55933333333333, 9.56, 15.587999999999992, 22.736666666666657, 7.830333333333331, 10.675999999999997, 18.092333333333325, 12.628, 18.063999999999997, 9.486666666666665, 17.726666666666667, 11.49333333333333, 11.69533333333333, 10.658333333333333, 15.774333333333335, 18.560999999999993, 14.157999999999994, 20.036999999999995, 17.91, 12.177999999999999, 12.410666666666666, 14.575666666666665, 11.769999999999998, 20.421333333333333, 15.470666666666666, 22.75466666666666, 11.983999999999996, 33.733000000000004, 11.686, 14.535666666666666, 11.678666666666661, 14.042666666666662, 15.88666666666666, 9.41533333333333, 12.671999999999995, 19.875999999999998, 18.147999999999996, 32.44166666666666, 16.69133333333333, 14.51466666666666, 15.382000000000001, 15.125333333333325, 18.430666666666667, 27.716999999999995, 13.051333333333334, 12.225666666666665, 28.07366666666666, 8.485333333333333, 10.457666666666666, 18.845333333333333, 13.69433333333333, 21.099666666666664, 14.127, 8.427999999999999, 18.249666666666663, 19.585666666666658, 11.386666666666663, 16.466666666666658], "episode_lengths": [34, 58, 43, 47, 21, 28, 23, 23, 24, 32, 44, 27, 43, 17, 19, 27, 18, 48, 27, 26, 16, 35, 30, 28, 46, 26, 36, 51, 55, 57, 36, 29, 50, 30, 25, 27, 35, 37, 22, 45, 41, 45, 40, 25, 44, 60, 25, 28, 29, 27, 21, 24, 43, 39, 44, 85, 43, 71, 28, 26, 20, 33, 39, 16, 20, 33, 28, 41, 19, 34, 26, 23, 20, 37, 43, 30, 39, 33, 25, 25, 33, 21, 41, 33, 52, 24, 68, 27, 31, 24, 24, 29, 21, 23, 41, 59, 51, 40, 31, 30, 32, 38, 51, 27, 25, 51, 17, 23, 39, 32, 43, 26, 18, 37, 34, 23, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7621970879257738, "mean_inference_ms": 3.0791310947582597, "mean_action_processing_ms": 0.6514417728164795, "mean_env_wait_ms": 0.15074604990500495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05651498452211038, "StateBufferConnector_ms": 0.009184005932930188, "ViewRequirementAgentConnector_ms": 0.5549606095012437}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.0537579242501, "num_env_steps_trained_throughput_per_sec": 449.0537579242501, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 9814.357, "sample_time_ms": 3358.97, "load_time_ms": 0.888, "load_throughput": 4505160.043, "learn_time_ms": 6416.95, "learn_throughput": 623.349, "synch_weights_time_ms": 28.154}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 841, "training_iteration": 5, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-46-28", "timestamp": 1701996388, "time_this_iter_s": 8.933469533920288, "time_total_s": 49.23694348335266, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.23694348335266, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 70.70000000000002, "ram_util_percent": 92.84545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 4.999999873689376e-05, "total_loss": 5.474173545837402, "policy_loss": -0.013688350096344948, "vf_loss": 5.485293388366699, "vf_explained_var": 0.577349066734314, "kl": 0.005707401316612959, "entropy": 0.5761619806289673, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 40.48000000000001, "episode_reward_min": 9.01, "episode_reward_mean": 19.87498039215686, "episode_len_mean": 39.431372549019606, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.010666666666662, 9.859333333333332, 18.711333333333325, 16.311666666666664, 21.657666666666664, 29.544333333333324, 16.20633333333333, 10.104666666666668, 10.953999999999997, 9.653333333333332, 21.15566666666667, 24.090666666666667, 18.509666666666657, 38.13866666666668, 22.926333333333325, 19.29133333333333, 34.515999999999984, 21.939666666666664, 17.140666666666657, 26.537666666666652, 19.622999999999998, 21.526666666666653, 40.48000000000001, 13.904999999999994, 13.463666666666661, 12.423, 15.563999999999997, 21.734333333333314, 19.42199999999999, 20.217999999999993, 13.54266666666666, 15.181666666666667, 20.872666666666657, 14.282000000000004, 15.723666666666666, 18.008333333333326, 24.96866666666666, 11.362666666666662, 14.849999999999994, 32.596999999999994, 18.932999999999993, 26.554333333333325, 24.294666666666654, 13.838666666666663, 36.42266666666666, 11.42566666666667, 39.481333333333346, 15.579333333333329, 12.413333333333327, 18.26033333333333, 13.679333333333329, 20.897666666666666, 25.078999999999994, 17.99933333333333, 17.65033333333333, 28.02133333333332, 18.498999999999985, 15.201333333333332, 18.740666666666662, 14.074999999999992, 36.845, 9.01, 31.999999999999986, 17.549999999999994, 31.236666666666665, 13.748333333333333, 15.113666666666667, 10.486666666666665, 14.436, 21.041666666666668, 13.975333333333332, 17.04966666666666, 16.276333333333326, 40.42000000000001, 14.996333333333334, 17.003999999999998, 11.703333333333333, 21.61233333333333, 20.254999999999995, 24.216666666666672, 30.232999999999997, 16.259333333333327, 23.365666666666648, 12.833999999999996, 13.827999999999996, 33.03966666666667, 36.740666666666655, 21.895666666666656, 15.496666666666663, 11.352666666666666, 12.849333333333332, 18.258999999999997, 11.934000000000001, 13.856333333333334, 16.129999999999995, 15.050999999999993, 13.44333333333333, 39.13433333333335, 16.41833333333333, 13.520333333333332, 27.766, 13.808666666666662], "episode_lengths": [60, 19, 35, 37, 48, 57, 32, 21, 27, 20, 40, 60, 36, 75, 51, 41, 71, 38, 41, 45, 37, 40, 65, 28, 30, 27, 38, 45, 38, 40, 29, 28, 42, 27, 33, 33, 48, 21, 30, 49, 35, 45, 39, 25, 63, 22, 68, 34, 34, 35, 26, 42, 59, 36, 36, 56, 39, 31, 45, 32, 62, 22, 52, 35, 75, 25, 30, 19, 27, 40, 31, 37, 33, 89, 31, 38, 22, 38, 35, 51, 58, 31, 48, 26, 25, 64, 70, 51, 28, 25, 26, 34, 27, 27, 35, 28, 29, 66, 29, 32, 60, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7466149909644961, "mean_inference_ms": 3.0312654305642974, "mean_action_processing_ms": 0.6477553254973615, "mean_env_wait_ms": 0.15155239687896588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027416500390744676, "StateBufferConnector_ms": 0.020746857512230966, "ViewRequirementAgentConnector_ms": 0.5112068325865502}}, "episode_reward_max": 40.48000000000001, "episode_reward_min": 9.01, "episode_reward_mean": 19.87498039215686, "episode_len_mean": 39.431372549019606, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.010666666666662, 9.859333333333332, 18.711333333333325, 16.311666666666664, 21.657666666666664, 29.544333333333324, 16.20633333333333, 10.104666666666668, 10.953999999999997, 9.653333333333332, 21.15566666666667, 24.090666666666667, 18.509666666666657, 38.13866666666668, 22.926333333333325, 19.29133333333333, 34.515999999999984, 21.939666666666664, 17.140666666666657, 26.537666666666652, 19.622999999999998, 21.526666666666653, 40.48000000000001, 13.904999999999994, 13.463666666666661, 12.423, 15.563999999999997, 21.734333333333314, 19.42199999999999, 20.217999999999993, 13.54266666666666, 15.181666666666667, 20.872666666666657, 14.282000000000004, 15.723666666666666, 18.008333333333326, 24.96866666666666, 11.362666666666662, 14.849999999999994, 32.596999999999994, 18.932999999999993, 26.554333333333325, 24.294666666666654, 13.838666666666663, 36.42266666666666, 11.42566666666667, 39.481333333333346, 15.579333333333329, 12.413333333333327, 18.26033333333333, 13.679333333333329, 20.897666666666666, 25.078999999999994, 17.99933333333333, 17.65033333333333, 28.02133333333332, 18.498999999999985, 15.201333333333332, 18.740666666666662, 14.074999999999992, 36.845, 9.01, 31.999999999999986, 17.549999999999994, 31.236666666666665, 13.748333333333333, 15.113666666666667, 10.486666666666665, 14.436, 21.041666666666668, 13.975333333333332, 17.04966666666666, 16.276333333333326, 40.42000000000001, 14.996333333333334, 17.003999999999998, 11.703333333333333, 21.61233333333333, 20.254999999999995, 24.216666666666672, 30.232999999999997, 16.259333333333327, 23.365666666666648, 12.833999999999996, 13.827999999999996, 33.03966666666667, 36.740666666666655, 21.895666666666656, 15.496666666666663, 11.352666666666666, 12.849333333333332, 18.258999999999997, 11.934000000000001, 13.856333333333334, 16.129999999999995, 15.050999999999993, 13.44333333333333, 39.13433333333335, 16.41833333333333, 13.520333333333332, 27.766, 13.808666666666662], "episode_lengths": [60, 19, 35, 37, 48, 57, 32, 21, 27, 20, 40, 60, 36, 75, 51, 41, 71, 38, 41, 45, 37, 40, 65, 28, 30, 27, 38, 45, 38, 40, 29, 28, 42, 27, 33, 33, 48, 21, 30, 49, 35, 45, 39, 25, 63, 22, 68, 34, 34, 35, 26, 42, 59, 36, 36, 56, 39, 31, 45, 32, 62, 22, 52, 35, 75, 25, 30, 19, 27, 40, 31, 37, 33, 89, 31, 38, 22, 38, 35, 51, 58, 31, 48, 26, 25, 64, 70, 51, 28, 25, 26, 34, 27, 27, 35, 28, 29, 66, 29, 32, 60, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7466149909644961, "mean_inference_ms": 3.0312654305642974, "mean_action_processing_ms": 0.6477553254973615, "mean_env_wait_ms": 0.15155239687896588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027416500390744676, "StateBufferConnector_ms": 0.020746857512230966, "ViewRequirementAgentConnector_ms": 0.5112068325865502}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.59224654498627, "num_env_steps_trained_throughput_per_sec": 454.59224654498627, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9645.147, "sample_time_ms": 3308.822, "load_time_ms": 0.906, "load_throughput": 4413895.291, "learn_time_ms": 6299.858, "learn_throughput": 634.935, "synch_weights_time_ms": 27.461}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 943, "training_iteration": 6, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-46-37", "timestamp": 1701996397, "time_this_iter_s": 8.830480337142944, "time_total_s": 58.067423820495605, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 58.067423820495605, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 65.04615384615386, "ram_util_percent": 90.44615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 4.999999873689376e-05, "total_loss": 5.698543548583984, "policy_loss": -0.013347318395972252, "vf_loss": 5.709977626800537, "vf_explained_var": 0.5979832410812378, "kl": 0.004251271951943636, "entropy": 0.5240809321403503, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 44.51133333333334, "episode_reward_min": 8.46933333333333, "episode_reward_mean": 21.050656666666665, "episode_len_mean": 41.83, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.856333333333334, 16.129999999999995, 15.050999999999993, 13.44333333333333, 39.13433333333335, 16.41833333333333, 13.520333333333332, 27.766, 13.808666666666662, 23.32133333333333, 9.693666666666667, 17.55999999999999, 28.843999999999998, 36.61633333333332, 14.251999999999997, 24.100000000000012, 16.18533333333333, 13.947333333333331, 25.793000000000003, 16.311999999999994, 17.117333333333324, 28.083000000000002, 15.24933333333333, 43.46833333333335, 34.12366666666667, 13.83666666666666, 15.805333333333328, 21.569, 21.933333333333323, 14.617666666666663, 23.526666666666657, 11.665333333333333, 44.51133333333334, 28.305999999999994, 20.143666666666658, 25.53666666666666, 22.10366666666666, 44.09100000000002, 30.747666666666657, 18.54833333333333, 42.34833333333335, 9.680000000000001, 15.958333333333332, 18.92366666666667, 10.53533333333333, 17.932999999999993, 16.60566666666666, 20.214, 37.840999999999994, 14.147999999999996, 14.622333333333334, 16.05766666666666, 12.925999999999998, 15.655666666666662, 15.836666666666666, 24.47033333333333, 15.054, 34.52433333333332, 32.965, 14.97733333333333, 18.459666666666667, 12.139666666666669, 8.46933333333333, 10.983999999999996, 18.678666666666665, 27.91066666666667, 27.854999999999993, 20.29533333333333, 16.996, 15.777999999999999, 26.771666666666658, 12.654666666666664, 35.117666666666686, 33.99433333333332, 21.599666666666664, 16.881999999999998, 11.304666666666664, 18.908333333333328, 16.046999999999997, 29.136000000000003, 28.708, 30.123999999999988, 19.79133333333334, 21.85566666666666, 12.320666666666664, 30.970666666666663, 17.645000000000003, 16.828666666666663, 15.740999999999994, 22.697333333333322, 19.610666666666667, 27.36566666666665, 25.518, 21.476999999999997, 16.326, 14.724999999999998, 15.182999999999998, 12.817, 22.907999999999998, 20.45666666666666], "episode_lengths": [27, 35, 28, 29, 66, 29, 32, 60, 27, 41, 20, 35, 48, 70, 39, 53, 33, 27, 62, 39, 35, 57, 28, 75, 69, 23, 31, 55, 37, 33, 45, 21, 82, 54, 42, 57, 59, 82, 59, 40, 70, 21, 34, 46, 20, 40, 35, 38, 61, 24, 28, 32, 27, 27, 29, 46, 29, 67, 56, 30, 38, 25, 18, 21, 42, 57, 56, 37, 31, 29, 73, 26, 65, 56, 40, 35, 24, 32, 29, 50, 55, 73, 41, 41, 25, 53, 41, 33, 30, 45, 38, 55, 45, 49, 44, 28, 33, 27, 51, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7274150272033644, "mean_inference_ms": 2.9766553856832085, "mean_action_processing_ms": 0.6423503517465504, "mean_env_wait_ms": 0.15007103811139855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017868518829345703, "StateBufferConnector_ms": 0.02140641212463379, "ViewRequirementAgentConnector_ms": 0.4736819267272949}}, "episode_reward_max": 44.51133333333334, "episode_reward_min": 8.46933333333333, "episode_reward_mean": 21.050656666666665, "episode_len_mean": 41.83, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.856333333333334, 16.129999999999995, 15.050999999999993, 13.44333333333333, 39.13433333333335, 16.41833333333333, 13.520333333333332, 27.766, 13.808666666666662, 23.32133333333333, 9.693666666666667, 17.55999999999999, 28.843999999999998, 36.61633333333332, 14.251999999999997, 24.100000000000012, 16.18533333333333, 13.947333333333331, 25.793000000000003, 16.311999999999994, 17.117333333333324, 28.083000000000002, 15.24933333333333, 43.46833333333335, 34.12366666666667, 13.83666666666666, 15.805333333333328, 21.569, 21.933333333333323, 14.617666666666663, 23.526666666666657, 11.665333333333333, 44.51133333333334, 28.305999999999994, 20.143666666666658, 25.53666666666666, 22.10366666666666, 44.09100000000002, 30.747666666666657, 18.54833333333333, 42.34833333333335, 9.680000000000001, 15.958333333333332, 18.92366666666667, 10.53533333333333, 17.932999999999993, 16.60566666666666, 20.214, 37.840999999999994, 14.147999999999996, 14.622333333333334, 16.05766666666666, 12.925999999999998, 15.655666666666662, 15.836666666666666, 24.47033333333333, 15.054, 34.52433333333332, 32.965, 14.97733333333333, 18.459666666666667, 12.139666666666669, 8.46933333333333, 10.983999999999996, 18.678666666666665, 27.91066666666667, 27.854999999999993, 20.29533333333333, 16.996, 15.777999999999999, 26.771666666666658, 12.654666666666664, 35.117666666666686, 33.99433333333332, 21.599666666666664, 16.881999999999998, 11.304666666666664, 18.908333333333328, 16.046999999999997, 29.136000000000003, 28.708, 30.123999999999988, 19.79133333333334, 21.85566666666666, 12.320666666666664, 30.970666666666663, 17.645000000000003, 16.828666666666663, 15.740999999999994, 22.697333333333322, 19.610666666666667, 27.36566666666665, 25.518, 21.476999999999997, 16.326, 14.724999999999998, 15.182999999999998, 12.817, 22.907999999999998, 20.45666666666666], "episode_lengths": [27, 35, 28, 29, 66, 29, 32, 60, 27, 41, 20, 35, 48, 70, 39, 53, 33, 27, 62, 39, 35, 57, 28, 75, 69, 23, 31, 55, 37, 33, 45, 21, 82, 54, 42, 57, 59, 82, 59, 40, 70, 21, 34, 46, 20, 40, 35, 38, 61, 24, 28, 32, 27, 27, 29, 46, 29, 67, 56, 30, 38, 25, 18, 21, 42, 57, 56, 37, 31, 29, 73, 26, 65, 56, 40, 35, 24, 32, 29, 50, 55, 73, 41, 41, 25, 53, 41, 33, 30, 45, 38, 55, 45, 49, 44, 28, 33, 27, 51, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7274150272033644, "mean_inference_ms": 2.9766553856832085, "mean_action_processing_ms": 0.6423503517465504, "mean_env_wait_ms": 0.15007103811139855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017868518829345703, "StateBufferConnector_ms": 0.02140641212463379, "ViewRequirementAgentConnector_ms": 0.4736819267272949}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.7947799561491, "num_env_steps_trained_throughput_per_sec": 462.7947799561491, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 9502.003, "sample_time_ms": 3251.493, "load_time_ms": 0.92, "load_throughput": 4349165.352, "learn_time_ms": 6214.515, "learn_throughput": 643.654, "synch_weights_time_ms": 27.88}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 1034, "training_iteration": 7, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-46-46", "timestamp": 1701996406, "time_this_iter_s": 8.668142318725586, "time_total_s": 66.73556613922119, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 66.73556613922119, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 66.70833333333333, "ram_util_percent": 90.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.22499999403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 5.995534896850586, "policy_loss": -0.01093135867267847, "vf_loss": 6.005235195159912, "vf_explained_var": 0.6261496543884277, "kl": 0.005472690798342228, "entropy": 0.45831698179244995, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 56.38266666666669, "episode_reward_min": 9.81733333333333, "episode_reward_mean": 22.912036666666662, "episode_len_mean": 45.51, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.697333333333322, 19.610666666666667, 27.36566666666665, 25.518, 21.476999999999997, 16.326, 14.724999999999998, 15.182999999999998, 12.817, 22.907999999999998, 20.45666666666666, 30.965333333333326, 17.32766666666667, 20.268666666666675, 32.81, 17.337999999999994, 21.752333333333343, 56.38266666666669, 26.17099999999999, 24.091333333333335, 14.416999999999996, 13.312, 28.973000000000013, 16.57966666666666, 30.019, 11.756, 31.08266666666668, 23.05866666666668, 20.78966666666665, 20.302666666666667, 15.516666666666655, 13.048333333333336, 13.71833333333333, 16.41833333333333, 14.052666666666664, 19.919999999999998, 24.455, 24.014333333333326, 28.509999999999987, 34.11166666666666, 22.134666666666668, 15.534666666666663, 17.119999999999994, 39.311666666666646, 33.61466666666668, 25.20099999999999, 28.26000000000001, 27.494666666666657, 28.71966666666667, 18.365, 17.657333333333323, 14.508999999999997, 26.709666666666656, 26.81733333333333, 20.45066666666666, 18.16833333333333, 18.072333333333333, 22.85899999999998, 30.416666666666657, 25.883333333333333, 16.34033333333333, 33.901999999999994, 14.435999999999996, 13.600999999999996, 16.87266666666666, 21.601333333333322, 23.65266666666667, 24.218666666666657, 12.244333333333332, 15.409, 14.785333333333325, 21.894333333333332, 25.765333333333327, 12.317666666666666, 31.313666666666663, 35.55766666666667, 23.510000000000005, 18.228333333333328, 17.98266666666666, 18.460333333333327, 27.351999999999997, 21.10466666666666, 14.402666666666661, 13.805666666666665, 22.950000000000006, 25.86499999999999, 9.81733333333333, 40.67599999999999, 31.83933333333331, 24.84266666666667, 23.53166666666665, 18.206666666666656, 15.514000000000001, 52.91766666666666, 28.958666666666655, 31.81833333333333, 41.43033333333333, 29.014, 28.817999999999998, 18.698999999999998], "episode_lengths": [45, 38, 55, 45, 49, 44, 28, 33, 27, 51, 48, 50, 39, 35, 62, 38, 45, 93, 50, 60, 32, 30, 61, 34, 72, 22, 56, 52, 40, 38, 31, 29, 25, 46, 27, 41, 51, 49, 50, 55, 49, 27, 37, 63, 79, 44, 49, 54, 58, 37, 38, 29, 58, 55, 34, 34, 36, 42, 58, 62, 31, 56, 29, 29, 31, 42, 46, 51, 24, 34, 29, 51, 50, 24, 55, 60, 52, 37, 30, 50, 54, 36, 32, 26, 50, 48, 21, 74, 51, 39, 58, 42, 33, 101, 47, 55, 83, 59, 70, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7243956819757682, "mean_inference_ms": 2.97565753266844, "mean_action_processing_ms": 0.6512516784855373, "mean_env_wait_ms": 0.1504522290682544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02356576919555664, "StateBufferConnector_ms": 0.015380144119262695, "ViewRequirementAgentConnector_ms": 0.5365645885467529}}, "episode_reward_max": 56.38266666666669, "episode_reward_min": 9.81733333333333, "episode_reward_mean": 22.912036666666662, "episode_len_mean": 45.51, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.697333333333322, 19.610666666666667, 27.36566666666665, 25.518, 21.476999999999997, 16.326, 14.724999999999998, 15.182999999999998, 12.817, 22.907999999999998, 20.45666666666666, 30.965333333333326, 17.32766666666667, 20.268666666666675, 32.81, 17.337999999999994, 21.752333333333343, 56.38266666666669, 26.17099999999999, 24.091333333333335, 14.416999999999996, 13.312, 28.973000000000013, 16.57966666666666, 30.019, 11.756, 31.08266666666668, 23.05866666666668, 20.78966666666665, 20.302666666666667, 15.516666666666655, 13.048333333333336, 13.71833333333333, 16.41833333333333, 14.052666666666664, 19.919999999999998, 24.455, 24.014333333333326, 28.509999999999987, 34.11166666666666, 22.134666666666668, 15.534666666666663, 17.119999999999994, 39.311666666666646, 33.61466666666668, 25.20099999999999, 28.26000000000001, 27.494666666666657, 28.71966666666667, 18.365, 17.657333333333323, 14.508999999999997, 26.709666666666656, 26.81733333333333, 20.45066666666666, 18.16833333333333, 18.072333333333333, 22.85899999999998, 30.416666666666657, 25.883333333333333, 16.34033333333333, 33.901999999999994, 14.435999999999996, 13.600999999999996, 16.87266666666666, 21.601333333333322, 23.65266666666667, 24.218666666666657, 12.244333333333332, 15.409, 14.785333333333325, 21.894333333333332, 25.765333333333327, 12.317666666666666, 31.313666666666663, 35.55766666666667, 23.510000000000005, 18.228333333333328, 17.98266666666666, 18.460333333333327, 27.351999999999997, 21.10466666666666, 14.402666666666661, 13.805666666666665, 22.950000000000006, 25.86499999999999, 9.81733333333333, 40.67599999999999, 31.83933333333331, 24.84266666666667, 23.53166666666665, 18.206666666666656, 15.514000000000001, 52.91766666666666, 28.958666666666655, 31.81833333333333, 41.43033333333333, 29.014, 28.817999999999998, 18.698999999999998], "episode_lengths": [45, 38, 55, 45, 49, 44, 28, 33, 27, 51, 48, 50, 39, 35, 62, 38, 45, 93, 50, 60, 32, 30, 61, 34, 72, 22, 56, 52, 40, 38, 31, 29, 25, 46, 27, 41, 51, 49, 50, 55, 49, 27, 37, 63, 79, 44, 49, 54, 58, 37, 38, 29, 58, 55, 34, 34, 36, 42, 58, 62, 31, 56, 29, 29, 31, 42, 46, 51, 24, 34, 29, 51, 50, 24, 55, 60, 52, 37, 30, 50, 54, 36, 32, 26, 50, 48, 21, 74, 51, 39, 58, 42, 33, 101, 47, 55, 83, 59, 70, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7243956819757682, "mean_inference_ms": 2.97565753266844, "mean_action_processing_ms": 0.6512516784855373, "mean_env_wait_ms": 0.1504522290682544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02356576919555664, "StateBufferConnector_ms": 0.015380144119262695, "ViewRequirementAgentConnector_ms": 0.5365645885467529}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.4052637003768, "num_env_steps_trained_throughput_per_sec": 406.4052637003768, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9544.551, "sample_time_ms": 3269.826, "load_time_ms": 0.93, "load_throughput": 4303229.497, "learn_time_ms": 6239.365, "learn_throughput": 641.091, "synch_weights_time_ms": 27.93}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 1123, "training_iteration": 8, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-46-56", "timestamp": 1701996416, "time_this_iter_s": 9.866891622543335, "time_total_s": 76.60245776176453, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 76.60245776176453, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 77.58461538461539, "ram_util_percent": 91.23846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.22499999403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 5.797954082489014, "policy_loss": -0.010125373490154743, "vf_loss": 5.806495189666748, "vf_explained_var": 0.5763881206512451, "kl": 0.007042529061436653, "entropy": 0.3876059651374817, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 52.91766666666666, "episode_reward_min": 9.81733333333333, "episode_reward_mean": 24.10051333333333, "episode_len_mean": 48.69, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.10466666666666, 14.402666666666661, 13.805666666666665, 22.950000000000006, 25.86499999999999, 9.81733333333333, 40.67599999999999, 31.83933333333331, 24.84266666666667, 23.53166666666665, 18.206666666666656, 15.514000000000001, 52.91766666666666, 28.958666666666655, 31.81833333333333, 41.43033333333333, 29.014, 28.817999999999998, 18.698999999999998, 31.758333333333322, 15.572999999999999, 14.331333333333335, 23.094333333333317, 21.421666666666653, 28.28166666666666, 18.927666666666674, 20.50033333333333, 32.032333333333334, 12.395999999999999, 30.732333333333337, 14.820999999999998, 40.72200000000001, 16.013666666666662, 31.464, 25.163666666666664, 16.284, 20.967000000000002, 19.811666666666667, 13.891999999999996, 22.18633333333333, 16.46, 31.181333333333342, 28.278333333333343, 32.35833333333334, 19.539999999999996, 43.01599999999999, 18.184999999999995, 27.94200000000001, 13.447999999999997, 21.81366666666667, 19.861666666666665, 23.76133333333333, 16.047333333333334, 13.180333333333332, 30.942999999999998, 17.713666666666665, 31.30366666666666, 18.065333333333335, 21.89599999999999, 30.793333333333326, 16.115000000000002, 19.220666666666663, 13.529000000000002, 20.385333333333328, 50.60800000000001, 19.564000000000004, 19.113999999999994, 20.314, 16.238333333333333, 19.371333333333332, 38.79833333333334, 24.72999999999999, 27.33466666666666, 22.971666666666657, 13.598666666666665, 37.80533333333334, 20.991666666666664, 15.449999999999996, 25.003000000000004, 28.850333333333342, 14.822999999999997, 30.675333333333327, 23.111999999999995, 37.51200000000002, 18.629666666666665, 24.351333333333322, 14.361999999999997, 32.740666666666655, 16.762999999999998, 20.12499999999999, 39.39400000000001, 16.217333333333332, 17.336000000000002, 40.540000000000006, 21.370333333333328, 31.803999999999995, 33.49400000000001, 23.197999999999997, 15.65433333333332, 27.58166666666667], "episode_lengths": [36, 32, 26, 50, 48, 21, 74, 51, 39, 58, 42, 33, 101, 47, 55, 83, 59, 70, 42, 62, 32, 33, 45, 56, 49, 35, 53, 68, 29, 59, 30, 86, 28, 53, 43, 36, 42, 39, 25, 37, 37, 69, 76, 71, 35, 76, 38, 55, 26, 53, 40, 40, 34, 28, 65, 43, 65, 41, 49, 77, 32, 42, 28, 43, 85, 43, 42, 37, 31, 55, 69, 50, 48, 52, 30, 96, 40, 31, 43, 49, 29, 57, 52, 82, 52, 49, 32, 62, 34, 49, 91, 33, 35, 72, 38, 51, 51, 39, 36, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7106745110661905, "mean_inference_ms": 2.9513257988664248, "mean_action_processing_ms": 0.6459503752210709, "mean_env_wait_ms": 0.1512222267166494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03230428695678711, "StateBufferConnector_ms": 0.014292240142822266, "ViewRequirementAgentConnector_ms": 0.5234284400939941}}, "episode_reward_max": 52.91766666666666, "episode_reward_min": 9.81733333333333, "episode_reward_mean": 24.10051333333333, "episode_len_mean": 48.69, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.10466666666666, 14.402666666666661, 13.805666666666665, 22.950000000000006, 25.86499999999999, 9.81733333333333, 40.67599999999999, 31.83933333333331, 24.84266666666667, 23.53166666666665, 18.206666666666656, 15.514000000000001, 52.91766666666666, 28.958666666666655, 31.81833333333333, 41.43033333333333, 29.014, 28.817999999999998, 18.698999999999998, 31.758333333333322, 15.572999999999999, 14.331333333333335, 23.094333333333317, 21.421666666666653, 28.28166666666666, 18.927666666666674, 20.50033333333333, 32.032333333333334, 12.395999999999999, 30.732333333333337, 14.820999999999998, 40.72200000000001, 16.013666666666662, 31.464, 25.163666666666664, 16.284, 20.967000000000002, 19.811666666666667, 13.891999999999996, 22.18633333333333, 16.46, 31.181333333333342, 28.278333333333343, 32.35833333333334, 19.539999999999996, 43.01599999999999, 18.184999999999995, 27.94200000000001, 13.447999999999997, 21.81366666666667, 19.861666666666665, 23.76133333333333, 16.047333333333334, 13.180333333333332, 30.942999999999998, 17.713666666666665, 31.30366666666666, 18.065333333333335, 21.89599999999999, 30.793333333333326, 16.115000000000002, 19.220666666666663, 13.529000000000002, 20.385333333333328, 50.60800000000001, 19.564000000000004, 19.113999999999994, 20.314, 16.238333333333333, 19.371333333333332, 38.79833333333334, 24.72999999999999, 27.33466666666666, 22.971666666666657, 13.598666666666665, 37.80533333333334, 20.991666666666664, 15.449999999999996, 25.003000000000004, 28.850333333333342, 14.822999999999997, 30.675333333333327, 23.111999999999995, 37.51200000000002, 18.629666666666665, 24.351333333333322, 14.361999999999997, 32.740666666666655, 16.762999999999998, 20.12499999999999, 39.39400000000001, 16.217333333333332, 17.336000000000002, 40.540000000000006, 21.370333333333328, 31.803999999999995, 33.49400000000001, 23.197999999999997, 15.65433333333332, 27.58166666666667], "episode_lengths": [36, 32, 26, 50, 48, 21, 74, 51, 39, 58, 42, 33, 101, 47, 55, 83, 59, 70, 42, 62, 32, 33, 45, 56, 49, 35, 53, 68, 29, 59, 30, 86, 28, 53, 43, 36, 42, 39, 25, 37, 37, 69, 76, 71, 35, 76, 38, 55, 26, 53, 40, 40, 34, 28, 65, 43, 65, 41, 49, 77, 32, 42, 28, 43, 85, 43, 42, 37, 31, 55, 69, 50, 48, 52, 30, 96, 40, 31, 43, 49, 29, 57, 52, 82, 52, 49, 32, 62, 34, 49, 91, 33, 35, 72, 38, 51, 51, 39, 36, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7106745110661905, "mean_inference_ms": 2.9513257988664248, "mean_action_processing_ms": 0.6459503752210709, "mean_env_wait_ms": 0.1512222267166494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03230428695678711, "StateBufferConnector_ms": 0.014292240142822266, "ViewRequirementAgentConnector_ms": 0.5234284400939941}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.24604229851633, "num_env_steps_trained_throughput_per_sec": 457.24604229851633, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 9456.049, "sample_time_ms": 3233.571, "load_time_ms": 0.826, "load_throughput": 4841133.184, "learn_time_ms": 6187.715, "learn_throughput": 646.442, "synch_weights_time_ms": 27.933}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 1204, "training_iteration": 9, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-47-05", "timestamp": 1701996425, "time_this_iter_s": 8.773044109344482, "time_total_s": 85.37550187110901, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.37550187110901, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 64.56666666666666, "ram_util_percent": 92.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.22499999403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 6.251138210296631, "policy_loss": -0.002770806895568967, "vf_loss": 6.252728462219238, "vf_explained_var": 0.6023803949356079, "kl": 0.005246286280453205, "entropy": 0.3089406192302704, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 55.086333333333336, "episode_reward_min": 11.062666666666665, "episode_reward_mean": 25.763236666666668, "episode_len_mean": 52.65, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.80533333333334, 20.991666666666664, 15.449999999999996, 25.003000000000004, 28.850333333333342, 14.822999999999997, 30.675333333333327, 23.111999999999995, 37.51200000000002, 18.629666666666665, 24.351333333333322, 14.361999999999997, 32.740666666666655, 16.762999999999998, 20.12499999999999, 39.39400000000001, 16.217333333333332, 17.336000000000002, 40.540000000000006, 21.370333333333328, 31.803999999999995, 33.49400000000001, 23.197999999999997, 15.65433333333332, 27.58166666666667, 14.732999999999997, 31.814999999999987, 25.520999999999997, 43.483, 39.00400000000002, 24.207000000000004, 39.72266666666665, 19.334333333333333, 15.862999999999998, 18.212999999999997, 22.47433333333333, 21.470333333333325, 15.240999999999994, 30.765000000000004, 11.950999999999997, 25.720999999999986, 14.912333333333333, 26.823666666666664, 25.02833333333332, 12.915, 28.267333333333347, 17.994333333333337, 43.402999999999984, 35.373666666666665, 40.57766666666667, 27.880333333333333, 23.841999999999985, 20.540666666666656, 36.99566666666666, 44.63166666666665, 11.062666666666665, 16.205000000000005, 24.15833333333332, 44.00766666666667, 28.116333333333344, 15.15233333333333, 41.64466666666665, 15.826999999999993, 24.52, 36.69133333333333, 46.29466666666668, 26.615999999999996, 41.50500000000001, 25.966333333333328, 11.967999999999998, 21.903666666666666, 55.086333333333336, 28.57433333333333, 21.39066666666666, 20.89066666666666, 28.125999999999998, 19.778333333333332, 30.41, 47.830666666666666, 16.462, 31.905333333333324, 15.139999999999993, 16.699333333333332, 21.466333333333324, 20.532333333333334, 16.752333333333333, 26.99233333333332, 17.283666666666665, 32.150000000000006, 17.287666666666667, 20.545333333333335, 18.732333333333333, 25.29466666666666, 35.908333333333324, 20.48566666666667, 20.42699999999999, 15.413666666666666, 17.416, 38.74199999999999, 20.472999999999995], "episode_lengths": [96, 40, 31, 43, 49, 29, 57, 52, 82, 52, 49, 32, 62, 34, 49, 91, 33, 35, 72, 38, 51, 51, 39, 36, 54, 32, 89, 42, 93, 75, 42, 73, 53, 36, 34, 63, 55, 31, 72, 24, 63, 31, 48, 60, 27, 53, 37, 73, 60, 96, 55, 43, 49, 80, 75, 21, 43, 58, 77, 70, 31, 88, 32, 47, 64, 91, 46, 80, 48, 23, 51, 94, 50, 40, 37, 67, 42, 69, 101, 31, 64, 31, 41, 43, 46, 33, 60, 34, 63, 36, 39, 34, 62, 80, 45, 40, 30, 32, 86, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7022873010116228, "mean_inference_ms": 2.934101081290229, "mean_action_processing_ms": 0.6424064622407315, "mean_env_wait_ms": 0.15205207966614825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02407526969909668, "StateBufferConnector_ms": 0.024311304092407227, "ViewRequirementAgentConnector_ms": 0.4877324104309082}}, "episode_reward_max": 55.086333333333336, "episode_reward_min": 11.062666666666665, "episode_reward_mean": 25.763236666666668, "episode_len_mean": 52.65, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.80533333333334, 20.991666666666664, 15.449999999999996, 25.003000000000004, 28.850333333333342, 14.822999999999997, 30.675333333333327, 23.111999999999995, 37.51200000000002, 18.629666666666665, 24.351333333333322, 14.361999999999997, 32.740666666666655, 16.762999999999998, 20.12499999999999, 39.39400000000001, 16.217333333333332, 17.336000000000002, 40.540000000000006, 21.370333333333328, 31.803999999999995, 33.49400000000001, 23.197999999999997, 15.65433333333332, 27.58166666666667, 14.732999999999997, 31.814999999999987, 25.520999999999997, 43.483, 39.00400000000002, 24.207000000000004, 39.72266666666665, 19.334333333333333, 15.862999999999998, 18.212999999999997, 22.47433333333333, 21.470333333333325, 15.240999999999994, 30.765000000000004, 11.950999999999997, 25.720999999999986, 14.912333333333333, 26.823666666666664, 25.02833333333332, 12.915, 28.267333333333347, 17.994333333333337, 43.402999999999984, 35.373666666666665, 40.57766666666667, 27.880333333333333, 23.841999999999985, 20.540666666666656, 36.99566666666666, 44.63166666666665, 11.062666666666665, 16.205000000000005, 24.15833333333332, 44.00766666666667, 28.116333333333344, 15.15233333333333, 41.64466666666665, 15.826999999999993, 24.52, 36.69133333333333, 46.29466666666668, 26.615999999999996, 41.50500000000001, 25.966333333333328, 11.967999999999998, 21.903666666666666, 55.086333333333336, 28.57433333333333, 21.39066666666666, 20.89066666666666, 28.125999999999998, 19.778333333333332, 30.41, 47.830666666666666, 16.462, 31.905333333333324, 15.139999999999993, 16.699333333333332, 21.466333333333324, 20.532333333333334, 16.752333333333333, 26.99233333333332, 17.283666666666665, 32.150000000000006, 17.287666666666667, 20.545333333333335, 18.732333333333333, 25.29466666666666, 35.908333333333324, 20.48566666666667, 20.42699999999999, 15.413666666666666, 17.416, 38.74199999999999, 20.472999999999995], "episode_lengths": [96, 40, 31, 43, 49, 29, 57, 52, 82, 52, 49, 32, 62, 34, 49, 91, 33, 35, 72, 38, 51, 51, 39, 36, 54, 32, 89, 42, 93, 75, 42, 73, 53, 36, 34, 63, 55, 31, 72, 24, 63, 31, 48, 60, 27, 53, 37, 73, 60, 96, 55, 43, 49, 80, 75, 21, 43, 58, 77, 70, 31, 88, 32, 47, 64, 91, 46, 80, 48, 23, 51, 94, 50, 40, 37, 67, 42, 69, 101, 31, 64, 31, 41, 43, 46, 33, 60, 34, 63, 36, 39, 34, 62, 80, 45, 40, 30, 32, 86, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7022873010116228, "mean_inference_ms": 2.934101081290229, "mean_action_processing_ms": 0.6424064622407315, "mean_env_wait_ms": 0.15205207966614825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02407526969909668, "StateBufferConnector_ms": 0.024311304092407227, "ViewRequirementAgentConnector_ms": 0.4877324104309082}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.25125739569006, "num_env_steps_trained_throughput_per_sec": 452.25125739569006, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 9394.808, "sample_time_ms": 3217.106, "load_time_ms": 0.844, "load_throughput": 4740397.83, "learn_time_ms": 6143.619, "learn_throughput": 651.082, "synch_weights_time_ms": 27.737}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 1279, "training_iteration": 10, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-47-14", "timestamp": 1701996434, "time_this_iter_s": 8.864585161209106, "time_total_s": 94.24008703231812, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.24008703231812, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 66.82307692307693, "ram_util_percent": 92.5923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.22499999403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 5.267096519470215, "policy_loss": -0.0017542862333357334, "vf_loss": 5.268462181091309, "vf_explained_var": 0.6006929278373718, "kl": 0.0017282671760767698, "entropy": 0.2694968581199646, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 56.953, "episode_reward_min": 12.39533333333333, "episode_reward_mean": 24.687106666666665, "episode_len_mean": 50.86, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.905333333333324, 15.139999999999993, 16.699333333333332, 21.466333333333324, 20.532333333333334, 16.752333333333333, 26.99233333333332, 17.283666666666665, 32.150000000000006, 17.287666666666667, 20.545333333333335, 18.732333333333333, 25.29466666666666, 35.908333333333324, 20.48566666666667, 20.42699999999999, 15.413666666666666, 17.416, 38.74199999999999, 20.472999999999995, 33.38, 15.167000000000002, 16.82733333333333, 20.728999999999992, 31.149999999999995, 18.11833333333333, 17.932999999999996, 18.250000000000004, 30.138666666666662, 28.10166666666666, 19.209, 35.13899999999999, 23.319333333333322, 19.371999999999986, 14.929666666666664, 43.128333333333345, 26.92033333333332, 17.362999999999992, 19.679000000000002, 31.855000000000004, 25.122000000000007, 18.803333333333327, 17.954999999999995, 25.925666666666658, 28.763999999999996, 25.128, 17.278999999999993, 20.501, 46.72700000000002, 21.76033333333332, 50.172, 36.170333333333346, 27.45566666666665, 24.50466666666667, 22.624333333333325, 14.050666666666666, 16.27766666666666, 18.270333333333333, 17.38933333333333, 49.09166666666664, 25.132333333333335, 16.452666666666662, 17.587333333333323, 17.74, 19.377666666666663, 54.96133333333333, 21.229666666666663, 22.00166666666666, 18.82533333333333, 41.782333333333334, 39.81266666666669, 33.203333333333326, 18.859333333333332, 18.95966666666666, 28.375666666666675, 12.39533333333333, 19.79933333333333, 56.953, 25.59499999999999, 32.03499999999998, 16.77133333333333, 26.46999999999998, 39.80866666666667, 16.767, 19.995666666666665, 18.34099999999999, 18.228999999999992, 16.252666666666666, 34.97133333333334, 13.86233333333333, 26.358333333333334, 17.60366666666666, 23.078, 22.80366666666666, 21.719666666666658, 46.85866666666668, 18.99033333333333, 23.967666666666673, 29.76799999999998, 20.685999999999996], "episode_lengths": [64, 31, 41, 43, 46, 33, 60, 34, 63, 36, 39, 34, 62, 80, 45, 40, 30, 32, 86, 44, 66, 29, 33, 45, 68, 40, 36, 39, 72, 65, 54, 64, 49, 50, 34, 72, 52, 34, 38, 60, 48, 37, 32, 50, 55, 59, 36, 40, 78, 54, 109, 67, 88, 49, 41, 28, 32, 40, 31, 83, 50, 32, 37, 45, 46, 93, 44, 60, 51, 111, 61, 67, 37, 38, 48, 26, 53, 85, 55, 70, 38, 55, 76, 36, 44, 36, 33, 31, 69, 34, 52, 42, 49, 55, 42, 93, 40, 52, 64, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6970098817794814, "mean_inference_ms": 2.9160127722597156, "mean_action_processing_ms": 0.6471028273790108, "mean_env_wait_ms": 0.15083280636355248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025404930114746094, "StateBufferConnector_ms": 0.021487951278686523, "ViewRequirementAgentConnector_ms": 0.5014321804046631}}, "episode_reward_max": 56.953, "episode_reward_min": 12.39533333333333, "episode_reward_mean": 24.687106666666665, "episode_len_mean": 50.86, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.905333333333324, 15.139999999999993, 16.699333333333332, 21.466333333333324, 20.532333333333334, 16.752333333333333, 26.99233333333332, 17.283666666666665, 32.150000000000006, 17.287666666666667, 20.545333333333335, 18.732333333333333, 25.29466666666666, 35.908333333333324, 20.48566666666667, 20.42699999999999, 15.413666666666666, 17.416, 38.74199999999999, 20.472999999999995, 33.38, 15.167000000000002, 16.82733333333333, 20.728999999999992, 31.149999999999995, 18.11833333333333, 17.932999999999996, 18.250000000000004, 30.138666666666662, 28.10166666666666, 19.209, 35.13899999999999, 23.319333333333322, 19.371999999999986, 14.929666666666664, 43.128333333333345, 26.92033333333332, 17.362999999999992, 19.679000000000002, 31.855000000000004, 25.122000000000007, 18.803333333333327, 17.954999999999995, 25.925666666666658, 28.763999999999996, 25.128, 17.278999999999993, 20.501, 46.72700000000002, 21.76033333333332, 50.172, 36.170333333333346, 27.45566666666665, 24.50466666666667, 22.624333333333325, 14.050666666666666, 16.27766666666666, 18.270333333333333, 17.38933333333333, 49.09166666666664, 25.132333333333335, 16.452666666666662, 17.587333333333323, 17.74, 19.377666666666663, 54.96133333333333, 21.229666666666663, 22.00166666666666, 18.82533333333333, 41.782333333333334, 39.81266666666669, 33.203333333333326, 18.859333333333332, 18.95966666666666, 28.375666666666675, 12.39533333333333, 19.79933333333333, 56.953, 25.59499999999999, 32.03499999999998, 16.77133333333333, 26.46999999999998, 39.80866666666667, 16.767, 19.995666666666665, 18.34099999999999, 18.228999999999992, 16.252666666666666, 34.97133333333334, 13.86233333333333, 26.358333333333334, 17.60366666666666, 23.078, 22.80366666666666, 21.719666666666658, 46.85866666666668, 18.99033333333333, 23.967666666666673, 29.76799999999998, 20.685999999999996], "episode_lengths": [64, 31, 41, 43, 46, 33, 60, 34, 63, 36, 39, 34, 62, 80, 45, 40, 30, 32, 86, 44, 66, 29, 33, 45, 68, 40, 36, 39, 72, 65, 54, 64, 49, 50, 34, 72, 52, 34, 38, 60, 48, 37, 32, 50, 55, 59, 36, 40, 78, 54, 109, 67, 88, 49, 41, 28, 32, 40, 31, 83, 50, 32, 37, 45, 46, 93, 44, 60, 51, 111, 61, 67, 37, 38, 48, 26, 53, 85, 55, 70, 38, 55, 76, 36, 44, 36, 33, 31, 69, 34, 52, 42, 49, 55, 42, 93, 40, 52, 64, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6970098817794814, "mean_inference_ms": 2.9160127722597156, "mean_action_processing_ms": 0.6471028273790108, "mean_env_wait_ms": 0.15083280636355248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025404930114746094, "StateBufferConnector_ms": 0.021487951278686523, "ViewRequirementAgentConnector_ms": 0.5014321804046631}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.14308425852306, "num_env_steps_trained_throughput_per_sec": 448.14308425852306, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 9377.104, "sample_time_ms": 3220.155, "load_time_ms": 0.843, "load_throughput": 4744151.114, "learn_time_ms": 6125.066, "learn_throughput": 653.054, "synch_weights_time_ms": 26.029}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 1359, "training_iteration": 11, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-47-23", "timestamp": 1701996443, "time_this_iter_s": 8.952716588973999, "time_total_s": 103.19280362129211, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 103.19280362129211, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 68.03333333333333, "ram_util_percent": 93.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 5.335543632507324, "policy_loss": -0.009018192067742348, "vf_loss": 5.344266414642334, "vf_explained_var": 0.6562268733978271, "kl": 0.002629483351483941, "entropy": 0.2320026159286499, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 56.953, "episode_reward_min": 12.39533333333333, "episode_reward_mean": 24.701029999999996, "episode_len_mean": 52.43, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.95966666666666, 28.375666666666675, 12.39533333333333, 19.79933333333333, 56.953, 25.59499999999999, 32.03499999999998, 16.77133333333333, 26.46999999999998, 39.80866666666667, 16.767, 19.995666666666665, 18.34099999999999, 18.228999999999992, 16.252666666666666, 34.97133333333334, 13.86233333333333, 26.358333333333334, 17.60366666666666, 23.078, 22.80366666666666, 21.719666666666658, 46.85866666666668, 18.99033333333333, 23.967666666666673, 29.76799999999998, 20.685999999999996, 35.717999999999975, 16.10566666666666, 16.55933333333333, 18.24066666666666, 38.95233333333333, 18.552333333333326, 15.828999999999995, 26.87166666666667, 16.55733333333333, 41.26499999999997, 18.131666666666653, 15.78466666666666, 26.293, 28.369333333333323, 45.381, 18.01, 15.829999999999998, 19.606, 19.13599999999999, 16.836333333333325, 25.78566666666666, 32.22033333333333, 19.21433333333333, 18.886000000000006, 22.102999999999987, 25.558, 41.66066666666664, 46.110666666666674, 28.30133333333334, 17.569999999999993, 22.385333333333335, 16.25166666666666, 41.065333333333335, 20.522333333333325, 19.12366666666667, 34.202666666666644, 37.38799999999999, 15.117999999999997, 19.286333333333328, 17.73866666666666, 19.26233333333333, 13.780999999999999, 28.529333333333334, 33.34033333333335, 24.56533333333333, 16.962, 20.79366666666666, 15.099333333333329, 21.214333333333332, 31.700333333333322, 43.79100000000001, 25.634333333333316, 19.839999999999996, 20.122999999999998, 28.907666666666664, 16.46366666666666, 19.60233333333332, 23.108666666666668, 14.632333333333332, 29.36766666666666, 24.729999999999993, 15.385999999999996, 22.466333333333324, 28.727999999999994, 27.188666666666666, 43.72966666666667, 16.642, 36.00366666666666, 18.346666666666668, 36.52099999999999, 35.97499999999999, 20.32099999999999, 21.409], "episode_lengths": [38, 48, 26, 53, 85, 55, 70, 38, 55, 76, 36, 44, 36, 33, 31, 69, 34, 52, 42, 49, 55, 42, 93, 40, 52, 64, 36, 66, 44, 31, 37, 73, 38, 36, 57, 33, 80, 40, 39, 63, 67, 112, 35, 33, 45, 55, 32, 48, 68, 34, 45, 62, 61, 89, 109, 71, 37, 45, 32, 77, 44, 40, 61, 89, 34, 40, 43, 38, 30, 51, 71, 64, 38, 64, 31, 40, 67, 90, 72, 43, 40, 56, 43, 48, 53, 28, 65, 57, 31, 54, 49, 45, 91, 40, 82, 32, 75, 62, 46, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6832551055517206, "mean_inference_ms": 2.900826127323387, "mean_action_processing_ms": 0.6434740569072792, "mean_env_wait_ms": 0.15061352412092746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02840423583984375, "StateBufferConnector_ms": 0.020792722702026367, "ViewRequirementAgentConnector_ms": 0.5114006996154785}}, "episode_reward_max": 56.953, "episode_reward_min": 12.39533333333333, "episode_reward_mean": 24.701029999999996, "episode_len_mean": 52.43, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.95966666666666, 28.375666666666675, 12.39533333333333, 19.79933333333333, 56.953, 25.59499999999999, 32.03499999999998, 16.77133333333333, 26.46999999999998, 39.80866666666667, 16.767, 19.995666666666665, 18.34099999999999, 18.228999999999992, 16.252666666666666, 34.97133333333334, 13.86233333333333, 26.358333333333334, 17.60366666666666, 23.078, 22.80366666666666, 21.719666666666658, 46.85866666666668, 18.99033333333333, 23.967666666666673, 29.76799999999998, 20.685999999999996, 35.717999999999975, 16.10566666666666, 16.55933333333333, 18.24066666666666, 38.95233333333333, 18.552333333333326, 15.828999999999995, 26.87166666666667, 16.55733333333333, 41.26499999999997, 18.131666666666653, 15.78466666666666, 26.293, 28.369333333333323, 45.381, 18.01, 15.829999999999998, 19.606, 19.13599999999999, 16.836333333333325, 25.78566666666666, 32.22033333333333, 19.21433333333333, 18.886000000000006, 22.102999999999987, 25.558, 41.66066666666664, 46.110666666666674, 28.30133333333334, 17.569999999999993, 22.385333333333335, 16.25166666666666, 41.065333333333335, 20.522333333333325, 19.12366666666667, 34.202666666666644, 37.38799999999999, 15.117999999999997, 19.286333333333328, 17.73866666666666, 19.26233333333333, 13.780999999999999, 28.529333333333334, 33.34033333333335, 24.56533333333333, 16.962, 20.79366666666666, 15.099333333333329, 21.214333333333332, 31.700333333333322, 43.79100000000001, 25.634333333333316, 19.839999999999996, 20.122999999999998, 28.907666666666664, 16.46366666666666, 19.60233333333332, 23.108666666666668, 14.632333333333332, 29.36766666666666, 24.729999999999993, 15.385999999999996, 22.466333333333324, 28.727999999999994, 27.188666666666666, 43.72966666666667, 16.642, 36.00366666666666, 18.346666666666668, 36.52099999999999, 35.97499999999999, 20.32099999999999, 21.409], "episode_lengths": [38, 48, 26, 53, 85, 55, 70, 38, 55, 76, 36, 44, 36, 33, 31, 69, 34, 52, 42, 49, 55, 42, 93, 40, 52, 64, 36, 66, 44, 31, 37, 73, 38, 36, 57, 33, 80, 40, 39, 63, 67, 112, 35, 33, 45, 55, 32, 48, 68, 34, 45, 62, 61, 89, 109, 71, 37, 45, 32, 77, 44, 40, 61, 89, 34, 40, 43, 38, 30, 51, 71, 64, 38, 64, 31, 40, 67, 90, 72, 43, 40, 56, 43, 48, 53, 28, 65, 57, 31, 54, 49, 45, 91, 40, 82, 32, 75, 62, 46, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6832551055517206, "mean_inference_ms": 2.900826127323387, "mean_action_processing_ms": 0.6434740569072792, "mean_env_wait_ms": 0.15061352412092746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02840423583984375, "StateBufferConnector_ms": 0.020792722702026367, "ViewRequirementAgentConnector_ms": 0.5114006996154785}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.87463269438126, "num_env_steps_trained_throughput_per_sec": 462.87463269438126, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 8964.267, "sample_time_ms": 3154.029, "load_time_ms": 0.843, "load_throughput": 4744151.114, "learn_time_ms": 5781.357, "learn_throughput": 691.879, "synch_weights_time_ms": 25.946}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 1432, "training_iteration": 12, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-47-31", "timestamp": 1701996451, "time_this_iter_s": 8.662353754043579, "time_total_s": 111.8551573753357, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 111.8551573753357, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 71.425, "ram_util_percent": 93.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05624999850988388, "cur_lr": 4.999999873689376e-05, "total_loss": 5.806033611297607, "policy_loss": -0.00836536567658186, "vf_loss": 5.8143181800842285, "vf_explained_var": 0.5691256523132324, "kl": 0.0014398448402062058, "entropy": 0.19775785505771637, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 69.15666666666674, "episode_reward_min": 13.711, "episode_reward_mean": 27.681763333333333, "episode_len_mean": 58.36, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.117999999999997, 19.286333333333328, 17.73866666666666, 19.26233333333333, 13.780999999999999, 28.529333333333334, 33.34033333333335, 24.56533333333333, 16.962, 20.79366666666666, 15.099333333333329, 21.214333333333332, 31.700333333333322, 43.79100000000001, 25.634333333333316, 19.839999999999996, 20.122999999999998, 28.907666666666664, 16.46366666666666, 19.60233333333332, 23.108666666666668, 14.632333333333332, 29.36766666666666, 24.729999999999993, 15.385999999999996, 22.466333333333324, 28.727999999999994, 27.188666666666666, 43.72966666666667, 16.642, 36.00366666666666, 18.346666666666668, 36.52099999999999, 35.97499999999999, 20.32099999999999, 21.409, 20.541666666666664, 22.394999999999992, 22.733000000000004, 47.83700000000001, 44.71133333333331, 24.83466666666666, 32.464999999999996, 23.292333333333318, 50.859666666666655, 22.931999999999977, 26.793333333333326, 55.922666666666686, 19.42266666666667, 14.400666666666664, 22.354666666666663, 22.926333333333318, 34.40666666666667, 30.508000000000006, 18.36566666666666, 40.89866666666668, 41.776999999999965, 22.690333333333335, 28.184000000000008, 20.325333333333337, 23.597000000000005, 33.44, 61.15633333333336, 69.15666666666674, 20.02, 27.93766666666666, 24.843666666666667, 23.241, 43.566, 34.91366666666665, 39.27700000000002, 17.249666666666666, 13.711, 19.21366666666666, 22.368333333333332, 27.12233333333332, 29.636000000000006, 20.192666666666668, 20.803333333333338, 20.37233333333333, 18.916999999999994, 46.32533333333335, 37.596, 28.843333333333334, 16.38199999999999, 23.746, 32.20366666666668, 27.70666666666666, 25.15466666666667, 14.434666666666663, 20.644666666666666, 25.14866666666665, 40.21533333333331, 19.990666666666662, 51.316000000000024, 18.681666666666654, 22.326666666666664, 48.03033333333332, 21.139333333333326, 59.669000000000004], "episode_lengths": [34, 40, 43, 38, 30, 51, 71, 64, 38, 64, 31, 40, 67, 90, 72, 43, 40, 56, 43, 48, 53, 28, 65, 57, 31, 54, 49, 45, 91, 40, 82, 32, 75, 62, 46, 50, 45, 74, 44, 81, 93, 77, 66, 70, 91, 63, 62, 93, 48, 30, 53, 59, 75, 55, 50, 85, 115, 43, 53, 43, 48, 55, 123, 113, 44, 52, 53, 44, 82, 58, 67, 42, 30, 40, 51, 64, 70, 51, 47, 42, 43, 108, 85, 55, 33, 56, 58, 55, 60, 26, 42, 58, 79, 40, 114, 42, 45, 77, 50, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6777754860650256, "mean_inference_ms": 2.8825714321399287, "mean_action_processing_ms": 0.6390705705216572, "mean_env_wait_ms": 0.14920893357516937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026511430740356445, "StateBufferConnector_ms": 0.017148256301879883, "ViewRequirementAgentConnector_ms": 0.525768518447876}}, "episode_reward_max": 69.15666666666674, "episode_reward_min": 13.711, "episode_reward_mean": 27.681763333333333, "episode_len_mean": 58.36, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.117999999999997, 19.286333333333328, 17.73866666666666, 19.26233333333333, 13.780999999999999, 28.529333333333334, 33.34033333333335, 24.56533333333333, 16.962, 20.79366666666666, 15.099333333333329, 21.214333333333332, 31.700333333333322, 43.79100000000001, 25.634333333333316, 19.839999999999996, 20.122999999999998, 28.907666666666664, 16.46366666666666, 19.60233333333332, 23.108666666666668, 14.632333333333332, 29.36766666666666, 24.729999999999993, 15.385999999999996, 22.466333333333324, 28.727999999999994, 27.188666666666666, 43.72966666666667, 16.642, 36.00366666666666, 18.346666666666668, 36.52099999999999, 35.97499999999999, 20.32099999999999, 21.409, 20.541666666666664, 22.394999999999992, 22.733000000000004, 47.83700000000001, 44.71133333333331, 24.83466666666666, 32.464999999999996, 23.292333333333318, 50.859666666666655, 22.931999999999977, 26.793333333333326, 55.922666666666686, 19.42266666666667, 14.400666666666664, 22.354666666666663, 22.926333333333318, 34.40666666666667, 30.508000000000006, 18.36566666666666, 40.89866666666668, 41.776999999999965, 22.690333333333335, 28.184000000000008, 20.325333333333337, 23.597000000000005, 33.44, 61.15633333333336, 69.15666666666674, 20.02, 27.93766666666666, 24.843666666666667, 23.241, 43.566, 34.91366666666665, 39.27700000000002, 17.249666666666666, 13.711, 19.21366666666666, 22.368333333333332, 27.12233333333332, 29.636000000000006, 20.192666666666668, 20.803333333333338, 20.37233333333333, 18.916999999999994, 46.32533333333335, 37.596, 28.843333333333334, 16.38199999999999, 23.746, 32.20366666666668, 27.70666666666666, 25.15466666666667, 14.434666666666663, 20.644666666666666, 25.14866666666665, 40.21533333333331, 19.990666666666662, 51.316000000000024, 18.681666666666654, 22.326666666666664, 48.03033333333332, 21.139333333333326, 59.669000000000004], "episode_lengths": [34, 40, 43, 38, 30, 51, 71, 64, 38, 64, 31, 40, 67, 90, 72, 43, 40, 56, 43, 48, 53, 28, 65, 57, 31, 54, 49, 45, 91, 40, 82, 32, 75, 62, 46, 50, 45, 74, 44, 81, 93, 77, 66, 70, 91, 63, 62, 93, 48, 30, 53, 59, 75, 55, 50, 85, 115, 43, 53, 43, 48, 55, 123, 113, 44, 52, 53, 44, 82, 58, 67, 42, 30, 40, 51, 64, 70, 51, 47, 42, 43, 108, 85, 55, 33, 56, 58, 55, 60, 26, 42, 58, 79, 40, 114, 42, 45, 77, 50, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6777754860650256, "mean_inference_ms": 2.8825714321399287, "mean_action_processing_ms": 0.6390705705216572, "mean_env_wait_ms": 0.14920893357516937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026511430740356445, "StateBufferConnector_ms": 0.017148256301879883, "ViewRequirementAgentConnector_ms": 0.525768518447876}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.25700264318596, "num_env_steps_trained_throughput_per_sec": 460.25700264318596, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 8902.411, "sample_time_ms": 3119.426, "load_time_ms": 0.943, "load_throughput": 4240740.104, "learn_time_ms": 5753.962, "learn_throughput": 695.173, "synch_weights_time_ms": 25.96}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 1496, "training_iteration": 13, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-47-40", "timestamp": 1701996460, "time_this_iter_s": 8.711563348770142, "time_total_s": 120.56672072410583, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 120.56672072410583, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 64.56666666666668, "ram_util_percent": 93.61666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02812499925494194, "cur_lr": 4.999999873689376e-05, "total_loss": 5.77148962020874, "policy_loss": -0.003734608180820942, "vf_loss": 5.77517557144165, "vf_explained_var": 0.5822086930274963, "kl": 0.001755272620357573, "entropy": 0.1681869775056839, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 65.38866666666674, "episode_reward_min": 13.711, "episode_reward_mean": 27.958529999999996, "episode_len_mean": 57.48, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.91366666666665, 39.27700000000002, 17.249666666666666, 13.711, 19.21366666666666, 22.368333333333332, 27.12233333333332, 29.636000000000006, 20.192666666666668, 20.803333333333338, 20.37233333333333, 18.916999999999994, 46.32533333333335, 37.596, 28.843333333333334, 16.38199999999999, 23.746, 32.20366666666668, 27.70666666666666, 25.15466666666667, 14.434666666666663, 20.644666666666666, 25.14866666666665, 40.21533333333331, 19.990666666666662, 51.316000000000024, 18.681666666666654, 22.326666666666664, 48.03033333333332, 21.139333333333326, 59.669000000000004, 46.08600000000003, 17.299333333333326, 19.40366666666667, 58.84866666666667, 29.836666666666652, 26.758999999999997, 30.47000000000001, 27.54399999999998, 16.265999999999995, 16.631666666666657, 14.94166666666666, 30.644333333333346, 15.158999999999999, 19.63799999999999, 35.649000000000015, 29.419, 65.38866666666674, 20.371999999999993, 16.561999999999998, 33.725666666666655, 17.690333333333328, 33.91933333333335, 29.48233333333333, 17.49299999999999, 25.843666666666664, 20.755999999999986, 27.83366666666666, 31.37566666666665, 16.442999999999998, 17.71966666666666, 47.275999999999996, 25.847999999999995, 33.806999999999974, 39.08033333333333, 22.739666666666665, 21.642333333333333, 22.820999999999998, 24.713999999999995, 51.73666666666667, 26.336333333333325, 25.462666666666657, 38.31866666666668, 22.155666666666658, 20.789999999999996, 18.18633333333333, 27.17233333333332, 19.988333333333326, 50.51666666666666, 30.85766666666667, 37.316333333333326, 44.79699999999999, 21.496666666666652, 39.20333333333334, 25.004333333333317, 14.745666666666667, 33.11666666666667, 52.92566666666667, 14.714999999999993, 25.214666666666652, 31.327666666666662, 37.332999999999984, 26.33133333333333, 39.58666666666667, 15.253666666666659, 24.499000000000002, 22.645666666666656, 15.296999999999997, 16.53833333333333, 16.522999999999993], "episode_lengths": [58, 67, 42, 30, 40, 51, 64, 70, 51, 47, 42, 43, 108, 85, 55, 33, 56, 58, 55, 60, 26, 42, 58, 79, 40, 114, 42, 45, 77, 50, 103, 74, 41, 40, 99, 66, 53, 47, 78, 31, 32, 32, 52, 28, 57, 58, 58, 131, 51, 33, 59, 38, 55, 65, 34, 44, 47, 68, 66, 34, 49, 91, 62, 88, 73, 44, 53, 56, 59, 90, 72, 72, 71, 49, 45, 36, 58, 40, 110, 56, 80, 94, 59, 77, 62, 32, 63, 86, 32, 46, 59, 67, 58, 65, 29, 51, 48, 33, 32, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6690539309824572, "mean_inference_ms": 2.869766976694005, "mean_action_processing_ms": 0.6391329524355416, "mean_env_wait_ms": 0.14926760442987697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026170969009399414, "StateBufferConnector_ms": 0.018747568130493164, "ViewRequirementAgentConnector_ms": 0.5124514102935791}}, "episode_reward_max": 65.38866666666674, "episode_reward_min": 13.711, "episode_reward_mean": 27.958529999999996, "episode_len_mean": 57.48, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.91366666666665, 39.27700000000002, 17.249666666666666, 13.711, 19.21366666666666, 22.368333333333332, 27.12233333333332, 29.636000000000006, 20.192666666666668, 20.803333333333338, 20.37233333333333, 18.916999999999994, 46.32533333333335, 37.596, 28.843333333333334, 16.38199999999999, 23.746, 32.20366666666668, 27.70666666666666, 25.15466666666667, 14.434666666666663, 20.644666666666666, 25.14866666666665, 40.21533333333331, 19.990666666666662, 51.316000000000024, 18.681666666666654, 22.326666666666664, 48.03033333333332, 21.139333333333326, 59.669000000000004, 46.08600000000003, 17.299333333333326, 19.40366666666667, 58.84866666666667, 29.836666666666652, 26.758999999999997, 30.47000000000001, 27.54399999999998, 16.265999999999995, 16.631666666666657, 14.94166666666666, 30.644333333333346, 15.158999999999999, 19.63799999999999, 35.649000000000015, 29.419, 65.38866666666674, 20.371999999999993, 16.561999999999998, 33.725666666666655, 17.690333333333328, 33.91933333333335, 29.48233333333333, 17.49299999999999, 25.843666666666664, 20.755999999999986, 27.83366666666666, 31.37566666666665, 16.442999999999998, 17.71966666666666, 47.275999999999996, 25.847999999999995, 33.806999999999974, 39.08033333333333, 22.739666666666665, 21.642333333333333, 22.820999999999998, 24.713999999999995, 51.73666666666667, 26.336333333333325, 25.462666666666657, 38.31866666666668, 22.155666666666658, 20.789999999999996, 18.18633333333333, 27.17233333333332, 19.988333333333326, 50.51666666666666, 30.85766666666667, 37.316333333333326, 44.79699999999999, 21.496666666666652, 39.20333333333334, 25.004333333333317, 14.745666666666667, 33.11666666666667, 52.92566666666667, 14.714999999999993, 25.214666666666652, 31.327666666666662, 37.332999999999984, 26.33133333333333, 39.58666666666667, 15.253666666666659, 24.499000000000002, 22.645666666666656, 15.296999999999997, 16.53833333333333, 16.522999999999993], "episode_lengths": [58, 67, 42, 30, 40, 51, 64, 70, 51, 47, 42, 43, 108, 85, 55, 33, 56, 58, 55, 60, 26, 42, 58, 79, 40, 114, 42, 45, 77, 50, 103, 74, 41, 40, 99, 66, 53, 47, 78, 31, 32, 32, 52, 28, 57, 58, 58, 131, 51, 33, 59, 38, 55, 65, 34, 44, 47, 68, 66, 34, 49, 91, 62, 88, 73, 44, 53, 56, 59, 90, 72, 72, 71, 49, 45, 36, 58, 40, 110, 56, 80, 94, 59, 77, 62, 32, 63, 86, 32, 46, 59, 67, 58, 65, 29, 51, 48, 33, 32, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6690539309824572, "mean_inference_ms": 2.869766976694005, "mean_action_processing_ms": 0.6391329524355416, "mean_env_wait_ms": 0.14926760442987697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026170969009399414, "StateBufferConnector_ms": 0.018747568130493164, "ViewRequirementAgentConnector_ms": 0.5124514102935791}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.3229658145113, "num_env_steps_trained_throughput_per_sec": 448.3229658145113, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 8896.39, "sample_time_ms": 3073.615, "load_time_ms": 0.949, "load_throughput": 4213369.497, "learn_time_ms": 5793.354, "learn_throughput": 690.446, "synch_weights_time_ms": 26.357}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 1565, "training_iteration": 14, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-47-49", "timestamp": 1701996469, "time_this_iter_s": 8.94216775894165, "time_total_s": 129.50888848304749, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 129.50888848304749, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 65.37692307692308, "ram_util_percent": 94.04615384615383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 5.784660816192627, "policy_loss": -0.0010712973307818174, "vf_loss": 5.785708904266357, "vf_explained_var": 0.6027407050132751, "kl": 0.0015914924442768097, "entropy": 0.14456148445606232, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 57.79266666666663, "episode_reward_min": 12.179999999999998, "episode_reward_mean": 27.126739999999998, "episode_len_mean": 56.0, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.789999999999996, 18.18633333333333, 27.17233333333332, 19.988333333333326, 50.51666666666666, 30.85766666666667, 37.316333333333326, 44.79699999999999, 21.496666666666652, 39.20333333333334, 25.004333333333317, 14.745666666666667, 33.11666666666667, 52.92566666666667, 14.714999999999993, 25.214666666666652, 31.327666666666662, 37.332999999999984, 26.33133333333333, 39.58666666666667, 15.253666666666659, 24.499000000000002, 22.645666666666656, 15.296999999999997, 16.53833333333333, 16.522999999999993, 17.83899999999999, 50.295000000000016, 19.953666666666663, 16.54466666666666, 21.999333333333322, 30.08499999999998, 22.86299999999999, 16.229333333333326, 40.55899999999999, 34.344333333333324, 17.61833333333333, 33.99599999999999, 15.867333333333331, 25.566999999999997, 29.941, 32.94566666666665, 15.100666666666662, 28.862000000000005, 33.537, 23.703000000000007, 21.623333333333328, 33.45366666666666, 32.81966666666665, 19.315999999999992, 18.837666666666667, 22.918000000000003, 20.328333333333326, 18.110666666666663, 15.028333333333332, 53.01833333333333, 18.910999999999987, 15.442999999999996, 46.4416666666667, 19.339666666666663, 31.26733333333334, 22.196999999999996, 33.994666666666674, 18.480333333333324, 29.98833333333333, 40.637, 21.905999999999995, 38.13866666666667, 15.200333333333324, 42.13800000000001, 18.732999999999997, 15.795, 36.165000000000006, 20.072333333333322, 41.61233333333333, 12.179999999999998, 24.78566666666668, 16.590666666666664, 14.116666666666662, 31.349333333333306, 18.573666666666657, 33.045, 29.09666666666666, 30.402000000000005, 27.98899999999999, 35.13899999999999, 16.053666666666658, 36.9143333333333, 19.896999999999988, 14.087666666666665, 17.30133333333333, 33.30633333333332, 50.341999999999985, 57.79266666666663, 22.511999999999997, 26.00200000000001, 18.514666666666663, 28.157000000000007, 47.096333333333355, 20.282333333333327], "episode_lengths": [45, 36, 58, 40, 110, 56, 80, 94, 59, 77, 62, 32, 63, 86, 32, 46, 59, 67, 58, 65, 29, 51, 48, 33, 32, 39, 36, 100, 40, 31, 41, 72, 54, 38, 84, 62, 35, 97, 33, 64, 50, 78, 33, 63, 68, 49, 43, 70, 74, 45, 40, 39, 41, 36, 28, 93, 43, 34, 75, 45, 59, 62, 69, 39, 72, 68, 51, 94, 28, 91, 39, 32, 73, 43, 73, 25, 46, 35, 31, 75, 38, 62, 47, 57, 48, 78, 34, 101, 59, 26, 41, 60, 109, 114, 55, 55, 39, 58, 84, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6600873051611829, "mean_inference_ms": 2.8581553310853742, "mean_action_processing_ms": 0.6380139389176993, "mean_env_wait_ms": 0.14928101652170045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021542072296142578, "StateBufferConnector_ms": 0.01968073844909668, "ViewRequirementAgentConnector_ms": 0.4996469020843506}}, "episode_reward_max": 57.79266666666663, "episode_reward_min": 12.179999999999998, "episode_reward_mean": 27.126739999999998, "episode_len_mean": 56.0, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.789999999999996, 18.18633333333333, 27.17233333333332, 19.988333333333326, 50.51666666666666, 30.85766666666667, 37.316333333333326, 44.79699999999999, 21.496666666666652, 39.20333333333334, 25.004333333333317, 14.745666666666667, 33.11666666666667, 52.92566666666667, 14.714999999999993, 25.214666666666652, 31.327666666666662, 37.332999999999984, 26.33133333333333, 39.58666666666667, 15.253666666666659, 24.499000000000002, 22.645666666666656, 15.296999999999997, 16.53833333333333, 16.522999999999993, 17.83899999999999, 50.295000000000016, 19.953666666666663, 16.54466666666666, 21.999333333333322, 30.08499999999998, 22.86299999999999, 16.229333333333326, 40.55899999999999, 34.344333333333324, 17.61833333333333, 33.99599999999999, 15.867333333333331, 25.566999999999997, 29.941, 32.94566666666665, 15.100666666666662, 28.862000000000005, 33.537, 23.703000000000007, 21.623333333333328, 33.45366666666666, 32.81966666666665, 19.315999999999992, 18.837666666666667, 22.918000000000003, 20.328333333333326, 18.110666666666663, 15.028333333333332, 53.01833333333333, 18.910999999999987, 15.442999999999996, 46.4416666666667, 19.339666666666663, 31.26733333333334, 22.196999999999996, 33.994666666666674, 18.480333333333324, 29.98833333333333, 40.637, 21.905999999999995, 38.13866666666667, 15.200333333333324, 42.13800000000001, 18.732999999999997, 15.795, 36.165000000000006, 20.072333333333322, 41.61233333333333, 12.179999999999998, 24.78566666666668, 16.590666666666664, 14.116666666666662, 31.349333333333306, 18.573666666666657, 33.045, 29.09666666666666, 30.402000000000005, 27.98899999999999, 35.13899999999999, 16.053666666666658, 36.9143333333333, 19.896999999999988, 14.087666666666665, 17.30133333333333, 33.30633333333332, 50.341999999999985, 57.79266666666663, 22.511999999999997, 26.00200000000001, 18.514666666666663, 28.157000000000007, 47.096333333333355, 20.282333333333327], "episode_lengths": [45, 36, 58, 40, 110, 56, 80, 94, 59, 77, 62, 32, 63, 86, 32, 46, 59, 67, 58, 65, 29, 51, 48, 33, 32, 39, 36, 100, 40, 31, 41, 72, 54, 38, 84, 62, 35, 97, 33, 64, 50, 78, 33, 63, 68, 49, 43, 70, 74, 45, 40, 39, 41, 36, 28, 93, 43, 34, 75, 45, 59, 62, 69, 39, 72, 68, 51, 94, 28, 91, 39, 32, 73, 43, 73, 25, 46, 35, 31, 75, 38, 62, 47, 57, 48, 78, 34, 101, 59, 26, 41, 60, 109, 114, 55, 55, 39, 58, 84, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6600873051611829, "mean_inference_ms": 2.8581553310853742, "mean_action_processing_ms": 0.6380139389176993, "mean_env_wait_ms": 0.14928101652170045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021542072296142578, "StateBufferConnector_ms": 0.01968073844909668, "ViewRequirementAgentConnector_ms": 0.4996469020843506}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.6585353580798, "num_env_steps_trained_throughput_per_sec": 452.6585353580798, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 8889.207, "sample_time_ms": 3028.652, "load_time_ms": 0.799, "load_throughput": 5003643.305, "learn_time_ms": 5831.205, "learn_throughput": 685.965, "synch_weights_time_ms": 26.507}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 1639, "training_iteration": 15, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-47-58", "timestamp": 1701996478, "time_this_iter_s": 8.853362798690796, "time_total_s": 138.36225128173828, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 138.36225128173828, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 72.81666666666668, "ram_util_percent": 94.08333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.007031249813735485, "cur_lr": 4.999999873689376e-05, "total_loss": 5.52196741104126, "policy_loss": -0.006262187380343676, "vf_loss": 5.528219699859619, "vf_explained_var": 0.6012630462646484, "kl": 0.0014125528978183866, "entropy": 0.11854004114866257, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 62.19433333333336, "episode_reward_min": 12.179999999999998, "episode_reward_mean": 25.96191666666666, "episode_len_mean": 54.12, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.072333333333322, 41.61233333333333, 12.179999999999998, 24.78566666666668, 16.590666666666664, 14.116666666666662, 31.349333333333306, 18.573666666666657, 33.045, 29.09666666666666, 30.402000000000005, 27.98899999999999, 35.13899999999999, 16.053666666666658, 36.9143333333333, 19.896999999999988, 14.087666666666665, 17.30133333333333, 33.30633333333332, 50.341999999999985, 57.79266666666663, 22.511999999999997, 26.00200000000001, 18.514666666666663, 28.157000000000007, 47.096333333333355, 20.282333333333327, 29.296666666666667, 36.046, 18.359999999999992, 22.80166666666666, 16.662999999999997, 45.44566666666664, 32.88766666666667, 16.047666666666665, 57.633333333333354, 15.459666666666669, 29.634666666666643, 16.46999999999999, 33.93733333333333, 23.907999999999994, 15.35433333333333, 24.492333333333317, 21.193666666666658, 26.715333333333326, 23.742666666666654, 16.846333333333334, 27.90366666666666, 26.86099999999999, 32.711, 13.392000000000003, 17.76733333333333, 35.375333333333316, 15.833333333333334, 26.366999999999987, 20.669999999999995, 34.896666666666654, 18.018333333333327, 19.66866666666666, 20.808999999999994, 21.24666666666666, 15.503666666666664, 31.988999999999997, 23.28533333333333, 21.175333333333327, 15.539666666666665, 22.83833333333332, 34.080666666666644, 15.611333333333333, 17.50966666666666, 18.27966666666666, 16.18666666666666, 35.18766666666667, 30.84833333333332, 15.74999999999999, 18.42833333333333, 17.047333333333334, 31.19700000000001, 35.460666666666675, 16.992333333333328, 19.466999999999985, 37.17466666666666, 23.315333333333335, 24.435333333333322, 13.781000000000002, 24.52533333333334, 62.19433333333336, 37.394000000000005, 15.822666666666663, 17.07299999999999, 21.161, 49.98500000000003, 34.450333333333326, 15.98466666666666, 18.884999999999998, 42.12366666666668, 17.859666666666666, 30.850333333333328, 26.41299999999999, 32.71766666666665], "episode_lengths": [43, 73, 25, 46, 35, 31, 75, 38, 62, 47, 57, 48, 78, 34, 101, 59, 26, 41, 60, 109, 114, 55, 55, 39, 58, 84, 39, 55, 56, 35, 42, 44, 87, 72, 36, 105, 31, 60, 35, 82, 49, 30, 66, 44, 60, 55, 35, 62, 47, 66, 27, 46, 66, 33, 51, 66, 61, 38, 39, 72, 55, 32, 67, 44, 61, 30, 50, 85, 29, 45, 40, 35, 56, 73, 36, 48, 34, 64, 71, 36, 50, 61, 53, 44, 28, 46, 109, 70, 32, 46, 46, 80, 60, 39, 42, 84, 34, 61, 67, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6557394350740242, "mean_inference_ms": 2.8466775063308902, "mean_action_processing_ms": 0.6376040399362239, "mean_env_wait_ms": 0.14894330892010166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016386985778808594, "StateBufferConnector_ms": 0.01578545570373535, "ViewRequirementAgentConnector_ms": 0.5280029773712158}}, "episode_reward_max": 62.19433333333336, "episode_reward_min": 12.179999999999998, "episode_reward_mean": 25.96191666666666, "episode_len_mean": 54.12, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.072333333333322, 41.61233333333333, 12.179999999999998, 24.78566666666668, 16.590666666666664, 14.116666666666662, 31.349333333333306, 18.573666666666657, 33.045, 29.09666666666666, 30.402000000000005, 27.98899999999999, 35.13899999999999, 16.053666666666658, 36.9143333333333, 19.896999999999988, 14.087666666666665, 17.30133333333333, 33.30633333333332, 50.341999999999985, 57.79266666666663, 22.511999999999997, 26.00200000000001, 18.514666666666663, 28.157000000000007, 47.096333333333355, 20.282333333333327, 29.296666666666667, 36.046, 18.359999999999992, 22.80166666666666, 16.662999999999997, 45.44566666666664, 32.88766666666667, 16.047666666666665, 57.633333333333354, 15.459666666666669, 29.634666666666643, 16.46999999999999, 33.93733333333333, 23.907999999999994, 15.35433333333333, 24.492333333333317, 21.193666666666658, 26.715333333333326, 23.742666666666654, 16.846333333333334, 27.90366666666666, 26.86099999999999, 32.711, 13.392000000000003, 17.76733333333333, 35.375333333333316, 15.833333333333334, 26.366999999999987, 20.669999999999995, 34.896666666666654, 18.018333333333327, 19.66866666666666, 20.808999999999994, 21.24666666666666, 15.503666666666664, 31.988999999999997, 23.28533333333333, 21.175333333333327, 15.539666666666665, 22.83833333333332, 34.080666666666644, 15.611333333333333, 17.50966666666666, 18.27966666666666, 16.18666666666666, 35.18766666666667, 30.84833333333332, 15.74999999999999, 18.42833333333333, 17.047333333333334, 31.19700000000001, 35.460666666666675, 16.992333333333328, 19.466999999999985, 37.17466666666666, 23.315333333333335, 24.435333333333322, 13.781000000000002, 24.52533333333334, 62.19433333333336, 37.394000000000005, 15.822666666666663, 17.07299999999999, 21.161, 49.98500000000003, 34.450333333333326, 15.98466666666666, 18.884999999999998, 42.12366666666668, 17.859666666666666, 30.850333333333328, 26.41299999999999, 32.71766666666665], "episode_lengths": [43, 73, 25, 46, 35, 31, 75, 38, 62, 47, 57, 48, 78, 34, 101, 59, 26, 41, 60, 109, 114, 55, 55, 39, 58, 84, 39, 55, 56, 35, 42, 44, 87, 72, 36, 105, 31, 60, 35, 82, 49, 30, 66, 44, 60, 55, 35, 62, 47, 66, 27, 46, 66, 33, 51, 66, 61, 38, 39, 72, 55, 32, 67, 44, 61, 30, 50, 85, 29, 45, 40, 35, 56, 73, 36, 48, 34, 64, 71, 36, 50, 61, 53, 44, 28, 46, 109, 70, 32, 46, 46, 80, 60, 39, 42, 84, 34, 61, 67, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6557394350740242, "mean_inference_ms": 2.8466775063308902, "mean_action_processing_ms": 0.6376040399362239, "mean_env_wait_ms": 0.14894330892010166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016386985778808594, "StateBufferConnector_ms": 0.01578545570373535, "ViewRequirementAgentConnector_ms": 0.5280029773712158}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.31023523254174, "num_env_steps_trained_throughput_per_sec": 455.31023523254174, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 8887.82, "sample_time_ms": 3023.192, "load_time_ms": 0.8, "load_throughput": 5002748.092, "learn_time_ms": 5835.738, "learn_throughput": 685.432, "synch_weights_time_ms": 26.008}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 1712, "training_iteration": 16, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-48-07", "timestamp": 1701996487, "time_this_iter_s": 8.803370952606201, "time_total_s": 147.16562223434448, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 147.16562223434448, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 66.675, "ram_util_percent": 94.15833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0035156249068677425, "cur_lr": 4.999999873689376e-05, "total_loss": 5.410033226013184, "policy_loss": -0.004597080405801535, "vf_loss": 5.414628505706787, "vf_explained_var": 0.6057751774787903, "kl": 0.0006318247178569436, "entropy": 0.10250232368707657, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 67.1053333333333, "episode_reward_min": 13.009333333333338, "episode_reward_mean": 27.22758333333333, "episode_len_mean": 56.91, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.18666666666666, 35.18766666666667, 30.84833333333332, 15.74999999999999, 18.42833333333333, 17.047333333333334, 31.19700000000001, 35.460666666666675, 16.992333333333328, 19.466999999999985, 37.17466666666666, 23.315333333333335, 24.435333333333322, 13.781000000000002, 24.52533333333334, 62.19433333333336, 37.394000000000005, 15.822666666666663, 17.07299999999999, 21.161, 49.98500000000003, 34.450333333333326, 15.98466666666666, 18.884999999999998, 42.12366666666668, 17.859666666666666, 30.850333333333328, 26.41299999999999, 32.71766666666665, 45.62566666666669, 62.088666666666725, 14.152333333333333, 18.406999999999996, 34.98366666666667, 35.15566666666667, 49.12900000000003, 50.74733333333333, 67.1053333333333, 47.119, 23.640999999999995, 13.009333333333338, 17.357666666666663, 23.81466666666665, 16.726333333333333, 26.364999999999988, 31.44033333333332, 22.848666666666645, 20.203666666666656, 38.94633333333334, 18.42566666666666, 19.437999999999985, 54.99900000000002, 20.32366666666666, 19.61099999999999, 19.454333333333338, 33.80166666666668, 29.551, 19.365666666666666, 20.425666666666658, 42.96966666666663, 18.994666666666667, 17.844, 20.760333333333328, 16.888666666666662, 18.35933333333333, 18.260333333333335, 16.43599999999999, 13.171999999999999, 34.86866666666665, 24.337999999999994, 21.340666666666657, 15.939333333333328, 16.71399999999999, 42.266000000000005, 28.570999999999994, 46.40966666666665, 36.51333333333332, 22.876333333333328, 17.723666666666663, 17.352666666666657, 22.008333333333322, 22.70599999999999, 29.169999999999987, 17.96966666666667, 57.447000000000024, 16.32333333333333, 16.63866666666666, 54.48699999999999, 29.20633333333331, 14.63133333333333, 24.651666666666653, 32.65699999999999, 18.970333333333325, 14.575666666666667, 18.239666666666665, 18.45499999999999, 15.946999999999996, 16.102999999999998, 41.727333333333334, 35.27199999999999], "episode_lengths": [35, 56, 73, 36, 48, 34, 64, 71, 36, 50, 61, 53, 44, 28, 46, 109, 70, 32, 46, 46, 80, 60, 39, 42, 84, 34, 61, 67, 84, 88, 102, 28, 36, 65, 78, 78, 93, 144, 118, 56, 26, 34, 71, 34, 59, 92, 56, 54, 76, 38, 63, 104, 44, 40, 40, 60, 51, 43, 39, 84, 35, 33, 40, 33, 47, 39, 35, 29, 79, 49, 53, 34, 39, 83, 60, 87, 79, 41, 40, 37, 64, 55, 77, 37, 108, 34, 39, 104, 84, 31, 64, 75, 39, 29, 38, 36, 41, 31, 77, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6274789252254993, "mean_inference_ms": 2.8032868576316967, "mean_action_processing_ms": 0.6265796941362382, "mean_env_wait_ms": 0.14629220428316422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013992071151733398, "StateBufferConnector_ms": 0.010943412780761719, "ViewRequirementAgentConnector_ms": 0.36589503288269043}}, "episode_reward_max": 67.1053333333333, "episode_reward_min": 13.009333333333338, "episode_reward_mean": 27.22758333333333, "episode_len_mean": 56.91, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.18666666666666, 35.18766666666667, 30.84833333333332, 15.74999999999999, 18.42833333333333, 17.047333333333334, 31.19700000000001, 35.460666666666675, 16.992333333333328, 19.466999999999985, 37.17466666666666, 23.315333333333335, 24.435333333333322, 13.781000000000002, 24.52533333333334, 62.19433333333336, 37.394000000000005, 15.822666666666663, 17.07299999999999, 21.161, 49.98500000000003, 34.450333333333326, 15.98466666666666, 18.884999999999998, 42.12366666666668, 17.859666666666666, 30.850333333333328, 26.41299999999999, 32.71766666666665, 45.62566666666669, 62.088666666666725, 14.152333333333333, 18.406999999999996, 34.98366666666667, 35.15566666666667, 49.12900000000003, 50.74733333333333, 67.1053333333333, 47.119, 23.640999999999995, 13.009333333333338, 17.357666666666663, 23.81466666666665, 16.726333333333333, 26.364999999999988, 31.44033333333332, 22.848666666666645, 20.203666666666656, 38.94633333333334, 18.42566666666666, 19.437999999999985, 54.99900000000002, 20.32366666666666, 19.61099999999999, 19.454333333333338, 33.80166666666668, 29.551, 19.365666666666666, 20.425666666666658, 42.96966666666663, 18.994666666666667, 17.844, 20.760333333333328, 16.888666666666662, 18.35933333333333, 18.260333333333335, 16.43599999999999, 13.171999999999999, 34.86866666666665, 24.337999999999994, 21.340666666666657, 15.939333333333328, 16.71399999999999, 42.266000000000005, 28.570999999999994, 46.40966666666665, 36.51333333333332, 22.876333333333328, 17.723666666666663, 17.352666666666657, 22.008333333333322, 22.70599999999999, 29.169999999999987, 17.96966666666667, 57.447000000000024, 16.32333333333333, 16.63866666666666, 54.48699999999999, 29.20633333333331, 14.63133333333333, 24.651666666666653, 32.65699999999999, 18.970333333333325, 14.575666666666667, 18.239666666666665, 18.45499999999999, 15.946999999999996, 16.102999999999998, 41.727333333333334, 35.27199999999999], "episode_lengths": [35, 56, 73, 36, 48, 34, 64, 71, 36, 50, 61, 53, 44, 28, 46, 109, 70, 32, 46, 46, 80, 60, 39, 42, 84, 34, 61, 67, 84, 88, 102, 28, 36, 65, 78, 78, 93, 144, 118, 56, 26, 34, 71, 34, 59, 92, 56, 54, 76, 38, 63, 104, 44, 40, 40, 60, 51, 43, 39, 84, 35, 33, 40, 33, 47, 39, 35, 29, 79, 49, 53, 34, 39, 83, 60, 87, 79, 41, 40, 37, 64, 55, 77, 37, 108, 34, 39, 104, 84, 31, 64, 75, 39, 29, 38, 36, 41, 31, 77, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6274789252254993, "mean_inference_ms": 2.8032868576316967, "mean_action_processing_ms": 0.6265796941362382, "mean_env_wait_ms": 0.14629220428316422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013992071151733398, "StateBufferConnector_ms": 0.010943412780761719, "ViewRequirementAgentConnector_ms": 0.36589503288269043}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.6308462888858, "num_env_steps_trained_throughput_per_sec": 502.6308462888858, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 8819.319, "sample_time_ms": 2929.822, "load_time_ms": 0.699, "load_throughput": 5718400.763, "learn_time_ms": 5861.213, "learn_throughput": 682.453, "synch_weights_time_ms": 25.482}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 1783, "training_iteration": 17, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-48-15", "timestamp": 1701996495, "time_this_iter_s": 7.981145143508911, "time_total_s": 155.1467673778534, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 155.1467673778534, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 68.30000000000001, "ram_util_percent": 94.06363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0017578124534338713, "cur_lr": 4.999999873689376e-05, "total_loss": 5.276252269744873, "policy_loss": -0.004592627752572298, "vf_loss": 5.280843734741211, "vf_explained_var": 0.5538289546966553, "kl": 0.00045316654723137617, "entropy": 0.10448890924453735, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 58.852333333333384, "episode_reward_min": 14.575666666666667, "episode_reward_mean": 25.788666666666664, "episode_len_mean": 55.31, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.340666666666657, 15.939333333333328, 16.71399999999999, 42.266000000000005, 28.570999999999994, 46.40966666666665, 36.51333333333332, 22.876333333333328, 17.723666666666663, 17.352666666666657, 22.008333333333322, 22.70599999999999, 29.169999999999987, 17.96966666666667, 57.447000000000024, 16.32333333333333, 16.63866666666666, 54.48699999999999, 29.20633333333331, 14.63133333333333, 24.651666666666653, 32.65699999999999, 18.970333333333325, 14.575666666666667, 18.239666666666665, 18.45499999999999, 15.946999999999996, 16.102999999999998, 41.727333333333334, 35.27199999999999, 29.343333333333323, 23.896666666666654, 17.004999999999992, 17.18, 16.42566666666666, 58.852333333333384, 17.898999999999997, 25.84033333333332, 31.922, 35.94833333333335, 34.702666666666666, 19.61566666666665, 27.17666666666667, 31.42799999999999, 17.05066666666666, 30.482999999999986, 21.835333333333324, 42.03699999999999, 27.407666666666678, 37.40933333333333, 26.44299999999999, 21.178333333333324, 17.078666666666667, 32.65899999999998, 20.13033333333333, 19.478333333333328, 22.627666666666656, 33.960333333333324, 29.680666666666657, 30.22399999999999, 24.595000000000002, 14.635666666666669, 18.52266666666666, 16.166999999999994, 18.401666666666657, 23.082666666666658, 24.573, 19.909999999999997, 17.991999999999997, 17.448999999999995, 20.482999999999993, 15.559, 18.174333333333323, 17.959666666666664, 26.255333333333322, 18.886333333333326, 50.50033333333337, 41.21299999999999, 16.884999999999994, 20.320666666666664, 19.062333333333328, 32.006999999999984, 18.331666666666667, 35.143666666666675, 15.925999999999995, 20.188666666666666, 21.391666666666666, 51.18366666666662, 15.748666666666661, 26.57366666666666, 54.62033333333335, 26.319666666666645, 18.212, 35.29366666666666, 16.31233333333333, 17.728666666666662, 46.22833333333337, 20.984666666666666, 16.941666666666656, 29.291000000000004], "episode_lengths": [53, 34, 39, 83, 60, 87, 79, 41, 40, 37, 64, 55, 77, 37, 108, 34, 39, 104, 84, 31, 64, 75, 39, 29, 38, 36, 41, 31, 77, 73, 54, 63, 32, 35, 41, 109, 38, 69, 49, 74, 61, 44, 57, 72, 33, 74, 59, 108, 51, 75, 54, 57, 39, 75, 37, 56, 59, 72, 52, 63, 48, 33, 33, 34, 56, 55, 46, 37, 47, 38, 44, 31, 54, 36, 47, 54, 84, 84, 36, 49, 38, 70, 39, 70, 32, 37, 42, 136, 33, 60, 90, 75, 38, 70, 35, 37, 82, 49, 50, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6181895527311667, "mean_inference_ms": 2.797703624109124, "mean_action_processing_ms": 0.6230800673686336, "mean_env_wait_ms": 0.1460167969864348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014353513717651367, "StateBufferConnector_ms": 0.013324260711669922, "ViewRequirementAgentConnector_ms": 0.45563817024230957}}, "episode_reward_max": 58.852333333333384, "episode_reward_min": 14.575666666666667, "episode_reward_mean": 25.788666666666664, "episode_len_mean": 55.31, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.340666666666657, 15.939333333333328, 16.71399999999999, 42.266000000000005, 28.570999999999994, 46.40966666666665, 36.51333333333332, 22.876333333333328, 17.723666666666663, 17.352666666666657, 22.008333333333322, 22.70599999999999, 29.169999999999987, 17.96966666666667, 57.447000000000024, 16.32333333333333, 16.63866666666666, 54.48699999999999, 29.20633333333331, 14.63133333333333, 24.651666666666653, 32.65699999999999, 18.970333333333325, 14.575666666666667, 18.239666666666665, 18.45499999999999, 15.946999999999996, 16.102999999999998, 41.727333333333334, 35.27199999999999, 29.343333333333323, 23.896666666666654, 17.004999999999992, 17.18, 16.42566666666666, 58.852333333333384, 17.898999999999997, 25.84033333333332, 31.922, 35.94833333333335, 34.702666666666666, 19.61566666666665, 27.17666666666667, 31.42799999999999, 17.05066666666666, 30.482999999999986, 21.835333333333324, 42.03699999999999, 27.407666666666678, 37.40933333333333, 26.44299999999999, 21.178333333333324, 17.078666666666667, 32.65899999999998, 20.13033333333333, 19.478333333333328, 22.627666666666656, 33.960333333333324, 29.680666666666657, 30.22399999999999, 24.595000000000002, 14.635666666666669, 18.52266666666666, 16.166999999999994, 18.401666666666657, 23.082666666666658, 24.573, 19.909999999999997, 17.991999999999997, 17.448999999999995, 20.482999999999993, 15.559, 18.174333333333323, 17.959666666666664, 26.255333333333322, 18.886333333333326, 50.50033333333337, 41.21299999999999, 16.884999999999994, 20.320666666666664, 19.062333333333328, 32.006999999999984, 18.331666666666667, 35.143666666666675, 15.925999999999995, 20.188666666666666, 21.391666666666666, 51.18366666666662, 15.748666666666661, 26.57366666666666, 54.62033333333335, 26.319666666666645, 18.212, 35.29366666666666, 16.31233333333333, 17.728666666666662, 46.22833333333337, 20.984666666666666, 16.941666666666656, 29.291000000000004], "episode_lengths": [53, 34, 39, 83, 60, 87, 79, 41, 40, 37, 64, 55, 77, 37, 108, 34, 39, 104, 84, 31, 64, 75, 39, 29, 38, 36, 41, 31, 77, 73, 54, 63, 32, 35, 41, 109, 38, 69, 49, 74, 61, 44, 57, 72, 33, 74, 59, 108, 51, 75, 54, 57, 39, 75, 37, 56, 59, 72, 52, 63, 48, 33, 33, 34, 56, 55, 46, 37, 47, 38, 44, 31, 54, 36, 47, 54, 84, 84, 36, 49, 38, 70, 39, 70, 32, 37, 42, 136, 33, 60, 90, 75, 38, 70, 35, 37, 82, 49, 50, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6181895527311667, "mean_inference_ms": 2.797703624109124, "mean_action_processing_ms": 0.6230800673686336, "mean_env_wait_ms": 0.1460167969864348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014353513717651367, "StateBufferConnector_ms": 0.013324260711669922, "ViewRequirementAgentConnector_ms": 0.45563817024230957}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.33729374497517, "num_env_steps_trained_throughput_per_sec": 427.33729374497517, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 8771.108, "sample_time_ms": 2921.345, "load_time_ms": 0.7, "load_throughput": 5714505.262, "learn_time_ms": 5821.171, "learn_throughput": 687.147, "synch_weights_time_ms": 25.677}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 1853, "training_iteration": 18, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-48-25", "timestamp": 1701996505, "time_this_iter_s": 9.381774187088013, "time_total_s": 164.5285415649414, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 164.5285415649414, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 73.23846153846154, "ram_util_percent": 94.3923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0008789062267169356, "cur_lr": 4.999999873689376e-05, "total_loss": 5.227348804473877, "policy_loss": -0.006838715635240078, "vf_loss": 5.234186172485352, "vf_explained_var": 0.5549535751342773, "kl": 0.001186539069749415, "entropy": 0.08351540565490723, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 63.80966666666674, "episode_reward_min": 13.814999999999998, "episode_reward_mean": 27.12959666666666, "episode_len_mean": 56.63, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.174333333333323, 17.959666666666664, 26.255333333333322, 18.886333333333326, 50.50033333333337, 41.21299999999999, 16.884999999999994, 20.320666666666664, 19.062333333333328, 32.006999999999984, 18.331666666666667, 35.143666666666675, 15.925999999999995, 20.188666666666666, 21.391666666666666, 51.18366666666662, 15.748666666666661, 26.57366666666666, 54.62033333333335, 26.319666666666645, 18.212, 35.29366666666666, 16.31233333333333, 17.728666666666662, 46.22833333333337, 20.984666666666666, 16.941666666666656, 29.291000000000004, 31.032333333333344, 42.65833333333336, 22.91266666666666, 17.420999999999992, 17.317666666666668, 15.477999999999998, 21.971999999999998, 22.575333333333322, 20.075333333333337, 13.814999999999998, 34.41799999999999, 44.59166666666665, 38.98233333333332, 16.686666666666664, 26.387999999999987, 60.94466666666667, 16.949333333333325, 19.407666666666657, 26.581333333333326, 20.94533333333333, 27.666333333333316, 21.536999999999995, 63.80966666666674, 20.05633333333333, 19.272333333333314, 23.563333333333325, 41.74800000000001, 22.539999999999996, 46.597, 19.78633333333333, 16.06466666666666, 24.19866666666665, 35.676333333333325, 39.867, 21.466000000000008, 37.05066666666667, 23.226999999999986, 18.604999999999997, 30.695666666666668, 19.91133333333333, 20.038666666666664, 15.034666666666663, 19.602999999999994, 52.58466666666666, 25.06166666666665, 16.91933333333333, 16.45966666666666, 21.570999999999994, 34.72033333333332, 30.53299999999999, 19.06099999999999, 47.68866666666666, 25.150666666666666, 18.336333333333332, 20.240000000000002, 29.474333333333334, 37.941333333333304, 39.694666666666656, 36.91533333333333, 14.188999999999995, 18.129999999999992, 18.914666666666662, 28.61166666666666, 38.49599999999998, 20.67366666666665, 14.492333333333333, 53.59933333333335, 33.330666666666644, 22.547333333333317, 16.825666666666667, 21.57033333333332, 32.37533333333332], "episode_lengths": [54, 36, 47, 54, 84, 84, 36, 49, 38, 70, 39, 70, 32, 37, 42, 136, 33, 60, 90, 75, 38, 70, 35, 37, 82, 49, 50, 51, 65, 87, 68, 32, 43, 33, 51, 59, 35, 31, 68, 84, 82, 32, 61, 99, 37, 36, 48, 45, 59, 48, 94, 52, 45, 47, 69, 57, 81, 40, 35, 69, 86, 62, 51, 71, 66, 38, 64, 41, 41, 33, 44, 89, 66, 37, 38, 48, 64, 51, 35, 87, 59, 48, 50, 50, 89, 77, 69, 32, 37, 36, 62, 85, 56, 28, 95, 93, 73, 33, 54, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6252879078298383, "mean_inference_ms": 2.8137304556323595, "mean_action_processing_ms": 0.6269749428958219, "mean_env_wait_ms": 0.14720582642043165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033878326416015625, "StateBufferConnector_ms": 0.020872831344604492, "ViewRequirementAgentConnector_ms": 0.5543017387390137}}, "episode_reward_max": 63.80966666666674, "episode_reward_min": 13.814999999999998, "episode_reward_mean": 27.12959666666666, "episode_len_mean": 56.63, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.174333333333323, 17.959666666666664, 26.255333333333322, 18.886333333333326, 50.50033333333337, 41.21299999999999, 16.884999999999994, 20.320666666666664, 19.062333333333328, 32.006999999999984, 18.331666666666667, 35.143666666666675, 15.925999999999995, 20.188666666666666, 21.391666666666666, 51.18366666666662, 15.748666666666661, 26.57366666666666, 54.62033333333335, 26.319666666666645, 18.212, 35.29366666666666, 16.31233333333333, 17.728666666666662, 46.22833333333337, 20.984666666666666, 16.941666666666656, 29.291000000000004, 31.032333333333344, 42.65833333333336, 22.91266666666666, 17.420999999999992, 17.317666666666668, 15.477999999999998, 21.971999999999998, 22.575333333333322, 20.075333333333337, 13.814999999999998, 34.41799999999999, 44.59166666666665, 38.98233333333332, 16.686666666666664, 26.387999999999987, 60.94466666666667, 16.949333333333325, 19.407666666666657, 26.581333333333326, 20.94533333333333, 27.666333333333316, 21.536999999999995, 63.80966666666674, 20.05633333333333, 19.272333333333314, 23.563333333333325, 41.74800000000001, 22.539999999999996, 46.597, 19.78633333333333, 16.06466666666666, 24.19866666666665, 35.676333333333325, 39.867, 21.466000000000008, 37.05066666666667, 23.226999999999986, 18.604999999999997, 30.695666666666668, 19.91133333333333, 20.038666666666664, 15.034666666666663, 19.602999999999994, 52.58466666666666, 25.06166666666665, 16.91933333333333, 16.45966666666666, 21.570999999999994, 34.72033333333332, 30.53299999999999, 19.06099999999999, 47.68866666666666, 25.150666666666666, 18.336333333333332, 20.240000000000002, 29.474333333333334, 37.941333333333304, 39.694666666666656, 36.91533333333333, 14.188999999999995, 18.129999999999992, 18.914666666666662, 28.61166666666666, 38.49599999999998, 20.67366666666665, 14.492333333333333, 53.59933333333335, 33.330666666666644, 22.547333333333317, 16.825666666666667, 21.57033333333332, 32.37533333333332], "episode_lengths": [54, 36, 47, 54, 84, 84, 36, 49, 38, 70, 39, 70, 32, 37, 42, 136, 33, 60, 90, 75, 38, 70, 35, 37, 82, 49, 50, 51, 65, 87, 68, 32, 43, 33, 51, 59, 35, 31, 68, 84, 82, 32, 61, 99, 37, 36, 48, 45, 59, 48, 94, 52, 45, 47, 69, 57, 81, 40, 35, 69, 86, 62, 51, 71, 66, 38, 64, 41, 41, 33, 44, 89, 66, 37, 38, 48, 64, 51, 35, 87, 59, 48, 50, 50, 89, 77, 69, 32, 37, 36, 62, 85, 56, 28, 95, 93, 73, 33, 54, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6252879078298383, "mean_inference_ms": 2.8137304556323595, "mean_action_processing_ms": 0.6269749428958219, "mean_env_wait_ms": 0.14720582642043165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033878326416015625, "StateBufferConnector_ms": 0.020872831344604492, "ViewRequirementAgentConnector_ms": 0.5543017387390137}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.89218537777174, "num_env_steps_trained_throughput_per_sec": 465.89218537777174, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 8754.848, "sample_time_ms": 2962.387, "load_time_ms": 0.8, "load_throughput": 4998723.594, "learn_time_ms": 5762.595, "learn_throughput": 694.132, "synch_weights_time_ms": 26.853}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1925, "training_iteration": 19, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-48-33", "timestamp": 1701996513, "time_this_iter_s": 8.606694459915161, "time_total_s": 173.13523602485657, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 173.13523602485657, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 77.03333333333333, "ram_util_percent": 94.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 4.999999873689376e-05, "total_loss": 5.878846168518066, "policy_loss": -0.005330861080437899, "vf_loss": 5.884177207946777, "vf_explained_var": 0.6160653829574585, "kl": 0.0002639852464199066, "entropy": 0.08340375125408173, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 70.5836666666666, "episode_reward_min": 14.124333333333325, "episode_reward_mean": 27.899459999999994, "episode_len_mean": 58.44, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.038666666666664, 15.034666666666663, 19.602999999999994, 52.58466666666666, 25.06166666666665, 16.91933333333333, 16.45966666666666, 21.570999999999994, 34.72033333333332, 30.53299999999999, 19.06099999999999, 47.68866666666666, 25.150666666666666, 18.336333333333332, 20.240000000000002, 29.474333333333334, 37.941333333333304, 39.694666666666656, 36.91533333333333, 14.188999999999995, 18.129999999999992, 18.914666666666662, 28.61166666666666, 38.49599999999998, 20.67366666666665, 14.492333333333333, 53.59933333333335, 33.330666666666644, 22.547333333333317, 16.825666666666667, 21.57033333333332, 32.37533333333332, 35.60866666666669, 37.087333333333326, 20.26366666666665, 19.99566666666666, 20.306666666666654, 16.629333333333324, 29.98866666666666, 33.911999999999985, 37.614333333333335, 17.411333333333324, 58.5466666666667, 42.96033333333334, 23.214333333333325, 47.078, 17.80833333333333, 14.124333333333325, 38.25166666666665, 21.44733333333333, 21.308999999999994, 26.164666666666662, 21.02799999999999, 48.41999999999999, 24.097666666666665, 17.529666666666664, 19.816333333333322, 31.693666666666648, 16.310333333333332, 15.976999999999997, 25.585000000000004, 22.22966666666666, 35.83966666666667, 17.297999999999988, 14.741666666666665, 28.71366666666667, 42.16699999999998, 22.61299999999999, 33.71699999999999, 56.51400000000001, 22.21833333333333, 24.098666666666663, 39.17699999999999, 24.688666666666652, 14.502333333333333, 24.070999999999977, 15.653666666666657, 26.79333333333334, 53.785999999999994, 70.5836666666666, 18.842666666666663, 20.228999999999996, 40.44800000000001, 25.89833333333333, 26.084666666666664, 33.340333333333334, 21.819333333333333, 14.434666666666663, 18.098999999999993, 24.988333333333316, 19.070999999999998, 19.41366666666667, 46.35899999999995, 25.812666666666672, 41.428333333333335, 21.27499999999999, 16.964333333333336, 16.174666666666663, 44.926666666666655, 43.96566666666664], "episode_lengths": [41, 33, 44, 89, 66, 37, 38, 48, 64, 51, 35, 87, 59, 48, 50, 50, 89, 77, 69, 32, 37, 36, 62, 85, 56, 28, 95, 93, 73, 33, 54, 55, 62, 91, 46, 43, 52, 31, 53, 80, 73, 41, 117, 73, 44, 90, 42, 27, 95, 39, 43, 49, 54, 125, 56, 36, 47, 89, 30, 30, 47, 49, 78, 37, 30, 68, 74, 44, 70, 101, 47, 49, 88, 60, 28, 62, 38, 51, 101, 142, 51, 41, 77, 51, 59, 62, 46, 29, 35, 42, 39, 40, 110, 51, 67, 52, 32, 39, 93, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.629718378651132, "mean_inference_ms": 2.8240578157298604, "mean_action_processing_ms": 0.6280180587809739, "mean_env_wait_ms": 0.14813378641057062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027815818786621094, "StateBufferConnector_ms": 0.01477193832397461, "ViewRequirementAgentConnector_ms": 0.5171120166778564}}, "episode_reward_max": 70.5836666666666, "episode_reward_min": 14.124333333333325, "episode_reward_mean": 27.899459999999994, "episode_len_mean": 58.44, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.038666666666664, 15.034666666666663, 19.602999999999994, 52.58466666666666, 25.06166666666665, 16.91933333333333, 16.45966666666666, 21.570999999999994, 34.72033333333332, 30.53299999999999, 19.06099999999999, 47.68866666666666, 25.150666666666666, 18.336333333333332, 20.240000000000002, 29.474333333333334, 37.941333333333304, 39.694666666666656, 36.91533333333333, 14.188999999999995, 18.129999999999992, 18.914666666666662, 28.61166666666666, 38.49599999999998, 20.67366666666665, 14.492333333333333, 53.59933333333335, 33.330666666666644, 22.547333333333317, 16.825666666666667, 21.57033333333332, 32.37533333333332, 35.60866666666669, 37.087333333333326, 20.26366666666665, 19.99566666666666, 20.306666666666654, 16.629333333333324, 29.98866666666666, 33.911999999999985, 37.614333333333335, 17.411333333333324, 58.5466666666667, 42.96033333333334, 23.214333333333325, 47.078, 17.80833333333333, 14.124333333333325, 38.25166666666665, 21.44733333333333, 21.308999999999994, 26.164666666666662, 21.02799999999999, 48.41999999999999, 24.097666666666665, 17.529666666666664, 19.816333333333322, 31.693666666666648, 16.310333333333332, 15.976999999999997, 25.585000000000004, 22.22966666666666, 35.83966666666667, 17.297999999999988, 14.741666666666665, 28.71366666666667, 42.16699999999998, 22.61299999999999, 33.71699999999999, 56.51400000000001, 22.21833333333333, 24.098666666666663, 39.17699999999999, 24.688666666666652, 14.502333333333333, 24.070999999999977, 15.653666666666657, 26.79333333333334, 53.785999999999994, 70.5836666666666, 18.842666666666663, 20.228999999999996, 40.44800000000001, 25.89833333333333, 26.084666666666664, 33.340333333333334, 21.819333333333333, 14.434666666666663, 18.098999999999993, 24.988333333333316, 19.070999999999998, 19.41366666666667, 46.35899999999995, 25.812666666666672, 41.428333333333335, 21.27499999999999, 16.964333333333336, 16.174666666666663, 44.926666666666655, 43.96566666666664], "episode_lengths": [41, 33, 44, 89, 66, 37, 38, 48, 64, 51, 35, 87, 59, 48, 50, 50, 89, 77, 69, 32, 37, 36, 62, 85, 56, 28, 95, 93, 73, 33, 54, 55, 62, 91, 46, 43, 52, 31, 53, 80, 73, 41, 117, 73, 44, 90, 42, 27, 95, 39, 43, 49, 54, 125, 56, 36, 47, 89, 30, 30, 47, 49, 78, 37, 30, 68, 74, 44, 70, 101, 47, 49, 88, 60, 28, 62, 38, 51, 101, 142, 51, 41, 77, 51, 59, 62, 46, 29, 35, 42, 39, 40, 110, 51, 67, 52, 32, 39, 93, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.629718378651132, "mean_inference_ms": 2.8240578157298604, "mean_action_processing_ms": 0.6280180587809739, "mean_env_wait_ms": 0.14813378641057062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027815818786621094, "StateBufferConnector_ms": 0.01477193832397461, "ViewRequirementAgentConnector_ms": 0.5171120166778564}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.0045342664849, "num_env_steps_trained_throughput_per_sec": 419.0045342664849, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 8825.127, "sample_time_ms": 2979.937, "load_time_ms": 0.786, "load_throughput": 5089711.495, "learn_time_ms": 5811.47, "learn_throughput": 688.294, "synch_weights_time_ms": 30.607}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 1993, "training_iteration": 20, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-48-43", "timestamp": 1701996523, "time_this_iter_s": 9.574466943740845, "time_total_s": 182.7097029685974, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 182.7097029685974, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 70.01538461538462, "ram_util_percent": 91.66153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0002197265566792339, "cur_lr": 4.999999873689376e-05, "total_loss": 6.244372844696045, "policy_loss": -0.001212984905578196, "vf_loss": 6.2455854415893555, "vf_explained_var": 0.5704147219657898, "kl": 0.0008222225587815046, "entropy": 0.06611397117376328, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 70.5836666666666, "episode_reward_min": 14.404666666666666, "episode_reward_mean": 28.977929999999997, "episode_len_mean": 60.16, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.71366666666667, 42.16699999999998, 22.61299999999999, 33.71699999999999, 56.51400000000001, 22.21833333333333, 24.098666666666663, 39.17699999999999, 24.688666666666652, 14.502333333333333, 24.070999999999977, 15.653666666666657, 26.79333333333334, 53.785999999999994, 70.5836666666666, 18.842666666666663, 20.228999999999996, 40.44800000000001, 25.89833333333333, 26.084666666666664, 33.340333333333334, 21.819333333333333, 14.434666666666663, 18.098999999999993, 24.988333333333316, 19.070999999999998, 19.41366666666667, 46.35899999999995, 25.812666666666672, 41.428333333333335, 21.27499999999999, 16.964333333333336, 16.174666666666663, 44.926666666666655, 43.96566666666664, 22.83633333333333, 21.244999999999994, 21.59766666666666, 18.088666666666665, 17.330666666666655, 23.07766666666666, 40.713666666666676, 20.97633333333333, 26.835666666666658, 38.556999999999995, 38.96200000000001, 18.191333333333326, 23.704333333333327, 36.87133333333331, 42.77766666666667, 21.48099999999999, 17.06133333333333, 45.64133333333334, 20.725666666666665, 16.07699999999999, 20.348999999999997, 26.341666666666654, 35.27766666666667, 15.977999999999993, 25.557666666666655, 51.29233333333335, 16.509666666666654, 34.48033333333334, 32.18333333333334, 28.585666666666665, 59.47700000000004, 32.87966666666665, 30.670999999999985, 15.124666666666661, 44.86633333333333, 20.74033333333332, 24.145000000000003, 32.75333333333333, 40.371, 35.799, 36.196333333333335, 21.77433333333333, 18.830333333333336, 42.44200000000001, 15.299999999999997, 23.36633333333333, 38.402666666666654, 20.64533333333332, 22.860333333333323, 14.458999999999996, 37.02366666666664, 21.779999999999994, 26.078333333333337, 35.67066666666668, 31.35466666666664, 48.595000000000034, 18.064666666666664, 14.404666666666666, 29.443333333333324, 21.234666666666666, 67.01700000000008, 19.33433333333333, 38.02933333333334, 24.15833333333333, 16.320666666666657], "episode_lengths": [68, 74, 44, 70, 101, 47, 49, 88, 60, 28, 62, 38, 51, 101, 142, 51, 41, 77, 51, 59, 62, 46, 29, 35, 42, 39, 40, 110, 51, 67, 52, 32, 39, 93, 92, 54, 49, 40, 35, 34, 44, 72, 44, 67, 115, 79, 37, 50, 86, 86, 46, 35, 99, 47, 33, 38, 52, 72, 31, 55, 92, 36, 56, 61, 48, 105, 78, 73, 31, 93, 42, 58, 76, 95, 90, 64, 43, 52, 84, 33, 44, 61, 56, 50, 28, 88, 49, 52, 69, 69, 101, 35, 29, 63, 49, 140, 46, 65, 48, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6335297132348325, "mean_inference_ms": 2.832517539758705, "mean_action_processing_ms": 0.629231272547583, "mean_env_wait_ms": 0.14855408956761967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025367259979248047, "StateBufferConnector_ms": 0.015618324279785156, "ViewRequirementAgentConnector_ms": 0.5151138305664062}}, "episode_reward_max": 70.5836666666666, "episode_reward_min": 14.404666666666666, "episode_reward_mean": 28.977929999999997, "episode_len_mean": 60.16, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.71366666666667, 42.16699999999998, 22.61299999999999, 33.71699999999999, 56.51400000000001, 22.21833333333333, 24.098666666666663, 39.17699999999999, 24.688666666666652, 14.502333333333333, 24.070999999999977, 15.653666666666657, 26.79333333333334, 53.785999999999994, 70.5836666666666, 18.842666666666663, 20.228999999999996, 40.44800000000001, 25.89833333333333, 26.084666666666664, 33.340333333333334, 21.819333333333333, 14.434666666666663, 18.098999999999993, 24.988333333333316, 19.070999999999998, 19.41366666666667, 46.35899999999995, 25.812666666666672, 41.428333333333335, 21.27499999999999, 16.964333333333336, 16.174666666666663, 44.926666666666655, 43.96566666666664, 22.83633333333333, 21.244999999999994, 21.59766666666666, 18.088666666666665, 17.330666666666655, 23.07766666666666, 40.713666666666676, 20.97633333333333, 26.835666666666658, 38.556999999999995, 38.96200000000001, 18.191333333333326, 23.704333333333327, 36.87133333333331, 42.77766666666667, 21.48099999999999, 17.06133333333333, 45.64133333333334, 20.725666666666665, 16.07699999999999, 20.348999999999997, 26.341666666666654, 35.27766666666667, 15.977999999999993, 25.557666666666655, 51.29233333333335, 16.509666666666654, 34.48033333333334, 32.18333333333334, 28.585666666666665, 59.47700000000004, 32.87966666666665, 30.670999999999985, 15.124666666666661, 44.86633333333333, 20.74033333333332, 24.145000000000003, 32.75333333333333, 40.371, 35.799, 36.196333333333335, 21.77433333333333, 18.830333333333336, 42.44200000000001, 15.299999999999997, 23.36633333333333, 38.402666666666654, 20.64533333333332, 22.860333333333323, 14.458999999999996, 37.02366666666664, 21.779999999999994, 26.078333333333337, 35.67066666666668, 31.35466666666664, 48.595000000000034, 18.064666666666664, 14.404666666666666, 29.443333333333324, 21.234666666666666, 67.01700000000008, 19.33433333333333, 38.02933333333334, 24.15833333333333, 16.320666666666657], "episode_lengths": [68, 74, 44, 70, 101, 47, 49, 88, 60, 28, 62, 38, 51, 101, 142, 51, 41, 77, 51, 59, 62, 46, 29, 35, 42, 39, 40, 110, 51, 67, 52, 32, 39, 93, 92, 54, 49, 40, 35, 34, 44, 72, 44, 67, 115, 79, 37, 50, 86, 86, 46, 35, 99, 47, 33, 38, 52, 72, 31, 55, 92, 36, 56, 61, 48, 105, 78, 73, 31, 93, 42, 58, 76, 95, 90, 64, 43, 52, 84, 33, 44, 61, 56, 50, 28, 88, 49, 52, 69, 69, 101, 35, 29, 63, 49, 140, 46, 65, 48, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6335297132348325, "mean_inference_ms": 2.832517539758705, "mean_action_processing_ms": 0.629231272547583, "mean_env_wait_ms": 0.14855408956761967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025367259979248047, "StateBufferConnector_ms": 0.015618324279785156, "ViewRequirementAgentConnector_ms": 0.5151138305664062}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.55515058730134, "num_env_steps_trained_throughput_per_sec": 432.55515058730134, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 8857.293, "sample_time_ms": 2999.584, "load_time_ms": 0.787, "load_throughput": 5083850.792, "learn_time_ms": 5823.665, "learn_throughput": 686.853, "synch_weights_time_ms": 31.037}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 2058, "training_iteration": 21, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-48-52", "timestamp": 1701996532, "time_this_iter_s": 9.270364999771118, "time_total_s": 191.98006796836853, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 191.98006796836853, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 73.83333333333333, "ram_util_percent": 91.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00010986327833961695, "cur_lr": 4.999999873689376e-05, "total_loss": 5.3334760665893555, "policy_loss": -0.002762165851891041, "vf_loss": 5.336237907409668, "vf_explained_var": 0.667263388633728, "kl": 0.0006492643151432276, "entropy": 0.05149564892053604, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 67.01700000000008, "episode_reward_min": 14.367999999999999, "episode_reward_mean": 27.902953333333326, "episode_len_mean": 59.59, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.74033333333332, 24.145000000000003, 32.75333333333333, 40.371, 35.799, 36.196333333333335, 21.77433333333333, 18.830333333333336, 42.44200000000001, 15.299999999999997, 23.36633333333333, 38.402666666666654, 20.64533333333332, 22.860333333333323, 14.458999999999996, 37.02366666666664, 21.779999999999994, 26.078333333333337, 35.67066666666668, 31.35466666666664, 48.595000000000034, 18.064666666666664, 14.404666666666666, 29.443333333333324, 21.234666666666666, 67.01700000000008, 19.33433333333333, 38.02933333333334, 24.15833333333333, 16.320666666666657, 41.70166666666664, 25.77433333333332, 23.981666666666644, 18.04866666666666, 38.32966666666665, 36.130333333333326, 25.12166666666667, 16.410999999999994, 41.175000000000004, 36.172999999999995, 20.076999999999988, 27.89500000000001, 22.032, 19.594999999999995, 17.741666666666664, 50.80533333333333, 55.083666666666666, 25.36999999999999, 14.367999999999999, 38.05466666666666, 34.39133333333333, 61.25300000000001, 22.082999999999995, 21.526999999999997, 24.573333333333323, 30.288999999999998, 31.69433333333332, 16.336333333333336, 49.42066666666665, 18.42133333333332, 27.109999999999967, 24.612333333333336, 25.466333333333317, 15.85499999999999, 23.702666666666666, 21.83566666666665, 18.82033333333333, 57.428333333333356, 22.256333333333334, 24.648333333333316, 20.040999999999997, 20.587666666666667, 17.25099999999999, 23.16166666666666, 32.24966666666666, 20.670999999999996, 33.86366666666665, 15.481999999999996, 32.72233333333332, 18.04699999999999, 53.674666666666674, 49.510000000000026, 23.660666666666653, 40.75166666666665, 20.456333333333333, 35.13966666666665, 26.670333333333335, 45.126999999999974, 14.800333333333333, 19.748333333333335, 25.054666666666666, 21.14699999999999, 25.58033333333333, 16.13033333333333, 27.754999999999995, 18.493333333333325, 20.39233333333333, 18.283999999999995, 15.098333333333331, 16.555333333333337], "episode_lengths": [42, 58, 76, 95, 90, 64, 43, 52, 84, 33, 44, 61, 56, 50, 28, 88, 49, 52, 69, 69, 101, 35, 29, 63, 49, 140, 46, 65, 48, 33, 92, 61, 57, 35, 74, 76, 60, 40, 81, 68, 46, 50, 47, 40, 32, 113, 112, 57, 29, 92, 79, 116, 41, 46, 57, 68, 82, 42, 87, 41, 96, 58, 64, 34, 51, 48, 44, 92, 41, 58, 43, 51, 42, 47, 51, 54, 84, 31, 66, 38, 131, 95, 51, 67, 44, 94, 55, 112, 30, 37, 49, 40, 70, 33, 52, 35, 43, 33, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6395890478048865, "mean_inference_ms": 2.843342656495386, "mean_action_processing_ms": 0.6299716086113277, "mean_env_wait_ms": 0.14962545117186216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025735855102539062, "StateBufferConnector_ms": 0.026786088943481445, "ViewRequirementAgentConnector_ms": 0.5207886695861816}}, "episode_reward_max": 67.01700000000008, "episode_reward_min": 14.367999999999999, "episode_reward_mean": 27.902953333333326, "episode_len_mean": 59.59, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.74033333333332, 24.145000000000003, 32.75333333333333, 40.371, 35.799, 36.196333333333335, 21.77433333333333, 18.830333333333336, 42.44200000000001, 15.299999999999997, 23.36633333333333, 38.402666666666654, 20.64533333333332, 22.860333333333323, 14.458999999999996, 37.02366666666664, 21.779999999999994, 26.078333333333337, 35.67066666666668, 31.35466666666664, 48.595000000000034, 18.064666666666664, 14.404666666666666, 29.443333333333324, 21.234666666666666, 67.01700000000008, 19.33433333333333, 38.02933333333334, 24.15833333333333, 16.320666666666657, 41.70166666666664, 25.77433333333332, 23.981666666666644, 18.04866666666666, 38.32966666666665, 36.130333333333326, 25.12166666666667, 16.410999999999994, 41.175000000000004, 36.172999999999995, 20.076999999999988, 27.89500000000001, 22.032, 19.594999999999995, 17.741666666666664, 50.80533333333333, 55.083666666666666, 25.36999999999999, 14.367999999999999, 38.05466666666666, 34.39133333333333, 61.25300000000001, 22.082999999999995, 21.526999999999997, 24.573333333333323, 30.288999999999998, 31.69433333333332, 16.336333333333336, 49.42066666666665, 18.42133333333332, 27.109999999999967, 24.612333333333336, 25.466333333333317, 15.85499999999999, 23.702666666666666, 21.83566666666665, 18.82033333333333, 57.428333333333356, 22.256333333333334, 24.648333333333316, 20.040999999999997, 20.587666666666667, 17.25099999999999, 23.16166666666666, 32.24966666666666, 20.670999999999996, 33.86366666666665, 15.481999999999996, 32.72233333333332, 18.04699999999999, 53.674666666666674, 49.510000000000026, 23.660666666666653, 40.75166666666665, 20.456333333333333, 35.13966666666665, 26.670333333333335, 45.126999999999974, 14.800333333333333, 19.748333333333335, 25.054666666666666, 21.14699999999999, 25.58033333333333, 16.13033333333333, 27.754999999999995, 18.493333333333325, 20.39233333333333, 18.283999999999995, 15.098333333333331, 16.555333333333337], "episode_lengths": [42, 58, 76, 95, 90, 64, 43, 52, 84, 33, 44, 61, 56, 50, 28, 88, 49, 52, 69, 69, 101, 35, 29, 63, 49, 140, 46, 65, 48, 33, 92, 61, 57, 35, 74, 76, 60, 40, 81, 68, 46, 50, 47, 40, 32, 113, 112, 57, 29, 92, 79, 116, 41, 46, 57, 68, 82, 42, 87, 41, 96, 58, 64, 34, 51, 48, 44, 92, 41, 58, 43, 51, 42, 47, 51, 54, 84, 31, 66, 38, 131, 95, 51, 67, 44, 94, 55, 112, 30, 37, 49, 40, 70, 33, 52, 35, 43, 33, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6395890478048865, "mean_inference_ms": 2.843342656495386, "mean_action_processing_ms": 0.6299716086113277, "mean_env_wait_ms": 0.14962545117186216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025735855102539062, "StateBufferConnector_ms": 0.026786088943481445, "ViewRequirementAgentConnector_ms": 0.5207886695861816}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.5076105803204, "num_env_steps_trained_throughput_per_sec": 421.5076105803204, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 8942.135, "sample_time_ms": 3039.461, "load_time_ms": 0.787, "load_throughput": 5083850.792, "learn_time_ms": 5868.929, "learn_throughput": 681.555, "synch_weights_time_ms": 30.818}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 2128, "training_iteration": 22, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-49-02", "timestamp": 1701996542, "time_this_iter_s": 9.514742612838745, "time_total_s": 201.49481058120728, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 201.49481058120728, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 74.6076923076923, "ram_util_percent": 91.46153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5.587813377380371, "policy_loss": -0.0031810873188078403, "vf_loss": 5.590994834899902, "vf_explained_var": 0.5642144680023193, "kl": 0.0003574051952455193, "entropy": 0.05766764655709267, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 59.93366666666666, "episode_reward_min": 14.73633333333333, "episode_reward_mean": 27.07106666666666, "episode_len_mean": 56.48, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.648333333333316, 20.040999999999997, 20.587666666666667, 17.25099999999999, 23.16166666666666, 32.24966666666666, 20.670999999999996, 33.86366666666665, 15.481999999999996, 32.72233333333332, 18.04699999999999, 53.674666666666674, 49.510000000000026, 23.660666666666653, 40.75166666666665, 20.456333333333333, 35.13966666666665, 26.670333333333335, 45.126999999999974, 14.800333333333333, 19.748333333333335, 25.054666666666666, 21.14699999999999, 25.58033333333333, 16.13033333333333, 27.754999999999995, 18.493333333333325, 20.39233333333333, 18.283999999999995, 15.098333333333331, 16.555333333333337, 42.90766666666665, 27.693333333333314, 22.100999999999992, 15.578333333333331, 17.878666666666664, 15.741999999999996, 16.33, 23.302999999999983, 43.66433333333334, 15.831666666666663, 22.33033333333333, 20.201999999999995, 16.476666666666663, 35.85633333333333, 18.582333333333334, 30.577000000000005, 29.663666666666657, 25.78566666666666, 17.317, 34.57499999999998, 17.97199999999999, 28.27933333333333, 27.197666666666642, 50.24399999999999, 45.71033333333335, 14.79266666666666, 26.198666666666675, 24.006666666666646, 40.31466666666665, 22.91799999999999, 35.198333333333295, 29.32899999999999, 40.85166666666667, 59.93366666666666, 15.159666666666666, 28.304666666666666, 50.2686666666667, 31.555, 18.813999999999997, 15.20366666666666, 27.002999999999986, 39.52966666666667, 14.73633333333333, 15.725666666666662, 16.507666666666665, 17.722999999999995, 24.010333333333328, 22.967333333333325, 48.452, 22.68166666666666, 31.07533333333333, 40.50066666666669, 29.312333333333324, 39.06333333333334, 24.02166666666666, 35.53033333333335, 27.114666666666682, 21.25066666666666, 24.233999999999988, 29.476999999999986, 14.794666666666664, 23.281666666666663, 19.41666666666666, 32.74999999999999, 23.114999999999988, 32.86933333333334, 40.95233333333333, 41.1, 20.506999999999994], "episode_lengths": [58, 43, 51, 42, 47, 51, 54, 84, 31, 66, 38, 131, 95, 51, 67, 44, 94, 55, 112, 30, 37, 49, 40, 70, 33, 52, 35, 43, 33, 32, 30, 70, 69, 45, 33, 35, 31, 37, 63, 66, 32, 42, 39, 40, 74, 38, 62, 60, 54, 41, 81, 37, 51, 79, 93, 78, 35, 51, 71, 71, 51, 82, 73, 69, 110, 31, 65, 95, 60, 43, 30, 74, 66, 29, 38, 42, 36, 53, 47, 76, 52, 51, 83, 68, 65, 52, 78, 58, 39, 53, 64, 29, 55, 35, 72, 66, 67, 88, 85, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6409805112856395, "mean_inference_ms": 2.8503015849977804, "mean_action_processing_ms": 0.6294383757570056, "mean_env_wait_ms": 0.15037370935386443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020464181900024414, "StateBufferConnector_ms": 0.022769689559936523, "ViewRequirementAgentConnector_ms": 0.5101957321166992}}, "episode_reward_max": 59.93366666666666, "episode_reward_min": 14.73633333333333, "episode_reward_mean": 27.07106666666666, "episode_len_mean": 56.48, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.648333333333316, 20.040999999999997, 20.587666666666667, 17.25099999999999, 23.16166666666666, 32.24966666666666, 20.670999999999996, 33.86366666666665, 15.481999999999996, 32.72233333333332, 18.04699999999999, 53.674666666666674, 49.510000000000026, 23.660666666666653, 40.75166666666665, 20.456333333333333, 35.13966666666665, 26.670333333333335, 45.126999999999974, 14.800333333333333, 19.748333333333335, 25.054666666666666, 21.14699999999999, 25.58033333333333, 16.13033333333333, 27.754999999999995, 18.493333333333325, 20.39233333333333, 18.283999999999995, 15.098333333333331, 16.555333333333337, 42.90766666666665, 27.693333333333314, 22.100999999999992, 15.578333333333331, 17.878666666666664, 15.741999999999996, 16.33, 23.302999999999983, 43.66433333333334, 15.831666666666663, 22.33033333333333, 20.201999999999995, 16.476666666666663, 35.85633333333333, 18.582333333333334, 30.577000000000005, 29.663666666666657, 25.78566666666666, 17.317, 34.57499999999998, 17.97199999999999, 28.27933333333333, 27.197666666666642, 50.24399999999999, 45.71033333333335, 14.79266666666666, 26.198666666666675, 24.006666666666646, 40.31466666666665, 22.91799999999999, 35.198333333333295, 29.32899999999999, 40.85166666666667, 59.93366666666666, 15.159666666666666, 28.304666666666666, 50.2686666666667, 31.555, 18.813999999999997, 15.20366666666666, 27.002999999999986, 39.52966666666667, 14.73633333333333, 15.725666666666662, 16.507666666666665, 17.722999999999995, 24.010333333333328, 22.967333333333325, 48.452, 22.68166666666666, 31.07533333333333, 40.50066666666669, 29.312333333333324, 39.06333333333334, 24.02166666666666, 35.53033333333335, 27.114666666666682, 21.25066666666666, 24.233999999999988, 29.476999999999986, 14.794666666666664, 23.281666666666663, 19.41666666666666, 32.74999999999999, 23.114999999999988, 32.86933333333334, 40.95233333333333, 41.1, 20.506999999999994], "episode_lengths": [58, 43, 51, 42, 47, 51, 54, 84, 31, 66, 38, 131, 95, 51, 67, 44, 94, 55, 112, 30, 37, 49, 40, 70, 33, 52, 35, 43, 33, 32, 30, 70, 69, 45, 33, 35, 31, 37, 63, 66, 32, 42, 39, 40, 74, 38, 62, 60, 54, 41, 81, 37, 51, 79, 93, 78, 35, 51, 71, 71, 51, 82, 73, 69, 110, 31, 65, 95, 60, 43, 30, 74, 66, 29, 38, 42, 36, 53, 47, 76, 52, 51, 83, 68, 65, 52, 78, 58, 39, 53, 64, 29, 55, 35, 72, 66, 67, 88, 85, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6409805112856395, "mean_inference_ms": 2.8503015849977804, "mean_action_processing_ms": 0.6294383757570056, "mean_env_wait_ms": 0.15037370935386443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020464181900024414, "StateBufferConnector_ms": 0.022769689559936523, "ViewRequirementAgentConnector_ms": 0.5101957321166992}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.3287032017999, "num_env_steps_trained_throughput_per_sec": 447.3287032017999, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 8967.252, "sample_time_ms": 3054.431, "load_time_ms": 0.687, "load_throughput": 5824815.471, "learn_time_ms": 5879.598, "learn_throughput": 680.319, "synch_weights_time_ms": 30.646}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 2197, "training_iteration": 23, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-49-11", "timestamp": 1701996551, "time_this_iter_s": 8.99216341972351, "time_total_s": 210.4869740009308, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 210.4869740009308, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 77.225, "ram_util_percent": 92.85833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.746581958490424e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5.59042501449585, "policy_loss": -0.002776657696813345, "vf_loss": 5.593201637268066, "vf_explained_var": 0.6609688997268677, "kl": 0.00038670928915962577, "entropy": 0.044000908732414246, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 53.028999999999996, "episode_reward_min": 14.224999999999998, "episode_reward_mean": 27.51941333333333, "episode_len_mean": 57.92, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.813999999999997, 15.20366666666666, 27.002999999999986, 39.52966666666667, 14.73633333333333, 15.725666666666662, 16.507666666666665, 17.722999999999995, 24.010333333333328, 22.967333333333325, 48.452, 22.68166666666666, 31.07533333333333, 40.50066666666669, 29.312333333333324, 39.06333333333334, 24.02166666666666, 35.53033333333335, 27.114666666666682, 21.25066666666666, 24.233999999999988, 29.476999999999986, 14.794666666666664, 23.281666666666663, 19.41666666666666, 32.74999999999999, 23.114999999999988, 32.86933333333334, 40.95233333333333, 41.1, 20.506999999999994, 39.98166666666668, 36.12233333333333, 28.802999999999976, 19.23699999999999, 31.52866666666666, 18.616999999999994, 14.224999999999998, 35.29633333333333, 17.781, 22.59299999999999, 24.332666666666668, 18.267666666666663, 48.413666666666686, 36.793666666666674, 17.816, 18.286999999999992, 16.036999999999992, 33.60699999999999, 17.322, 19.357999999999997, 18.843999999999994, 34.66233333333332, 26.949666666666666, 36.16633333333334, 34.85566666666665, 14.956999999999994, 19.042666666666655, 23.550333333333327, 35.03700000000002, 19.914333333333317, 24.282666666666653, 22.467333333333315, 27.799666666666656, 23.377, 35.671333333333344, 25.609666666666666, 17.14566666666666, 21.050333333333324, 35.068999999999974, 19.577666666666655, 23.640999999999984, 28.362, 16.319666666666663, 43.10166666666665, 18.250999999999994, 44.12366666666668, 40.510333333333335, 21.00699999999999, 40.40566666666669, 27.116000000000007, 26.219333333333328, 17.714999999999996, 15.315999999999995, 18.30066666666666, 22.66399999999999, 40.983999999999995, 47.614333333333285, 43.77433333333333, 23.145333333333337, 36.49799999999999, 19.71199999999999, 26.113000000000007, 46.26866666666667, 23.478666666666662, 20.22933333333333, 52.67133333333331, 17.676333333333332, 53.028999999999996, 33.523666666666635], "episode_lengths": [43, 30, 74, 66, 29, 38, 42, 36, 53, 47, 76, 52, 51, 83, 68, 65, 52, 78, 58, 39, 53, 64, 29, 55, 35, 72, 66, 67, 88, 85, 42, 79, 80, 85, 37, 59, 40, 27, 82, 32, 48, 59, 50, 82, 93, 33, 44, 34, 68, 33, 39, 41, 84, 47, 84, 64, 32, 51, 62, 72, 66, 47, 65, 66, 44, 71, 46, 36, 42, 88, 42, 50, 51, 36, 96, 36, 80, 66, 42, 77, 66, 51, 36, 33, 39, 59, 71, 102, 94, 45, 69, 50, 46, 95, 55, 38, 99, 36, 100, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6403685903247998, "mean_inference_ms": 2.8506720183088046, "mean_action_processing_ms": 0.6298993777928807, "mean_env_wait_ms": 0.14992864048006324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018367290496826172, "StateBufferConnector_ms": 0.017012357711791992, "ViewRequirementAgentConnector_ms": 0.5450356006622314}}, "episode_reward_max": 53.028999999999996, "episode_reward_min": 14.224999999999998, "episode_reward_mean": 27.51941333333333, "episode_len_mean": 57.92, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.813999999999997, 15.20366666666666, 27.002999999999986, 39.52966666666667, 14.73633333333333, 15.725666666666662, 16.507666666666665, 17.722999999999995, 24.010333333333328, 22.967333333333325, 48.452, 22.68166666666666, 31.07533333333333, 40.50066666666669, 29.312333333333324, 39.06333333333334, 24.02166666666666, 35.53033333333335, 27.114666666666682, 21.25066666666666, 24.233999999999988, 29.476999999999986, 14.794666666666664, 23.281666666666663, 19.41666666666666, 32.74999999999999, 23.114999999999988, 32.86933333333334, 40.95233333333333, 41.1, 20.506999999999994, 39.98166666666668, 36.12233333333333, 28.802999999999976, 19.23699999999999, 31.52866666666666, 18.616999999999994, 14.224999999999998, 35.29633333333333, 17.781, 22.59299999999999, 24.332666666666668, 18.267666666666663, 48.413666666666686, 36.793666666666674, 17.816, 18.286999999999992, 16.036999999999992, 33.60699999999999, 17.322, 19.357999999999997, 18.843999999999994, 34.66233333333332, 26.949666666666666, 36.16633333333334, 34.85566666666665, 14.956999999999994, 19.042666666666655, 23.550333333333327, 35.03700000000002, 19.914333333333317, 24.282666666666653, 22.467333333333315, 27.799666666666656, 23.377, 35.671333333333344, 25.609666666666666, 17.14566666666666, 21.050333333333324, 35.068999999999974, 19.577666666666655, 23.640999999999984, 28.362, 16.319666666666663, 43.10166666666665, 18.250999999999994, 44.12366666666668, 40.510333333333335, 21.00699999999999, 40.40566666666669, 27.116000000000007, 26.219333333333328, 17.714999999999996, 15.315999999999995, 18.30066666666666, 22.66399999999999, 40.983999999999995, 47.614333333333285, 43.77433333333333, 23.145333333333337, 36.49799999999999, 19.71199999999999, 26.113000000000007, 46.26866666666667, 23.478666666666662, 20.22933333333333, 52.67133333333331, 17.676333333333332, 53.028999999999996, 33.523666666666635], "episode_lengths": [43, 30, 74, 66, 29, 38, 42, 36, 53, 47, 76, 52, 51, 83, 68, 65, 52, 78, 58, 39, 53, 64, 29, 55, 35, 72, 66, 67, 88, 85, 42, 79, 80, 85, 37, 59, 40, 27, 82, 32, 48, 59, 50, 82, 93, 33, 44, 34, 68, 33, 39, 41, 84, 47, 84, 64, 32, 51, 62, 72, 66, 47, 65, 66, 44, 71, 46, 36, 42, 88, 42, 50, 51, 36, 96, 36, 80, 66, 42, 77, 66, 51, 36, 33, 39, 59, 71, 102, 94, 45, 69, 50, 46, 95, 55, 38, 99, 36, 100, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6403685903247998, "mean_inference_ms": 2.8506720183088046, "mean_action_processing_ms": 0.6298993777928807, "mean_env_wait_ms": 0.14992864048006324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018367290496826172, "StateBufferConnector_ms": 0.017012357711791992, "ViewRequirementAgentConnector_ms": 0.5450356006622314}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.9947785011422, "num_env_steps_trained_throughput_per_sec": 463.9947785011422, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 8937.117, "sample_time_ms": 3067.439, "load_time_ms": 0.587, "load_throughput": 6817789.337, "learn_time_ms": 5836.039, "learn_throughput": 685.396, "synch_weights_time_ms": 31.052}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 2266, "training_iteration": 24, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-49-20", "timestamp": 1701996560, "time_this_iter_s": 8.647574424743652, "time_total_s": 219.13454842567444, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 219.13454842567444, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 73.38333333333334, "ram_util_percent": 93.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.373290979245212e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6.1411237716674805, "policy_loss": -0.005314326379448175, "vf_loss": 6.146438121795654, "vf_explained_var": 0.5197758674621582, "kl": 0.00037639756919816136, "entropy": 0.0352996326982975, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 60.909000000000034, "episode_reward_min": 14.421666666666663, "episode_reward_mean": 29.313693333333326, "episode_len_mean": 60.54, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.609666666666666, 17.14566666666666, 21.050333333333324, 35.068999999999974, 19.577666666666655, 23.640999999999984, 28.362, 16.319666666666663, 43.10166666666665, 18.250999999999994, 44.12366666666668, 40.510333333333335, 21.00699999999999, 40.40566666666669, 27.116000000000007, 26.219333333333328, 17.714999999999996, 15.315999999999995, 18.30066666666666, 22.66399999999999, 40.983999999999995, 47.614333333333285, 43.77433333333333, 23.145333333333337, 36.49799999999999, 19.71199999999999, 26.113000000000007, 46.26866666666667, 23.478666666666662, 20.22933333333333, 52.67133333333331, 17.676333333333332, 53.028999999999996, 33.523666666666635, 60.909000000000034, 15.553666666666665, 37.125000000000014, 37.81766666666667, 22.083666666666655, 34.39533333333333, 32.65866666666663, 17.839, 20.220333333333333, 18.036666666666665, 20.345666666666663, 17.618999999999996, 15.188333333333329, 33.01166666666665, 18.34033333333333, 15.625999999999996, 21.49533333333333, 19.955333333333314, 15.953666666666658, 50.768999999999984, 21.04366666666665, 33.831666666666685, 24.611999999999988, 17.28566666666666, 30.73699999999999, 44.08366666666664, 29.262333333333324, 38.86966666666666, 20.514333333333333, 48.775666666666645, 27.68499999999999, 34.42133333333333, 42.27799999999998, 17.714333333333332, 27.81099999999999, 47.598333333333294, 14.421666666666663, 16.089, 19.075333333333326, 34.31433333333333, 21.05966666666666, 25.464333333333315, 54.051000000000016, 17.902999999999995, 14.431666666666661, 28.24266666666667, 19.641666666666662, 33.697666666666656, 22.47966666666665, 20.720333333333336, 21.594333333333335, 14.485666666666665, 21.731999999999992, 51.642000000000024, 48.31533333333331, 24.352333333333327, 50.150999999999954, 19.14466666666666, 58.32266666666664, 47.222333333333324, 57.42933333333337, 25.02833333333333, 56.28933333333331, 18.857666666666667, 16.924666666666663, 20.595333333333325], "episode_lengths": [46, 36, 42, 88, 42, 50, 51, 36, 96, 36, 80, 66, 42, 77, 66, 51, 36, 33, 39, 59, 71, 102, 94, 45, 69, 50, 46, 95, 55, 38, 99, 36, 100, 84, 114, 30, 74, 68, 67, 61, 89, 37, 44, 39, 42, 39, 32, 72, 40, 32, 47, 57, 34, 105, 50, 70, 65, 33, 51, 77, 78, 86, 45, 90, 52, 63, 87, 42, 60, 98, 30, 34, 39, 76, 46, 76, 92, 44, 29, 62, 41, 68, 54, 49, 46, 28, 43, 91, 117, 44, 93, 39, 101, 99, 99, 63, 95, 36, 41, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6400620329940068, "mean_inference_ms": 2.8520169823971395, "mean_action_processing_ms": 0.6297030957460058, "mean_env_wait_ms": 0.14948467339640942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01929306983947754, "StateBufferConnector_ms": 0.02057790756225586, "ViewRequirementAgentConnector_ms": 0.5450997352600098}}, "episode_reward_max": 60.909000000000034, "episode_reward_min": 14.421666666666663, "episode_reward_mean": 29.313693333333326, "episode_len_mean": 60.54, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.609666666666666, 17.14566666666666, 21.050333333333324, 35.068999999999974, 19.577666666666655, 23.640999999999984, 28.362, 16.319666666666663, 43.10166666666665, 18.250999999999994, 44.12366666666668, 40.510333333333335, 21.00699999999999, 40.40566666666669, 27.116000000000007, 26.219333333333328, 17.714999999999996, 15.315999999999995, 18.30066666666666, 22.66399999999999, 40.983999999999995, 47.614333333333285, 43.77433333333333, 23.145333333333337, 36.49799999999999, 19.71199999999999, 26.113000000000007, 46.26866666666667, 23.478666666666662, 20.22933333333333, 52.67133333333331, 17.676333333333332, 53.028999999999996, 33.523666666666635, 60.909000000000034, 15.553666666666665, 37.125000000000014, 37.81766666666667, 22.083666666666655, 34.39533333333333, 32.65866666666663, 17.839, 20.220333333333333, 18.036666666666665, 20.345666666666663, 17.618999999999996, 15.188333333333329, 33.01166666666665, 18.34033333333333, 15.625999999999996, 21.49533333333333, 19.955333333333314, 15.953666666666658, 50.768999999999984, 21.04366666666665, 33.831666666666685, 24.611999999999988, 17.28566666666666, 30.73699999999999, 44.08366666666664, 29.262333333333324, 38.86966666666666, 20.514333333333333, 48.775666666666645, 27.68499999999999, 34.42133333333333, 42.27799999999998, 17.714333333333332, 27.81099999999999, 47.598333333333294, 14.421666666666663, 16.089, 19.075333333333326, 34.31433333333333, 21.05966666666666, 25.464333333333315, 54.051000000000016, 17.902999999999995, 14.431666666666661, 28.24266666666667, 19.641666666666662, 33.697666666666656, 22.47966666666665, 20.720333333333336, 21.594333333333335, 14.485666666666665, 21.731999999999992, 51.642000000000024, 48.31533333333331, 24.352333333333327, 50.150999999999954, 19.14466666666666, 58.32266666666664, 47.222333333333324, 57.42933333333337, 25.02833333333333, 56.28933333333331, 18.857666666666667, 16.924666666666663, 20.595333333333325], "episode_lengths": [46, 36, 42, 88, 42, 50, 51, 36, 96, 36, 80, 66, 42, 77, 66, 51, 36, 33, 39, 59, 71, 102, 94, 45, 69, 50, 46, 95, 55, 38, 99, 36, 100, 84, 114, 30, 74, 68, 67, 61, 89, 37, 44, 39, 42, 39, 32, 72, 40, 32, 47, 57, 34, 105, 50, 70, 65, 33, 51, 77, 78, 86, 45, 90, 52, 63, 87, 42, 60, 98, 30, 34, 39, 76, 46, 76, 92, 44, 29, 62, 41, 68, 54, 49, 46, 28, 43, 91, 117, 44, 93, 39, 101, 99, 99, 63, 95, 36, 41, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6400620329940068, "mean_inference_ms": 2.8520169823971395, "mean_action_processing_ms": 0.6297030957460058, "mean_env_wait_ms": 0.14948467339640942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01929306983947754, "StateBufferConnector_ms": 0.02057790756225586, "ViewRequirementAgentConnector_ms": 0.5450997352600098}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.4947331749815, "num_env_steps_trained_throughput_per_sec": 422.4947331749815, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9000.294, "sample_time_ms": 3084.102, "load_time_ms": 0.487, "load_throughput": 8219693.303, "learn_time_ms": 5882.867, "learn_throughput": 679.941, "synch_weights_time_ms": 30.635}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 2332, "training_iteration": 25, "trial_id": "ebb9e_00000", "date": "2023-12-07_16-49-29", "timestamp": 1701996569, "time_this_iter_s": 9.509260416030884, "time_total_s": 228.64380884170532, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 228.64380884170532, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 70.92307692307692, "ram_util_percent": 94.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.86645489622606e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 5.248999118804932, "policy_loss": -0.006397401448339224, "vf_loss": 5.255396842956543, "vf_explained_var": 0.646263062953949, "kl": 0.0004741079465020448, "entropy": 0.027037091553211212, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 58.32266666666664, "episode_reward_min": 14.124999999999996, "episode_reward_mean": 27.490929999999995, "episode_len_mean": 57.38, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.421666666666663, 16.089, 19.075333333333326, 34.31433333333333, 21.05966666666666, 25.464333333333315, 54.051000000000016, 17.902999999999995, 14.431666666666661, 28.24266666666667, 19.641666666666662, 33.697666666666656, 22.47966666666665, 20.720333333333336, 21.594333333333335, 14.485666666666665, 21.731999999999992, 51.642000000000024, 48.31533333333331, 24.352333333333327, 50.150999999999954, 19.14466666666666, 58.32266666666664, 47.222333333333324, 57.42933333333337, 25.02833333333333, 56.28933333333331, 18.857666666666667, 16.924666666666663, 20.595333333333325, 34.81533333333333, 28.448333333333323, 19.932999999999993, 21.503999999999998, 29.658666666666665, 17.286333333333328, 31.51866666666666, 19.425333333333327, 23.15899999999999, 30.335333333333335, 42.5023333333333, 16.214999999999993, 16.882333333333328, 39.206333333333326, 36.309, 18.227666666666664, 21.09999999999999, 23.009666666666664, 14.407, 22.140333333333327, 40.62533333333332, 22.366333333333326, 41.73833333333332, 22.505666666666656, 18.297666666666657, 15.904333333333323, 47.23166666666666, 40.24033333333333, 30.06099999999999, 19.801999999999996, 19.681, 22.28766666666666, 20.491333333333323, 17.17633333333333, 19.64233333333333, 53.937666666666686, 25.92833333333331, 22.646999999999995, 30.580333333333318, 38.79099999999998, 26.724999999999994, 14.124999999999996, 17.609999999999992, 35.839, 24.236333333333338, 19.877333333333333, 15.31666666666666, 28.528333333333315, 18.565666666666658, 43.851333333333336, 29.16966666666665, 17.40933333333333, 23.016333333333314, 25.962333333333312, 35.97833333333333, 18.83866666666666, 21.982333333333322, 24.08033333333331, 30.273333333333326, 31.626999999999992, 20.787, 28.02900000000001, 24.33033333333333, 39.554333333333325, 23.099000000000004, 18.717, 43.984, 19.11599999999999, 30.808333333333326, 27.957333333333334], "episode_lengths": [30, 34, 39, 76, 46, 76, 92, 44, 29, 62, 41, 68, 54, 49, 46, 28, 43, 91, 117, 44, 93, 39, 101, 99, 99, 63, 95, 36, 41, 53, 65, 47, 40, 45, 53, 34, 63, 41, 51, 53, 82, 34, 38, 72, 68, 46, 60, 58, 28, 50, 71, 46, 72, 56, 36, 35, 97, 91, 76, 35, 36, 52, 45, 34, 38, 78, 74, 66, 54, 92, 66, 30, 39, 88, 54, 43, 33, 69, 50, 79, 72, 33, 54, 64, 70, 35, 48, 67, 47, 70, 42, 54, 49, 96, 46, 42, 83, 47, 59, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6398888323405947, "mean_inference_ms": 2.85831910025145, "mean_action_processing_ms": 0.6300640244544414, "mean_env_wait_ms": 0.15038168117975345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015061378479003906, "StateBufferConnector_ms": 0.03364443778991699, "ViewRequirementAgentConnector_ms": 0.5392048358917236}}, "episode_reward_max": 58.32266666666664, "episode_reward_min": 14.124999999999996, "episode_reward_mean": 27.490929999999995, "episode_len_mean": 57.38, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.421666666666663, 16.089, 19.075333333333326, 34.31433333333333, 21.05966666666666, 25.464333333333315, 54.051000000000016, 17.902999999999995, 14.431666666666661, 28.24266666666667, 19.641666666666662, 33.697666666666656, 22.47966666666665, 20.720333333333336, 21.594333333333335, 14.485666666666665, 21.731999999999992, 51.642000000000024, 48.31533333333331, 24.352333333333327, 50.150999999999954, 19.14466666666666, 58.32266666666664, 47.222333333333324, 57.42933333333337, 25.02833333333333, 56.28933333333331, 18.857666666666667, 16.924666666666663, 20.595333333333325, 34.81533333333333, 28.448333333333323, 19.932999999999993, 21.503999999999998, 29.658666666666665, 17.286333333333328, 31.51866666666666, 19.425333333333327, 23.15899999999999, 30.335333333333335, 42.5023333333333, 16.214999999999993, 16.882333333333328, 39.206333333333326, 36.309, 18.227666666666664, 21.09999999999999, 23.009666666666664, 14.407, 22.140333333333327, 40.62533333333332, 22.366333333333326, 41.73833333333332, 22.505666666666656, 18.297666666666657, 15.904333333333323, 47.23166666666666, 40.24033333333333, 30.06099999999999, 19.801999999999996, 19.681, 22.28766666666666, 20.491333333333323, 17.17633333333333, 19.64233333333333, 53.937666666666686, 25.92833333333331, 22.646999999999995, 30.580333333333318, 38.79099999999998, 26.724999999999994, 14.124999999999996, 17.609999999999992, 35.839, 24.236333333333338, 19.877333333333333, 15.31666666666666, 28.528333333333315, 18.565666666666658, 43.851333333333336, 29.16966666666665, 17.40933333333333, 23.016333333333314, 25.962333333333312, 35.97833333333333, 18.83866666666666, 21.982333333333322, 24.08033333333331, 30.273333333333326, 31.626999999999992, 20.787, 28.02900000000001, 24.33033333333333, 39.554333333333325, 23.099000000000004, 18.717, 43.984, 19.11599999999999, 30.808333333333326, 27.957333333333334], "episode_lengths": [30, 34, 39, 76, 46, 76, 92, 44, 29, 62, 41, 68, 54, 49, 46, 28, 43, 91, 117, 44, 93, 39, 101, 99, 99, 63, 95, 36, 41, 53, 65, 47, 40, 45, 53, 34, 63, 41, 51, 53, 82, 34, 38, 72, 68, 46, 60, 58, 28, 50, 71, 46, 72, 56, 36, 35, 97, 91, 76, 35, 36, 52, 45, 34, 38, 78, 74, 66, 54, 92, 66, 30, 39, 88, 54, 43, 33, 69, 50, 79, 72, 33, 54, 64, 70, 35, 48, 67, 47, 70, 42, 54, 49, 96, 46, 42, 83, 47, 59, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6398888323405947, "mean_inference_ms": 2.85831910025145, "mean_action_processing_ms": 0.6300640244544414, "mean_env_wait_ms": 0.15038168117975345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015061378479003906, "StateBufferConnector_ms": 0.03364443778991699, "ViewRequirementAgentConnector_ms": 0.5392048358917236}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.2493378322784494, "num_env_steps_trained_throughput_per_sec": 3.2493378322784494, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 131223.777, "sample_time_ms": 3106.086, "load_time_ms": 0.468, "load_throughput": 8541500.865, "learn_time_ms": 128082.156, "learn_throughput": 31.23, "synch_weights_time_ms": 32.738}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 2402, "training_iteration": 26, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-10-15", "timestamp": 1701997815, "time_this_iter_s": 1245.159434556961, "time_total_s": 1473.8032433986664, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1473.8032433986664, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 91.99142857142857, "ram_util_percent": 97.64285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.43322744811303e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 6.277286052703857, "policy_loss": -0.011605646461248398, "vf_loss": 6.288891315460205, "vf_explained_var": 0.5752398371696472, "kl": 0.04582232981920242, "entropy": 0.11680258810520172, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 78.2763333333334, "episode_reward_min": 14.098333333333331, "episode_reward_mean": 28.26000333333333, "episode_len_mean": 60.35, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.92833333333331, 22.646999999999995, 30.580333333333318, 38.79099999999998, 26.724999999999994, 14.124999999999996, 17.609999999999992, 35.839, 24.236333333333338, 19.877333333333333, 15.31666666666666, 28.528333333333315, 18.565666666666658, 43.851333333333336, 29.16966666666665, 17.40933333333333, 23.016333333333314, 25.962333333333312, 35.97833333333333, 18.83866666666666, 21.982333333333322, 24.08033333333331, 30.273333333333326, 31.626999999999992, 20.787, 28.02900000000001, 24.33033333333333, 39.554333333333325, 23.099000000000004, 18.717, 43.984, 19.11599999999999, 30.808333333333326, 27.957333333333334, 28.245666666666672, 46.326, 22.07633333333334, 22.674999999999994, 17.033666666666658, 21.726999999999997, 43.51833333333335, 18.819999999999997, 27.360666666666663, 35.402, 16.627666666666663, 35.571999999999996, 33.121, 18.87933333333332, 33.95766666666666, 14.098333333333331, 21.541333333333323, 32.32433333333333, 27.981000000000005, 20.467666666666656, 24.57333333333333, 24.092000000000002, 35.67399999999999, 16.610333333333326, 78.2763333333334, 20.13366666666666, 57.72066666666668, 20.678333333333324, 48.29200000000003, 15.555666666666662, 41.3263333333333, 28.962999999999987, 41.78999999999998, 55.96966666666662, 19.506666666666664, 16.527999999999995, 18.822666666666663, 25.02166666666666, 22.007, 47.65166666666666, 28.585333333333338, 20.376999999999995, 16.104666666666667, 43.58433333333334, 22.20833333333331, 45.80833333333334, 32.091, 24.36766666666665, 22.01766666666666, 30.636666666666656, 45.31066666666666, 34.36366666666664, 32.82366666666668, 27.371999999999996, 25.198999999999995, 18.474999999999994, 30.747666666666642, 14.821666666666667, 16.958666666666662, 24.377333333333333, 19.828666666666653, 36.81366666666665, 14.44233333333333, 16.163999999999998, 31.456999999999997, 56.774999999999984], "episode_lengths": [74, 66, 54, 92, 66, 30, 39, 88, 54, 43, 33, 69, 50, 79, 72, 33, 54, 64, 70, 35, 48, 67, 47, 70, 42, 54, 49, 96, 46, 42, 83, 47, 59, 69, 66, 91, 48, 60, 34, 56, 76, 47, 61, 65, 33, 75, 83, 45, 67, 30, 49, 80, 56, 58, 52, 43, 59, 33, 146, 42, 105, 42, 85, 34, 104, 54, 97, 136, 47, 37, 37, 52, 45, 82, 49, 38, 33, 90, 62, 107, 62, 60, 46, 55, 77, 77, 55, 59, 75, 40, 84, 29, 33, 43, 48, 83, 32, 33, 61, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.645209002523189, "mean_inference_ms": 2.885234803491445, "mean_action_processing_ms": 0.6288118152762173, "mean_env_wait_ms": 0.15046851965591387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02922224998474121, "StateBufferConnector_ms": 0.02129840850830078, "ViewRequirementAgentConnector_ms": 0.5530900955200195}}, "episode_reward_max": 78.2763333333334, "episode_reward_min": 14.098333333333331, "episode_reward_mean": 28.26000333333333, "episode_len_mean": 60.35, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.92833333333331, 22.646999999999995, 30.580333333333318, 38.79099999999998, 26.724999999999994, 14.124999999999996, 17.609999999999992, 35.839, 24.236333333333338, 19.877333333333333, 15.31666666666666, 28.528333333333315, 18.565666666666658, 43.851333333333336, 29.16966666666665, 17.40933333333333, 23.016333333333314, 25.962333333333312, 35.97833333333333, 18.83866666666666, 21.982333333333322, 24.08033333333331, 30.273333333333326, 31.626999999999992, 20.787, 28.02900000000001, 24.33033333333333, 39.554333333333325, 23.099000000000004, 18.717, 43.984, 19.11599999999999, 30.808333333333326, 27.957333333333334, 28.245666666666672, 46.326, 22.07633333333334, 22.674999999999994, 17.033666666666658, 21.726999999999997, 43.51833333333335, 18.819999999999997, 27.360666666666663, 35.402, 16.627666666666663, 35.571999999999996, 33.121, 18.87933333333332, 33.95766666666666, 14.098333333333331, 21.541333333333323, 32.32433333333333, 27.981000000000005, 20.467666666666656, 24.57333333333333, 24.092000000000002, 35.67399999999999, 16.610333333333326, 78.2763333333334, 20.13366666666666, 57.72066666666668, 20.678333333333324, 48.29200000000003, 15.555666666666662, 41.3263333333333, 28.962999999999987, 41.78999999999998, 55.96966666666662, 19.506666666666664, 16.527999999999995, 18.822666666666663, 25.02166666666666, 22.007, 47.65166666666666, 28.585333333333338, 20.376999999999995, 16.104666666666667, 43.58433333333334, 22.20833333333331, 45.80833333333334, 32.091, 24.36766666666665, 22.01766666666666, 30.636666666666656, 45.31066666666666, 34.36366666666664, 32.82366666666668, 27.371999999999996, 25.198999999999995, 18.474999999999994, 30.747666666666642, 14.821666666666667, 16.958666666666662, 24.377333333333333, 19.828666666666653, 36.81366666666665, 14.44233333333333, 16.163999999999998, 31.456999999999997, 56.774999999999984], "episode_lengths": [74, 66, 54, 92, 66, 30, 39, 88, 54, 43, 33, 69, 50, 79, 72, 33, 54, 64, 70, 35, 48, 67, 47, 70, 42, 54, 49, 96, 46, 42, 83, 47, 59, 69, 66, 91, 48, 60, 34, 56, 76, 47, 61, 65, 33, 75, 83, 45, 67, 30, 49, 80, 56, 58, 52, 43, 59, 33, 146, 42, 105, 42, 85, 34, 104, 54, 97, 136, 47, 37, 37, 52, 45, 82, 49, 38, 33, 90, 62, 107, 62, 60, 46, 55, 77, 77, 55, 59, 75, 40, 84, 29, 33, 43, 48, 83, 32, 33, 61, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.645209002523189, "mean_inference_ms": 2.885234803491445, "mean_action_processing_ms": 0.6288118152762173, "mean_env_wait_ms": 0.15046851965591387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02922224998474121, "StateBufferConnector_ms": 0.02129840850830078, "ViewRequirementAgentConnector_ms": 0.5530900955200195}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.1373094629073, "num_env_steps_trained_throughput_per_sec": 400.1373094629073, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 131427.621, "sample_time_ms": 3296.151, "load_time_ms": 0.641, "load_throughput": 6239434.713, "learn_time_ms": 128092.982, "learn_throughput": 31.227, "synch_weights_time_ms": 34.984}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 2468, "training_iteration": 27, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-10-25", "timestamp": 1701997825, "time_this_iter_s": 10.03357744216919, "time_total_s": 1483.8368208408356, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1483.8368208408356, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 92.30000000000001, "ram_util_percent": 96.23846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.14984139954322e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 5.795298099517822, "policy_loss": -0.004738719202578068, "vf_loss": 5.800036907196045, "vf_explained_var": 0.5641408562660217, "kl": 0.0020196407567709684, "entropy": 0.07490410655736923, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 58.45000000000006, "episode_reward_min": 12.968333333333332, "episode_reward_mean": 26.581163333333333, "episode_len_mean": 57.77, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.822666666666663, 25.02166666666666, 22.007, 47.65166666666666, 28.585333333333338, 20.376999999999995, 16.104666666666667, 43.58433333333334, 22.20833333333331, 45.80833333333334, 32.091, 24.36766666666665, 22.01766666666666, 30.636666666666656, 45.31066666666666, 34.36366666666664, 32.82366666666668, 27.371999999999996, 25.198999999999995, 18.474999999999994, 30.747666666666642, 14.821666666666667, 16.958666666666662, 24.377333333333333, 19.828666666666653, 36.81366666666665, 14.44233333333333, 16.163999999999998, 31.456999999999997, 56.774999999999984, 18.252666666666663, 32.96966666666668, 58.45000000000006, 13.40833333333333, 54.98466666666665, 22.72933333333334, 16.053999999999995, 24.977999999999998, 30.45899999999999, 46.25700000000002, 19.244333333333334, 22.093333333333334, 40.69999999999999, 22.545000000000005, 51.87733333333335, 20.616666666666667, 22.22366666666666, 14.04433333333333, 37.645666666666656, 14.462666666666665, 29.93700000000001, 17.816666666666666, 15.936333333333328, 44.937666666666686, 18.022, 22.517666666666667, 29.07566666666667, 32.37133333333332, 54.04066666666672, 28.689666666666668, 14.924333333333331, 20.710666666666654, 21.601333333333326, 33.093, 17.407666666666664, 20.910333333333316, 13.168666666666665, 17.21933333333333, 18.752666666666666, 14.875999999999998, 28.435, 24.747333333333334, 40.195666666666654, 14.208333333333325, 17.755333333333333, 24.91866666666667, 18.147666666666662, 20.584333333333326, 28.610333333333333, 39.15033333333332, 27.84466666666668, 15.704333333333324, 17.943333333333328, 37.609666666666655, 38.60800000000002, 20.09199999999999, 21.259, 26.921333333333305, 32.72299999999999, 16.884999999999994, 33.53466666666666, 12.968333333333332, 14.564, 23.747666666666664, 34.95133333333331, 19.42266666666667, 16.411333333333328, 17.304999999999993, 26.752666666666652, 30.89699999999999], "episode_lengths": [37, 52, 45, 82, 49, 38, 33, 90, 62, 107, 62, 60, 46, 55, 77, 77, 55, 59, 75, 40, 84, 29, 33, 43, 48, 83, 32, 33, 61, 108, 36, 60, 99, 30, 125, 51, 49, 55, 56, 94, 47, 51, 96, 43, 114, 44, 48, 32, 76, 33, 65, 46, 32, 78, 39, 62, 58, 59, 97, 84, 38, 79, 48, 57, 45, 66, 33, 36, 44, 35, 73, 44, 89, 32, 41, 54, 51, 50, 61, 91, 56, 43, 39, 74, 73, 49, 55, 77, 74, 52, 78, 29, 35, 44, 69, 43, 36, 40, 72, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6533480354672248, "mean_inference_ms": 2.9157640413120633, "mean_action_processing_ms": 0.6288481897278239, "mean_env_wait_ms": 0.15067809637423368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03762507438659668, "StateBufferConnector_ms": 0.014199018478393555, "ViewRequirementAgentConnector_ms": 0.670245885848999}}, "episode_reward_max": 58.45000000000006, "episode_reward_min": 12.968333333333332, "episode_reward_mean": 26.581163333333333, "episode_len_mean": 57.77, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.822666666666663, 25.02166666666666, 22.007, 47.65166666666666, 28.585333333333338, 20.376999999999995, 16.104666666666667, 43.58433333333334, 22.20833333333331, 45.80833333333334, 32.091, 24.36766666666665, 22.01766666666666, 30.636666666666656, 45.31066666666666, 34.36366666666664, 32.82366666666668, 27.371999999999996, 25.198999999999995, 18.474999999999994, 30.747666666666642, 14.821666666666667, 16.958666666666662, 24.377333333333333, 19.828666666666653, 36.81366666666665, 14.44233333333333, 16.163999999999998, 31.456999999999997, 56.774999999999984, 18.252666666666663, 32.96966666666668, 58.45000000000006, 13.40833333333333, 54.98466666666665, 22.72933333333334, 16.053999999999995, 24.977999999999998, 30.45899999999999, 46.25700000000002, 19.244333333333334, 22.093333333333334, 40.69999999999999, 22.545000000000005, 51.87733333333335, 20.616666666666667, 22.22366666666666, 14.04433333333333, 37.645666666666656, 14.462666666666665, 29.93700000000001, 17.816666666666666, 15.936333333333328, 44.937666666666686, 18.022, 22.517666666666667, 29.07566666666667, 32.37133333333332, 54.04066666666672, 28.689666666666668, 14.924333333333331, 20.710666666666654, 21.601333333333326, 33.093, 17.407666666666664, 20.910333333333316, 13.168666666666665, 17.21933333333333, 18.752666666666666, 14.875999999999998, 28.435, 24.747333333333334, 40.195666666666654, 14.208333333333325, 17.755333333333333, 24.91866666666667, 18.147666666666662, 20.584333333333326, 28.610333333333333, 39.15033333333332, 27.84466666666668, 15.704333333333324, 17.943333333333328, 37.609666666666655, 38.60800000000002, 20.09199999999999, 21.259, 26.921333333333305, 32.72299999999999, 16.884999999999994, 33.53466666666666, 12.968333333333332, 14.564, 23.747666666666664, 34.95133333333331, 19.42266666666667, 16.411333333333328, 17.304999999999993, 26.752666666666652, 30.89699999999999], "episode_lengths": [37, 52, 45, 82, 49, 38, 33, 90, 62, 107, 62, 60, 46, 55, 77, 77, 55, 59, 75, 40, 84, 29, 33, 43, 48, 83, 32, 33, 61, 108, 36, 60, 99, 30, 125, 51, 49, 55, 56, 94, 47, 51, 96, 43, 114, 44, 48, 32, 76, 33, 65, 46, 32, 78, 39, 62, 58, 59, 97, 84, 38, 79, 48, 57, 45, 66, 33, 36, 44, 35, 73, 44, 89, 32, 41, 54, 51, 50, 61, 91, 56, 43, 39, 74, 73, 49, 55, 77, 74, 52, 78, 29, 35, 44, 69, 43, 36, 40, 72, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6533480354672248, "mean_inference_ms": 2.9157640413120633, "mean_action_processing_ms": 0.6288481897278239, "mean_env_wait_ms": 0.15067809637423368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03762507438659668, "StateBufferConnector_ms": 0.014199018478393555, "ViewRequirementAgentConnector_ms": 0.670245885848999}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.98386181819427, "num_env_steps_trained_throughput_per_sec": 387.98386181819427, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 131522.463, "sample_time_ms": 3340.356, "load_time_ms": 0.644, "load_throughput": 6208954.517, "learn_time_ms": 128142.317, "learn_throughput": 31.215, "synch_weights_time_ms": 36.161}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 2538, "training_iteration": 28, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-10-35", "timestamp": 1701997835, "time_this_iter_s": 10.349703550338745, "time_total_s": 1494.1865243911743, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1494.1865243911743, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 85.00769230769232, "ram_util_percent": 95.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.57492069977161e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 5.718527317047119, "policy_loss": -0.0036161530297249556, "vf_loss": 5.722143650054932, "vf_explained_var": 0.5495312809944153, "kl": 0.0033838527742773294, "entropy": 0.0757163017988205, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 62.193666666666715, "episode_reward_min": 10.254999999999999, "episode_reward_mean": 25.264536666666665, "episode_len_mean": 55.05, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.747333333333334, 40.195666666666654, 14.208333333333325, 17.755333333333333, 24.91866666666667, 18.147666666666662, 20.584333333333326, 28.610333333333333, 39.15033333333332, 27.84466666666668, 15.704333333333324, 17.943333333333328, 37.609666666666655, 38.60800000000002, 20.09199999999999, 21.259, 26.921333333333305, 32.72299999999999, 16.884999999999994, 33.53466666666666, 12.968333333333332, 14.564, 23.747666666666664, 34.95133333333331, 19.42266666666667, 16.411333333333328, 17.304999999999993, 26.752666666666652, 30.89699999999999, 15.891000000000002, 27.95566666666666, 26.574333333333335, 18.433333333333334, 24.08399999999998, 12.967333333333327, 16.437333333333324, 18.30566666666666, 31.13933333333333, 19.15233333333334, 22.519, 39.02500000000001, 47.13766666666664, 15.853666666666665, 17.464666666666663, 36.666333333333334, 13.593666666666664, 23.194666666666667, 14.807999999999996, 14.366999999999994, 11.297666666666666, 13.780666666666663, 32.203666666666635, 32.170333333333325, 27.173000000000002, 11.005666666666666, 29.567000000000007, 10.254999999999999, 35.672999999999995, 30.288999999999984, 26.954666666666643, 43.28166666666667, 22.87166666666667, 25.85633333333333, 20.289666666666665, 34.23033333333333, 14.186999999999992, 27.03233333333333, 17.06066666666666, 21.863999999999994, 13.483666666666661, 31.819999999999983, 30.158666666666665, 52.17033333333332, 16.833, 41.328000000000024, 13.545333333333334, 21.50733333333333, 62.193666666666715, 20.26799999999999, 15.676000000000002, 37.52199999999999, 29.757999999999992, 42.81566666666667, 25.64233333333334, 23.83966666666666, 18.193666666666655, 27.538666666666632, 31.56366666666665, 15.651999999999994, 25.91166666666666, 15.71933333333333, 11.924999999999997, 27.038666666666664, 37.785000000000004, 16.01166666666666, 24.056333333333335, 42.72366666666668, 27.457333333333334, 18.407999999999994, 50.83099999999999], "episode_lengths": [44, 89, 32, 41, 54, 51, 50, 61, 91, 56, 43, 39, 74, 73, 49, 55, 77, 74, 52, 78, 29, 35, 44, 69, 43, 36, 40, 72, 58, 35, 56, 66, 47, 73, 30, 35, 39, 61, 40, 43, 76, 106, 38, 43, 66, 33, 46, 29, 34, 26, 29, 90, 92, 54, 23, 61, 23, 64, 74, 70, 85, 46, 48, 42, 60, 34, 48, 40, 48, 28, 61, 67, 93, 34, 73, 30, 49, 114, 51, 31, 110, 59, 72, 47, 47, 36, 75, 102, 35, 56, 43, 27, 49, 57, 41, 60, 91, 57, 40, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6521302580844488, "mean_inference_ms": 2.9325581851524576, "mean_action_processing_ms": 0.6290978312652669, "mean_env_wait_ms": 0.15091680998904974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04363226890563965, "StateBufferConnector_ms": 0.013351202011108398, "ViewRequirementAgentConnector_ms": 0.5081677436828613}}, "episode_reward_max": 62.193666666666715, "episode_reward_min": 10.254999999999999, "episode_reward_mean": 25.264536666666665, "episode_len_mean": 55.05, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.747333333333334, 40.195666666666654, 14.208333333333325, 17.755333333333333, 24.91866666666667, 18.147666666666662, 20.584333333333326, 28.610333333333333, 39.15033333333332, 27.84466666666668, 15.704333333333324, 17.943333333333328, 37.609666666666655, 38.60800000000002, 20.09199999999999, 21.259, 26.921333333333305, 32.72299999999999, 16.884999999999994, 33.53466666666666, 12.968333333333332, 14.564, 23.747666666666664, 34.95133333333331, 19.42266666666667, 16.411333333333328, 17.304999999999993, 26.752666666666652, 30.89699999999999, 15.891000000000002, 27.95566666666666, 26.574333333333335, 18.433333333333334, 24.08399999999998, 12.967333333333327, 16.437333333333324, 18.30566666666666, 31.13933333333333, 19.15233333333334, 22.519, 39.02500000000001, 47.13766666666664, 15.853666666666665, 17.464666666666663, 36.666333333333334, 13.593666666666664, 23.194666666666667, 14.807999999999996, 14.366999999999994, 11.297666666666666, 13.780666666666663, 32.203666666666635, 32.170333333333325, 27.173000000000002, 11.005666666666666, 29.567000000000007, 10.254999999999999, 35.672999999999995, 30.288999999999984, 26.954666666666643, 43.28166666666667, 22.87166666666667, 25.85633333333333, 20.289666666666665, 34.23033333333333, 14.186999999999992, 27.03233333333333, 17.06066666666666, 21.863999999999994, 13.483666666666661, 31.819999999999983, 30.158666666666665, 52.17033333333332, 16.833, 41.328000000000024, 13.545333333333334, 21.50733333333333, 62.193666666666715, 20.26799999999999, 15.676000000000002, 37.52199999999999, 29.757999999999992, 42.81566666666667, 25.64233333333334, 23.83966666666666, 18.193666666666655, 27.538666666666632, 31.56366666666665, 15.651999999999994, 25.91166666666666, 15.71933333333333, 11.924999999999997, 27.038666666666664, 37.785000000000004, 16.01166666666666, 24.056333333333335, 42.72366666666668, 27.457333333333334, 18.407999999999994, 50.83099999999999], "episode_lengths": [44, 89, 32, 41, 54, 51, 50, 61, 91, 56, 43, 39, 74, 73, 49, 55, 77, 74, 52, 78, 29, 35, 44, 69, 43, 36, 40, 72, 58, 35, 56, 66, 47, 73, 30, 35, 39, 61, 40, 43, 76, 106, 38, 43, 66, 33, 46, 29, 34, 26, 29, 90, 92, 54, 23, 61, 23, 64, 74, 70, 85, 46, 48, 42, 60, 34, 48, 40, 48, 28, 61, 67, 93, 34, 73, 30, 49, 114, 51, 31, 110, 59, 72, 47, 47, 36, 75, 102, 35, 56, 43, 27, 49, 57, 41, 60, 91, 57, 40, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6521302580844488, "mean_inference_ms": 2.9325581851524576, "mean_action_processing_ms": 0.6290978312652669, "mean_env_wait_ms": 0.15091680998904974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04363226890563965, "StateBufferConnector_ms": 0.013351202011108398, "ViewRequirementAgentConnector_ms": 0.5081677436828613}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.34929743116226, "num_env_steps_trained_throughput_per_sec": 455.34929743116226, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 131542.367, "sample_time_ms": 3342.495, "load_time_ms": 0.644, "load_throughput": 6214474.201, "learn_time_ms": 128161.634, "learn_throughput": 31.211, "synch_weights_time_ms": 34.556}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 2609, "training_iteration": 29, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-10-44", "timestamp": 1701997844, "time_this_iter_s": 8.80326247215271, "time_total_s": 1502.989786863327, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1502.989786863327, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 81.45, "ram_util_percent": 95.28333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.287460349885805e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 6.057782173156738, "policy_loss": -0.008517606183886528, "vf_loss": 6.066298961639404, "vf_explained_var": 0.5125334858894348, "kl": 0.0024055044632405043, "entropy": 0.07631160318851471, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 67.12666666666675, "episode_reward_min": 11.54733333333333, "episode_reward_mean": 27.458349999999992, "episode_len_mean": 59.1, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.483666666666661, 31.819999999999983, 30.158666666666665, 52.17033333333332, 16.833, 41.328000000000024, 13.545333333333334, 21.50733333333333, 62.193666666666715, 20.26799999999999, 15.676000000000002, 37.52199999999999, 29.757999999999992, 42.81566666666667, 25.64233333333334, 23.83966666666666, 18.193666666666655, 27.538666666666632, 31.56366666666665, 15.651999999999994, 25.91166666666666, 15.71933333333333, 11.924999999999997, 27.038666666666664, 37.785000000000004, 16.01166666666666, 24.056333333333335, 42.72366666666668, 27.457333333333334, 18.407999999999994, 50.83099999999999, 36.86066666666668, 19.761333333333322, 24.25733333333333, 21.19633333333333, 20.295, 37.566333333333304, 37.05066666666668, 26.03299999999999, 25.739999999999988, 31.814999999999998, 23.450000000000003, 21.123666666666672, 47.52366666666668, 32.29066666666665, 36.623999999999995, 45.29100000000001, 36.599666666666664, 24.777666666666676, 33.902666666666676, 18.267666666666656, 29.087666666666642, 28.724333333333327, 19.298666666666666, 28.392999999999986, 17.136333333333322, 15.740333333333327, 16.10233333333333, 16.061999999999998, 13.872666666666662, 25.343333333333312, 11.54733333333333, 35.00900000000001, 24.256999999999984, 22.879666666666658, 33.709666666666664, 16.463666666666665, 18.54533333333333, 37.33766666666665, 13.901333333333328, 14.972333333333335, 67.12666666666675, 20.928333333333335, 20.87766666666666, 33.283666666666655, 24.28433333333333, 37.25866666666666, 41.60566666666662, 13.042666666666664, 21.591666666666658, 15.434999999999995, 23.618666666666652, 26.596666666666653, 17.193, 30.73766666666666, 12.58933333333333, 30.12566666666667, 43.23566666666667, 36.73399999999998, 27.784999999999997, 26.868666666666677, 51.908999999999985, 30.122333333333323, 18.805, 42.040333333333336, 26.90366666666664, 14.630666666666663, 36.92433333333334, 28.65333333333332, 16.740333333333325], "episode_lengths": [28, 61, 67, 93, 34, 73, 30, 49, 114, 51, 31, 110, 59, 72, 47, 47, 36, 75, 102, 35, 56, 43, 27, 49, 57, 41, 60, 91, 57, 40, 108, 88, 41, 51, 49, 36, 104, 71, 60, 63, 52, 56, 55, 110, 91, 73, 101, 78, 47, 65, 38, 76, 63, 46, 48, 55, 35, 38, 35, 34, 49, 25, 75, 61, 47, 71, 32, 35, 105, 29, 30, 105, 42, 41, 80, 46, 95, 95, 29, 52, 37, 57, 58, 44, 61, 26, 65, 74, 85, 52, 53, 94, 48, 36, 67, 82, 33, 67, 77, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6523264337363395, "mean_inference_ms": 2.941032292519252, "mean_action_processing_ms": 0.6273426756976545, "mean_env_wait_ms": 0.1508804949719894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04272913932800293, "StateBufferConnector_ms": 0.04245734214782715, "ViewRequirementAgentConnector_ms": 0.47307252883911133}}, "episode_reward_max": 67.12666666666675, "episode_reward_min": 11.54733333333333, "episode_reward_mean": 27.458349999999992, "episode_len_mean": 59.1, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.483666666666661, 31.819999999999983, 30.158666666666665, 52.17033333333332, 16.833, 41.328000000000024, 13.545333333333334, 21.50733333333333, 62.193666666666715, 20.26799999999999, 15.676000000000002, 37.52199999999999, 29.757999999999992, 42.81566666666667, 25.64233333333334, 23.83966666666666, 18.193666666666655, 27.538666666666632, 31.56366666666665, 15.651999999999994, 25.91166666666666, 15.71933333333333, 11.924999999999997, 27.038666666666664, 37.785000000000004, 16.01166666666666, 24.056333333333335, 42.72366666666668, 27.457333333333334, 18.407999999999994, 50.83099999999999, 36.86066666666668, 19.761333333333322, 24.25733333333333, 21.19633333333333, 20.295, 37.566333333333304, 37.05066666666668, 26.03299999999999, 25.739999999999988, 31.814999999999998, 23.450000000000003, 21.123666666666672, 47.52366666666668, 32.29066666666665, 36.623999999999995, 45.29100000000001, 36.599666666666664, 24.777666666666676, 33.902666666666676, 18.267666666666656, 29.087666666666642, 28.724333333333327, 19.298666666666666, 28.392999999999986, 17.136333333333322, 15.740333333333327, 16.10233333333333, 16.061999999999998, 13.872666666666662, 25.343333333333312, 11.54733333333333, 35.00900000000001, 24.256999999999984, 22.879666666666658, 33.709666666666664, 16.463666666666665, 18.54533333333333, 37.33766666666665, 13.901333333333328, 14.972333333333335, 67.12666666666675, 20.928333333333335, 20.87766666666666, 33.283666666666655, 24.28433333333333, 37.25866666666666, 41.60566666666662, 13.042666666666664, 21.591666666666658, 15.434999999999995, 23.618666666666652, 26.596666666666653, 17.193, 30.73766666666666, 12.58933333333333, 30.12566666666667, 43.23566666666667, 36.73399999999998, 27.784999999999997, 26.868666666666677, 51.908999999999985, 30.122333333333323, 18.805, 42.040333333333336, 26.90366666666664, 14.630666666666663, 36.92433333333334, 28.65333333333332, 16.740333333333325], "episode_lengths": [28, 61, 67, 93, 34, 73, 30, 49, 114, 51, 31, 110, 59, 72, 47, 47, 36, 75, 102, 35, 56, 43, 27, 49, 57, 41, 60, 91, 57, 40, 108, 88, 41, 51, 49, 36, 104, 71, 60, 63, 52, 56, 55, 110, 91, 73, 101, 78, 47, 65, 38, 76, 63, 46, 48, 55, 35, 38, 35, 34, 49, 25, 75, 61, 47, 71, 32, 35, 105, 29, 30, 105, 42, 41, 80, 46, 95, 95, 29, 52, 37, 57, 58, 44, 61, 26, 65, 74, 85, 52, 53, 94, 48, 36, 67, 82, 33, 67, 77, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6523264337363395, "mean_inference_ms": 2.941032292519252, "mean_action_processing_ms": 0.6273426756976545, "mean_env_wait_ms": 0.1508804949719894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04272913932800293, "StateBufferConnector_ms": 0.04245734214782715, "ViewRequirementAgentConnector_ms": 0.47307252883911133}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.00101510842194, "num_env_steps_trained_throughput_per_sec": 464.00101510842194, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 131449.791, "sample_time_ms": 3350.618, "load_time_ms": 0.658, "load_throughput": 6081125.086, "learn_time_ms": 128064.385, "learn_throughput": 31.234, "synch_weights_time_ms": 31.035}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 2678, "training_iteration": 30, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-10-53", "timestamp": 1701997853, "time_this_iter_s": 8.645190477371216, "time_total_s": 1511.6349773406982, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1511.6349773406982, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 82.72727272727273, "ram_util_percent": 94.88181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.437301749429025e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 6.4937663078308105, "policy_loss": -0.006542723625898361, "vf_loss": 6.500309467315674, "vf_explained_var": 0.5198059678077698, "kl": 0.0012386783491820097, "entropy": 0.05206511542201042, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 67.12666666666675, "episode_reward_min": 12.58933333333333, "episode_reward_mean": 29.177513333333323, "episode_len_mean": 60.83, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.879666666666658, 33.709666666666664, 16.463666666666665, 18.54533333333333, 37.33766666666665, 13.901333333333328, 14.972333333333335, 67.12666666666675, 20.928333333333335, 20.87766666666666, 33.283666666666655, 24.28433333333333, 37.25866666666666, 41.60566666666662, 13.042666666666664, 21.591666666666658, 15.434999999999995, 23.618666666666652, 26.596666666666653, 17.193, 30.73766666666666, 12.58933333333333, 30.12566666666667, 43.23566666666667, 36.73399999999998, 27.784999999999997, 26.868666666666677, 51.908999999999985, 30.122333333333323, 18.805, 42.040333333333336, 26.90366666666664, 14.630666666666663, 36.92433333333334, 28.65333333333332, 16.740333333333325, 14.423, 16.577333333333325, 18.822999999999993, 15.531333333333333, 28.32, 15.287333333333333, 33.364999999999974, 25.601999999999983, 22.031999999999996, 46.21200000000003, 17.801666666666666, 52.4616666666667, 26.475666666666665, 37.976, 43.44433333333331, 42.98700000000001, 15.092666666666661, 25.683333333333323, 30.169666666666647, 19.703666666666656, 44.5106666666667, 49.19099999999995, 34.33333333333334, 22.778333333333325, 23.628333333333323, 17.311666666666667, 25.939999999999987, 15.355333333333334, 19.218999999999998, 47.85666666666662, 16.568, 19.349666666666664, 44.830999999999996, 40.63333333333333, 26.625666666666646, 53.93133333333338, 18.606999999999996, 17.024333333333328, 33.29599999999999, 17.96433333333333, 40.56299999999999, 49.227666666666664, 16.057333333333325, 16.327333333333332, 41.118666666666684, 20.677333333333323, 16.66599999999999, 37.480333333333334, 13.226999999999999, 37.11366666666666, 19.592333333333325, 52.24533333333333, 27.62299999999999, 45.49866666666667, 37.82100000000001, 16.398999999999997, 25.603666666666662, 16.185333333333336, 40.878999999999984, 40.72499999999999, 60.3816666666667, 36.80066666666667, 59.597333333333346, 17.559999999999995], "episode_lengths": [47, 71, 32, 35, 105, 29, 30, 105, 42, 41, 80, 46, 95, 95, 29, 52, 37, 57, 58, 44, 61, 26, 65, 74, 85, 52, 53, 94, 48, 36, 67, 82, 33, 67, 77, 48, 28, 35, 60, 45, 67, 30, 98, 56, 46, 75, 35, 86, 58, 69, 84, 69, 31, 54, 54, 60, 87, 86, 82, 48, 53, 33, 79, 43, 41, 101, 35, 39, 114, 82, 66, 109, 38, 41, 67, 42, 84, 89, 34, 32, 79, 55, 42, 66, 28, 79, 38, 113, 49, 101, 60, 35, 61, 40, 70, 72, 112, 85, 100, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6481124672620888, "mean_inference_ms": 2.9459907445182147, "mean_action_processing_ms": 0.6270608256947594, "mean_env_wait_ms": 0.15072175946458963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026853561401367188, "StateBufferConnector_ms": 0.04030489921569824, "ViewRequirementAgentConnector_ms": 0.5686349868774414}}, "episode_reward_max": 67.12666666666675, "episode_reward_min": 12.58933333333333, "episode_reward_mean": 29.177513333333323, "episode_len_mean": 60.83, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.879666666666658, 33.709666666666664, 16.463666666666665, 18.54533333333333, 37.33766666666665, 13.901333333333328, 14.972333333333335, 67.12666666666675, 20.928333333333335, 20.87766666666666, 33.283666666666655, 24.28433333333333, 37.25866666666666, 41.60566666666662, 13.042666666666664, 21.591666666666658, 15.434999999999995, 23.618666666666652, 26.596666666666653, 17.193, 30.73766666666666, 12.58933333333333, 30.12566666666667, 43.23566666666667, 36.73399999999998, 27.784999999999997, 26.868666666666677, 51.908999999999985, 30.122333333333323, 18.805, 42.040333333333336, 26.90366666666664, 14.630666666666663, 36.92433333333334, 28.65333333333332, 16.740333333333325, 14.423, 16.577333333333325, 18.822999999999993, 15.531333333333333, 28.32, 15.287333333333333, 33.364999999999974, 25.601999999999983, 22.031999999999996, 46.21200000000003, 17.801666666666666, 52.4616666666667, 26.475666666666665, 37.976, 43.44433333333331, 42.98700000000001, 15.092666666666661, 25.683333333333323, 30.169666666666647, 19.703666666666656, 44.5106666666667, 49.19099999999995, 34.33333333333334, 22.778333333333325, 23.628333333333323, 17.311666666666667, 25.939999999999987, 15.355333333333334, 19.218999999999998, 47.85666666666662, 16.568, 19.349666666666664, 44.830999999999996, 40.63333333333333, 26.625666666666646, 53.93133333333338, 18.606999999999996, 17.024333333333328, 33.29599999999999, 17.96433333333333, 40.56299999999999, 49.227666666666664, 16.057333333333325, 16.327333333333332, 41.118666666666684, 20.677333333333323, 16.66599999999999, 37.480333333333334, 13.226999999999999, 37.11366666666666, 19.592333333333325, 52.24533333333333, 27.62299999999999, 45.49866666666667, 37.82100000000001, 16.398999999999997, 25.603666666666662, 16.185333333333336, 40.878999999999984, 40.72499999999999, 60.3816666666667, 36.80066666666667, 59.597333333333346, 17.559999999999995], "episode_lengths": [47, 71, 32, 35, 105, 29, 30, 105, 42, 41, 80, 46, 95, 95, 29, 52, 37, 57, 58, 44, 61, 26, 65, 74, 85, 52, 53, 94, 48, 36, 67, 82, 33, 67, 77, 48, 28, 35, 60, 45, 67, 30, 98, 56, 46, 75, 35, 86, 58, 69, 84, 69, 31, 54, 54, 60, 87, 86, 82, 48, 53, 33, 79, 43, 41, 101, 35, 39, 114, 82, 66, 109, 38, 41, 67, 42, 84, 89, 34, 32, 79, 55, 42, 66, 28, 79, 38, 113, 49, 101, 60, 35, 61, 40, 70, 72, 112, 85, 100, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6481124672620888, "mean_inference_ms": 2.9459907445182147, "mean_action_processing_ms": 0.6270608256947594, "mean_env_wait_ms": 0.15072175946458963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026853561401367188, "StateBufferConnector_ms": 0.04030489921569824, "ViewRequirementAgentConnector_ms": 0.5686349868774414}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.9712062607854, "num_env_steps_trained_throughput_per_sec": 383.9712062607854, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 131566.798, "sample_time_ms": 3328.787, "load_time_ms": 0.557, "load_throughput": 7174963.007, "learn_time_ms": 128203.904, "learn_throughput": 31.2, "synch_weights_time_ms": 30.414}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 2742, "training_iteration": 31, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-11-04", "timestamp": 1701997864, "time_this_iter_s": 10.439741134643555, "time_total_s": 1522.0747184753418, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1522.0747184753418, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 78.075, "ram_util_percent": 95.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.2186508747145126e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 5.346025466918945, "policy_loss": -0.006235822569578886, "vf_loss": 5.352261543273926, "vf_explained_var": 0.5971973538398743, "kl": 0.0014287169324234128, "entropy": 0.07106997817754745, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 68.30266666666667, "episode_reward_min": 13.226999999999999, "episode_reward_mean": 29.057026666666662, "episode_len_mean": 60.29, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.625666666666646, 53.93133333333338, 18.606999999999996, 17.024333333333328, 33.29599999999999, 17.96433333333333, 40.56299999999999, 49.227666666666664, 16.057333333333325, 16.327333333333332, 41.118666666666684, 20.677333333333323, 16.66599999999999, 37.480333333333334, 13.226999999999999, 37.11366666666666, 19.592333333333325, 52.24533333333333, 27.62299999999999, 45.49866666666667, 37.82100000000001, 16.398999999999997, 25.603666666666662, 16.185333333333336, 40.878999999999984, 40.72499999999999, 60.3816666666667, 36.80066666666667, 59.597333333333346, 17.559999999999995, 51.27033333333335, 17.06866666666666, 68.30266666666667, 17.15033333333333, 24.58966666666664, 52.90466666666669, 26.535666666666657, 20.802666666666664, 24.80699999999999, 20.99166666666666, 19.191666666666656, 40.63033333333334, 22.92900000000001, 25.87166666666667, 21.630999999999993, 20.948999999999987, 39.53399999999999, 18.07299999999999, 20.99099999999999, 55.146333333333324, 25.17133333333333, 24.12133333333333, 18.445333333333327, 16.655666666666665, 19.237666666666662, 30.747333333333323, 21.55099999999999, 19.202666666666662, 23.45499999999999, 56.234333333333346, 33.54233333333332, 19.057666666666655, 22.286999999999992, 19.925333333333327, 29.428000000000004, 49.82966666666672, 20.697, 35.06700000000001, 39.45466666666665, 17.29366666666666, 19.30666666666666, 20.93099999999999, 21.94899999999999, 22.286333333333328, 22.184999999999988, 27.801000000000002, 26.617999999999988, 20.43966666666666, 38.277666666666654, 30.463666666666647, 35.07799999999999, 29.950666666666663, 15.289666666666667, 25.775999999999996, 26.532, 21.37066666666666, 39.84866666666667, 18.610333333333337, 22.113999999999987, 40.03000000000001, 31.473666666666656, 21.71033333333332, 49.37766666666668, 38.69933333333333, 25.213333333333328, 18.398000000000003, 20.375666666666664, 29.195999999999994, 28.053999999999995, 14.753333333333329], "episode_lengths": [66, 109, 38, 41, 67, 42, 84, 89, 34, 32, 79, 55, 42, 66, 28, 79, 38, 113, 49, 101, 60, 35, 61, 40, 70, 72, 112, 85, 100, 35, 100, 48, 121, 36, 85, 91, 56, 48, 46, 50, 38, 66, 56, 48, 47, 54, 93, 40, 50, 118, 63, 45, 37, 34, 42, 92, 41, 40, 54, 95, 56, 42, 44, 49, 54, 98, 40, 76, 81, 34, 44, 42, 50, 46, 59, 51, 62, 45, 86, 48, 59, 66, 32, 49, 49, 43, 73, 38, 46, 77, 66, 70, 80, 71, 81, 41, 38, 87, 69, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.636361251006809, "mean_inference_ms": 2.9385911521969716, "mean_action_processing_ms": 0.6231285720559396, "mean_env_wait_ms": 0.14989303131141266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025948047637939453, "StateBufferConnector_ms": 0.012963533401489258, "ViewRequirementAgentConnector_ms": 0.45021724700927734}}, "episode_reward_max": 68.30266666666667, "episode_reward_min": 13.226999999999999, "episode_reward_mean": 29.057026666666662, "episode_len_mean": 60.29, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.625666666666646, 53.93133333333338, 18.606999999999996, 17.024333333333328, 33.29599999999999, 17.96433333333333, 40.56299999999999, 49.227666666666664, 16.057333333333325, 16.327333333333332, 41.118666666666684, 20.677333333333323, 16.66599999999999, 37.480333333333334, 13.226999999999999, 37.11366666666666, 19.592333333333325, 52.24533333333333, 27.62299999999999, 45.49866666666667, 37.82100000000001, 16.398999999999997, 25.603666666666662, 16.185333333333336, 40.878999999999984, 40.72499999999999, 60.3816666666667, 36.80066666666667, 59.597333333333346, 17.559999999999995, 51.27033333333335, 17.06866666666666, 68.30266666666667, 17.15033333333333, 24.58966666666664, 52.90466666666669, 26.535666666666657, 20.802666666666664, 24.80699999999999, 20.99166666666666, 19.191666666666656, 40.63033333333334, 22.92900000000001, 25.87166666666667, 21.630999999999993, 20.948999999999987, 39.53399999999999, 18.07299999999999, 20.99099999999999, 55.146333333333324, 25.17133333333333, 24.12133333333333, 18.445333333333327, 16.655666666666665, 19.237666666666662, 30.747333333333323, 21.55099999999999, 19.202666666666662, 23.45499999999999, 56.234333333333346, 33.54233333333332, 19.057666666666655, 22.286999999999992, 19.925333333333327, 29.428000000000004, 49.82966666666672, 20.697, 35.06700000000001, 39.45466666666665, 17.29366666666666, 19.30666666666666, 20.93099999999999, 21.94899999999999, 22.286333333333328, 22.184999999999988, 27.801000000000002, 26.617999999999988, 20.43966666666666, 38.277666666666654, 30.463666666666647, 35.07799999999999, 29.950666666666663, 15.289666666666667, 25.775999999999996, 26.532, 21.37066666666666, 39.84866666666667, 18.610333333333337, 22.113999999999987, 40.03000000000001, 31.473666666666656, 21.71033333333332, 49.37766666666668, 38.69933333333333, 25.213333333333328, 18.398000000000003, 20.375666666666664, 29.195999999999994, 28.053999999999995, 14.753333333333329], "episode_lengths": [66, 109, 38, 41, 67, 42, 84, 89, 34, 32, 79, 55, 42, 66, 28, 79, 38, 113, 49, 101, 60, 35, 61, 40, 70, 72, 112, 85, 100, 35, 100, 48, 121, 36, 85, 91, 56, 48, 46, 50, 38, 66, 56, 48, 47, 54, 93, 40, 50, 118, 63, 45, 37, 34, 42, 92, 41, 40, 54, 95, 56, 42, 44, 49, 54, 98, 40, 76, 81, 34, 44, 42, 50, 46, 59, 51, 62, 45, 86, 48, 59, 66, 32, 49, 49, 43, 73, 38, 46, 77, 66, 70, 80, 71, 81, 41, 38, 87, 69, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.636361251006809, "mean_inference_ms": 2.9385911521969716, "mean_action_processing_ms": 0.6231285720559396, "mean_env_wait_ms": 0.14989303131141266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025948047637939453, "StateBufferConnector_ms": 0.012963533401489258, "ViewRequirementAgentConnector_ms": 0.45021724700927734}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.1226110231252, "num_env_steps_trained_throughput_per_sec": 538.1226110231252, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 131361.148, "sample_time_ms": 3255.681, "load_time_ms": 0.557, "load_throughput": 7174963.007, "learn_time_ms": 128072.552, "learn_throughput": 31.232, "synch_weights_time_ms": 29.316}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 2812, "training_iteration": 32, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-11-11", "timestamp": 1701997871, "time_this_iter_s": 7.448196172714233, "time_total_s": 1529.522914648056, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1529.522914648056, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 82.83000000000001, "ram_util_percent": 94.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6093254373572563e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 5.922086238861084, "policy_loss": -0.005739294923841953, "vf_loss": 5.927824974060059, "vf_explained_var": 0.5676187872886658, "kl": 0.0006159236072562635, "entropy": 0.06009479612112045, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 69.0036666666667, "episode_reward_min": 11.070333333333332, "episode_reward_mean": 27.742663333333336, "episode_len_mean": 59.3, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.82966666666672, 20.697, 35.06700000000001, 39.45466666666665, 17.29366666666666, 19.30666666666666, 20.93099999999999, 21.94899999999999, 22.286333333333328, 22.184999999999988, 27.801000000000002, 26.617999999999988, 20.43966666666666, 38.277666666666654, 30.463666666666647, 35.07799999999999, 29.950666666666663, 15.289666666666667, 25.775999999999996, 26.532, 21.37066666666666, 39.84866666666667, 18.610333333333337, 22.113999999999987, 40.03000000000001, 31.473666666666656, 21.71033333333332, 49.37766666666668, 38.69933333333333, 25.213333333333328, 18.398000000000003, 20.375666666666664, 29.195999999999994, 28.053999999999995, 14.753333333333329, 21.294666666666668, 29.236333333333317, 39.749333333333375, 12.990999999999998, 21.42333333333333, 18.84433333333333, 13.87233333333333, 55.694333333333276, 20.467666666666656, 61.72633333333331, 16.54866666666666, 33.772666666666666, 29.570666666666657, 26.395999999999994, 31.91133333333332, 18.225666666666662, 42.145333333333326, 23.337666666666667, 59.761666666666684, 14.636999999999997, 69.0036666666667, 33.31699999999998, 38.373333333333335, 33.95966666666667, 15.571999999999994, 16.77699999999999, 11.070333333333332, 23.995333333333328, 19.183333333333334, 31.77766666666666, 15.349, 28.07333333333333, 17.127666666666666, 48.12, 35.84933333333335, 42.283666666666676, 21.572333333333322, 43.02566666666669, 48.23833333333335, 21.17899999999999, 18.649666666666665, 24.719666666666658, 15.753333333333325, 19.954999999999984, 13.330666666666664, 21.430999999999994, 34.87133333333331, 20.382999999999985, 40.89166666666669, 19.673666666666673, 19.589999999999996, 20.684999999999995, 23.09666666666666, 25.05433333333334, 31.644999999999982, 27.96533333333334, 28.012999999999984, 18.40066666666666, 25.272999999999996, 38.913000000000004, 27.007, 22.659333333333326, 13.891333333333332, 36.351333333333315, 16.157000000000004], "episode_lengths": [98, 40, 76, 81, 34, 44, 42, 50, 46, 59, 51, 62, 45, 86, 48, 59, 66, 32, 49, 49, 43, 73, 38, 46, 77, 66, 70, 80, 71, 81, 41, 38, 87, 69, 31, 45, 50, 101, 28, 49, 50, 31, 132, 57, 114, 39, 71, 87, 63, 56, 42, 73, 50, 104, 35, 148, 72, 77, 59, 33, 37, 24, 61, 38, 60, 31, 62, 41, 105, 74, 80, 70, 68, 102, 38, 38, 55, 36, 58, 27, 60, 77, 57, 79, 36, 37, 44, 49, 55, 83, 59, 66, 53, 55, 66, 57, 57, 31, 79, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6263070177384018, "mean_inference_ms": 2.9280600774387615, "mean_action_processing_ms": 0.6195550298168224, "mean_env_wait_ms": 0.14910828756312408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017353534698486328, "StateBufferConnector_ms": 0.0156557559967041, "ViewRequirementAgentConnector_ms": 0.42935848236083984}}, "episode_reward_max": 69.0036666666667, "episode_reward_min": 11.070333333333332, "episode_reward_mean": 27.742663333333336, "episode_len_mean": 59.3, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.82966666666672, 20.697, 35.06700000000001, 39.45466666666665, 17.29366666666666, 19.30666666666666, 20.93099999999999, 21.94899999999999, 22.286333333333328, 22.184999999999988, 27.801000000000002, 26.617999999999988, 20.43966666666666, 38.277666666666654, 30.463666666666647, 35.07799999999999, 29.950666666666663, 15.289666666666667, 25.775999999999996, 26.532, 21.37066666666666, 39.84866666666667, 18.610333333333337, 22.113999999999987, 40.03000000000001, 31.473666666666656, 21.71033333333332, 49.37766666666668, 38.69933333333333, 25.213333333333328, 18.398000000000003, 20.375666666666664, 29.195999999999994, 28.053999999999995, 14.753333333333329, 21.294666666666668, 29.236333333333317, 39.749333333333375, 12.990999999999998, 21.42333333333333, 18.84433333333333, 13.87233333333333, 55.694333333333276, 20.467666666666656, 61.72633333333331, 16.54866666666666, 33.772666666666666, 29.570666666666657, 26.395999999999994, 31.91133333333332, 18.225666666666662, 42.145333333333326, 23.337666666666667, 59.761666666666684, 14.636999999999997, 69.0036666666667, 33.31699999999998, 38.373333333333335, 33.95966666666667, 15.571999999999994, 16.77699999999999, 11.070333333333332, 23.995333333333328, 19.183333333333334, 31.77766666666666, 15.349, 28.07333333333333, 17.127666666666666, 48.12, 35.84933333333335, 42.283666666666676, 21.572333333333322, 43.02566666666669, 48.23833333333335, 21.17899999999999, 18.649666666666665, 24.719666666666658, 15.753333333333325, 19.954999999999984, 13.330666666666664, 21.430999999999994, 34.87133333333331, 20.382999999999985, 40.89166666666669, 19.673666666666673, 19.589999999999996, 20.684999999999995, 23.09666666666666, 25.05433333333334, 31.644999999999982, 27.96533333333334, 28.012999999999984, 18.40066666666666, 25.272999999999996, 38.913000000000004, 27.007, 22.659333333333326, 13.891333333333332, 36.351333333333315, 16.157000000000004], "episode_lengths": [98, 40, 76, 81, 34, 44, 42, 50, 46, 59, 51, 62, 45, 86, 48, 59, 66, 32, 49, 49, 43, 73, 38, 46, 77, 66, 70, 80, 71, 81, 41, 38, 87, 69, 31, 45, 50, 101, 28, 49, 50, 31, 132, 57, 114, 39, 71, 87, 63, 56, 42, 73, 50, 104, 35, 148, 72, 77, 59, 33, 37, 24, 61, 38, 60, 31, 62, 41, 105, 74, 80, 70, 68, 102, 38, 38, 55, 36, 58, 27, 60, 77, 57, 79, 36, 37, 44, 49, 55, 83, 59, 66, 53, 55, 66, 57, 57, 31, 79, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6263070177384018, "mean_inference_ms": 2.9280600774387615, "mean_action_processing_ms": 0.6195550298168224, "mean_env_wait_ms": 0.14910828756312408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017353534698486328, "StateBufferConnector_ms": 0.0156557559967041, "ViewRequirementAgentConnector_ms": 0.42935848236083984}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.310519669493, "num_env_steps_trained_throughput_per_sec": 493.310519669493, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 131277.8, "sample_time_ms": 3212.264, "load_time_ms": 0.657, "load_throughput": 6084212.511, "learn_time_ms": 128032.646, "learn_throughput": 31.242, "synch_weights_time_ms": 29.093}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 2877, "training_iteration": 33, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-11-19", "timestamp": 1701997879, "time_this_iter_s": 8.137676239013672, "time_total_s": 1537.6605908870697, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1537.6605908870697, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 84.68181818181819, "ram_util_percent": 85.91818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.046627186786282e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 5.542089939117432, "policy_loss": -0.00608419394120574, "vf_loss": 5.548173904418945, "vf_explained_var": 0.6598068475723267, "kl": 0.001437799888662994, "entropy": 0.06282924860715866, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 85.44600000000004, "episode_reward_min": 13.330666666666664, "episode_reward_mean": 25.366636666666665, "episode_len_mean": 54.19, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.23833333333335, 21.17899999999999, 18.649666666666665, 24.719666666666658, 15.753333333333325, 19.954999999999984, 13.330666666666664, 21.430999999999994, 34.87133333333331, 20.382999999999985, 40.89166666666669, 19.673666666666673, 19.589999999999996, 20.684999999999995, 23.09666666666666, 25.05433333333334, 31.644999999999982, 27.96533333333334, 28.012999999999984, 18.40066666666666, 25.272999999999996, 38.913000000000004, 27.007, 22.659333333333326, 13.891333333333332, 36.351333333333315, 16.157000000000004, 17.92033333333333, 18.801000000000005, 15.794333333333332, 35.99533333333333, 18.360333333333326, 35.09199999999998, 16.07966666666666, 34.893, 24.131000000000007, 22.822333333333326, 25.644, 14.639666666666669, 26.128666666666657, 20.02633333333333, 17.467333333333322, 33.17300000000001, 85.44600000000004, 16.821333333333328, 36.863333333333316, 14.857999999999995, 23.135666666666662, 22.500666666666664, 29.440666666666647, 16.473666666666663, 16.423000000000002, 17.760333333333328, 18.180999999999994, 33.290333333333336, 15.320333333333323, 20.216999999999995, 37.727666666666664, 23.110666666666663, 31.618666666666673, 18.06366666666666, 30.646333333333327, 17.946999999999996, 24.57533333333333, 22.061666666666646, 14.324999999999998, 30.919666666666664, 22.967999999999996, 31.842333333333343, 20.55566666666666, 22.028666666666663, 16.959666666666664, 35.651666666666664, 50.35533333333335, 28.628999999999984, 14.717666666666663, 22.127333333333333, 15.479666666666665, 35.69699999999999, 30.26033333333333, 35.81033333333332, 17.103333333333335, 47.630666666666656, 19.269, 13.422666666666665, 23.724999999999998, 21.120666666666658, 28.070000000000004, 34.90333333333333, 19.49966666666667, 28.905333333333335, 16.946999999999992, 29.063333333333315, 27.009333333333323, 22.943333333333324, 17.810666666666656, 30.968666666666678, 36.281333333333336, 20.82166666666666, 29.61233333333333], "episode_lengths": [102, 38, 38, 55, 36, 58, 27, 60, 77, 57, 79, 36, 37, 44, 49, 55, 83, 59, 66, 53, 55, 66, 57, 57, 31, 79, 31, 42, 34, 32, 61, 38, 81, 31, 84, 50, 62, 59, 28, 63, 44, 40, 64, 151, 39, 65, 33, 51, 50, 73, 38, 32, 45, 42, 55, 34, 38, 76, 46, 62, 34, 74, 45, 45, 70, 30, 70, 41, 59, 40, 41, 37, 66, 87, 61, 32, 46, 34, 78, 60, 80, 32, 118, 37, 29, 62, 54, 59, 95, 36, 55, 34, 81, 61, 45, 37, 50, 67, 41, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6113581563130237, "mean_inference_ms": 2.9102496153250366, "mean_action_processing_ms": 0.6150904258673691, "mean_env_wait_ms": 0.14779545101756134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018898487091064453, "StateBufferConnector_ms": 0.014396190643310547, "ViewRequirementAgentConnector_ms": 0.3800358772277832}}, "episode_reward_max": 85.44600000000004, "episode_reward_min": 13.330666666666664, "episode_reward_mean": 25.366636666666665, "episode_len_mean": 54.19, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.23833333333335, 21.17899999999999, 18.649666666666665, 24.719666666666658, 15.753333333333325, 19.954999999999984, 13.330666666666664, 21.430999999999994, 34.87133333333331, 20.382999999999985, 40.89166666666669, 19.673666666666673, 19.589999999999996, 20.684999999999995, 23.09666666666666, 25.05433333333334, 31.644999999999982, 27.96533333333334, 28.012999999999984, 18.40066666666666, 25.272999999999996, 38.913000000000004, 27.007, 22.659333333333326, 13.891333333333332, 36.351333333333315, 16.157000000000004, 17.92033333333333, 18.801000000000005, 15.794333333333332, 35.99533333333333, 18.360333333333326, 35.09199999999998, 16.07966666666666, 34.893, 24.131000000000007, 22.822333333333326, 25.644, 14.639666666666669, 26.128666666666657, 20.02633333333333, 17.467333333333322, 33.17300000000001, 85.44600000000004, 16.821333333333328, 36.863333333333316, 14.857999999999995, 23.135666666666662, 22.500666666666664, 29.440666666666647, 16.473666666666663, 16.423000000000002, 17.760333333333328, 18.180999999999994, 33.290333333333336, 15.320333333333323, 20.216999999999995, 37.727666666666664, 23.110666666666663, 31.618666666666673, 18.06366666666666, 30.646333333333327, 17.946999999999996, 24.57533333333333, 22.061666666666646, 14.324999999999998, 30.919666666666664, 22.967999999999996, 31.842333333333343, 20.55566666666666, 22.028666666666663, 16.959666666666664, 35.651666666666664, 50.35533333333335, 28.628999999999984, 14.717666666666663, 22.127333333333333, 15.479666666666665, 35.69699999999999, 30.26033333333333, 35.81033333333332, 17.103333333333335, 47.630666666666656, 19.269, 13.422666666666665, 23.724999999999998, 21.120666666666658, 28.070000000000004, 34.90333333333333, 19.49966666666667, 28.905333333333335, 16.946999999999992, 29.063333333333315, 27.009333333333323, 22.943333333333324, 17.810666666666656, 30.968666666666678, 36.281333333333336, 20.82166666666666, 29.61233333333333], "episode_lengths": [102, 38, 38, 55, 36, 58, 27, 60, 77, 57, 79, 36, 37, 44, 49, 55, 83, 59, 66, 53, 55, 66, 57, 57, 31, 79, 31, 42, 34, 32, 61, 38, 81, 31, 84, 50, 62, 59, 28, 63, 44, 40, 64, 151, 39, 65, 33, 51, 50, 73, 38, 32, 45, 42, 55, 34, 38, 76, 46, 62, 34, 74, 45, 45, 70, 30, 70, 41, 59, 40, 41, 37, 66, 87, 61, 32, 46, 34, 78, 60, 80, 32, 118, 37, 29, 62, 54, 59, 95, 36, 55, 34, 81, 61, 45, 37, 50, 67, 41, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6113581563130237, "mean_inference_ms": 2.9102496153250366, "mean_action_processing_ms": 0.6150904258673691, "mean_env_wait_ms": 0.14779545101756134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018898487091064453, "StateBufferConnector_ms": 0.014396190643310547, "ViewRequirementAgentConnector_ms": 0.3800358772277832}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.0697203875448, "num_env_steps_trained_throughput_per_sec": 502.0697203875448, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 131212.423, "sample_time_ms": 3133.005, "load_time_ms": 0.657, "load_throughput": 6084212.511, "learn_time_ms": 128047.24, "learn_throughput": 31.238, "synch_weights_time_ms": 28.393}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 2950, "training_iteration": 34, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-11-27", "timestamp": 1701997887, "time_this_iter_s": 7.986021518707275, "time_total_s": 1545.646612405777, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1545.646612405777, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 75.82727272727273, "ram_util_percent": 81.15454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.023313593393141e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 6.1143317222595215, "policy_loss": -0.004458766896277666, "vf_loss": 6.118791103363037, "vf_explained_var": 0.5617662072181702, "kl": 0.0009280159138143063, "entropy": 0.04349452257156372, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 60.213333333333345, "episode_reward_min": 13.422666666666665, "episode_reward_mean": 28.74240333333333, "episode_len_mean": 59.3, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.967999999999996, 31.842333333333343, 20.55566666666666, 22.028666666666663, 16.959666666666664, 35.651666666666664, 50.35533333333335, 28.628999999999984, 14.717666666666663, 22.127333333333333, 15.479666666666665, 35.69699999999999, 30.26033333333333, 35.81033333333332, 17.103333333333335, 47.630666666666656, 19.269, 13.422666666666665, 23.724999999999998, 21.120666666666658, 28.070000000000004, 34.90333333333333, 19.49966666666667, 28.905333333333335, 16.946999999999992, 29.063333333333315, 27.009333333333323, 22.943333333333324, 17.810666666666656, 30.968666666666678, 36.281333333333336, 20.82166666666666, 29.61233333333333, 40.97500000000001, 25.11799999999999, 18.460333333333324, 30.021666666666654, 25.130666666666663, 50.52233333333329, 35.88766666666666, 60.213333333333345, 24.306999999999995, 15.623333333333326, 20.756999999999987, 23.01999999999999, 51.538666666666664, 26.150000000000006, 28.682999999999986, 15.731666666666662, 25.794, 35.01033333333333, 35.280666666666654, 37.88933333333335, 22.364333333333324, 30.418333333333337, 20.964666666666666, 20.87233333333333, 20.005999999999993, 25.028, 44.359, 45.52366666666666, 21.850333333333328, 22.99633333333332, 18.407333333333334, 50.63833333333332, 36.70033333333335, 34.74999999999998, 43.264000000000024, 25.993666666666662, 21.03066666666666, 29.958333333333346, 14.683666666666664, 14.715333333333334, 35.15233333333332, 39.556999999999995, 26.78700000000001, 55.93633333333336, 37.502999999999986, 51.85866666666668, 14.048666666666664, 28.58333333333334, 22.56933333333333, 25.92666666666667, 24.003333333333327, 28.16233333333333, 32.23100000000002, 46.34533333333331, 36.23599999999999, 38.39633333333336, 34.775333333333315, 20.23733333333334, 15.107999999999993, 22.373666666666658, 17.84699999999999, 20.48633333333333, 29.869999999999987, 32.04466666666667, 29.197000000000006, 24.96866666666665, 25.206999999999997], "episode_lengths": [41, 59, 40, 41, 37, 66, 87, 61, 32, 46, 34, 78, 60, 80, 32, 118, 37, 29, 62, 54, 59, 95, 36, 55, 34, 81, 61, 45, 37, 50, 67, 41, 68, 72, 58, 40, 72, 53, 105, 79, 106, 51, 42, 60, 47, 95, 55, 86, 33, 45, 67, 85, 75, 41, 62, 51, 41, 37, 51, 74, 80, 43, 43, 33, 81, 72, 87, 79, 49, 58, 52, 34, 29, 80, 72, 48, 110, 64, 105, 30, 64, 61, 51, 55, 54, 66, 77, 81, 84, 89, 40, 38, 42, 40, 39, 47, 69, 61, 57, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598281140489317, "mean_inference_ms": 2.8922876551288685, "mean_action_processing_ms": 0.6100232839323055, "mean_env_wait_ms": 0.14672545172006426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029284000396728516, "StateBufferConnector_ms": 0.010930538177490234, "ViewRequirementAgentConnector_ms": 0.3970911502838135}}, "episode_reward_max": 60.213333333333345, "episode_reward_min": 13.422666666666665, "episode_reward_mean": 28.74240333333333, "episode_len_mean": 59.3, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.967999999999996, 31.842333333333343, 20.55566666666666, 22.028666666666663, 16.959666666666664, 35.651666666666664, 50.35533333333335, 28.628999999999984, 14.717666666666663, 22.127333333333333, 15.479666666666665, 35.69699999999999, 30.26033333333333, 35.81033333333332, 17.103333333333335, 47.630666666666656, 19.269, 13.422666666666665, 23.724999999999998, 21.120666666666658, 28.070000000000004, 34.90333333333333, 19.49966666666667, 28.905333333333335, 16.946999999999992, 29.063333333333315, 27.009333333333323, 22.943333333333324, 17.810666666666656, 30.968666666666678, 36.281333333333336, 20.82166666666666, 29.61233333333333, 40.97500000000001, 25.11799999999999, 18.460333333333324, 30.021666666666654, 25.130666666666663, 50.52233333333329, 35.88766666666666, 60.213333333333345, 24.306999999999995, 15.623333333333326, 20.756999999999987, 23.01999999999999, 51.538666666666664, 26.150000000000006, 28.682999999999986, 15.731666666666662, 25.794, 35.01033333333333, 35.280666666666654, 37.88933333333335, 22.364333333333324, 30.418333333333337, 20.964666666666666, 20.87233333333333, 20.005999999999993, 25.028, 44.359, 45.52366666666666, 21.850333333333328, 22.99633333333332, 18.407333333333334, 50.63833333333332, 36.70033333333335, 34.74999999999998, 43.264000000000024, 25.993666666666662, 21.03066666666666, 29.958333333333346, 14.683666666666664, 14.715333333333334, 35.15233333333332, 39.556999999999995, 26.78700000000001, 55.93633333333336, 37.502999999999986, 51.85866666666668, 14.048666666666664, 28.58333333333334, 22.56933333333333, 25.92666666666667, 24.003333333333327, 28.16233333333333, 32.23100000000002, 46.34533333333331, 36.23599999999999, 38.39633333333336, 34.775333333333315, 20.23733333333334, 15.107999999999993, 22.373666666666658, 17.84699999999999, 20.48633333333333, 29.869999999999987, 32.04466666666667, 29.197000000000006, 24.96866666666665, 25.206999999999997], "episode_lengths": [41, 59, 40, 41, 37, 66, 87, 61, 32, 46, 34, 78, 60, 80, 32, 118, 37, 29, 62, 54, 59, 95, 36, 55, 34, 81, 61, 45, 37, 50, 67, 41, 68, 72, 58, 40, 72, 53, 105, 79, 106, 51, 42, 60, 47, 95, 55, 86, 33, 45, 67, 85, 75, 41, 62, 51, 41, 37, 51, 74, 80, 43, 43, 33, 81, 72, 87, 79, 49, 58, 52, 34, 29, 80, 72, 48, 110, 64, 105, 30, 64, 61, 51, 55, 54, 66, 77, 81, 84, 89, 40, 38, 42, 40, 39, 47, 69, 61, 57, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598281140489317, "mean_inference_ms": 2.8922876551288685, "mean_action_processing_ms": 0.6100232839323055, "mean_env_wait_ms": 0.14672545172006426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029284000396728516, "StateBufferConnector_ms": 0.010930538177490234, "ViewRequirementAgentConnector_ms": 0.3970911502838135}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 526.7421906303074, "num_env_steps_trained_throughput_per_sec": 526.7421906303074, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 131025.05, "sample_time_ms": 3051.43, "load_time_ms": 0.723, "load_throughput": 5535573.446, "learn_time_ms": 127938.148, "learn_throughput": 31.265, "synch_weights_time_ms": 31.801}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 3017, "training_iteration": 35, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-11-35", "timestamp": 1701997895, "time_this_iter_s": 7.618567943572998, "time_total_s": 1553.26518034935, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1553.26518034935, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 79.27272727272727, "ram_util_percent": 82.32727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0116567966965704e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 5.997509002685547, "policy_loss": -0.005291395355015993, "vf_loss": 6.002800464630127, "vf_explained_var": 0.6525136232376099, "kl": 0.0004146590654272586, "entropy": 0.03819553181529045, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 72.35366666666661, "episode_reward_min": 14.048666666666664, "episode_reward_mean": 27.673816666666664, "episode_len_mean": 59.15, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.03066666666666, 29.958333333333346, 14.683666666666664, 14.715333333333334, 35.15233333333332, 39.556999999999995, 26.78700000000001, 55.93633333333336, 37.502999999999986, 51.85866666666668, 14.048666666666664, 28.58333333333334, 22.56933333333333, 25.92666666666667, 24.003333333333327, 28.16233333333333, 32.23100000000002, 46.34533333333331, 36.23599999999999, 38.39633333333336, 34.775333333333315, 20.23733333333334, 15.107999999999993, 22.373666666666658, 17.84699999999999, 20.48633333333333, 29.869999999999987, 32.04466666666667, 29.197000000000006, 24.96866666666665, 25.206999999999997, 17.323666666666657, 31.56533333333333, 32.471666666666664, 42.031000000000006, 22.780999999999988, 27.228999999999974, 15.808666666666664, 19.240333333333332, 17.769666666666662, 23.364999999999988, 21.582999999999988, 23.064333333333323, 15.260666666666662, 24.522666666666662, 17.163999999999998, 16.688333333333325, 53.97366666666665, 40.93366666666667, 29.70533333333331, 38.25133333333331, 17.373999999999995, 38.462333333333305, 21.051999999999992, 28.06566666666668, 17.23566666666667, 18.282999999999994, 61.9676666666667, 20.099666666666664, 48.897000000000034, 23.140333333333324, 39.21599999999997, 20.533666666666665, 22.635666666666662, 29.000333333333334, 16.267333333333326, 16.04699999999999, 52.26033333333338, 30.762666666666657, 14.613666666666662, 34.50866666666666, 17.258666666666667, 27.044666666666643, 41.447666666666656, 21.74599999999998, 72.35366666666661, 17.499999999999993, 22.58833333333332, 18.37366666666667, 21.458666666666662, 34.866666666666646, 25.693333333333328, 31.336333333333336, 21.081333333333326, 41.70366666666667, 15.687999999999999, 26.152999999999988, 35.99299999999999, 29.084999999999983, 15.131666666666659, 29.71966666666665, 30.459333333333323, 15.441, 37.44966666666669, 18.900666666666663, 23.960333333333327, 17.431666666666658, 16.762333333333327, 14.593333333333335, 29.20566666666668], "episode_lengths": [58, 52, 34, 29, 80, 72, 48, 110, 64, 105, 30, 64, 61, 51, 55, 54, 66, 77, 81, 84, 89, 40, 38, 42, 40, 39, 47, 69, 61, 57, 60, 40, 57, 70, 81, 59, 67, 31, 38, 34, 44, 58, 46, 46, 63, 33, 40, 88, 93, 80, 83, 36, 102, 41, 49, 38, 36, 122, 39, 82, 48, 100, 40, 48, 54, 37, 36, 84, 51, 30, 87, 33, 57, 94, 85, 179, 44, 62, 34, 39, 93, 57, 70, 41, 70, 33, 54, 90, 68, 38, 66, 65, 39, 75, 43, 57, 40, 33, 29, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5901759167869647, "mean_inference_ms": 2.8902523471915953, "mean_action_processing_ms": 0.608434549427654, "mean_env_wait_ms": 0.146685470534274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02009892463684082, "StateBufferConnector_ms": 0.010710477828979492, "ViewRequirementAgentConnector_ms": 0.42593979835510254}}, "episode_reward_max": 72.35366666666661, "episode_reward_min": 14.048666666666664, "episode_reward_mean": 27.673816666666664, "episode_len_mean": 59.15, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.03066666666666, 29.958333333333346, 14.683666666666664, 14.715333333333334, 35.15233333333332, 39.556999999999995, 26.78700000000001, 55.93633333333336, 37.502999999999986, 51.85866666666668, 14.048666666666664, 28.58333333333334, 22.56933333333333, 25.92666666666667, 24.003333333333327, 28.16233333333333, 32.23100000000002, 46.34533333333331, 36.23599999999999, 38.39633333333336, 34.775333333333315, 20.23733333333334, 15.107999999999993, 22.373666666666658, 17.84699999999999, 20.48633333333333, 29.869999999999987, 32.04466666666667, 29.197000000000006, 24.96866666666665, 25.206999999999997, 17.323666666666657, 31.56533333333333, 32.471666666666664, 42.031000000000006, 22.780999999999988, 27.228999999999974, 15.808666666666664, 19.240333333333332, 17.769666666666662, 23.364999999999988, 21.582999999999988, 23.064333333333323, 15.260666666666662, 24.522666666666662, 17.163999999999998, 16.688333333333325, 53.97366666666665, 40.93366666666667, 29.70533333333331, 38.25133333333331, 17.373999999999995, 38.462333333333305, 21.051999999999992, 28.06566666666668, 17.23566666666667, 18.282999999999994, 61.9676666666667, 20.099666666666664, 48.897000000000034, 23.140333333333324, 39.21599999999997, 20.533666666666665, 22.635666666666662, 29.000333333333334, 16.267333333333326, 16.04699999999999, 52.26033333333338, 30.762666666666657, 14.613666666666662, 34.50866666666666, 17.258666666666667, 27.044666666666643, 41.447666666666656, 21.74599999999998, 72.35366666666661, 17.499999999999993, 22.58833333333332, 18.37366666666667, 21.458666666666662, 34.866666666666646, 25.693333333333328, 31.336333333333336, 21.081333333333326, 41.70366666666667, 15.687999999999999, 26.152999999999988, 35.99299999999999, 29.084999999999983, 15.131666666666659, 29.71966666666665, 30.459333333333323, 15.441, 37.44966666666669, 18.900666666666663, 23.960333333333327, 17.431666666666658, 16.762333333333327, 14.593333333333335, 29.20566666666668], "episode_lengths": [58, 52, 34, 29, 80, 72, 48, 110, 64, 105, 30, 64, 61, 51, 55, 54, 66, 77, 81, 84, 89, 40, 38, 42, 40, 39, 47, 69, 61, 57, 60, 40, 57, 70, 81, 59, 67, 31, 38, 34, 44, 58, 46, 46, 63, 33, 40, 88, 93, 80, 83, 36, 102, 41, 49, 38, 36, 122, 39, 82, 48, 100, 40, 48, 54, 37, 36, 84, 51, 30, 87, 33, 57, 94, 85, 179, 44, 62, 34, 39, 93, 57, 70, 41, 70, 33, 54, 90, 68, 38, 66, 65, 39, 75, 43, 57, 40, 33, 29, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5901759167869647, "mean_inference_ms": 2.8902523471915953, "mean_action_processing_ms": 0.608434549427654, "mean_env_wait_ms": 0.146685470534274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02009892463684082, "StateBufferConnector_ms": 0.010710477828979492, "ViewRequirementAgentConnector_ms": 0.42593979835510254}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.5828493632513, "num_env_steps_trained_throughput_per_sec": 445.5828493632513, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 8820.747, "sample_time_ms": 3043.519, "load_time_ms": 0.741, "load_throughput": 5398248.335, "learn_time_ms": 5742.186, "learn_throughput": 696.599, "synch_weights_time_ms": 31.361}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 3086, "training_iteration": 36, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-11-44", "timestamp": 1701997904, "time_this_iter_s": 9.02522611618042, "time_total_s": 1562.2904064655304, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1562.2904064655304, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 87.98333333333333, "ram_util_percent": 85.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0058283983482852e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 6.023313522338867, "policy_loss": -0.005542625207453966, "vf_loss": 6.028855800628662, "vf_explained_var": 0.5667301416397095, "kl": 0.00041441910434514284, "entropy": 0.029609929770231247, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 72.35366666666661, "episode_reward_min": 13.573999999999996, "episode_reward_mean": 27.68297666666667, "episode_len_mean": 58.68, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.762666666666657, 14.613666666666662, 34.50866666666666, 17.258666666666667, 27.044666666666643, 41.447666666666656, 21.74599999999998, 72.35366666666661, 17.499999999999993, 22.58833333333332, 18.37366666666667, 21.458666666666662, 34.866666666666646, 25.693333333333328, 31.336333333333336, 21.081333333333326, 41.70366666666667, 15.687999999999999, 26.152999999999988, 35.99299999999999, 29.084999999999983, 15.131666666666659, 29.71966666666665, 30.459333333333323, 15.441, 37.44966666666669, 18.900666666666663, 23.960333333333327, 17.431666666666658, 16.762333333333327, 14.593333333333335, 29.20566666666668, 15.745666666666661, 47.63, 13.598666666666663, 22.274666666666658, 37.66366666666666, 22.24966666666667, 17.892666666666656, 50.69766666666664, 48.18366666666666, 16.63333333333333, 18.773666666666657, 16.40899999999999, 22.728333333333328, 40.366999999999976, 23.441666666666663, 16.01799999999999, 21.81966666666666, 19.96566666666666, 37.568666666666665, 33.569999999999986, 40.95966666666665, 39.84833333333333, 37.57533333333331, 61.219, 20.072999999999997, 29.89033333333333, 28.192333333333337, 20.559333333333324, 39.771333333333345, 42.55433333333333, 19.368666666666655, 40.280333333333346, 21.12566666666666, 18.313, 57.35799999999999, 18.571666666666655, 46.789333333333346, 25.092999999999993, 29.780333333333335, 20.214999999999993, 33.61266666666666, 18.644999999999992, 25.663999999999987, 28.838, 23.806333333333335, 24.033666666666672, 18.016999999999996, 13.573999999999996, 37.107666666666674, 27.316999999999986, 23.433666666666657, 30.213999999999988, 30.60833333333333, 36.96366666666667, 16.853333333333325, 25.491999999999997, 17.82266666666666, 20.195, 33.846, 15.997999999999992, 47.27133333333337, 16.142999999999994, 24.543666666666667, 17.675, 22.738999999999994, 16.634999999999998, 50.9676666666667, 19.199666666666666], "episode_lengths": [51, 30, 87, 33, 57, 94, 85, 179, 44, 62, 34, 39, 93, 57, 70, 41, 70, 33, 54, 90, 68, 38, 66, 65, 39, 75, 43, 57, 40, 33, 29, 59, 33, 87, 39, 59, 70, 45, 34, 96, 90, 39, 40, 36, 45, 84, 58, 34, 44, 38, 67, 69, 108, 78, 105, 130, 40, 50, 64, 41, 81, 90, 53, 85, 58, 37, 87, 40, 71, 50, 58, 54, 71, 46, 66, 59, 44, 48, 38, 28, 62, 60, 64, 63, 66, 70, 41, 50, 35, 37, 59, 32, 93, 36, 60, 36, 42, 32, 86, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5888740336597267, "mean_inference_ms": 2.9000052492923856, "mean_action_processing_ms": 0.6075793253386249, "mean_env_wait_ms": 0.14741806072383212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018461942672729492, "StateBufferConnector_ms": 0.015088796615600586, "ViewRequirementAgentConnector_ms": 0.46481943130493164}}, "episode_reward_max": 72.35366666666661, "episode_reward_min": 13.573999999999996, "episode_reward_mean": 27.68297666666667, "episode_len_mean": 58.68, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.762666666666657, 14.613666666666662, 34.50866666666666, 17.258666666666667, 27.044666666666643, 41.447666666666656, 21.74599999999998, 72.35366666666661, 17.499999999999993, 22.58833333333332, 18.37366666666667, 21.458666666666662, 34.866666666666646, 25.693333333333328, 31.336333333333336, 21.081333333333326, 41.70366666666667, 15.687999999999999, 26.152999999999988, 35.99299999999999, 29.084999999999983, 15.131666666666659, 29.71966666666665, 30.459333333333323, 15.441, 37.44966666666669, 18.900666666666663, 23.960333333333327, 17.431666666666658, 16.762333333333327, 14.593333333333335, 29.20566666666668, 15.745666666666661, 47.63, 13.598666666666663, 22.274666666666658, 37.66366666666666, 22.24966666666667, 17.892666666666656, 50.69766666666664, 48.18366666666666, 16.63333333333333, 18.773666666666657, 16.40899999999999, 22.728333333333328, 40.366999999999976, 23.441666666666663, 16.01799999999999, 21.81966666666666, 19.96566666666666, 37.568666666666665, 33.569999999999986, 40.95966666666665, 39.84833333333333, 37.57533333333331, 61.219, 20.072999999999997, 29.89033333333333, 28.192333333333337, 20.559333333333324, 39.771333333333345, 42.55433333333333, 19.368666666666655, 40.280333333333346, 21.12566666666666, 18.313, 57.35799999999999, 18.571666666666655, 46.789333333333346, 25.092999999999993, 29.780333333333335, 20.214999999999993, 33.61266666666666, 18.644999999999992, 25.663999999999987, 28.838, 23.806333333333335, 24.033666666666672, 18.016999999999996, 13.573999999999996, 37.107666666666674, 27.316999999999986, 23.433666666666657, 30.213999999999988, 30.60833333333333, 36.96366666666667, 16.853333333333325, 25.491999999999997, 17.82266666666666, 20.195, 33.846, 15.997999999999992, 47.27133333333337, 16.142999999999994, 24.543666666666667, 17.675, 22.738999999999994, 16.634999999999998, 50.9676666666667, 19.199666666666666], "episode_lengths": [51, 30, 87, 33, 57, 94, 85, 179, 44, 62, 34, 39, 93, 57, 70, 41, 70, 33, 54, 90, 68, 38, 66, 65, 39, 75, 43, 57, 40, 33, 29, 59, 33, 87, 39, 59, 70, 45, 34, 96, 90, 39, 40, 36, 45, 84, 58, 34, 44, 38, 67, 69, 108, 78, 105, 130, 40, 50, 64, 41, 81, 90, 53, 85, 58, 37, 87, 40, 71, 50, 58, 54, 71, 46, 66, 59, 44, 48, 38, 28, 62, 60, 64, 63, 66, 70, 41, 50, 35, 37, 59, 32, 93, 36, 60, 36, 42, 32, 86, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5888740336597267, "mean_inference_ms": 2.9000052492923856, "mean_action_processing_ms": 0.6075793253386249, "mean_env_wait_ms": 0.14741806072383212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018461942672729492, "StateBufferConnector_ms": 0.015088796615600586, "ViewRequirementAgentConnector_ms": 0.46481943130493164}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.4656028522089, "num_env_steps_trained_throughput_per_sec": 388.4656028522089, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 8850.782, "sample_time_ms": 2989.926, "load_time_ms": 0.668, "load_throughput": 5987799.707, "learn_time_ms": 5827.784, "learn_throughput": 686.367, "synch_weights_time_ms": 30.001}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 3154, "training_iteration": 37, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-11-55", "timestamp": 1701997915, "time_this_iter_s": 10.335913896560669, "time_total_s": 1572.626320362091, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1572.626320362091, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 76.62142857142858, "ram_util_percent": 83.42857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.029141991741426e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 5.83494234085083, "policy_loss": -0.005258701276034117, "vf_loss": 5.840200901031494, "vf_explained_var": 0.5772644877433777, "kl": 0.00019296097161713988, "entropy": 0.020877161994576454, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 85.02233333333338, "episode_reward_min": 13.573999999999996, "episode_reward_mean": 27.45372333333333, "episode_len_mean": 57.22, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.313, 57.35799999999999, 18.571666666666655, 46.789333333333346, 25.092999999999993, 29.780333333333335, 20.214999999999993, 33.61266666666666, 18.644999999999992, 25.663999999999987, 28.838, 23.806333333333335, 24.033666666666672, 18.016999999999996, 13.573999999999996, 37.107666666666674, 27.316999999999986, 23.433666666666657, 30.213999999999988, 30.60833333333333, 36.96366666666667, 16.853333333333325, 25.491999999999997, 17.82266666666666, 20.195, 33.846, 15.997999999999992, 47.27133333333337, 16.142999999999994, 24.543666666666667, 17.675, 22.738999999999994, 16.634999999999998, 50.9676666666667, 19.199666666666666, 30.263999999999996, 26.285, 31.669999999999995, 20.00966666666666, 23.182999999999996, 28.90833333333331, 19.093666666666657, 18.173666666666662, 17.03566666666666, 34.27766666666667, 25.941333333333336, 18.70866666666666, 19.80866666666666, 38.92766666666666, 18.465666666666667, 22.925333333333324, 30.923666666666673, 15.311666666666659, 20.228999999999985, 19.526999999999997, 27.643666666666658, 85.02233333333338, 20.337666666666657, 20.374333333333325, 14.751666666666667, 15.008333333333328, 36.43399999999999, 44.57766666666667, 20.044999999999995, 27.091666666666647, 22.13166666666665, 38.777333333333324, 25.852999999999994, 24.46633333333331, 21.604666666666652, 36.701666666666654, 29.052666666666674, 33.878666666666675, 22.012666666666668, 42.00733333333335, 39.98299999999999, 43.424333333333315, 18.482333333333326, 26.46499999999999, 34.036, 40.778000000000006, 15.638666666666657, 15.654666666666664, 42.60700000000002, 19.863666666666656, 46.30966666666669, 22.720666666666663, 21.517000000000003, 56.90066666666665, 15.282666666666664, 18.238333333333337, 31.84033333333335, 47.02566666666666, 20.45233333333332, 20.412666666666663, 33.06033333333334, 15.223333333333327, 37.52933333333332, 18.81633333333333, 22.331999999999994], "episode_lengths": [37, 87, 40, 71, 50, 58, 54, 71, 46, 66, 59, 44, 48, 38, 28, 62, 60, 64, 63, 66, 70, 41, 50, 35, 37, 59, 32, 93, 36, 60, 36, 42, 32, 86, 42, 53, 57, 67, 44, 44, 72, 46, 38, 38, 67, 51, 49, 48, 81, 38, 53, 56, 36, 72, 42, 58, 147, 44, 40, 30, 34, 67, 82, 39, 64, 58, 73, 44, 68, 69, 62, 55, 69, 41, 75, 84, 96, 40, 89, 71, 83, 35, 32, 73, 54, 98, 45, 46, 123, 31, 44, 73, 93, 50, 41, 76, 33, 81, 44, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5982649717487123, "mean_inference_ms": 2.9221704363701893, "mean_action_processing_ms": 0.6111793724023061, "mean_env_wait_ms": 0.14800848079871345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019895076751708984, "StateBufferConnector_ms": 0.013901710510253906, "ViewRequirementAgentConnector_ms": 0.7148864269256592}}, "episode_reward_max": 85.02233333333338, "episode_reward_min": 13.573999999999996, "episode_reward_mean": 27.45372333333333, "episode_len_mean": 57.22, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.313, 57.35799999999999, 18.571666666666655, 46.789333333333346, 25.092999999999993, 29.780333333333335, 20.214999999999993, 33.61266666666666, 18.644999999999992, 25.663999999999987, 28.838, 23.806333333333335, 24.033666666666672, 18.016999999999996, 13.573999999999996, 37.107666666666674, 27.316999999999986, 23.433666666666657, 30.213999999999988, 30.60833333333333, 36.96366666666667, 16.853333333333325, 25.491999999999997, 17.82266666666666, 20.195, 33.846, 15.997999999999992, 47.27133333333337, 16.142999999999994, 24.543666666666667, 17.675, 22.738999999999994, 16.634999999999998, 50.9676666666667, 19.199666666666666, 30.263999999999996, 26.285, 31.669999999999995, 20.00966666666666, 23.182999999999996, 28.90833333333331, 19.093666666666657, 18.173666666666662, 17.03566666666666, 34.27766666666667, 25.941333333333336, 18.70866666666666, 19.80866666666666, 38.92766666666666, 18.465666666666667, 22.925333333333324, 30.923666666666673, 15.311666666666659, 20.228999999999985, 19.526999999999997, 27.643666666666658, 85.02233333333338, 20.337666666666657, 20.374333333333325, 14.751666666666667, 15.008333333333328, 36.43399999999999, 44.57766666666667, 20.044999999999995, 27.091666666666647, 22.13166666666665, 38.777333333333324, 25.852999999999994, 24.46633333333331, 21.604666666666652, 36.701666666666654, 29.052666666666674, 33.878666666666675, 22.012666666666668, 42.00733333333335, 39.98299999999999, 43.424333333333315, 18.482333333333326, 26.46499999999999, 34.036, 40.778000000000006, 15.638666666666657, 15.654666666666664, 42.60700000000002, 19.863666666666656, 46.30966666666669, 22.720666666666663, 21.517000000000003, 56.90066666666665, 15.282666666666664, 18.238333333333337, 31.84033333333335, 47.02566666666666, 20.45233333333332, 20.412666666666663, 33.06033333333334, 15.223333333333327, 37.52933333333332, 18.81633333333333, 22.331999999999994], "episode_lengths": [37, 87, 40, 71, 50, 58, 54, 71, 46, 66, 59, 44, 48, 38, 28, 62, 60, 64, 63, 66, 70, 41, 50, 35, 37, 59, 32, 93, 36, 60, 36, 42, 32, 86, 42, 53, 57, 67, 44, 44, 72, 46, 38, 38, 67, 51, 49, 48, 81, 38, 53, 56, 36, 72, 42, 58, 147, 44, 40, 30, 34, 67, 82, 39, 64, 58, 73, 44, 68, 69, 62, 55, 69, 41, 75, 84, 96, 40, 89, 71, 83, 35, 32, 73, 54, 98, 45, 46, 123, 31, 44, 73, 93, 50, 41, 76, 33, 81, 44, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5982649717487123, "mean_inference_ms": 2.9221704363701893, "mean_action_processing_ms": 0.6111793724023061, "mean_env_wait_ms": 0.14800848079871345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019895076751708984, "StateBufferConnector_ms": 0.013901710510253906, "ViewRequirementAgentConnector_ms": 0.7148864269256592}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.8671266076414, "num_env_steps_trained_throughput_per_sec": 386.8671266076414, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 8853.858, "sample_time_ms": 3040.583, "load_time_ms": 0.664, "load_throughput": 6020892.159, "learn_time_ms": 5782.11, "learn_throughput": 691.789, "synch_weights_time_ms": 28.242}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 3219, "training_iteration": 38, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-12-05", "timestamp": 1701997925, "time_this_iter_s": 10.358014583587646, "time_total_s": 1582.9843349456787, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1582.9843349456787, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 75.81538461538463, "ram_util_percent": 86.6076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.514570995870713e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 5.793834686279297, "policy_loss": -0.008790768682956696, "vf_loss": 5.8026251792907715, "vf_explained_var": 0.6248089075088501, "kl": 0.03054136410355568, "entropy": 0.09935270249843597, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 65.61200000000004, "episode_reward_min": 15.223333333333327, "episode_reward_mean": 28.495783333333335, "episode_len_mean": 60.7, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.46633333333331, 21.604666666666652, 36.701666666666654, 29.052666666666674, 33.878666666666675, 22.012666666666668, 42.00733333333335, 39.98299999999999, 43.424333333333315, 18.482333333333326, 26.46499999999999, 34.036, 40.778000000000006, 15.638666666666657, 15.654666666666664, 42.60700000000002, 19.863666666666656, 46.30966666666669, 22.720666666666663, 21.517000000000003, 56.90066666666665, 15.282666666666664, 18.238333333333337, 31.84033333333335, 47.02566666666666, 20.45233333333332, 20.412666666666663, 33.06033333333334, 15.223333333333327, 37.52933333333332, 18.81633333333333, 22.331999999999994, 32.05866666666665, 15.632999999999996, 22.678333333333335, 52.412666666666695, 33.12833333333332, 26.463666666666665, 28.43033333333332, 17.419, 33.740999999999985, 21.211666666666652, 32.57966666666666, 57.376333333333385, 23.589666666666666, 28.122333333333327, 65.61200000000004, 43.76433333333333, 40.58099999999997, 32.083333333333336, 27.941666666666652, 15.444999999999999, 21.735666666666656, 17.63133333333333, 18.66099999999999, 21.312333333333324, 28.70566666666667, 19.726333333333326, 31.097666666666665, 40.77399999999998, 29.25, 15.376666666666662, 17.029666666666664, 18.57733333333333, 18.89066666666666, 20.950666666666653, 16.900666666666663, 28.785333333333337, 58.773000000000046, 27.053666666666658, 35.34633333333331, 46.73899999999996, 26.174666666666656, 22.201333333333327, 20.871999999999996, 26.14966666666666, 24.77566666666666, 24.092333333333336, 45.48700000000002, 41.76566666666669, 19.11466666666666, 32.80733333333333, 29.98033333333333, 17.847666666666658, 33.031666666666666, 17.114333333333327, 21.687, 24.384000000000004, 33.57866666666666, 17.846999999999994, 19.914333333333328, 17.76699999999999, 21.19266666666666, 22.238333333333337, 21.48499999999998, 20.94666666666665, 34.93633333333334, 47.61200000000002, 29.89733333333333, 16.77066666666666], "episode_lengths": [68, 69, 62, 55, 69, 41, 75, 84, 96, 40, 89, 71, 83, 35, 32, 73, 54, 98, 45, 46, 123, 31, 44, 73, 93, 50, 41, 76, 33, 81, 44, 53, 84, 31, 52, 111, 52, 60, 58, 38, 56, 42, 62, 104, 52, 50, 105, 100, 112, 67, 74, 32, 48, 35, 54, 44, 64, 50, 57, 103, 73, 31, 34, 48, 55, 63, 33, 63, 124, 50, 69, 95, 67, 51, 55, 46, 47, 50, 96, 78, 41, 53, 62, 38, 72, 36, 47, 45, 61, 48, 36, 35, 51, 43, 52, 53, 66, 97, 49, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6013226356462393, "mean_inference_ms": 2.9286319634541615, "mean_action_processing_ms": 0.6121573536487271, "mean_env_wait_ms": 0.14768595605908327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01702094078063965, "StateBufferConnector_ms": 0.008633136749267578, "ViewRequirementAgentConnector_ms": 0.5556111335754395}}, "episode_reward_max": 65.61200000000004, "episode_reward_min": 15.223333333333327, "episode_reward_mean": 28.495783333333335, "episode_len_mean": 60.7, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.46633333333331, 21.604666666666652, 36.701666666666654, 29.052666666666674, 33.878666666666675, 22.012666666666668, 42.00733333333335, 39.98299999999999, 43.424333333333315, 18.482333333333326, 26.46499999999999, 34.036, 40.778000000000006, 15.638666666666657, 15.654666666666664, 42.60700000000002, 19.863666666666656, 46.30966666666669, 22.720666666666663, 21.517000000000003, 56.90066666666665, 15.282666666666664, 18.238333333333337, 31.84033333333335, 47.02566666666666, 20.45233333333332, 20.412666666666663, 33.06033333333334, 15.223333333333327, 37.52933333333332, 18.81633333333333, 22.331999999999994, 32.05866666666665, 15.632999999999996, 22.678333333333335, 52.412666666666695, 33.12833333333332, 26.463666666666665, 28.43033333333332, 17.419, 33.740999999999985, 21.211666666666652, 32.57966666666666, 57.376333333333385, 23.589666666666666, 28.122333333333327, 65.61200000000004, 43.76433333333333, 40.58099999999997, 32.083333333333336, 27.941666666666652, 15.444999999999999, 21.735666666666656, 17.63133333333333, 18.66099999999999, 21.312333333333324, 28.70566666666667, 19.726333333333326, 31.097666666666665, 40.77399999999998, 29.25, 15.376666666666662, 17.029666666666664, 18.57733333333333, 18.89066666666666, 20.950666666666653, 16.900666666666663, 28.785333333333337, 58.773000000000046, 27.053666666666658, 35.34633333333331, 46.73899999999996, 26.174666666666656, 22.201333333333327, 20.871999999999996, 26.14966666666666, 24.77566666666666, 24.092333333333336, 45.48700000000002, 41.76566666666669, 19.11466666666666, 32.80733333333333, 29.98033333333333, 17.847666666666658, 33.031666666666666, 17.114333333333327, 21.687, 24.384000000000004, 33.57866666666666, 17.846999999999994, 19.914333333333328, 17.76699999999999, 21.19266666666666, 22.238333333333337, 21.48499999999998, 20.94666666666665, 34.93633333333334, 47.61200000000002, 29.89733333333333, 16.77066666666666], "episode_lengths": [68, 69, 62, 55, 69, 41, 75, 84, 96, 40, 89, 71, 83, 35, 32, 73, 54, 98, 45, 46, 123, 31, 44, 73, 93, 50, 41, 76, 33, 81, 44, 53, 84, 31, 52, 111, 52, 60, 58, 38, 56, 42, 62, 104, 52, 50, 105, 100, 112, 67, 74, 32, 48, 35, 54, 44, 64, 50, 57, 103, 73, 31, 34, 48, 55, 63, 33, 63, 124, 50, 69, 95, 67, 51, 55, 46, 47, 50, 96, 78, 41, 53, 62, 38, 72, 36, 47, 45, 61, 48, 36, 35, 51, 43, 52, 53, 66, 97, 49, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6013226356462393, "mean_inference_ms": 2.9286319634541615, "mean_action_processing_ms": 0.6121573536487271, "mean_env_wait_ms": 0.14768595605908327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01702094078063965, "StateBufferConnector_ms": 0.008633136749267578, "ViewRequirementAgentConnector_ms": 0.5556111335754395}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.8327528559134, "num_env_steps_trained_throughput_per_sec": 425.8327528559134, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 8914.748, "sample_time_ms": 2997.48, "load_time_ms": 0.664, "load_throughput": 6019811.984, "learn_time_ms": 5885.159, "learn_throughput": 679.676, "synch_weights_time_ms": 29.135}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 3287, "training_iteration": 39, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-12-15", "timestamp": 1701997935, "time_this_iter_s": 9.42383337020874, "time_total_s": 1592.4081683158875, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1592.4081683158875, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 77.2, "ram_util_percent": 86.42307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.771856604828372e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 5.134827613830566, "policy_loss": -0.008944264613091946, "vf_loss": 5.143772125244141, "vf_explained_var": 0.582627534866333, "kl": 0.001743291737511754, "entropy": 0.18877796828746796, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 72.7443333333334, "episode_reward_min": 11.224666666666664, "episode_reward_mean": 25.583326666666668, "episode_len_mean": 55.53, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.201333333333327, 20.871999999999996, 26.14966666666666, 24.77566666666666, 24.092333333333336, 45.48700000000002, 41.76566666666669, 19.11466666666666, 32.80733333333333, 29.98033333333333, 17.847666666666658, 33.031666666666666, 17.114333333333327, 21.687, 24.384000000000004, 33.57866666666666, 17.846999999999994, 19.914333333333328, 17.76699999999999, 21.19266666666666, 22.238333333333337, 21.48499999999998, 20.94666666666665, 34.93633333333334, 47.61200000000002, 29.89733333333333, 16.77066666666666, 44.014666666666656, 30.739999999999995, 34.767333333333305, 38.33666666666668, 25.671666666666642, 47.635333333333286, 20.034666666666663, 16.757666666666662, 31.319999999999993, 36.626666666666644, 15.329333333333333, 40.3353333333333, 18.136999999999993, 14.978999999999994, 15.292000000000002, 23.703999999999994, 21.563666666666663, 14.14233333333333, 18.006666666666657, 25.601333333333333, 17.910333333333323, 17.71699999999999, 13.825666666666663, 25.287999999999997, 13.793999999999997, 24.510666666666662, 20.760999999999996, 28.89933333333334, 23.131333333333338, 15.58733333333333, 25.227, 17.417999999999992, 49.67966666666666, 19.622666666666664, 29.14499999999999, 20.258666666666663, 17.09166666666666, 17.722666666666658, 29.899999999999988, 25.148333333333323, 22.703333333333326, 34.455000000000005, 24.256999999999987, 14.05733333333333, 27.479666666666667, 20.50466666666666, 18.935999999999993, 20.17633333333333, 13.839000000000002, 16.588999999999995, 26.648, 25.360999999999983, 36.25466666666665, 44.826333333333366, 72.7443333333334, 11.224666666666664, 18.446666666666665, 20.131333333333323, 26.47899999999999, 19.818666666666658, 37.62466666666665, 43.45033333333335, 24.26966666666664, 32.13233333333333, 23.136666666666663, 26.828666666666667, 19.304666666666673, 17.982, 32.744666666666674, 17.244333333333337, 31.584666666666646, 24.343333333333323, 21.624333333333315], "episode_lengths": [51, 55, 46, 47, 50, 96, 78, 41, 53, 62, 38, 72, 36, 47, 45, 61, 48, 36, 35, 51, 43, 52, 53, 66, 97, 49, 33, 96, 57, 84, 72, 92, 115, 42, 32, 57, 91, 31, 89, 42, 35, 28, 49, 55, 28, 47, 44, 47, 46, 28, 57, 28, 58, 46, 51, 56, 33, 70, 39, 144, 41, 67, 43, 37, 48, 55, 44, 52, 70, 61, 28, 54, 36, 51, 49, 28, 39, 54, 66, 58, 76, 116, 27, 37, 67, 66, 42, 91, 87, 80, 58, 70, 48, 34, 35, 69, 43, 79, 55, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6056481206666047, "mean_inference_ms": 2.941788035768023, "mean_action_processing_ms": 0.6131237729326279, "mean_env_wait_ms": 0.14828504653482924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013674020767211914, "StateBufferConnector_ms": 0.012779712677001953, "ViewRequirementAgentConnector_ms": 0.6621429920196533}}, "episode_reward_max": 72.7443333333334, "episode_reward_min": 11.224666666666664, "episode_reward_mean": 25.583326666666668, "episode_len_mean": 55.53, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.201333333333327, 20.871999999999996, 26.14966666666666, 24.77566666666666, 24.092333333333336, 45.48700000000002, 41.76566666666669, 19.11466666666666, 32.80733333333333, 29.98033333333333, 17.847666666666658, 33.031666666666666, 17.114333333333327, 21.687, 24.384000000000004, 33.57866666666666, 17.846999999999994, 19.914333333333328, 17.76699999999999, 21.19266666666666, 22.238333333333337, 21.48499999999998, 20.94666666666665, 34.93633333333334, 47.61200000000002, 29.89733333333333, 16.77066666666666, 44.014666666666656, 30.739999999999995, 34.767333333333305, 38.33666666666668, 25.671666666666642, 47.635333333333286, 20.034666666666663, 16.757666666666662, 31.319999999999993, 36.626666666666644, 15.329333333333333, 40.3353333333333, 18.136999999999993, 14.978999999999994, 15.292000000000002, 23.703999999999994, 21.563666666666663, 14.14233333333333, 18.006666666666657, 25.601333333333333, 17.910333333333323, 17.71699999999999, 13.825666666666663, 25.287999999999997, 13.793999999999997, 24.510666666666662, 20.760999999999996, 28.89933333333334, 23.131333333333338, 15.58733333333333, 25.227, 17.417999999999992, 49.67966666666666, 19.622666666666664, 29.14499999999999, 20.258666666666663, 17.09166666666666, 17.722666666666658, 29.899999999999988, 25.148333333333323, 22.703333333333326, 34.455000000000005, 24.256999999999987, 14.05733333333333, 27.479666666666667, 20.50466666666666, 18.935999999999993, 20.17633333333333, 13.839000000000002, 16.588999999999995, 26.648, 25.360999999999983, 36.25466666666665, 44.826333333333366, 72.7443333333334, 11.224666666666664, 18.446666666666665, 20.131333333333323, 26.47899999999999, 19.818666666666658, 37.62466666666665, 43.45033333333335, 24.26966666666664, 32.13233333333333, 23.136666666666663, 26.828666666666667, 19.304666666666673, 17.982, 32.744666666666674, 17.244333333333337, 31.584666666666646, 24.343333333333323, 21.624333333333315], "episode_lengths": [51, 55, 46, 47, 50, 96, 78, 41, 53, 62, 38, 72, 36, 47, 45, 61, 48, 36, 35, 51, 43, 52, 53, 66, 97, 49, 33, 96, 57, 84, 72, 92, 115, 42, 32, 57, 91, 31, 89, 42, 35, 28, 49, 55, 28, 47, 44, 47, 46, 28, 57, 28, 58, 46, 51, 56, 33, 70, 39, 144, 41, 67, 43, 37, 48, 55, 44, 52, 70, 61, 28, 54, 36, 51, 49, 28, 39, 54, 66, 58, 76, 116, 27, 37, 67, 66, 42, 91, 87, 80, 58, 70, 48, 34, 35, 69, 43, 79, 55, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6056481206666047, "mean_inference_ms": 2.941788035768023, "mean_action_processing_ms": 0.6131237729326279, "mean_env_wait_ms": 0.14828504653482924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013674020767211914, "StateBufferConnector_ms": 0.012779712677001953, "ViewRequirementAgentConnector_ms": 0.6621429920196533}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.16572697604175, "num_env_steps_trained_throughput_per_sec": 403.16572697604175, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9044.828, "sample_time_ms": 3045.24, "load_time_ms": 0.665, "load_throughput": 6017221.146, "learn_time_ms": 5967.682, "learn_throughput": 670.277, "synch_weights_time_ms": 29.001}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 3360, "training_iteration": 40, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-12-25", "timestamp": 1701997945, "time_this_iter_s": 9.943492650985718, "time_total_s": 1602.3516609668732, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1602.3516609668732, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 74.5, "ram_util_percent": 85.72307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.885928302414186e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 5.558645725250244, "policy_loss": -0.008116494864225388, "vf_loss": 5.566762447357178, "vf_explained_var": 0.5574686527252197, "kl": 0.003805409884080291, "entropy": 0.17169825732707977, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 79.06166666666672, "episode_reward_min": 11.224666666666664, "episode_reward_mean": 26.410379999999996, "episode_len_mean": 55.83, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.935999999999993, 20.17633333333333, 13.839000000000002, 16.588999999999995, 26.648, 25.360999999999983, 36.25466666666665, 44.826333333333366, 72.7443333333334, 11.224666666666664, 18.446666666666665, 20.131333333333323, 26.47899999999999, 19.818666666666658, 37.62466666666665, 43.45033333333335, 24.26966666666664, 32.13233333333333, 23.136666666666663, 26.828666666666667, 19.304666666666673, 17.982, 32.744666666666674, 17.244333333333337, 31.584666666666646, 24.343333333333323, 21.624333333333315, 36.06566666666665, 21.371666666666655, 17.962999999999994, 21.67333333333332, 29.551999999999975, 38.39766666666668, 71.52533333333332, 54.300333333333334, 26.58, 14.361666666666665, 26.613666666666674, 14.341, 19.897, 16.952999999999996, 16.502666666666666, 19.960666666666665, 22.671999999999986, 20.442, 21.86133333333333, 13.083333333333332, 42.237333333333304, 14.688000000000002, 18.88533333333332, 27.650666666666677, 29.380333333333336, 15.105333333333329, 22.379666666666676, 32.83933333333335, 17.542666666666662, 29.018333333333334, 58.68600000000002, 38.61533333333333, 28.910333333333323, 30.817666666666664, 32.50533333333334, 24.471000000000004, 23.75366666666667, 29.30666666666665, 39.56366666666664, 35.07766666666666, 19.139666666666667, 16.97733333333333, 16.09866666666666, 19.671999999999997, 17.548, 79.06166666666672, 13.463333333333335, 29.54833333333333, 15.493999999999996, 38.10199999999999, 22.733666666666657, 18.41333333333333, 15.307666666666663, 26.80533333333332, 24.398999999999994, 21.827666666666655, 16.623333333333328, 55.68699999999997, 24.34199999999999, 45.82666666666666, 40.19766666666666, 16.66866666666666, 15.302333333333328, 19.867666666666665, 13.691, 23.857999999999993, 24.21866666666666, 14.477999999999993, 20.436666666666667, 20.808999999999983, 13.490666666666666, 17.238666666666667, 24.41333333333333], "episode_lengths": [51, 49, 28, 39, 54, 66, 58, 76, 116, 27, 37, 67, 66, 42, 91, 87, 80, 58, 70, 48, 34, 35, 69, 43, 79, 55, 62, 58, 53, 57, 46, 55, 96, 115, 95, 57, 28, 50, 37, 42, 36, 34, 55, 60, 43, 43, 27, 69, 29, 51, 54, 47, 32, 54, 69, 39, 48, 96, 63, 66, 81, 65, 41, 42, 91, 93, 71, 46, 34, 43, 42, 36, 145, 27, 57, 31, 78, 57, 37, 32, 63, 48, 62, 38, 114, 54, 97, 80, 43, 37, 47, 26, 54, 50, 31, 37, 49, 27, 39, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.606601639432977, "mean_inference_ms": 2.943763320001479, "mean_action_processing_ms": 0.6148279885995794, "mean_env_wait_ms": 0.14825045085964939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022396087646484375, "StateBufferConnector_ms": 0.01801466941833496, "ViewRequirementAgentConnector_ms": 0.6095542907714844}}, "episode_reward_max": 79.06166666666672, "episode_reward_min": 11.224666666666664, "episode_reward_mean": 26.410379999999996, "episode_len_mean": 55.83, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.935999999999993, 20.17633333333333, 13.839000000000002, 16.588999999999995, 26.648, 25.360999999999983, 36.25466666666665, 44.826333333333366, 72.7443333333334, 11.224666666666664, 18.446666666666665, 20.131333333333323, 26.47899999999999, 19.818666666666658, 37.62466666666665, 43.45033333333335, 24.26966666666664, 32.13233333333333, 23.136666666666663, 26.828666666666667, 19.304666666666673, 17.982, 32.744666666666674, 17.244333333333337, 31.584666666666646, 24.343333333333323, 21.624333333333315, 36.06566666666665, 21.371666666666655, 17.962999999999994, 21.67333333333332, 29.551999999999975, 38.39766666666668, 71.52533333333332, 54.300333333333334, 26.58, 14.361666666666665, 26.613666666666674, 14.341, 19.897, 16.952999999999996, 16.502666666666666, 19.960666666666665, 22.671999999999986, 20.442, 21.86133333333333, 13.083333333333332, 42.237333333333304, 14.688000000000002, 18.88533333333332, 27.650666666666677, 29.380333333333336, 15.105333333333329, 22.379666666666676, 32.83933333333335, 17.542666666666662, 29.018333333333334, 58.68600000000002, 38.61533333333333, 28.910333333333323, 30.817666666666664, 32.50533333333334, 24.471000000000004, 23.75366666666667, 29.30666666666665, 39.56366666666664, 35.07766666666666, 19.139666666666667, 16.97733333333333, 16.09866666666666, 19.671999999999997, 17.548, 79.06166666666672, 13.463333333333335, 29.54833333333333, 15.493999999999996, 38.10199999999999, 22.733666666666657, 18.41333333333333, 15.307666666666663, 26.80533333333332, 24.398999999999994, 21.827666666666655, 16.623333333333328, 55.68699999999997, 24.34199999999999, 45.82666666666666, 40.19766666666666, 16.66866666666666, 15.302333333333328, 19.867666666666665, 13.691, 23.857999999999993, 24.21866666666666, 14.477999999999993, 20.436666666666667, 20.808999999999983, 13.490666666666666, 17.238666666666667, 24.41333333333333], "episode_lengths": [51, 49, 28, 39, 54, 66, 58, 76, 116, 27, 37, 67, 66, 42, 91, 87, 80, 58, 70, 48, 34, 35, 69, 43, 79, 55, 62, 58, 53, 57, 46, 55, 96, 115, 95, 57, 28, 50, 37, 42, 36, 34, 55, 60, 43, 43, 27, 69, 29, 51, 54, 47, 32, 54, 69, 39, 48, 96, 63, 66, 81, 65, 41, 42, 91, 93, 71, 46, 34, 43, 42, 36, 145, 27, 57, 31, 78, 57, 37, 32, 63, 48, 62, 38, 114, 54, 97, 80, 43, 37, 47, 26, 54, 50, 31, 37, 49, 27, 39, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.606601639432977, "mean_inference_ms": 2.943763320001479, "mean_action_processing_ms": 0.6148279885995794, "mean_env_wait_ms": 0.14825045085964939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022396087646484375, "StateBufferConnector_ms": 0.01801466941833496, "ViewRequirementAgentConnector_ms": 0.6095542907714844}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.10528776474496, "num_env_steps_trained_throughput_per_sec": 437.10528776474496, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 8918.195, "sample_time_ms": 3038.454, "load_time_ms": 0.665, "load_throughput": 6017221.146, "learn_time_ms": 5846.894, "learn_throughput": 684.124, "synch_weights_time_ms": 29.798}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 3433, "training_iteration": 41, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-12-34", "timestamp": 1701997954, "time_this_iter_s": 9.172066688537598, "time_total_s": 1611.5237276554108, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1611.5237276554108, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 72.63846153846154, "ram_util_percent": 85.22307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.42964151207093e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 5.522153377532959, "policy_loss": -0.007229739334434271, "vf_loss": 5.529383182525635, "vf_explained_var": 0.5716739296913147, "kl": 0.001247845939360559, "entropy": 0.1594909280538559, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 79.06166666666672, "episode_reward_min": 13.463333333333335, "episode_reward_mean": 25.71680666666667, "episode_len_mean": 54.46, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.06166666666672, 13.463333333333335, 29.54833333333333, 15.493999999999996, 38.10199999999999, 22.733666666666657, 18.41333333333333, 15.307666666666663, 26.80533333333332, 24.398999999999994, 21.827666666666655, 16.623333333333328, 55.68699999999997, 24.34199999999999, 45.82666666666666, 40.19766666666666, 16.66866666666666, 15.302333333333328, 19.867666666666665, 13.691, 23.857999999999993, 24.21866666666666, 14.477999999999993, 20.436666666666667, 20.808999999999983, 13.490666666666666, 17.238666666666667, 24.41333333333333, 20.048000000000002, 22.36866666666666, 18.628333333333327, 28.415333333333344, 18.89433333333333, 16.42366666666666, 19.378666666666653, 18.42333333333333, 18.322999999999997, 29.92966666666666, 46.46866666666668, 15.871, 24.793666666666656, 24.019, 32.51599999999999, 30.59, 16.50466666666666, 16.63433333333333, 29.57233333333335, 21.039333333333335, 28.156333333333325, 29.070333333333316, 41.38800000000001, 13.802333333333332, 19.22399999999999, 16.72366666666666, 18.34799999999999, 14.117999999999997, 25.089, 16.391999999999992, 13.671333333333331, 18.614999999999995, 20.048666666666662, 16.862333333333332, 26.342000000000006, 15.945999999999996, 21.071999999999992, 37.69366666666667, 28.59833333333332, 21.035333333333323, 35.80866666666666, 20.733666666666664, 21.964000000000006, 28.74, 21.913333333333327, 28.542333333333325, 56.188666666666684, 38.912333333333336, 24.098333333333326, 23.915666666666656, 30.468333333333327, 20.166666666666657, 14.994000000000003, 39.423333333333325, 45.201333333333345, 38.60566666666668, 16.58933333333333, 23.508333333333326, 20.063999999999993, 32.201333333333324, 18.565333333333328, 27.358666666666668, 16.977999999999994, 39.964666666666666, 32.951999999999984, 47.24566666666669, 26.571333333333328, 49.923333333333346, 20.058333333333334, 43.262, 14.089999999999993, 29.328333333333312], "episode_lengths": [145, 27, 57, 31, 78, 57, 37, 32, 63, 48, 62, 38, 114, 54, 97, 80, 43, 37, 47, 26, 54, 50, 31, 37, 49, 27, 39, 47, 53, 63, 45, 47, 46, 34, 43, 35, 38, 52, 82, 31, 62, 43, 80, 58, 38, 34, 48, 47, 64, 65, 69, 28, 41, 38, 50, 36, 58, 37, 30, 42, 46, 33, 47, 46, 55, 82, 71, 68, 59, 48, 59, 75, 57, 48, 119, 76, 47, 43, 70, 47, 29, 64, 74, 80, 36, 44, 43, 71, 35, 47, 47, 70, 79, 73, 65, 95, 42, 95, 31, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6016923610380354, "mean_inference_ms": 2.935921395450902, "mean_action_processing_ms": 0.6153821339104644, "mean_env_wait_ms": 0.14765096133815714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023098468780517578, "StateBufferConnector_ms": 0.017828941345214844, "ViewRequirementAgentConnector_ms": 0.4886467456817627}}, "episode_reward_max": 79.06166666666672, "episode_reward_min": 13.463333333333335, "episode_reward_mean": 25.71680666666667, "episode_len_mean": 54.46, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [79.06166666666672, 13.463333333333335, 29.54833333333333, 15.493999999999996, 38.10199999999999, 22.733666666666657, 18.41333333333333, 15.307666666666663, 26.80533333333332, 24.398999999999994, 21.827666666666655, 16.623333333333328, 55.68699999999997, 24.34199999999999, 45.82666666666666, 40.19766666666666, 16.66866666666666, 15.302333333333328, 19.867666666666665, 13.691, 23.857999999999993, 24.21866666666666, 14.477999999999993, 20.436666666666667, 20.808999999999983, 13.490666666666666, 17.238666666666667, 24.41333333333333, 20.048000000000002, 22.36866666666666, 18.628333333333327, 28.415333333333344, 18.89433333333333, 16.42366666666666, 19.378666666666653, 18.42333333333333, 18.322999999999997, 29.92966666666666, 46.46866666666668, 15.871, 24.793666666666656, 24.019, 32.51599999999999, 30.59, 16.50466666666666, 16.63433333333333, 29.57233333333335, 21.039333333333335, 28.156333333333325, 29.070333333333316, 41.38800000000001, 13.802333333333332, 19.22399999999999, 16.72366666666666, 18.34799999999999, 14.117999999999997, 25.089, 16.391999999999992, 13.671333333333331, 18.614999999999995, 20.048666666666662, 16.862333333333332, 26.342000000000006, 15.945999999999996, 21.071999999999992, 37.69366666666667, 28.59833333333332, 21.035333333333323, 35.80866666666666, 20.733666666666664, 21.964000000000006, 28.74, 21.913333333333327, 28.542333333333325, 56.188666666666684, 38.912333333333336, 24.098333333333326, 23.915666666666656, 30.468333333333327, 20.166666666666657, 14.994000000000003, 39.423333333333325, 45.201333333333345, 38.60566666666668, 16.58933333333333, 23.508333333333326, 20.063999999999993, 32.201333333333324, 18.565333333333328, 27.358666666666668, 16.977999999999994, 39.964666666666666, 32.951999999999984, 47.24566666666669, 26.571333333333328, 49.923333333333346, 20.058333333333334, 43.262, 14.089999999999993, 29.328333333333312], "episode_lengths": [145, 27, 57, 31, 78, 57, 37, 32, 63, 48, 62, 38, 114, 54, 97, 80, 43, 37, 47, 26, 54, 50, 31, 37, 49, 27, 39, 47, 53, 63, 45, 47, 46, 34, 43, 35, 38, 52, 82, 31, 62, 43, 80, 58, 38, 34, 48, 47, 64, 65, 69, 28, 41, 38, 50, 36, 58, 37, 30, 42, 46, 33, 47, 46, 55, 82, 71, 68, 59, 48, 59, 75, 57, 48, 119, 76, 47, 43, 70, 47, 29, 64, 74, 80, 36, 44, 43, 71, 35, 47, 47, 70, 79, 73, 65, 95, 42, 95, 31, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6016923610380354, "mean_inference_ms": 2.935921395450902, "mean_action_processing_ms": 0.6153821339104644, "mean_env_wait_ms": 0.14765096133815714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023098468780517578, "StateBufferConnector_ms": 0.017828941345214844, "ViewRequirementAgentConnector_ms": 0.4886467456817627}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.81949561636316, "num_env_steps_trained_throughput_per_sec": 454.81949561636316, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9054.34, "sample_time_ms": 3060.213, "load_time_ms": 0.765, "load_throughput": 5229153.472, "learn_time_ms": 5959.889, "learn_throughput": 671.153, "synch_weights_time_ms": 31.094}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 3505, "training_iteration": 42, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-12-43", "timestamp": 1701997963, "time_this_iter_s": 8.813752174377441, "time_total_s": 1620.3374798297882, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1620.3374798297882, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 70.09166666666667, "ram_util_percent": 84.75833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.714820756035465e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 5.369048118591309, "policy_loss": -0.006936181336641312, "vf_loss": 5.375985145568848, "vf_explained_var": 0.6741078495979309, "kl": 0.0008558898698538542, "entropy": 0.15407508611679077, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 56.44700000000007, "episode_reward_min": 13.809333333333331, "episode_reward_mean": 27.12936666666666, "episode_len_mean": 56.76, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.542333333333325, 56.188666666666684, 38.912333333333336, 24.098333333333326, 23.915666666666656, 30.468333333333327, 20.166666666666657, 14.994000000000003, 39.423333333333325, 45.201333333333345, 38.60566666666668, 16.58933333333333, 23.508333333333326, 20.063999999999993, 32.201333333333324, 18.565333333333328, 27.358666666666668, 16.977999999999994, 39.964666666666666, 32.951999999999984, 47.24566666666669, 26.571333333333328, 49.923333333333346, 20.058333333333334, 43.262, 14.089999999999993, 29.328333333333312, 56.44700000000007, 45.10366666666666, 28.143000000000004, 16.19566666666666, 23.50999999999999, 15.284333333333329, 21.505333333333326, 25.913999999999973, 17.62, 22.882333333333325, 19.01466666666666, 17.196999999999996, 20.238999999999994, 32.815333333333335, 42.44700000000001, 23.203333333333326, 45.44200000000001, 41.38900000000003, 36.47199999999999, 19.037333333333326, 19.623999999999995, 20.415999999999997, 15.94633333333333, 22.811666666666667, 26.344999999999988, 26.01833333333332, 19.678999999999988, 27.892666666666667, 24.901999999999973, 18.545999999999996, 38.997666666666674, 41.873666666666665, 15.644333333333325, 16.946999999999996, 34.22266666666667, 19.962333333333326, 21.091333333333335, 14.40366666666666, 24.75866666666667, 53.89566666666667, 39.93933333333332, 17.177, 32.61666666666668, 18.339333333333336, 16.218333333333327, 18.291333333333334, 20.29933333333333, 24.137333333333316, 22.580666666666662, 27.906666666666673, 25.417333333333332, 22.58299999999999, 25.544333333333334, 13.809333333333331, 16.56566666666666, 22.819666666666663, 15.652666666666667, 22.135666666666665, 22.864666666666672, 37.218, 24.650666666666663, 45.45900000000004, 30.10233333333333, 31.004666666666676, 16.275999999999996, 19.467333333333332, 26.396333333333324, 31.8623333333333, 16.95566666666666, 14.183666666666664, 36.879, 38.87233333333336, 25.693666666666658], "episode_lengths": [48, 119, 76, 47, 43, 70, 47, 29, 64, 74, 80, 36, 44, 43, 71, 35, 47, 47, 70, 79, 73, 65, 95, 42, 95, 31, 86, 92, 74, 52, 38, 52, 30, 58, 66, 35, 60, 46, 34, 48, 58, 78, 49, 93, 93, 95, 49, 51, 41, 31, 41, 60, 65, 38, 48, 93, 36, 77, 85, 32, 33, 60, 38, 44, 30, 49, 100, 94, 35, 66, 41, 32, 41, 41, 73, 48, 52, 59, 49, 62, 37, 33, 49, 38, 46, 49, 67, 45, 82, 53, 57, 37, 55, 54, 91, 38, 28, 82, 78, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5969232265923319, "mean_inference_ms": 2.9277808154714227, "mean_action_processing_ms": 0.6132524660900716, "mean_env_wait_ms": 0.14760092526092894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016989469528198242, "StateBufferConnector_ms": 0.010975360870361328, "ViewRequirementAgentConnector_ms": 0.4262504577636719}}, "episode_reward_max": 56.44700000000007, "episode_reward_min": 13.809333333333331, "episode_reward_mean": 27.12936666666666, "episode_len_mean": 56.76, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.542333333333325, 56.188666666666684, 38.912333333333336, 24.098333333333326, 23.915666666666656, 30.468333333333327, 20.166666666666657, 14.994000000000003, 39.423333333333325, 45.201333333333345, 38.60566666666668, 16.58933333333333, 23.508333333333326, 20.063999999999993, 32.201333333333324, 18.565333333333328, 27.358666666666668, 16.977999999999994, 39.964666666666666, 32.951999999999984, 47.24566666666669, 26.571333333333328, 49.923333333333346, 20.058333333333334, 43.262, 14.089999999999993, 29.328333333333312, 56.44700000000007, 45.10366666666666, 28.143000000000004, 16.19566666666666, 23.50999999999999, 15.284333333333329, 21.505333333333326, 25.913999999999973, 17.62, 22.882333333333325, 19.01466666666666, 17.196999999999996, 20.238999999999994, 32.815333333333335, 42.44700000000001, 23.203333333333326, 45.44200000000001, 41.38900000000003, 36.47199999999999, 19.037333333333326, 19.623999999999995, 20.415999999999997, 15.94633333333333, 22.811666666666667, 26.344999999999988, 26.01833333333332, 19.678999999999988, 27.892666666666667, 24.901999999999973, 18.545999999999996, 38.997666666666674, 41.873666666666665, 15.644333333333325, 16.946999999999996, 34.22266666666667, 19.962333333333326, 21.091333333333335, 14.40366666666666, 24.75866666666667, 53.89566666666667, 39.93933333333332, 17.177, 32.61666666666668, 18.339333333333336, 16.218333333333327, 18.291333333333334, 20.29933333333333, 24.137333333333316, 22.580666666666662, 27.906666666666673, 25.417333333333332, 22.58299999999999, 25.544333333333334, 13.809333333333331, 16.56566666666666, 22.819666666666663, 15.652666666666667, 22.135666666666665, 22.864666666666672, 37.218, 24.650666666666663, 45.45900000000004, 30.10233333333333, 31.004666666666676, 16.275999999999996, 19.467333333333332, 26.396333333333324, 31.8623333333333, 16.95566666666666, 14.183666666666664, 36.879, 38.87233333333336, 25.693666666666658], "episode_lengths": [48, 119, 76, 47, 43, 70, 47, 29, 64, 74, 80, 36, 44, 43, 71, 35, 47, 47, 70, 79, 73, 65, 95, 42, 95, 31, 86, 92, 74, 52, 38, 52, 30, 58, 66, 35, 60, 46, 34, 48, 58, 78, 49, 93, 93, 95, 49, 51, 41, 31, 41, 60, 65, 38, 48, 93, 36, 77, 85, 32, 33, 60, 38, 44, 30, 49, 100, 94, 35, 66, 41, 32, 41, 41, 73, 48, 52, 59, 49, 62, 37, 33, 49, 38, 46, 49, 67, 45, 82, 53, 57, 37, 55, 54, 91, 38, 28, 82, 78, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5969232265923319, "mean_inference_ms": 2.9277808154714227, "mean_action_processing_ms": 0.6132524660900716, "mean_env_wait_ms": 0.14760092526092894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016989469528198242, "StateBufferConnector_ms": 0.010975360870361328, "ViewRequirementAgentConnector_ms": 0.4262504577636719}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.4857535971516, "num_env_steps_trained_throughput_per_sec": 422.4857535971516, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 9190.171, "sample_time_ms": 3064.325, "load_time_ms": 0.765, "load_throughput": 5231436.233, "learn_time_ms": 6090.554, "learn_throughput": 656.755, "synch_weights_time_ms": 31.993}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 3578, "training_iteration": 43, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-12-53", "timestamp": 1701997973, "time_this_iter_s": 9.500803709030151, "time_total_s": 1629.8382835388184, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1629.8382835388184, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 72.32307692307693, "ram_util_percent": 85.63846153846156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3574103780177325e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 6.043854713439941, "policy_loss": -0.005661624018102884, "vf_loss": 6.049516677856445, "vf_explained_var": 0.5645140409469604, "kl": 0.0021628791000694036, "entropy": 0.12000186741352081, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 61.20366666666664, "episode_reward_min": 13.235333333333335, "episode_reward_mean": 26.93780333333333, "episode_len_mean": 56.92, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.61666666666668, 18.339333333333336, 16.218333333333327, 18.291333333333334, 20.29933333333333, 24.137333333333316, 22.580666666666662, 27.906666666666673, 25.417333333333332, 22.58299999999999, 25.544333333333334, 13.809333333333331, 16.56566666666666, 22.819666666666663, 15.652666666666667, 22.135666666666665, 22.864666666666672, 37.218, 24.650666666666663, 45.45900000000004, 30.10233333333333, 31.004666666666676, 16.275999999999996, 19.467333333333332, 26.396333333333324, 31.8623333333333, 16.95566666666666, 14.183666666666664, 36.879, 38.87233333333336, 25.693666666666658, 28.586999999999996, 50.31733333333335, 34.20066666666666, 17.325666666666663, 13.417000000000002, 42.891000000000005, 14.463999999999992, 47.012000000000015, 43.88066666666666, 43.945333333333295, 37.81766666666665, 15.142999999999997, 16.185333333333332, 36.99166666666668, 16.723999999999997, 18.530666666666658, 29.39733333333333, 21.304999999999996, 34.45066666666664, 24.874666666666656, 37.11066666666666, 28.500666666666667, 14.934999999999992, 47.70033333333332, 34.538, 61.20366666666664, 13.235333333333335, 19.644, 24.711333333333336, 16.087666666666664, 22.450999999999993, 21.882333333333328, 27.904666666666664, 18.86366666666666, 15.094666666666662, 22.87866666666665, 37.434333333333306, 40.506000000000014, 23.213666666666658, 19.20766666666667, 20.49299999999999, 17.197666666666663, 15.050999999999995, 17.34333333333333, 44.12566666666669, 24.282333333333334, 17.483333333333334, 30.498666666666658, 14.368333333333329, 23.369666666666667, 18.508, 32.79466666666666, 33.98666666666667, 37.766, 43.42433333333334, 43.589000000000006, 32.884000000000015, 22.208, 13.458333333333332, 42.169666666666686, 57.796333333333344, 18.18666666666666, 28.270333333333333, 39.36066666666666, 22.60266666666666, 30.366666666666653, 18.732333333333322, 19.976999999999993, 16.118999999999993], "episode_lengths": [66, 41, 32, 41, 41, 73, 48, 52, 59, 49, 62, 37, 33, 49, 38, 46, 49, 67, 45, 82, 53, 57, 37, 55, 54, 91, 38, 28, 82, 78, 56, 62, 93, 63, 43, 26, 80, 28, 87, 87, 83, 96, 34, 31, 60, 33, 57, 71, 42, 73, 51, 89, 49, 38, 107, 70, 120, 27, 48, 54, 32, 46, 53, 59, 40, 38, 43, 86, 71, 44, 48, 45, 41, 31, 37, 83, 46, 44, 51, 29, 56, 36, 69, 83, 77, 111, 78, 53, 60, 31, 74, 106, 37, 57, 93, 56, 77, 44, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5971928160771638, "mean_inference_ms": 2.927174458354594, "mean_action_processing_ms": 0.6123064049275596, "mean_env_wait_ms": 0.14788926314052436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996736526489258, "StateBufferConnector_ms": 0.022696495056152344, "ViewRequirementAgentConnector_ms": 0.48734116554260254}}, "episode_reward_max": 61.20366666666664, "episode_reward_min": 13.235333333333335, "episode_reward_mean": 26.93780333333333, "episode_len_mean": 56.92, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.61666666666668, 18.339333333333336, 16.218333333333327, 18.291333333333334, 20.29933333333333, 24.137333333333316, 22.580666666666662, 27.906666666666673, 25.417333333333332, 22.58299999999999, 25.544333333333334, 13.809333333333331, 16.56566666666666, 22.819666666666663, 15.652666666666667, 22.135666666666665, 22.864666666666672, 37.218, 24.650666666666663, 45.45900000000004, 30.10233333333333, 31.004666666666676, 16.275999999999996, 19.467333333333332, 26.396333333333324, 31.8623333333333, 16.95566666666666, 14.183666666666664, 36.879, 38.87233333333336, 25.693666666666658, 28.586999999999996, 50.31733333333335, 34.20066666666666, 17.325666666666663, 13.417000000000002, 42.891000000000005, 14.463999999999992, 47.012000000000015, 43.88066666666666, 43.945333333333295, 37.81766666666665, 15.142999999999997, 16.185333333333332, 36.99166666666668, 16.723999999999997, 18.530666666666658, 29.39733333333333, 21.304999999999996, 34.45066666666664, 24.874666666666656, 37.11066666666666, 28.500666666666667, 14.934999999999992, 47.70033333333332, 34.538, 61.20366666666664, 13.235333333333335, 19.644, 24.711333333333336, 16.087666666666664, 22.450999999999993, 21.882333333333328, 27.904666666666664, 18.86366666666666, 15.094666666666662, 22.87866666666665, 37.434333333333306, 40.506000000000014, 23.213666666666658, 19.20766666666667, 20.49299999999999, 17.197666666666663, 15.050999999999995, 17.34333333333333, 44.12566666666669, 24.282333333333334, 17.483333333333334, 30.498666666666658, 14.368333333333329, 23.369666666666667, 18.508, 32.79466666666666, 33.98666666666667, 37.766, 43.42433333333334, 43.589000000000006, 32.884000000000015, 22.208, 13.458333333333332, 42.169666666666686, 57.796333333333344, 18.18666666666666, 28.270333333333333, 39.36066666666666, 22.60266666666666, 30.366666666666653, 18.732333333333322, 19.976999999999993, 16.118999999999993], "episode_lengths": [66, 41, 32, 41, 41, 73, 48, 52, 59, 49, 62, 37, 33, 49, 38, 46, 49, 67, 45, 82, 53, 57, 37, 55, 54, 91, 38, 28, 82, 78, 56, 62, 93, 63, 43, 26, 80, 28, 87, 87, 83, 96, 34, 31, 60, 33, 57, 71, 42, 73, 51, 89, 49, 38, 107, 70, 120, 27, 48, 54, 32, 46, 53, 59, 40, 38, 43, 86, 71, 44, 48, 45, 41, 31, 37, 83, 46, 44, 51, 29, 56, 36, 69, 83, 77, 111, 78, 53, 60, 31, 74, 106, 37, 57, 93, 56, 77, 44, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5971928160771638, "mean_inference_ms": 2.927174458354594, "mean_action_processing_ms": 0.6123064049275596, "mean_env_wait_ms": 0.14788926314052436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996736526489258, "StateBufferConnector_ms": 0.022696495056152344, "ViewRequirementAgentConnector_ms": 0.48734116554260254}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.47373094686344, "num_env_steps_trained_throughput_per_sec": 426.47373094686344, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9331.393, "sample_time_ms": 3149.655, "load_time_ms": 0.864, "load_throughput": 4628069.846, "learn_time_ms": 6146.746, "learn_throughput": 650.751, "synch_weights_time_ms": 31.691}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3647, "training_iteration": 44, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-13-02", "timestamp": 1701997982, "time_this_iter_s": 9.405226945877075, "time_total_s": 1639.2435104846954, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1639.2435104846954, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 79.96923076923078, "ram_util_percent": 86.37692307692306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1787051890088662e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 5.863563060760498, "policy_loss": -0.009984145872294903, "vf_loss": 5.873547077178955, "vf_explained_var": 0.4967075288295746, "kl": 0.002079162746667862, "entropy": 0.10540991276502609, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 57.796333333333344, "episode_reward_min": 12.907000000000004, "episode_reward_mean": 26.830556666666666, "episode_len_mean": 56.18, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.49299999999999, 17.197666666666663, 15.050999999999995, 17.34333333333333, 44.12566666666669, 24.282333333333334, 17.483333333333334, 30.498666666666658, 14.368333333333329, 23.369666666666667, 18.508, 32.79466666666666, 33.98666666666667, 37.766, 43.42433333333334, 43.589000000000006, 32.884000000000015, 22.208, 13.458333333333332, 42.169666666666686, 57.796333333333344, 18.18666666666666, 28.270333333333333, 39.36066666666666, 22.60266666666666, 30.366666666666653, 18.732333333333322, 19.976999999999993, 16.118999999999993, 25.60566666666665, 24.779999999999994, 40.57199999999996, 13.389000000000003, 15.893999999999995, 45.11266666666671, 14.148333333333328, 16.670666666666662, 16.799999999999994, 36.06300000000002, 14.983999999999996, 34.84400000000002, 54.697333333333304, 21.06299999999999, 21.71033333333333, 29.733999999999995, 15.951666666666663, 13.693333333333328, 24.58633333333332, 20.10333333333333, 44.91900000000003, 22.932999999999993, 16.258333333333326, 35.02166666666666, 17.33666666666667, 26.512999999999998, 21.032, 27.341999999999988, 41.59900000000003, 15.52866666666666, 21.18766666666666, 55.56933333333334, 18.29033333333333, 24.203666666666663, 16.70366666666666, 13.299999999999997, 19.952666666666673, 39.96366666666667, 17.852333333333323, 23.603666666666655, 51.22366666666666, 24.988333333333326, 23.80766666666667, 34.759333333333295, 12.907000000000004, 21.256666666666657, 41.25233333333337, 36.16866666666664, 19.710333333333327, 43.03466666666665, 26.92266666666665, 30.639999999999997, 54.45999999999997, 15.154333333333327, 29.03433333333334, 19.542333333333332, 16.57, 25.171333333333322, 48.42733333333331, 39.36866666666668, 18.092333333333332, 21.186999999999987, 29.896999999999995, 23.79566666666666, 20.762666666666654, 19.950333333333326, 18.150999999999986, 32.64966666666666, 33.665333333333336, 20.80599999999999, 13.772666666666659], "episode_lengths": [45, 41, 31, 37, 83, 46, 44, 51, 29, 56, 36, 69, 83, 77, 111, 78, 53, 60, 31, 74, 106, 37, 57, 93, 56, 77, 44, 38, 48, 53, 57, 87, 26, 34, 85, 35, 38, 44, 90, 31, 73, 93, 55, 40, 53, 35, 28, 47, 43, 90, 58, 37, 68, 35, 52, 48, 49, 74, 42, 36, 81, 38, 40, 36, 28, 43, 72, 46, 64, 102, 64, 46, 93, 25, 57, 74, 96, 42, 81, 69, 64, 77, 31, 46, 38, 30, 59, 93, 67, 38, 60, 64, 44, 59, 47, 49, 84, 57, 51, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6039114237090337, "mean_inference_ms": 2.94353190350429, "mean_action_processing_ms": 0.6153083587918357, "mean_env_wait_ms": 0.1485481542643711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025289297103881836, "StateBufferConnector_ms": 0.04498100280761719, "ViewRequirementAgentConnector_ms": 0.6070904731750488}}, "episode_reward_max": 57.796333333333344, "episode_reward_min": 12.907000000000004, "episode_reward_mean": 26.830556666666666, "episode_len_mean": 56.18, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.49299999999999, 17.197666666666663, 15.050999999999995, 17.34333333333333, 44.12566666666669, 24.282333333333334, 17.483333333333334, 30.498666666666658, 14.368333333333329, 23.369666666666667, 18.508, 32.79466666666666, 33.98666666666667, 37.766, 43.42433333333334, 43.589000000000006, 32.884000000000015, 22.208, 13.458333333333332, 42.169666666666686, 57.796333333333344, 18.18666666666666, 28.270333333333333, 39.36066666666666, 22.60266666666666, 30.366666666666653, 18.732333333333322, 19.976999999999993, 16.118999999999993, 25.60566666666665, 24.779999999999994, 40.57199999999996, 13.389000000000003, 15.893999999999995, 45.11266666666671, 14.148333333333328, 16.670666666666662, 16.799999999999994, 36.06300000000002, 14.983999999999996, 34.84400000000002, 54.697333333333304, 21.06299999999999, 21.71033333333333, 29.733999999999995, 15.951666666666663, 13.693333333333328, 24.58633333333332, 20.10333333333333, 44.91900000000003, 22.932999999999993, 16.258333333333326, 35.02166666666666, 17.33666666666667, 26.512999999999998, 21.032, 27.341999999999988, 41.59900000000003, 15.52866666666666, 21.18766666666666, 55.56933333333334, 18.29033333333333, 24.203666666666663, 16.70366666666666, 13.299999999999997, 19.952666666666673, 39.96366666666667, 17.852333333333323, 23.603666666666655, 51.22366666666666, 24.988333333333326, 23.80766666666667, 34.759333333333295, 12.907000000000004, 21.256666666666657, 41.25233333333337, 36.16866666666664, 19.710333333333327, 43.03466666666665, 26.92266666666665, 30.639999999999997, 54.45999999999997, 15.154333333333327, 29.03433333333334, 19.542333333333332, 16.57, 25.171333333333322, 48.42733333333331, 39.36866666666668, 18.092333333333332, 21.186999999999987, 29.896999999999995, 23.79566666666666, 20.762666666666654, 19.950333333333326, 18.150999999999986, 32.64966666666666, 33.665333333333336, 20.80599999999999, 13.772666666666659], "episode_lengths": [45, 41, 31, 37, 83, 46, 44, 51, 29, 56, 36, 69, 83, 77, 111, 78, 53, 60, 31, 74, 106, 37, 57, 93, 56, 77, 44, 38, 48, 53, 57, 87, 26, 34, 85, 35, 38, 44, 90, 31, 73, 93, 55, 40, 53, 35, 28, 47, 43, 90, 58, 37, 68, 35, 52, 48, 49, 74, 42, 36, 81, 38, 40, 36, 28, 43, 72, 46, 64, 102, 64, 46, 93, 25, 57, 74, 96, 42, 81, 69, 64, 77, 31, 46, 38, 30, 59, 93, 67, 38, 60, 64, 44, 59, 47, 49, 84, 57, 51, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6039114237090337, "mean_inference_ms": 2.94353190350429, "mean_action_processing_ms": 0.6153083587918357, "mean_env_wait_ms": 0.1485481542643711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025289297103881836, "StateBufferConnector_ms": 0.04498100280761719, "ViewRequirementAgentConnector_ms": 0.6070904731750488}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.5851501929788, "num_env_steps_trained_throughput_per_sec": 395.5851501929788, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 9583.169, "sample_time_ms": 3333.689, "load_time_ms": 0.947, "load_throughput": 4225998.992, "learn_time_ms": 6217.321, "learn_throughput": 643.364, "synch_weights_time_ms": 28.656}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3718, "training_iteration": 45, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-13-12", "timestamp": 1701997992, "time_this_iter_s": 10.135775566101074, "time_total_s": 1649.3792860507965, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1649.3792860507965, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 74.40714285714286, "ram_util_percent": 86.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.893525945044331e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 5.868826866149902, "policy_loss": -0.00322680058889091, "vf_loss": 5.872053623199463, "vf_explained_var": 0.5849117040634155, "kl": 0.0006556060980074108, "entropy": 0.08440826088190079, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 78.84700000000007, "episode_reward_min": 12.907000000000004, "episode_reward_mean": 27.90297666666666, "episode_len_mean": 58.91, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.852333333333323, 23.603666666666655, 51.22366666666666, 24.988333333333326, 23.80766666666667, 34.759333333333295, 12.907000000000004, 21.256666666666657, 41.25233333333337, 36.16866666666664, 19.710333333333327, 43.03466666666665, 26.92266666666665, 30.639999999999997, 54.45999999999997, 15.154333333333327, 29.03433333333334, 19.542333333333332, 16.57, 25.171333333333322, 48.42733333333331, 39.36866666666668, 18.092333333333332, 21.186999999999987, 29.896999999999995, 23.79566666666666, 20.762666666666654, 19.950333333333326, 18.150999999999986, 32.64966666666666, 33.665333333333336, 20.80599999999999, 13.772666666666659, 15.487999999999992, 16.372333333333327, 31.40933333333331, 29.34366666666664, 47.49300000000004, 34.63033333333331, 23.447666666666663, 33.48333333333333, 33.10033333333333, 29.79200000000001, 23.17966666666666, 28.02333333333332, 30.604666666666652, 27.685666666666663, 31.44166666666665, 18.087333333333333, 50.887000000000015, 23.63033333333333, 21.03133333333333, 39.839666666666645, 20.09099999999999, 59.193333333333335, 23.18533333333332, 17.285666666666668, 14.001666666666667, 19.416666666666657, 28.808666666666657, 29.771999999999984, 78.84700000000007, 15.494666666666664, 70.64066666666668, 21.989666666666665, 35.2713333333333, 20.145666666666653, 37.95633333333333, 16.507666666666662, 20.603666666666648, 21.55233333333333, 29.239, 25.615666666666662, 26.550999999999977, 34.94233333333333, 22.331999999999987, 31.205333333333332, 25.204333333333324, 35.783, 16.949333333333332, 20.897999999999993, 32.84066666666666, 31.235000000000014, 14.247666666666664, 17.331, 38.65199999999999, 18.177666666666664, 34.59933333333332, 22.602999999999987, 23.516666666666666, 18.206333333333326, 28.918666666666667, 24.52, 37.97366666666667, 20.410999999999998, 20.952333333333314, 24.419666666666668, 19.039666666666662, 22.05233333333332, 23.56166666666666], "episode_lengths": [46, 64, 102, 64, 46, 93, 25, 57, 74, 96, 42, 81, 69, 64, 77, 31, 46, 38, 30, 59, 93, 67, 38, 60, 64, 44, 59, 47, 49, 84, 57, 51, 36, 37, 36, 65, 78, 74, 57, 46, 57, 68, 52, 44, 57, 49, 48, 50, 33, 113, 54, 41, 94, 42, 107, 57, 39, 40, 63, 53, 50, 130, 36, 129, 46, 65, 53, 86, 36, 57, 42, 63, 58, 66, 69, 43, 91, 68, 74, 37, 41, 85, 70, 27, 37, 85, 43, 71, 64, 62, 38, 53, 65, 80, 40, 58, 41, 34, 49, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6054350004272828, "mean_inference_ms": 2.9440689186154247, "mean_action_processing_ms": 0.6157053474346239, "mean_env_wait_ms": 0.14881021765291336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012196540832519531, "StateBufferConnector_ms": 0.037427663803100586, "ViewRequirementAgentConnector_ms": 0.519594669342041}}, "episode_reward_max": 78.84700000000007, "episode_reward_min": 12.907000000000004, "episode_reward_mean": 27.90297666666666, "episode_len_mean": 58.91, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.852333333333323, 23.603666666666655, 51.22366666666666, 24.988333333333326, 23.80766666666667, 34.759333333333295, 12.907000000000004, 21.256666666666657, 41.25233333333337, 36.16866666666664, 19.710333333333327, 43.03466666666665, 26.92266666666665, 30.639999999999997, 54.45999999999997, 15.154333333333327, 29.03433333333334, 19.542333333333332, 16.57, 25.171333333333322, 48.42733333333331, 39.36866666666668, 18.092333333333332, 21.186999999999987, 29.896999999999995, 23.79566666666666, 20.762666666666654, 19.950333333333326, 18.150999999999986, 32.64966666666666, 33.665333333333336, 20.80599999999999, 13.772666666666659, 15.487999999999992, 16.372333333333327, 31.40933333333331, 29.34366666666664, 47.49300000000004, 34.63033333333331, 23.447666666666663, 33.48333333333333, 33.10033333333333, 29.79200000000001, 23.17966666666666, 28.02333333333332, 30.604666666666652, 27.685666666666663, 31.44166666666665, 18.087333333333333, 50.887000000000015, 23.63033333333333, 21.03133333333333, 39.839666666666645, 20.09099999999999, 59.193333333333335, 23.18533333333332, 17.285666666666668, 14.001666666666667, 19.416666666666657, 28.808666666666657, 29.771999999999984, 78.84700000000007, 15.494666666666664, 70.64066666666668, 21.989666666666665, 35.2713333333333, 20.145666666666653, 37.95633333333333, 16.507666666666662, 20.603666666666648, 21.55233333333333, 29.239, 25.615666666666662, 26.550999999999977, 34.94233333333333, 22.331999999999987, 31.205333333333332, 25.204333333333324, 35.783, 16.949333333333332, 20.897999999999993, 32.84066666666666, 31.235000000000014, 14.247666666666664, 17.331, 38.65199999999999, 18.177666666666664, 34.59933333333332, 22.602999999999987, 23.516666666666666, 18.206333333333326, 28.918666666666667, 24.52, 37.97366666666667, 20.410999999999998, 20.952333333333314, 24.419666666666668, 19.039666666666662, 22.05233333333332, 23.56166666666666], "episode_lengths": [46, 64, 102, 64, 46, 93, 25, 57, 74, 96, 42, 81, 69, 64, 77, 31, 46, 38, 30, 59, 93, 67, 38, 60, 64, 44, 59, 47, 49, 84, 57, 51, 36, 37, 36, 65, 78, 74, 57, 46, 57, 68, 52, 44, 57, 49, 48, 50, 33, 113, 54, 41, 94, 42, 107, 57, 39, 40, 63, 53, 50, 130, 36, 129, 46, 65, 53, 86, 36, 57, 42, 63, 58, 66, 69, 43, 91, 68, 74, 37, 41, 85, 70, 27, 37, 85, 43, 71, 64, 62, 38, 53, 65, 80, 40, 58, 41, 34, 49, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6054350004272828, "mean_inference_ms": 2.9440689186154247, "mean_action_processing_ms": 0.6157053474346239, "mean_env_wait_ms": 0.14881021765291336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012196540832519531, "StateBufferConnector_ms": 0.037427663803100586, "ViewRequirementAgentConnector_ms": 0.519594669342041}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.8814088380322, "num_env_steps_trained_throughput_per_sec": 446.8814088380322, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9580.46, "sample_time_ms": 3301.344, "load_time_ms": 0.948, "load_throughput": 4220364.752, "learn_time_ms": 6246.737, "learn_throughput": 640.334, "synch_weights_time_ms": 28.49}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3785, "training_iteration": 46, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-13-22", "timestamp": 1701998002, "time_this_iter_s": 8.983961820602417, "time_total_s": 1658.363247871399, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1658.363247871399, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 79.59166666666665, "ram_util_percent": 86.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9467629725221656e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 6.0359721183776855, "policy_loss": -0.0069724260829389095, "vf_loss": 6.042943954467773, "vf_explained_var": 0.5460231900215149, "kl": 0.004047862254083157, "entropy": 0.09077746421098709, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 61.32566666666668, "episode_reward_min": 13.932333333333332, "episode_reward_mean": 27.27863, "episode_len_mean": 57.36, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.603666666666648, 21.55233333333333, 29.239, 25.615666666666662, 26.550999999999977, 34.94233333333333, 22.331999999999987, 31.205333333333332, 25.204333333333324, 35.783, 16.949333333333332, 20.897999999999993, 32.84066666666666, 31.235000000000014, 14.247666666666664, 17.331, 38.65199999999999, 18.177666666666664, 34.59933333333332, 22.602999999999987, 23.516666666666666, 18.206333333333326, 28.918666666666667, 24.52, 37.97366666666667, 20.410999999999998, 20.952333333333314, 24.419666666666668, 19.039666666666662, 22.05233333333332, 23.56166666666666, 34.47333333333333, 15.750333333333328, 26.793333333333322, 54.438333333333354, 18.71566666666666, 21.098333333333326, 39.76533333333334, 33.04466666666667, 30.950000000000003, 50.08166666666669, 18.990999999999993, 18.39866666666667, 26.62133333333332, 16.806333333333328, 24.771999999999995, 43.42733333333333, 19.677666666666664, 23.736333333333327, 20.29033333333333, 20.696333333333328, 31.605, 15.590333333333326, 20.73033333333332, 18.97799999999999, 31.627, 15.708666666666662, 61.32566666666668, 47.98099999999996, 33.67033333333334, 27.676333333333318, 20.799666666666663, 32.24133333333332, 15.490666666666659, 50.688333333333276, 40.328666666666656, 14.551666666666668, 34.629999999999995, 18.655333333333324, 19.864333333333327, 21.906999999999996, 16.691666666666663, 17.533666666666665, 48.52233333333333, 19.41366666666666, 16.055666666666664, 19.301999999999992, 48.476999999999975, 25.561999999999998, 48.86200000000001, 47.78666666666666, 37.308000000000014, 30.251333333333346, 25.491999999999983, 21.903999999999993, 15.224666666666666, 44.89966666666668, 19.724999999999994, 25.490000000000002, 15.675333333333334, 16.107, 41.88733333333332, 16.175666666666665, 34.661333333333324, 21.157666666666664, 37.539999999999985, 13.932333333333332, 24.09633333333332, 33.009666666666654, 28.406666666666666], "episode_lengths": [57, 42, 63, 58, 66, 69, 43, 91, 68, 74, 37, 41, 85, 70, 27, 37, 85, 43, 71, 64, 62, 38, 53, 65, 80, 40, 58, 41, 34, 49, 42, 68, 30, 67, 120, 38, 41, 87, 55, 57, 107, 41, 35, 63, 40, 51, 73, 36, 49, 44, 58, 70, 33, 50, 39, 60, 33, 108, 122, 61, 68, 46, 61, 37, 108, 75, 27, 77, 37, 44, 49, 32, 33, 98, 41, 34, 35, 85, 47, 101, 85, 59, 67, 67, 43, 29, 84, 40, 45, 33, 34, 69, 38, 81, 57, 78, 30, 44, 81, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6040811128188366, "mean_inference_ms": 2.944308171781478, "mean_action_processing_ms": 0.615221554842797, "mean_env_wait_ms": 0.14862215983969268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025695323944091797, "StateBufferConnector_ms": 0.014377117156982422, "ViewRequirementAgentConnector_ms": 0.48834872245788574}}, "episode_reward_max": 61.32566666666668, "episode_reward_min": 13.932333333333332, "episode_reward_mean": 27.27863, "episode_len_mean": 57.36, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.603666666666648, 21.55233333333333, 29.239, 25.615666666666662, 26.550999999999977, 34.94233333333333, 22.331999999999987, 31.205333333333332, 25.204333333333324, 35.783, 16.949333333333332, 20.897999999999993, 32.84066666666666, 31.235000000000014, 14.247666666666664, 17.331, 38.65199999999999, 18.177666666666664, 34.59933333333332, 22.602999999999987, 23.516666666666666, 18.206333333333326, 28.918666666666667, 24.52, 37.97366666666667, 20.410999999999998, 20.952333333333314, 24.419666666666668, 19.039666666666662, 22.05233333333332, 23.56166666666666, 34.47333333333333, 15.750333333333328, 26.793333333333322, 54.438333333333354, 18.71566666666666, 21.098333333333326, 39.76533333333334, 33.04466666666667, 30.950000000000003, 50.08166666666669, 18.990999999999993, 18.39866666666667, 26.62133333333332, 16.806333333333328, 24.771999999999995, 43.42733333333333, 19.677666666666664, 23.736333333333327, 20.29033333333333, 20.696333333333328, 31.605, 15.590333333333326, 20.73033333333332, 18.97799999999999, 31.627, 15.708666666666662, 61.32566666666668, 47.98099999999996, 33.67033333333334, 27.676333333333318, 20.799666666666663, 32.24133333333332, 15.490666666666659, 50.688333333333276, 40.328666666666656, 14.551666666666668, 34.629999999999995, 18.655333333333324, 19.864333333333327, 21.906999999999996, 16.691666666666663, 17.533666666666665, 48.52233333333333, 19.41366666666666, 16.055666666666664, 19.301999999999992, 48.476999999999975, 25.561999999999998, 48.86200000000001, 47.78666666666666, 37.308000000000014, 30.251333333333346, 25.491999999999983, 21.903999999999993, 15.224666666666666, 44.89966666666668, 19.724999999999994, 25.490000000000002, 15.675333333333334, 16.107, 41.88733333333332, 16.175666666666665, 34.661333333333324, 21.157666666666664, 37.539999999999985, 13.932333333333332, 24.09633333333332, 33.009666666666654, 28.406666666666666], "episode_lengths": [57, 42, 63, 58, 66, 69, 43, 91, 68, 74, 37, 41, 85, 70, 27, 37, 85, 43, 71, 64, 62, 38, 53, 65, 80, 40, 58, 41, 34, 49, 42, 68, 30, 67, 120, 38, 41, 87, 55, 57, 107, 41, 35, 63, 40, 51, 73, 36, 49, 44, 58, 70, 33, 50, 39, 60, 33, 108, 122, 61, 68, 46, 61, 37, 108, 75, 27, 77, 37, 44, 49, 32, 33, 98, 41, 34, 35, 85, 47, 101, 85, 59, 67, 67, 43, 29, 84, 40, 45, 33, 34, 69, 38, 81, 57, 78, 30, 44, 81, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6040811128188366, "mean_inference_ms": 2.944308171781478, "mean_action_processing_ms": 0.615221554842797, "mean_env_wait_ms": 0.14862215983969268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025695323944091797, "StateBufferConnector_ms": 0.014377117156982422, "ViewRequirementAgentConnector_ms": 0.48834872245788574}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.2739053456726, "num_env_steps_trained_throughput_per_sec": 399.2739053456726, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 9552.587, "sample_time_ms": 3293.594, "load_time_ms": 0.953, "load_throughput": 4198712.648, "learn_time_ms": 6226.795, "learn_throughput": 642.385, "synch_weights_time_ms": 28.298}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3854, "training_iteration": 47, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-13-32", "timestamp": 1701998012, "time_this_iter_s": 10.053257465362549, "time_total_s": 1668.4165053367615, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1668.4165053367615, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 78.35000000000001, "ram_util_percent": 86.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4733814862610828e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 5.412686824798584, "policy_loss": -0.00555173447355628, "vf_loss": 5.418239593505859, "vf_explained_var": 0.6004917025566101, "kl": 0.0035005223471671343, "entropy": 0.10020079463720322, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 62.51333333333333, "episode_reward_min": 8.936, "episode_reward_mean": 25.837419999999998, "episode_len_mean": 56.28, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.864333333333327, 21.906999999999996, 16.691666666666663, 17.533666666666665, 48.52233333333333, 19.41366666666666, 16.055666666666664, 19.301999999999992, 48.476999999999975, 25.561999999999998, 48.86200000000001, 47.78666666666666, 37.308000000000014, 30.251333333333346, 25.491999999999983, 21.903999999999993, 15.224666666666666, 44.89966666666668, 19.724999999999994, 25.490000000000002, 15.675333333333334, 16.107, 41.88733333333332, 16.175666666666665, 34.661333333333324, 21.157666666666664, 37.539999999999985, 13.932333333333332, 24.09633333333332, 33.009666666666654, 28.406666666666666, 52.246999999999986, 12.078999999999999, 16.306666666666665, 14.981333333333335, 31.512999999999987, 28.999666666666652, 34.684666666666665, 24.023999999999997, 14.884333333333329, 55.51466666666673, 14.015999999999996, 36.246333333333325, 14.483333333333327, 17.744333333333326, 13.950333333333331, 20.67766666666667, 18.728666666666662, 8.936, 12.994666666666662, 15.564333333333332, 23.74433333333332, 19.369, 57.153333333333336, 29.65066666666667, 19.652999999999995, 17.785666666666657, 45.75099999999998, 13.771999999999995, 17.15666666666666, 27.380333333333322, 18.380333333333326, 30.392333333333326, 26.37700000000001, 17.480666666666664, 14.260666666666665, 18.488666666666663, 12.541999999999998, 62.51333333333333, 33.379333333333314, 17.086, 21.70866666666666, 24.87166666666666, 20.643999999999995, 16.432999999999996, 13.978999999999992, 33.20733333333334, 27.86000000000001, 20.900666666666655, 29.14866666666665, 17.693666666666658, 24.260999999999996, 28.045666666666666, 18.011999999999993, 27.345999999999997, 25.354999999999983, 27.126333333333314, 20.646333333333327, 45.88533333333333, 25.680333333333326, 35.10566666666667, 18.49233333333333, 27.02699999999998, 49.277999999999956, 26.608333333333327, 38.37933333333329, 28.770333333333333, 15.942333333333327, 30.447666666666645, 11.072], "episode_lengths": [44, 49, 32, 33, 98, 41, 34, 35, 85, 47, 101, 85, 59, 67, 67, 43, 29, 84, 40, 45, 33, 34, 69, 38, 81, 57, 78, 30, 44, 81, 48, 99, 30, 33, 28, 68, 76, 66, 53, 30, 101, 33, 77, 33, 37, 29, 44, 40, 22, 30, 36, 77, 48, 93, 65, 53, 49, 101, 34, 39, 71, 49, 62, 48, 50, 30, 37, 38, 117, 91, 36, 46, 52, 59, 39, 39, 58, 63, 58, 79, 37, 48, 52, 41, 62, 61, 88, 43, 110, 74, 68, 40, 63, 125, 62, 101, 60, 34, 78, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6041343108339168, "mean_inference_ms": 2.9481875769589023, "mean_action_processing_ms": 0.6162091821103063, "mean_env_wait_ms": 0.14865486222544422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02118372917175293, "StateBufferConnector_ms": 0.0174257755279541, "ViewRequirementAgentConnector_ms": 0.5230274200439453}}, "episode_reward_max": 62.51333333333333, "episode_reward_min": 8.936, "episode_reward_mean": 25.837419999999998, "episode_len_mean": 56.28, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.864333333333327, 21.906999999999996, 16.691666666666663, 17.533666666666665, 48.52233333333333, 19.41366666666666, 16.055666666666664, 19.301999999999992, 48.476999999999975, 25.561999999999998, 48.86200000000001, 47.78666666666666, 37.308000000000014, 30.251333333333346, 25.491999999999983, 21.903999999999993, 15.224666666666666, 44.89966666666668, 19.724999999999994, 25.490000000000002, 15.675333333333334, 16.107, 41.88733333333332, 16.175666666666665, 34.661333333333324, 21.157666666666664, 37.539999999999985, 13.932333333333332, 24.09633333333332, 33.009666666666654, 28.406666666666666, 52.246999999999986, 12.078999999999999, 16.306666666666665, 14.981333333333335, 31.512999999999987, 28.999666666666652, 34.684666666666665, 24.023999999999997, 14.884333333333329, 55.51466666666673, 14.015999999999996, 36.246333333333325, 14.483333333333327, 17.744333333333326, 13.950333333333331, 20.67766666666667, 18.728666666666662, 8.936, 12.994666666666662, 15.564333333333332, 23.74433333333332, 19.369, 57.153333333333336, 29.65066666666667, 19.652999999999995, 17.785666666666657, 45.75099999999998, 13.771999999999995, 17.15666666666666, 27.380333333333322, 18.380333333333326, 30.392333333333326, 26.37700000000001, 17.480666666666664, 14.260666666666665, 18.488666666666663, 12.541999999999998, 62.51333333333333, 33.379333333333314, 17.086, 21.70866666666666, 24.87166666666666, 20.643999999999995, 16.432999999999996, 13.978999999999992, 33.20733333333334, 27.86000000000001, 20.900666666666655, 29.14866666666665, 17.693666666666658, 24.260999999999996, 28.045666666666666, 18.011999999999993, 27.345999999999997, 25.354999999999983, 27.126333333333314, 20.646333333333327, 45.88533333333333, 25.680333333333326, 35.10566666666667, 18.49233333333333, 27.02699999999998, 49.277999999999956, 26.608333333333327, 38.37933333333329, 28.770333333333333, 15.942333333333327, 30.447666666666645, 11.072], "episode_lengths": [44, 49, 32, 33, 98, 41, 34, 35, 85, 47, 101, 85, 59, 67, 67, 43, 29, 84, 40, 45, 33, 34, 69, 38, 81, 57, 78, 30, 44, 81, 48, 99, 30, 33, 28, 68, 76, 66, 53, 30, 101, 33, 77, 33, 37, 29, 44, 40, 22, 30, 36, 77, 48, 93, 65, 53, 49, 101, 34, 39, 71, 49, 62, 48, 50, 30, 37, 38, 117, 91, 36, 46, 52, 59, 39, 39, 58, 63, 58, 79, 37, 48, 52, 41, 62, 61, 88, 43, 110, 74, 68, 40, 63, 125, 62, 101, 60, 34, 78, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6041343108339168, "mean_inference_ms": 2.9481875769589023, "mean_action_processing_ms": 0.6162091821103063, "mean_env_wait_ms": 0.14865486222544422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02118372917175293, "StateBufferConnector_ms": 0.0174257755279541, "ViewRequirementAgentConnector_ms": 0.5230274200439453}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.01963331503856, "num_env_steps_trained_throughput_per_sec": 411.01963331503856, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9491.83, "sample_time_ms": 3204.845, "load_time_ms": 0.872, "load_throughput": 4585692.888, "learn_time_ms": 6254.907, "learn_throughput": 639.498, "synch_weights_time_ms": 28.231}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 3923, "training_iteration": 48, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-13-42", "timestamp": 1701998022, "time_this_iter_s": 9.752886772155762, "time_total_s": 1678.1693921089172, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1678.1693921089172, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 74.43846153846154, "ram_util_percent": 86.36923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.366907431305414e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 6.124413967132568, "policy_loss": -0.008652912452816963, "vf_loss": 6.133066654205322, "vf_explained_var": 0.5795248746871948, "kl": 0.004187612794339657, "entropy": 0.10687505453824997, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 59.13166666666663, "episode_reward_min": 10.277999999999997, "episode_reward_mean": 26.941416666666658, "episode_len_mean": 58.91, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.70866666666666, 24.87166666666666, 20.643999999999995, 16.432999999999996, 13.978999999999992, 33.20733333333334, 27.86000000000001, 20.900666666666655, 29.14866666666665, 17.693666666666658, 24.260999999999996, 28.045666666666666, 18.011999999999993, 27.345999999999997, 25.354999999999983, 27.126333333333314, 20.646333333333327, 45.88533333333333, 25.680333333333326, 35.10566666666667, 18.49233333333333, 27.02699999999998, 49.277999999999956, 26.608333333333327, 38.37933333333329, 28.770333333333333, 15.942333333333327, 30.447666666666645, 11.072, 36.476333333333315, 50.78566666666667, 18.604333333333326, 24.459666666666656, 44.509666666666675, 24.681999999999988, 32.36999999999999, 23.477333333333323, 28.491666666666664, 59.13166666666663, 18.311666666666657, 20.44466666666666, 33.963333333333345, 37.60533333333332, 20.26433333333333, 39.87833333333335, 13.912666666666667, 17.688333333333325, 13.55033333333333, 12.368666666666666, 17.885333333333325, 28.16866666666666, 26.73266666666666, 24.61066666666667, 15.200666666666663, 27.775666666666677, 14.469666666666662, 17.779333333333334, 23.043666666666656, 26.570333333333327, 44.5443333333333, 20.961333333333332, 22.227666666666643, 17.357666666666667, 15.33133333333333, 35.39533333333334, 24.167333333333325, 20.596666666666664, 36.01233333333334, 42.559999999999995, 16.276333333333326, 22.600666666666672, 48.75733333333335, 20.479333333333326, 38.988666666666674, 32.69666666666666, 34.744, 40.49766666666667, 10.277999999999997, 41.23233333333334, 17.348333333333326, 13.573333333333332, 36.83633333333334, 16.453999999999994, 16.82833333333333, 43.37000000000001, 27.462000000000014, 13.703999999999994, 38.20700000000001, 15.926666666666666, 16.50733333333333, 26.820666666666654, 26.023333333333333, 39.64066666666663, 24.56833333333334, 37.587, 22.95, 39.858333333333356, 31.311333333333316, 13.112333333333332, 47.207], "episode_lengths": [46, 52, 59, 39, 39, 58, 63, 58, 79, 37, 48, 52, 41, 62, 61, 88, 43, 110, 74, 68, 40, 63, 125, 62, 101, 60, 34, 78, 24, 68, 100, 47, 56, 86, 48, 55, 47, 54, 141, 40, 46, 69, 81, 55, 89, 27, 36, 29, 29, 39, 72, 61, 43, 32, 54, 34, 42, 50, 50, 92, 48, 66, 35, 34, 66, 43, 46, 59, 80, 44, 49, 103, 51, 81, 73, 73, 90, 23, 86, 39, 29, 87, 32, 42, 93, 61, 30, 79, 41, 43, 90, 49, 69, 54, 68, 47, 67, 74, 28, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.602858747266594, "mean_inference_ms": 2.9474642763646806, "mean_action_processing_ms": 0.615371708727562, "mean_env_wait_ms": 0.1488831057906124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01617908477783203, "StateBufferConnector_ms": 0.019449472427368164, "ViewRequirementAgentConnector_ms": 0.4782552719116211}}, "episode_reward_max": 59.13166666666663, "episode_reward_min": 10.277999999999997, "episode_reward_mean": 26.941416666666658, "episode_len_mean": 58.91, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.70866666666666, 24.87166666666666, 20.643999999999995, 16.432999999999996, 13.978999999999992, 33.20733333333334, 27.86000000000001, 20.900666666666655, 29.14866666666665, 17.693666666666658, 24.260999999999996, 28.045666666666666, 18.011999999999993, 27.345999999999997, 25.354999999999983, 27.126333333333314, 20.646333333333327, 45.88533333333333, 25.680333333333326, 35.10566666666667, 18.49233333333333, 27.02699999999998, 49.277999999999956, 26.608333333333327, 38.37933333333329, 28.770333333333333, 15.942333333333327, 30.447666666666645, 11.072, 36.476333333333315, 50.78566666666667, 18.604333333333326, 24.459666666666656, 44.509666666666675, 24.681999999999988, 32.36999999999999, 23.477333333333323, 28.491666666666664, 59.13166666666663, 18.311666666666657, 20.44466666666666, 33.963333333333345, 37.60533333333332, 20.26433333333333, 39.87833333333335, 13.912666666666667, 17.688333333333325, 13.55033333333333, 12.368666666666666, 17.885333333333325, 28.16866666666666, 26.73266666666666, 24.61066666666667, 15.200666666666663, 27.775666666666677, 14.469666666666662, 17.779333333333334, 23.043666666666656, 26.570333333333327, 44.5443333333333, 20.961333333333332, 22.227666666666643, 17.357666666666667, 15.33133333333333, 35.39533333333334, 24.167333333333325, 20.596666666666664, 36.01233333333334, 42.559999999999995, 16.276333333333326, 22.600666666666672, 48.75733333333335, 20.479333333333326, 38.988666666666674, 32.69666666666666, 34.744, 40.49766666666667, 10.277999999999997, 41.23233333333334, 17.348333333333326, 13.573333333333332, 36.83633333333334, 16.453999999999994, 16.82833333333333, 43.37000000000001, 27.462000000000014, 13.703999999999994, 38.20700000000001, 15.926666666666666, 16.50733333333333, 26.820666666666654, 26.023333333333333, 39.64066666666663, 24.56833333333334, 37.587, 22.95, 39.858333333333356, 31.311333333333316, 13.112333333333332, 47.207], "episode_lengths": [46, 52, 59, 39, 39, 58, 63, 58, 79, 37, 48, 52, 41, 62, 61, 88, 43, 110, 74, 68, 40, 63, 125, 62, 101, 60, 34, 78, 24, 68, 100, 47, 56, 86, 48, 55, 47, 54, 141, 40, 46, 69, 81, 55, 89, 27, 36, 29, 29, 39, 72, 61, 43, 32, 54, 34, 42, 50, 50, 92, 48, 66, 35, 34, 66, 43, 46, 59, 80, 44, 49, 103, 51, 81, 73, 73, 90, 23, 86, 39, 29, 87, 32, 42, 93, 61, 30, 79, 41, 43, 90, 49, 69, 54, 68, 47, 67, 74, 28, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.602858747266594, "mean_inference_ms": 2.9474642763646806, "mean_action_processing_ms": 0.615371708727562, "mean_env_wait_ms": 0.1488831057906124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01617908477783203, "StateBufferConnector_ms": 0.019449472427368164, "ViewRequirementAgentConnector_ms": 0.4782552719116211}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.3786160739676, "num_env_steps_trained_throughput_per_sec": 406.3786160739676, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 9536.797, "sample_time_ms": 3209.523, "load_time_ms": 0.773, "load_throughput": 5177993.272, "learn_time_ms": 6295.303, "learn_throughput": 635.394, "synch_weights_time_ms": 28.122}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 3994, "training_iteration": 49, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-13-52", "timestamp": 1701998032, "time_this_iter_s": 9.874605655670166, "time_total_s": 1688.0439977645874, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1688.0439977645874, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 73.42142857142858, "ram_util_percent": 86.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.683453715652707e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 5.684185028076172, "policy_loss": -0.0018081910675391555, "vf_loss": 5.685993671417236, "vf_explained_var": 0.5623770952224731, "kl": 0.0015742576215416193, "entropy": 0.09467607736587524, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 72.1383333333334, "episode_reward_min": 10.277999999999997, "episode_reward_mean": 27.080303333333337, "episode_len_mean": 59.4, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.559999999999995, 16.276333333333326, 22.600666666666672, 48.75733333333335, 20.479333333333326, 38.988666666666674, 32.69666666666666, 34.744, 40.49766666666667, 10.277999999999997, 41.23233333333334, 17.348333333333326, 13.573333333333332, 36.83633333333334, 16.453999999999994, 16.82833333333333, 43.37000000000001, 27.462000000000014, 13.703999999999994, 38.20700000000001, 15.926666666666666, 16.50733333333333, 26.820666666666654, 26.023333333333333, 39.64066666666663, 24.56833333333334, 37.587, 22.95, 39.858333333333356, 31.311333333333316, 13.112333333333332, 47.207, 39.63900000000002, 17.75999999999999, 33.575333333333326, 13.884999999999994, 53.66233333333332, 17.988999999999994, 22.475666666666662, 28.672999999999995, 16.23933333333333, 22.803666666666665, 30.74466666666665, 22.37066666666665, 30.177666666666653, 30.707666666666654, 72.1383333333334, 27.706666666666653, 38.583666666666666, 25.979, 31.29133333333331, 15.299333333333326, 16.706, 49.825, 19.64433333333333, 19.371999999999996, 24.498999999999988, 19.724333333333323, 16.442999999999994, 13.645999999999997, 13.843666666666664, 41.735000000000014, 34.737, 23.41866666666666, 28.861666666666665, 29.291666666666668, 19.776666666666664, 23.189666666666668, 15.207999999999998, 16.399000000000004, 20.191999999999993, 17.89833333333333, 37.85266666666666, 21.578999999999986, 18.966999999999995, 13.444999999999997, 28.016000000000002, 16.202666666666666, 14.44433333333333, 22.68433333333333, 18.43133333333333, 25.58, 35.53433333333332, 34.167, 11.811, 28.154333333333323, 17.978999999999992, 18.167666666666676, 28.608333333333327, 48.141333333333286, 23.808333333333316, 13.278999999999998, 32.83899999999999, 37.031000000000006, 25.340666666666664, 21.224333333333323, 14.443000000000001, 47.59533333333335, 24.43366666666666, 57.751000000000005], "episode_lengths": [80, 44, 49, 103, 51, 81, 73, 73, 90, 23, 86, 39, 29, 87, 32, 42, 93, 61, 30, 79, 41, 43, 90, 49, 69, 54, 68, 47, 67, 74, 28, 83, 83, 57, 79, 30, 107, 34, 45, 68, 35, 50, 69, 48, 60, 60, 145, 79, 69, 48, 80, 31, 39, 109, 47, 47, 68, 50, 34, 28, 30, 91, 72, 47, 68, 60, 37, 68, 33, 31, 43, 58, 69, 58, 42, 28, 51, 37, 32, 51, 55, 51, 103, 62, 26, 80, 43, 40, 57, 113, 61, 30, 94, 66, 56, 56, 35, 75, 48, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.601540260348442, "mean_inference_ms": 2.946214630885471, "mean_action_processing_ms": 0.6142851396810306, "mean_env_wait_ms": 0.1487861636646017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029907703399658203, "StateBufferConnector_ms": 0.0185544490814209, "ViewRequirementAgentConnector_ms": 0.46261119842529297}}, "episode_reward_max": 72.1383333333334, "episode_reward_min": 10.277999999999997, "episode_reward_mean": 27.080303333333337, "episode_len_mean": 59.4, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.559999999999995, 16.276333333333326, 22.600666666666672, 48.75733333333335, 20.479333333333326, 38.988666666666674, 32.69666666666666, 34.744, 40.49766666666667, 10.277999999999997, 41.23233333333334, 17.348333333333326, 13.573333333333332, 36.83633333333334, 16.453999999999994, 16.82833333333333, 43.37000000000001, 27.462000000000014, 13.703999999999994, 38.20700000000001, 15.926666666666666, 16.50733333333333, 26.820666666666654, 26.023333333333333, 39.64066666666663, 24.56833333333334, 37.587, 22.95, 39.858333333333356, 31.311333333333316, 13.112333333333332, 47.207, 39.63900000000002, 17.75999999999999, 33.575333333333326, 13.884999999999994, 53.66233333333332, 17.988999999999994, 22.475666666666662, 28.672999999999995, 16.23933333333333, 22.803666666666665, 30.74466666666665, 22.37066666666665, 30.177666666666653, 30.707666666666654, 72.1383333333334, 27.706666666666653, 38.583666666666666, 25.979, 31.29133333333331, 15.299333333333326, 16.706, 49.825, 19.64433333333333, 19.371999999999996, 24.498999999999988, 19.724333333333323, 16.442999999999994, 13.645999999999997, 13.843666666666664, 41.735000000000014, 34.737, 23.41866666666666, 28.861666666666665, 29.291666666666668, 19.776666666666664, 23.189666666666668, 15.207999999999998, 16.399000000000004, 20.191999999999993, 17.89833333333333, 37.85266666666666, 21.578999999999986, 18.966999999999995, 13.444999999999997, 28.016000000000002, 16.202666666666666, 14.44433333333333, 22.68433333333333, 18.43133333333333, 25.58, 35.53433333333332, 34.167, 11.811, 28.154333333333323, 17.978999999999992, 18.167666666666676, 28.608333333333327, 48.141333333333286, 23.808333333333316, 13.278999999999998, 32.83899999999999, 37.031000000000006, 25.340666666666664, 21.224333333333323, 14.443000000000001, 47.59533333333335, 24.43366666666666, 57.751000000000005], "episode_lengths": [80, 44, 49, 103, 51, 81, 73, 73, 90, 23, 86, 39, 29, 87, 32, 42, 93, 61, 30, 79, 41, 43, 90, 49, 69, 54, 68, 47, 67, 74, 28, 83, 83, 57, 79, 30, 107, 34, 45, 68, 35, 50, 69, 48, 60, 60, 145, 79, 69, 48, 80, 31, 39, 109, 47, 47, 68, 50, 34, 28, 30, 91, 72, 47, 68, 60, 37, 68, 33, 31, 43, 58, 69, 58, 42, 28, 51, 37, 32, 51, 55, 51, 103, 62, 26, 80, 43, 40, 57, 113, 61, 30, 94, 66, 56, 56, 35, 75, 48, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.601540260348442, "mean_inference_ms": 2.946214630885471, "mean_action_processing_ms": 0.6142851396810306, "mean_env_wait_ms": 0.1487861636646017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029907703399658203, "StateBufferConnector_ms": 0.0185544490814209, "ViewRequirementAgentConnector_ms": 0.46261119842529297}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.37505360518816, "num_env_steps_trained_throughput_per_sec": 409.37505360518816, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 9521.749, "sample_time_ms": 3138.247, "load_time_ms": 0.773, "load_throughput": 5177354.112, "learn_time_ms": 6351.006, "learn_throughput": 629.822, "synch_weights_time_ms": 28.631}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 4062, "training_iteration": 50, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-14-01", "timestamp": 1701998041, "time_this_iter_s": 9.812640190124512, "time_total_s": 1697.856637954712, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1697.856637954712, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 74.52142857142857, "ram_util_percent": 86.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8417268578263535e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 5.737174034118652, "policy_loss": -0.0046724737621843815, "vf_loss": 5.741846084594727, "vf_explained_var": 0.5562741756439209, "kl": 0.0009410736383870244, "entropy": 0.08197982609272003, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 62.452, "episode_reward_min": 11.811, "episode_reward_mean": 27.018939999999994, "episode_len_mean": 57.41, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.207999999999998, 16.399000000000004, 20.191999999999993, 17.89833333333333, 37.85266666666666, 21.578999999999986, 18.966999999999995, 13.444999999999997, 28.016000000000002, 16.202666666666666, 14.44433333333333, 22.68433333333333, 18.43133333333333, 25.58, 35.53433333333332, 34.167, 11.811, 28.154333333333323, 17.978999999999992, 18.167666666666676, 28.608333333333327, 48.141333333333286, 23.808333333333316, 13.278999999999998, 32.83899999999999, 37.031000000000006, 25.340666666666664, 21.224333333333323, 14.443000000000001, 47.59533333333335, 24.43366666666666, 57.751000000000005, 62.452, 23.495333333333313, 18.284999999999993, 32.730333333333334, 15.20266666666666, 44.100333333333346, 26.85566666666665, 28.397333333333318, 14.712333333333332, 22.676000000000002, 15.97533333333333, 34.178000000000004, 23.462999999999987, 28.361666666666675, 14.859666666666664, 30.92799999999999, 19.701333333333327, 27.791999999999987, 28.69466666666666, 42.10933333333332, 24.740999999999993, 33.455000000000005, 50.543666666666674, 37.226333333333336, 22.180666666666657, 30.208666666666673, 29.15066666666666, 34.204333333333345, 13.78933333333333, 16.072999999999993, 26.82133333333332, 27.854333333333322, 30.423666666666662, 44.858333333333306, 24.889666666666667, 18.345999999999993, 31.969666666666672, 25.486999999999988, 26.419999999999995, 22.952666666666666, 18.685333333333325, 19.008333333333322, 22.46833333333333, 39.98233333333333, 36.102000000000004, 22.501666666666658, 28.339666666666655, 22.368333333333325, 13.140333333333334, 19.023999999999997, 21.24666666666667, 32.837999999999994, 27.49599999999999, 16.942999999999998, 15.662999999999997, 49.41366666666664, 15.60633333333333, 50.923666666666705, 24.050999999999988, 35.86466666666665, 19.916333333333334, 30.250333333333337, 37.069666666666656, 14.955666666666664, 45.05266666666667, 41.63866666666671, 21.441333333333326, 26.12966666666666], "episode_lengths": [33, 31, 43, 58, 69, 58, 42, 28, 51, 37, 32, 51, 55, 51, 103, 62, 26, 80, 43, 40, 57, 113, 61, 30, 94, 66, 56, 56, 35, 75, 48, 126, 99, 55, 35, 54, 31, 84, 63, 67, 32, 50, 36, 77, 54, 62, 36, 67, 43, 53, 49, 110, 46, 68, 96, 72, 54, 51, 63, 65, 29, 36, 66, 66, 60, 72, 64, 43, 64, 55, 47, 51, 39, 66, 50, 112, 74, 44, 54, 56, 27, 39, 45, 51, 54, 33, 34, 80, 31, 106, 52, 83, 46, 60, 76, 34, 94, 69, 43, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6013544772325898, "mean_inference_ms": 2.943998589806163, "mean_action_processing_ms": 0.6134498018754253, "mean_env_wait_ms": 0.14886805842436432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03047323226928711, "StateBufferConnector_ms": 0.018284320831298828, "ViewRequirementAgentConnector_ms": 0.5074207782745361}}, "episode_reward_max": 62.452, "episode_reward_min": 11.811, "episode_reward_mean": 27.018939999999994, "episode_len_mean": 57.41, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.207999999999998, 16.399000000000004, 20.191999999999993, 17.89833333333333, 37.85266666666666, 21.578999999999986, 18.966999999999995, 13.444999999999997, 28.016000000000002, 16.202666666666666, 14.44433333333333, 22.68433333333333, 18.43133333333333, 25.58, 35.53433333333332, 34.167, 11.811, 28.154333333333323, 17.978999999999992, 18.167666666666676, 28.608333333333327, 48.141333333333286, 23.808333333333316, 13.278999999999998, 32.83899999999999, 37.031000000000006, 25.340666666666664, 21.224333333333323, 14.443000000000001, 47.59533333333335, 24.43366666666666, 57.751000000000005, 62.452, 23.495333333333313, 18.284999999999993, 32.730333333333334, 15.20266666666666, 44.100333333333346, 26.85566666666665, 28.397333333333318, 14.712333333333332, 22.676000000000002, 15.97533333333333, 34.178000000000004, 23.462999999999987, 28.361666666666675, 14.859666666666664, 30.92799999999999, 19.701333333333327, 27.791999999999987, 28.69466666666666, 42.10933333333332, 24.740999999999993, 33.455000000000005, 50.543666666666674, 37.226333333333336, 22.180666666666657, 30.208666666666673, 29.15066666666666, 34.204333333333345, 13.78933333333333, 16.072999999999993, 26.82133333333332, 27.854333333333322, 30.423666666666662, 44.858333333333306, 24.889666666666667, 18.345999999999993, 31.969666666666672, 25.486999999999988, 26.419999999999995, 22.952666666666666, 18.685333333333325, 19.008333333333322, 22.46833333333333, 39.98233333333333, 36.102000000000004, 22.501666666666658, 28.339666666666655, 22.368333333333325, 13.140333333333334, 19.023999999999997, 21.24666666666667, 32.837999999999994, 27.49599999999999, 16.942999999999998, 15.662999999999997, 49.41366666666664, 15.60633333333333, 50.923666666666705, 24.050999999999988, 35.86466666666665, 19.916333333333334, 30.250333333333337, 37.069666666666656, 14.955666666666664, 45.05266666666667, 41.63866666666671, 21.441333333333326, 26.12966666666666], "episode_lengths": [33, 31, 43, 58, 69, 58, 42, 28, 51, 37, 32, 51, 55, 51, 103, 62, 26, 80, 43, 40, 57, 113, 61, 30, 94, 66, 56, 56, 35, 75, 48, 126, 99, 55, 35, 54, 31, 84, 63, 67, 32, 50, 36, 77, 54, 62, 36, 67, 43, 53, 49, 110, 46, 68, 96, 72, 54, 51, 63, 65, 29, 36, 66, 66, 60, 72, 64, 43, 64, 55, 47, 51, 39, 66, 50, 112, 74, 44, 54, 56, 27, 39, 45, 51, 54, 33, 34, 80, 31, 106, 52, 83, 46, 60, 76, 34, 94, 69, 43, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6013544772325898, "mean_inference_ms": 2.943998589806163, "mean_action_processing_ms": 0.6134498018754253, "mean_env_wait_ms": 0.14886805842436432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03047323226928711, "StateBufferConnector_ms": 0.018284320831298828, "ViewRequirementAgentConnector_ms": 0.5074207782745361}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.4843552773067, "num_env_steps_trained_throughput_per_sec": 426.4843552773067, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 9544.538, "sample_time_ms": 3144.905, "load_time_ms": 0.773, "load_throughput": 5177354.112, "learn_time_ms": 6367.024, "learn_throughput": 628.237, "synch_weights_time_ms": 28.73}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 4130, "training_iteration": 51, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-14-11", "timestamp": 1701998051, "time_this_iter_s": 9.400984048843384, "time_total_s": 1707.2576220035553, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1707.2576220035553, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 75.5076923076923, "ram_util_percent": 86.33076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.208634289131767e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 5.5016560554504395, "policy_loss": -0.001513141323812306, "vf_loss": 5.503169059753418, "vf_explained_var": 0.5869866609573364, "kl": 0.0010725522879511118, "entropy": 0.09000297635793686, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 66.11733333333332, "episode_reward_min": 13.014999999999999, "episode_reward_mean": 27.282196666666664, "episode_len_mean": 58.57, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.969666666666672, 25.486999999999988, 26.419999999999995, 22.952666666666666, 18.685333333333325, 19.008333333333322, 22.46833333333333, 39.98233333333333, 36.102000000000004, 22.501666666666658, 28.339666666666655, 22.368333333333325, 13.140333333333334, 19.023999999999997, 21.24666666666667, 32.837999999999994, 27.49599999999999, 16.942999999999998, 15.662999999999997, 49.41366666666664, 15.60633333333333, 50.923666666666705, 24.050999999999988, 35.86466666666665, 19.916333333333334, 30.250333333333337, 37.069666666666656, 14.955666666666664, 45.05266666666667, 41.63866666666671, 21.441333333333326, 26.12966666666666, 32.85033333333328, 24.32066666666666, 22.919333333333334, 18.01533333333333, 17.920666666666655, 28.15333333333334, 34.73033333333334, 22.327333333333325, 18.00833333333333, 66.11733333333332, 13.014999999999999, 40.6406666666667, 40.05566666666664, 20.60566666666666, 43.68233333333331, 20.77999999999999, 19.703333333333326, 20.458999999999996, 19.655999999999988, 23.997666666666646, 19.250333333333337, 28.437999999999978, 23.87133333333333, 31.984666666666676, 33.566999999999986, 27.194999999999993, 28.044333333333327, 27.30899999999999, 39.76400000000001, 34.16900000000001, 31.575666666666645, 27.775666666666666, 39.794666666666664, 16.981999999999996, 60.36833333333334, 21.42633333333333, 18.060999999999996, 36.19433333333334, 21.29733333333332, 23.787333333333322, 34.403999999999975, 23.513999999999985, 28.569333333333333, 15.862333333333332, 19.95599999999999, 16.570666666666664, 37.00766666666667, 20.05333333333332, 17.523333333333323, 29.443666666666665, 23.484666666666655, 29.87033333333334, 26.09633333333333, 21.113, 23.153333333333336, 20.720999999999986, 29.94366666666666, 28.237666666666655, 23.461333333333336, 54.706000000000024, 15.234, 17.681333333333328, 39.69166666666665, 45.72733333333333, 17.96066666666666, 17.254, 14.836333333333332, 22.37899999999999], "episode_lengths": [64, 55, 47, 51, 39, 66, 50, 112, 74, 44, 54, 56, 27, 39, 45, 51, 54, 33, 34, 80, 31, 106, 52, 83, 46, 60, 76, 34, 94, 69, 43, 54, 86, 50, 44, 35, 49, 47, 70, 41, 37, 135, 27, 81, 88, 41, 87, 44, 50, 50, 43, 76, 39, 104, 60, 62, 76, 63, 71, 48, 72, 76, 84, 73, 78, 40, 126, 46, 35, 67, 63, 59, 93, 59, 47, 34, 48, 34, 61, 39, 37, 62, 49, 48, 62, 50, 55, 41, 58, 72, 57, 110, 29, 40, 92, 79, 37, 40, 30, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5974617361716457, "mean_inference_ms": 2.9386365432729384, "mean_action_processing_ms": 0.6128531611721535, "mean_env_wait_ms": 0.14859979076361035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015635251998901367, "StateBufferConnector_ms": 0.016380786895751953, "ViewRequirementAgentConnector_ms": 0.49382495880126953}}, "episode_reward_max": 66.11733333333332, "episode_reward_min": 13.014999999999999, "episode_reward_mean": 27.282196666666664, "episode_len_mean": 58.57, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.969666666666672, 25.486999999999988, 26.419999999999995, 22.952666666666666, 18.685333333333325, 19.008333333333322, 22.46833333333333, 39.98233333333333, 36.102000000000004, 22.501666666666658, 28.339666666666655, 22.368333333333325, 13.140333333333334, 19.023999999999997, 21.24666666666667, 32.837999999999994, 27.49599999999999, 16.942999999999998, 15.662999999999997, 49.41366666666664, 15.60633333333333, 50.923666666666705, 24.050999999999988, 35.86466666666665, 19.916333333333334, 30.250333333333337, 37.069666666666656, 14.955666666666664, 45.05266666666667, 41.63866666666671, 21.441333333333326, 26.12966666666666, 32.85033333333328, 24.32066666666666, 22.919333333333334, 18.01533333333333, 17.920666666666655, 28.15333333333334, 34.73033333333334, 22.327333333333325, 18.00833333333333, 66.11733333333332, 13.014999999999999, 40.6406666666667, 40.05566666666664, 20.60566666666666, 43.68233333333331, 20.77999999999999, 19.703333333333326, 20.458999999999996, 19.655999999999988, 23.997666666666646, 19.250333333333337, 28.437999999999978, 23.87133333333333, 31.984666666666676, 33.566999999999986, 27.194999999999993, 28.044333333333327, 27.30899999999999, 39.76400000000001, 34.16900000000001, 31.575666666666645, 27.775666666666666, 39.794666666666664, 16.981999999999996, 60.36833333333334, 21.42633333333333, 18.060999999999996, 36.19433333333334, 21.29733333333332, 23.787333333333322, 34.403999999999975, 23.513999999999985, 28.569333333333333, 15.862333333333332, 19.95599999999999, 16.570666666666664, 37.00766666666667, 20.05333333333332, 17.523333333333323, 29.443666666666665, 23.484666666666655, 29.87033333333334, 26.09633333333333, 21.113, 23.153333333333336, 20.720999999999986, 29.94366666666666, 28.237666666666655, 23.461333333333336, 54.706000000000024, 15.234, 17.681333333333328, 39.69166666666665, 45.72733333333333, 17.96066666666666, 17.254, 14.836333333333332, 22.37899999999999], "episode_lengths": [64, 55, 47, 51, 39, 66, 50, 112, 74, 44, 54, 56, 27, 39, 45, 51, 54, 33, 34, 80, 31, 106, 52, 83, 46, 60, 76, 34, 94, 69, 43, 54, 86, 50, 44, 35, 49, 47, 70, 41, 37, 135, 27, 81, 88, 41, 87, 44, 50, 50, 43, 76, 39, 104, 60, 62, 76, 63, 71, 48, 72, 76, 84, 73, 78, 40, 126, 46, 35, 67, 63, 59, 93, 59, 47, 34, 48, 34, 61, 39, 37, 62, 49, 48, 62, 50, 55, 41, 58, 72, 57, 110, 29, 40, 92, 79, 37, 40, 30, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5974617361716457, "mean_inference_ms": 2.9386365432729384, "mean_action_processing_ms": 0.6128531611721535, "mean_env_wait_ms": 0.14859979076361035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015635251998901367, "StateBufferConnector_ms": 0.016380786895751953, "ViewRequirementAgentConnector_ms": 0.49382495880126953}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.29226133739843, "num_env_steps_trained_throughput_per_sec": 441.29226133739843, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 9571.497, "sample_time_ms": 3136.326, "load_time_ms": 0.672, "load_throughput": 5948734.532, "learn_time_ms": 6402.096, "learn_throughput": 624.795, "synch_weights_time_ms": 29.233}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 4198, "training_iteration": 52, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-14-20", "timestamp": 1701998060, "time_this_iter_s": 9.09668755531311, "time_total_s": 1716.3543095588684, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1716.3543095588684, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 70.74615384615385, "ram_util_percent": 86.4769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.604317144565884e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 5.472805023193359, "policy_loss": -0.003988086245954037, "vf_loss": 5.476792812347412, "vf_explained_var": 0.5470527410507202, "kl": 0.0012798119569197297, "entropy": 0.07716602832078934, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 69.18966666666667, "episode_reward_min": 13.915333333333328, "episode_reward_mean": 28.09304333333333, "episode_len_mean": 58.69, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.060999999999996, 36.19433333333334, 21.29733333333332, 23.787333333333322, 34.403999999999975, 23.513999999999985, 28.569333333333333, 15.862333333333332, 19.95599999999999, 16.570666666666664, 37.00766666666667, 20.05333333333332, 17.523333333333323, 29.443666666666665, 23.484666666666655, 29.87033333333334, 26.09633333333333, 21.113, 23.153333333333336, 20.720999999999986, 29.94366666666666, 28.237666666666655, 23.461333333333336, 54.706000000000024, 15.234, 17.681333333333328, 39.69166666666665, 45.72733333333333, 17.96066666666666, 17.254, 14.836333333333332, 22.37899999999999, 19.130000000000003, 29.269333333333332, 23.226999999999986, 21.355, 24.055333333333333, 35.84366666666668, 18.39166666666666, 20.22466666666666, 26.75033333333331, 26.32333333333333, 18.79166666666666, 38.703333333333326, 16.862999999999992, 13.915333333333328, 51.83900000000002, 19.837666666666664, 26.291999999999998, 44.84466666666667, 32.487333333333325, 14.156999999999998, 69.18966666666667, 30.809666666666658, 51.97733333333332, 18.35866666666666, 22.295333333333325, 59.24366666666664, 20.793333333333333, 17.223999999999993, 22.724666666666653, 59.30233333333331, 42.62266666666668, 19.38733333333333, 32.73433333333331, 29.609333333333325, 39.94133333333332, 24.564333333333323, 37.262333333333316, 52.57733333333332, 25.118666666666666, 33.17866666666667, 15.651666666666658, 14.723999999999995, 22.686333333333323, 20.307999999999993, 23.759999999999998, 31.33533333333332, 34.504333333333335, 18.293, 51.534666666666666, 28.3833333333333, 41.07633333333335, 16.532999999999994, 17.99366666666666, 24.72333333333331, 16.58966666666666, 26.905333333333324, 14.974999999999998, 20.97533333333334, 30.488666666666656, 54.15766666666666, 16.68366666666666, 29.065666666666672, 52.73300000000003, 16.210666666666665, 24.47966666666665, 37.874999999999986, 23.297666666666657, 38.348000000000006], "episode_lengths": [35, 67, 63, 59, 93, 59, 47, 34, 48, 34, 61, 39, 37, 62, 49, 48, 62, 50, 55, 41, 58, 72, 57, 110, 29, 40, 92, 79, 37, 40, 30, 48, 42, 54, 58, 47, 52, 68, 50, 39, 66, 49, 43, 70, 33, 29, 88, 39, 45, 83, 63, 30, 106, 56, 94, 37, 58, 160, 37, 33, 61, 121, 71, 42, 91, 59, 69, 56, 81, 101, 59, 65, 33, 29, 47, 54, 62, 78, 62, 37, 89, 74, 64, 37, 37, 80, 33, 71, 30, 53, 51, 108, 33, 54, 110, 33, 63, 72, 72, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5974015467937641, "mean_inference_ms": 2.940912511214711, "mean_action_processing_ms": 0.6125939079099926, "mean_env_wait_ms": 0.14845182452931766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02308034896850586, "StateBufferConnector_ms": 0.03238630294799805, "ViewRequirementAgentConnector_ms": 0.48914122581481934}}, "episode_reward_max": 69.18966666666667, "episode_reward_min": 13.915333333333328, "episode_reward_mean": 28.09304333333333, "episode_len_mean": 58.69, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.060999999999996, 36.19433333333334, 21.29733333333332, 23.787333333333322, 34.403999999999975, 23.513999999999985, 28.569333333333333, 15.862333333333332, 19.95599999999999, 16.570666666666664, 37.00766666666667, 20.05333333333332, 17.523333333333323, 29.443666666666665, 23.484666666666655, 29.87033333333334, 26.09633333333333, 21.113, 23.153333333333336, 20.720999999999986, 29.94366666666666, 28.237666666666655, 23.461333333333336, 54.706000000000024, 15.234, 17.681333333333328, 39.69166666666665, 45.72733333333333, 17.96066666666666, 17.254, 14.836333333333332, 22.37899999999999, 19.130000000000003, 29.269333333333332, 23.226999999999986, 21.355, 24.055333333333333, 35.84366666666668, 18.39166666666666, 20.22466666666666, 26.75033333333331, 26.32333333333333, 18.79166666666666, 38.703333333333326, 16.862999999999992, 13.915333333333328, 51.83900000000002, 19.837666666666664, 26.291999999999998, 44.84466666666667, 32.487333333333325, 14.156999999999998, 69.18966666666667, 30.809666666666658, 51.97733333333332, 18.35866666666666, 22.295333333333325, 59.24366666666664, 20.793333333333333, 17.223999999999993, 22.724666666666653, 59.30233333333331, 42.62266666666668, 19.38733333333333, 32.73433333333331, 29.609333333333325, 39.94133333333332, 24.564333333333323, 37.262333333333316, 52.57733333333332, 25.118666666666666, 33.17866666666667, 15.651666666666658, 14.723999999999995, 22.686333333333323, 20.307999999999993, 23.759999999999998, 31.33533333333332, 34.504333333333335, 18.293, 51.534666666666666, 28.3833333333333, 41.07633333333335, 16.532999999999994, 17.99366666666666, 24.72333333333331, 16.58966666666666, 26.905333333333324, 14.974999999999998, 20.97533333333334, 30.488666666666656, 54.15766666666666, 16.68366666666666, 29.065666666666672, 52.73300000000003, 16.210666666666665, 24.47966666666665, 37.874999999999986, 23.297666666666657, 38.348000000000006], "episode_lengths": [35, 67, 63, 59, 93, 59, 47, 34, 48, 34, 61, 39, 37, 62, 49, 48, 62, 50, 55, 41, 58, 72, 57, 110, 29, 40, 92, 79, 37, 40, 30, 48, 42, 54, 58, 47, 52, 68, 50, 39, 66, 49, 43, 70, 33, 29, 88, 39, 45, 83, 63, 30, 106, 56, 94, 37, 58, 160, 37, 33, 61, 121, 71, 42, 91, 59, 69, 56, 81, 101, 59, 65, 33, 29, 47, 54, 62, 78, 62, 37, 89, 74, 64, 37, 37, 80, 33, 71, 30, 53, 51, 108, 33, 54, 110, 33, 63, 72, 72, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5974015467937641, "mean_inference_ms": 2.940912511214711, "mean_action_processing_ms": 0.6125939079099926, "mean_env_wait_ms": 0.14845182452931766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02308034896850586, "StateBufferConnector_ms": 0.03238630294799805, "ViewRequirementAgentConnector_ms": 0.48914122581481934}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.4743397139899, "num_env_steps_trained_throughput_per_sec": 401.4743397139899, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 9621.145, "sample_time_ms": 3203.641, "load_time_ms": 0.673, "load_throughput": 5946204.501, "learn_time_ms": 6382.527, "learn_throughput": 626.711, "synch_weights_time_ms": 31.034}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 4266, "training_iteration": 53, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-14-30", "timestamp": 1701998070, "time_this_iter_s": 9.991233825683594, "time_total_s": 1726.345543384552, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1726.345543384552, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 80.22857142857144, "ram_util_percent": 86.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.302158572282942e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 5.934055328369141, "policy_loss": -0.005967463832348585, "vf_loss": 5.940022945404053, "vf_explained_var": 0.5981447696685791, "kl": 0.0012919728178530931, "entropy": 0.060756243765354156, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 73.19300000000004, "episode_reward_min": 12.594333333333333, "episode_reward_mean": 28.662083333333335, "episode_len_mean": 60.2, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.609333333333325, 39.94133333333332, 24.564333333333323, 37.262333333333316, 52.57733333333332, 25.118666666666666, 33.17866666666667, 15.651666666666658, 14.723999999999995, 22.686333333333323, 20.307999999999993, 23.759999999999998, 31.33533333333332, 34.504333333333335, 18.293, 51.534666666666666, 28.3833333333333, 41.07633333333335, 16.532999999999994, 17.99366666666666, 24.72333333333331, 16.58966666666666, 26.905333333333324, 14.974999999999998, 20.97533333333334, 30.488666666666656, 54.15766666666666, 16.68366666666666, 29.065666666666672, 52.73300000000003, 16.210666666666665, 24.47966666666665, 37.874999999999986, 23.297666666666657, 38.348000000000006, 15.880333333333335, 50.02166666666667, 36.09866666666669, 17.951666666666657, 17.682333333333332, 16.56, 61.03699999999999, 17.297333333333324, 17.360999999999997, 19.682999999999993, 14.317666666666668, 18.125666666666657, 24.063666666666663, 38.955666666666666, 28.40366666666666, 42.025999999999996, 56.87966666666667, 34.12866666666668, 34.919000000000004, 18.371999999999993, 16.728666666666665, 46.38366666666664, 43.16766666666665, 21.42399999999999, 17.705000000000005, 19.67666666666667, 42.40699999999999, 39.268333333333345, 22.725666666666655, 19.427333333333326, 25.30533333333333, 34.50466666666667, 49.42066666666669, 18.031666666666663, 16.635666666666662, 36.63366666666665, 29.369, 47.07099999999996, 36.24199999999999, 16.395333333333326, 20.143333333333334, 20.781333333333336, 47.78633333333334, 22.92266666666666, 21.49566666666666, 45.81200000000002, 21.298333333333343, 45.244333333333344, 23.79899999999998, 12.819000000000004, 26.268666666666668, 30.37599999999999, 19.54366666666666, 20.594999999999995, 16.147999999999996, 28.81066666666666, 73.19300000000004, 24.247999999999994, 26.206999999999997, 22.573666666666668, 23.006999999999994, 12.594333333333333, 14.222, 33.77299999999999, 27.714666666666652], "episode_lengths": [59, 69, 56, 81, 101, 59, 65, 33, 29, 47, 54, 62, 78, 62, 37, 89, 74, 64, 37, 37, 80, 33, 71, 30, 53, 51, 108, 33, 54, 110, 33, 63, 72, 72, 63, 33, 103, 77, 43, 44, 32, 99, 38, 36, 46, 30, 44, 60, 87, 65, 103, 93, 63, 68, 41, 35, 98, 98, 41, 39, 37, 80, 62, 46, 38, 51, 69, 99, 38, 41, 96, 68, 122, 69, 37, 41, 42, 108, 53, 48, 89, 40, 88, 74, 25, 59, 59, 43, 44, 35, 64, 124, 49, 75, 50, 46, 27, 28, 56, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599076651648275, "mean_inference_ms": 2.9456502452411373, "mean_action_processing_ms": 0.613142488039833, "mean_env_wait_ms": 0.14824508011667153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030465126037597656, "StateBufferConnector_ms": 0.023896217346191406, "ViewRequirementAgentConnector_ms": 0.4856722354888916}}, "episode_reward_max": 73.19300000000004, "episode_reward_min": 12.594333333333333, "episode_reward_mean": 28.662083333333335, "episode_len_mean": 60.2, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.609333333333325, 39.94133333333332, 24.564333333333323, 37.262333333333316, 52.57733333333332, 25.118666666666666, 33.17866666666667, 15.651666666666658, 14.723999999999995, 22.686333333333323, 20.307999999999993, 23.759999999999998, 31.33533333333332, 34.504333333333335, 18.293, 51.534666666666666, 28.3833333333333, 41.07633333333335, 16.532999999999994, 17.99366666666666, 24.72333333333331, 16.58966666666666, 26.905333333333324, 14.974999999999998, 20.97533333333334, 30.488666666666656, 54.15766666666666, 16.68366666666666, 29.065666666666672, 52.73300000000003, 16.210666666666665, 24.47966666666665, 37.874999999999986, 23.297666666666657, 38.348000000000006, 15.880333333333335, 50.02166666666667, 36.09866666666669, 17.951666666666657, 17.682333333333332, 16.56, 61.03699999999999, 17.297333333333324, 17.360999999999997, 19.682999999999993, 14.317666666666668, 18.125666666666657, 24.063666666666663, 38.955666666666666, 28.40366666666666, 42.025999999999996, 56.87966666666667, 34.12866666666668, 34.919000000000004, 18.371999999999993, 16.728666666666665, 46.38366666666664, 43.16766666666665, 21.42399999999999, 17.705000000000005, 19.67666666666667, 42.40699999999999, 39.268333333333345, 22.725666666666655, 19.427333333333326, 25.30533333333333, 34.50466666666667, 49.42066666666669, 18.031666666666663, 16.635666666666662, 36.63366666666665, 29.369, 47.07099999999996, 36.24199999999999, 16.395333333333326, 20.143333333333334, 20.781333333333336, 47.78633333333334, 22.92266666666666, 21.49566666666666, 45.81200000000002, 21.298333333333343, 45.244333333333344, 23.79899999999998, 12.819000000000004, 26.268666666666668, 30.37599999999999, 19.54366666666666, 20.594999999999995, 16.147999999999996, 28.81066666666666, 73.19300000000004, 24.247999999999994, 26.206999999999997, 22.573666666666668, 23.006999999999994, 12.594333333333333, 14.222, 33.77299999999999, 27.714666666666652], "episode_lengths": [59, 69, 56, 81, 101, 59, 65, 33, 29, 47, 54, 62, 78, 62, 37, 89, 74, 64, 37, 37, 80, 33, 71, 30, 53, 51, 108, 33, 54, 110, 33, 63, 72, 72, 63, 33, 103, 77, 43, 44, 32, 99, 38, 36, 46, 30, 44, 60, 87, 65, 103, 93, 63, 68, 41, 35, 98, 98, 41, 39, 37, 80, 62, 46, 38, 51, 69, 99, 38, 41, 96, 68, 122, 69, 37, 41, 42, 108, 53, 48, 89, 40, 88, 74, 25, 59, 59, 43, 44, 35, 64, 124, 49, 75, 50, 46, 27, 28, 56, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599076651648275, "mean_inference_ms": 2.9456502452411373, "mean_action_processing_ms": 0.613142488039833, "mean_env_wait_ms": 0.14824508011667153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030465126037597656, "StateBufferConnector_ms": 0.023896217346191406, "ViewRequirementAgentConnector_ms": 0.4856722354888916}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.6072397796408, "num_env_steps_trained_throughput_per_sec": 396.6072397796408, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 9691.775, "sample_time_ms": 3226.124, "load_time_ms": 0.573, "load_throughput": 6980617.459, "learn_time_ms": 6428.737, "learn_throughput": 622.206, "synch_weights_time_ms": 32.87}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 4331, "training_iteration": 54, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-14-41", "timestamp": 1701998081, "time_this_iter_s": 10.116639137268066, "time_total_s": 1736.46218252182, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1736.46218252182, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 76.52142857142856, "ram_util_percent": 85.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.151079286141471e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 5.450045585632324, "policy_loss": -0.004526193253695965, "vf_loss": 5.4545722007751465, "vf_explained_var": 0.5609362721443176, "kl": 0.004192625638097525, "entropy": 0.08432277292013168, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 73.19300000000004, "episode_reward_min": 12.594333333333333, "episode_reward_mean": 26.880736666666667, "episode_len_mean": 57.19, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.07099999999996, 36.24199999999999, 16.395333333333326, 20.143333333333334, 20.781333333333336, 47.78633333333334, 22.92266666666666, 21.49566666666666, 45.81200000000002, 21.298333333333343, 45.244333333333344, 23.79899999999998, 12.819000000000004, 26.268666666666668, 30.37599999999999, 19.54366666666666, 20.594999999999995, 16.147999999999996, 28.81066666666666, 73.19300000000004, 24.247999999999994, 26.206999999999997, 22.573666666666668, 23.006999999999994, 12.594333333333333, 14.222, 33.77299999999999, 27.714666666666652, 31.576999999999977, 23.420999999999992, 28.248, 15.962333333333323, 23.889666666666653, 65.96866666666669, 27.99266666666666, 23.174, 15.453666666666665, 21.058000000000003, 18.345999999999997, 36.852, 23.58633333333333, 27.21866666666664, 36.070666666666675, 31.75966666666663, 16.631333333333327, 40.11166666666668, 27.027666666666658, 26.591333333333335, 13.649666666666663, 23.596333333333323, 35.326, 18.023, 30.53599999999998, 18.90166666666666, 24.602333333333323, 13.249333333333329, 39.21066666666663, 16.997999999999998, 37.567000000000014, 17.11466666666666, 17.46733333333333, 50.29699999999997, 43.631, 35.53533333333333, 18.833666666666662, 46.180333333333294, 24.433999999999994, 58.496333333333325, 30.398999999999987, 14.541666666666666, 19.21833333333333, 20.844333333333324, 32.08233333333333, 20.420333333333332, 23.360999999999997, 21.142999999999994, 38.539333333333325, 42.41566666666664, 16.19599999999999, 15.389666666666658, 21.26566666666665, 30.860999999999986, 14.21866666666667, 36.49766666666665, 32.240666666666655, 20.543333333333326, 22.614333333333313, 17.909666666666656, 16.218666666666664, 16.029333333333334, 23.75733333333333, 15.269999999999992, 52.90266666666668, 15.766333333333328, 20.15866666666667, 22.23266666666666, 16.583333333333325, 19.50266666666666, 22.200666666666663, 31.074666666666655], "episode_lengths": [122, 69, 37, 41, 42, 108, 53, 48, 89, 40, 88, 74, 25, 59, 59, 43, 44, 35, 64, 124, 49, 75, 50, 46, 27, 28, 56, 65, 108, 53, 63, 34, 68, 105, 71, 44, 35, 46, 39, 83, 46, 76, 71, 84, 41, 81, 47, 65, 30, 64, 69, 40, 57, 38, 48, 27, 63, 40, 64, 40, 43, 80, 76, 65, 42, 122, 67, 114, 76, 28, 46, 46, 69, 40, 46, 43, 71, 72, 39, 33, 60, 76, 27, 66, 59, 40, 64, 55, 32, 31, 43, 33, 81, 34, 42, 61, 35, 51, 43, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5970406299545126, "mean_inference_ms": 2.9458710632329366, "mean_action_processing_ms": 0.6130940172115177, "mean_env_wait_ms": 0.1482140313109092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024687767028808594, "StateBufferConnector_ms": 0.014544010162353516, "ViewRequirementAgentConnector_ms": 0.4833335876464844}}, "episode_reward_max": 73.19300000000004, "episode_reward_min": 12.594333333333333, "episode_reward_mean": 26.880736666666667, "episode_len_mean": 57.19, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.07099999999996, 36.24199999999999, 16.395333333333326, 20.143333333333334, 20.781333333333336, 47.78633333333334, 22.92266666666666, 21.49566666666666, 45.81200000000002, 21.298333333333343, 45.244333333333344, 23.79899999999998, 12.819000000000004, 26.268666666666668, 30.37599999999999, 19.54366666666666, 20.594999999999995, 16.147999999999996, 28.81066666666666, 73.19300000000004, 24.247999999999994, 26.206999999999997, 22.573666666666668, 23.006999999999994, 12.594333333333333, 14.222, 33.77299999999999, 27.714666666666652, 31.576999999999977, 23.420999999999992, 28.248, 15.962333333333323, 23.889666666666653, 65.96866666666669, 27.99266666666666, 23.174, 15.453666666666665, 21.058000000000003, 18.345999999999997, 36.852, 23.58633333333333, 27.21866666666664, 36.070666666666675, 31.75966666666663, 16.631333333333327, 40.11166666666668, 27.027666666666658, 26.591333333333335, 13.649666666666663, 23.596333333333323, 35.326, 18.023, 30.53599999999998, 18.90166666666666, 24.602333333333323, 13.249333333333329, 39.21066666666663, 16.997999999999998, 37.567000000000014, 17.11466666666666, 17.46733333333333, 50.29699999999997, 43.631, 35.53533333333333, 18.833666666666662, 46.180333333333294, 24.433999999999994, 58.496333333333325, 30.398999999999987, 14.541666666666666, 19.21833333333333, 20.844333333333324, 32.08233333333333, 20.420333333333332, 23.360999999999997, 21.142999999999994, 38.539333333333325, 42.41566666666664, 16.19599999999999, 15.389666666666658, 21.26566666666665, 30.860999999999986, 14.21866666666667, 36.49766666666665, 32.240666666666655, 20.543333333333326, 22.614333333333313, 17.909666666666656, 16.218666666666664, 16.029333333333334, 23.75733333333333, 15.269999999999992, 52.90266666666668, 15.766333333333328, 20.15866666666667, 22.23266666666666, 16.583333333333325, 19.50266666666666, 22.200666666666663, 31.074666666666655], "episode_lengths": [122, 69, 37, 41, 42, 108, 53, 48, 89, 40, 88, 74, 25, 59, 59, 43, 44, 35, 64, 124, 49, 75, 50, 46, 27, 28, 56, 65, 108, 53, 63, 34, 68, 105, 71, 44, 35, 46, 39, 83, 46, 76, 71, 84, 41, 81, 47, 65, 30, 64, 69, 40, 57, 38, 48, 27, 63, 40, 64, 40, 43, 80, 76, 65, 42, 122, 67, 114, 76, 28, 46, 46, 69, 40, 46, 43, 71, 72, 39, 33, 60, 76, 27, 66, 59, 40, 64, 55, 32, 31, 43, 33, 81, 34, 42, 61, 35, 51, 43, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5970406299545126, "mean_inference_ms": 2.9458710632329366, "mean_action_processing_ms": 0.6130940172115177, "mean_env_wait_ms": 0.1482140313109092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024687767028808594, "StateBufferConnector_ms": 0.014544010162353516, "ViewRequirementAgentConnector_ms": 0.4833335876464844}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.7324996752033, "num_env_steps_trained_throughput_per_sec": 432.7324996752033, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 9604.973, "sample_time_ms": 3108.444, "load_time_ms": 0.426, "load_throughput": 9397947.569, "learn_time_ms": 6459.565, "learn_throughput": 619.237, "synch_weights_time_ms": 32.94}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 4403, "training_iteration": 55, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-14-50", "timestamp": 1701998090, "time_this_iter_s": 9.287674188613892, "time_total_s": 1745.749856710434, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1745.749856710434, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 72.93846153846154, "ram_util_percent": 85.90769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.755396430707355e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 5.754750728607178, "policy_loss": -0.0012436796678230166, "vf_loss": 5.7559943199157715, "vf_explained_var": 0.5212878584861755, "kl": 0.0011872138129547238, "entropy": 0.08073887974023819, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 52.90266666666668, "episode_reward_min": 12.318333333333333, "episode_reward_mean": 25.73197666666666, "episode_len_mean": 54.57, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.21833333333333, 20.844333333333324, 32.08233333333333, 20.420333333333332, 23.360999999999997, 21.142999999999994, 38.539333333333325, 42.41566666666664, 16.19599999999999, 15.389666666666658, 21.26566666666665, 30.860999999999986, 14.21866666666667, 36.49766666666665, 32.240666666666655, 20.543333333333326, 22.614333333333313, 17.909666666666656, 16.218666666666664, 16.029333333333334, 23.75733333333333, 15.269999999999992, 52.90266666666668, 15.766333333333328, 20.15866666666667, 22.23266666666666, 16.583333333333325, 19.50266666666666, 22.200666666666663, 31.074666666666655, 34.16033333333331, 36.77933333333334, 23.316, 33.675, 15.386333333333328, 24.326999999999998, 51.27166666666668, 19.76833333333333, 16.240666666666662, 22.46566666666666, 49.69933333333333, 26.126333333333328, 17.92333333333332, 21.12433333333333, 30.841666666666647, 18.59966666666666, 34.07866666666667, 23.242333333333335, 21.953999999999997, 17.913999999999998, 22.02433333333333, 17.813333333333325, 36.465999999999994, 17.001999999999995, 22.086000000000002, 40.18499999999998, 31.29266666666664, 34.69699999999998, 22.790333333333326, 17.446666666666662, 15.433666666666662, 21.49766666666666, 28.449666666666662, 38.83466666666668, 37.286999999999985, 27.02866666666664, 22.87833333333333, 24.06433333333333, 12.318333333333333, 34.75366666666666, 26.090666666666653, 27.646666666666665, 19.03, 17.43966666666666, 28.95066666666667, 25.728666666666676, 24.22866666666666, 15.80833333333333, 24.40433333333333, 39.95999999999997, 29.184, 15.447666666666665, 22.265666666666668, 27.221666666666668, 18.947999999999993, 48.07233333333333, 24.071333333333335, 39.64433333333335, 51.20433333333336, 21.155999999999988, 41.92166666666667, 17.98833333333333, 27.799333333333323, 14.109333333333334, 23.092000000000002, 14.738999999999994, 40.536333333333346, 18.528, 22.832333333333324, 24.446999999999985], "episode_lengths": [46, 46, 69, 40, 46, 43, 71, 72, 39, 33, 60, 76, 27, 66, 59, 40, 64, 55, 32, 31, 43, 33, 81, 34, 42, 61, 35, 51, 43, 68, 62, 67, 43, 92, 41, 55, 80, 55, 45, 48, 103, 46, 55, 46, 70, 44, 61, 48, 50, 42, 53, 40, 61, 32, 41, 100, 81, 55, 58, 44, 40, 40, 59, 79, 80, 85, 42, 43, 25, 72, 64, 47, 57, 43, 53, 63, 51, 42, 55, 99, 53, 34, 48, 65, 49, 68, 49, 76, 90, 51, 82, 39, 67, 27, 47, 34, 64, 41, 58, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.594987706152545, "mean_inference_ms": 2.943600488367048, "mean_action_processing_ms": 0.6127533496223012, "mean_env_wait_ms": 0.14805857963126215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023062467575073242, "StateBufferConnector_ms": 0.010333061218261719, "ViewRequirementAgentConnector_ms": 0.46982598304748535}}, "episode_reward_max": 52.90266666666668, "episode_reward_min": 12.318333333333333, "episode_reward_mean": 25.73197666666666, "episode_len_mean": 54.57, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.21833333333333, 20.844333333333324, 32.08233333333333, 20.420333333333332, 23.360999999999997, 21.142999999999994, 38.539333333333325, 42.41566666666664, 16.19599999999999, 15.389666666666658, 21.26566666666665, 30.860999999999986, 14.21866666666667, 36.49766666666665, 32.240666666666655, 20.543333333333326, 22.614333333333313, 17.909666666666656, 16.218666666666664, 16.029333333333334, 23.75733333333333, 15.269999999999992, 52.90266666666668, 15.766333333333328, 20.15866666666667, 22.23266666666666, 16.583333333333325, 19.50266666666666, 22.200666666666663, 31.074666666666655, 34.16033333333331, 36.77933333333334, 23.316, 33.675, 15.386333333333328, 24.326999999999998, 51.27166666666668, 19.76833333333333, 16.240666666666662, 22.46566666666666, 49.69933333333333, 26.126333333333328, 17.92333333333332, 21.12433333333333, 30.841666666666647, 18.59966666666666, 34.07866666666667, 23.242333333333335, 21.953999999999997, 17.913999999999998, 22.02433333333333, 17.813333333333325, 36.465999999999994, 17.001999999999995, 22.086000000000002, 40.18499999999998, 31.29266666666664, 34.69699999999998, 22.790333333333326, 17.446666666666662, 15.433666666666662, 21.49766666666666, 28.449666666666662, 38.83466666666668, 37.286999999999985, 27.02866666666664, 22.87833333333333, 24.06433333333333, 12.318333333333333, 34.75366666666666, 26.090666666666653, 27.646666666666665, 19.03, 17.43966666666666, 28.95066666666667, 25.728666666666676, 24.22866666666666, 15.80833333333333, 24.40433333333333, 39.95999999999997, 29.184, 15.447666666666665, 22.265666666666668, 27.221666666666668, 18.947999999999993, 48.07233333333333, 24.071333333333335, 39.64433333333335, 51.20433333333336, 21.155999999999988, 41.92166666666667, 17.98833333333333, 27.799333333333323, 14.109333333333334, 23.092000000000002, 14.738999999999994, 40.536333333333346, 18.528, 22.832333333333324, 24.446999999999985], "episode_lengths": [46, 46, 69, 40, 46, 43, 71, 72, 39, 33, 60, 76, 27, 66, 59, 40, 64, 55, 32, 31, 43, 33, 81, 34, 42, 61, 35, 51, 43, 68, 62, 67, 43, 92, 41, 55, 80, 55, 45, 48, 103, 46, 55, 46, 70, 44, 61, 48, 50, 42, 53, 40, 61, 32, 41, 100, 81, 55, 58, 44, 40, 40, 59, 79, 80, 85, 42, 43, 25, 72, 64, 47, 57, 43, 53, 63, 51, 42, 55, 99, 53, 34, 48, 65, 49, 68, 49, 76, 90, 51, 82, 39, 67, 27, 47, 34, 64, 41, 58, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.594987706152545, "mean_inference_ms": 2.943600488367048, "mean_action_processing_ms": 0.6127533496223012, "mean_env_wait_ms": 0.14805857963126215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023062467575073242, "StateBufferConnector_ms": 0.010333061218261719, "ViewRequirementAgentConnector_ms": 0.46982598304748535}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.3122421221174, "num_env_steps_trained_throughput_per_sec": 416.3122421221174, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9670.798, "sample_time_ms": 3122.393, "load_time_ms": 0.377, "load_throughput": 10617147.197, "learn_time_ms": 6511.641, "learn_throughput": 614.284, "synch_weights_time_ms": 33.042}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 4473, "training_iteration": 56, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-15-00", "timestamp": 1701998100, "time_this_iter_s": 9.643068075180054, "time_total_s": 1755.392924785614, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1755.392924785614, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 76.61538461538461, "ram_util_percent": 85.62307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.877698215353677e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 5.945563316345215, "policy_loss": -0.006831265054643154, "vf_loss": 5.952394485473633, "vf_explained_var": 0.5695919990539551, "kl": 0.0013197048101574183, "entropy": 0.05710447207093239, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 58.54200000000004, "episode_reward_min": 12.318333333333333, "episode_reward_mean": 27.590639999999997, "episode_len_mean": 58.18, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.02866666666664, 22.87833333333333, 24.06433333333333, 12.318333333333333, 34.75366666666666, 26.090666666666653, 27.646666666666665, 19.03, 17.43966666666666, 28.95066666666667, 25.728666666666676, 24.22866666666666, 15.80833333333333, 24.40433333333333, 39.95999999999997, 29.184, 15.447666666666665, 22.265666666666668, 27.221666666666668, 18.947999999999993, 48.07233333333333, 24.071333333333335, 39.64433333333335, 51.20433333333336, 21.155999999999988, 41.92166666666667, 17.98833333333333, 27.799333333333323, 14.109333333333334, 23.092000000000002, 14.738999999999994, 40.536333333333346, 18.528, 22.832333333333324, 24.446999999999985, 33.873999999999995, 16.558999999999997, 24.292333333333325, 33.13599999999998, 15.521666666666661, 36.45600000000001, 21.012333333333324, 48.56466666666668, 17.440666666666665, 17.287999999999993, 20.81633333333333, 25.56433333333333, 52.5076666666667, 22.604333333333326, 14.753666666666664, 53.58999999999998, 18.589999999999996, 25.197, 16.77633333333333, 16.66166666666666, 44.34799999999999, 19.366666666666653, 20.182999999999996, 25.519666666666666, 13.215000000000002, 19.10066666666666, 19.084999999999994, 23.505666666666663, 38.31733333333333, 48.38366666666668, 39.006, 41.339000000000006, 49.38866666666667, 26.07666666666666, 14.620999999999995, 25.887999999999984, 18.681333333333335, 19.499666666666666, 16.326333333333334, 34.98566666666664, 19.274333333333338, 21.98533333333331, 58.54200000000004, 27.151333333333312, 46.91633333333333, 36.0273333333333, 26.962999999999973, 20.87933333333332, 25.843333333333327, 17.791999999999987, 29.33566666666668, 28.537333333333322, 37.31166666666668, 20.160999999999994, 16.08899999999999, 55.92900000000001, 28.871666666666666, 33.66699999999998, 39.33166666666666, 31.636333333333315, 17.754999999999992, 29.84033333333333, 51.03366666666669, 15.405999999999999, 21.20166666666666], "episode_lengths": [85, 42, 43, 25, 72, 64, 47, 57, 43, 53, 63, 51, 42, 55, 99, 53, 34, 48, 65, 49, 68, 49, 76, 90, 51, 82, 39, 67, 27, 47, 34, 64, 41, 58, 52, 67, 38, 51, 71, 30, 61, 43, 101, 34, 35, 52, 47, 92, 46, 30, 120, 41, 46, 35, 38, 89, 41, 38, 54, 27, 61, 68, 58, 79, 93, 77, 76, 98, 57, 31, 66, 54, 39, 35, 98, 36, 65, 117, 65, 72, 97, 81, 47, 47, 37, 54, 59, 85, 40, 37, 108, 52, 59, 74, 73, 34, 67, 80, 33, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5942435878070365, "mean_inference_ms": 2.9449473435581037, "mean_action_processing_ms": 0.6127310475208594, "mean_env_wait_ms": 0.147868974041298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02707529067993164, "StateBufferConnector_ms": 0.017726898193359375, "ViewRequirementAgentConnector_ms": 0.4692816734313965}}, "episode_reward_max": 58.54200000000004, "episode_reward_min": 12.318333333333333, "episode_reward_mean": 27.590639999999997, "episode_len_mean": 58.18, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.02866666666664, 22.87833333333333, 24.06433333333333, 12.318333333333333, 34.75366666666666, 26.090666666666653, 27.646666666666665, 19.03, 17.43966666666666, 28.95066666666667, 25.728666666666676, 24.22866666666666, 15.80833333333333, 24.40433333333333, 39.95999999999997, 29.184, 15.447666666666665, 22.265666666666668, 27.221666666666668, 18.947999999999993, 48.07233333333333, 24.071333333333335, 39.64433333333335, 51.20433333333336, 21.155999999999988, 41.92166666666667, 17.98833333333333, 27.799333333333323, 14.109333333333334, 23.092000000000002, 14.738999999999994, 40.536333333333346, 18.528, 22.832333333333324, 24.446999999999985, 33.873999999999995, 16.558999999999997, 24.292333333333325, 33.13599999999998, 15.521666666666661, 36.45600000000001, 21.012333333333324, 48.56466666666668, 17.440666666666665, 17.287999999999993, 20.81633333333333, 25.56433333333333, 52.5076666666667, 22.604333333333326, 14.753666666666664, 53.58999999999998, 18.589999999999996, 25.197, 16.77633333333333, 16.66166666666666, 44.34799999999999, 19.366666666666653, 20.182999999999996, 25.519666666666666, 13.215000000000002, 19.10066666666666, 19.084999999999994, 23.505666666666663, 38.31733333333333, 48.38366666666668, 39.006, 41.339000000000006, 49.38866666666667, 26.07666666666666, 14.620999999999995, 25.887999999999984, 18.681333333333335, 19.499666666666666, 16.326333333333334, 34.98566666666664, 19.274333333333338, 21.98533333333331, 58.54200000000004, 27.151333333333312, 46.91633333333333, 36.0273333333333, 26.962999999999973, 20.87933333333332, 25.843333333333327, 17.791999999999987, 29.33566666666668, 28.537333333333322, 37.31166666666668, 20.160999999999994, 16.08899999999999, 55.92900000000001, 28.871666666666666, 33.66699999999998, 39.33166666666666, 31.636333333333315, 17.754999999999992, 29.84033333333333, 51.03366666666669, 15.405999999999999, 21.20166666666666], "episode_lengths": [85, 42, 43, 25, 72, 64, 47, 57, 43, 53, 63, 51, 42, 55, 99, 53, 34, 48, 65, 49, 68, 49, 76, 90, 51, 82, 39, 67, 27, 47, 34, 64, 41, 58, 52, 67, 38, 51, 71, 30, 61, 43, 101, 34, 35, 52, 47, 92, 46, 30, 120, 41, 46, 35, 38, 89, 41, 38, 54, 27, 61, 68, 58, 79, 93, 77, 76, 98, 57, 31, 66, 54, 39, 35, 98, 36, 65, 117, 65, 72, 97, 81, 47, 47, 37, 54, 59, 85, 40, 37, 108, 52, 59, 74, 73, 34, 67, 80, 33, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5942435878070365, "mean_inference_ms": 2.9449473435581037, "mean_action_processing_ms": 0.6127310475208594, "mean_env_wait_ms": 0.147868974041298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02707529067993164, "StateBufferConnector_ms": 0.017726898193359375, "ViewRequirementAgentConnector_ms": 0.4692816734313965}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.413771549524, "num_env_steps_trained_throughput_per_sec": 407.413771549524, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 9650.783, "sample_time_ms": 3120.405, "load_time_ms": 0.272, "load_throughput": 14703957.932, "learn_time_ms": 6493.004, "learn_throughput": 616.048, "synch_weights_time_ms": 33.55}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 4538, "training_iteration": 57, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-15-10", "timestamp": 1701998110, "time_this_iter_s": 9.875194072723389, "time_total_s": 1765.2681188583374, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1765.2681188583374, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 73.34285714285714, "ram_util_percent": 86.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4388491076768387e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 5.620782852172852, "policy_loss": -0.0073448652401566505, "vf_loss": 5.6281280517578125, "vf_explained_var": 0.5579254627227783, "kl": 0.0010348157957196236, "entropy": 0.0464131198823452, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 69.1876666666667, "episode_reward_min": 14.620999999999995, "episode_reward_mean": 29.057073333333324, "episode_len_mean": 61.77, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.339000000000006, 49.38866666666667, 26.07666666666666, 14.620999999999995, 25.887999999999984, 18.681333333333335, 19.499666666666666, 16.326333333333334, 34.98566666666664, 19.274333333333338, 21.98533333333331, 58.54200000000004, 27.151333333333312, 46.91633333333333, 36.0273333333333, 26.962999999999973, 20.87933333333332, 25.843333333333327, 17.791999999999987, 29.33566666666668, 28.537333333333322, 37.31166666666668, 20.160999999999994, 16.08899999999999, 55.92900000000001, 28.871666666666666, 33.66699999999998, 39.33166666666666, 31.636333333333315, 17.754999999999992, 29.84033333333333, 51.03366666666669, 15.405999999999999, 21.20166666666666, 51.483333333333306, 28.45866666666666, 25.11533333333332, 32.676666666666684, 25.658333333333335, 22.959, 39.11766666666667, 24.059000000000005, 19.476999999999993, 21.715999999999994, 38.903666666666666, 22.703, 32.36199999999998, 21.084999999999994, 32.841, 21.298333333333325, 18.85466666666667, 24.795000000000005, 42.40166666666665, 42.306333333333335, 55.954333333333345, 21.644999999999992, 18.094999999999995, 17.582333333333324, 43.648333333333305, 26.596999999999987, 15.809999999999997, 25.646333333333324, 37.30866666666667, 49.67833333333335, 33.496999999999986, 25.083999999999982, 32.543333333333315, 17.19366666666666, 17.479999999999993, 38.62799999999999, 48.20566666666667, 17.560999999999996, 18.530999999999985, 40.42666666666665, 69.1876666666667, 36.166333333333334, 16.778666666666663, 39.27066666666668, 30.287, 18.903666666666663, 26.18966666666667, 48.04299999999997, 56.277333333333296, 30.097999999999995, 16.782666666666664, 17.422666666666657, 27.018999999999995, 20.106999999999992, 18.632, 15.676000000000002, 17.454999999999995, 25.439000000000004, 24.812666666666658, 23.110333333333333, 37.077666666666666, 15.033666666666665, 16.29166666666666, 23.88533333333332, 23.755666666666656, 18.33], "episode_lengths": [76, 98, 57, 31, 66, 54, 39, 35, 98, 36, 65, 117, 65, 72, 97, 81, 47, 47, 37, 54, 59, 85, 40, 37, 108, 52, 59, 74, 73, 34, 67, 80, 33, 47, 132, 47, 66, 63, 60, 54, 65, 61, 42, 62, 97, 54, 63, 57, 62, 62, 52, 56, 80, 72, 94, 55, 37, 45, 90, 58, 32, 47, 76, 92, 84, 69, 87, 33, 49, 71, 82, 38, 49, 103, 118, 64, 36, 67, 72, 46, 56, 100, 113, 71, 34, 35, 62, 45, 40, 30, 40, 43, 53, 42, 76, 30, 34, 57, 58, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5923633851737427, "mean_inference_ms": 2.942859799821717, "mean_action_processing_ms": 0.612022148766396, "mean_env_wait_ms": 0.14784645728363427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026381492614746094, "StateBufferConnector_ms": 0.016991853713989258, "ViewRequirementAgentConnector_ms": 0.4644203186035156}}, "episode_reward_max": 69.1876666666667, "episode_reward_min": 14.620999999999995, "episode_reward_mean": 29.057073333333324, "episode_len_mean": 61.77, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.339000000000006, 49.38866666666667, 26.07666666666666, 14.620999999999995, 25.887999999999984, 18.681333333333335, 19.499666666666666, 16.326333333333334, 34.98566666666664, 19.274333333333338, 21.98533333333331, 58.54200000000004, 27.151333333333312, 46.91633333333333, 36.0273333333333, 26.962999999999973, 20.87933333333332, 25.843333333333327, 17.791999999999987, 29.33566666666668, 28.537333333333322, 37.31166666666668, 20.160999999999994, 16.08899999999999, 55.92900000000001, 28.871666666666666, 33.66699999999998, 39.33166666666666, 31.636333333333315, 17.754999999999992, 29.84033333333333, 51.03366666666669, 15.405999999999999, 21.20166666666666, 51.483333333333306, 28.45866666666666, 25.11533333333332, 32.676666666666684, 25.658333333333335, 22.959, 39.11766666666667, 24.059000000000005, 19.476999999999993, 21.715999999999994, 38.903666666666666, 22.703, 32.36199999999998, 21.084999999999994, 32.841, 21.298333333333325, 18.85466666666667, 24.795000000000005, 42.40166666666665, 42.306333333333335, 55.954333333333345, 21.644999999999992, 18.094999999999995, 17.582333333333324, 43.648333333333305, 26.596999999999987, 15.809999999999997, 25.646333333333324, 37.30866666666667, 49.67833333333335, 33.496999999999986, 25.083999999999982, 32.543333333333315, 17.19366666666666, 17.479999999999993, 38.62799999999999, 48.20566666666667, 17.560999999999996, 18.530999999999985, 40.42666666666665, 69.1876666666667, 36.166333333333334, 16.778666666666663, 39.27066666666668, 30.287, 18.903666666666663, 26.18966666666667, 48.04299999999997, 56.277333333333296, 30.097999999999995, 16.782666666666664, 17.422666666666657, 27.018999999999995, 20.106999999999992, 18.632, 15.676000000000002, 17.454999999999995, 25.439000000000004, 24.812666666666658, 23.110333333333333, 37.077666666666666, 15.033666666666665, 16.29166666666666, 23.88533333333332, 23.755666666666656, 18.33], "episode_lengths": [76, 98, 57, 31, 66, 54, 39, 35, 98, 36, 65, 117, 65, 72, 97, 81, 47, 47, 37, 54, 59, 85, 40, 37, 108, 52, 59, 74, 73, 34, 67, 80, 33, 47, 132, 47, 66, 63, 60, 54, 65, 61, 42, 62, 97, 54, 63, 57, 62, 62, 52, 56, 80, 72, 94, 55, 37, 45, 90, 58, 32, 47, 76, 92, 84, 69, 87, 33, 49, 71, 82, 38, 49, 103, 118, 64, 36, 67, 72, 46, 56, 100, 113, 71, 34, 35, 62, 45, 40, 30, 40, 43, 53, 42, 76, 30, 34, 57, 58, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5923633851737427, "mean_inference_ms": 2.942859799821717, "mean_action_processing_ms": 0.612022148766396, "mean_env_wait_ms": 0.14784645728363427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026381492614746094, "StateBufferConnector_ms": 0.016991853713989258, "ViewRequirementAgentConnector_ms": 0.4644203186035156}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.025674389131, "num_env_steps_trained_throughput_per_sec": 439.025674389131, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 9588.702, "sample_time_ms": 3067.792, "load_time_ms": 0.253, "load_throughput": 15832043.031, "learn_time_ms": 6482.662, "learn_throughput": 617.031, "synch_weights_time_ms": 34.376}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 4604, "training_iteration": 58, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-15-19", "timestamp": 1701998119, "time_this_iter_s": 9.1450777053833, "time_total_s": 1774.4131965637207, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1774.4131965637207, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 75.40833333333335, "ram_util_percent": 86.54166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.194245538384193e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 5.4603424072265625, "policy_loss": -0.004967569373548031, "vf_loss": 5.465310096740723, "vf_explained_var": 0.5932157039642334, "kl": 0.0006014851969666779, "entropy": 0.042610134929418564, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 70.95233333333336, "episode_reward_min": 13.281999999999998, "episode_reward_mean": 27.586796666666654, "episode_len_mean": 57.9, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.530999999999985, 40.42666666666665, 69.1876666666667, 36.166333333333334, 16.778666666666663, 39.27066666666668, 30.287, 18.903666666666663, 26.18966666666667, 48.04299999999997, 56.277333333333296, 30.097999999999995, 16.782666666666664, 17.422666666666657, 27.018999999999995, 20.106999999999992, 18.632, 15.676000000000002, 17.454999999999995, 25.439000000000004, 24.812666666666658, 23.110333333333333, 37.077666666666666, 15.033666666666665, 16.29166666666666, 23.88533333333332, 23.755666666666656, 18.33, 53.07633333333328, 13.281999999999998, 16.71633333333333, 15.922666666666666, 26.837666666666657, 70.95233333333336, 33.153333333333336, 35.71266666666668, 16.988666666666663, 19.61233333333333, 16.12266666666666, 30.580999999999992, 30.879666666666648, 38.22800000000001, 22.989999999999988, 31.385666666666648, 25.495999999999984, 16.084333333333333, 69.85766666666666, 18.272666666666655, 21.934666666666665, 50.287000000000006, 28.19366666666664, 40.09833333333332, 18.893999999999984, 19.634333333333327, 27.749666666666652, 24.906999999999993, 18.468333333333327, 22.22566666666667, 29.404333333333316, 19.41033333333333, 18.868666666666655, 16.24966666666667, 14.89466666666667, 19.85133333333332, 16.819999999999997, 23.98766666666666, 15.197333333333333, 24.429666666666666, 20.38999999999999, 31.653666666666673, 67.73500000000001, 21.092999999999993, 33.93733333333333, 24.583666666666645, 28.80333333333333, 18.392999999999994, 25.224666666666657, 27.458666666666666, 27.69766666666667, 16.937333333333328, 26.787666666666645, 24.24133333333332, 49.38233333333331, 31.7203333333333, 24.537666666666667, 23.318999999999996, 16.43, 36.54166666666666, 17.05633333333333, 42.140999999999984, 44.918999999999976, 18.491666666666674, 33.84699999999999, 23.584999999999997, 32.839, 25.43533333333334, 19.01333333333333, 40.65966666666667, 14.602333333333332, 24.57433333333333], "episode_lengths": [49, 103, 118, 64, 36, 67, 72, 46, 56, 100, 113, 71, 34, 35, 62, 45, 40, 30, 40, 43, 53, 42, 76, 30, 34, 57, 58, 37, 102, 29, 36, 31, 72, 134, 64, 71, 35, 48, 35, 70, 58, 69, 43, 79, 51, 32, 117, 51, 39, 86, 87, 90, 50, 40, 74, 46, 41, 44, 58, 38, 59, 37, 29, 43, 35, 61, 31, 44, 44, 73, 112, 49, 73, 44, 57, 36, 48, 52, 56, 33, 81, 52, 74, 60, 60, 58, 35, 88, 43, 92, 98, 42, 86, 52, 51, 45, 43, 100, 28, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5908828236442007, "mean_inference_ms": 2.9416145646394694, "mean_action_processing_ms": 0.6116558344786958, "mean_env_wait_ms": 0.14773185926890206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02475285530090332, "StateBufferConnector_ms": 0.009062767028808594, "ViewRequirementAgentConnector_ms": 0.4963970184326172}}, "episode_reward_max": 70.95233333333336, "episode_reward_min": 13.281999999999998, "episode_reward_mean": 27.586796666666654, "episode_len_mean": 57.9, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.530999999999985, 40.42666666666665, 69.1876666666667, 36.166333333333334, 16.778666666666663, 39.27066666666668, 30.287, 18.903666666666663, 26.18966666666667, 48.04299999999997, 56.277333333333296, 30.097999999999995, 16.782666666666664, 17.422666666666657, 27.018999999999995, 20.106999999999992, 18.632, 15.676000000000002, 17.454999999999995, 25.439000000000004, 24.812666666666658, 23.110333333333333, 37.077666666666666, 15.033666666666665, 16.29166666666666, 23.88533333333332, 23.755666666666656, 18.33, 53.07633333333328, 13.281999999999998, 16.71633333333333, 15.922666666666666, 26.837666666666657, 70.95233333333336, 33.153333333333336, 35.71266666666668, 16.988666666666663, 19.61233333333333, 16.12266666666666, 30.580999999999992, 30.879666666666648, 38.22800000000001, 22.989999999999988, 31.385666666666648, 25.495999999999984, 16.084333333333333, 69.85766666666666, 18.272666666666655, 21.934666666666665, 50.287000000000006, 28.19366666666664, 40.09833333333332, 18.893999999999984, 19.634333333333327, 27.749666666666652, 24.906999999999993, 18.468333333333327, 22.22566666666667, 29.404333333333316, 19.41033333333333, 18.868666666666655, 16.24966666666667, 14.89466666666667, 19.85133333333332, 16.819999999999997, 23.98766666666666, 15.197333333333333, 24.429666666666666, 20.38999999999999, 31.653666666666673, 67.73500000000001, 21.092999999999993, 33.93733333333333, 24.583666666666645, 28.80333333333333, 18.392999999999994, 25.224666666666657, 27.458666666666666, 27.69766666666667, 16.937333333333328, 26.787666666666645, 24.24133333333332, 49.38233333333331, 31.7203333333333, 24.537666666666667, 23.318999999999996, 16.43, 36.54166666666666, 17.05633333333333, 42.140999999999984, 44.918999999999976, 18.491666666666674, 33.84699999999999, 23.584999999999997, 32.839, 25.43533333333334, 19.01333333333333, 40.65966666666667, 14.602333333333332, 24.57433333333333], "episode_lengths": [49, 103, 118, 64, 36, 67, 72, 46, 56, 100, 113, 71, 34, 35, 62, 45, 40, 30, 40, 43, 53, 42, 76, 30, 34, 57, 58, 37, 102, 29, 36, 31, 72, 134, 64, 71, 35, 48, 35, 70, 58, 69, 43, 79, 51, 32, 117, 51, 39, 86, 87, 90, 50, 40, 74, 46, 41, 44, 58, 38, 59, 37, 29, 43, 35, 61, 31, 44, 44, 73, 112, 49, 73, 44, 57, 36, 48, 52, 56, 33, 81, 52, 74, 60, 60, 58, 35, 88, 43, 92, 98, 42, 86, 52, 51, 45, 43, 100, 28, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5908828236442007, "mean_inference_ms": 2.9416145646394694, "mean_action_processing_ms": 0.6116558344786958, "mean_env_wait_ms": 0.14773185926890206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02475285530090332, "StateBufferConnector_ms": 0.009062767028808594, "ViewRequirementAgentConnector_ms": 0.4963970184326172}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.23256240520766, "num_env_steps_trained_throughput_per_sec": 413.23256240520766, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 9572.376, "sample_time_ms": 3075.781, "load_time_ms": 0.253, "load_throughput": 15832043.031, "learn_time_ms": 6456.884, "learn_throughput": 619.494, "synch_weights_time_ms": 34.739}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 4676, "training_iteration": 59, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-15-29", "timestamp": 1701998129, "time_this_iter_s": 9.71077299118042, "time_total_s": 1784.1239695549011, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1784.1239695549011, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 76.82857142857142, "ram_util_percent": 86.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.597122769192097e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 5.6188201904296875, "policy_loss": -0.0058800880797207355, "vf_loss": 5.62470006942749, "vf_explained_var": 0.5110039710998535, "kl": 0.0023008594289422035, "entropy": 0.0445648692548275, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 67.73500000000001, "episode_reward_min": 13.198999999999998, "episode_reward_mean": 28.55977333333333, "episode_len_mean": 59.39, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.429666666666666, 20.38999999999999, 31.653666666666673, 67.73500000000001, 21.092999999999993, 33.93733333333333, 24.583666666666645, 28.80333333333333, 18.392999999999994, 25.224666666666657, 27.458666666666666, 27.69766666666667, 16.937333333333328, 26.787666666666645, 24.24133333333332, 49.38233333333331, 31.7203333333333, 24.537666666666667, 23.318999999999996, 16.43, 36.54166666666666, 17.05633333333333, 42.140999999999984, 44.918999999999976, 18.491666666666674, 33.84699999999999, 23.584999999999997, 32.839, 25.43533333333334, 19.01333333333333, 40.65966666666667, 14.602333333333332, 24.57433333333333, 18.848999999999997, 18.723999999999997, 17.903666666666663, 33.733999999999995, 55.11900000000001, 19.78466666666667, 18.015999999999995, 19.969666666666665, 21.221666666666668, 21.245999999999988, 39.368999999999986, 19.142999999999997, 35.130999999999986, 17.694, 17.085666666666658, 33.626333333333335, 60.04033333333336, 27.46033333333331, 14.877999999999997, 20.235, 17.959333333333326, 43.86233333333335, 17.395333333333333, 35.55633333333331, 50.783333333333346, 44.76366666666668, 21.03533333333333, 30.152333333333328, 21.48133333333331, 15.82033333333333, 29.965666666666653, 23.045333333333325, 15.408666666666663, 26.549666666666642, 28.80166666666667, 27.50566666666667, 17.787999999999993, 32.90833333333334, 61.873000000000026, 15.008, 16.461666666666662, 22.649333333333324, 29.79866666666667, 17.17966666666667, 24.378333333333316, 42.266999999999996, 21.29033333333333, 13.198999999999998, 67.3006666666667, 20.560333333333336, 60.10266666666664, 38.954333333333345, 15.333999999999998, 62.08133333333326, 29.318333333333353, 17.272333333333332, 28.723333333333326, 16.68166666666666, 18.732, 65.95133333333327, 31.815333333333307, 21.410666666666657, 17.011666666666653, 22.251999999999995, 49.935, 19.368999999999996, 20.592333333333332], "episode_lengths": [44, 44, 73, 112, 49, 73, 44, 57, 36, 48, 52, 56, 33, 81, 52, 74, 60, 60, 58, 35, 88, 43, 92, 98, 42, 86, 52, 51, 45, 43, 100, 28, 55, 44, 43, 36, 61, 88, 39, 45, 39, 50, 49, 68, 34, 92, 33, 37, 69, 100, 71, 29, 40, 41, 90, 43, 68, 117, 74, 57, 68, 69, 31, 68, 58, 30, 84, 58, 49, 34, 50, 106, 29, 32, 49, 50, 39, 52, 86, 46, 28, 109, 54, 131, 78, 29, 119, 69, 33, 65, 40, 36, 111, 73, 58, 39, 71, 99, 48, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.590128465532074, "mean_inference_ms": 2.941594600620059, "mean_action_processing_ms": 0.6112327106325274, "mean_env_wait_ms": 0.147501187241225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029242753982543945, "StateBufferConnector_ms": 0.01647186279296875, "ViewRequirementAgentConnector_ms": 0.483992338180542}}, "episode_reward_max": 67.73500000000001, "episode_reward_min": 13.198999999999998, "episode_reward_mean": 28.55977333333333, "episode_len_mean": 59.39, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.429666666666666, 20.38999999999999, 31.653666666666673, 67.73500000000001, 21.092999999999993, 33.93733333333333, 24.583666666666645, 28.80333333333333, 18.392999999999994, 25.224666666666657, 27.458666666666666, 27.69766666666667, 16.937333333333328, 26.787666666666645, 24.24133333333332, 49.38233333333331, 31.7203333333333, 24.537666666666667, 23.318999999999996, 16.43, 36.54166666666666, 17.05633333333333, 42.140999999999984, 44.918999999999976, 18.491666666666674, 33.84699999999999, 23.584999999999997, 32.839, 25.43533333333334, 19.01333333333333, 40.65966666666667, 14.602333333333332, 24.57433333333333, 18.848999999999997, 18.723999999999997, 17.903666666666663, 33.733999999999995, 55.11900000000001, 19.78466666666667, 18.015999999999995, 19.969666666666665, 21.221666666666668, 21.245999999999988, 39.368999999999986, 19.142999999999997, 35.130999999999986, 17.694, 17.085666666666658, 33.626333333333335, 60.04033333333336, 27.46033333333331, 14.877999999999997, 20.235, 17.959333333333326, 43.86233333333335, 17.395333333333333, 35.55633333333331, 50.783333333333346, 44.76366666666668, 21.03533333333333, 30.152333333333328, 21.48133333333331, 15.82033333333333, 29.965666666666653, 23.045333333333325, 15.408666666666663, 26.549666666666642, 28.80166666666667, 27.50566666666667, 17.787999999999993, 32.90833333333334, 61.873000000000026, 15.008, 16.461666666666662, 22.649333333333324, 29.79866666666667, 17.17966666666667, 24.378333333333316, 42.266999999999996, 21.29033333333333, 13.198999999999998, 67.3006666666667, 20.560333333333336, 60.10266666666664, 38.954333333333345, 15.333999999999998, 62.08133333333326, 29.318333333333353, 17.272333333333332, 28.723333333333326, 16.68166666666666, 18.732, 65.95133333333327, 31.815333333333307, 21.410666666666657, 17.011666666666653, 22.251999999999995, 49.935, 19.368999999999996, 20.592333333333332], "episode_lengths": [44, 44, 73, 112, 49, 73, 44, 57, 36, 48, 52, 56, 33, 81, 52, 74, 60, 60, 58, 35, 88, 43, 92, 98, 42, 86, 52, 51, 45, 43, 100, 28, 55, 44, 43, 36, 61, 88, 39, 45, 39, 50, 49, 68, 34, 92, 33, 37, 69, 100, 71, 29, 40, 41, 90, 43, 68, 117, 74, 57, 68, 69, 31, 68, 58, 30, 84, 58, 49, 34, 50, 106, 29, 32, 49, 50, 39, 52, 86, 46, 28, 109, 54, 131, 78, 29, 119, 69, 33, 65, 40, 36, 111, 73, 58, 39, 71, 99, 48, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.590128465532074, "mean_inference_ms": 2.941594600620059, "mean_action_processing_ms": 0.6112327106325274, "mean_env_wait_ms": 0.147501187241225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029242753982543945, "StateBufferConnector_ms": 0.01647186279296875, "ViewRequirementAgentConnector_ms": 0.483992338180542}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.0947146018285, "num_env_steps_trained_throughput_per_sec": 403.0947146018285, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9587.599, "sample_time_ms": 3068.848, "load_time_ms": 0.252, "load_throughput": 15863479.576, "learn_time_ms": 6479.081, "learn_throughput": 617.372, "synch_weights_time_ms": 34.641}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 4743, "training_iteration": 60, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-15-39", "timestamp": 1701998139, "time_this_iter_s": 9.948240756988525, "time_total_s": 1794.0722103118896, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1794.0722103118896, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 79.12307692307692, "ram_util_percent": 86.03076923076924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7985613845960483e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 6.285033226013184, "policy_loss": -0.005502540618181229, "vf_loss": 6.290535926818848, "vf_explained_var": 0.5777321457862854, "kl": 0.00048786954721435905, "entropy": 0.039615556597709656, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 67.3006666666667, "episode_reward_min": 13.198999999999998, "episode_reward_mean": 29.385143333333332, "episode_len_mean": 62.34, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.48133333333331, 15.82033333333333, 29.965666666666653, 23.045333333333325, 15.408666666666663, 26.549666666666642, 28.80166666666667, 27.50566666666667, 17.787999999999993, 32.90833333333334, 61.873000000000026, 15.008, 16.461666666666662, 22.649333333333324, 29.79866666666667, 17.17966666666667, 24.378333333333316, 42.266999999999996, 21.29033333333333, 13.198999999999998, 67.3006666666667, 20.560333333333336, 60.10266666666664, 38.954333333333345, 15.333999999999998, 62.08133333333326, 29.318333333333353, 17.272333333333332, 28.723333333333326, 16.68166666666666, 18.732, 65.95133333333327, 31.815333333333307, 21.410666666666657, 17.011666666666653, 22.251999999999995, 49.935, 19.368999999999996, 20.592333333333332, 48.30533333333335, 34.92933333333333, 36.34833333333332, 20.64633333333333, 40.01599999999999, 19.98099999999999, 17.510666666666665, 24.536666666666658, 30.036999999999992, 15.350999999999994, 40.15799999999997, 28.520999999999994, 19.645999999999983, 16.771333333333327, 14.817999999999996, 21.92433333333333, 18.922333333333327, 18.731666666666662, 23.384000000000004, 16.14433333333333, 31.94866666666664, 39.14466666666665, 35.154666666666664, 15.89733333333333, 32.474000000000004, 61.32266666666667, 24.476999999999986, 19.194, 35.710333333333345, 19.980666666666657, 14.810999999999993, 44.395999999999944, 19.913333333333327, 37.78566666666666, 16.227999999999994, 55.03533333333335, 28.130999999999993, 66.32733333333329, 40.3946666666667, 24.648333333333333, 19.317333333333327, 19.410333333333327, 27.34233333333332, 16.130999999999997, 40.92366666666667, 20.075333333333322, 24.745333333333342, 38.467333333333315, 13.677666666666662, 35.29833333333329, 19.084666666666656, 17.009666666666664, 33.712, 29.809333333333324, 21.210333333333335, 51.07799999999994, 60.943000000000055, 65.33566666666668, 25.94799999999999, 32.50333333333333, 30.056333333333306], "episode_lengths": [69, 31, 68, 58, 30, 84, 58, 49, 34, 50, 106, 29, 32, 49, 50, 39, 52, 86, 46, 28, 109, 54, 131, 78, 29, 119, 69, 33, 65, 40, 36, 111, 73, 58, 39, 71, 99, 48, 40, 91, 87, 96, 40, 61, 50, 38, 45, 73, 37, 99, 62, 63, 40, 33, 46, 42, 36, 53, 36, 81, 101, 69, 31, 89, 117, 48, 39, 64, 52, 32, 99, 38, 102, 31, 113, 58, 99, 87, 52, 40, 54, 63, 34, 64, 40, 52, 93, 29, 94, 36, 32, 60, 70, 46, 110, 120, 107, 59, 59, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5902141585774394, "mean_inference_ms": 2.938466637224351, "mean_action_processing_ms": 0.6109961070656086, "mean_env_wait_ms": 0.147011895559391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0213625431060791, "StateBufferConnector_ms": 0.014698266983032227, "ViewRequirementAgentConnector_ms": 0.4814131259918213}}, "episode_reward_max": 67.3006666666667, "episode_reward_min": 13.198999999999998, "episode_reward_mean": 29.385143333333332, "episode_len_mean": 62.34, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.48133333333331, 15.82033333333333, 29.965666666666653, 23.045333333333325, 15.408666666666663, 26.549666666666642, 28.80166666666667, 27.50566666666667, 17.787999999999993, 32.90833333333334, 61.873000000000026, 15.008, 16.461666666666662, 22.649333333333324, 29.79866666666667, 17.17966666666667, 24.378333333333316, 42.266999999999996, 21.29033333333333, 13.198999999999998, 67.3006666666667, 20.560333333333336, 60.10266666666664, 38.954333333333345, 15.333999999999998, 62.08133333333326, 29.318333333333353, 17.272333333333332, 28.723333333333326, 16.68166666666666, 18.732, 65.95133333333327, 31.815333333333307, 21.410666666666657, 17.011666666666653, 22.251999999999995, 49.935, 19.368999999999996, 20.592333333333332, 48.30533333333335, 34.92933333333333, 36.34833333333332, 20.64633333333333, 40.01599999999999, 19.98099999999999, 17.510666666666665, 24.536666666666658, 30.036999999999992, 15.350999999999994, 40.15799999999997, 28.520999999999994, 19.645999999999983, 16.771333333333327, 14.817999999999996, 21.92433333333333, 18.922333333333327, 18.731666666666662, 23.384000000000004, 16.14433333333333, 31.94866666666664, 39.14466666666665, 35.154666666666664, 15.89733333333333, 32.474000000000004, 61.32266666666667, 24.476999999999986, 19.194, 35.710333333333345, 19.980666666666657, 14.810999999999993, 44.395999999999944, 19.913333333333327, 37.78566666666666, 16.227999999999994, 55.03533333333335, 28.130999999999993, 66.32733333333329, 40.3946666666667, 24.648333333333333, 19.317333333333327, 19.410333333333327, 27.34233333333332, 16.130999999999997, 40.92366666666667, 20.075333333333322, 24.745333333333342, 38.467333333333315, 13.677666666666662, 35.29833333333329, 19.084666666666656, 17.009666666666664, 33.712, 29.809333333333324, 21.210333333333335, 51.07799999999994, 60.943000000000055, 65.33566666666668, 25.94799999999999, 32.50333333333333, 30.056333333333306], "episode_lengths": [69, 31, 68, 58, 30, 84, 58, 49, 34, 50, 106, 29, 32, 49, 50, 39, 52, 86, 46, 28, 109, 54, 131, 78, 29, 119, 69, 33, 65, 40, 36, 111, 73, 58, 39, 71, 99, 48, 40, 91, 87, 96, 40, 61, 50, 38, 45, 73, 37, 99, 62, 63, 40, 33, 46, 42, 36, 53, 36, 81, 101, 69, 31, 89, 117, 48, 39, 64, 52, 32, 99, 38, 102, 31, 113, 58, 99, 87, 52, 40, 54, 63, 34, 64, 40, 52, 93, 29, 94, 36, 32, 60, 70, 46, 110, 120, 107, 59, 59, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5902141585774394, "mean_inference_ms": 2.938466637224351, "mean_action_processing_ms": 0.6109961070656086, "mean_env_wait_ms": 0.147011895559391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0213625431060791, "StateBufferConnector_ms": 0.014698266983032227, "ViewRequirementAgentConnector_ms": 0.4814131259918213}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.026220844044, "num_env_steps_trained_throughput_per_sec": 425.026220844044, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 9590.817, "sample_time_ms": 3059.628, "load_time_ms": 0.352, "load_throughput": 11362058.784, "learn_time_ms": 6491.117, "learn_throughput": 616.227, "synch_weights_time_ms": 35.144}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 4804, "training_iteration": 61, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-15-48", "timestamp": 1701998148, "time_this_iter_s": 9.444316387176514, "time_total_s": 1803.5165266990662, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1803.5165266990662, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 75.57692307692307, "ram_util_percent": 86.75384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.992806922980242e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 6.074574947357178, "policy_loss": -0.004338337108492851, "vf_loss": 6.07891321182251, "vf_explained_var": 0.601952314376831, "kl": 0.0008208224317058921, "entropy": 0.04060875251889229, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 66.32733333333329, "episode_reward_min": 13.677666666666662, "episode_reward_mean": 29.88274999999999, "episode_len_mean": 63.11, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.476999999999986, 19.194, 35.710333333333345, 19.980666666666657, 14.810999999999993, 44.395999999999944, 19.913333333333327, 37.78566666666666, 16.227999999999994, 55.03533333333335, 28.130999999999993, 66.32733333333329, 40.3946666666667, 24.648333333333333, 19.317333333333327, 19.410333333333327, 27.34233333333332, 16.130999999999997, 40.92366666666667, 20.075333333333322, 24.745333333333342, 38.467333333333315, 13.677666666666662, 35.29833333333329, 19.084666666666656, 17.009666666666664, 33.712, 29.809333333333324, 21.210333333333335, 51.07799999999994, 60.943000000000055, 65.33566666666668, 25.94799999999999, 32.50333333333333, 30.056333333333306, 32.76633333333333, 56.684333333333335, 18.84333333333333, 22.060999999999993, 33.459666666666664, 26.294666666666647, 22.834333333333326, 18.368999999999993, 34.306999999999995, 28.59266666666665, 24.99999999999999, 17.445333333333327, 20.763666666666666, 23.207333333333327, 36.28233333333335, 57.951333333333345, 21.577666666666662, 64.52500000000003, 25.947, 13.882666666666664, 17.533, 33.352000000000004, 22.882666666666676, 26.783333333333328, 39.55533333333331, 39.52633333333333, 26.99033333333332, 23.636333333333326, 25.649666666666654, 16.100333333333325, 18.206333333333333, 35.00299999999999, 33.909999999999975, 19.18133333333334, 46.90933333333332, 39.41066666666664, 17.829999999999995, 48.643666666666626, 16.26333333333333, 38.370666666666644, 20.661999999999992, 15.34666666666666, 48.057333333333354, 52.90033333333338, 31.738, 46.748333333333335, 28.194666666666663, 28.51099999999998, 24.995999999999995, 28.594333333333342, 31.18866666666668, 18.837, 37.69866666666663, 42.52433333333333, 36.05366666666667, 17.529666666666664, 15.943000000000001, 18.14499999999999, 15.812666666666665, 32.562333333333314, 28.839333333333315, 18.755333333333326, 23.64099999999999, 35.46399999999999, 13.887666666666664], "episode_lengths": [48, 39, 64, 52, 32, 99, 38, 102, 31, 113, 58, 99, 87, 52, 40, 54, 63, 34, 64, 40, 52, 93, 29, 94, 36, 32, 60, 70, 46, 110, 120, 107, 59, 59, 92, 70, 98, 45, 46, 86, 75, 46, 46, 54, 52, 79, 36, 40, 51, 78, 93, 57, 100, 62, 27, 34, 65, 49, 55, 110, 84, 51, 50, 44, 37, 39, 68, 73, 39, 81, 95, 35, 124, 34, 93, 49, 34, 114, 91, 75, 103, 59, 70, 51, 48, 49, 47, 109, 79, 76, 34, 29, 40, 34, 59, 71, 37, 56, 99, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5887471594257718, "mean_inference_ms": 2.936080033871292, "mean_action_processing_ms": 0.6109519164416907, "mean_env_wait_ms": 0.14700014368045347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018229246139526367, "StateBufferConnector_ms": 0.011429309844970703, "ViewRequirementAgentConnector_ms": 0.4915194511413574}}, "episode_reward_max": 66.32733333333329, "episode_reward_min": 13.677666666666662, "episode_reward_mean": 29.88274999999999, "episode_len_mean": 63.11, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.476999999999986, 19.194, 35.710333333333345, 19.980666666666657, 14.810999999999993, 44.395999999999944, 19.913333333333327, 37.78566666666666, 16.227999999999994, 55.03533333333335, 28.130999999999993, 66.32733333333329, 40.3946666666667, 24.648333333333333, 19.317333333333327, 19.410333333333327, 27.34233333333332, 16.130999999999997, 40.92366666666667, 20.075333333333322, 24.745333333333342, 38.467333333333315, 13.677666666666662, 35.29833333333329, 19.084666666666656, 17.009666666666664, 33.712, 29.809333333333324, 21.210333333333335, 51.07799999999994, 60.943000000000055, 65.33566666666668, 25.94799999999999, 32.50333333333333, 30.056333333333306, 32.76633333333333, 56.684333333333335, 18.84333333333333, 22.060999999999993, 33.459666666666664, 26.294666666666647, 22.834333333333326, 18.368999999999993, 34.306999999999995, 28.59266666666665, 24.99999999999999, 17.445333333333327, 20.763666666666666, 23.207333333333327, 36.28233333333335, 57.951333333333345, 21.577666666666662, 64.52500000000003, 25.947, 13.882666666666664, 17.533, 33.352000000000004, 22.882666666666676, 26.783333333333328, 39.55533333333331, 39.52633333333333, 26.99033333333332, 23.636333333333326, 25.649666666666654, 16.100333333333325, 18.206333333333333, 35.00299999999999, 33.909999999999975, 19.18133333333334, 46.90933333333332, 39.41066666666664, 17.829999999999995, 48.643666666666626, 16.26333333333333, 38.370666666666644, 20.661999999999992, 15.34666666666666, 48.057333333333354, 52.90033333333338, 31.738, 46.748333333333335, 28.194666666666663, 28.51099999999998, 24.995999999999995, 28.594333333333342, 31.18866666666668, 18.837, 37.69866666666663, 42.52433333333333, 36.05366666666667, 17.529666666666664, 15.943000000000001, 18.14499999999999, 15.812666666666665, 32.562333333333314, 28.839333333333315, 18.755333333333326, 23.64099999999999, 35.46399999999999, 13.887666666666664], "episode_lengths": [48, 39, 64, 52, 32, 99, 38, 102, 31, 113, 58, 99, 87, 52, 40, 54, 63, 34, 64, 40, 52, 93, 29, 94, 36, 32, 60, 70, 46, 110, 120, 107, 59, 59, 92, 70, 98, 45, 46, 86, 75, 46, 46, 54, 52, 79, 36, 40, 51, 78, 93, 57, 100, 62, 27, 34, 65, 49, 55, 110, 84, 51, 50, 44, 37, 39, 68, 73, 39, 81, 95, 35, 124, 34, 93, 49, 34, 114, 91, 75, 103, 59, 70, 51, 48, 49, 47, 109, 79, 76, 34, 29, 40, 34, 59, 71, 37, 56, 99, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5887471594257718, "mean_inference_ms": 2.936080033871292, "mean_action_processing_ms": 0.6109519164416907, "mean_env_wait_ms": 0.14700014368045347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018229246139526367, "StateBufferConnector_ms": 0.011429309844970703, "ViewRequirementAgentConnector_ms": 0.4915194511413574}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.7894196602588, "num_env_steps_trained_throughput_per_sec": 422.7894196602588, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 9630.486, "sample_time_ms": 3090.362, "load_time_ms": 0.553, "load_throughput": 7237485.872, "learn_time_ms": 6499.008, "learn_throughput": 615.479, "synch_weights_time_ms": 35.91}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 4869, "training_iteration": 62, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-15-58", "timestamp": 1701998158, "time_this_iter_s": 9.532554864883423, "time_total_s": 1813.0490815639496, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1813.0490815639496, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 79.34615384615387, "ram_util_percent": 86.3923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.496403461490121e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 5.7175374031066895, "policy_loss": -0.0053112138994038105, "vf_loss": 5.722847938537598, "vf_explained_var": 0.585037350654602, "kl": 0.0006971479160711169, "entropy": 0.039661213755607605, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 64.41133333333333, "episode_reward_min": 13.818, "episode_reward_mean": 28.537983333333322, "episode_len_mean": 59.91, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.18133333333334, 46.90933333333332, 39.41066666666664, 17.829999999999995, 48.643666666666626, 16.26333333333333, 38.370666666666644, 20.661999999999992, 15.34666666666666, 48.057333333333354, 52.90033333333338, 31.738, 46.748333333333335, 28.194666666666663, 28.51099999999998, 24.995999999999995, 28.594333333333342, 31.18866666666668, 18.837, 37.69866666666663, 42.52433333333333, 36.05366666666667, 17.529666666666664, 15.943000000000001, 18.14499999999999, 15.812666666666665, 32.562333333333314, 28.839333333333315, 18.755333333333326, 23.64099999999999, 35.46399999999999, 13.887666666666664, 16.717333333333325, 19.55433333333333, 22.097999999999992, 34.62366666666665, 29.74333333333332, 25.194999999999983, 24.459666666666656, 23.117333333333335, 43.41233333333335, 25.833666666666648, 15.217999999999995, 51.76233333333328, 42.22766666666668, 25.554999999999996, 64.41133333333333, 33.96566666666666, 26.06633333333333, 19.275666666666666, 18.122999999999998, 18.644, 54.038999999999994, 22.35833333333333, 32.31199999999999, 23.35866666666666, 22.762999999999995, 19.395333333333333, 26.31633333333332, 25.191333333333315, 34.239666666666665, 37.57666666666664, 18.096999999999998, 19.742, 25.069000000000003, 54.99566666666664, 13.818, 17.775, 16.40266666666666, 53.40833333333332, 24.90566666666667, 17.184999999999995, 50.246333333333304, 16.641999999999996, 38.285333333333334, 40.421666666666674, 16.360333333333326, 17.758666666666663, 22.371666666666666, 21.77099999999999, 38.983000000000004, 50.317000000000036, 37.036666666666655, 24.178333333333303, 24.129333333333335, 18.43233333333333, 23.68466666666666, 26.673999999999992, 36.623999999999974, 16.862666666666666, 16.683999999999997, 24.540000000000006, 25.11733333333333, 28.963999999999974, 33.29100000000001, 39.96433333333335, 17.365, 19.15133333333333, 31.689666666666664, 18.060333333333325], "episode_lengths": [39, 81, 95, 35, 124, 34, 93, 49, 34, 114, 91, 75, 103, 59, 70, 51, 48, 49, 47, 109, 79, 76, 34, 29, 40, 34, 59, 71, 37, 56, 99, 29, 33, 46, 49, 80, 57, 68, 54, 52, 84, 62, 33, 91, 66, 62, 131, 63, 65, 42, 34, 38, 108, 51, 64, 53, 44, 35, 66, 57, 70, 67, 45, 35, 49, 88, 29, 43, 31, 138, 48, 36, 81, 35, 69, 70, 42, 51, 42, 52, 71, 100, 67, 69, 60, 38, 52, 63, 93, 31, 33, 46, 45, 69, 56, 62, 40, 39, 68, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.587918262746606, "mean_inference_ms": 2.941581116594035, "mean_action_processing_ms": 0.6102816588195759, "mean_env_wait_ms": 0.14731179652310847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0160064697265625, "StateBufferConnector_ms": 0.038393497467041016, "ViewRequirementAgentConnector_ms": 0.5456762313842773}}, "episode_reward_max": 64.41133333333333, "episode_reward_min": 13.818, "episode_reward_mean": 28.537983333333322, "episode_len_mean": 59.91, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.18133333333334, 46.90933333333332, 39.41066666666664, 17.829999999999995, 48.643666666666626, 16.26333333333333, 38.370666666666644, 20.661999999999992, 15.34666666666666, 48.057333333333354, 52.90033333333338, 31.738, 46.748333333333335, 28.194666666666663, 28.51099999999998, 24.995999999999995, 28.594333333333342, 31.18866666666668, 18.837, 37.69866666666663, 42.52433333333333, 36.05366666666667, 17.529666666666664, 15.943000000000001, 18.14499999999999, 15.812666666666665, 32.562333333333314, 28.839333333333315, 18.755333333333326, 23.64099999999999, 35.46399999999999, 13.887666666666664, 16.717333333333325, 19.55433333333333, 22.097999999999992, 34.62366666666665, 29.74333333333332, 25.194999999999983, 24.459666666666656, 23.117333333333335, 43.41233333333335, 25.833666666666648, 15.217999999999995, 51.76233333333328, 42.22766666666668, 25.554999999999996, 64.41133333333333, 33.96566666666666, 26.06633333333333, 19.275666666666666, 18.122999999999998, 18.644, 54.038999999999994, 22.35833333333333, 32.31199999999999, 23.35866666666666, 22.762999999999995, 19.395333333333333, 26.31633333333332, 25.191333333333315, 34.239666666666665, 37.57666666666664, 18.096999999999998, 19.742, 25.069000000000003, 54.99566666666664, 13.818, 17.775, 16.40266666666666, 53.40833333333332, 24.90566666666667, 17.184999999999995, 50.246333333333304, 16.641999999999996, 38.285333333333334, 40.421666666666674, 16.360333333333326, 17.758666666666663, 22.371666666666666, 21.77099999999999, 38.983000000000004, 50.317000000000036, 37.036666666666655, 24.178333333333303, 24.129333333333335, 18.43233333333333, 23.68466666666666, 26.673999999999992, 36.623999999999974, 16.862666666666666, 16.683999999999997, 24.540000000000006, 25.11733333333333, 28.963999999999974, 33.29100000000001, 39.96433333333335, 17.365, 19.15133333333333, 31.689666666666664, 18.060333333333325], "episode_lengths": [39, 81, 95, 35, 124, 34, 93, 49, 34, 114, 91, 75, 103, 59, 70, 51, 48, 49, 47, 109, 79, 76, 34, 29, 40, 34, 59, 71, 37, 56, 99, 29, 33, 46, 49, 80, 57, 68, 54, 52, 84, 62, 33, 91, 66, 62, 131, 63, 65, 42, 34, 38, 108, 51, 64, 53, 44, 35, 66, 57, 70, 67, 45, 35, 49, 88, 29, 43, 31, 138, 48, 36, 81, 35, 69, 70, 42, 51, 42, 52, 71, 100, 67, 69, 60, 38, 52, 63, 93, 31, 33, 46, 45, 69, 56, 62, 40, 39, 68, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.587918262746606, "mean_inference_ms": 2.941581116594035, "mean_action_processing_ms": 0.6102816588195759, "mean_env_wait_ms": 0.14731179652310847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0160064697265625, "StateBufferConnector_ms": 0.038393497467041016, "ViewRequirementAgentConnector_ms": 0.5456762313842773}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.48429299375493, "num_env_steps_trained_throughput_per_sec": 401.48429299375493, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 9630.461, "sample_time_ms": 3087.26, "load_time_ms": 0.553, "load_throughput": 7237798.102, "learn_time_ms": 6504.28, "learn_throughput": 614.98, "synch_weights_time_ms": 33.909}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 4937, "training_iteration": 63, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-16-08", "timestamp": 1701998168, "time_this_iter_s": 9.99291729927063, "time_total_s": 1823.0419988632202, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1823.0419988632202, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 81.9, "ram_util_percent": 86.28461538461536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2482017307450604e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 5.644650936126709, "policy_loss": -0.0019064180087298155, "vf_loss": 5.646556854248047, "vf_explained_var": 0.5319005250930786, "kl": 0.0007797345169819891, "entropy": 0.03663067892193794, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 77.63033333333334, "episode_reward_min": 13.65933333333333, "episode_reward_mean": 27.955740000000002, "episode_len_mean": 57.62, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.90566666666667, 17.184999999999995, 50.246333333333304, 16.641999999999996, 38.285333333333334, 40.421666666666674, 16.360333333333326, 17.758666666666663, 22.371666666666666, 21.77099999999999, 38.983000000000004, 50.317000000000036, 37.036666666666655, 24.178333333333303, 24.129333333333335, 18.43233333333333, 23.68466666666666, 26.673999999999992, 36.623999999999974, 16.862666666666666, 16.683999999999997, 24.540000000000006, 25.11733333333333, 28.963999999999974, 33.29100000000001, 39.96433333333335, 17.365, 19.15133333333333, 31.689666666666664, 18.060333333333325, 49.4656666666667, 23.12699999999999, 49.64633333333334, 25.125666666666653, 49.997000000000035, 15.318999999999996, 31.620333333333342, 16.80666666666666, 28.671333333333312, 18.470999999999997, 20.743999999999996, 51.15066666666669, 13.65933333333333, 57.93700000000001, 24.279333333333327, 23.521, 19.109666666666662, 22.458999999999993, 17.727666666666664, 21.852333333333334, 26.043666666666645, 54.42566666666662, 19.12366666666666, 29.569333333333333, 15.506999999999994, 23.03233333333331, 17.854999999999993, 53.01233333333335, 14.131666666666668, 46.75566666666669, 24.47566666666665, 17.173999999999992, 25.108333333333334, 15.848999999999995, 13.992333333333324, 17.238999999999997, 29.166333333333334, 25.658999999999995, 21.502999999999997, 18.487, 26.53766666666667, 57.741999999999976, 38.595666666666666, 24.791000000000007, 19.34066666666666, 21.44066666666666, 30.344333333333317, 30.60366666666665, 27.38566666666666, 23.399, 25.873333333333328, 24.31666666666667, 18.000666666666667, 24.61966666666666, 46.381333333333295, 46.775999999999975, 22.328333333333322, 18.829333333333327, 21.852333333333334, 25.34966666666664, 15.864999999999995, 55.45533333333338, 48.39866666666669, 29.617999999999988, 77.63033333333334, 20.218666666666664, 15.510000000000002, 14.020999999999994, 22.881333333333334, 14.971333333333328], "episode_lengths": [48, 36, 81, 35, 69, 70, 42, 51, 42, 52, 71, 100, 67, 69, 60, 38, 52, 63, 93, 31, 33, 46, 45, 69, 56, 62, 40, 39, 68, 37, 78, 75, 86, 59, 100, 36, 73, 39, 74, 40, 37, 83, 27, 90, 45, 66, 38, 56, 44, 48, 75, 114, 39, 58, 37, 59, 36, 96, 29, 88, 61, 33, 58, 33, 35, 51, 56, 54, 51, 42, 47, 115, 64, 53, 49, 39, 65, 53, 58, 58, 75, 47, 42, 46, 71, 89, 62, 41, 48, 64, 32, 113, 89, 66, 129, 43, 31, 29, 49, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5884390209910746, "mean_inference_ms": 2.9459708794497477, "mean_action_processing_ms": 0.6103782827034822, "mean_env_wait_ms": 0.14739616784625054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015071392059326172, "StateBufferConnector_ms": 0.046292781829833984, "ViewRequirementAgentConnector_ms": 0.5621044635772705}}, "episode_reward_max": 77.63033333333334, "episode_reward_min": 13.65933333333333, "episode_reward_mean": 27.955740000000002, "episode_len_mean": 57.62, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.90566666666667, 17.184999999999995, 50.246333333333304, 16.641999999999996, 38.285333333333334, 40.421666666666674, 16.360333333333326, 17.758666666666663, 22.371666666666666, 21.77099999999999, 38.983000000000004, 50.317000000000036, 37.036666666666655, 24.178333333333303, 24.129333333333335, 18.43233333333333, 23.68466666666666, 26.673999999999992, 36.623999999999974, 16.862666666666666, 16.683999999999997, 24.540000000000006, 25.11733333333333, 28.963999999999974, 33.29100000000001, 39.96433333333335, 17.365, 19.15133333333333, 31.689666666666664, 18.060333333333325, 49.4656666666667, 23.12699999999999, 49.64633333333334, 25.125666666666653, 49.997000000000035, 15.318999999999996, 31.620333333333342, 16.80666666666666, 28.671333333333312, 18.470999999999997, 20.743999999999996, 51.15066666666669, 13.65933333333333, 57.93700000000001, 24.279333333333327, 23.521, 19.109666666666662, 22.458999999999993, 17.727666666666664, 21.852333333333334, 26.043666666666645, 54.42566666666662, 19.12366666666666, 29.569333333333333, 15.506999999999994, 23.03233333333331, 17.854999999999993, 53.01233333333335, 14.131666666666668, 46.75566666666669, 24.47566666666665, 17.173999999999992, 25.108333333333334, 15.848999999999995, 13.992333333333324, 17.238999999999997, 29.166333333333334, 25.658999999999995, 21.502999999999997, 18.487, 26.53766666666667, 57.741999999999976, 38.595666666666666, 24.791000000000007, 19.34066666666666, 21.44066666666666, 30.344333333333317, 30.60366666666665, 27.38566666666666, 23.399, 25.873333333333328, 24.31666666666667, 18.000666666666667, 24.61966666666666, 46.381333333333295, 46.775999999999975, 22.328333333333322, 18.829333333333327, 21.852333333333334, 25.34966666666664, 15.864999999999995, 55.45533333333338, 48.39866666666669, 29.617999999999988, 77.63033333333334, 20.218666666666664, 15.510000000000002, 14.020999999999994, 22.881333333333334, 14.971333333333328], "episode_lengths": [48, 36, 81, 35, 69, 70, 42, 51, 42, 52, 71, 100, 67, 69, 60, 38, 52, 63, 93, 31, 33, 46, 45, 69, 56, 62, 40, 39, 68, 37, 78, 75, 86, 59, 100, 36, 73, 39, 74, 40, 37, 83, 27, 90, 45, 66, 38, 56, 44, 48, 75, 114, 39, 58, 37, 59, 36, 96, 29, 88, 61, 33, 58, 33, 35, 51, 56, 54, 51, 42, 47, 115, 64, 53, 49, 39, 65, 53, 58, 58, 75, 47, 42, 46, 71, 89, 62, 41, 48, 64, 32, 113, 89, 66, 129, 43, 31, 29, 49, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5884390209910746, "mean_inference_ms": 2.9459708794497477, "mean_action_processing_ms": 0.6103782827034822, "mean_env_wait_ms": 0.14739616784625054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015071392059326172, "StateBufferConnector_ms": 0.046292781829833984, "ViewRequirementAgentConnector_ms": 0.5621044635772705}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.8401521942426, "num_env_steps_trained_throughput_per_sec": 435.8401521942426, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 9539.574, "sample_time_ms": 3078.792, "load_time_ms": 0.654, "load_throughput": 6116597.761, "learn_time_ms": 6422.516, "learn_throughput": 622.809, "synch_weights_time_ms": 33.254}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 5007, "training_iteration": 64, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-16-18", "timestamp": 1701998178, "time_this_iter_s": 9.219335317611694, "time_total_s": 1832.261334180832, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1832.261334180832, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 85.97692307692309, "ram_util_percent": 84.62307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 5.9035725593566895, "policy_loss": -0.007721723988652229, "vf_loss": 5.911294460296631, "vf_explained_var": 0.6022035479545593, "kl": 0.00017827711417339742, "entropy": 0.02972094714641571, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 77.63033333333334, "episode_reward_min": 13.992333333333324, "episode_reward_mean": 28.88605, "episode_len_mean": 61.13, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.173999999999992, 25.108333333333334, 15.848999999999995, 13.992333333333324, 17.238999999999997, 29.166333333333334, 25.658999999999995, 21.502999999999997, 18.487, 26.53766666666667, 57.741999999999976, 38.595666666666666, 24.791000000000007, 19.34066666666666, 21.44066666666666, 30.344333333333317, 30.60366666666665, 27.38566666666666, 23.399, 25.873333333333328, 24.31666666666667, 18.000666666666667, 24.61966666666666, 46.381333333333295, 46.775999999999975, 22.328333333333322, 18.829333333333327, 21.852333333333334, 25.34966666666664, 15.864999999999995, 55.45533333333338, 48.39866666666669, 29.617999999999988, 77.63033333333334, 20.218666666666664, 15.510000000000002, 14.020999999999994, 22.881333333333334, 14.971333333333328, 31.995666666666672, 36.22899999999999, 19.670333333333325, 34.737666666666655, 17.009333333333327, 25.736333333333324, 19.01166666666666, 30.945333333333316, 31.216333333333328, 50.35533333333333, 18.43233333333333, 16.51233333333333, 27.548333333333318, 23.571999999999985, 36.179666666666655, 19.093666666666664, 49.69300000000001, 16.66866666666666, 61.809000000000005, 36.216, 18.691333333333322, 59.94166666666668, 32.34033333333331, 22.14133333333332, 23.245333333333317, 28.032000000000004, 32.220999999999975, 36.55666666666665, 20.62366666666666, 17.48966666666666, 17.622666666666657, 56.99099999999998, 19.228999999999985, 34.85833333333333, 40.76833333333333, 27.24166666666665, 31.514333333333326, 19.079333333333327, 28.43400000000001, 37.17999999999998, 37.38900000000003, 25.926000000000002, 26.05999999999998, 28.24633333333332, 29.995666666666658, 47.11500000000001, 37.04599999999999, 26.385666666666665, 36.35466666666665, 16.552666666666667, 20.501999999999992, 21.99833333333333, 44.355666666666636, 27.94866666666665, 15.05366666666666, 22.004333333333328, 24.744666666666664, 45.038, 40.26, 21.235999999999986, 14.30366666666666], "episode_lengths": [33, 58, 33, 35, 51, 56, 54, 51, 42, 47, 115, 64, 53, 49, 39, 65, 53, 58, 58, 75, 47, 42, 46, 71, 89, 62, 41, 48, 64, 32, 113, 89, 66, 129, 43, 31, 29, 49, 31, 64, 72, 55, 84, 31, 56, 52, 69, 69, 85, 40, 34, 60, 71, 101, 40, 78, 38, 114, 61, 64, 102, 70, 50, 59, 57, 79, 75, 46, 34, 37, 106, 42, 62, 82, 72, 55, 52, 67, 95, 74, 51, 58, 52, 53, 82, 77, 64, 89, 37, 75, 56, 88, 71, 30, 58, 49, 102, 85, 41, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5898959530193166, "mean_inference_ms": 2.9457223559658856, "mean_action_processing_ms": 0.6106426506368464, "mean_env_wait_ms": 0.14726780896357913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018015146255493164, "StateBufferConnector_ms": 0.028236865997314453, "ViewRequirementAgentConnector_ms": 0.5238912105560303}}, "episode_reward_max": 77.63033333333334, "episode_reward_min": 13.992333333333324, "episode_reward_mean": 28.88605, "episode_len_mean": 61.13, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.173999999999992, 25.108333333333334, 15.848999999999995, 13.992333333333324, 17.238999999999997, 29.166333333333334, 25.658999999999995, 21.502999999999997, 18.487, 26.53766666666667, 57.741999999999976, 38.595666666666666, 24.791000000000007, 19.34066666666666, 21.44066666666666, 30.344333333333317, 30.60366666666665, 27.38566666666666, 23.399, 25.873333333333328, 24.31666666666667, 18.000666666666667, 24.61966666666666, 46.381333333333295, 46.775999999999975, 22.328333333333322, 18.829333333333327, 21.852333333333334, 25.34966666666664, 15.864999999999995, 55.45533333333338, 48.39866666666669, 29.617999999999988, 77.63033333333334, 20.218666666666664, 15.510000000000002, 14.020999999999994, 22.881333333333334, 14.971333333333328, 31.995666666666672, 36.22899999999999, 19.670333333333325, 34.737666666666655, 17.009333333333327, 25.736333333333324, 19.01166666666666, 30.945333333333316, 31.216333333333328, 50.35533333333333, 18.43233333333333, 16.51233333333333, 27.548333333333318, 23.571999999999985, 36.179666666666655, 19.093666666666664, 49.69300000000001, 16.66866666666666, 61.809000000000005, 36.216, 18.691333333333322, 59.94166666666668, 32.34033333333331, 22.14133333333332, 23.245333333333317, 28.032000000000004, 32.220999999999975, 36.55666666666665, 20.62366666666666, 17.48966666666666, 17.622666666666657, 56.99099999999998, 19.228999999999985, 34.85833333333333, 40.76833333333333, 27.24166666666665, 31.514333333333326, 19.079333333333327, 28.43400000000001, 37.17999999999998, 37.38900000000003, 25.926000000000002, 26.05999999999998, 28.24633333333332, 29.995666666666658, 47.11500000000001, 37.04599999999999, 26.385666666666665, 36.35466666666665, 16.552666666666667, 20.501999999999992, 21.99833333333333, 44.355666666666636, 27.94866666666665, 15.05366666666666, 22.004333333333328, 24.744666666666664, 45.038, 40.26, 21.235999999999986, 14.30366666666666], "episode_lengths": [33, 58, 33, 35, 51, 56, 54, 51, 42, 47, 115, 64, 53, 49, 39, 65, 53, 58, 58, 75, 47, 42, 46, 71, 89, 62, 41, 48, 64, 32, 113, 89, 66, 129, 43, 31, 29, 49, 31, 64, 72, 55, 84, 31, 56, 52, 69, 69, 85, 40, 34, 60, 71, 101, 40, 78, 38, 114, 61, 64, 102, 70, 50, 59, 57, 79, 75, 46, 34, 37, 106, 42, 62, 82, 72, 55, 52, 67, 95, 74, 51, 58, 52, 53, 82, 77, 64, 89, 37, 75, 56, 88, 71, 30, 58, 49, 102, 85, 41, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5898959530193166, "mean_inference_ms": 2.9457223559658856, "mean_action_processing_ms": 0.6106426506368464, "mean_env_wait_ms": 0.14726780896357913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018015146255493164, "StateBufferConnector_ms": 0.028236865997314453, "ViewRequirementAgentConnector_ms": 0.5238912105560303}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.1671030492332, "num_env_steps_trained_throughput_per_sec": 423.1671030492332, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 9560.469, "sample_time_ms": 3096.12, "load_time_ms": 0.654, "load_throughput": 6116597.761, "learn_time_ms": 6425.676, "learn_throughput": 622.503, "synch_weights_time_ms": 33.784}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 5068, "training_iteration": 65, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-16-27", "timestamp": 1701998187, "time_this_iter_s": 9.478537559509277, "time_total_s": 1841.7398717403412, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1841.7398717403412, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 76.72307692307693, "ram_util_percent": 82.58461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.620504326862651e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 5.837497711181641, "policy_loss": -0.0060061197727918625, "vf_loss": 5.843503952026367, "vf_explained_var": 0.5963680148124695, "kl": 0.0004036181198898703, "entropy": 0.022561419755220413, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 57.733666666666686, "episode_reward_min": 14.30366666666666, "episode_reward_mean": 28.956369999999996, "episode_len_mean": 62.15, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.14133333333332, 23.245333333333317, 28.032000000000004, 32.220999999999975, 36.55666666666665, 20.62366666666666, 17.48966666666666, 17.622666666666657, 56.99099999999998, 19.228999999999985, 34.85833333333333, 40.76833333333333, 27.24166666666665, 31.514333333333326, 19.079333333333327, 28.43400000000001, 37.17999999999998, 37.38900000000003, 25.926000000000002, 26.05999999999998, 28.24633333333332, 29.995666666666658, 47.11500000000001, 37.04599999999999, 26.385666666666665, 36.35466666666665, 16.552666666666667, 20.501999999999992, 21.99833333333333, 44.355666666666636, 27.94866666666665, 15.05366666666666, 22.004333333333328, 24.744666666666664, 45.038, 40.26, 21.235999999999986, 14.30366666666666, 36.20366666666667, 20.28499999999999, 34.688999999999986, 21.403666666666663, 28.687333333333317, 21.02533333333333, 26.49033333333333, 17.02933333333333, 14.994999999999996, 52.50066666666668, 16.52399999999999, 44.29199999999997, 23.487333333333325, 16.22166666666666, 32.334333333333305, 28.610000000000007, 19.472999999999995, 30.67099999999999, 19.27433333333333, 25.04366666666665, 42.859000000000016, 33.02366666666667, 27.558666666666664, 25.52799999999999, 15.328999999999995, 26.501666666666658, 16.973666666666663, 26.55433333333332, 15.141333333333328, 33.728, 35.477, 33.571333333333314, 29.763666666666673, 23.563666666666663, 57.733666666666686, 33.63300000000001, 18.01433333333333, 34.12966666666667, 18.863666666666653, 20.715666666666664, 17.690333333333328, 17.39099999999999, 18.922333333333334, 42.361000000000026, 28.383, 40.57033333333335, 55.85933333333334, 25.179333333333332, 51.53100000000004, 42.44899999999998, 23.006666666666664, 38.253666666666675, 25.74433333333334, 16.072666666666667, 21.78233333333332, 55.709666666666664, 26.412666666666652, 39.83566666666666, 36.983, 34.163666666666636, 19.858666666666657, 17.829333333333327], "episode_lengths": [50, 59, 57, 79, 75, 46, 34, 37, 106, 42, 62, 82, 72, 55, 52, 67, 95, 74, 51, 58, 52, 53, 82, 77, 64, 89, 37, 75, 56, 88, 71, 30, 58, 49, 102, 85, 41, 30, 63, 40, 80, 52, 77, 43, 58, 38, 32, 109, 33, 93, 59, 35, 100, 68, 48, 78, 36, 61, 83, 68, 73, 61, 38, 58, 36, 51, 29, 69, 64, 83, 62, 50, 93, 59, 38, 58, 51, 47, 42, 36, 47, 72, 54, 75, 93, 55, 116, 98, 47, 82, 50, 35, 57, 92, 67, 83, 66, 90, 55, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.591560116580698, "mean_inference_ms": 2.95141794876304, "mean_action_processing_ms": 0.6115474460789752, "mean_env_wait_ms": 0.14719107958003166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03103017807006836, "StateBufferConnector_ms": 0.021593332290649414, "ViewRequirementAgentConnector_ms": 0.622856616973877}}, "episode_reward_max": 57.733666666666686, "episode_reward_min": 14.30366666666666, "episode_reward_mean": 28.956369999999996, "episode_len_mean": 62.15, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.14133333333332, 23.245333333333317, 28.032000000000004, 32.220999999999975, 36.55666666666665, 20.62366666666666, 17.48966666666666, 17.622666666666657, 56.99099999999998, 19.228999999999985, 34.85833333333333, 40.76833333333333, 27.24166666666665, 31.514333333333326, 19.079333333333327, 28.43400000000001, 37.17999999999998, 37.38900000000003, 25.926000000000002, 26.05999999999998, 28.24633333333332, 29.995666666666658, 47.11500000000001, 37.04599999999999, 26.385666666666665, 36.35466666666665, 16.552666666666667, 20.501999999999992, 21.99833333333333, 44.355666666666636, 27.94866666666665, 15.05366666666666, 22.004333333333328, 24.744666666666664, 45.038, 40.26, 21.235999999999986, 14.30366666666666, 36.20366666666667, 20.28499999999999, 34.688999999999986, 21.403666666666663, 28.687333333333317, 21.02533333333333, 26.49033333333333, 17.02933333333333, 14.994999999999996, 52.50066666666668, 16.52399999999999, 44.29199999999997, 23.487333333333325, 16.22166666666666, 32.334333333333305, 28.610000000000007, 19.472999999999995, 30.67099999999999, 19.27433333333333, 25.04366666666665, 42.859000000000016, 33.02366666666667, 27.558666666666664, 25.52799999999999, 15.328999999999995, 26.501666666666658, 16.973666666666663, 26.55433333333332, 15.141333333333328, 33.728, 35.477, 33.571333333333314, 29.763666666666673, 23.563666666666663, 57.733666666666686, 33.63300000000001, 18.01433333333333, 34.12966666666667, 18.863666666666653, 20.715666666666664, 17.690333333333328, 17.39099999999999, 18.922333333333334, 42.361000000000026, 28.383, 40.57033333333335, 55.85933333333334, 25.179333333333332, 51.53100000000004, 42.44899999999998, 23.006666666666664, 38.253666666666675, 25.74433333333334, 16.072666666666667, 21.78233333333332, 55.709666666666664, 26.412666666666652, 39.83566666666666, 36.983, 34.163666666666636, 19.858666666666657, 17.829333333333327], "episode_lengths": [50, 59, 57, 79, 75, 46, 34, 37, 106, 42, 62, 82, 72, 55, 52, 67, 95, 74, 51, 58, 52, 53, 82, 77, 64, 89, 37, 75, 56, 88, 71, 30, 58, 49, 102, 85, 41, 30, 63, 40, 80, 52, 77, 43, 58, 38, 32, 109, 33, 93, 59, 35, 100, 68, 48, 78, 36, 61, 83, 68, 73, 61, 38, 58, 36, 51, 29, 69, 64, 83, 62, 50, 93, 59, 38, 58, 51, 47, 42, 36, 47, 72, 54, 75, 93, 55, 116, 98, 47, 82, 50, 35, 57, 92, 67, 83, 66, 90, 55, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.591560116580698, "mean_inference_ms": 2.95141794876304, "mean_action_processing_ms": 0.6115474460789752, "mean_env_wait_ms": 0.14719107958003166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03103017807006836, "StateBufferConnector_ms": 0.021593332290649414, "ViewRequirementAgentConnector_ms": 0.622856616973877}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.47788558087024, "num_env_steps_trained_throughput_per_sec": 389.47788558087024, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 9626.568, "sample_time_ms": 3160.517, "load_time_ms": 0.701, "load_throughput": 5704595.716, "learn_time_ms": 6427.875, "learn_throughput": 622.29, "synch_weights_time_ms": 33.38}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 5130, "training_iteration": 66, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-16-38", "timestamp": 1701998198, "time_this_iter_s": 10.30476427078247, "time_total_s": 1852.0446360111237, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1852.0446360111237, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 79.0, "ram_util_percent": 82.63571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.8102521634313255e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 5.9477009773254395, "policy_loss": 0.004797301720827818, "vf_loss": 5.942903518676758, "vf_explained_var": 0.6406731605529785, "kl": 0.00033322095987387, "entropy": 0.02285475842654705, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 79.32099999999998, "episode_reward_min": 14.545333333333327, "episode_reward_mean": 29.49025, "episode_len_mean": 61.43, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.477, 33.571333333333314, 29.763666666666673, 23.563666666666663, 57.733666666666686, 33.63300000000001, 18.01433333333333, 34.12966666666667, 18.863666666666653, 20.715666666666664, 17.690333333333328, 17.39099999999999, 18.922333333333334, 42.361000000000026, 28.383, 40.57033333333335, 55.85933333333334, 25.179333333333332, 51.53100000000004, 42.44899999999998, 23.006666666666664, 38.253666666666675, 25.74433333333334, 16.072666666666667, 21.78233333333332, 55.709666666666664, 26.412666666666652, 39.83566666666666, 36.983, 34.163666666666636, 19.858666666666657, 17.829333333333327, 72.93333333333335, 46.89566666666663, 27.54233333333332, 26.822333333333322, 21.596999999999994, 24.258666666666663, 14.620666666666668, 24.553666666666665, 22.447, 29.074666666666673, 18.501666666666665, 15.979999999999997, 17.446333333333325, 19.950666666666663, 17.023333333333333, 22.004333333333324, 19.090666666666657, 27.486666666666665, 37.616, 55.75900000000001, 35.91633333333333, 17.648, 44.08199999999997, 23.63966666666665, 21.91999999999999, 20.011999999999997, 17.279999999999998, 27.093333333333327, 39.237000000000016, 14.545333333333327, 20.065999999999992, 15.925999999999995, 35.60033333333334, 56.58033333333335, 26.782999999999998, 27.72333333333332, 18.12699999999999, 37.84199999999998, 25.88366666666667, 16.817999999999998, 79.32099999999998, 39.313333333333325, 21.352999999999994, 28.830999999999992, 15.647999999999993, 16.30666666666666, 16.290333333333326, 18.45933333333333, 20.65533333333332, 29.61233333333332, 20.793666666666663, 61.023333333333305, 26.280666666666676, 49.823666666666675, 21.969999999999985, 24.90366666666667, 26.484999999999996, 44.82933333333335, 31.32499999999999, 16.40366666666666, 41.772333333333336, 23.199666666666662, 16.16433333333333, 17.379666666666665, 34.056, 58.19499999999998, 17.324666666666666, 25.522999999999985], "episode_lengths": [64, 83, 62, 50, 93, 59, 38, 58, 51, 47, 42, 36, 47, 72, 54, 75, 93, 55, 116, 98, 47, 82, 50, 35, 57, 92, 67, 83, 66, 90, 55, 37, 139, 86, 68, 58, 49, 43, 29, 55, 48, 59, 38, 32, 39, 45, 32, 58, 54, 61, 75, 128, 64, 35, 97, 60, 51, 43, 38, 47, 84, 32, 41, 37, 68, 120, 48, 65, 40, 104, 47, 33, 116, 93, 44, 56, 47, 37, 32, 41, 51, 58, 52, 145, 57, 103, 50, 45, 54, 75, 78, 33, 102, 44, 32, 34, 61, 101, 34, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5918081875183885, "mean_inference_ms": 2.955477806679391, "mean_action_processing_ms": 0.6125100815356921, "mean_env_wait_ms": 0.14748697257340276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02150249481201172, "StateBufferConnector_ms": 0.014027118682861328, "ViewRequirementAgentConnector_ms": 0.5598735809326172}}, "episode_reward_max": 79.32099999999998, "episode_reward_min": 14.545333333333327, "episode_reward_mean": 29.49025, "episode_len_mean": 61.43, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.477, 33.571333333333314, 29.763666666666673, 23.563666666666663, 57.733666666666686, 33.63300000000001, 18.01433333333333, 34.12966666666667, 18.863666666666653, 20.715666666666664, 17.690333333333328, 17.39099999999999, 18.922333333333334, 42.361000000000026, 28.383, 40.57033333333335, 55.85933333333334, 25.179333333333332, 51.53100000000004, 42.44899999999998, 23.006666666666664, 38.253666666666675, 25.74433333333334, 16.072666666666667, 21.78233333333332, 55.709666666666664, 26.412666666666652, 39.83566666666666, 36.983, 34.163666666666636, 19.858666666666657, 17.829333333333327, 72.93333333333335, 46.89566666666663, 27.54233333333332, 26.822333333333322, 21.596999999999994, 24.258666666666663, 14.620666666666668, 24.553666666666665, 22.447, 29.074666666666673, 18.501666666666665, 15.979999999999997, 17.446333333333325, 19.950666666666663, 17.023333333333333, 22.004333333333324, 19.090666666666657, 27.486666666666665, 37.616, 55.75900000000001, 35.91633333333333, 17.648, 44.08199999999997, 23.63966666666665, 21.91999999999999, 20.011999999999997, 17.279999999999998, 27.093333333333327, 39.237000000000016, 14.545333333333327, 20.065999999999992, 15.925999999999995, 35.60033333333334, 56.58033333333335, 26.782999999999998, 27.72333333333332, 18.12699999999999, 37.84199999999998, 25.88366666666667, 16.817999999999998, 79.32099999999998, 39.313333333333325, 21.352999999999994, 28.830999999999992, 15.647999999999993, 16.30666666666666, 16.290333333333326, 18.45933333333333, 20.65533333333332, 29.61233333333332, 20.793666666666663, 61.023333333333305, 26.280666666666676, 49.823666666666675, 21.969999999999985, 24.90366666666667, 26.484999999999996, 44.82933333333335, 31.32499999999999, 16.40366666666666, 41.772333333333336, 23.199666666666662, 16.16433333333333, 17.379666666666665, 34.056, 58.19499999999998, 17.324666666666666, 25.522999999999985], "episode_lengths": [64, 83, 62, 50, 93, 59, 38, 58, 51, 47, 42, 36, 47, 72, 54, 75, 93, 55, 116, 98, 47, 82, 50, 35, 57, 92, 67, 83, 66, 90, 55, 37, 139, 86, 68, 58, 49, 43, 29, 55, 48, 59, 38, 32, 39, 45, 32, 58, 54, 61, 75, 128, 64, 35, 97, 60, 51, 43, 38, 47, 84, 32, 41, 37, 68, 120, 48, 65, 40, 104, 47, 33, 116, 93, 44, 56, 47, 37, 32, 41, 51, 58, 52, 145, 57, 103, 50, 45, 54, 75, 78, 33, 102, 44, 32, 34, 61, 101, 34, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5918081875183885, "mean_inference_ms": 2.955477806679391, "mean_action_processing_ms": 0.6125100815356921, "mean_env_wait_ms": 0.14748697257340276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02150249481201172, "StateBufferConnector_ms": 0.014027118682861328, "ViewRequirementAgentConnector_ms": 0.5598735809326172}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.35022692500087, "num_env_steps_trained_throughput_per_sec": 411.35022692500087, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 9617.172, "sample_time_ms": 3149.649, "load_time_ms": 0.794, "load_throughput": 5039110.951, "learn_time_ms": 6430.079, "learn_throughput": 622.076, "synch_weights_time_ms": 32.663}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 5198, "training_iteration": 67, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-16-48", "timestamp": 1701998208, "time_this_iter_s": 9.78017544746399, "time_total_s": 1861.8248114585876, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1861.8248114585876, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 74.44615384615385, "ram_util_percent": 82.29230769230767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4051260817156628e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 6.0519022941589355, "policy_loss": -0.008106435649096966, "vf_loss": 6.0600080490112305, "vf_explained_var": 0.5225143432617188, "kl": 0.00738999480381608, "entropy": 0.040564242750406265, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 82.38899999999998, "episode_reward_min": 14.799666666666662, "episode_reward_mean": 30.335273333333326, "episode_len_mean": 63.09, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.782999999999998, 27.72333333333332, 18.12699999999999, 37.84199999999998, 25.88366666666667, 16.817999999999998, 79.32099999999998, 39.313333333333325, 21.352999999999994, 28.830999999999992, 15.647999999999993, 16.30666666666666, 16.290333333333326, 18.45933333333333, 20.65533333333332, 29.61233333333332, 20.793666666666663, 61.023333333333305, 26.280666666666676, 49.823666666666675, 21.969999999999985, 24.90366666666667, 26.484999999999996, 44.82933333333335, 31.32499999999999, 16.40366666666666, 41.772333333333336, 23.199666666666662, 16.16433333333333, 17.379666666666665, 34.056, 58.19499999999998, 17.324666666666666, 25.522999999999985, 22.842333333333325, 20.033333333333328, 42.7943333333333, 19.930333333333326, 35.00733333333332, 18.540000000000003, 20.65033333333333, 66.8143333333334, 25.642333333333326, 25.543999999999997, 68.96133333333331, 36.27566666666665, 29.53566666666665, 17.74633333333333, 29.71466666666665, 17.75366666666666, 30.326999999999984, 16.683999999999997, 82.38899999999998, 30.618999999999993, 30.25533333333331, 19.040333333333326, 33.416999999999994, 46.860000000000035, 14.942333333333332, 44.85199999999999, 19.46299999999999, 24.230333333333324, 36.66666666666666, 80.92566666666669, 24.025333333333315, 29.032999999999983, 21.477, 54.710666666666704, 34.607, 15.74033333333333, 18.073666666666657, 35.271999999999984, 19.700333333333322, 22.15033333333333, 33.696999999999996, 15.15733333333333, 59.277000000000015, 15.59966666666666, 26.94833333333333, 43.931999999999974, 26.18800000000001, 24.01366666666665, 16.709999999999994, 20.553, 26.296000000000003, 27.775333333333318, 23.955666666666662, 48.212333333333326, 14.799666666666662, 30.745333333333335, 40.739999999999995, 23.933999999999983, 57.28300000000003, 37.33966666666665, 23.27033333333332, 20.537, 16.71833333333333, 32.50166666666667, 26.617666666666665, 21.058], "episode_lengths": [48, 65, 40, 104, 47, 33, 116, 93, 44, 56, 47, 37, 32, 41, 51, 58, 52, 145, 57, 103, 50, 45, 54, 75, 78, 33, 102, 44, 32, 34, 61, 101, 34, 64, 50, 39, 95, 49, 79, 37, 45, 116, 54, 48, 133, 93, 64, 42, 61, 46, 62, 33, 174, 68, 80, 51, 68, 95, 29, 85, 36, 70, 65, 138, 59, 61, 64, 83, 57, 32, 42, 75, 43, 40, 74, 33, 132, 34, 58, 89, 51, 62, 33, 49, 54, 60, 54, 78, 31, 55, 77, 63, 104, 76, 54, 39, 43, 73, 49, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5901175959063698, "mean_inference_ms": 2.9530833544422865, "mean_action_processing_ms": 0.6114306463170063, "mean_env_wait_ms": 0.14732876840478684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017309904098510742, "StateBufferConnector_ms": 0.01677107810974121, "ViewRequirementAgentConnector_ms": 0.4897489547729492}}, "episode_reward_max": 82.38899999999998, "episode_reward_min": 14.799666666666662, "episode_reward_mean": 30.335273333333326, "episode_len_mean": 63.09, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.782999999999998, 27.72333333333332, 18.12699999999999, 37.84199999999998, 25.88366666666667, 16.817999999999998, 79.32099999999998, 39.313333333333325, 21.352999999999994, 28.830999999999992, 15.647999999999993, 16.30666666666666, 16.290333333333326, 18.45933333333333, 20.65533333333332, 29.61233333333332, 20.793666666666663, 61.023333333333305, 26.280666666666676, 49.823666666666675, 21.969999999999985, 24.90366666666667, 26.484999999999996, 44.82933333333335, 31.32499999999999, 16.40366666666666, 41.772333333333336, 23.199666666666662, 16.16433333333333, 17.379666666666665, 34.056, 58.19499999999998, 17.324666666666666, 25.522999999999985, 22.842333333333325, 20.033333333333328, 42.7943333333333, 19.930333333333326, 35.00733333333332, 18.540000000000003, 20.65033333333333, 66.8143333333334, 25.642333333333326, 25.543999999999997, 68.96133333333331, 36.27566666666665, 29.53566666666665, 17.74633333333333, 29.71466666666665, 17.75366666666666, 30.326999999999984, 16.683999999999997, 82.38899999999998, 30.618999999999993, 30.25533333333331, 19.040333333333326, 33.416999999999994, 46.860000000000035, 14.942333333333332, 44.85199999999999, 19.46299999999999, 24.230333333333324, 36.66666666666666, 80.92566666666669, 24.025333333333315, 29.032999999999983, 21.477, 54.710666666666704, 34.607, 15.74033333333333, 18.073666666666657, 35.271999999999984, 19.700333333333322, 22.15033333333333, 33.696999999999996, 15.15733333333333, 59.277000000000015, 15.59966666666666, 26.94833333333333, 43.931999999999974, 26.18800000000001, 24.01366666666665, 16.709999999999994, 20.553, 26.296000000000003, 27.775333333333318, 23.955666666666662, 48.212333333333326, 14.799666666666662, 30.745333333333335, 40.739999999999995, 23.933999999999983, 57.28300000000003, 37.33966666666665, 23.27033333333332, 20.537, 16.71833333333333, 32.50166666666667, 26.617666666666665, 21.058], "episode_lengths": [48, 65, 40, 104, 47, 33, 116, 93, 44, 56, 47, 37, 32, 41, 51, 58, 52, 145, 57, 103, 50, 45, 54, 75, 78, 33, 102, 44, 32, 34, 61, 101, 34, 64, 50, 39, 95, 49, 79, 37, 45, 116, 54, 48, 133, 93, 64, 42, 61, 46, 62, 33, 174, 68, 80, 51, 68, 95, 29, 85, 36, 70, 65, 138, 59, 61, 64, 83, 57, 32, 42, 75, 43, 40, 74, 33, 132, 34, 58, 89, 51, 62, 33, 49, 54, 60, 54, 78, 31, 55, 77, 63, 104, 76, 54, 39, 43, 73, 49, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5901175959063698, "mean_inference_ms": 2.9530833544422865, "mean_action_processing_ms": 0.6114306463170063, "mean_env_wait_ms": 0.14732876840478684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017309904098510742, "StateBufferConnector_ms": 0.01677107810974121, "ViewRequirementAgentConnector_ms": 0.4897489547729492}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.2421044268796, "num_env_steps_trained_throughput_per_sec": 430.2421044268796, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 9635.773, "sample_time_ms": 3149.342, "load_time_ms": 0.883, "load_throughput": 4528630.118, "learn_time_ms": 6449.199, "learn_throughput": 620.232, "synch_weights_time_ms": 32.614}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 5264, "training_iteration": 68, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-16-57", "timestamp": 1701998217, "time_this_iter_s": 9.32412075996399, "time_total_s": 1871.1489322185516, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1871.1489322185516, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 75.35384615384616, "ram_util_percent": 82.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4051260817156628e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 5.5764241218566895, "policy_loss": 0.00520239258185029, "vf_loss": 5.571221351623535, "vf_explained_var": 0.6783599257469177, "kl": 0.0008419773657806218, "entropy": 0.12241697311401367, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 59.277000000000015, "episode_reward_min": 14.300000000000002, "episode_reward_mean": 27.231789999999997, "episode_len_mean": 58.28, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.607, 15.74033333333333, 18.073666666666657, 35.271999999999984, 19.700333333333322, 22.15033333333333, 33.696999999999996, 15.15733333333333, 59.277000000000015, 15.59966666666666, 26.94833333333333, 43.931999999999974, 26.18800000000001, 24.01366666666665, 16.709999999999994, 20.553, 26.296000000000003, 27.775333333333318, 23.955666666666662, 48.212333333333326, 14.799666666666662, 30.745333333333335, 40.739999999999995, 23.933999999999983, 57.28300000000003, 37.33966666666665, 23.27033333333332, 20.537, 16.71833333333333, 32.50166666666667, 26.617666666666665, 21.058, 27.738333333333316, 30.941333333333336, 21.26933333333332, 21.312333333333328, 16.323333333333327, 23.903333333333332, 32.776333333333326, 25.640666666666664, 32.942, 16.812333333333335, 16.879666666666665, 27.43433333333333, 15.861999999999998, 37.33699999999999, 16.014333333333333, 18.053333333333327, 22.311999999999987, 23.974666666666668, 34.677333333333344, 35.666999999999994, 25.109333333333318, 38.28799999999999, 28.27733333333333, 14.300000000000002, 31.913000000000004, 32.19699999999999, 24.314, 38.12933333333335, 41.85566666666667, 30.672333333333327, 27.456999999999987, 33.76233333333332, 25.428999999999977, 33.87833333333332, 15.553666666666663, 18.06299999999999, 18.756333333333334, 20.86466666666666, 17.700666666666663, 54.27366666666665, 25.691666666666652, 15.635666666666665, 19.69299999999998, 25.79966666666666, 31.342666666666656, 35.943666666666665, 42.11033333333334, 31.307333333333332, 19.598999999999997, 21.91866666666667, 29.205666666666655, 27.09599999999998, 14.987999999999996, 34.32500000000001, 42.64266666666666, 18.21066666666666, 25.202999999999978, 20.241666666666664, 22.34899999999999, 20.74766666666666, 17.974666666666668, 48.20400000000001, 15.038666666666666, 34.00866666666666, 36.48933333333332, 37.85433333333333, 18.116666666666667, 23.372333333333312], "episode_lengths": [57, 32, 42, 75, 43, 40, 74, 33, 132, 34, 58, 89, 51, 62, 33, 49, 54, 60, 54, 78, 31, 55, 77, 63, 104, 76, 54, 39, 43, 73, 49, 47, 76, 61, 51, 38, 40, 45, 61, 53, 68, 38, 38, 56, 41, 86, 32, 35, 45, 54, 72, 73, 59, 68, 73, 27, 68, 57, 58, 71, 98, 69, 53, 63, 68, 102, 33, 50, 38, 51, 38, 120, 65, 45, 59, 53, 74, 68, 60, 64, 38, 45, 58, 71, 35, 82, 91, 43, 65, 40, 56, 45, 36, 88, 32, 72, 67, 80, 37, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5893727350498192, "mean_inference_ms": 2.9504002285286437, "mean_action_processing_ms": 0.6115527156754134, "mean_env_wait_ms": 0.14734977724911105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018291234970092773, "StateBufferConnector_ms": 0.013516902923583984, "ViewRequirementAgentConnector_ms": 0.48935723304748535}}, "episode_reward_max": 59.277000000000015, "episode_reward_min": 14.300000000000002, "episode_reward_mean": 27.231789999999997, "episode_len_mean": 58.28, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.607, 15.74033333333333, 18.073666666666657, 35.271999999999984, 19.700333333333322, 22.15033333333333, 33.696999999999996, 15.15733333333333, 59.277000000000015, 15.59966666666666, 26.94833333333333, 43.931999999999974, 26.18800000000001, 24.01366666666665, 16.709999999999994, 20.553, 26.296000000000003, 27.775333333333318, 23.955666666666662, 48.212333333333326, 14.799666666666662, 30.745333333333335, 40.739999999999995, 23.933999999999983, 57.28300000000003, 37.33966666666665, 23.27033333333332, 20.537, 16.71833333333333, 32.50166666666667, 26.617666666666665, 21.058, 27.738333333333316, 30.941333333333336, 21.26933333333332, 21.312333333333328, 16.323333333333327, 23.903333333333332, 32.776333333333326, 25.640666666666664, 32.942, 16.812333333333335, 16.879666666666665, 27.43433333333333, 15.861999999999998, 37.33699999999999, 16.014333333333333, 18.053333333333327, 22.311999999999987, 23.974666666666668, 34.677333333333344, 35.666999999999994, 25.109333333333318, 38.28799999999999, 28.27733333333333, 14.300000000000002, 31.913000000000004, 32.19699999999999, 24.314, 38.12933333333335, 41.85566666666667, 30.672333333333327, 27.456999999999987, 33.76233333333332, 25.428999999999977, 33.87833333333332, 15.553666666666663, 18.06299999999999, 18.756333333333334, 20.86466666666666, 17.700666666666663, 54.27366666666665, 25.691666666666652, 15.635666666666665, 19.69299999999998, 25.79966666666666, 31.342666666666656, 35.943666666666665, 42.11033333333334, 31.307333333333332, 19.598999999999997, 21.91866666666667, 29.205666666666655, 27.09599999999998, 14.987999999999996, 34.32500000000001, 42.64266666666666, 18.21066666666666, 25.202999999999978, 20.241666666666664, 22.34899999999999, 20.74766666666666, 17.974666666666668, 48.20400000000001, 15.038666666666666, 34.00866666666666, 36.48933333333332, 37.85433333333333, 18.116666666666667, 23.372333333333312], "episode_lengths": [57, 32, 42, 75, 43, 40, 74, 33, 132, 34, 58, 89, 51, 62, 33, 49, 54, 60, 54, 78, 31, 55, 77, 63, 104, 76, 54, 39, 43, 73, 49, 47, 76, 61, 51, 38, 40, 45, 61, 53, 68, 38, 38, 56, 41, 86, 32, 35, 45, 54, 72, 73, 59, 68, 73, 27, 68, 57, 58, 71, 98, 69, 53, 63, 68, 102, 33, 50, 38, 51, 38, 120, 65, 45, 59, 53, 74, 68, 60, 64, 38, 45, 58, 71, 35, 82, 91, 43, 65, 40, 56, 45, 36, 88, 32, 72, 67, 80, 37, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5893727350498192, "mean_inference_ms": 2.9504002285286437, "mean_action_processing_ms": 0.6115527156754134, "mean_env_wait_ms": 0.14734977724911105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018291234970092773, "StateBufferConnector_ms": 0.013516902923583984, "ViewRequirementAgentConnector_ms": 0.48935723304748535}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.9386697911881, "num_env_steps_trained_throughput_per_sec": 409.9386697911881, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 9643.55, "sample_time_ms": 3152.491, "load_time_ms": 0.983, "load_throughput": 4069176.813, "learn_time_ms": 6455.248, "learn_throughput": 619.651, "synch_weights_time_ms": 32.395}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 5332, "training_iteration": 69, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-17-07", "timestamp": 1701998227, "time_this_iter_s": 9.786185026168823, "time_total_s": 1880.9351172447205, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1880.9351172447205, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 81.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.025630408578314e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 6.097407341003418, "policy_loss": -0.0074939243495464325, "vf_loss": 6.104901313781738, "vf_explained_var": 0.5057729482650757, "kl": 0.0006878335843794048, "entropy": 0.12211161851882935, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 62.4696666666667, "episode_reward_min": 13.532666666666668, "episode_reward_mean": 28.03357333333333, "episode_len_mean": 58.84, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.553666666666663, 18.06299999999999, 18.756333333333334, 20.86466666666666, 17.700666666666663, 54.27366666666665, 25.691666666666652, 15.635666666666665, 19.69299999999998, 25.79966666666666, 31.342666666666656, 35.943666666666665, 42.11033333333334, 31.307333333333332, 19.598999999999997, 21.91866666666667, 29.205666666666655, 27.09599999999998, 14.987999999999996, 34.32500000000001, 42.64266666666666, 18.21066666666666, 25.202999999999978, 20.241666666666664, 22.34899999999999, 20.74766666666666, 17.974666666666668, 48.20400000000001, 15.038666666666666, 34.00866666666666, 36.48933333333332, 37.85433333333333, 18.116666666666667, 23.372333333333312, 34.60300000000001, 17.37733333333333, 20.86066666666666, 17.46966666666666, 35.2023333333333, 18.485666666666663, 61.458333333333336, 17.279666666666657, 20.406999999999996, 16.302999999999994, 45.51966666666666, 30.73133333333331, 31.82866666666666, 23.32133333333332, 32.5, 13.532666666666668, 62.4696666666667, 19.833999999999996, 22.77966666666666, 15.477, 35.92466666666665, 24.555666666666642, 28.51033333333334, 14.291666666666663, 40.67166666666666, 24.739666666666647, 31.228333333333318, 41.51466666666665, 19.420333333333325, 38.26766666666668, 30.078999999999997, 48.13133333333334, 54.53066666666674, 16.066666666666663, 18.46033333333333, 53.16733333333334, 48.799666666666695, 19.441333333333326, 32.105, 28.761333333333326, 15.19299999999999, 52.26633333333338, 18.576999999999998, 20.818999999999992, 39.58900000000001, 21.383333333333336, 22.285666666666675, 26.35366666666667, 16.410333333333327, 26.020666666666653, 33.66633333333334, 20.772333333333336, 49.46566666666669, 16.20366666666666, 14.197666666666668, 40.35366666666667, 28.408333333333335, 26.033666666666647, 39.84333333333337, 27.070666666666657, 26.10233333333332, 20.153999999999986, 27.11633333333332, 28.38333333333333, 21.471333333333323, 18.787], "episode_lengths": [33, 50, 38, 51, 38, 120, 65, 45, 59, 53, 74, 68, 60, 64, 38, 45, 58, 71, 35, 82, 91, 43, 65, 40, 56, 45, 36, 88, 32, 72, 67, 80, 37, 71, 59, 39, 43, 36, 84, 55, 104, 37, 42, 36, 80, 83, 57, 41, 86, 26, 114, 49, 46, 30, 79, 68, 59, 30, 78, 73, 54, 75, 41, 95, 48, 81, 93, 32, 34, 93, 99, 51, 74, 49, 34, 81, 37, 42, 69, 43, 48, 68, 32, 50, 79, 46, 104, 32, 28, 76, 52, 79, 72, 67, 62, 53, 58, 55, 49, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5895825283766, "mean_inference_ms": 2.949621594960086, "mean_action_processing_ms": 0.6113410120615025, "mean_env_wait_ms": 0.14718863441171082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01960611343383789, "StateBufferConnector_ms": 0.015393495559692383, "ViewRequirementAgentConnector_ms": 0.5098860263824463}}, "episode_reward_max": 62.4696666666667, "episode_reward_min": 13.532666666666668, "episode_reward_mean": 28.03357333333333, "episode_len_mean": 58.84, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.553666666666663, 18.06299999999999, 18.756333333333334, 20.86466666666666, 17.700666666666663, 54.27366666666665, 25.691666666666652, 15.635666666666665, 19.69299999999998, 25.79966666666666, 31.342666666666656, 35.943666666666665, 42.11033333333334, 31.307333333333332, 19.598999999999997, 21.91866666666667, 29.205666666666655, 27.09599999999998, 14.987999999999996, 34.32500000000001, 42.64266666666666, 18.21066666666666, 25.202999999999978, 20.241666666666664, 22.34899999999999, 20.74766666666666, 17.974666666666668, 48.20400000000001, 15.038666666666666, 34.00866666666666, 36.48933333333332, 37.85433333333333, 18.116666666666667, 23.372333333333312, 34.60300000000001, 17.37733333333333, 20.86066666666666, 17.46966666666666, 35.2023333333333, 18.485666666666663, 61.458333333333336, 17.279666666666657, 20.406999999999996, 16.302999999999994, 45.51966666666666, 30.73133333333331, 31.82866666666666, 23.32133333333332, 32.5, 13.532666666666668, 62.4696666666667, 19.833999999999996, 22.77966666666666, 15.477, 35.92466666666665, 24.555666666666642, 28.51033333333334, 14.291666666666663, 40.67166666666666, 24.739666666666647, 31.228333333333318, 41.51466666666665, 19.420333333333325, 38.26766666666668, 30.078999999999997, 48.13133333333334, 54.53066666666674, 16.066666666666663, 18.46033333333333, 53.16733333333334, 48.799666666666695, 19.441333333333326, 32.105, 28.761333333333326, 15.19299999999999, 52.26633333333338, 18.576999999999998, 20.818999999999992, 39.58900000000001, 21.383333333333336, 22.285666666666675, 26.35366666666667, 16.410333333333327, 26.020666666666653, 33.66633333333334, 20.772333333333336, 49.46566666666669, 16.20366666666666, 14.197666666666668, 40.35366666666667, 28.408333333333335, 26.033666666666647, 39.84333333333337, 27.070666666666657, 26.10233333333332, 20.153999999999986, 27.11633333333332, 28.38333333333333, 21.471333333333323, 18.787], "episode_lengths": [33, 50, 38, 51, 38, 120, 65, 45, 59, 53, 74, 68, 60, 64, 38, 45, 58, 71, 35, 82, 91, 43, 65, 40, 56, 45, 36, 88, 32, 72, 67, 80, 37, 71, 59, 39, 43, 36, 84, 55, 104, 37, 42, 36, 80, 83, 57, 41, 86, 26, 114, 49, 46, 30, 79, 68, 59, 30, 78, 73, 54, 75, 41, 95, 48, 81, 93, 32, 34, 93, 99, 51, 74, 49, 34, 81, 37, 42, 69, 43, 48, 68, 32, 50, 79, 46, 104, 32, 28, 76, 52, 79, 72, 67, 62, 53, 58, 55, 49, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5895825283766, "mean_inference_ms": 2.949621594960086, "mean_action_processing_ms": 0.6113410120615025, "mean_env_wait_ms": 0.14718863441171082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01960611343383789, "StateBufferConnector_ms": 0.015393495559692383, "ViewRequirementAgentConnector_ms": 0.5098860263824463}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.60401538707976, "num_env_steps_trained_throughput_per_sec": 414.60401538707976, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 9616.004, "sample_time_ms": 3158.312, "load_time_ms": 0.986, "load_throughput": 4055406.333, "learn_time_ms": 6422.33, "learn_throughput": 622.827, "synch_weights_time_ms": 31.879}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 5398, "training_iteration": 70, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-17-17", "timestamp": 1701998237, "time_this_iter_s": 9.6897873878479, "time_total_s": 1890.6249046325684, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1890.6249046325684, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 76.1076923076923, "ram_util_percent": 82.12307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.512815204289157e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 5.682922840118408, "policy_loss": -0.003861403791233897, "vf_loss": 5.686784267425537, "vf_explained_var": 0.6308029294013977, "kl": 0.022315792739391327, "entropy": 0.1581946462392807, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 94.03500000000001, "episode_reward_min": 13.955333333333332, "episode_reward_mean": 27.239583333333325, "episode_len_mean": 57.82, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.799666666666695, 19.441333333333326, 32.105, 28.761333333333326, 15.19299999999999, 52.26633333333338, 18.576999999999998, 20.818999999999992, 39.58900000000001, 21.383333333333336, 22.285666666666675, 26.35366666666667, 16.410333333333327, 26.020666666666653, 33.66633333333334, 20.772333333333336, 49.46566666666669, 16.20366666666666, 14.197666666666668, 40.35366666666667, 28.408333333333335, 26.033666666666647, 39.84333333333337, 27.070666666666657, 26.10233333333332, 20.153999999999986, 27.11633333333332, 28.38333333333333, 21.471333333333323, 18.787, 38.48033333333332, 26.180999999999997, 28.791999999999994, 60.24033333333341, 18.092000000000006, 17.23866666666666, 56.747999999999976, 17.790666666666656, 27.398999999999987, 36.280666666666654, 33.998333333333306, 25.35566666666666, 25.70333333333334, 19.19933333333333, 21.34866666666666, 53.157000000000046, 32.46033333333332, 42.813666666666656, 18.553, 53.517, 13.955333333333332, 32.6833333333333, 28.612999999999992, 32.18766666666666, 15.953333333333331, 32.251333333333314, 30.871666666666655, 15.636333333333331, 25.826333333333313, 21.300666666666665, 16.600333333333328, 15.272, 21.164999999999996, 94.03500000000001, 25.540333333333326, 14.398333333333333, 22.701666666666657, 18.19699999999999, 14.840999999999998, 20.120999999999988, 23.991666666666664, 14.494333333333332, 37.00099999999997, 23.907999999999994, 19.90299999999999, 14.465333333333332, 33.26566666666667, 20.633666666666663, 16.621333333333332, 27.056333333333335, 20.65366666666666, 24.132666666666655, 29.545666666666662, 31.88999999999999, 19.174, 25.750333333333312, 45.72733333333331, 24.002666666666666, 14.489666666666661, 29.60733333333332, 33.51733333333333, 18.359999999999996, 17.420999999999996, 15.453666666666667, 30.48633333333333, 20.26166666666666, 17.38066666666666, 18.583666666666655, 22.856999999999996, 41.78866666666666], "episode_lengths": [99, 51, 74, 49, 34, 81, 37, 42, 69, 43, 48, 68, 32, 50, 79, 46, 104, 32, 28, 76, 52, 79, 72, 67, 62, 53, 58, 55, 49, 45, 64, 66, 57, 106, 37, 35, 101, 34, 77, 85, 87, 52, 50, 53, 57, 96, 70, 90, 34, 105, 29, 81, 69, 56, 35, 79, 77, 31, 88, 45, 35, 35, 39, 172, 43, 32, 45, 48, 31, 50, 45, 30, 96, 45, 36, 32, 66, 47, 33, 61, 51, 41, 48, 77, 43, 80, 109, 61, 35, 57, 56, 42, 36, 30, 65, 40, 33, 38, 53, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5868218767278515, "mean_inference_ms": 2.947627958613682, "mean_action_processing_ms": 0.6104941770802875, "mean_env_wait_ms": 0.14716631162860977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021527767181396484, "StateBufferConnector_ms": 0.015195846557617188, "ViewRequirementAgentConnector_ms": 0.4821281433105469}}, "episode_reward_max": 94.03500000000001, "episode_reward_min": 13.955333333333332, "episode_reward_mean": 27.239583333333325, "episode_len_mean": 57.82, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.799666666666695, 19.441333333333326, 32.105, 28.761333333333326, 15.19299999999999, 52.26633333333338, 18.576999999999998, 20.818999999999992, 39.58900000000001, 21.383333333333336, 22.285666666666675, 26.35366666666667, 16.410333333333327, 26.020666666666653, 33.66633333333334, 20.772333333333336, 49.46566666666669, 16.20366666666666, 14.197666666666668, 40.35366666666667, 28.408333333333335, 26.033666666666647, 39.84333333333337, 27.070666666666657, 26.10233333333332, 20.153999999999986, 27.11633333333332, 28.38333333333333, 21.471333333333323, 18.787, 38.48033333333332, 26.180999999999997, 28.791999999999994, 60.24033333333341, 18.092000000000006, 17.23866666666666, 56.747999999999976, 17.790666666666656, 27.398999999999987, 36.280666666666654, 33.998333333333306, 25.35566666666666, 25.70333333333334, 19.19933333333333, 21.34866666666666, 53.157000000000046, 32.46033333333332, 42.813666666666656, 18.553, 53.517, 13.955333333333332, 32.6833333333333, 28.612999999999992, 32.18766666666666, 15.953333333333331, 32.251333333333314, 30.871666666666655, 15.636333333333331, 25.826333333333313, 21.300666666666665, 16.600333333333328, 15.272, 21.164999999999996, 94.03500000000001, 25.540333333333326, 14.398333333333333, 22.701666666666657, 18.19699999999999, 14.840999999999998, 20.120999999999988, 23.991666666666664, 14.494333333333332, 37.00099999999997, 23.907999999999994, 19.90299999999999, 14.465333333333332, 33.26566666666667, 20.633666666666663, 16.621333333333332, 27.056333333333335, 20.65366666666666, 24.132666666666655, 29.545666666666662, 31.88999999999999, 19.174, 25.750333333333312, 45.72733333333331, 24.002666666666666, 14.489666666666661, 29.60733333333332, 33.51733333333333, 18.359999999999996, 17.420999999999996, 15.453666666666667, 30.48633333333333, 20.26166666666666, 17.38066666666666, 18.583666666666655, 22.856999999999996, 41.78866666666666], "episode_lengths": [99, 51, 74, 49, 34, 81, 37, 42, 69, 43, 48, 68, 32, 50, 79, 46, 104, 32, 28, 76, 52, 79, 72, 67, 62, 53, 58, 55, 49, 45, 64, 66, 57, 106, 37, 35, 101, 34, 77, 85, 87, 52, 50, 53, 57, 96, 70, 90, 34, 105, 29, 81, 69, 56, 35, 79, 77, 31, 88, 45, 35, 35, 39, 172, 43, 32, 45, 48, 31, 50, 45, 30, 96, 45, 36, 32, 66, 47, 33, 61, 51, 41, 48, 77, 43, 80, 109, 61, 35, 57, 56, 42, 36, 30, 65, 40, 33, 38, 53, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5868218767278515, "mean_inference_ms": 2.947627958613682, "mean_action_processing_ms": 0.6104941770802875, "mean_env_wait_ms": 0.14716631162860977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021527767181396484, "StateBufferConnector_ms": 0.015195846557617188, "ViewRequirementAgentConnector_ms": 0.4821281433105469}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.7249957128603, "num_env_steps_trained_throughput_per_sec": 471.7249957128603, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 9522.837, "sample_time_ms": 3135.901, "load_time_ms": 0.886, "load_throughput": 4512430.339, "learn_time_ms": 6353.173, "learn_throughput": 629.607, "synch_weights_time_ms": 30.38}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 5468, "training_iteration": 71, "trial_id": "ebb9e_00000", "date": "2023-12-07_17-17-25", "timestamp": 1701998245, "time_this_iter_s": 8.501519203186035, "time_total_s": 1899.1264238357544, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1899.1264238357544, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 79.96666666666667, "ram_util_percent": 82.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.269222392843429e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 5.328503608703613, "policy_loss": -0.006231121718883514, "vf_loss": 5.33473539352417, "vf_explained_var": 0.588128387928009, "kl": 0.004938941914588213, "entropy": 0.17463372647762299, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 61.83433333333334, "episode_reward_min": 11.818333333333332, "episode_reward_mean": 24.873376666666662, "episode_len_mean": 54.63, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.907999999999994, 19.90299999999999, 14.465333333333332, 33.26566666666667, 20.633666666666663, 16.621333333333332, 27.056333333333335, 20.65366666666666, 24.132666666666655, 29.545666666666662, 31.88999999999999, 19.174, 25.750333333333312, 45.72733333333331, 24.002666666666666, 14.489666666666661, 29.60733333333332, 33.51733333333333, 18.359999999999996, 17.420999999999996, 15.453666666666667, 30.48633333333333, 20.26166666666666, 17.38066666666666, 18.583666666666655, 22.856999999999996, 41.78866666666666, 34.84766666666667, 14.120666666666663, 25.99033333333332, 19.513333333333335, 20.044666666666668, 15.77833333333333, 26.13499999999998, 13.875000000000004, 15.400000000000002, 21.057999999999986, 20.28466666666666, 31.48266666666668, 12.211333333333334, 33.730333333333334, 25.019999999999996, 25.075333333333337, 15.027666666666665, 41.30366666666667, 27.716666666666654, 12.684333333333333, 29.03633333333333, 22.949666666666666, 31.68399999999999, 18.898, 14.17033333333333, 16.258333333333333, 14.454333333333329, 27.583, 38.308333333333344, 11.818333333333332, 28.982333333333305, 27.86733333333331, 37.562666666666665, 21.32666666666667, 25.653999999999996, 15.618333333333332, 25.92833333333333, 36.59733333333333, 15.512666666666664, 43.109999999999985, 13.941666666666665, 15.197999999999995, 32.07833333333328, 12.086000000000002, 19.604000000000003, 15.381999999999994, 25.34266666666666, 15.303666666666665, 31.329666666666654, 61.83433333333334, 17.733333333333327, 24.04499999999998, 34.67833333333334, 15.251333333333333, 28.871333333333318, 25.58833333333332, 19.253333333333327, 50.219, 36.95099999999999, 20.307333333333332, 14.602666666666662, 20.357999999999986, 18.414999999999996, 41.75733333333339, 43.26866666666666, 14.315999999999999, 22.360999999999994, 20.081666666666663, 33.30533333333331, 52.91933333333339, 26.691333333333326, 35.813, 16.893000000000004], "episode_lengths": [45, 36, 32, 66, 47, 33, 61, 51, 41, 48, 77, 43, 80, 109, 61, 35, 57, 56, 42, 36, 30, 65, 40, 33, 38, 53, 86, 68, 32, 47, 43, 49, 44, 71, 29, 30, 52, 41, 77, 25, 70, 58, 55, 28, 82, 69, 26, 66, 49, 82, 49, 32, 40, 37, 66, 68, 33, 83, 67, 74, 53, 52, 34, 49, 67, 32, 72, 32, 38, 87, 26, 41, 34, 51, 35, 83, 106, 34, 71, 72, 40, 74, 65, 44, 109, 79, 43, 33, 63, 34, 88, 77, 34, 39, 43, 89, 122, 71, 70, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5859481680911747, "mean_inference_ms": 2.9408282686528238, "mean_action_processing_ms": 0.6111943269790798, "mean_env_wait_ms": 0.14703172204357284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015516042709350586, "StateBufferConnector_ms": 0.013794898986816406, "ViewRequirementAgentConnector_ms": 0.47513866424560547}}, "episode_reward_max": 61.83433333333334, "episode_reward_min": 11.818333333333332, "episode_reward_mean": 24.873376666666662, "episode_len_mean": 54.63, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.907999999999994, 19.90299999999999, 14.465333333333332, 33.26566666666667, 20.633666666666663, 16.621333333333332, 27.056333333333335, 20.65366666666666, 24.132666666666655, 29.545666666666662, 31.88999999999999, 19.174, 25.750333333333312, 45.72733333333331, 24.002666666666666, 14.489666666666661, 29.60733333333332, 33.51733333333333, 18.359999999999996, 17.420999999999996, 15.453666666666667, 30.48633333333333, 20.26166666666666, 17.38066666666666, 18.583666666666655, 22.856999999999996, 41.78866666666666, 34.84766666666667, 14.120666666666663, 25.99033333333332, 19.513333333333335, 20.044666666666668, 15.77833333333333, 26.13499999999998, 13.875000000000004, 15.400000000000002, 21.057999999999986, 20.28466666666666, 31.48266666666668, 12.211333333333334, 33.730333333333334, 25.019999999999996, 25.075333333333337, 15.027666666666665, 41.30366666666667, 27.716666666666654, 12.684333333333333, 29.03633333333333, 22.949666666666666, 31.68399999999999, 18.898, 14.17033333333333, 16.258333333333333, 14.454333333333329, 27.583, 38.308333333333344, 11.818333333333332, 28.982333333333305, 27.86733333333331, 37.562666666666665, 21.32666666666667, 25.653999999999996, 15.618333333333332, 25.92833333333333, 36.59733333333333, 15.512666666666664, 43.109999999999985, 13.941666666666665, 15.197999999999995, 32.07833333333328, 12.086000000000002, 19.604000000000003, 15.381999999999994, 25.34266666666666, 15.303666666666665, 31.329666666666654, 61.83433333333334, 17.733333333333327, 24.04499999999998, 34.67833333333334, 15.251333333333333, 28.871333333333318, 25.58833333333332, 19.253333333333327, 50.219, 36.95099999999999, 20.307333333333332, 14.602666666666662, 20.357999999999986, 18.414999999999996, 41.75733333333339, 43.26866666666666, 14.315999999999999, 22.360999999999994, 20.081666666666663, 33.30533333333331, 52.91933333333339, 26.691333333333326, 35.813, 16.893000000000004], "episode_lengths": [45, 36, 32, 66, 47, 33, 61, 51, 41, 48, 77, 43, 80, 109, 61, 35, 57, 56, 42, 36, 30, 65, 40, 33, 38, 53, 86, 68, 32, 47, 43, 49, 44, 71, 29, 30, 52, 41, 77, 25, 70, 58, 55, 28, 82, 69, 26, 66, 49, 82, 49, 32, 40, 37, 66, 68, 33, 83, 67, 74, 53, 52, 34, 49, 67, 32, 72, 32, 38, 87, 26, 41, 34, 51, 35, 83, 106, 34, 71, 72, 40, 74, 65, 44, 109, 79, 43, 33, 63, 34, 88, 77, 34, 39, 43, 89, 122, 71, 70, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5859481680911747, "mean_inference_ms": 2.9408282686528238, "mean_action_processing_ms": 0.6111943269790798, "mean_env_wait_ms": 0.14703172204357284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015516042709350586, "StateBufferConnector_ms": 0.013794898986816406, "ViewRequirementAgentConnector_ms": 0.47513866424560547}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.20419705193033968, "num_env_steps_trained_throughput_per_sec": 0.20419705193033968, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 1967468.879, "sample_time_ms": 3119.657, "load_time_ms": 0.786, "load_throughput": 5090020.327, "learn_time_ms": 1964317.017, "learn_throughput": 2.036, "synch_weights_time_ms": 28.864}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 5541, "training_iteration": 72, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-44-03", "timestamp": 1702017843, "time_this_iter_s": 19597.433967351913, "time_total_s": 21496.560391187668, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21496.560391187668, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 79.07083333333333, "ram_util_percent": 91.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.6346111964217145e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 6.141838550567627, "policy_loss": -0.00028134085005149245, "vf_loss": 6.142119407653809, "vf_explained_var": 0.4122258424758911, "kl": 0.004572631791234016, "entropy": 0.13535133004188538, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 65.47033333333336, "episode_reward_min": 11.894666666666664, "episode_reward_mean": 27.154103333333328, "episode_len_mean": 58.58, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.109999999999985, 13.941666666666665, 15.197999999999995, 32.07833333333328, 12.086000000000002, 19.604000000000003, 15.381999999999994, 25.34266666666666, 15.303666666666665, 31.329666666666654, 61.83433333333334, 17.733333333333327, 24.04499999999998, 34.67833333333334, 15.251333333333333, 28.871333333333318, 25.58833333333332, 19.253333333333327, 50.219, 36.95099999999999, 20.307333333333332, 14.602666666666662, 20.357999999999986, 18.414999999999996, 41.75733333333339, 43.26866666666666, 14.315999999999999, 22.360999999999994, 20.081666666666663, 33.30533333333331, 52.91933333333339, 26.691333333333326, 35.813, 16.893000000000004, 14.882333333333339, 25.750000000000007, 37.908333333333346, 15.837333333333328, 20.946666666666665, 45.866666666666674, 22.59766666666666, 53.48966666666667, 22.035666666666668, 14.639333333333331, 41.25666666666669, 29.614999999999977, 29.04033333333333, 65.47033333333336, 11.894666666666664, 14.51733333333333, 25.656666666666663, 50.75366666666666, 24.70566666666666, 17.60233333333333, 13.735666666666667, 15.900666666666663, 15.42, 14.35733333333333, 13.317666666666666, 28.61166666666665, 23.499333333333343, 44.25766666666665, 18.324666666666655, 19.10266666666666, 21.593999999999994, 57.690000000000026, 16.05533333333333, 29.911333333333342, 14.03233333333333, 13.634666666666662, 27.11899999999999, 20.304333333333325, 14.367999999999995, 31.86366666666668, 18.29999999999999, 50.21366666666664, 43.04366666666665, 29.754666666666623, 48.64433333333337, 23.044333333333324, 44.06933333333332, 16.58766666666666, 23.48099999999999, 31.943333333333314, 31.23366666666665, 18.61266666666666, 21.493666666666662, 19.082999999999988, 50.57133333333331, 13.87033333333333, 23.26066666666666, 17.341999999999988, 22.731999999999996, 25.90533333333332, 27.267333333333333, 23.17033333333334, 28.48666666666666, 32.83599999999999, 16.292666666666662, 57.71333333333334], "episode_lengths": [72, 32, 38, 87, 26, 41, 34, 51, 35, 83, 106, 34, 71, 72, 40, 74, 65, 44, 109, 79, 43, 33, 63, 34, 88, 77, 34, 39, 43, 89, 122, 71, 70, 34, 30, 58, 72, 36, 49, 91, 62, 88, 46, 30, 74, 99, 52, 120, 29, 34, 64, 84, 52, 35, 27, 50, 32, 44, 27, 69, 43, 74, 51, 45, 39, 87, 36, 64, 31, 34, 75, 43, 30, 65, 36, 95, 98, 91, 85, 57, 71, 39, 51, 79, 62, 38, 57, 53, 109, 28, 50, 47, 51, 59, 48, 45, 60, 64, 49, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5872817983259953, "mean_inference_ms": 2.9418427526054245, "mean_action_processing_ms": 0.6101699872798696, "mean_env_wait_ms": 0.14649444668092038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02027583122253418, "StateBufferConnector_ms": 0.008600234985351562, "ViewRequirementAgentConnector_ms": 0.47202396392822266}}, "episode_reward_max": 65.47033333333336, "episode_reward_min": 11.894666666666664, "episode_reward_mean": 27.154103333333328, "episode_len_mean": 58.58, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.109999999999985, 13.941666666666665, 15.197999999999995, 32.07833333333328, 12.086000000000002, 19.604000000000003, 15.381999999999994, 25.34266666666666, 15.303666666666665, 31.329666666666654, 61.83433333333334, 17.733333333333327, 24.04499999999998, 34.67833333333334, 15.251333333333333, 28.871333333333318, 25.58833333333332, 19.253333333333327, 50.219, 36.95099999999999, 20.307333333333332, 14.602666666666662, 20.357999999999986, 18.414999999999996, 41.75733333333339, 43.26866666666666, 14.315999999999999, 22.360999999999994, 20.081666666666663, 33.30533333333331, 52.91933333333339, 26.691333333333326, 35.813, 16.893000000000004, 14.882333333333339, 25.750000000000007, 37.908333333333346, 15.837333333333328, 20.946666666666665, 45.866666666666674, 22.59766666666666, 53.48966666666667, 22.035666666666668, 14.639333333333331, 41.25666666666669, 29.614999999999977, 29.04033333333333, 65.47033333333336, 11.894666666666664, 14.51733333333333, 25.656666666666663, 50.75366666666666, 24.70566666666666, 17.60233333333333, 13.735666666666667, 15.900666666666663, 15.42, 14.35733333333333, 13.317666666666666, 28.61166666666665, 23.499333333333343, 44.25766666666665, 18.324666666666655, 19.10266666666666, 21.593999999999994, 57.690000000000026, 16.05533333333333, 29.911333333333342, 14.03233333333333, 13.634666666666662, 27.11899999999999, 20.304333333333325, 14.367999999999995, 31.86366666666668, 18.29999999999999, 50.21366666666664, 43.04366666666665, 29.754666666666623, 48.64433333333337, 23.044333333333324, 44.06933333333332, 16.58766666666666, 23.48099999999999, 31.943333333333314, 31.23366666666665, 18.61266666666666, 21.493666666666662, 19.082999999999988, 50.57133333333331, 13.87033333333333, 23.26066666666666, 17.341999999999988, 22.731999999999996, 25.90533333333332, 27.267333333333333, 23.17033333333334, 28.48666666666666, 32.83599999999999, 16.292666666666662, 57.71333333333334], "episode_lengths": [72, 32, 38, 87, 26, 41, 34, 51, 35, 83, 106, 34, 71, 72, 40, 74, 65, 44, 109, 79, 43, 33, 63, 34, 88, 77, 34, 39, 43, 89, 122, 71, 70, 34, 30, 58, 72, 36, 49, 91, 62, 88, 46, 30, 74, 99, 52, 120, 29, 34, 64, 84, 52, 35, 27, 50, 32, 44, 27, 69, 43, 74, 51, 45, 39, 87, 36, 64, 31, 34, 75, 43, 30, 65, 36, 95, 98, 91, 85, 57, 71, 39, 51, 79, 62, 38, 57, 53, 109, 28, 50, 47, 51, 59, 48, 45, 60, 64, 49, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5872817983259953, "mean_inference_ms": 2.9418427526054245, "mean_action_processing_ms": 0.6101699872798696, "mean_env_wait_ms": 0.14649444668092038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02027583122253418, "StateBufferConnector_ms": 0.008600234985351562, "ViewRequirementAgentConnector_ms": 0.47202396392822266}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.6410746969635, "num_env_steps_trained_throughput_per_sec": 540.6410746969635, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 1967212.439, "sample_time_ms": 3114.888, "load_time_ms": 0.786, "load_throughput": 5089865.906, "learn_time_ms": 1964065.356, "learn_throughput": 2.037, "synch_weights_time_ms": 28.602}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 5607, "training_iteration": 73, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-44-10", "timestamp": 1702017850, "time_this_iter_s": 7.422618389129639, "time_total_s": 21503.983009576797, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21503.983009576797, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 90.1222222222222, "ram_util_percent": 96.83333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3173055982108573e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 6.0420966148376465, "policy_loss": -0.006169130094349384, "vf_loss": 6.0482659339904785, "vf_explained_var": 0.4977279305458069, "kl": 0.002490716753527522, "entropy": 0.12403899431228638, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 68.65166666666669, "episode_reward_min": 13.188999999999995, "episode_reward_mean": 28.491036666666655, "episode_len_mean": 60.24, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.11899999999999, 20.304333333333325, 14.367999999999995, 31.86366666666668, 18.29999999999999, 50.21366666666664, 43.04366666666665, 29.754666666666623, 48.64433333333337, 23.044333333333324, 44.06933333333332, 16.58766666666666, 23.48099999999999, 31.943333333333314, 31.23366666666665, 18.61266666666666, 21.493666666666662, 19.082999999999988, 50.57133333333331, 13.87033333333333, 23.26066666666666, 17.341999999999988, 22.731999999999996, 25.90533333333332, 27.267333333333333, 23.17033333333334, 28.48666666666666, 32.83599999999999, 16.292666666666662, 57.71333333333334, 39.00033333333329, 36.342000000000006, 17.305999999999994, 39.39733333333335, 25.343666666666664, 68.65166666666669, 14.939666666666659, 19.000999999999998, 19.25666666666667, 13.610333333333337, 38.16866666666666, 27.248000000000008, 24.624666666666656, 30.278999999999996, 18.960999999999995, 37.54533333333332, 29.477000000000004, 53.426000000000016, 56.158666666666676, 17.267999999999997, 15.538999999999996, 42.09633333333331, 33.17966666666665, 14.847999999999994, 20.768666666666643, 29.001333333333307, 19.168333333333326, 26.15600000000001, 17.054999999999996, 24.27899999999999, 41.23899999999998, 22.909999999999997, 13.188999999999995, 41.40899999999999, 27.008999999999997, 14.466, 26.960333333333324, 35.784, 19.314333333333327, 23.891333333333325, 44.507333333333364, 14.773999999999996, 17.785333333333334, 28.11166666666666, 15.989666666666663, 13.432, 28.49666666666665, 66.68533333333335, 14.584666666666664, 17.314999999999998, 26.439999999999994, 18.474999999999998, 21.931333333333328, 32.69399999999999, 49.167000000000016, 18.162000000000003, 20.908666666666665, 16.514333333333333, 19.255333333333326, 16.411333333333328, 32.97266666666663, 60.01299999999995, 22.30066666666666, 53.11233333333334, 16.935, 17.156999999999993, 20.24599999999999, 39.69766666666667, 40.365333333333346, 57.78699999999993], "episode_lengths": [75, 43, 30, 65, 36, 95, 98, 91, 85, 57, 71, 39, 51, 79, 62, 38, 57, 53, 109, 28, 50, 47, 51, 59, 48, 45, 60, 64, 49, 132, 94, 85, 39, 79, 58, 127, 32, 39, 45, 27, 62, 51, 56, 54, 54, 67, 56, 115, 97, 39, 31, 77, 74, 31, 57, 70, 36, 60, 42, 75, 83, 48, 28, 75, 50, 36, 62, 69, 41, 48, 77, 31, 33, 64, 40, 27, 79, 125, 30, 34, 65, 42, 53, 70, 85, 35, 42, 41, 51, 41, 77, 122, 45, 88, 35, 36, 51, 86, 72, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5845671252897222, "mean_inference_ms": 2.9416798326163325, "mean_action_processing_ms": 0.609131891565874, "mean_env_wait_ms": 0.14632972463263857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02302837371826172, "StateBufferConnector_ms": 0.00798797607421875, "ViewRequirementAgentConnector_ms": 0.4119737148284912}}, "episode_reward_max": 68.65166666666669, "episode_reward_min": 13.188999999999995, "episode_reward_mean": 28.491036666666655, "episode_len_mean": 60.24, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.11899999999999, 20.304333333333325, 14.367999999999995, 31.86366666666668, 18.29999999999999, 50.21366666666664, 43.04366666666665, 29.754666666666623, 48.64433333333337, 23.044333333333324, 44.06933333333332, 16.58766666666666, 23.48099999999999, 31.943333333333314, 31.23366666666665, 18.61266666666666, 21.493666666666662, 19.082999999999988, 50.57133333333331, 13.87033333333333, 23.26066666666666, 17.341999999999988, 22.731999999999996, 25.90533333333332, 27.267333333333333, 23.17033333333334, 28.48666666666666, 32.83599999999999, 16.292666666666662, 57.71333333333334, 39.00033333333329, 36.342000000000006, 17.305999999999994, 39.39733333333335, 25.343666666666664, 68.65166666666669, 14.939666666666659, 19.000999999999998, 19.25666666666667, 13.610333333333337, 38.16866666666666, 27.248000000000008, 24.624666666666656, 30.278999999999996, 18.960999999999995, 37.54533333333332, 29.477000000000004, 53.426000000000016, 56.158666666666676, 17.267999999999997, 15.538999999999996, 42.09633333333331, 33.17966666666665, 14.847999999999994, 20.768666666666643, 29.001333333333307, 19.168333333333326, 26.15600000000001, 17.054999999999996, 24.27899999999999, 41.23899999999998, 22.909999999999997, 13.188999999999995, 41.40899999999999, 27.008999999999997, 14.466, 26.960333333333324, 35.784, 19.314333333333327, 23.891333333333325, 44.507333333333364, 14.773999999999996, 17.785333333333334, 28.11166666666666, 15.989666666666663, 13.432, 28.49666666666665, 66.68533333333335, 14.584666666666664, 17.314999999999998, 26.439999999999994, 18.474999999999998, 21.931333333333328, 32.69399999999999, 49.167000000000016, 18.162000000000003, 20.908666666666665, 16.514333333333333, 19.255333333333326, 16.411333333333328, 32.97266666666663, 60.01299999999995, 22.30066666666666, 53.11233333333334, 16.935, 17.156999999999993, 20.24599999999999, 39.69766666666667, 40.365333333333346, 57.78699999999993], "episode_lengths": [75, 43, 30, 65, 36, 95, 98, 91, 85, 57, 71, 39, 51, 79, 62, 38, 57, 53, 109, 28, 50, 47, 51, 59, 48, 45, 60, 64, 49, 132, 94, 85, 39, 79, 58, 127, 32, 39, 45, 27, 62, 51, 56, 54, 54, 67, 56, 115, 97, 39, 31, 77, 74, 31, 57, 70, 36, 60, 42, 75, 83, 48, 28, 75, 50, 36, 62, 69, 41, 48, 77, 31, 33, 64, 40, 27, 79, 125, 30, 34, 65, 42, 53, 70, 85, 35, 42, 41, 51, 41, 77, 122, 45, 88, 35, 36, 51, 86, 72, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5845671252897222, "mean_inference_ms": 2.9416798326163325, "mean_action_processing_ms": 0.609131891565874, "mean_env_wait_ms": 0.14632972463263857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02302837371826172, "StateBufferConnector_ms": 0.00798797607421875, "ViewRequirementAgentConnector_ms": 0.4119737148284912}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.954138244167314, "num_env_steps_trained_throughput_per_sec": 12.954138244167314, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 1997172.935, "sample_time_ms": 3059.722, "load_time_ms": 0.784, "load_throughput": 5099302.757, "learn_time_ms": 1994081.199, "learn_throughput": 2.006, "synch_weights_time_ms": 28.322}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 5677, "training_iteration": 74, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-49-20", "timestamp": 1702018160, "time_this_iter_s": 309.1906397342682, "time_total_s": 21813.173649311066, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21813.173649311066, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 96.33999999999999, "ram_util_percent": 97.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.586527991054286e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 5.660528182983398, "policy_loss": -0.0036039326805621386, "vf_loss": 5.664131164550781, "vf_explained_var": 0.5653995275497437, "kl": 0.0022392836399376392, "entropy": 0.10434749722480774, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 66.68533333333335, "episode_reward_min": 13.432, "episode_reward_mean": 27.68857333333333, "episode_len_mean": 57.75, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.314333333333327, 23.891333333333325, 44.507333333333364, 14.773999999999996, 17.785333333333334, 28.11166666666666, 15.989666666666663, 13.432, 28.49666666666665, 66.68533333333335, 14.584666666666664, 17.314999999999998, 26.439999999999994, 18.474999999999998, 21.931333333333328, 32.69399999999999, 49.167000000000016, 18.162000000000003, 20.908666666666665, 16.514333333333333, 19.255333333333326, 16.411333333333328, 32.97266666666663, 60.01299999999995, 22.30066666666666, 53.11233333333334, 16.935, 17.156999999999993, 20.24599999999999, 39.69766666666667, 40.365333333333346, 57.78699999999993, 22.81733333333332, 22.110333333333323, 16.58833333333333, 61.15066666666669, 36.40466666666666, 26.04666666666667, 19.568999999999992, 17.907666666666664, 33.84100000000001, 43.762999999999984, 18.262333333333327, 13.924333333333333, 18.638666666666655, 34.516333333333314, 17.68033333333333, 15.458666666666668, 33.64233333333333, 29.531000000000006, 39.66033333333335, 18.972999999999995, 45.00533333333335, 51.24999999999996, 21.679666666666666, 27.174666666666663, 30.365333333333325, 17.50833333333333, 20.704666666666657, 19.716666666666665, 47.987333333333325, 40.440333333333314, 22.19699999999999, 35.53666666666666, 17.542333333333332, 26.554333333333318, 18.13833333333333, 25.649, 15.224999999999996, 23.279333333333337, 29.90666666666667, 38.31199999999999, 55.002333333333354, 14.426333333333327, 30.760333333333314, 58.311666666666675, 24.59699999999999, 15.16233333333333, 38.355, 21.45733333333332, 14.66966666666666, 29.61033333333333, 33.12566666666667, 16.186999999999998, 26.041333333333327, 14.26233333333333, 28.551000000000002, 14.088999999999997, 27.080333333333336, 33.57300000000001, 20.54166666666667, 43.265000000000015, 39.488, 15.379999999999999, 27.709999999999997, 17.35933333333333, 14.107666666666669, 36.81866666666666, 19.11399999999999, 19.718999999999994], "episode_lengths": [41, 48, 77, 31, 33, 64, 40, 27, 79, 125, 30, 34, 65, 42, 53, 70, 85, 35, 42, 41, 51, 41, 77, 122, 45, 88, 35, 36, 51, 86, 72, 111, 45, 72, 40, 98, 69, 67, 40, 46, 77, 86, 39, 30, 35, 86, 46, 32, 66, 59, 62, 38, 74, 131, 54, 57, 61, 33, 49, 37, 91, 106, 62, 62, 34, 63, 37, 47, 32, 63, 72, 65, 114, 28, 70, 110, 72, 33, 70, 60, 32, 70, 71, 33, 50, 28, 56, 28, 51, 58, 46, 80, 69, 30, 55, 41, 29, 65, 47, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599000610659715, "mean_inference_ms": 2.969725468545681, "mean_action_processing_ms": 0.6109963713245871, "mean_env_wait_ms": 0.14806348857548438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017994403839111328, "StateBufferConnector_ms": 0.010979413986206055, "ViewRequirementAgentConnector_ms": 0.8665657043457031}}, "episode_reward_max": 66.68533333333335, "episode_reward_min": 13.432, "episode_reward_mean": 27.68857333333333, "episode_len_mean": 57.75, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.314333333333327, 23.891333333333325, 44.507333333333364, 14.773999999999996, 17.785333333333334, 28.11166666666666, 15.989666666666663, 13.432, 28.49666666666665, 66.68533333333335, 14.584666666666664, 17.314999999999998, 26.439999999999994, 18.474999999999998, 21.931333333333328, 32.69399999999999, 49.167000000000016, 18.162000000000003, 20.908666666666665, 16.514333333333333, 19.255333333333326, 16.411333333333328, 32.97266666666663, 60.01299999999995, 22.30066666666666, 53.11233333333334, 16.935, 17.156999999999993, 20.24599999999999, 39.69766666666667, 40.365333333333346, 57.78699999999993, 22.81733333333332, 22.110333333333323, 16.58833333333333, 61.15066666666669, 36.40466666666666, 26.04666666666667, 19.568999999999992, 17.907666666666664, 33.84100000000001, 43.762999999999984, 18.262333333333327, 13.924333333333333, 18.638666666666655, 34.516333333333314, 17.68033333333333, 15.458666666666668, 33.64233333333333, 29.531000000000006, 39.66033333333335, 18.972999999999995, 45.00533333333335, 51.24999999999996, 21.679666666666666, 27.174666666666663, 30.365333333333325, 17.50833333333333, 20.704666666666657, 19.716666666666665, 47.987333333333325, 40.440333333333314, 22.19699999999999, 35.53666666666666, 17.542333333333332, 26.554333333333318, 18.13833333333333, 25.649, 15.224999999999996, 23.279333333333337, 29.90666666666667, 38.31199999999999, 55.002333333333354, 14.426333333333327, 30.760333333333314, 58.311666666666675, 24.59699999999999, 15.16233333333333, 38.355, 21.45733333333332, 14.66966666666666, 29.61033333333333, 33.12566666666667, 16.186999999999998, 26.041333333333327, 14.26233333333333, 28.551000000000002, 14.088999999999997, 27.080333333333336, 33.57300000000001, 20.54166666666667, 43.265000000000015, 39.488, 15.379999999999999, 27.709999999999997, 17.35933333333333, 14.107666666666669, 36.81866666666666, 19.11399999999999, 19.718999999999994], "episode_lengths": [41, 48, 77, 31, 33, 64, 40, 27, 79, 125, 30, 34, 65, 42, 53, 70, 85, 35, 42, 41, 51, 41, 77, 122, 45, 88, 35, 36, 51, 86, 72, 111, 45, 72, 40, 98, 69, 67, 40, 46, 77, 86, 39, 30, 35, 86, 46, 32, 66, 59, 62, 38, 74, 131, 54, 57, 61, 33, 49, 37, 91, 106, 62, 62, 34, 63, 37, 47, 32, 63, 72, 65, 114, 28, 70, 110, 72, 33, 70, 60, 32, 70, 71, 33, 50, 28, 56, 28, 51, 58, 46, 80, 69, 30, 55, 41, 29, 65, 47, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599000610659715, "mean_inference_ms": 2.969725468545681, "mean_action_processing_ms": 0.6109963713245871, "mean_env_wait_ms": 0.14806348857548438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017994403839111328, "StateBufferConnector_ms": 0.010979413986206055, "ViewRequirementAgentConnector_ms": 0.8665657043457031}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.9211106151734, "num_env_steps_trained_throughput_per_sec": 323.9211106151734, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 1997462.55, "sample_time_ms": 3401.994, "load_time_ms": 2.084, "load_throughput": 1919238.583, "learn_time_ms": 1994028.245, "learn_throughput": 2.006, "synch_weights_time_ms": 27.12}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 5745, "training_iteration": 75, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-49-32", "timestamp": 1702018172, "time_this_iter_s": 12.390684843063354, "time_total_s": 21825.56433415413, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21825.56433415413, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 98.4, "ram_util_percent": 96.29285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.293263995527143e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 5.43665885925293, "policy_loss": -0.008668688125908375, "vf_loss": 5.445327281951904, "vf_explained_var": 0.6356394290924072, "kl": 0.0009444990428164601, "entropy": 0.08920758962631226, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 58.311666666666675, "episode_reward_min": 14.088999999999997, "episode_reward_mean": 26.509609999999995, "episode_len_mean": 56.47, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.31199999999999, 55.002333333333354, 14.426333333333327, 30.760333333333314, 58.311666666666675, 24.59699999999999, 15.16233333333333, 38.355, 21.45733333333332, 14.66966666666666, 29.61033333333333, 33.12566666666667, 16.186999999999998, 26.041333333333327, 14.26233333333333, 28.551000000000002, 14.088999999999997, 27.080333333333336, 33.57300000000001, 20.54166666666667, 43.265000000000015, 39.488, 15.379999999999999, 27.709999999999997, 17.35933333333333, 14.107666666666669, 36.81866666666666, 19.11399999999999, 19.718999999999994, 29.066999999999997, 38.11466666666667, 37.52900000000001, 17.424333333333326, 15.289333333333328, 37.159333333333336, 37.334666666666685, 15.01566666666666, 50.82533333333335, 25.791666666666654, 25.65866666666666, 19.93033333333333, 16.344, 14.973333333333333, 30.08599999999999, 16.118000000000002, 26.764999999999976, 26.91366666666667, 21.973999999999993, 15.76233333333333, 15.48433333333333, 27.576333333333345, 22.367333333333335, 22.63499999999999, 23.77866666666665, 45.39433333333331, 27.828333333333315, 21.441333333333326, 18.85266666666666, 22.750999999999994, 20.728999999999992, 34.61233333333334, 37.255666666666684, 23.269333333333325, 17.61566666666666, 32.37366666666667, 23.23233333333332, 24.81, 25.963333333333317, 30.622333333333334, 23.714666666666663, 32.340999999999994, 16.06466666666666, 26.805333333333326, 18.450333333333322, 27.43433333333333, 46.42466666666667, 38.96933333333333, 27.68033333333334, 14.778333333333329, 14.484666666666664, 31.64933333333332, 19.632333333333325, 16.612999999999992, 15.936333333333325, 30.446666666666626, 16.518333333333324, 19.72533333333332, 17.231333333333325, 26.35466666666667, 27.56633333333334, 16.243666666666662, 37.239333333333306, 42.79899999999999, 17.674333333333333, 46.23966666666668, 38.41266666666664, 25.188666666666663, 48.748666666666644, 24.916333333333316, 20.930666666666667], "episode_lengths": [65, 114, 28, 70, 110, 72, 33, 70, 60, 32, 70, 71, 33, 50, 28, 56, 28, 51, 58, 46, 80, 69, 30, 55, 41, 29, 65, 47, 39, 60, 69, 68, 42, 35, 58, 79, 34, 81, 44, 67, 36, 31, 33, 64, 29, 68, 48, 55, 37, 31, 59, 45, 52, 75, 106, 72, 45, 51, 55, 45, 64, 81, 60, 52, 68, 56, 45, 74, 62, 39, 58, 39, 56, 40, 57, 91, 67, 51, 31, 31, 57, 42, 44, 38, 102, 54, 59, 36, 51, 46, 38, 96, 74, 43, 98, 85, 42, 107, 88, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.604157225621908, "mean_inference_ms": 2.982791060153121, "mean_action_processing_ms": 0.610705190079978, "mean_env_wait_ms": 0.14830286603308537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01893925666809082, "StateBufferConnector_ms": 0.007025241851806641, "ViewRequirementAgentConnector_ms": 0.616753101348877}}, "episode_reward_max": 58.311666666666675, "episode_reward_min": 14.088999999999997, "episode_reward_mean": 26.509609999999995, "episode_len_mean": 56.47, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.31199999999999, 55.002333333333354, 14.426333333333327, 30.760333333333314, 58.311666666666675, 24.59699999999999, 15.16233333333333, 38.355, 21.45733333333332, 14.66966666666666, 29.61033333333333, 33.12566666666667, 16.186999999999998, 26.041333333333327, 14.26233333333333, 28.551000000000002, 14.088999999999997, 27.080333333333336, 33.57300000000001, 20.54166666666667, 43.265000000000015, 39.488, 15.379999999999999, 27.709999999999997, 17.35933333333333, 14.107666666666669, 36.81866666666666, 19.11399999999999, 19.718999999999994, 29.066999999999997, 38.11466666666667, 37.52900000000001, 17.424333333333326, 15.289333333333328, 37.159333333333336, 37.334666666666685, 15.01566666666666, 50.82533333333335, 25.791666666666654, 25.65866666666666, 19.93033333333333, 16.344, 14.973333333333333, 30.08599999999999, 16.118000000000002, 26.764999999999976, 26.91366666666667, 21.973999999999993, 15.76233333333333, 15.48433333333333, 27.576333333333345, 22.367333333333335, 22.63499999999999, 23.77866666666665, 45.39433333333331, 27.828333333333315, 21.441333333333326, 18.85266666666666, 22.750999999999994, 20.728999999999992, 34.61233333333334, 37.255666666666684, 23.269333333333325, 17.61566666666666, 32.37366666666667, 23.23233333333332, 24.81, 25.963333333333317, 30.622333333333334, 23.714666666666663, 32.340999999999994, 16.06466666666666, 26.805333333333326, 18.450333333333322, 27.43433333333333, 46.42466666666667, 38.96933333333333, 27.68033333333334, 14.778333333333329, 14.484666666666664, 31.64933333333332, 19.632333333333325, 16.612999999999992, 15.936333333333325, 30.446666666666626, 16.518333333333324, 19.72533333333332, 17.231333333333325, 26.35466666666667, 27.56633333333334, 16.243666666666662, 37.239333333333306, 42.79899999999999, 17.674333333333333, 46.23966666666668, 38.41266666666664, 25.188666666666663, 48.748666666666644, 24.916333333333316, 20.930666666666667], "episode_lengths": [65, 114, 28, 70, 110, 72, 33, 70, 60, 32, 70, 71, 33, 50, 28, 56, 28, 51, 58, 46, 80, 69, 30, 55, 41, 29, 65, 47, 39, 60, 69, 68, 42, 35, 58, 79, 34, 81, 44, 67, 36, 31, 33, 64, 29, 68, 48, 55, 37, 31, 59, 45, 52, 75, 106, 72, 45, 51, 55, 45, 64, 81, 60, 52, 68, 56, 45, 74, 62, 39, 58, 39, 56, 40, 57, 91, 67, 51, 31, 31, 57, 42, 44, 38, 102, 54, 59, 36, 51, 46, 38, 96, 74, 43, 98, 85, 42, 107, 88, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.604157225621908, "mean_inference_ms": 2.982791060153121, "mean_action_processing_ms": 0.610705190079978, "mean_env_wait_ms": 0.14830286603308537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01893925666809082, "StateBufferConnector_ms": 0.007025241851806641, "ViewRequirementAgentConnector_ms": 0.616753101348877}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.7901182697017, "num_env_steps_trained_throughput_per_sec": 516.7901182697017, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 1997209.643, "sample_time_ms": 3334.881, "load_time_ms": 2.084, "load_throughput": 1919326.408, "learn_time_ms": 1993843.752, "learn_throughput": 2.006, "synch_weights_time_ms": 25.925}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 5816, "training_iteration": 76, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-49-40", "timestamp": 1702018180, "time_this_iter_s": 7.774085521697998, "time_total_s": 21833.338419675827, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21833.338419675827, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 95.81, "ram_util_percent": 96.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6466319977635716e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 5.930515766143799, "policy_loss": -0.006472044158726931, "vf_loss": 5.936987400054932, "vf_explained_var": 0.5965760350227356, "kl": 0.0006476641865447164, "entropy": 0.08073735237121582, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 64.34266666666663, "episode_reward_min": 13.406999999999998, "episode_reward_mean": 27.345816666666657, "episode_len_mean": 58.14, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.340999999999994, 16.06466666666666, 26.805333333333326, 18.450333333333322, 27.43433333333333, 46.42466666666667, 38.96933333333333, 27.68033333333334, 14.778333333333329, 14.484666666666664, 31.64933333333332, 19.632333333333325, 16.612999999999992, 15.936333333333325, 30.446666666666626, 16.518333333333324, 19.72533333333332, 17.231333333333325, 26.35466666666667, 27.56633333333334, 16.243666666666662, 37.239333333333306, 42.79899999999999, 17.674333333333333, 46.23966666666668, 38.41266666666664, 25.188666666666663, 48.748666666666644, 24.916333333333316, 20.930666666666667, 26.25366666666666, 34.634999999999984, 23.997999999999994, 25.728, 15.783666666666665, 17.048666666666673, 17.93033333333333, 53.96533333333331, 15.801999999999996, 19.461666666666662, 33.89366666666666, 26.14166666666666, 54.40233333333333, 13.406999999999998, 24.153333333333332, 42.227, 32.82966666666664, 22.73033333333332, 33.586999999999975, 20.21766666666666, 19.034333333333326, 45.46833333333332, 19.880666666666663, 28.904333333333327, 14.859333333333332, 25.76499999999999, 18.784999999999993, 18.468999999999994, 23.057999999999986, 30.73633333333333, 19.743999999999993, 20.550999999999995, 33.976999999999975, 14.554666666666668, 14.530666666666667, 18.445999999999994, 28.610000000000003, 16.48833333333333, 31.400999999999986, 38.32566666666666, 17.44133333333333, 27.453666666666656, 35.39900000000001, 54.477000000000025, 31.684333333333324, 32.306, 21.535666666666657, 16.633333333333333, 29.30666666666666, 24.140333333333327, 18.531666666666663, 64.34266666666663, 25.008333333333344, 31.139333333333337, 26.20366666666667, 23.67199999999999, 23.720999999999993, 20.889333333333326, 16.020666666666664, 25.92366666666666, 53.712000000000025, 21.356333333333335, 17.80233333333333, 30.783666666666647, 43.003666666666625, 28.99466666666667, 44.72133333333335, 36.05766666666666, 23.35366666666666, 29.682333333333332], "episode_lengths": [58, 39, 56, 40, 57, 91, 67, 51, 31, 31, 57, 42, 44, 38, 102, 54, 59, 36, 51, 46, 38, 96, 74, 43, 98, 85, 42, 107, 88, 51, 50, 77, 65, 57, 33, 31, 39, 85, 31, 37, 67, 47, 96, 31, 42, 64, 84, 45, 86, 40, 40, 89, 43, 88, 37, 48, 41, 36, 79, 66, 39, 50, 80, 29, 33, 39, 51, 42, 72, 78, 33, 50, 68, 100, 58, 71, 56, 39, 63, 58, 40, 123, 60, 57, 54, 45, 47, 48, 32, 52, 103, 44, 50, 62, 89, 49, 87, 56, 88, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5994471972577418, "mean_inference_ms": 2.982611579705586, "mean_action_processing_ms": 0.6087456405427164, "mean_env_wait_ms": 0.14778560077334776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972976684570312, "StateBufferConnector_ms": 0.01204061508178711, "ViewRequirementAgentConnector_ms": 0.39302849769592285}}, "episode_reward_max": 64.34266666666663, "episode_reward_min": 13.406999999999998, "episode_reward_mean": 27.345816666666657, "episode_len_mean": 58.14, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.340999999999994, 16.06466666666666, 26.805333333333326, 18.450333333333322, 27.43433333333333, 46.42466666666667, 38.96933333333333, 27.68033333333334, 14.778333333333329, 14.484666666666664, 31.64933333333332, 19.632333333333325, 16.612999999999992, 15.936333333333325, 30.446666666666626, 16.518333333333324, 19.72533333333332, 17.231333333333325, 26.35466666666667, 27.56633333333334, 16.243666666666662, 37.239333333333306, 42.79899999999999, 17.674333333333333, 46.23966666666668, 38.41266666666664, 25.188666666666663, 48.748666666666644, 24.916333333333316, 20.930666666666667, 26.25366666666666, 34.634999999999984, 23.997999999999994, 25.728, 15.783666666666665, 17.048666666666673, 17.93033333333333, 53.96533333333331, 15.801999999999996, 19.461666666666662, 33.89366666666666, 26.14166666666666, 54.40233333333333, 13.406999999999998, 24.153333333333332, 42.227, 32.82966666666664, 22.73033333333332, 33.586999999999975, 20.21766666666666, 19.034333333333326, 45.46833333333332, 19.880666666666663, 28.904333333333327, 14.859333333333332, 25.76499999999999, 18.784999999999993, 18.468999999999994, 23.057999999999986, 30.73633333333333, 19.743999999999993, 20.550999999999995, 33.976999999999975, 14.554666666666668, 14.530666666666667, 18.445999999999994, 28.610000000000003, 16.48833333333333, 31.400999999999986, 38.32566666666666, 17.44133333333333, 27.453666666666656, 35.39900000000001, 54.477000000000025, 31.684333333333324, 32.306, 21.535666666666657, 16.633333333333333, 29.30666666666666, 24.140333333333327, 18.531666666666663, 64.34266666666663, 25.008333333333344, 31.139333333333337, 26.20366666666667, 23.67199999999999, 23.720999999999993, 20.889333333333326, 16.020666666666664, 25.92366666666666, 53.712000000000025, 21.356333333333335, 17.80233333333333, 30.783666666666647, 43.003666666666625, 28.99466666666667, 44.72133333333335, 36.05766666666666, 23.35366666666666, 29.682333333333332], "episode_lengths": [58, 39, 56, 40, 57, 91, 67, 51, 31, 31, 57, 42, 44, 38, 102, 54, 59, 36, 51, 46, 38, 96, 74, 43, 98, 85, 42, 107, 88, 51, 50, 77, 65, 57, 33, 31, 39, 85, 31, 37, 67, 47, 96, 31, 42, 64, 84, 45, 86, 40, 40, 89, 43, 88, 37, 48, 41, 36, 79, 66, 39, 50, 80, 29, 33, 39, 51, 42, 72, 78, 33, 50, 68, 100, 58, 71, 56, 39, 63, 58, 40, 123, 60, 57, 54, 45, 47, 48, 32, 52, 103, 44, 50, 62, 89, 49, 87, 56, 88, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5994471972577418, "mean_inference_ms": 2.982611579705586, "mean_action_processing_ms": 0.6087456405427164, "mean_env_wait_ms": 0.14778560077334776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972976684570312, "StateBufferConnector_ms": 0.01204061508178711, "ViewRequirementAgentConnector_ms": 0.39302849769592285}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.833523408055, "num_env_steps_trained_throughput_per_sec": 521.833523408055, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 1997003.763, "sample_time_ms": 3308.532, "load_time_ms": 2.091, "load_throughput": 1912696.346, "learn_time_ms": 1993666.013, "learn_throughput": 2.006, "synch_weights_time_ms": 24.227}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 5886, "training_iteration": 77, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-49-48", "timestamp": 1702018188, "time_this_iter_s": 7.679271697998047, "time_total_s": 21841.017691373825, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21841.017691373825, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 80.925, "ram_util_percent": 94.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.233159988817858e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 5.8073625564575195, "policy_loss": -0.006318948231637478, "vf_loss": 5.813681125640869, "vf_explained_var": 0.604447603225708, "kl": 0.0007482157088816166, "entropy": 0.06257171928882599, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 66.91033333333334, "episode_reward_min": 14.616000000000001, "episode_reward_mean": 29.256003333333332, "episode_len_mean": 61.01, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.610000000000003, 16.48833333333333, 31.400999999999986, 38.32566666666666, 17.44133333333333, 27.453666666666656, 35.39900000000001, 54.477000000000025, 31.684333333333324, 32.306, 21.535666666666657, 16.633333333333333, 29.30666666666666, 24.140333333333327, 18.531666666666663, 64.34266666666663, 25.008333333333344, 31.139333333333337, 26.20366666666667, 23.67199999999999, 23.720999999999993, 20.889333333333326, 16.020666666666664, 25.92366666666666, 53.712000000000025, 21.356333333333335, 17.80233333333333, 30.783666666666647, 43.003666666666625, 28.99466666666667, 44.72133333333335, 36.05766666666666, 23.35366666666666, 29.682333333333332, 46.318333333333335, 44.14866666666668, 59.69300000000003, 22.793999999999986, 17.796, 21.99466666666665, 15.037333333333333, 22.634333333333327, 22.825333333333326, 19.282999999999994, 15.71033333333333, 19.098666666666674, 42.25766666666662, 17.698999999999995, 24.963666666666654, 29.605000000000015, 46.96699999999998, 44.50733333333334, 27.952666666666666, 28.83933333333332, 36.56166666666667, 46.54966666666666, 20.891333333333332, 22.571333333333325, 15.918666666666665, 23.053000000000004, 16.28533333333333, 25.022333333333336, 25.58433333333333, 58.51299999999999, 15.123666666666661, 19.22699999999999, 26.795999999999975, 27.441999999999993, 29.458999999999996, 20.29999999999999, 38.19233333333332, 31.072000000000003, 29.96866666666666, 29.875666666666657, 18.944333333333333, 49.29133333333334, 16.419666666666664, 37.55966666666667, 20.972333333333324, 20.100999999999992, 23.87733333333333, 19.62366666666666, 19.490333333333336, 20.293333333333333, 25.607333333333326, 39.26933333333334, 36.613, 31.245999999999995, 54.699666666666666, 66.91033333333334, 25.98366666666667, 19.564333333333327, 43.824666666666644, 18.637999999999995, 14.616000000000001, 17.13533333333333, 17.037666666666656, 54.03166666666665, 17.485333333333323, 37.71033333333332], "episode_lengths": [51, 42, 72, 78, 33, 50, 68, 100, 58, 71, 56, 39, 63, 58, 40, 123, 60, 57, 54, 45, 47, 48, 32, 52, 103, 44, 50, 62, 89, 49, 87, 56, 88, 73, 72, 67, 128, 42, 36, 41, 33, 60, 45, 44, 30, 43, 90, 44, 68, 75, 105, 73, 75, 75, 67, 112, 49, 49, 32, 45, 33, 48, 52, 109, 30, 46, 79, 47, 76, 49, 91, 65, 56, 58, 42, 89, 34, 69, 47, 44, 49, 52, 36, 39, 66, 88, 72, 78, 86, 112, 57, 53, 91, 39, 31, 33, 38, 112, 39, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5924930138419071, "mean_inference_ms": 2.97247194965582, "mean_action_processing_ms": 0.6061859313865132, "mean_env_wait_ms": 0.14735655225178446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013011693954467773, "StateBufferConnector_ms": 0.010996341705322266, "ViewRequirementAgentConnector_ms": 0.34400510787963867}}, "episode_reward_max": 66.91033333333334, "episode_reward_min": 14.616000000000001, "episode_reward_mean": 29.256003333333332, "episode_len_mean": 61.01, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.610000000000003, 16.48833333333333, 31.400999999999986, 38.32566666666666, 17.44133333333333, 27.453666666666656, 35.39900000000001, 54.477000000000025, 31.684333333333324, 32.306, 21.535666666666657, 16.633333333333333, 29.30666666666666, 24.140333333333327, 18.531666666666663, 64.34266666666663, 25.008333333333344, 31.139333333333337, 26.20366666666667, 23.67199999999999, 23.720999999999993, 20.889333333333326, 16.020666666666664, 25.92366666666666, 53.712000000000025, 21.356333333333335, 17.80233333333333, 30.783666666666647, 43.003666666666625, 28.99466666666667, 44.72133333333335, 36.05766666666666, 23.35366666666666, 29.682333333333332, 46.318333333333335, 44.14866666666668, 59.69300000000003, 22.793999999999986, 17.796, 21.99466666666665, 15.037333333333333, 22.634333333333327, 22.825333333333326, 19.282999999999994, 15.71033333333333, 19.098666666666674, 42.25766666666662, 17.698999999999995, 24.963666666666654, 29.605000000000015, 46.96699999999998, 44.50733333333334, 27.952666666666666, 28.83933333333332, 36.56166666666667, 46.54966666666666, 20.891333333333332, 22.571333333333325, 15.918666666666665, 23.053000000000004, 16.28533333333333, 25.022333333333336, 25.58433333333333, 58.51299999999999, 15.123666666666661, 19.22699999999999, 26.795999999999975, 27.441999999999993, 29.458999999999996, 20.29999999999999, 38.19233333333332, 31.072000000000003, 29.96866666666666, 29.875666666666657, 18.944333333333333, 49.29133333333334, 16.419666666666664, 37.55966666666667, 20.972333333333324, 20.100999999999992, 23.87733333333333, 19.62366666666666, 19.490333333333336, 20.293333333333333, 25.607333333333326, 39.26933333333334, 36.613, 31.245999999999995, 54.699666666666666, 66.91033333333334, 25.98366666666667, 19.564333333333327, 43.824666666666644, 18.637999999999995, 14.616000000000001, 17.13533333333333, 17.037666666666656, 54.03166666666665, 17.485333333333323, 37.71033333333332], "episode_lengths": [51, 42, 72, 78, 33, 50, 68, 100, 58, 71, 56, 39, 63, 58, 40, 123, 60, 57, 54, 45, 47, 48, 32, 52, 103, 44, 50, 62, 89, 49, 87, 56, 88, 73, 72, 67, 128, 42, 36, 41, 33, 60, 45, 44, 30, 43, 90, 44, 68, 75, 105, 73, 75, 75, 67, 112, 49, 49, 32, 45, 33, 48, 52, 109, 30, 46, 79, 47, 76, 49, 91, 65, 56, 58, 42, 89, 34, 69, 47, 44, 49, 52, 36, 39, 66, 88, 72, 78, 86, 112, 57, 53, 91, 39, 31, 33, 38, 112, 39, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5924930138419071, "mean_inference_ms": 2.97247194965582, "mean_action_processing_ms": 0.6061859313865132, "mean_env_wait_ms": 0.14735655225178446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013011693954467773, "StateBufferConnector_ms": 0.010996341705322266, "ViewRequirementAgentConnector_ms": 0.34400510787963867}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 626.0743687065213, "num_env_steps_trained_throughput_per_sec": 626.0743687065213, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 1996712.956, "sample_time_ms": 3208.701, "load_time_ms": 2.102, "load_throughput": 1903149.68, "learn_time_ms": 1993476.376, "learn_throughput": 2.007, "synch_weights_time_ms": 22.575}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 5952, "training_iteration": 78, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-49-54", "timestamp": 1702018194, "time_this_iter_s": 6.406003475189209, "time_total_s": 21847.423694849014, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21847.423694849014, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 83.22500000000001, "ram_util_percent": 94.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.116579994408929e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 6.395581245422363, "policy_loss": -0.002806533593684435, "vf_loss": 6.398387432098389, "vf_explained_var": 0.5850030183792114, "kl": 0.0006382323917932808, "entropy": 0.049568548798561096, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 78.66000000000007, "episode_reward_min": 14.616000000000001, "episode_reward_mean": 30.233493333333335, "episode_len_mean": 62.96, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.053000000000004, 16.28533333333333, 25.022333333333336, 25.58433333333333, 58.51299999999999, 15.123666666666661, 19.22699999999999, 26.795999999999975, 27.441999999999993, 29.458999999999996, 20.29999999999999, 38.19233333333332, 31.072000000000003, 29.96866666666666, 29.875666666666657, 18.944333333333333, 49.29133333333334, 16.419666666666664, 37.55966666666667, 20.972333333333324, 20.100999999999992, 23.87733333333333, 19.62366666666666, 19.490333333333336, 20.293333333333333, 25.607333333333326, 39.26933333333334, 36.613, 31.245999999999995, 54.699666666666666, 66.91033333333334, 25.98366666666667, 19.564333333333327, 43.824666666666644, 18.637999999999995, 14.616000000000001, 17.13533333333333, 17.037666666666656, 54.03166666666665, 17.485333333333323, 37.71033333333332, 28.637, 26.25633333333333, 25.16266666666666, 37.79766666666666, 16.12866666666666, 24.00966666666665, 17.36366666666666, 36.53199999999998, 20.427666666666667, 19.709333333333333, 39.87533333333335, 14.876, 71.73200000000006, 48.02200000000001, 50.202, 78.66000000000007, 33.59066666666666, 15.788333333333334, 21.649666666666654, 18.075666666666663, 28.86499999999999, 35.66666666666667, 30.27266666666664, 45.11266666666668, 23.925666666666675, 19.34233333333333, 27.40733333333333, 51.61233333333333, 20.565333333333324, 44.897000000000006, 31.270000000000007, 30.54066666666666, 27.480333333333316, 30.09633333333331, 33.95333333333331, 65.81233333333336, 40.56066666666665, 39.78700000000003, 19.441666666666656, 29.160333333333327, 24.25199999999999, 63.73833333333336, 17.709666666666664, 32.81133333333334, 17.782999999999998, 48.20066666666666, 17.557333333333332, 30.131999999999987, 29.08200000000001, 30.945, 20.102666666666657, 21.52733333333332, 17.88533333333333, 15.643333333333326, 17.271999999999995, 20.852333333333316, 23.09466666666666, 41.937333333333314, 29.69699999999999], "episode_lengths": [45, 33, 48, 52, 109, 30, 46, 79, 47, 76, 49, 91, 65, 56, 58, 42, 89, 34, 69, 47, 44, 49, 52, 36, 39, 66, 88, 72, 78, 86, 112, 57, 53, 91, 39, 31, 33, 38, 112, 39, 68, 71, 54, 67, 63, 35, 58, 54, 71, 36, 41, 84, 31, 115, 90, 115, 135, 63, 33, 40, 34, 63, 71, 79, 79, 46, 40, 54, 108, 43, 94, 57, 79, 68, 84, 63, 127, 87, 72, 41, 73, 57, 110, 36, 59, 32, 118, 34, 57, 65, 58, 48, 43, 37, 33, 49, 46, 59, 103, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5865306685316631, "mean_inference_ms": 2.963937880115949, "mean_action_processing_ms": 0.6039499550006826, "mean_env_wait_ms": 0.14702890293704296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018070459365844727, "StateBufferConnector_ms": 0.014988422393798828, "ViewRequirementAgentConnector_ms": 0.3479604721069336}}, "episode_reward_max": 78.66000000000007, "episode_reward_min": 14.616000000000001, "episode_reward_mean": 30.233493333333335, "episode_len_mean": 62.96, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.053000000000004, 16.28533333333333, 25.022333333333336, 25.58433333333333, 58.51299999999999, 15.123666666666661, 19.22699999999999, 26.795999999999975, 27.441999999999993, 29.458999999999996, 20.29999999999999, 38.19233333333332, 31.072000000000003, 29.96866666666666, 29.875666666666657, 18.944333333333333, 49.29133333333334, 16.419666666666664, 37.55966666666667, 20.972333333333324, 20.100999999999992, 23.87733333333333, 19.62366666666666, 19.490333333333336, 20.293333333333333, 25.607333333333326, 39.26933333333334, 36.613, 31.245999999999995, 54.699666666666666, 66.91033333333334, 25.98366666666667, 19.564333333333327, 43.824666666666644, 18.637999999999995, 14.616000000000001, 17.13533333333333, 17.037666666666656, 54.03166666666665, 17.485333333333323, 37.71033333333332, 28.637, 26.25633333333333, 25.16266666666666, 37.79766666666666, 16.12866666666666, 24.00966666666665, 17.36366666666666, 36.53199999999998, 20.427666666666667, 19.709333333333333, 39.87533333333335, 14.876, 71.73200000000006, 48.02200000000001, 50.202, 78.66000000000007, 33.59066666666666, 15.788333333333334, 21.649666666666654, 18.075666666666663, 28.86499999999999, 35.66666666666667, 30.27266666666664, 45.11266666666668, 23.925666666666675, 19.34233333333333, 27.40733333333333, 51.61233333333333, 20.565333333333324, 44.897000000000006, 31.270000000000007, 30.54066666666666, 27.480333333333316, 30.09633333333331, 33.95333333333331, 65.81233333333336, 40.56066666666665, 39.78700000000003, 19.441666666666656, 29.160333333333327, 24.25199999999999, 63.73833333333336, 17.709666666666664, 32.81133333333334, 17.782999999999998, 48.20066666666666, 17.557333333333332, 30.131999999999987, 29.08200000000001, 30.945, 20.102666666666657, 21.52733333333332, 17.88533333333333, 15.643333333333326, 17.271999999999995, 20.852333333333316, 23.09466666666666, 41.937333333333314, 29.69699999999999], "episode_lengths": [45, 33, 48, 52, 109, 30, 46, 79, 47, 76, 49, 91, 65, 56, 58, 42, 89, 34, 69, 47, 44, 49, 52, 36, 39, 66, 88, 72, 78, 86, 112, 57, 53, 91, 39, 31, 33, 38, 112, 39, 68, 71, 54, 67, 63, 35, 58, 54, 71, 36, 41, 84, 31, 115, 90, 115, 135, 63, 33, 40, 34, 63, 71, 79, 79, 46, 40, 54, 108, 43, 94, 57, 79, 68, 84, 63, 127, 87, 72, 41, 73, 57, 110, 36, 59, 32, 118, 34, 57, 65, 58, 48, 43, 37, 33, 49, 46, 59, 103, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5865306685316631, "mean_inference_ms": 2.963937880115949, "mean_action_processing_ms": 0.6039499550006826, "mean_env_wait_ms": 0.14702890293704296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018070459365844727, "StateBufferConnector_ms": 0.014988422393798828, "ViewRequirementAgentConnector_ms": 0.3479604721069336}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.66085375189283, "num_env_steps_trained_throughput_per_sec": 507.66085375189283, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 1996525.128, "sample_time_ms": 3153.553, "load_time_ms": 2.102, "load_throughput": 1902976.986, "learn_time_ms": 1993344.396, "learn_throughput": 2.007, "synch_weights_time_ms": 21.879}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 6011, "training_iteration": 79, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-02", "timestamp": 1702018202, "time_this_iter_s": 7.905273914337158, "time_total_s": 21855.32896876335, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21855.32896876335, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 89.79090909090908, "ram_util_percent": 96.44545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0582899972044645e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 5.706146240234375, "policy_loss": -0.0010157274082303047, "vf_loss": 5.7071614265441895, "vf_explained_var": 0.6198839545249939, "kl": 0.0007033403962850571, "entropy": 0.0436411052942276, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 65.81233333333336, "episode_reward_min": 13.422, "episode_reward_mean": 29.098699999999994, "episode_len_mean": 62.48, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.61233333333333, 20.565333333333324, 44.897000000000006, 31.270000000000007, 30.54066666666666, 27.480333333333316, 30.09633333333331, 33.95333333333331, 65.81233333333336, 40.56066666666665, 39.78700000000003, 19.441666666666656, 29.160333333333327, 24.25199999999999, 63.73833333333336, 17.709666666666664, 32.81133333333334, 17.782999999999998, 48.20066666666666, 17.557333333333332, 30.131999999999987, 29.08200000000001, 30.945, 20.102666666666657, 21.52733333333332, 17.88533333333333, 15.643333333333326, 17.271999999999995, 20.852333333333316, 23.09466666666666, 41.937333333333314, 29.69699999999999, 38.57899999999998, 37.24199999999999, 57.18100000000003, 23.61566666666666, 32.76733333333333, 32.812333333333335, 20.533333333333328, 21.13666666666667, 41.43233333333335, 28.740333333333332, 27.82499999999998, 28.370333333333306, 50.74799999999999, 22.63433333333333, 25.975666666666665, 22.598666666666663, 33.45266666666669, 21.189999999999987, 27.207666666666647, 52.81266666666663, 30.827333333333332, 26.526000000000014, 33.337666666666664, 49.16899999999995, 24.219333333333324, 51.527, 30.971999999999994, 31.756333333333338, 15.529666666666664, 29.133666666666652, 21.12533333333332, 13.422, 31.333333333333297, 13.656999999999991, 18.769, 27.54699999999998, 43.847333333333346, 19.62733333333334, 42.25866666666667, 17.805666666666664, 28.447999999999997, 18.497, 16.825666666666663, 26.693666666666658, 46.00566666666668, 19.96466666666666, 36.68033333333333, 15.278333333333334, 32.798333333333325, 16.233666666666664, 20.467333333333322, 18.547666666666657, 17.217666666666663, 42.02666666666663, 37.69800000000001, 28.626333333333324, 21.29866666666666, 26.207666666666665, 14.117999999999997, 29.53199999999999, 28.398000000000007, 32.73800000000001, 20.566333333333326, 21.41766666666666, 20.61166666666666, 22.588666666666658, 18.39433333333333, 27.343666666666675], "episode_lengths": [108, 43, 94, 57, 79, 68, 84, 63, 127, 87, 72, 41, 73, 57, 110, 36, 59, 32, 118, 34, 57, 65, 58, 48, 43, 37, 33, 49, 46, 59, 103, 86, 92, 70, 114, 52, 65, 58, 37, 52, 99, 53, 70, 91, 89, 54, 62, 45, 63, 39, 56, 107, 70, 57, 63, 129, 59, 83, 55, 76, 34, 62, 67, 27, 94, 28, 38, 70, 87, 47, 75, 35, 49, 49, 39, 45, 96, 41, 84, 32, 62, 40, 43, 48, 35, 82, 71, 53, 53, 46, 30, 71, 51, 67, 54, 45, 46, 53, 36, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5898114768459128, "mean_inference_ms": 2.97719323103023, "mean_action_processing_ms": 0.605987597828635, "mean_env_wait_ms": 0.1476131012662206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021669864654541016, "StateBufferConnector_ms": 0.060302734375, "ViewRequirementAgentConnector_ms": 0.49136948585510254}}, "episode_reward_max": 65.81233333333336, "episode_reward_min": 13.422, "episode_reward_mean": 29.098699999999994, "episode_len_mean": 62.48, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.61233333333333, 20.565333333333324, 44.897000000000006, 31.270000000000007, 30.54066666666666, 27.480333333333316, 30.09633333333331, 33.95333333333331, 65.81233333333336, 40.56066666666665, 39.78700000000003, 19.441666666666656, 29.160333333333327, 24.25199999999999, 63.73833333333336, 17.709666666666664, 32.81133333333334, 17.782999999999998, 48.20066666666666, 17.557333333333332, 30.131999999999987, 29.08200000000001, 30.945, 20.102666666666657, 21.52733333333332, 17.88533333333333, 15.643333333333326, 17.271999999999995, 20.852333333333316, 23.09466666666666, 41.937333333333314, 29.69699999999999, 38.57899999999998, 37.24199999999999, 57.18100000000003, 23.61566666666666, 32.76733333333333, 32.812333333333335, 20.533333333333328, 21.13666666666667, 41.43233333333335, 28.740333333333332, 27.82499999999998, 28.370333333333306, 50.74799999999999, 22.63433333333333, 25.975666666666665, 22.598666666666663, 33.45266666666669, 21.189999999999987, 27.207666666666647, 52.81266666666663, 30.827333333333332, 26.526000000000014, 33.337666666666664, 49.16899999999995, 24.219333333333324, 51.527, 30.971999999999994, 31.756333333333338, 15.529666666666664, 29.133666666666652, 21.12533333333332, 13.422, 31.333333333333297, 13.656999999999991, 18.769, 27.54699999999998, 43.847333333333346, 19.62733333333334, 42.25866666666667, 17.805666666666664, 28.447999999999997, 18.497, 16.825666666666663, 26.693666666666658, 46.00566666666668, 19.96466666666666, 36.68033333333333, 15.278333333333334, 32.798333333333325, 16.233666666666664, 20.467333333333322, 18.547666666666657, 17.217666666666663, 42.02666666666663, 37.69800000000001, 28.626333333333324, 21.29866666666666, 26.207666666666665, 14.117999999999997, 29.53199999999999, 28.398000000000007, 32.73800000000001, 20.566333333333326, 21.41766666666666, 20.61166666666666, 22.588666666666658, 18.39433333333333, 27.343666666666675], "episode_lengths": [108, 43, 94, 57, 79, 68, 84, 63, 127, 87, 72, 41, 73, 57, 110, 36, 59, 32, 118, 34, 57, 65, 58, 48, 43, 37, 33, 49, 46, 59, 103, 86, 92, 70, 114, 52, 65, 58, 37, 52, 99, 53, 70, 91, 89, 54, 62, 45, 63, 39, 56, 107, 70, 57, 63, 129, 59, 83, 55, 76, 34, 62, 67, 27, 94, 28, 38, 70, 87, 47, 75, 35, 49, 49, 39, 45, 96, 41, 84, 32, 62, 40, 43, 48, 35, 82, 71, 53, 53, 46, 30, 71, 51, 67, 54, 45, 46, 53, 36, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5898114768459128, "mean_inference_ms": 2.97719323103023, "mean_action_processing_ms": 0.605987597828635, "mean_env_wait_ms": 0.1476131012662206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021669864654541016, "StateBufferConnector_ms": 0.060302734375, "ViewRequirementAgentConnector_ms": 0.49136948585510254}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.6103870939717, "num_env_steps_trained_throughput_per_sec": 440.6103870939717, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 1996468.184, "sample_time_ms": 3328.747, "load_time_ms": 1.999, "load_throughput": 2001242.455, "learn_time_ms": 1993112.788, "learn_throughput": 2.007, "synch_weights_time_ms": 21.488}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 6079, "training_iteration": 80, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-12", "timestamp": 1702018212, "time_this_iter_s": 9.099308729171753, "time_total_s": 21864.428277492523, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21864.428277492523, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 91.24545454545455, "ram_util_percent": 95.73636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0291449986022322e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 5.785278797149658, "policy_loss": -0.0023607274051755667, "vf_loss": 5.787639617919922, "vf_explained_var": 0.5430176258087158, "kl": 0.00040870782686397433, "entropy": 0.03657739236950874, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 72.54633333333328, "episode_reward_min": 14.117999999999997, "episode_reward_mean": 27.17706666666666, "episode_len_mean": 55.96, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.847333333333346, 19.62733333333334, 42.25866666666667, 17.805666666666664, 28.447999999999997, 18.497, 16.825666666666663, 26.693666666666658, 46.00566666666668, 19.96466666666666, 36.68033333333333, 15.278333333333334, 32.798333333333325, 16.233666666666664, 20.467333333333322, 18.547666666666657, 17.217666666666663, 42.02666666666663, 37.69800000000001, 28.626333333333324, 21.29866666666666, 26.207666666666665, 14.117999999999997, 29.53199999999999, 28.398000000000007, 32.73800000000001, 20.566333333333326, 21.41766666666666, 20.61166666666666, 22.588666666666658, 18.39433333333333, 27.343666666666675, 21.242666666666658, 19.558666666666664, 18.91699999999999, 21.414666666666655, 15.79033333333333, 39.61633333333332, 15.328999999999994, 16.20533333333333, 21.97299999999999, 60.49300000000003, 34.233333333333306, 19.325666666666667, 19.330333333333332, 21.07633333333333, 35.08466666666666, 23.67466666666666, 60.913333333333384, 48.75299999999997, 20.765666666666668, 28.594666666666658, 72.54633333333328, 40.591666666666654, 26.468333333333305, 24.176999999999992, 19.10066666666666, 14.791333333333329, 33.22533333333334, 48.55266666666666, 15.97033333333333, 22.879666666666658, 40.86699999999999, 21.395666666666667, 37.13366666666665, 21.45833333333333, 29.003, 29.341666666666665, 30.500333333333334, 46.160666666666664, 25.005999999999982, 16.02333333333333, 54.85533333333333, 19.48599999999999, 22.984999999999996, 17.711999999999993, 15.469333333333331, 31.248333333333324, 20.169333333333324, 26.07766666666667, 21.925333333333327, 17.023333333333326, 15.205333333333332, 23.80799999999999, 33.065000000000005, 37.308666666666646, 22.27199999999999, 20.76799999999999, 18.102999999999987, 18.340999999999994, 28.486666666666675, 20.180666666666664, 14.854666666666663, 27.37966666666665, 18.230666666666668, 61.441, 30.716333333333345, 27.792333333333325, 18.75799999999999, 27.796666666666667], "episode_lengths": [87, 47, 75, 35, 49, 49, 39, 45, 96, 41, 84, 32, 62, 40, 43, 48, 35, 82, 71, 53, 53, 46, 30, 71, 51, 67, 54, 45, 46, 53, 36, 77, 48, 55, 40, 48, 36, 102, 33, 32, 47, 97, 84, 42, 48, 39, 81, 47, 107, 104, 43, 65, 124, 92, 62, 57, 39, 29, 73, 98, 33, 44, 64, 40, 62, 49, 59, 52, 56, 73, 65, 37, 95, 43, 46, 37, 32, 58, 39, 46, 39, 42, 29, 68, 67, 75, 49, 41, 52, 45, 69, 45, 31, 49, 42, 96, 54, 49, 53, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.587236609768829, "mean_inference_ms": 2.9783725694796437, "mean_action_processing_ms": 0.6058108670895664, "mean_env_wait_ms": 0.14756961447177108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019640684127807617, "StateBufferConnector_ms": 0.05129241943359375, "ViewRequirementAgentConnector_ms": 0.40854978561401367}}, "episode_reward_max": 72.54633333333328, "episode_reward_min": 14.117999999999997, "episode_reward_mean": 27.17706666666666, "episode_len_mean": 55.96, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.847333333333346, 19.62733333333334, 42.25866666666667, 17.805666666666664, 28.447999999999997, 18.497, 16.825666666666663, 26.693666666666658, 46.00566666666668, 19.96466666666666, 36.68033333333333, 15.278333333333334, 32.798333333333325, 16.233666666666664, 20.467333333333322, 18.547666666666657, 17.217666666666663, 42.02666666666663, 37.69800000000001, 28.626333333333324, 21.29866666666666, 26.207666666666665, 14.117999999999997, 29.53199999999999, 28.398000000000007, 32.73800000000001, 20.566333333333326, 21.41766666666666, 20.61166666666666, 22.588666666666658, 18.39433333333333, 27.343666666666675, 21.242666666666658, 19.558666666666664, 18.91699999999999, 21.414666666666655, 15.79033333333333, 39.61633333333332, 15.328999999999994, 16.20533333333333, 21.97299999999999, 60.49300000000003, 34.233333333333306, 19.325666666666667, 19.330333333333332, 21.07633333333333, 35.08466666666666, 23.67466666666666, 60.913333333333384, 48.75299999999997, 20.765666666666668, 28.594666666666658, 72.54633333333328, 40.591666666666654, 26.468333333333305, 24.176999999999992, 19.10066666666666, 14.791333333333329, 33.22533333333334, 48.55266666666666, 15.97033333333333, 22.879666666666658, 40.86699999999999, 21.395666666666667, 37.13366666666665, 21.45833333333333, 29.003, 29.341666666666665, 30.500333333333334, 46.160666666666664, 25.005999999999982, 16.02333333333333, 54.85533333333333, 19.48599999999999, 22.984999999999996, 17.711999999999993, 15.469333333333331, 31.248333333333324, 20.169333333333324, 26.07766666666667, 21.925333333333327, 17.023333333333326, 15.205333333333332, 23.80799999999999, 33.065000000000005, 37.308666666666646, 22.27199999999999, 20.76799999999999, 18.102999999999987, 18.340999999999994, 28.486666666666675, 20.180666666666664, 14.854666666666663, 27.37966666666665, 18.230666666666668, 61.441, 30.716333333333345, 27.792333333333325, 18.75799999999999, 27.796666666666667], "episode_lengths": [87, 47, 75, 35, 49, 49, 39, 45, 96, 41, 84, 32, 62, 40, 43, 48, 35, 82, 71, 53, 53, 46, 30, 71, 51, 67, 54, 45, 46, 53, 36, 77, 48, 55, 40, 48, 36, 102, 33, 32, 47, 97, 84, 42, 48, 39, 81, 47, 107, 104, 43, 65, 124, 92, 62, 57, 39, 29, 73, 98, 33, 44, 64, 40, 62, 49, 59, 52, 56, 73, 65, 37, 95, 43, 46, 37, 32, 58, 39, 46, 39, 42, 29, 68, 67, 75, 49, 41, 52, 45, 69, 45, 31, 49, 42, 96, 54, 49, 53, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.587236609768829, "mean_inference_ms": 2.9783725694796437, "mean_action_processing_ms": 0.6058108670895664, "mean_env_wait_ms": 0.14756961447177108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019640684127807617, "StateBufferConnector_ms": 0.05129241943359375, "ViewRequirementAgentConnector_ms": 0.40854978561401367}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 733.6768192814625, "num_env_steps_trained_throughput_per_sec": 733.6768192814625, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 1996165.431, "sample_time_ms": 3276.229, "load_time_ms": 1.999, "load_throughput": 2001242.455, "learn_time_ms": 1992862.654, "learn_throughput": 2.007, "synch_weights_time_ms": 21.387}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 6147, "training_iteration": 81, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-17", "timestamp": 1702018217, "time_this_iter_s": 5.475989580154419, "time_total_s": 21869.904267072678, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21869.904267072678, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 80.89999999999999, "ram_util_percent": 93.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.145724993011161e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 6.3412675857543945, "policy_loss": -0.004628435708582401, "vf_loss": 6.345895767211914, "vf_explained_var": 0.5485334396362305, "kl": 0.0012811971828341484, "entropy": 0.04951866343617439, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 101.37300000000003, "episode_reward_min": 14.049666666666665, "episode_reward_mean": 28.72024666666667, "episode_len_mean": 57.98, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.500333333333334, 46.160666666666664, 25.005999999999982, 16.02333333333333, 54.85533333333333, 19.48599999999999, 22.984999999999996, 17.711999999999993, 15.469333333333331, 31.248333333333324, 20.169333333333324, 26.07766666666667, 21.925333333333327, 17.023333333333326, 15.205333333333332, 23.80799999999999, 33.065000000000005, 37.308666666666646, 22.27199999999999, 20.76799999999999, 18.102999999999987, 18.340999999999994, 28.486666666666675, 20.180666666666664, 14.854666666666663, 27.37966666666665, 18.230666666666668, 61.441, 30.716333333333345, 27.792333333333325, 18.75799999999999, 27.796666666666667, 26.930999999999976, 14.049666666666665, 23.974999999999994, 35.43566666666668, 19.560999999999993, 17.188999999999993, 18.876666666666665, 27.261, 40.161000000000016, 40.059, 16.785666666666664, 21.74733333333332, 27.264666666666667, 49.134, 24.54933333333333, 16.629999999999995, 20.567000000000004, 61.61233333333334, 36.02799999999999, 36.75533333333333, 15.440333333333326, 26.490999999999996, 17.52433333333333, 34.287, 39.62333333333331, 22.65899999999999, 29.595000000000002, 39.776999999999994, 24.005333333333336, 26.675000000000008, 34.53633333333334, 31.695999999999984, 21.59899999999999, 19.421, 29.174999999999986, 54.16866666666665, 16.895666666666656, 27.750333333333334, 37.02599999999999, 61.65733333333337, 30.346333333333323, 23.441666666666656, 36.68499999999998, 101.37300000000003, 32.73233333333336, 19.19166666666666, 16.91866666666666, 44.82400000000002, 33.137000000000015, 23.39833333333334, 20.512666666666668, 16.614, 46.165000000000035, 20.78366666666666, 30.934333333333335, 16.602666666666668, 18.660333333333323, 23.251999999999992, 28.932333333333336, 34.204999999999984, 19.55366666666666, 30.470666666666656, 33.81299999999999, 37.17166666666667, 16.391333333333325, 40.851333333333336, 27.66166666666666, 33.67633333333332], "episode_lengths": [56, 73, 65, 37, 95, 43, 46, 37, 32, 58, 39, 46, 39, 42, 29, 68, 67, 75, 49, 41, 52, 45, 69, 45, 31, 49, 42, 96, 54, 49, 53, 57, 85, 30, 59, 63, 41, 34, 35, 60, 86, 68, 34, 67, 51, 83, 47, 35, 40, 117, 62, 73, 40, 52, 36, 68, 87, 49, 50, 59, 56, 50, 66, 57, 42, 35, 52, 105, 38, 52, 101, 111, 54, 61, 86, 177, 72, 40, 39, 77, 59, 52, 45, 33, 82, 60, 74, 35, 38, 42, 68, 67, 40, 53, 76, 81, 34, 74, 58, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5815584758531664, "mean_inference_ms": 2.9737746163050423, "mean_action_processing_ms": 0.6047990931946298, "mean_env_wait_ms": 0.147164795492811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018983125686645508, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.43450355529785156}}, "episode_reward_max": 101.37300000000003, "episode_reward_min": 14.049666666666665, "episode_reward_mean": 28.72024666666667, "episode_len_mean": 57.98, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.500333333333334, 46.160666666666664, 25.005999999999982, 16.02333333333333, 54.85533333333333, 19.48599999999999, 22.984999999999996, 17.711999999999993, 15.469333333333331, 31.248333333333324, 20.169333333333324, 26.07766666666667, 21.925333333333327, 17.023333333333326, 15.205333333333332, 23.80799999999999, 33.065000000000005, 37.308666666666646, 22.27199999999999, 20.76799999999999, 18.102999999999987, 18.340999999999994, 28.486666666666675, 20.180666666666664, 14.854666666666663, 27.37966666666665, 18.230666666666668, 61.441, 30.716333333333345, 27.792333333333325, 18.75799999999999, 27.796666666666667, 26.930999999999976, 14.049666666666665, 23.974999999999994, 35.43566666666668, 19.560999999999993, 17.188999999999993, 18.876666666666665, 27.261, 40.161000000000016, 40.059, 16.785666666666664, 21.74733333333332, 27.264666666666667, 49.134, 24.54933333333333, 16.629999999999995, 20.567000000000004, 61.61233333333334, 36.02799999999999, 36.75533333333333, 15.440333333333326, 26.490999999999996, 17.52433333333333, 34.287, 39.62333333333331, 22.65899999999999, 29.595000000000002, 39.776999999999994, 24.005333333333336, 26.675000000000008, 34.53633333333334, 31.695999999999984, 21.59899999999999, 19.421, 29.174999999999986, 54.16866666666665, 16.895666666666656, 27.750333333333334, 37.02599999999999, 61.65733333333337, 30.346333333333323, 23.441666666666656, 36.68499999999998, 101.37300000000003, 32.73233333333336, 19.19166666666666, 16.91866666666666, 44.82400000000002, 33.137000000000015, 23.39833333333334, 20.512666666666668, 16.614, 46.165000000000035, 20.78366666666666, 30.934333333333335, 16.602666666666668, 18.660333333333323, 23.251999999999992, 28.932333333333336, 34.204999999999984, 19.55366666666666, 30.470666666666656, 33.81299999999999, 37.17166666666667, 16.391333333333325, 40.851333333333336, 27.66166666666666, 33.67633333333332], "episode_lengths": [56, 73, 65, 37, 95, 43, 46, 37, 32, 58, 39, 46, 39, 42, 29, 68, 67, 75, 49, 41, 52, 45, 69, 45, 31, 49, 42, 96, 54, 49, 53, 57, 85, 30, 59, 63, 41, 34, 35, 60, 86, 68, 34, 67, 51, 83, 47, 35, 40, 117, 62, 73, 40, 52, 36, 68, 87, 49, 50, 59, 56, 50, 66, 57, 42, 35, 52, 105, 38, 52, 101, 111, 54, 61, 86, 177, 72, 40, 39, 77, 59, 52, 45, 33, 82, 60, 74, 35, 38, 42, 68, 67, 40, 53, 76, 81, 34, 74, 58, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5815584758531664, "mean_inference_ms": 2.9737746163050423, "mean_action_processing_ms": 0.6047990931946298, "mean_env_wait_ms": 0.147164795492811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018983125686645508, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.43450355529785156}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 588.9282700078318, "num_env_steps_trained_throughput_per_sec": 588.9282700078318, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 37952.491, "sample_time_ms": 3276.068, "load_time_ms": 1.998, "load_throughput": 2001552.833, "learn_time_ms": 34651.326, "learn_throughput": 115.436, "synch_weights_time_ms": 20.338}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 6215, "training_iteration": 82, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-24", "timestamp": 1702018224, "time_this_iter_s": 6.807008743286133, "time_total_s": 21876.711275815964, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21876.711275815964, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 88.03333333333333, "ram_util_percent": 94.34444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.5728624965055806e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 5.106287479400635, "policy_loss": -0.002669788198545575, "vf_loss": 5.108957290649414, "vf_explained_var": 0.6558807492256165, "kl": 0.004406151827424765, "entropy": 0.08700824528932571, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 101.37300000000003, "episode_reward_min": 13.681666666666667, "episode_reward_mean": 27.85541666666666, "episode_len_mean": 57.41, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.346333333333323, 23.441666666666656, 36.68499999999998, 101.37300000000003, 32.73233333333336, 19.19166666666666, 16.91866666666666, 44.82400000000002, 33.137000000000015, 23.39833333333334, 20.512666666666668, 16.614, 46.165000000000035, 20.78366666666666, 30.934333333333335, 16.602666666666668, 18.660333333333323, 23.251999999999992, 28.932333333333336, 34.204999999999984, 19.55366666666666, 30.470666666666656, 33.81299999999999, 37.17166666666667, 16.391333333333325, 40.851333333333336, 27.66166666666666, 33.67633333333332, 17.445666666666657, 49.67833333333334, 51.551333333333346, 24.557333333333325, 16.89833333333333, 38.05333333333333, 18.921000000000003, 18.986333333333324, 22.955666666666666, 42.035000000000004, 20.98133333333333, 20.514333333333322, 28.936999999999994, 32.243, 16.776666666666667, 32.76699999999998, 16.362999999999992, 16.632999999999996, 25.528333333333332, 32.57266666666665, 13.681666666666667, 27.119, 39.42699999999998, 15.678333333333327, 18.39066666666666, 19.049999999999986, 14.421666666666662, 38.210666666666675, 40.15233333333334, 21.77799999999999, 16.978333333333325, 22.77699999999999, 33.899, 36.637, 20.94633333333333, 15.521333333333331, 25.96866666666667, 26.907333333333323, 19.68366666666666, 17.126999999999992, 16.340333333333326, 26.892666666666656, 20.633333333333326, 19.53633333333333, 18.997333333333334, 43.22633333333336, 26.159999999999982, 77.25833333333338, 21.91733333333334, 25.786333333333328, 36.428000000000004, 26.081333333333333, 20.06033333333333, 27.837, 24.88066666666665, 55.3323333333333, 23.99499999999999, 18.37899999999999, 23.562999999999988, 26.842333333333325, 20.508666666666667, 18.10633333333333, 17.077333333333325, 52.08233333333332, 14.076999999999996, 25.425666666666654, 25.15433333333332, 20.007999999999992, 19.17366666666665, 54.91000000000001, 16.30366666666666, 35.514], "episode_lengths": [54, 61, 86, 177, 72, 40, 39, 77, 59, 52, 45, 33, 82, 60, 74, 35, 38, 42, 68, 67, 40, 53, 76, 81, 34, 74, 58, 66, 33, 112, 109, 65, 35, 83, 36, 37, 57, 71, 41, 46, 56, 66, 38, 85, 34, 34, 46, 76, 28, 65, 90, 37, 37, 56, 29, 73, 76, 45, 35, 44, 70, 64, 45, 31, 45, 74, 60, 38, 32, 55, 37, 39, 46, 79, 67, 122, 51, 64, 70, 61, 38, 62, 57, 97, 45, 38, 46, 57, 42, 34, 39, 94, 30, 45, 68, 41, 45, 106, 32, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.57589620903865, "mean_inference_ms": 2.965488044830947, "mean_action_processing_ms": 0.6029793385801171, "mean_env_wait_ms": 0.14660459814764232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015953779220581055, "StateBufferConnector_ms": 0.013006448745727539, "ViewRequirementAgentConnector_ms": 0.39687275886535645}}, "episode_reward_max": 101.37300000000003, "episode_reward_min": 13.681666666666667, "episode_reward_mean": 27.85541666666666, "episode_len_mean": 57.41, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.346333333333323, 23.441666666666656, 36.68499999999998, 101.37300000000003, 32.73233333333336, 19.19166666666666, 16.91866666666666, 44.82400000000002, 33.137000000000015, 23.39833333333334, 20.512666666666668, 16.614, 46.165000000000035, 20.78366666666666, 30.934333333333335, 16.602666666666668, 18.660333333333323, 23.251999999999992, 28.932333333333336, 34.204999999999984, 19.55366666666666, 30.470666666666656, 33.81299999999999, 37.17166666666667, 16.391333333333325, 40.851333333333336, 27.66166666666666, 33.67633333333332, 17.445666666666657, 49.67833333333334, 51.551333333333346, 24.557333333333325, 16.89833333333333, 38.05333333333333, 18.921000000000003, 18.986333333333324, 22.955666666666666, 42.035000000000004, 20.98133333333333, 20.514333333333322, 28.936999999999994, 32.243, 16.776666666666667, 32.76699999999998, 16.362999999999992, 16.632999999999996, 25.528333333333332, 32.57266666666665, 13.681666666666667, 27.119, 39.42699999999998, 15.678333333333327, 18.39066666666666, 19.049999999999986, 14.421666666666662, 38.210666666666675, 40.15233333333334, 21.77799999999999, 16.978333333333325, 22.77699999999999, 33.899, 36.637, 20.94633333333333, 15.521333333333331, 25.96866666666667, 26.907333333333323, 19.68366666666666, 17.126999999999992, 16.340333333333326, 26.892666666666656, 20.633333333333326, 19.53633333333333, 18.997333333333334, 43.22633333333336, 26.159999999999982, 77.25833333333338, 21.91733333333334, 25.786333333333328, 36.428000000000004, 26.081333333333333, 20.06033333333333, 27.837, 24.88066666666665, 55.3323333333333, 23.99499999999999, 18.37899999999999, 23.562999999999988, 26.842333333333325, 20.508666666666667, 18.10633333333333, 17.077333333333325, 52.08233333333332, 14.076999999999996, 25.425666666666654, 25.15433333333332, 20.007999999999992, 19.17366666666665, 54.91000000000001, 16.30366666666666, 35.514], "episode_lengths": [54, 61, 86, 177, 72, 40, 39, 77, 59, 52, 45, 33, 82, 60, 74, 35, 38, 42, 68, 67, 40, 53, 76, 81, 34, 74, 58, 66, 33, 112, 109, 65, 35, 83, 36, 37, 57, 71, 41, 46, 56, 66, 38, 85, 34, 34, 46, 76, 28, 65, 90, 37, 37, 56, 29, 73, 76, 45, 35, 44, 70, 64, 45, 31, 45, 74, 60, 38, 32, 55, 37, 39, 46, 79, 67, 122, 51, 64, 70, 61, 38, 62, 57, 97, 45, 38, 46, 57, 42, 34, 39, 94, 30, 45, 68, 41, 45, 106, 32, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.57589620903865, "mean_inference_ms": 2.965488044830947, "mean_action_processing_ms": 0.6029793385801171, "mean_env_wait_ms": 0.14660459814764232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015953779220581055, "StateBufferConnector_ms": 0.013006448745727539, "ViewRequirementAgentConnector_ms": 0.39687275886535645}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.2409827564202, "num_env_steps_trained_throughput_per_sec": 683.2409827564202, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 37798.074, "sample_time_ms": 3163.412, "load_time_ms": 1.899, "load_throughput": 2106869.938, "learn_time_ms": 34611.063, "learn_throughput": 115.57, "synch_weights_time_ms": 19.103}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 6287, "training_iteration": 83, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-30", "timestamp": 1702018230, "time_this_iter_s": 5.868440628051758, "time_total_s": 21882.579716444016, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21882.579716444016, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 83.5625, "ram_util_percent": 93.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2864312482527903e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 5.765283107757568, "policy_loss": -0.00657217251136899, "vf_loss": 5.771854877471924, "vf_explained_var": 0.556810200214386, "kl": 0.000958750955760479, "entropy": 0.07556617259979248, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77655.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 77.25833333333338, "episode_reward_min": 12.938000000000002, "episode_reward_mean": 27.25040666666666, "episode_len_mean": 57.04, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.997333333333334, 43.22633333333336, 26.159999999999982, 77.25833333333338, 21.91733333333334, 25.786333333333328, 36.428000000000004, 26.081333333333333, 20.06033333333333, 27.837, 24.88066666666665, 55.3323333333333, 23.99499999999999, 18.37899999999999, 23.562999999999988, 26.842333333333325, 20.508666666666667, 18.10633333333333, 17.077333333333325, 52.08233333333332, 14.076999999999996, 25.425666666666654, 25.15433333333332, 20.007999999999992, 19.17366666666665, 54.91000000000001, 16.30366666666666, 35.514, 17.18666666666666, 45.67433333333331, 16.821666666666662, 22.17833333333332, 17.763999999999992, 62.92166666666665, 27.516999999999992, 36.06066666666668, 18.117333333333328, 36.57666666666668, 17.96033333333333, 17.224, 13.665, 32.314333333333316, 18.456666666666663, 24.021999999999995, 38.53733333333333, 23.486999999999988, 17.380999999999993, 15.103999999999996, 17.848333333333326, 25.559666666666654, 34.840666666666664, 16.883, 25.499999999999986, 29.77333333333333, 22.509666666666657, 47.955, 32.26633333333333, 15.327999999999996, 23.311333333333334, 13.796999999999997, 42.38866666666668, 14.990666666666664, 24.970333333333322, 22.889999999999986, 16.069333333333336, 24.790333333333336, 30.727666666666668, 49.51266666666666, 33.59799999999999, 13.81733333333333, 25.72466666666665, 22.82133333333332, 32.642666666666656, 36.56599999999999, 23.358000000000004, 21.180666666666657, 21.022666666666666, 42.73633333333331, 12.938000000000002, 30.15066666666664, 42.18799999999997, 20.720666666666663, 20.710666666666658, 32.474333333333334, 26.660666666666668, 52.11700000000001, 25.531999999999982, 20.64033333333333, 43.129, 18.493999999999996, 19.914666666666662, 37.402333333333324, 17.08166666666666, 14.233666666666661, 41.77166666666667, 16.445999999999998, 25.007, 17.03633333333333, 22.296999999999993, 28.65966666666667], "episode_lengths": [46, 79, 67, 122, 51, 64, 70, 61, 38, 62, 57, 97, 45, 38, 46, 57, 42, 34, 39, 94, 30, 45, 68, 41, 45, 106, 32, 57, 34, 96, 38, 39, 35, 102, 57, 74, 47, 58, 39, 33, 29, 80, 45, 53, 61, 54, 37, 34, 52, 50, 69, 33, 47, 65, 44, 110, 58, 36, 51, 27, 80, 35, 47, 64, 31, 56, 63, 101, 71, 28, 88, 63, 86, 61, 49, 42, 42, 76, 32, 93, 87, 65, 55, 68, 55, 90, 75, 44, 78, 52, 39, 79, 42, 31, 87, 31, 52, 38, 47, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5710072282691192, "mean_inference_ms": 2.9616587870198963, "mean_action_processing_ms": 0.6013241839853274, "mean_env_wait_ms": 0.1463543096324009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018961191177368164, "StateBufferConnector_ms": 0.016928672790527344, "ViewRequirementAgentConnector_ms": 0.42020130157470703}}, "episode_reward_max": 77.25833333333338, "episode_reward_min": 12.938000000000002, "episode_reward_mean": 27.25040666666666, "episode_len_mean": 57.04, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.997333333333334, 43.22633333333336, 26.159999999999982, 77.25833333333338, 21.91733333333334, 25.786333333333328, 36.428000000000004, 26.081333333333333, 20.06033333333333, 27.837, 24.88066666666665, 55.3323333333333, 23.99499999999999, 18.37899999999999, 23.562999999999988, 26.842333333333325, 20.508666666666667, 18.10633333333333, 17.077333333333325, 52.08233333333332, 14.076999999999996, 25.425666666666654, 25.15433333333332, 20.007999999999992, 19.17366666666665, 54.91000000000001, 16.30366666666666, 35.514, 17.18666666666666, 45.67433333333331, 16.821666666666662, 22.17833333333332, 17.763999999999992, 62.92166666666665, 27.516999999999992, 36.06066666666668, 18.117333333333328, 36.57666666666668, 17.96033333333333, 17.224, 13.665, 32.314333333333316, 18.456666666666663, 24.021999999999995, 38.53733333333333, 23.486999999999988, 17.380999999999993, 15.103999999999996, 17.848333333333326, 25.559666666666654, 34.840666666666664, 16.883, 25.499999999999986, 29.77333333333333, 22.509666666666657, 47.955, 32.26633333333333, 15.327999999999996, 23.311333333333334, 13.796999999999997, 42.38866666666668, 14.990666666666664, 24.970333333333322, 22.889999999999986, 16.069333333333336, 24.790333333333336, 30.727666666666668, 49.51266666666666, 33.59799999999999, 13.81733333333333, 25.72466666666665, 22.82133333333332, 32.642666666666656, 36.56599999999999, 23.358000000000004, 21.180666666666657, 21.022666666666666, 42.73633333333331, 12.938000000000002, 30.15066666666664, 42.18799999999997, 20.720666666666663, 20.710666666666658, 32.474333333333334, 26.660666666666668, 52.11700000000001, 25.531999999999982, 20.64033333333333, 43.129, 18.493999999999996, 19.914666666666662, 37.402333333333324, 17.08166666666666, 14.233666666666661, 41.77166666666667, 16.445999999999998, 25.007, 17.03633333333333, 22.296999999999993, 28.65966666666667], "episode_lengths": [46, 79, 67, 122, 51, 64, 70, 61, 38, 62, 57, 97, 45, 38, 46, 57, 42, 34, 39, 94, 30, 45, 68, 41, 45, 106, 32, 57, 34, 96, 38, 39, 35, 102, 57, 74, 47, 58, 39, 33, 29, 80, 45, 53, 61, 54, 37, 34, 52, 50, 69, 33, 47, 65, 44, 110, 58, 36, 51, 27, 80, 35, 47, 64, 31, 56, 63, 101, 71, 28, 88, 63, 86, 61, 49, 42, 42, 76, 32, 93, 87, 65, 55, 68, 55, 90, 75, 44, 78, 52, 39, 79, 42, 31, 87, 31, 52, 38, 47, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5710072282691192, "mean_inference_ms": 2.9616587870198963, "mean_action_processing_ms": 0.6013241839853274, "mean_env_wait_ms": 0.1463543096324009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018961191177368164, "StateBufferConnector_ms": 0.016928672790527344, "ViewRequirementAgentConnector_ms": 0.42020130157470703}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 634.8463536082342, "num_env_steps_trained_throughput_per_sec": 634.8463536082342, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 7549.984, "sample_time_ms": 3159.686, "load_time_ms": 1.899, "load_throughput": 2106526.041, "learn_time_ms": 4367.799, "learn_throughput": 915.793, "synch_weights_time_ms": 18.104}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 6359, "training_iteration": 84, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-36", "timestamp": 1702018236, "time_this_iter_s": 6.318734407424927, "time_total_s": 21888.89845085144, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21888.89845085144, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 83.5125, "ram_util_percent": 93.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.432156241263951e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 5.850961685180664, "policy_loss": -0.007104542572051287, "vf_loss": 5.858066558837891, "vf_explained_var": 0.5921054482460022, "kl": 0.014559957198798656, "entropy": 0.11842239648103714, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78585.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 71.20800000000004, "episode_reward_min": 12.938000000000002, "episode_reward_mean": 27.625549999999993, "episode_len_mean": 60.14, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.51266666666666, 33.59799999999999, 13.81733333333333, 25.72466666666665, 22.82133333333332, 32.642666666666656, 36.56599999999999, 23.358000000000004, 21.180666666666657, 21.022666666666666, 42.73633333333331, 12.938000000000002, 30.15066666666664, 42.18799999999997, 20.720666666666663, 20.710666666666658, 32.474333333333334, 26.660666666666668, 52.11700000000001, 25.531999999999982, 20.64033333333333, 43.129, 18.493999999999996, 19.914666666666662, 37.402333333333324, 17.08166666666666, 14.233666666666661, 41.77166666666667, 16.445999999999998, 25.007, 17.03633333333333, 22.296999999999993, 28.65966666666667, 71.20800000000004, 17.26733333333333, 16.17166666666666, 25.26833333333333, 16.874333333333336, 18.51199999999999, 22.377666666666656, 23.537999999999993, 15.014666666666658, 23.065333333333335, 31.968666666666657, 24.237333333333332, 16.086666666666662, 29.739666666666665, 39.89233333333333, 19.347333333333324, 15.944666666666667, 15.242333333333326, 29.48966666666666, 23.12199999999999, 21.820333333333323, 15.884666666666659, 43.715666666666635, 19.286999999999992, 56.541999999999994, 20.413666666666668, 35.99366666666666, 16.949333333333335, 15.408666666666663, 18.191999999999997, 44.49033333333333, 28.15133333333333, 20.382333333333325, 28.968999999999973, 32.53633333333334, 31.96166666666665, 41.74900000000001, 24.769666666666676, 20.925999999999988, 17.47133333333333, 13.661333333333335, 18.051, 19.841999999999985, 18.180666666666664, 41.14699999999998, 27.182999999999986, 40.87433333333333, 17.098333333333333, 18.891333333333332, 61.88966666666664, 38.699666666666666, 15.67966666666666, 27.24799999999999, 30.950666666666656, 32.91966666666666, 47.30166666666667, 52.52033333333335, 29.75799999999998, 20.47466666666666, 23.97233333333333, 22.771666666666665, 27.102666666666654, 54.926333333333325, 14.495999999999997, 28.278666666666663, 40.13233333333332, 19.936333333333323], "episode_lengths": [101, 71, 28, 88, 63, 86, 61, 49, 42, 42, 76, 32, 93, 87, 65, 55, 68, 55, 90, 75, 44, 78, 52, 39, 79, 42, 31, 87, 31, 52, 38, 47, 61, 139, 36, 34, 57, 36, 47, 66, 50, 33, 47, 79, 50, 33, 55, 84, 41, 31, 34, 64, 55, 38, 40, 93, 42, 99, 44, 64, 41, 42, 47, 80, 64, 53, 73, 86, 82, 90, 44, 57, 39, 28, 36, 55, 35, 78, 66, 76, 37, 38, 136, 89, 37, 69, 62, 72, 88, 104, 59, 56, 46, 42, 73, 86, 31, 72, 100, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5673095290433416, "mean_inference_ms": 2.95651876444178, "mean_action_processing_ms": 0.5998771681953059, "mean_env_wait_ms": 0.14599594381442613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043999671936035156, "StateBufferConnector_ms": 0.041974782943725586, "ViewRequirementAgentConnector_ms": 0.4100916385650635}}, "episode_reward_max": 71.20800000000004, "episode_reward_min": 12.938000000000002, "episode_reward_mean": 27.625549999999993, "episode_len_mean": 60.14, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.51266666666666, 33.59799999999999, 13.81733333333333, 25.72466666666665, 22.82133333333332, 32.642666666666656, 36.56599999999999, 23.358000000000004, 21.180666666666657, 21.022666666666666, 42.73633333333331, 12.938000000000002, 30.15066666666664, 42.18799999999997, 20.720666666666663, 20.710666666666658, 32.474333333333334, 26.660666666666668, 52.11700000000001, 25.531999999999982, 20.64033333333333, 43.129, 18.493999999999996, 19.914666666666662, 37.402333333333324, 17.08166666666666, 14.233666666666661, 41.77166666666667, 16.445999999999998, 25.007, 17.03633333333333, 22.296999999999993, 28.65966666666667, 71.20800000000004, 17.26733333333333, 16.17166666666666, 25.26833333333333, 16.874333333333336, 18.51199999999999, 22.377666666666656, 23.537999999999993, 15.014666666666658, 23.065333333333335, 31.968666666666657, 24.237333333333332, 16.086666666666662, 29.739666666666665, 39.89233333333333, 19.347333333333324, 15.944666666666667, 15.242333333333326, 29.48966666666666, 23.12199999999999, 21.820333333333323, 15.884666666666659, 43.715666666666635, 19.286999999999992, 56.541999999999994, 20.413666666666668, 35.99366666666666, 16.949333333333335, 15.408666666666663, 18.191999999999997, 44.49033333333333, 28.15133333333333, 20.382333333333325, 28.968999999999973, 32.53633333333334, 31.96166666666665, 41.74900000000001, 24.769666666666676, 20.925999999999988, 17.47133333333333, 13.661333333333335, 18.051, 19.841999999999985, 18.180666666666664, 41.14699999999998, 27.182999999999986, 40.87433333333333, 17.098333333333333, 18.891333333333332, 61.88966666666664, 38.699666666666666, 15.67966666666666, 27.24799999999999, 30.950666666666656, 32.91966666666666, 47.30166666666667, 52.52033333333335, 29.75799999999998, 20.47466666666666, 23.97233333333333, 22.771666666666665, 27.102666666666654, 54.926333333333325, 14.495999999999997, 28.278666666666663, 40.13233333333332, 19.936333333333323], "episode_lengths": [101, 71, 28, 88, 63, 86, 61, 49, 42, 42, 76, 32, 93, 87, 65, 55, 68, 55, 90, 75, 44, 78, 52, 39, 79, 42, 31, 87, 31, 52, 38, 47, 61, 139, 36, 34, 57, 36, 47, 66, 50, 33, 47, 79, 50, 33, 55, 84, 41, 31, 34, 64, 55, 38, 40, 93, 42, 99, 44, 64, 41, 42, 47, 80, 64, 53, 73, 86, 82, 90, 44, 57, 39, 28, 36, 55, 35, 78, 66, 76, 37, 38, 136, 89, 37, 69, 62, 72, 88, 104, 59, 56, 46, 42, 73, 86, 31, 72, 100, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5673095290433416, "mean_inference_ms": 2.95651876444178, "mean_action_processing_ms": 0.5998771681953059, "mean_env_wait_ms": 0.14599594381442613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043999671936035156, "StateBufferConnector_ms": 0.041974782943725586, "ViewRequirementAgentConnector_ms": 0.4100916385650635}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 656.4909081660204, "num_env_steps_trained_throughput_per_sec": 656.4909081660204, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 6924.415, "sample_time_ms": 2746.755, "load_time_ms": 0.599, "load_throughput": 6676435.99, "learn_time_ms": 4156.162, "learn_throughput": 962.426, "synch_weights_time_ms": 18.702}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 6426, "training_iteration": 85, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-42", "timestamp": 1702018242, "time_this_iter_s": 6.108028411865234, "time_total_s": 21895.006479263306, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21895.006479263306, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 76.17777777777776, "ram_util_percent": 93.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.432156241263951e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 5.890743255615234, "policy_loss": -0.005221783183515072, "vf_loss": 5.895964622497559, "vf_explained_var": 0.577709436416626, "kl": 0.0026605171151459217, "entropy": 0.14710737764835358, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 73.20133333333334, "episode_reward_min": 13.053333333333331, "episode_reward_mean": 27.927676666666663, "episode_len_mean": 59.89, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.53633333333334, 31.96166666666665, 41.74900000000001, 24.769666666666676, 20.925999999999988, 17.47133333333333, 13.661333333333335, 18.051, 19.841999999999985, 18.180666666666664, 41.14699999999998, 27.182999999999986, 40.87433333333333, 17.098333333333333, 18.891333333333332, 61.88966666666664, 38.699666666666666, 15.67966666666666, 27.24799999999999, 30.950666666666656, 32.91966666666666, 47.30166666666667, 52.52033333333335, 29.75799999999998, 20.47466666666666, 23.97233333333333, 22.771666666666665, 27.102666666666654, 54.926333333333325, 14.495999999999997, 28.278666666666663, 40.13233333333332, 19.936333333333323, 33.064333333333344, 17.688333333333325, 22.27233333333333, 42.23800000000001, 25.843, 42.42233333333335, 13.053333333333331, 16.503333333333327, 22.975666666666655, 14.783999999999994, 37.570666666666654, 22.38766666666665, 59.53700000000001, 18.09666666666666, 41.90933333333332, 16.871666666666663, 17.584666666666667, 22.517333333333333, 13.831999999999999, 33.262666666666654, 31.098999999999997, 23.83733333333333, 34.19966666666666, 37.72866666666666, 14.998999999999999, 27.13866666666667, 27.952999999999978, 13.744000000000002, 23.97299999999999, 22.221666666666668, 33.38699999999999, 35.64933333333331, 23.671333333333312, 33.839000000000006, 41.916, 73.20133333333334, 14.996333333333327, 18.961999999999996, 40.827, 26.454999999999988, 26.794000000000015, 30.953666666666667, 39.895, 18.786, 16.798666666666666, 38.46633333333334, 30.90033333333332, 56.691666666666684, 19.76866666666666, 48.791333333333334, 24.33133333333332, 17.032666666666675, 17.055, 17.644666666666662, 13.248999999999995, 17.107333333333326, 35.49266666666667, 14.345999999999998, 19.091666666666665, 27.14766666666666, 17.652999999999995, 16.716333333333324, 13.227999999999998, 18.62333333333333, 36.54533333333331, 16.26266666666666, 35.78133333333332], "episode_lengths": [86, 82, 90, 44, 57, 39, 28, 36, 55, 35, 78, 66, 76, 37, 38, 136, 89, 37, 69, 62, 72, 88, 104, 59, 56, 46, 42, 73, 86, 31, 72, 100, 46, 80, 43, 51, 89, 58, 93, 34, 33, 43, 30, 64, 42, 109, 36, 75, 36, 49, 48, 29, 86, 58, 47, 70, 102, 39, 52, 54, 28, 54, 48, 60, 70, 59, 73, 83, 135, 33, 53, 102, 68, 57, 52, 91, 41, 35, 87, 72, 100, 55, 89, 67, 31, 42, 36, 32, 39, 71, 33, 39, 54, 38, 34, 28, 44, 81, 44, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.562414245423373, "mean_inference_ms": 2.9473639595486736, "mean_action_processing_ms": 0.5979725322411782, "mean_env_wait_ms": 0.1455549446199867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011996030807495117, "StateBufferConnector_ms": 0.04002547264099121, "ViewRequirementAgentConnector_ms": 0.34891271591186523}}, "episode_reward_max": 73.20133333333334, "episode_reward_min": 13.053333333333331, "episode_reward_mean": 27.927676666666663, "episode_len_mean": 59.89, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.53633333333334, 31.96166666666665, 41.74900000000001, 24.769666666666676, 20.925999999999988, 17.47133333333333, 13.661333333333335, 18.051, 19.841999999999985, 18.180666666666664, 41.14699999999998, 27.182999999999986, 40.87433333333333, 17.098333333333333, 18.891333333333332, 61.88966666666664, 38.699666666666666, 15.67966666666666, 27.24799999999999, 30.950666666666656, 32.91966666666666, 47.30166666666667, 52.52033333333335, 29.75799999999998, 20.47466666666666, 23.97233333333333, 22.771666666666665, 27.102666666666654, 54.926333333333325, 14.495999999999997, 28.278666666666663, 40.13233333333332, 19.936333333333323, 33.064333333333344, 17.688333333333325, 22.27233333333333, 42.23800000000001, 25.843, 42.42233333333335, 13.053333333333331, 16.503333333333327, 22.975666666666655, 14.783999999999994, 37.570666666666654, 22.38766666666665, 59.53700000000001, 18.09666666666666, 41.90933333333332, 16.871666666666663, 17.584666666666667, 22.517333333333333, 13.831999999999999, 33.262666666666654, 31.098999999999997, 23.83733333333333, 34.19966666666666, 37.72866666666666, 14.998999999999999, 27.13866666666667, 27.952999999999978, 13.744000000000002, 23.97299999999999, 22.221666666666668, 33.38699999999999, 35.64933333333331, 23.671333333333312, 33.839000000000006, 41.916, 73.20133333333334, 14.996333333333327, 18.961999999999996, 40.827, 26.454999999999988, 26.794000000000015, 30.953666666666667, 39.895, 18.786, 16.798666666666666, 38.46633333333334, 30.90033333333332, 56.691666666666684, 19.76866666666666, 48.791333333333334, 24.33133333333332, 17.032666666666675, 17.055, 17.644666666666662, 13.248999999999995, 17.107333333333326, 35.49266666666667, 14.345999999999998, 19.091666666666665, 27.14766666666666, 17.652999999999995, 16.716333333333324, 13.227999999999998, 18.62333333333333, 36.54533333333331, 16.26266666666666, 35.78133333333332], "episode_lengths": [86, 82, 90, 44, 57, 39, 28, 36, 55, 35, 78, 66, 76, 37, 38, 136, 89, 37, 69, 62, 72, 88, 104, 59, 56, 46, 42, 73, 86, 31, 72, 100, 46, 80, 43, 51, 89, 58, 93, 34, 33, 43, 30, 64, 42, 109, 36, 75, 36, 49, 48, 29, 86, 58, 47, 70, 102, 39, 52, 54, 28, 54, 48, 60, 70, 59, 73, 83, 135, 33, 53, 102, 68, 57, 52, 91, 41, 35, 87, 72, 100, 55, 89, 67, 31, 42, 36, 32, 39, 71, 33, 39, 54, 38, 34, 28, 44, 81, 44, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.562414245423373, "mean_inference_ms": 2.9473639595486736, "mean_action_processing_ms": 0.5979725322411782, "mean_env_wait_ms": 0.1455549446199867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011996030807495117, "StateBufferConnector_ms": 0.04002547264099121, "ViewRequirementAgentConnector_ms": 0.34891271591186523}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 673.5344861917773, "num_env_steps_trained_throughput_per_sec": 673.5344861917773, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 6744.289, "sample_time_ms": 2675.345, "load_time_ms": 0.6, "load_throughput": 6671126.486, "learn_time_ms": 4047.745, "learn_throughput": 988.205, "synch_weights_time_ms": 18.502}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 6493, "training_iteration": 86, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-48", "timestamp": 1702018248, "time_this_iter_s": 5.953818321228027, "time_total_s": 21900.960297584534, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21900.960297584534, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 76.3875, "ram_util_percent": 91.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.2160781206319757e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 5.108367919921875, "policy_loss": -0.007821454666554928, "vf_loss": 5.116189956665039, "vf_explained_var": 0.5850914120674133, "kl": 0.004460527095943689, "entropy": 0.16091498732566833, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80445.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 59.825, "episode_reward_min": 12.590333333333332, "episode_reward_mean": 24.340189999999996, "episode_len_mean": 51.99, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.691666666666684, 19.76866666666666, 48.791333333333334, 24.33133333333332, 17.032666666666675, 17.055, 17.644666666666662, 13.248999999999995, 17.107333333333326, 35.49266666666667, 14.345999999999998, 19.091666666666665, 27.14766666666666, 17.652999999999995, 16.716333333333324, 13.227999999999998, 18.62333333333333, 36.54533333333331, 16.26266666666666, 35.78133333333332, 32.42066666666666, 15.482333333333322, 15.117666666666661, 17.911333333333328, 16.228333333333325, 21.16833333333333, 15.797666666666663, 16.22533333333333, 33.49366666666668, 42.60166666666667, 31.88266666666667, 15.932, 16.68933333333333, 34.30666666666667, 19.898333333333333, 21.34466666666667, 24.133666666666677, 59.825, 23.581999999999994, 14.087333333333332, 29.11066666666666, 38.67533333333333, 19.141999999999992, 56.879666666666665, 15.434666666666663, 14.614666666666663, 20.231333333333332, 18.641, 25.91433333333333, 19.608333333333324, 17.977666666666664, 22.68433333333333, 34.697, 30.81466666666666, 24.268999999999984, 20.157999999999998, 46.72133333333335, 17.734666666666655, 18.935666666666663, 14.239999999999993, 15.905666666666663, 18.76599999999999, 14.794666666666664, 19.031666666666656, 30.312333333333342, 28.28299999999999, 25.886999999999983, 15.674666666666665, 18.620666666666658, 29.64699999999998, 31.838666666666658, 14.392999999999997, 19.758999999999986, 12.590333333333332, 45.31466666666667, 13.803666666666665, 30.721333333333327, 17.180333333333326, 30.472333333333303, 17.310999999999993, 21.76033333333332, 27.144333333333332, 17.888333333333332, 35.63466666666666, 18.99799999999999, 51.87099999999991, 16.105, 22.680000000000007, 39.83166666666666, 27.337333333333323, 13.471, 45.52200000000003, 27.72866666666667, 13.264999999999997, 24.167999999999996, 17.259333333333334, 32.840666666666664, 16.758333333333333, 18.79466666666666, 17.480999999999998], "episode_lengths": [100, 55, 89, 67, 31, 42, 36, 32, 39, 71, 33, 39, 54, 38, 34, 28, 44, 81, 44, 66, 76, 39, 33, 49, 43, 42, 32, 43, 60, 81, 61, 40, 41, 64, 49, 46, 44, 110, 46, 33, 53, 81, 36, 98, 34, 31, 43, 37, 53, 60, 35, 59, 67, 51, 50, 51, 98, 43, 44, 29, 33, 49, 31, 51, 60, 55, 67, 35, 40, 72, 70, 31, 38, 29, 76, 29, 85, 36, 78, 51, 46, 59, 37, 74, 43, 141, 38, 51, 64, 69, 26, 73, 55, 28, 46, 31, 73, 38, 39, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5589493847055507, "mean_inference_ms": 2.9375829309476194, "mean_action_processing_ms": 0.596662176634705, "mean_env_wait_ms": 0.1453786843126509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014603853225708008, "StateBufferConnector_ms": 0.012723684310913086, "ViewRequirementAgentConnector_ms": 0.4254343509674072}}, "episode_reward_max": 59.825, "episode_reward_min": 12.590333333333332, "episode_reward_mean": 24.340189999999996, "episode_len_mean": 51.99, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.691666666666684, 19.76866666666666, 48.791333333333334, 24.33133333333332, 17.032666666666675, 17.055, 17.644666666666662, 13.248999999999995, 17.107333333333326, 35.49266666666667, 14.345999999999998, 19.091666666666665, 27.14766666666666, 17.652999999999995, 16.716333333333324, 13.227999999999998, 18.62333333333333, 36.54533333333331, 16.26266666666666, 35.78133333333332, 32.42066666666666, 15.482333333333322, 15.117666666666661, 17.911333333333328, 16.228333333333325, 21.16833333333333, 15.797666666666663, 16.22533333333333, 33.49366666666668, 42.60166666666667, 31.88266666666667, 15.932, 16.68933333333333, 34.30666666666667, 19.898333333333333, 21.34466666666667, 24.133666666666677, 59.825, 23.581999999999994, 14.087333333333332, 29.11066666666666, 38.67533333333333, 19.141999999999992, 56.879666666666665, 15.434666666666663, 14.614666666666663, 20.231333333333332, 18.641, 25.91433333333333, 19.608333333333324, 17.977666666666664, 22.68433333333333, 34.697, 30.81466666666666, 24.268999999999984, 20.157999999999998, 46.72133333333335, 17.734666666666655, 18.935666666666663, 14.239999999999993, 15.905666666666663, 18.76599999999999, 14.794666666666664, 19.031666666666656, 30.312333333333342, 28.28299999999999, 25.886999999999983, 15.674666666666665, 18.620666666666658, 29.64699999999998, 31.838666666666658, 14.392999999999997, 19.758999999999986, 12.590333333333332, 45.31466666666667, 13.803666666666665, 30.721333333333327, 17.180333333333326, 30.472333333333303, 17.310999999999993, 21.76033333333332, 27.144333333333332, 17.888333333333332, 35.63466666666666, 18.99799999999999, 51.87099999999991, 16.105, 22.680000000000007, 39.83166666666666, 27.337333333333323, 13.471, 45.52200000000003, 27.72866666666667, 13.264999999999997, 24.167999999999996, 17.259333333333334, 32.840666666666664, 16.758333333333333, 18.79466666666666, 17.480999999999998], "episode_lengths": [100, 55, 89, 67, 31, 42, 36, 32, 39, 71, 33, 39, 54, 38, 34, 28, 44, 81, 44, 66, 76, 39, 33, 49, 43, 42, 32, 43, 60, 81, 61, 40, 41, 64, 49, 46, 44, 110, 46, 33, 53, 81, 36, 98, 34, 31, 43, 37, 53, 60, 35, 59, 67, 51, 50, 51, 98, 43, 44, 29, 33, 49, 31, 51, 60, 55, 67, 35, 40, 72, 70, 31, 38, 29, 76, 29, 85, 36, 78, 51, 46, 59, 37, 74, 43, 141, 38, 51, 64, 69, 26, 73, 55, 28, 46, 31, 73, 38, 39, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5589493847055507, "mean_inference_ms": 2.9375829309476194, "mean_action_processing_ms": 0.596662176634705, "mean_env_wait_ms": 0.1453786843126509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014603853225708008, "StateBufferConnector_ms": 0.012723684310913086, "ViewRequirementAgentConnector_ms": 0.4254343509674072}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 628.7053961992162, "num_env_steps_trained_throughput_per_sec": 628.7053961992162, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 6613.989, "sample_time_ms": 2638.799, "load_time_ms": 0.571, "load_throughput": 7003930.867, "learn_time_ms": 3953.214, "learn_throughput": 1011.835, "synch_weights_time_ms": 19.3}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 6573, "training_iteration": 87, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-50-55", "timestamp": 1702018255, "time_this_iter_s": 6.380200147628784, "time_total_s": 21907.340497732162, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21907.340497732162, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 77.71111111111112, "ram_util_percent": 91.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6080390603159879e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 5.633258819580078, "policy_loss": 0.004281145986169577, "vf_loss": 5.6289777755737305, "vf_explained_var": 0.5413532257080078, "kl": 0.0027970720548182726, "entropy": 0.11214591562747955, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81375.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 55.37500000000002, "episode_reward_min": 12.590333333333332, "episode_reward_mean": 25.757460000000002, "episode_len_mean": 56.56, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.28299999999999, 25.886999999999983, 15.674666666666665, 18.620666666666658, 29.64699999999998, 31.838666666666658, 14.392999999999997, 19.758999999999986, 12.590333333333332, 45.31466666666667, 13.803666666666665, 30.721333333333327, 17.180333333333326, 30.472333333333303, 17.310999999999993, 21.76033333333332, 27.144333333333332, 17.888333333333332, 35.63466666666666, 18.99799999999999, 51.87099999999991, 16.105, 22.680000000000007, 39.83166666666666, 27.337333333333323, 13.471, 45.52200000000003, 27.72866666666667, 13.264999999999997, 24.167999999999996, 17.259333333333334, 32.840666666666664, 16.758333333333333, 18.79466666666666, 17.480999999999998, 55.37500000000002, 43.908333333333324, 21.103666666666655, 14.967333333333327, 40.196999999999996, 30.743666666666662, 43.23566666666664, 26.081999999999997, 21.827999999999985, 32.509, 31.161333333333307, 16.978666666666662, 25.972666666666655, 27.084333333333333, 16.887666666666664, 17.882999999999996, 15.615333333333327, 28.538999999999998, 29.689000000000007, 21.760333333333328, 20.657333333333327, 23.216999999999988, 17.463999999999995, 35.93433333333333, 23.665333333333333, 13.563333333333334, 15.373333333333331, 38.89800000000001, 25.380999999999986, 15.797999999999996, 41.584666666666664, 19.671999999999983, 13.472666666666665, 18.022666666666662, 52.94366666666657, 26.85499999999999, 21.05733333333332, 40.75366666666666, 32.76400000000001, 29.918999999999972, 13.381666666666657, 19.12233333333333, 45.19933333333335, 47.19066666666667, 46.54233333333336, 15.661999999999995, 20.143, 20.25666666666666, 13.816999999999997, 41.56233333333334, 13.243666666666662, 18.794, 37.55666666666663, 24.114999999999988, 15.970333333333334, 15.81233333333333, 18.048666666666662, 27.91533333333333, 19.990999999999996, 33.377, 21.74833333333333, 17.419999999999998, 20.105666666666657, 18.421999999999986, 43.79533333333333], "episode_lengths": [55, 67, 35, 40, 72, 70, 31, 38, 29, 76, 29, 85, 36, 78, 51, 46, 59, 37, 74, 43, 141, 38, 51, 64, 69, 26, 73, 55, 28, 46, 31, 73, 38, 39, 44, 100, 72, 65, 35, 76, 70, 102, 53, 65, 74, 96, 46, 55, 57, 43, 48, 37, 54, 55, 46, 43, 67, 38, 72, 52, 27, 32, 84, 66, 31, 79, 61, 26, 35, 146, 58, 61, 84, 64, 87, 27, 51, 64, 93, 74, 34, 42, 41, 27, 87, 27, 40, 101, 67, 36, 33, 35, 54, 49, 56, 42, 43, 44, 49, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5579250726167944, "mean_inference_ms": 2.939678650984125, "mean_action_processing_ms": 0.5955636687040233, "mean_env_wait_ms": 0.14499061844498448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027475833892822266, "StateBufferConnector_ms": 0.011255741119384766, "ViewRequirementAgentConnector_ms": 0.4857606887817383}}, "episode_reward_max": 55.37500000000002, "episode_reward_min": 12.590333333333332, "episode_reward_mean": 25.757460000000002, "episode_len_mean": 56.56, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.28299999999999, 25.886999999999983, 15.674666666666665, 18.620666666666658, 29.64699999999998, 31.838666666666658, 14.392999999999997, 19.758999999999986, 12.590333333333332, 45.31466666666667, 13.803666666666665, 30.721333333333327, 17.180333333333326, 30.472333333333303, 17.310999999999993, 21.76033333333332, 27.144333333333332, 17.888333333333332, 35.63466666666666, 18.99799999999999, 51.87099999999991, 16.105, 22.680000000000007, 39.83166666666666, 27.337333333333323, 13.471, 45.52200000000003, 27.72866666666667, 13.264999999999997, 24.167999999999996, 17.259333333333334, 32.840666666666664, 16.758333333333333, 18.79466666666666, 17.480999999999998, 55.37500000000002, 43.908333333333324, 21.103666666666655, 14.967333333333327, 40.196999999999996, 30.743666666666662, 43.23566666666664, 26.081999999999997, 21.827999999999985, 32.509, 31.161333333333307, 16.978666666666662, 25.972666666666655, 27.084333333333333, 16.887666666666664, 17.882999999999996, 15.615333333333327, 28.538999999999998, 29.689000000000007, 21.760333333333328, 20.657333333333327, 23.216999999999988, 17.463999999999995, 35.93433333333333, 23.665333333333333, 13.563333333333334, 15.373333333333331, 38.89800000000001, 25.380999999999986, 15.797999999999996, 41.584666666666664, 19.671999999999983, 13.472666666666665, 18.022666666666662, 52.94366666666657, 26.85499999999999, 21.05733333333332, 40.75366666666666, 32.76400000000001, 29.918999999999972, 13.381666666666657, 19.12233333333333, 45.19933333333335, 47.19066666666667, 46.54233333333336, 15.661999999999995, 20.143, 20.25666666666666, 13.816999999999997, 41.56233333333334, 13.243666666666662, 18.794, 37.55666666666663, 24.114999999999988, 15.970333333333334, 15.81233333333333, 18.048666666666662, 27.91533333333333, 19.990999999999996, 33.377, 21.74833333333333, 17.419999999999998, 20.105666666666657, 18.421999999999986, 43.79533333333333], "episode_lengths": [55, 67, 35, 40, 72, 70, 31, 38, 29, 76, 29, 85, 36, 78, 51, 46, 59, 37, 74, 43, 141, 38, 51, 64, 69, 26, 73, 55, 28, 46, 31, 73, 38, 39, 44, 100, 72, 65, 35, 76, 70, 102, 53, 65, 74, 96, 46, 55, 57, 43, 48, 37, 54, 55, 46, 43, 67, 38, 72, 52, 27, 32, 84, 66, 31, 79, 61, 26, 35, 146, 58, 61, 84, 64, 87, 27, 51, 64, 93, 74, 34, 42, 41, 27, 87, 27, 40, 101, 67, 36, 33, 35, 54, 49, 56, 42, 43, 44, 49, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5579250726167944, "mean_inference_ms": 2.939678650984125, "mean_action_processing_ms": 0.5955636687040233, "mean_env_wait_ms": 0.14499061844498448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027475833892822266, "StateBufferConnector_ms": 0.011255741119384766, "ViewRequirementAgentConnector_ms": 0.4857606887817383}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.2771362977354, "num_env_steps_trained_throughput_per_sec": 476.2771362977354, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 6814.934, "sample_time_ms": 2787.885, "load_time_ms": 0.471, "load_throughput": 8490064.268, "learn_time_ms": 4003.86, "learn_throughput": 999.036, "synch_weights_time_ms": 20.802}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 6638, "training_iteration": 88, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-51-03", "timestamp": 1702018263, "time_this_iter_s": 8.425368785858154, "time_total_s": 21915.76586651802, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21915.76586651802, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 83.47272727272728, "ram_util_percent": 93.89090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.040195301579939e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 6.009819030761719, "policy_loss": 0.0014248811639845371, "vf_loss": 6.008394718170166, "vf_explained_var": 0.6155830025672913, "kl": 0.001312261912971735, "entropy": 0.09800062328577042, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82305.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 92.80166666666662, "episode_reward_min": 12.802999999999995, "episode_reward_mean": 28.886106666666663, "episode_len_mean": 60.62, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.797999999999996, 41.584666666666664, 19.671999999999983, 13.472666666666665, 18.022666666666662, 52.94366666666657, 26.85499999999999, 21.05733333333332, 40.75366666666666, 32.76400000000001, 29.918999999999972, 13.381666666666657, 19.12233333333333, 45.19933333333335, 47.19066666666667, 46.54233333333336, 15.661999999999995, 20.143, 20.25666666666666, 13.816999999999997, 41.56233333333334, 13.243666666666662, 18.794, 37.55666666666663, 24.114999999999988, 15.970333333333334, 15.81233333333333, 18.048666666666662, 27.91533333333333, 19.990999999999996, 33.377, 21.74833333333333, 17.419999999999998, 20.105666666666657, 18.421999999999986, 43.79533333333333, 29.578333333333326, 16.78533333333333, 24.636, 57.305333333333365, 12.802999999999995, 28.79533333333333, 52.428333333333335, 58.21500000000003, 24.983000000000004, 27.64633333333333, 28.847333333333317, 32.21066666666668, 31.102333333333323, 42.54766666666665, 19.33633333333333, 37.163999999999994, 57.52600000000001, 36.71733333333333, 60.69600000000009, 16.096333333333334, 22.832333333333338, 32.063333333333325, 28.45866666666667, 19.337666666666664, 29.891, 16.392333333333333, 35.500333333333316, 22.278333333333325, 34.15366666666668, 20.94033333333332, 52.81033333333333, 20.686666666666657, 43.83266666666667, 19.69699999999999, 31.908666666666655, 20.860333333333337, 23.346666666666657, 18.381999999999994, 42.556000000000026, 14.36866666666666, 31.416333333333327, 25.95833333333332, 17.095666666666666, 24.05999999999999, 22.669666666666675, 32.139666666666656, 40.07366666666665, 59.20633333333338, 21.944333333333322, 18.16066666666666, 24.878333333333327, 19.044333333333327, 28.337333333333337, 26.925666666666658, 92.80166666666662, 13.993666666666666, 15.640666666666666, 13.883666666666667, 15.871666666666664, 26.216666666666654, 43.85266666666667, 18.539666666666665, 28.033000000000012, 40.11466666666666], "episode_lengths": [31, 79, 61, 26, 35, 146, 58, 61, 84, 64, 87, 27, 51, 64, 93, 74, 34, 42, 41, 27, 87, 27, 40, 101, 67, 36, 33, 35, 54, 49, 56, 42, 43, 44, 49, 111, 66, 45, 53, 95, 29, 67, 100, 115, 57, 79, 70, 68, 74, 77, 36, 69, 119, 58, 111, 32, 44, 62, 60, 52, 56, 34, 62, 54, 67, 42, 112, 40, 71, 37, 77, 45, 60, 46, 80, 35, 85, 74, 42, 57, 52, 56, 75, 89, 48, 39, 55, 37, 79, 65, 143, 30, 30, 28, 42, 67, 93, 35, 56, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5554831734704937, "mean_inference_ms": 2.937764911709122, "mean_action_processing_ms": 0.5946081222986116, "mean_env_wait_ms": 0.14457163925687905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017632246017456055, "StateBufferConnector_ms": 0.01651310920715332, "ViewRequirementAgentConnector_ms": 0.4987664222717285}}, "episode_reward_max": 92.80166666666662, "episode_reward_min": 12.802999999999995, "episode_reward_mean": 28.886106666666663, "episode_len_mean": 60.62, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.797999999999996, 41.584666666666664, 19.671999999999983, 13.472666666666665, 18.022666666666662, 52.94366666666657, 26.85499999999999, 21.05733333333332, 40.75366666666666, 32.76400000000001, 29.918999999999972, 13.381666666666657, 19.12233333333333, 45.19933333333335, 47.19066666666667, 46.54233333333336, 15.661999999999995, 20.143, 20.25666666666666, 13.816999999999997, 41.56233333333334, 13.243666666666662, 18.794, 37.55666666666663, 24.114999999999988, 15.970333333333334, 15.81233333333333, 18.048666666666662, 27.91533333333333, 19.990999999999996, 33.377, 21.74833333333333, 17.419999999999998, 20.105666666666657, 18.421999999999986, 43.79533333333333, 29.578333333333326, 16.78533333333333, 24.636, 57.305333333333365, 12.802999999999995, 28.79533333333333, 52.428333333333335, 58.21500000000003, 24.983000000000004, 27.64633333333333, 28.847333333333317, 32.21066666666668, 31.102333333333323, 42.54766666666665, 19.33633333333333, 37.163999999999994, 57.52600000000001, 36.71733333333333, 60.69600000000009, 16.096333333333334, 22.832333333333338, 32.063333333333325, 28.45866666666667, 19.337666666666664, 29.891, 16.392333333333333, 35.500333333333316, 22.278333333333325, 34.15366666666668, 20.94033333333332, 52.81033333333333, 20.686666666666657, 43.83266666666667, 19.69699999999999, 31.908666666666655, 20.860333333333337, 23.346666666666657, 18.381999999999994, 42.556000000000026, 14.36866666666666, 31.416333333333327, 25.95833333333332, 17.095666666666666, 24.05999999999999, 22.669666666666675, 32.139666666666656, 40.07366666666665, 59.20633333333338, 21.944333333333322, 18.16066666666666, 24.878333333333327, 19.044333333333327, 28.337333333333337, 26.925666666666658, 92.80166666666662, 13.993666666666666, 15.640666666666666, 13.883666666666667, 15.871666666666664, 26.216666666666654, 43.85266666666667, 18.539666666666665, 28.033000000000012, 40.11466666666666], "episode_lengths": [31, 79, 61, 26, 35, 146, 58, 61, 84, 64, 87, 27, 51, 64, 93, 74, 34, 42, 41, 27, 87, 27, 40, 101, 67, 36, 33, 35, 54, 49, 56, 42, 43, 44, 49, 111, 66, 45, 53, 95, 29, 67, 100, 115, 57, 79, 70, 68, 74, 77, 36, 69, 119, 58, 111, 32, 44, 62, 60, 52, 56, 34, 62, 54, 67, 42, 112, 40, 71, 37, 77, 45, 60, 46, 80, 35, 85, 74, 42, 57, 52, 56, 75, 89, 48, 39, 55, 37, 79, 65, 143, 30, 30, 28, 42, 67, 93, 35, 56, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5554831734704937, "mean_inference_ms": 2.937764911709122, "mean_action_processing_ms": 0.5946081222986116, "mean_env_wait_ms": 0.14457163925687905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017632246017456055, "StateBufferConnector_ms": 0.01651310920715332, "ViewRequirementAgentConnector_ms": 0.4987664222717285}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.730016123543, "num_env_steps_trained_throughput_per_sec": 516.730016123543, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 6801.105, "sample_time_ms": 2780.905, "load_time_ms": 0.371, "load_throughput": 10775347.463, "learn_time_ms": 3997.935, "learn_throughput": 1000.516, "synch_weights_time_ms": 19.978}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 6702, "training_iteration": 89, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-51-11", "timestamp": 1702018271, "time_this_iter_s": 7.760485649108887, "time_total_s": 21923.52635216713, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21923.52635216713, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 88.44999999999999, "ram_util_percent": 94.97}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.0200976507899697e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 6.089582443237305, "policy_loss": -0.005930805578827858, "vf_loss": 6.095512866973877, "vf_explained_var": 0.6177155375480652, "kl": 0.0011291109258309007, "entropy": 0.0793968066573143, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83235.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 92.80166666666662, "episode_reward_min": 13.883666666666667, "episode_reward_mean": 29.93549666666667, "episode_len_mean": 61.94, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.15366666666668, 20.94033333333332, 52.81033333333333, 20.686666666666657, 43.83266666666667, 19.69699999999999, 31.908666666666655, 20.860333333333337, 23.346666666666657, 18.381999999999994, 42.556000000000026, 14.36866666666666, 31.416333333333327, 25.95833333333332, 17.095666666666666, 24.05999999999999, 22.669666666666675, 32.139666666666656, 40.07366666666665, 59.20633333333338, 21.944333333333322, 18.16066666666666, 24.878333333333327, 19.044333333333327, 28.337333333333337, 26.925666666666658, 92.80166666666662, 13.993666666666666, 15.640666666666666, 13.883666666666667, 15.871666666666664, 26.216666666666654, 43.85266666666667, 18.539666666666665, 28.033000000000012, 40.11466666666666, 20.565999999999992, 29.461666666666662, 17.82766666666665, 25.494333333333326, 30.016000000000005, 19.40366666666666, 54.41699999999997, 22.282999999999994, 16.356999999999996, 20.460666666666658, 28.09366666666666, 36.09833333333334, 42.08133333333331, 25.724999999999998, 15.506666666666664, 45.05399999999998, 33.15533333333333, 23.766333333333336, 56.83299999999999, 42.85766666666665, 36.93466666666666, 15.540333333333333, 20.95133333333333, 44.661666666666655, 24.393333333333327, 50.35566666666666, 24.421999999999993, 55.33700000000002, 24.819333333333315, 37.68733333333334, 22.417666666666655, 37.27999999999999, 18.465999999999994, 28.26033333333332, 26.884333333333313, 19.518333333333338, 21.631333333333323, 46.884666666666675, 41.127666666666684, 44.45633333333332, 48.363666666666646, 36.14666666666666, 35.76433333333331, 45.99533333333336, 45.16000000000003, 25.65466666666665, 32.435666666666656, 27.168000000000003, 18.18633333333333, 16.13466666666666, 17.854666666666663, 17.754333333333328, 25.247666666666664, 14.276666666666664, 18.60766666666666, 53.06699999999997, 19.377666666666663, 31.499000000000006, 22.65366666666666, 22.293666666666663, 21.645666666666656, 53.788666666666636, 26.03099999999999, 26.553999999999988], "episode_lengths": [67, 42, 112, 40, 71, 37, 77, 45, 60, 46, 80, 35, 85, 74, 42, 57, 52, 56, 75, 89, 48, 39, 55, 37, 79, 65, 143, 30, 30, 28, 42, 67, 93, 35, 56, 70, 47, 70, 44, 47, 71, 40, 113, 56, 31, 46, 49, 60, 76, 52, 32, 75, 55, 44, 114, 92, 59, 30, 39, 104, 47, 84, 55, 89, 53, 69, 54, 87, 39, 52, 76, 39, 51, 79, 98, 90, 91, 94, 66, 75, 83, 53, 83, 68, 38, 35, 39, 39, 46, 29, 36, 122, 37, 76, 55, 54, 61, 102, 84, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5522588815379874, "mean_inference_ms": 2.931437010622458, "mean_action_processing_ms": 0.5935210637421466, "mean_env_wait_ms": 0.1443075088102898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018340110778808594, "StateBufferConnector_ms": 0.02096104621887207, "ViewRequirementAgentConnector_ms": 0.4527413845062256}}, "episode_reward_max": 92.80166666666662, "episode_reward_min": 13.883666666666667, "episode_reward_mean": 29.93549666666667, "episode_len_mean": 61.94, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.15366666666668, 20.94033333333332, 52.81033333333333, 20.686666666666657, 43.83266666666667, 19.69699999999999, 31.908666666666655, 20.860333333333337, 23.346666666666657, 18.381999999999994, 42.556000000000026, 14.36866666666666, 31.416333333333327, 25.95833333333332, 17.095666666666666, 24.05999999999999, 22.669666666666675, 32.139666666666656, 40.07366666666665, 59.20633333333338, 21.944333333333322, 18.16066666666666, 24.878333333333327, 19.044333333333327, 28.337333333333337, 26.925666666666658, 92.80166666666662, 13.993666666666666, 15.640666666666666, 13.883666666666667, 15.871666666666664, 26.216666666666654, 43.85266666666667, 18.539666666666665, 28.033000000000012, 40.11466666666666, 20.565999999999992, 29.461666666666662, 17.82766666666665, 25.494333333333326, 30.016000000000005, 19.40366666666666, 54.41699999999997, 22.282999999999994, 16.356999999999996, 20.460666666666658, 28.09366666666666, 36.09833333333334, 42.08133333333331, 25.724999999999998, 15.506666666666664, 45.05399999999998, 33.15533333333333, 23.766333333333336, 56.83299999999999, 42.85766666666665, 36.93466666666666, 15.540333333333333, 20.95133333333333, 44.661666666666655, 24.393333333333327, 50.35566666666666, 24.421999999999993, 55.33700000000002, 24.819333333333315, 37.68733333333334, 22.417666666666655, 37.27999999999999, 18.465999999999994, 28.26033333333332, 26.884333333333313, 19.518333333333338, 21.631333333333323, 46.884666666666675, 41.127666666666684, 44.45633333333332, 48.363666666666646, 36.14666666666666, 35.76433333333331, 45.99533333333336, 45.16000000000003, 25.65466666666665, 32.435666666666656, 27.168000000000003, 18.18633333333333, 16.13466666666666, 17.854666666666663, 17.754333333333328, 25.247666666666664, 14.276666666666664, 18.60766666666666, 53.06699999999997, 19.377666666666663, 31.499000000000006, 22.65366666666666, 22.293666666666663, 21.645666666666656, 53.788666666666636, 26.03099999999999, 26.553999999999988], "episode_lengths": [67, 42, 112, 40, 71, 37, 77, 45, 60, 46, 80, 35, 85, 74, 42, 57, 52, 56, 75, 89, 48, 39, 55, 37, 79, 65, 143, 30, 30, 28, 42, 67, 93, 35, 56, 70, 47, 70, 44, 47, 71, 40, 113, 56, 31, 46, 49, 60, 76, 52, 32, 75, 55, 44, 114, 92, 59, 30, 39, 104, 47, 84, 55, 89, 53, 69, 54, 87, 39, 52, 76, 39, 51, 79, 98, 90, 91, 94, 66, 75, 83, 53, 83, 68, 38, 35, 39, 39, 46, 29, 36, 122, 37, 76, 55, 54, 61, 102, 84, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5522588815379874, "mean_inference_ms": 2.931437010622458, "mean_action_processing_ms": 0.5935210637421466, "mean_env_wait_ms": 0.1443075088102898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018340110778808594, "StateBufferConnector_ms": 0.02096104621887207, "ViewRequirementAgentConnector_ms": 0.4527413845062256}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.92248188667975, "num_env_steps_trained_throughput_per_sec": 467.92248188667975, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 6748.116, "sample_time_ms": 2543.483, "load_time_ms": 0.474, "load_throughput": 8438818.973, "learn_time_ms": 4182.455, "learn_throughput": 956.376, "synch_weights_time_ms": 19.838}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 6766, "training_iteration": 90, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-51-20", "timestamp": 1702018280, "time_this_iter_s": 8.582414150238037, "time_total_s": 21932.108766317368, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21932.108766317368, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 90.03636363636365, "ram_util_percent": 95.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0100488253949848e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 5.397947788238525, "policy_loss": -0.007963999174535275, "vf_loss": 5.405911922454834, "vf_explained_var": 0.6387448906898499, "kl": 0.0017447004793211818, "entropy": 0.06505781412124634, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84165.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 58.752666666666634, "episode_reward_min": 13.990333333333327, "episode_reward_mean": 28.16832999999999, "episode_len_mean": 59.26, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.884333333333313, 19.518333333333338, 21.631333333333323, 46.884666666666675, 41.127666666666684, 44.45633333333332, 48.363666666666646, 36.14666666666666, 35.76433333333331, 45.99533333333336, 45.16000000000003, 25.65466666666665, 32.435666666666656, 27.168000000000003, 18.18633333333333, 16.13466666666666, 17.854666666666663, 17.754333333333328, 25.247666666666664, 14.276666666666664, 18.60766666666666, 53.06699999999997, 19.377666666666663, 31.499000000000006, 22.65366666666666, 22.293666666666663, 21.645666666666656, 53.788666666666636, 26.03099999999999, 26.553999999999988, 31.852, 58.752666666666634, 33.163, 41.31933333333333, 23.67799999999999, 32.858666666666664, 16.474333333333334, 23.96833333333334, 42.42299999999997, 21.967999999999996, 26.50833333333333, 24.475666666666662, 24.104333333333326, 16.622666666666657, 34.18699999999999, 24.316666666666674, 37.517, 17.441666666666666, 39.82333333333334, 35.70499999999998, 17.44166666666666, 27.434333333333324, 21.88533333333333, 28.000999999999998, 22.491999999999994, 36.07766666666667, 34.866333333333344, 25.629333333333324, 16.15866666666666, 39.530666666666654, 28.647000000000006, 15.930333333333326, 32.605333333333334, 19.078, 20.65366666666666, 39.06, 23.106333333333332, 26.807999999999996, 54.98200000000002, 18.892999999999994, 41.10500000000002, 18.286666666666658, 32.352999999999966, 15.525333333333329, 14.704000000000002, 36.202, 17.842666666666663, 22.33766666666666, 28.62600000000001, 41.26833333333334, 48.64666666666665, 28.07699999999998, 25.242999999999988, 17.223999999999993, 18.296, 19.42699999999999, 41.406000000000006, 31.956999999999987, 20.651, 19.94333333333332, 19.980999999999998, 16.85299999999999, 19.25566666666666, 27.55233333333332, 16.99299999999999, 34.083666666666666, 27.076999999999984, 24.67433333333333, 18.64799999999999, 13.990333333333327], "episode_lengths": [76, 39, 51, 79, 98, 90, 91, 94, 66, 75, 83, 53, 83, 68, 38, 35, 39, 39, 46, 29, 36, 122, 37, 76, 55, 54, 61, 102, 84, 61, 77, 151, 74, 85, 67, 63, 32, 50, 74, 44, 52, 60, 51, 35, 77, 45, 70, 37, 77, 58, 43, 51, 51, 50, 53, 56, 86, 51, 31, 82, 52, 32, 68, 40, 46, 73, 51, 57, 87, 38, 82, 35, 68, 35, 29, 75, 36, 50, 55, 80, 75, 58, 64, 43, 41, 38, 77, 50, 45, 54, 40, 38, 39, 59, 37, 76, 74, 57, 49, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5530394756892754, "mean_inference_ms": 2.931827816851323, "mean_action_processing_ms": 0.5937061638451715, "mean_env_wait_ms": 0.14432401810502238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036398887634277344, "StateBufferConnector_ms": 0.02138805389404297, "ViewRequirementAgentConnector_ms": 0.5844085216522217}}, "episode_reward_max": 58.752666666666634, "episode_reward_min": 13.990333333333327, "episode_reward_mean": 28.16832999999999, "episode_len_mean": 59.26, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.884333333333313, 19.518333333333338, 21.631333333333323, 46.884666666666675, 41.127666666666684, 44.45633333333332, 48.363666666666646, 36.14666666666666, 35.76433333333331, 45.99533333333336, 45.16000000000003, 25.65466666666665, 32.435666666666656, 27.168000000000003, 18.18633333333333, 16.13466666666666, 17.854666666666663, 17.754333333333328, 25.247666666666664, 14.276666666666664, 18.60766666666666, 53.06699999999997, 19.377666666666663, 31.499000000000006, 22.65366666666666, 22.293666666666663, 21.645666666666656, 53.788666666666636, 26.03099999999999, 26.553999999999988, 31.852, 58.752666666666634, 33.163, 41.31933333333333, 23.67799999999999, 32.858666666666664, 16.474333333333334, 23.96833333333334, 42.42299999999997, 21.967999999999996, 26.50833333333333, 24.475666666666662, 24.104333333333326, 16.622666666666657, 34.18699999999999, 24.316666666666674, 37.517, 17.441666666666666, 39.82333333333334, 35.70499999999998, 17.44166666666666, 27.434333333333324, 21.88533333333333, 28.000999999999998, 22.491999999999994, 36.07766666666667, 34.866333333333344, 25.629333333333324, 16.15866666666666, 39.530666666666654, 28.647000000000006, 15.930333333333326, 32.605333333333334, 19.078, 20.65366666666666, 39.06, 23.106333333333332, 26.807999999999996, 54.98200000000002, 18.892999999999994, 41.10500000000002, 18.286666666666658, 32.352999999999966, 15.525333333333329, 14.704000000000002, 36.202, 17.842666666666663, 22.33766666666666, 28.62600000000001, 41.26833333333334, 48.64666666666665, 28.07699999999998, 25.242999999999988, 17.223999999999993, 18.296, 19.42699999999999, 41.406000000000006, 31.956999999999987, 20.651, 19.94333333333332, 19.980999999999998, 16.85299999999999, 19.25566666666666, 27.55233333333332, 16.99299999999999, 34.083666666666666, 27.076999999999984, 24.67433333333333, 18.64799999999999, 13.990333333333327], "episode_lengths": [76, 39, 51, 79, 98, 90, 91, 94, 66, 75, 83, 53, 83, 68, 38, 35, 39, 39, 46, 29, 36, 122, 37, 76, 55, 54, 61, 102, 84, 61, 77, 151, 74, 85, 67, 63, 32, 50, 74, 44, 52, 60, 51, 35, 77, 45, 70, 37, 77, 58, 43, 51, 51, 50, 53, 56, 86, 51, 31, 82, 52, 32, 68, 40, 46, 73, 51, 57, 87, 38, 82, 35, 68, 35, 29, 75, 36, 50, 55, 80, 75, 58, 64, 43, 41, 38, 77, 50, 45, 54, 40, 38, 39, 59, 37, 76, 74, 57, 49, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5530394756892754, "mean_inference_ms": 2.931827816851323, "mean_action_processing_ms": 0.5937061638451715, "mean_env_wait_ms": 0.14432401810502238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036398887634277344, "StateBufferConnector_ms": 0.02138805389404297, "ViewRequirementAgentConnector_ms": 0.5844085216522217}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.5635543414415, "num_env_steps_trained_throughput_per_sec": 423.5635543414415, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 7147.285, "sample_time_ms": 2673.543, "load_time_ms": 0.574, "load_throughput": 6969018.859, "learn_time_ms": 4450.665, "learn_throughput": 898.742, "synch_weights_time_ms": 20.638}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 6836, "training_iteration": 91, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-51-29", "timestamp": 1702018289, "time_this_iter_s": 9.475675821304321, "time_total_s": 21941.584442138672, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21941.584442138672, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 84.47692307692309, "ram_util_percent": 96.47692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0050244126974924e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 5.309322357177734, "policy_loss": -0.003674103645607829, "vf_loss": 5.312996864318848, "vf_explained_var": 0.6720742583274841, "kl": 0.002419534372165799, "entropy": 0.07652746140956879, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85095.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 56.96500000000002, "episode_reward_min": 13.621, "episode_reward_mean": 27.076039999999992, "episode_len_mean": 57.6, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.98200000000002, 18.892999999999994, 41.10500000000002, 18.286666666666658, 32.352999999999966, 15.525333333333329, 14.704000000000002, 36.202, 17.842666666666663, 22.33766666666666, 28.62600000000001, 41.26833333333334, 48.64666666666665, 28.07699999999998, 25.242999999999988, 17.223999999999993, 18.296, 19.42699999999999, 41.406000000000006, 31.956999999999987, 20.651, 19.94333333333332, 19.980999999999998, 16.85299999999999, 19.25566666666666, 27.55233333333332, 16.99299999999999, 34.083666666666666, 27.076999999999984, 24.67433333333333, 18.64799999999999, 13.990333333333327, 22.233666666666654, 31.80366666666668, 21.56866666666666, 31.757666666666644, 18.14899999999999, 56.14833333333331, 34.023666666666664, 21.505999999999997, 19.09966666666666, 19.318666666666665, 13.621, 44.33033333333333, 14.933666666666669, 37.27533333333333, 27.97366666666666, 27.72766666666666, 24.610333333333326, 24.93966666666665, 23.48499999999998, 31.24466666666667, 15.669999999999995, 46.98933333333328, 24.339999999999993, 31.687999999999985, 23.05933333333333, 34.80866666666664, 26.268666666666658, 19.942000000000004, 18.998999999999995, 17.751999999999995, 38.33966666666666, 40.48266666666666, 39.57266666666668, 17.52066666666667, 17.475999999999996, 24.866333333333323, 23.53466666666665, 28.160333333333337, 56.96500000000002, 25.516000000000002, 14.43333333333333, 20.708, 32.023333333333326, 49.702999999999996, 28.457999999999977, 18.31866666666666, 27.092666666666663, 20.42299999999999, 30.108999999999984, 27.070000000000007, 27.726999999999993, 14.489333333333331, 36.579999999999984, 15.387999999999998, 37.278999999999996, 47.274999999999984, 28.806999999999984, 18.101999999999993, 16.01433333333333, 23.243, 16.82233333333333, 45.66366666666667, 40.56866666666666, 23.58033333333333, 16.054999999999996, 22.151666666666664, 22.044333333333327, 37.667999999999985], "episode_lengths": [87, 38, 82, 35, 68, 35, 29, 75, 36, 50, 55, 80, 75, 58, 64, 43, 41, 38, 77, 50, 45, 54, 40, 38, 39, 59, 37, 76, 74, 57, 49, 30, 60, 56, 45, 64, 38, 108, 59, 46, 36, 40, 26, 100, 29, 75, 66, 60, 65, 58, 72, 71, 33, 103, 70, 76, 61, 99, 55, 37, 41, 37, 64, 66, 91, 34, 51, 54, 69, 67, 96, 46, 31, 41, 75, 96, 71, 39, 49, 46, 68, 55, 72, 31, 69, 29, 86, 100, 80, 45, 32, 45, 49, 90, 72, 48, 32, 53, 59, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5529561152613862, "mean_inference_ms": 2.9368668776693365, "mean_action_processing_ms": 0.5946864643213492, "mean_env_wait_ms": 0.1445472655979874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047814369201660156, "StateBufferConnector_ms": 0.01047062873840332, "ViewRequirementAgentConnector_ms": 0.572490930557251}}, "episode_reward_max": 56.96500000000002, "episode_reward_min": 13.621, "episode_reward_mean": 27.076039999999992, "episode_len_mean": 57.6, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.98200000000002, 18.892999999999994, 41.10500000000002, 18.286666666666658, 32.352999999999966, 15.525333333333329, 14.704000000000002, 36.202, 17.842666666666663, 22.33766666666666, 28.62600000000001, 41.26833333333334, 48.64666666666665, 28.07699999999998, 25.242999999999988, 17.223999999999993, 18.296, 19.42699999999999, 41.406000000000006, 31.956999999999987, 20.651, 19.94333333333332, 19.980999999999998, 16.85299999999999, 19.25566666666666, 27.55233333333332, 16.99299999999999, 34.083666666666666, 27.076999999999984, 24.67433333333333, 18.64799999999999, 13.990333333333327, 22.233666666666654, 31.80366666666668, 21.56866666666666, 31.757666666666644, 18.14899999999999, 56.14833333333331, 34.023666666666664, 21.505999999999997, 19.09966666666666, 19.318666666666665, 13.621, 44.33033333333333, 14.933666666666669, 37.27533333333333, 27.97366666666666, 27.72766666666666, 24.610333333333326, 24.93966666666665, 23.48499999999998, 31.24466666666667, 15.669999999999995, 46.98933333333328, 24.339999999999993, 31.687999999999985, 23.05933333333333, 34.80866666666664, 26.268666666666658, 19.942000000000004, 18.998999999999995, 17.751999999999995, 38.33966666666666, 40.48266666666666, 39.57266666666668, 17.52066666666667, 17.475999999999996, 24.866333333333323, 23.53466666666665, 28.160333333333337, 56.96500000000002, 25.516000000000002, 14.43333333333333, 20.708, 32.023333333333326, 49.702999999999996, 28.457999999999977, 18.31866666666666, 27.092666666666663, 20.42299999999999, 30.108999999999984, 27.070000000000007, 27.726999999999993, 14.489333333333331, 36.579999999999984, 15.387999999999998, 37.278999999999996, 47.274999999999984, 28.806999999999984, 18.101999999999993, 16.01433333333333, 23.243, 16.82233333333333, 45.66366666666667, 40.56866666666666, 23.58033333333333, 16.054999999999996, 22.151666666666664, 22.044333333333327, 37.667999999999985], "episode_lengths": [87, 38, 82, 35, 68, 35, 29, 75, 36, 50, 55, 80, 75, 58, 64, 43, 41, 38, 77, 50, 45, 54, 40, 38, 39, 59, 37, 76, 74, 57, 49, 30, 60, 56, 45, 64, 38, 108, 59, 46, 36, 40, 26, 100, 29, 75, 66, 60, 65, 58, 72, 71, 33, 103, 70, 76, 61, 99, 55, 37, 41, 37, 64, 66, 91, 34, 51, 54, 69, 67, 96, 46, 31, 41, 75, 96, 71, 39, 49, 46, 68, 55, 72, 31, 69, 29, 86, 100, 80, 45, 32, 45, 49, 90, 72, 48, 32, 53, 59, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5529561152613862, "mean_inference_ms": 2.9368668776693365, "mean_action_processing_ms": 0.5946864643213492, "mean_env_wait_ms": 0.1445472655979874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047814369201660156, "StateBufferConnector_ms": 0.01047062873840332, "ViewRequirementAgentConnector_ms": 0.572490930557251}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.09676579475655, "num_env_steps_trained_throughput_per_sec": 460.09676579475655, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 7337.468, "sample_time_ms": 2717.045, "load_time_ms": 0.586, "load_throughput": 6830001.628, "learn_time_ms": 4596.732, "learn_throughput": 870.183, "synch_weights_time_ms": 21.039}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 6904, "training_iteration": 92, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-51-38", "timestamp": 1702018298, "time_this_iter_s": 8.713821411132812, "time_total_s": 21950.298263549805, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21950.298263549805, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 85.49090909090908, "ram_util_percent": 97.13636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.025122063487462e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 6.080580234527588, "policy_loss": -0.0008604920003563166, "vf_loss": 6.0814409255981445, "vf_explained_var": 0.5772703886032104, "kl": 0.0013456691522151232, "entropy": 0.0803450420498848, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86025.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 65.88700000000001, "episode_reward_min": 13.096, "episode_reward_mean": 28.12147666666666, "episode_len_mean": 61.15, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.57266666666668, 17.52066666666667, 17.475999999999996, 24.866333333333323, 23.53466666666665, 28.160333333333337, 56.96500000000002, 25.516000000000002, 14.43333333333333, 20.708, 32.023333333333326, 49.702999999999996, 28.457999999999977, 18.31866666666666, 27.092666666666663, 20.42299999999999, 30.108999999999984, 27.070000000000007, 27.726999999999993, 14.489333333333331, 36.579999999999984, 15.387999999999998, 37.278999999999996, 47.274999999999984, 28.806999999999984, 18.101999999999993, 16.01433333333333, 23.243, 16.82233333333333, 45.66366666666667, 40.56866666666666, 23.58033333333333, 16.054999999999996, 22.151666666666664, 22.044333333333327, 37.667999999999985, 20.259, 32.22999999999999, 13.096, 16.958666666666662, 40.88599999999998, 17.383333333333326, 33.59466666666668, 54.05966666666667, 32.305, 15.799666666666663, 48.49566666666669, 17.647999999999993, 16.807, 17.148666666666667, 13.647666666666664, 27.429999999999975, 50.252, 23.773666666666657, 65.88700000000001, 38.899333333333324, 20.540666666666656, 27.04699999999999, 37.801333333333346, 58.13966666666661, 36.11000000000001, 21.571999999999996, 43.132666666666665, 29.83133333333332, 41.53133333333333, 18.226333333333336, 20.88633333333333, 31.515666666666647, 24.356999999999992, 21.203999999999983, 44.88966666666663, 17.666666666666664, 22.38466666666666, 26.794333333333324, 15.713666666666665, 18.763666666666662, 17.171333333333333, 34.62700000000001, 54.300999999999995, 24.066666666666656, 22.588999999999995, 26.391999999999996, 40.06133333333333, 16.417666666666662, 34.36833333333331, 27.03033333333332, 17.89733333333333, 32.12566666666666, 27.295666666666662, 15.154333333333328, 20.321333333333325, 32.382, 23.381333333333338, 24.77199999999999, 33.81166666666665, 16.481666666666662, 16.79899999999999, 16.698, 42.95266666666668, 28.972], "episode_lengths": [91, 34, 51, 54, 69, 67, 96, 46, 31, 41, 75, 96, 71, 39, 49, 46, 68, 55, 72, 31, 69, 29, 86, 100, 80, 45, 32, 45, 49, 90, 72, 48, 32, 53, 59, 59, 46, 57, 26, 36, 93, 41, 59, 114, 64, 31, 94, 35, 35, 33, 30, 67, 123, 44, 121, 87, 49, 55, 67, 138, 65, 47, 110, 92, 69, 38, 45, 72, 54, 63, 114, 45, 56, 62, 32, 35, 39, 68, 123, 41, 43, 70, 81, 32, 82, 83, 39, 84, 54, 33, 49, 87, 47, 73, 84, 41, 35, 37, 71, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5523935837551266, "mean_inference_ms": 2.9378424809282806, "mean_action_processing_ms": 0.5944913222652991, "mean_env_wait_ms": 0.1443397892063005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02520155906677246, "StateBufferConnector_ms": 0.013152837753295898, "ViewRequirementAgentConnector_ms": 0.48775458335876465}}, "episode_reward_max": 65.88700000000001, "episode_reward_min": 13.096, "episode_reward_mean": 28.12147666666666, "episode_len_mean": 61.15, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.57266666666668, 17.52066666666667, 17.475999999999996, 24.866333333333323, 23.53466666666665, 28.160333333333337, 56.96500000000002, 25.516000000000002, 14.43333333333333, 20.708, 32.023333333333326, 49.702999999999996, 28.457999999999977, 18.31866666666666, 27.092666666666663, 20.42299999999999, 30.108999999999984, 27.070000000000007, 27.726999999999993, 14.489333333333331, 36.579999999999984, 15.387999999999998, 37.278999999999996, 47.274999999999984, 28.806999999999984, 18.101999999999993, 16.01433333333333, 23.243, 16.82233333333333, 45.66366666666667, 40.56866666666666, 23.58033333333333, 16.054999999999996, 22.151666666666664, 22.044333333333327, 37.667999999999985, 20.259, 32.22999999999999, 13.096, 16.958666666666662, 40.88599999999998, 17.383333333333326, 33.59466666666668, 54.05966666666667, 32.305, 15.799666666666663, 48.49566666666669, 17.647999999999993, 16.807, 17.148666666666667, 13.647666666666664, 27.429999999999975, 50.252, 23.773666666666657, 65.88700000000001, 38.899333333333324, 20.540666666666656, 27.04699999999999, 37.801333333333346, 58.13966666666661, 36.11000000000001, 21.571999999999996, 43.132666666666665, 29.83133333333332, 41.53133333333333, 18.226333333333336, 20.88633333333333, 31.515666666666647, 24.356999999999992, 21.203999999999983, 44.88966666666663, 17.666666666666664, 22.38466666666666, 26.794333333333324, 15.713666666666665, 18.763666666666662, 17.171333333333333, 34.62700000000001, 54.300999999999995, 24.066666666666656, 22.588999999999995, 26.391999999999996, 40.06133333333333, 16.417666666666662, 34.36833333333331, 27.03033333333332, 17.89733333333333, 32.12566666666666, 27.295666666666662, 15.154333333333328, 20.321333333333325, 32.382, 23.381333333333338, 24.77199999999999, 33.81166666666665, 16.481666666666662, 16.79899999999999, 16.698, 42.95266666666668, 28.972], "episode_lengths": [91, 34, 51, 54, 69, 67, 96, 46, 31, 41, 75, 96, 71, 39, 49, 46, 68, 55, 72, 31, 69, 29, 86, 100, 80, 45, 32, 45, 49, 90, 72, 48, 32, 53, 59, 59, 46, 57, 26, 36, 93, 41, 59, 114, 64, 31, 94, 35, 35, 33, 30, 67, 123, 44, 121, 87, 49, 55, 67, 138, 65, 47, 110, 92, 69, 38, 45, 72, 54, 63, 114, 45, 56, 62, 32, 35, 39, 68, 123, 41, 43, 70, 81, 32, 82, 83, 39, 84, 54, 33, 49, 87, 47, 73, 84, 41, 35, 37, 71, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5523935837551266, "mean_inference_ms": 2.9378424809282806, "mean_action_processing_ms": 0.5944913222652991, "mean_env_wait_ms": 0.1443397892063005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02520155906677246, "StateBufferConnector_ms": 0.013152837753295898, "ViewRequirementAgentConnector_ms": 0.48775458335876465}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.7926790816861, "num_env_steps_trained_throughput_per_sec": 533.7926790816861, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 7501.377, "sample_time_ms": 2800.323, "load_time_ms": 0.685, "load_throughput": 5836162.382, "learn_time_ms": 4676.465, "learn_throughput": 855.347, "synch_weights_time_ms": 21.935}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 6968, "training_iteration": 93, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-51-46", "timestamp": 1702018306, "time_this_iter_s": 7.5095415115356445, "time_total_s": 21957.80780506134, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21957.80780506134, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 80.67, "ram_util_percent": 97.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.512561031743731e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 6.328000068664551, "policy_loss": -0.008698943071067333, "vf_loss": 6.33669900894165, "vf_explained_var": 0.5598217844963074, "kl": 0.0028421138413250446, "entropy": 0.0812176913022995, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86955.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 77.47366666666672, "episode_reward_min": 14.649999999999999, "episode_reward_mean": 29.329489999999993, "episode_len_mean": 62.36, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.53133333333333, 18.226333333333336, 20.88633333333333, 31.515666666666647, 24.356999999999992, 21.203999999999983, 44.88966666666663, 17.666666666666664, 22.38466666666666, 26.794333333333324, 15.713666666666665, 18.763666666666662, 17.171333333333333, 34.62700000000001, 54.300999999999995, 24.066666666666656, 22.588999999999995, 26.391999999999996, 40.06133333333333, 16.417666666666662, 34.36833333333331, 27.03033333333332, 17.89733333333333, 32.12566666666666, 27.295666666666662, 15.154333333333328, 20.321333333333325, 32.382, 23.381333333333338, 24.77199999999999, 33.81166666666665, 16.481666666666662, 16.79899999999999, 16.698, 42.95266666666668, 28.972, 28.764666666666667, 60.52733333333327, 34.43833333333332, 31.781333333333325, 14.649999999999999, 20.80899999999999, 19.380333333333322, 27.610999999999972, 24.13199999999999, 31.463666666666665, 16.829666666666665, 41.06099999999998, 36.13299999999998, 50.41533333333331, 25.028666666666663, 19.829666666666657, 25.47, 46.04033333333334, 32.208666666666666, 16.913, 59.99033333333328, 35.82633333333333, 54.72700000000003, 16.680333333333326, 27.385333333333335, 20.921333333333333, 40.02566666666665, 20.07866666666666, 42.639, 16.066999999999993, 18.84999999999999, 24.69066666666667, 27.62899999999999, 20.076333333333327, 15.381999999999996, 35.557, 22.108666666666657, 59.8316666666667, 21.404333333333316, 49.581666666666656, 20.19299999999999, 19.51666666666666, 24.01666666666666, 54.83033333333336, 20.229333333333333, 42.16900000000002, 16.90433333333333, 17.37233333333333, 25.99666666666666, 25.719333333333324, 28.730666666666668, 21.04433333333333, 47.00466666666663, 32.48833333333332, 30.470999999999997, 77.47366666666672, 23.523666666666657, 25.947666666666663, 19.441333333333322, 43.06366666666669, 36.45766666666667, 26.764666666666656, 41.412333333333365, 29.235666666666642], "episode_lengths": [69, 38, 45, 72, 54, 63, 114, 45, 56, 62, 32, 35, 39, 68, 123, 41, 43, 70, 81, 32, 82, 83, 39, 84, 54, 33, 49, 87, 47, 73, 84, 41, 35, 37, 71, 45, 60, 118, 83, 69, 33, 44, 42, 66, 48, 59, 34, 72, 86, 125, 45, 41, 56, 90, 55, 31, 130, 88, 121, 33, 56, 41, 64, 51, 78, 32, 47, 46, 61, 46, 37, 66, 44, 98, 44, 101, 43, 44, 59, 104, 43, 68, 44, 38, 54, 59, 60, 61, 111, 70, 67, 158, 44, 56, 39, 79, 66, 54, 79, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.551659383498508, "mean_inference_ms": 2.9359058940463796, "mean_action_processing_ms": 0.5946477168786308, "mean_env_wait_ms": 0.1442257796409713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020861148834228516, "StateBufferConnector_ms": 0.029550790786743164, "ViewRequirementAgentConnector_ms": 0.493710994720459}}, "episode_reward_max": 77.47366666666672, "episode_reward_min": 14.649999999999999, "episode_reward_mean": 29.329489999999993, "episode_len_mean": 62.36, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.53133333333333, 18.226333333333336, 20.88633333333333, 31.515666666666647, 24.356999999999992, 21.203999999999983, 44.88966666666663, 17.666666666666664, 22.38466666666666, 26.794333333333324, 15.713666666666665, 18.763666666666662, 17.171333333333333, 34.62700000000001, 54.300999999999995, 24.066666666666656, 22.588999999999995, 26.391999999999996, 40.06133333333333, 16.417666666666662, 34.36833333333331, 27.03033333333332, 17.89733333333333, 32.12566666666666, 27.295666666666662, 15.154333333333328, 20.321333333333325, 32.382, 23.381333333333338, 24.77199999999999, 33.81166666666665, 16.481666666666662, 16.79899999999999, 16.698, 42.95266666666668, 28.972, 28.764666666666667, 60.52733333333327, 34.43833333333332, 31.781333333333325, 14.649999999999999, 20.80899999999999, 19.380333333333322, 27.610999999999972, 24.13199999999999, 31.463666666666665, 16.829666666666665, 41.06099999999998, 36.13299999999998, 50.41533333333331, 25.028666666666663, 19.829666666666657, 25.47, 46.04033333333334, 32.208666666666666, 16.913, 59.99033333333328, 35.82633333333333, 54.72700000000003, 16.680333333333326, 27.385333333333335, 20.921333333333333, 40.02566666666665, 20.07866666666666, 42.639, 16.066999999999993, 18.84999999999999, 24.69066666666667, 27.62899999999999, 20.076333333333327, 15.381999999999996, 35.557, 22.108666666666657, 59.8316666666667, 21.404333333333316, 49.581666666666656, 20.19299999999999, 19.51666666666666, 24.01666666666666, 54.83033333333336, 20.229333333333333, 42.16900000000002, 16.90433333333333, 17.37233333333333, 25.99666666666666, 25.719333333333324, 28.730666666666668, 21.04433333333333, 47.00466666666663, 32.48833333333332, 30.470999999999997, 77.47366666666672, 23.523666666666657, 25.947666666666663, 19.441333333333322, 43.06366666666669, 36.45766666666667, 26.764666666666656, 41.412333333333365, 29.235666666666642], "episode_lengths": [69, 38, 45, 72, 54, 63, 114, 45, 56, 62, 32, 35, 39, 68, 123, 41, 43, 70, 81, 32, 82, 83, 39, 84, 54, 33, 49, 87, 47, 73, 84, 41, 35, 37, 71, 45, 60, 118, 83, 69, 33, 44, 42, 66, 48, 59, 34, 72, 86, 125, 45, 41, 56, 90, 55, 31, 130, 88, 121, 33, 56, 41, 64, 51, 78, 32, 47, 46, 61, 46, 37, 66, 44, 98, 44, 101, 43, 44, 59, 104, 43, 68, 44, 38, 54, 59, 60, 61, 111, 70, 67, 158, 44, 56, 39, 79, 66, 54, 79, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.551659383498508, "mean_inference_ms": 2.9359058940463796, "mean_action_processing_ms": 0.5946477168786308, "mean_env_wait_ms": 0.1442257796409713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020861148834228516, "StateBufferConnector_ms": 0.029550790786743164, "ViewRequirementAgentConnector_ms": 0.493710994720459}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 519.9452064083374, "num_env_steps_trained_throughput_per_sec": 519.9452064083374, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 7640.615, "sample_time_ms": 2830.497, "load_time_ms": 0.685, "load_throughput": 5836162.382, "learn_time_ms": 4785.573, "learn_throughput": 835.846, "synch_weights_time_ms": 22.032}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 7032, "training_iteration": 94, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-51-53", "timestamp": 1702018313, "time_this_iter_s": 7.709143877029419, "time_total_s": 21965.51694893837, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21965.51694893837, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 78.22, "ram_util_percent": 96.13}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2562805158718655e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 5.79492712020874, "policy_loss": -0.004261524882167578, "vf_loss": 5.799188613891602, "vf_explained_var": 0.5993462204933167, "kl": 0.0018554407870396972, "entropy": 0.07694222778081894, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 99.98000000000006, "episode_reward_min": 12.487666666666664, "episode_reward_mean": 29.464259999999996, "episode_len_mean": 61.96, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.07866666666666, 42.639, 16.066999999999993, 18.84999999999999, 24.69066666666667, 27.62899999999999, 20.076333333333327, 15.381999999999996, 35.557, 22.108666666666657, 59.8316666666667, 21.404333333333316, 49.581666666666656, 20.19299999999999, 19.51666666666666, 24.01666666666666, 54.83033333333336, 20.229333333333333, 42.16900000000002, 16.90433333333333, 17.37233333333333, 25.99666666666666, 25.719333333333324, 28.730666666666668, 21.04433333333333, 47.00466666666663, 32.48833333333332, 30.470999999999997, 77.47366666666672, 23.523666666666657, 25.947666666666663, 19.441333333333322, 43.06366666666669, 36.45766666666667, 26.764666666666656, 41.412333333333365, 29.235666666666642, 19.146999999999995, 15.576333333333332, 26.234999999999985, 32.41533333333332, 26.825333333333326, 16.54266666666666, 21.712999999999997, 33.72466666666667, 17.299, 20.71066666666666, 12.765666666666664, 16.2, 23.201666666666654, 17.36833333333333, 38.44399999999998, 12.487666666666664, 21.887333333333313, 19.01399999999999, 21.066333333333322, 24.794666666666654, 17.31566666666666, 33.701, 35.89499999999999, 28.775333333333336, 99.98000000000006, 18.679666666666662, 30.319000000000003, 16.760333333333335, 18.395666666666667, 40.13466666666666, 31.824666666666637, 45.43833333333333, 15.306333333333328, 18.992, 44.09766666666667, 46.53200000000002, 44.47233333333331, 28.97466666666666, 48.06599999999994, 38.559666666666665, 17.92066666666667, 20.741999999999987, 54.39533333333335, 29.189666666666653, 32.34799999999999, 31.715666666666678, 29.245666666666658, 34.492666666666665, 19.923999999999985, 14.920666666666657, 30.846666666666657, 26.586999999999975, 31.49033333333332, 30.209666666666642, 22.601999999999997, 33.68566666666667, 25.590333333333326, 17.324333333333325, 54.165666666666624, 28.77766666666666, 29.33299999999999, 47.390666666666704, 19.987], "episode_lengths": [51, 78, 32, 47, 46, 61, 46, 37, 66, 44, 98, 44, 101, 43, 44, 59, 104, 43, 68, 44, 38, 54, 59, 60, 61, 111, 70, 67, 158, 44, 56, 39, 79, 66, 54, 79, 69, 38, 31, 70, 70, 50, 36, 48, 69, 42, 38, 27, 37, 72, 36, 69, 26, 54, 41, 64, 77, 34, 55, 70, 55, 171, 38, 64, 35, 36, 102, 91, 92, 34, 45, 71, 77, 71, 65, 124, 74, 33, 51, 105, 51, 76, 69, 56, 77, 57, 31, 72, 72, 66, 86, 44, 54, 60, 49, 105, 53, 66, 92, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5494070663257469, "mean_inference_ms": 2.9313217246190186, "mean_action_processing_ms": 0.5946914855917358, "mean_env_wait_ms": 0.1440655788749647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01722121238708496, "StateBufferConnector_ms": 0.01883387565612793, "ViewRequirementAgentConnector_ms": 0.42511510848999023}}, "episode_reward_max": 99.98000000000006, "episode_reward_min": 12.487666666666664, "episode_reward_mean": 29.464259999999996, "episode_len_mean": 61.96, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.07866666666666, 42.639, 16.066999999999993, 18.84999999999999, 24.69066666666667, 27.62899999999999, 20.076333333333327, 15.381999999999996, 35.557, 22.108666666666657, 59.8316666666667, 21.404333333333316, 49.581666666666656, 20.19299999999999, 19.51666666666666, 24.01666666666666, 54.83033333333336, 20.229333333333333, 42.16900000000002, 16.90433333333333, 17.37233333333333, 25.99666666666666, 25.719333333333324, 28.730666666666668, 21.04433333333333, 47.00466666666663, 32.48833333333332, 30.470999999999997, 77.47366666666672, 23.523666666666657, 25.947666666666663, 19.441333333333322, 43.06366666666669, 36.45766666666667, 26.764666666666656, 41.412333333333365, 29.235666666666642, 19.146999999999995, 15.576333333333332, 26.234999999999985, 32.41533333333332, 26.825333333333326, 16.54266666666666, 21.712999999999997, 33.72466666666667, 17.299, 20.71066666666666, 12.765666666666664, 16.2, 23.201666666666654, 17.36833333333333, 38.44399999999998, 12.487666666666664, 21.887333333333313, 19.01399999999999, 21.066333333333322, 24.794666666666654, 17.31566666666666, 33.701, 35.89499999999999, 28.775333333333336, 99.98000000000006, 18.679666666666662, 30.319000000000003, 16.760333333333335, 18.395666666666667, 40.13466666666666, 31.824666666666637, 45.43833333333333, 15.306333333333328, 18.992, 44.09766666666667, 46.53200000000002, 44.47233333333331, 28.97466666666666, 48.06599999999994, 38.559666666666665, 17.92066666666667, 20.741999999999987, 54.39533333333335, 29.189666666666653, 32.34799999999999, 31.715666666666678, 29.245666666666658, 34.492666666666665, 19.923999999999985, 14.920666666666657, 30.846666666666657, 26.586999999999975, 31.49033333333332, 30.209666666666642, 22.601999999999997, 33.68566666666667, 25.590333333333326, 17.324333333333325, 54.165666666666624, 28.77766666666666, 29.33299999999999, 47.390666666666704, 19.987], "episode_lengths": [51, 78, 32, 47, 46, 61, 46, 37, 66, 44, 98, 44, 101, 43, 44, 59, 104, 43, 68, 44, 38, 54, 59, 60, 61, 111, 70, 67, 158, 44, 56, 39, 79, 66, 54, 79, 69, 38, 31, 70, 70, 50, 36, 48, 69, 42, 38, 27, 37, 72, 36, 69, 26, 54, 41, 64, 77, 34, 55, 70, 55, 171, 38, 64, 35, 36, 102, 91, 92, 34, 45, 71, 77, 71, 65, 124, 74, 33, 51, 105, 51, 76, 69, 56, 77, 57, 31, 72, 72, 66, 86, 44, 54, 60, 49, 105, 53, 66, 92, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5494070663257469, "mean_inference_ms": 2.9313217246190186, "mean_action_processing_ms": 0.5946914855917358, "mean_env_wait_ms": 0.1440655788749647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01722121238708496, "StateBufferConnector_ms": 0.01883387565612793, "ViewRequirementAgentConnector_ms": 0.42511510848999023}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 571.4553339510027, "num_env_steps_trained_throughput_per_sec": 571.4553339510027, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 7731.184, "sample_time_ms": 2839.638, "load_time_ms": 0.74, "load_throughput": 5404334.493, "learn_time_ms": 4867.612, "learn_throughput": 821.758, "synch_weights_time_ms": 21.432}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 7095, "training_iteration": 95, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-52-01", "timestamp": 1702018321, "time_this_iter_s": 7.016720771789551, "time_total_s": 21972.53366971016, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21972.53366971016, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 76.01, "ram_util_percent": 96.81}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.281402579359328e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 6.045778274536133, "policy_loss": -0.005971056409180164, "vf_loss": 6.051749229431152, "vf_explained_var": 0.5052850246429443, "kl": 0.00038394698640331626, "entropy": 0.0879204273223877, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88815.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 87.052, "episode_reward_min": 13.466666666666663, "episode_reward_mean": 29.77143333333333, "episode_len_mean": 63.39, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.824666666666637, 45.43833333333333, 15.306333333333328, 18.992, 44.09766666666667, 46.53200000000002, 44.47233333333331, 28.97466666666666, 48.06599999999994, 38.559666666666665, 17.92066666666667, 20.741999999999987, 54.39533333333335, 29.189666666666653, 32.34799999999999, 31.715666666666678, 29.245666666666658, 34.492666666666665, 19.923999999999985, 14.920666666666657, 30.846666666666657, 26.586999999999975, 31.49033333333332, 30.209666666666642, 22.601999999999997, 33.68566666666667, 25.590333333333326, 17.324333333333325, 54.165666666666624, 28.77766666666666, 29.33299999999999, 47.390666666666704, 19.987, 26.95966666666666, 46.96966666666667, 22.47599999999999, 35.03599999999999, 22.98666666666666, 73.82566666666669, 42.51933333333333, 31.082666666666675, 42.44033333333333, 20.134999999999987, 36.890333333333324, 18.71366666666666, 51.52033333333336, 21.204333333333338, 18.16366666666666, 32.256666666666646, 20.52233333333332, 18.913333333333327, 15.151333333333328, 42.38533333333334, 13.466666666666663, 17.56733333333333, 51.557000000000016, 15.697999999999999, 16.84999999999999, 21.03366666666666, 51.568666666666665, 23.964999999999986, 29.14866666666666, 36.28099999999997, 19.43333333333333, 16.861999999999995, 17.78966666666666, 16.203666666666663, 32.821, 27.75133333333332, 35.86600000000001, 21.071, 87.052, 36.29666666666667, 20.514333333333326, 46.31233333333334, 15.114666666666665, 16.010666666666662, 23.41233333333333, 23.81366666666667, 45.0183333333333, 24.523666666666667, 22.906000000000006, 26.349999999999998, 16.715666666666664, 28.269666666666662, 19.048666666666662, 18.64733333333333, 15.544333333333329, 18.658333333333324, 32.29533333333331, 21.902666666666658, 31.674999999999994, 16.92733333333333, 32.57433333333333, 43.87566666666666, 19.48666666666666, 20.05266666666666, 35.43999999999998, 41.095333333333336, 27.375333333333327], "episode_lengths": [91, 92, 34, 45, 71, 77, 71, 65, 124, 74, 33, 51, 105, 51, 76, 69, 56, 77, 57, 31, 72, 72, 66, 86, 44, 54, 60, 49, 105, 53, 66, 92, 52, 81, 94, 49, 71, 44, 112, 95, 61, 72, 52, 71, 42, 78, 38, 37, 85, 53, 42, 34, 95, 27, 38, 114, 39, 43, 46, 126, 52, 79, 106, 38, 34, 51, 35, 58, 59, 64, 47, 148, 95, 42, 88, 29, 35, 46, 40, 120, 49, 44, 45, 36, 56, 55, 47, 36, 43, 80, 52, 82, 36, 52, 78, 37, 36, 95, 85, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5469734908037938, "mean_inference_ms": 2.9266444890995427, "mean_action_processing_ms": 0.5933200085937738, "mean_env_wait_ms": 0.14381202754155695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01680302619934082, "StateBufferConnector_ms": 0.013068437576293945, "ViewRequirementAgentConnector_ms": 0.4043715000152588}}, "episode_reward_max": 87.052, "episode_reward_min": 13.466666666666663, "episode_reward_mean": 29.77143333333333, "episode_len_mean": 63.39, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.824666666666637, 45.43833333333333, 15.306333333333328, 18.992, 44.09766666666667, 46.53200000000002, 44.47233333333331, 28.97466666666666, 48.06599999999994, 38.559666666666665, 17.92066666666667, 20.741999999999987, 54.39533333333335, 29.189666666666653, 32.34799999999999, 31.715666666666678, 29.245666666666658, 34.492666666666665, 19.923999999999985, 14.920666666666657, 30.846666666666657, 26.586999999999975, 31.49033333333332, 30.209666666666642, 22.601999999999997, 33.68566666666667, 25.590333333333326, 17.324333333333325, 54.165666666666624, 28.77766666666666, 29.33299999999999, 47.390666666666704, 19.987, 26.95966666666666, 46.96966666666667, 22.47599999999999, 35.03599999999999, 22.98666666666666, 73.82566666666669, 42.51933333333333, 31.082666666666675, 42.44033333333333, 20.134999999999987, 36.890333333333324, 18.71366666666666, 51.52033333333336, 21.204333333333338, 18.16366666666666, 32.256666666666646, 20.52233333333332, 18.913333333333327, 15.151333333333328, 42.38533333333334, 13.466666666666663, 17.56733333333333, 51.557000000000016, 15.697999999999999, 16.84999999999999, 21.03366666666666, 51.568666666666665, 23.964999999999986, 29.14866666666666, 36.28099999999997, 19.43333333333333, 16.861999999999995, 17.78966666666666, 16.203666666666663, 32.821, 27.75133333333332, 35.86600000000001, 21.071, 87.052, 36.29666666666667, 20.514333333333326, 46.31233333333334, 15.114666666666665, 16.010666666666662, 23.41233333333333, 23.81366666666667, 45.0183333333333, 24.523666666666667, 22.906000000000006, 26.349999999999998, 16.715666666666664, 28.269666666666662, 19.048666666666662, 18.64733333333333, 15.544333333333329, 18.658333333333324, 32.29533333333331, 21.902666666666658, 31.674999999999994, 16.92733333333333, 32.57433333333333, 43.87566666666666, 19.48666666666666, 20.05266666666666, 35.43999999999998, 41.095333333333336, 27.375333333333327], "episode_lengths": [91, 92, 34, 45, 71, 77, 71, 65, 124, 74, 33, 51, 105, 51, 76, 69, 56, 77, 57, 31, 72, 72, 66, 86, 44, 54, 60, 49, 105, 53, 66, 92, 52, 81, 94, 49, 71, 44, 112, 95, 61, 72, 52, 71, 42, 78, 38, 37, 85, 53, 42, 34, 95, 27, 38, 114, 39, 43, 46, 126, 52, 79, 106, 38, 34, 51, 35, 58, 59, 64, 47, 148, 95, 42, 88, 29, 35, 46, 40, 120, 49, 44, 45, 36, 56, 55, 47, 36, 43, 80, 52, 82, 36, 52, 78, 37, 36, 95, 85, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5469734908037938, "mean_inference_ms": 2.9266444890995427, "mean_action_processing_ms": 0.5933200085937738, "mean_env_wait_ms": 0.14381202754155695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01680302619934082, "StateBufferConnector_ms": 0.013068437576293945, "ViewRequirementAgentConnector_ms": 0.4043715000152588}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.05699586527504, "num_env_steps_trained_throughput_per_sec": 467.05699586527504, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 7993.627, "sample_time_ms": 2889.912, "load_time_ms": 0.794, "load_throughput": 5035481.121, "learn_time_ms": 5079.978, "learn_throughput": 787.405, "synch_weights_time_ms": 21.24}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 7162, "training_iteration": 96, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-52-09", "timestamp": 1702018329, "time_this_iter_s": 8.578251123428345, "time_total_s": 21981.111920833588, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21981.111920833588, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 72.54166666666667, "ram_util_percent": 97.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.140701289679664e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 5.5844807624816895, "policy_loss": -0.004199193324893713, "vf_loss": 5.588679313659668, "vf_explained_var": 0.6272466778755188, "kl": 0.0006600468186661601, "entropy": 0.07688196748495102, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89745.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 87.052, "episode_reward_min": 14.750999999999994, "episode_reward_mean": 27.78999333333333, "episode_len_mean": 58.81, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.86600000000001, 21.071, 87.052, 36.29666666666667, 20.514333333333326, 46.31233333333334, 15.114666666666665, 16.010666666666662, 23.41233333333333, 23.81366666666667, 45.0183333333333, 24.523666666666667, 22.906000000000006, 26.349999999999998, 16.715666666666664, 28.269666666666662, 19.048666666666662, 18.64733333333333, 15.544333333333329, 18.658333333333324, 32.29533333333331, 21.902666666666658, 31.674999999999994, 16.92733333333333, 32.57433333333333, 43.87566666666666, 19.48666666666666, 20.05266666666666, 35.43999999999998, 41.095333333333336, 27.375333333333327, 22.037999999999997, 19.570666666666657, 17.716666666666658, 53.785, 22.916999999999994, 32.94066666666668, 32.479, 24.167666666666648, 17.035999999999994, 17.888999999999992, 26.329666666666654, 15.970999999999993, 24.76266666666665, 19.55566666666666, 24.152999999999984, 37.36799999999999, 27.407666666666675, 23.27066666666667, 40.109666666666655, 20.378999999999994, 17.029333333333334, 60.42166666666666, 20.06233333333333, 35.65133333333333, 31.294666666666668, 24.95899999999999, 46.56066666666669, 34.55433333333331, 26.322333333333326, 47.66066666666665, 23.025999999999996, 62.044, 21.350333333333328, 49.84333333333332, 27.93866666666665, 33.889999999999965, 17.75866666666666, 14.769333333333332, 30.22533333333332, 28.131000000000004, 17.18966666666666, 20.996666666666655, 26.639000000000003, 26.529666666666657, 35.92066666666667, 22.953999999999994, 16.477666666666664, 24.392333333333326, 21.84233333333332, 35.59033333333334, 14.750999999999994, 24.50466666666667, 22.581999999999997, 18.257999999999996, 24.146333333333306, 17.240666666666662, 19.363333333333326, 20.87433333333333, 22.654666666666657, 19.077666666666666, 29.439333333333323, 22.56999999999999, 58.43366666666664, 51.63699999999996, 17.256666666666664, 32.61033333333335, 23.79899999999999, 17.689333333333334, 16.393333333333334], "episode_lengths": [64, 47, 148, 95, 42, 88, 29, 35, 46, 40, 120, 49, 44, 45, 36, 56, 55, 47, 36, 43, 80, 52, 82, 36, 52, 78, 37, 36, 95, 85, 69, 45, 54, 35, 103, 50, 63, 68, 62, 38, 44, 58, 35, 72, 38, 49, 59, 50, 43, 89, 40, 31, 110, 38, 67, 61, 66, 89, 85, 44, 93, 43, 113, 38, 95, 51, 87, 36, 33, 76, 54, 46, 55, 58, 48, 83, 55, 39, 46, 57, 72, 36, 49, 60, 38, 66, 41, 53, 42, 51, 50, 53, 45, 88, 126, 45, 62, 74, 39, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5438802219662642, "mean_inference_ms": 2.9213675102572356, "mean_action_processing_ms": 0.5924615533038871, "mean_env_wait_ms": 0.14366863018170467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017360210418701172, "StateBufferConnector_ms": 0.01016688346862793, "ViewRequirementAgentConnector_ms": 0.4249236583709717}}, "episode_reward_max": 87.052, "episode_reward_min": 14.750999999999994, "episode_reward_mean": 27.78999333333333, "episode_len_mean": 58.81, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.86600000000001, 21.071, 87.052, 36.29666666666667, 20.514333333333326, 46.31233333333334, 15.114666666666665, 16.010666666666662, 23.41233333333333, 23.81366666666667, 45.0183333333333, 24.523666666666667, 22.906000000000006, 26.349999999999998, 16.715666666666664, 28.269666666666662, 19.048666666666662, 18.64733333333333, 15.544333333333329, 18.658333333333324, 32.29533333333331, 21.902666666666658, 31.674999999999994, 16.92733333333333, 32.57433333333333, 43.87566666666666, 19.48666666666666, 20.05266666666666, 35.43999999999998, 41.095333333333336, 27.375333333333327, 22.037999999999997, 19.570666666666657, 17.716666666666658, 53.785, 22.916999999999994, 32.94066666666668, 32.479, 24.167666666666648, 17.035999999999994, 17.888999999999992, 26.329666666666654, 15.970999999999993, 24.76266666666665, 19.55566666666666, 24.152999999999984, 37.36799999999999, 27.407666666666675, 23.27066666666667, 40.109666666666655, 20.378999999999994, 17.029333333333334, 60.42166666666666, 20.06233333333333, 35.65133333333333, 31.294666666666668, 24.95899999999999, 46.56066666666669, 34.55433333333331, 26.322333333333326, 47.66066666666665, 23.025999999999996, 62.044, 21.350333333333328, 49.84333333333332, 27.93866666666665, 33.889999999999965, 17.75866666666666, 14.769333333333332, 30.22533333333332, 28.131000000000004, 17.18966666666666, 20.996666666666655, 26.639000000000003, 26.529666666666657, 35.92066666666667, 22.953999999999994, 16.477666666666664, 24.392333333333326, 21.84233333333332, 35.59033333333334, 14.750999999999994, 24.50466666666667, 22.581999999999997, 18.257999999999996, 24.146333333333306, 17.240666666666662, 19.363333333333326, 20.87433333333333, 22.654666666666657, 19.077666666666666, 29.439333333333323, 22.56999999999999, 58.43366666666664, 51.63699999999996, 17.256666666666664, 32.61033333333335, 23.79899999999999, 17.689333333333334, 16.393333333333334], "episode_lengths": [64, 47, 148, 95, 42, 88, 29, 35, 46, 40, 120, 49, 44, 45, 36, 56, 55, 47, 36, 43, 80, 52, 82, 36, 52, 78, 37, 36, 95, 85, 69, 45, 54, 35, 103, 50, 63, 68, 62, 38, 44, 58, 35, 72, 38, 49, 59, 50, 43, 89, 40, 31, 110, 38, 67, 61, 66, 89, 85, 44, 93, 43, 113, 38, 95, 51, 87, 36, 33, 76, 54, 46, 55, 58, 48, 83, 55, 39, 46, 57, 72, 36, 49, 60, 38, 66, 41, 53, 42, 51, 50, 53, 45, 88, 126, 45, 62, 74, 39, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5438802219662642, "mean_inference_ms": 2.9213675102572356, "mean_action_processing_ms": 0.5924615533038871, "mean_env_wait_ms": 0.14366863018170467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017360210418701172, "StateBufferConnector_ms": 0.01016688346862793, "ViewRequirementAgentConnector_ms": 0.4249236583709717}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.8026634684886, "num_env_steps_trained_throughput_per_sec": 544.8026634684886, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 8091.61, "sample_time_ms": 2889.417, "load_time_ms": 0.723, "load_throughput": 5532287.806, "learn_time_ms": 5179.331, "learn_throughput": 772.301, "synch_weights_time_ms": 20.542}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 7231, "training_iteration": 97, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-52-17", "timestamp": 1702018337, "time_this_iter_s": 7.474654912948608, "time_total_s": 21988.586575746536, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21988.586575746536, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 81.80999999999999, "ram_util_percent": 98.13}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.570350644839832e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 6.305614471435547, "policy_loss": -0.012239553034305573, "vf_loss": 6.317854404449463, "vf_explained_var": 0.5680513381958008, "kl": 0.034632258117198944, "entropy": 0.14405687153339386, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90675.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 84.475, "episode_reward_min": 13.333666666666662, "episode_reward_mean": 27.524906666666656, "episode_len_mean": 58.16, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.889999999999965, 17.75866666666666, 14.769333333333332, 30.22533333333332, 28.131000000000004, 17.18966666666666, 20.996666666666655, 26.639000000000003, 26.529666666666657, 35.92066666666667, 22.953999999999994, 16.477666666666664, 24.392333333333326, 21.84233333333332, 35.59033333333334, 14.750999999999994, 24.50466666666667, 22.581999999999997, 18.257999999999996, 24.146333333333306, 17.240666666666662, 19.363333333333326, 20.87433333333333, 22.654666666666657, 19.077666666666666, 29.439333333333323, 22.56999999999999, 58.43366666666664, 51.63699999999996, 17.256666666666664, 32.61033333333335, 23.79899999999999, 17.689333333333334, 16.393333333333334, 16.310333333333336, 23.546333333333322, 29.945666666666675, 34.74499999999998, 27.25633333333331, 51.54400000000004, 30.021666666666658, 29.880999999999993, 34.94933333333334, 16.664333333333325, 33.839666666666645, 49.38433333333335, 21.684999999999995, 45.84033333333335, 33.94533333333333, 26.455999999999992, 21.877333333333322, 40.553666666666665, 41.18899999999997, 13.333666666666662, 36.78966666666667, 30.546333333333333, 15.773999999999996, 33.9, 22.121, 15.570999999999998, 18.145999999999997, 15.985333333333326, 84.475, 54.56600000000007, 15.319333333333327, 24.51533333333333, 22.546666666666653, 15.340333333333328, 21.759000000000007, 27.385999999999992, 17.223666666666666, 45.10666666666663, 30.603, 36.42733333333331, 22.413666666666646, 32.394000000000005, 16.590999999999998, 40.412000000000006, 28.63299999999999, 27.990666666666662, 15.522999999999996, 52.86433333333333, 18.37666666666666, 16.611666666666665, 30.75, 36.28999999999999, 24.593999999999994, 20.849999999999994, 22.102666666666668, 17.108666666666657, 16.868333333333332, 56.695333333333316, 26.676999999999992, 33.562333333333335, 22.061666666666657, 21.091999999999985, 16.679666666666662, 37.31466666666667, 24.459999999999965, 19.91633333333333], "episode_lengths": [87, 36, 33, 76, 54, 46, 55, 58, 48, 83, 55, 39, 46, 57, 72, 36, 49, 60, 38, 66, 41, 53, 42, 51, 50, 53, 45, 88, 126, 45, 62, 74, 39, 32, 40, 44, 63, 70, 76, 105, 52, 52, 65, 36, 87, 96, 42, 80, 67, 61, 53, 78, 84, 30, 63, 60, 33, 62, 40, 31, 35, 38, 132, 101, 37, 48, 55, 30, 38, 57, 35, 77, 58, 87, 63, 58, 36, 73, 48, 59, 32, 126, 42, 42, 57, 67, 43, 40, 44, 45, 32, 93, 64, 59, 67, 53, 34, 89, 95, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.543576970086117, "mean_inference_ms": 2.92431590375768, "mean_action_processing_ms": 0.5923460531777259, "mean_env_wait_ms": 0.14360937653803224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01926875114440918, "StateBufferConnector_ms": 0.013922691345214844, "ViewRequirementAgentConnector_ms": 0.4700586795806885}}, "episode_reward_max": 84.475, "episode_reward_min": 13.333666666666662, "episode_reward_mean": 27.524906666666656, "episode_len_mean": 58.16, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.889999999999965, 17.75866666666666, 14.769333333333332, 30.22533333333332, 28.131000000000004, 17.18966666666666, 20.996666666666655, 26.639000000000003, 26.529666666666657, 35.92066666666667, 22.953999999999994, 16.477666666666664, 24.392333333333326, 21.84233333333332, 35.59033333333334, 14.750999999999994, 24.50466666666667, 22.581999999999997, 18.257999999999996, 24.146333333333306, 17.240666666666662, 19.363333333333326, 20.87433333333333, 22.654666666666657, 19.077666666666666, 29.439333333333323, 22.56999999999999, 58.43366666666664, 51.63699999999996, 17.256666666666664, 32.61033333333335, 23.79899999999999, 17.689333333333334, 16.393333333333334, 16.310333333333336, 23.546333333333322, 29.945666666666675, 34.74499999999998, 27.25633333333331, 51.54400000000004, 30.021666666666658, 29.880999999999993, 34.94933333333334, 16.664333333333325, 33.839666666666645, 49.38433333333335, 21.684999999999995, 45.84033333333335, 33.94533333333333, 26.455999999999992, 21.877333333333322, 40.553666666666665, 41.18899999999997, 13.333666666666662, 36.78966666666667, 30.546333333333333, 15.773999999999996, 33.9, 22.121, 15.570999999999998, 18.145999999999997, 15.985333333333326, 84.475, 54.56600000000007, 15.319333333333327, 24.51533333333333, 22.546666666666653, 15.340333333333328, 21.759000000000007, 27.385999999999992, 17.223666666666666, 45.10666666666663, 30.603, 36.42733333333331, 22.413666666666646, 32.394000000000005, 16.590999999999998, 40.412000000000006, 28.63299999999999, 27.990666666666662, 15.522999999999996, 52.86433333333333, 18.37666666666666, 16.611666666666665, 30.75, 36.28999999999999, 24.593999999999994, 20.849999999999994, 22.102666666666668, 17.108666666666657, 16.868333333333332, 56.695333333333316, 26.676999999999992, 33.562333333333335, 22.061666666666657, 21.091999999999985, 16.679666666666662, 37.31466666666667, 24.459999999999965, 19.91633333333333], "episode_lengths": [87, 36, 33, 76, 54, 46, 55, 58, 48, 83, 55, 39, 46, 57, 72, 36, 49, 60, 38, 66, 41, 53, 42, 51, 50, 53, 45, 88, 126, 45, 62, 74, 39, 32, 40, 44, 63, 70, 76, 105, 52, 52, 65, 36, 87, 96, 42, 80, 67, 61, 53, 78, 84, 30, 63, 60, 33, 62, 40, 31, 35, 38, 132, 101, 37, 48, 55, 30, 38, 57, 35, 77, 58, 87, 63, 58, 36, 73, 48, 59, 32, 126, 42, 42, 57, 67, 43, 40, 44, 45, 32, 93, 64, 59, 67, 53, 34, 89, 95, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.543576970086117, "mean_inference_ms": 2.92431590375768, "mean_action_processing_ms": 0.5923460531777259, "mean_env_wait_ms": 0.14360937653803224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01926875114440918, "StateBufferConnector_ms": 0.013922691345214844, "ViewRequirementAgentConnector_ms": 0.4700586795806885}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.5738494298719, "num_env_steps_trained_throughput_per_sec": 383.5738494298719, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 8294.587, "sample_time_ms": 2913.749, "load_time_ms": 0.723, "load_throughput": 5532287.806, "learn_time_ms": 5357.99, "learn_throughput": 746.549, "synch_weights_time_ms": 20.442}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 7297, "training_iteration": 98, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-52-27", "timestamp": 1702018347, "time_this_iter_s": 10.456235647201538, "time_total_s": 21999.042811393738, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21999.042811393738, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 91.04999999999998, "ram_util_percent": 96.49285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3555260905192643e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 4.862950801849365, "policy_loss": -0.0070038847625255585, "vf_loss": 4.869955539703369, "vf_explained_var": 0.658778190612793, "kl": 0.0044207521714270115, "entropy": 0.12692274153232574, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91605.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 56.695333333333316, "episode_reward_min": 13.301666666666666, "episode_reward_mean": 25.16289666666666, "episode_len_mean": 54.91, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.412000000000006, 28.63299999999999, 27.990666666666662, 15.522999999999996, 52.86433333333333, 18.37666666666666, 16.611666666666665, 30.75, 36.28999999999999, 24.593999999999994, 20.849999999999994, 22.102666666666668, 17.108666666666657, 16.868333333333332, 56.695333333333316, 26.676999999999992, 33.562333333333335, 22.061666666666657, 21.091999999999985, 16.679666666666662, 37.31466666666667, 24.459999999999965, 19.91633333333333, 35.791000000000025, 30.04499999999999, 28.230999999999987, 16.612999999999992, 35.27800000000001, 23.341666666666658, 29.349000000000004, 19.87666666666667, 14.32666666666666, 41.87800000000001, 17.462666666666657, 49.67366666666664, 23.793333333333333, 18.129999999999995, 24.091333333333328, 44.04099999999998, 17.11633333333333, 21.008333333333322, 19.05, 16.140666666666657, 20.191999999999993, 26.273999999999994, 17.505333333333333, 22.05466666666666, 24.877999999999997, 14.654333333333332, 18.834000000000003, 26.475999999999996, 14.680000000000001, 19.840999999999994, 19.979999999999993, 33.98666666666666, 33.66433333333334, 26.74299999999999, 21.281999999999993, 25.783999999999963, 22.410000000000004, 32.60533333333332, 33.303, 37.747999999999955, 33.57566666666668, 22.627999999999997, 14.583666666666664, 18.11366666666666, 33.75133333333335, 14.655666666666658, 40.57666666666665, 29.55366666666667, 43.22866666666667, 16.58566666666666, 18.27833333333332, 24.266999999999992, 34.81899999999998, 28.32166666666668, 26.166999999999994, 14.912999999999993, 18.47066666666666, 15.254666666666656, 13.863666666666658, 31.308999999999987, 14.726999999999995, 31.328333333333315, 22.759666666666664, 27.022333333333332, 24.34666666666666, 16.539666666666665, 42.16833333333335, 13.301666666666666, 13.368666666666664, 17.527666666666658, 19.020666666666664, 34.799, 17.141666666666662, 27.358999999999984, 21.648999999999983, 14.31133333333333, 20.43533333333334], "episode_lengths": [73, 48, 59, 32, 126, 42, 42, 57, 67, 43, 40, 44, 45, 32, 93, 64, 59, 67, 53, 34, 89, 95, 62, 86, 59, 72, 40, 63, 55, 70, 45, 29, 76, 42, 97, 46, 42, 55, 78, 37, 52, 41, 36, 44, 63, 43, 45, 47, 30, 43, 56, 35, 42, 57, 66, 78, 67, 63, 69, 52, 76, 65, 102, 61, 48, 30, 44, 60, 30, 77, 54, 75, 38, 44, 55, 73, 69, 62, 30, 43, 35, 34, 78, 32, 75, 46, 62, 61, 33, 76, 27, 30, 37, 40, 80, 33, 57, 54, 31, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5471888436918335, "mean_inference_ms": 2.9287166188843377, "mean_action_processing_ms": 0.5929630740179355, "mean_env_wait_ms": 0.14395956115293626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015327930450439453, "StateBufferConnector_ms": 0.015871047973632812, "ViewRequirementAgentConnector_ms": 0.5938184261322021}}, "episode_reward_max": 56.695333333333316, "episode_reward_min": 13.301666666666666, "episode_reward_mean": 25.16289666666666, "episode_len_mean": 54.91, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.412000000000006, 28.63299999999999, 27.990666666666662, 15.522999999999996, 52.86433333333333, 18.37666666666666, 16.611666666666665, 30.75, 36.28999999999999, 24.593999999999994, 20.849999999999994, 22.102666666666668, 17.108666666666657, 16.868333333333332, 56.695333333333316, 26.676999999999992, 33.562333333333335, 22.061666666666657, 21.091999999999985, 16.679666666666662, 37.31466666666667, 24.459999999999965, 19.91633333333333, 35.791000000000025, 30.04499999999999, 28.230999999999987, 16.612999999999992, 35.27800000000001, 23.341666666666658, 29.349000000000004, 19.87666666666667, 14.32666666666666, 41.87800000000001, 17.462666666666657, 49.67366666666664, 23.793333333333333, 18.129999999999995, 24.091333333333328, 44.04099999999998, 17.11633333333333, 21.008333333333322, 19.05, 16.140666666666657, 20.191999999999993, 26.273999999999994, 17.505333333333333, 22.05466666666666, 24.877999999999997, 14.654333333333332, 18.834000000000003, 26.475999999999996, 14.680000000000001, 19.840999999999994, 19.979999999999993, 33.98666666666666, 33.66433333333334, 26.74299999999999, 21.281999999999993, 25.783999999999963, 22.410000000000004, 32.60533333333332, 33.303, 37.747999999999955, 33.57566666666668, 22.627999999999997, 14.583666666666664, 18.11366666666666, 33.75133333333335, 14.655666666666658, 40.57666666666665, 29.55366666666667, 43.22866666666667, 16.58566666666666, 18.27833333333332, 24.266999999999992, 34.81899999999998, 28.32166666666668, 26.166999999999994, 14.912999999999993, 18.47066666666666, 15.254666666666656, 13.863666666666658, 31.308999999999987, 14.726999999999995, 31.328333333333315, 22.759666666666664, 27.022333333333332, 24.34666666666666, 16.539666666666665, 42.16833333333335, 13.301666666666666, 13.368666666666664, 17.527666666666658, 19.020666666666664, 34.799, 17.141666666666662, 27.358999999999984, 21.648999999999983, 14.31133333333333, 20.43533333333334], "episode_lengths": [73, 48, 59, 32, 126, 42, 42, 57, 67, 43, 40, 44, 45, 32, 93, 64, 59, 67, 53, 34, 89, 95, 62, 86, 59, 72, 40, 63, 55, 70, 45, 29, 76, 42, 97, 46, 42, 55, 78, 37, 52, 41, 36, 44, 63, 43, 45, 47, 30, 43, 56, 35, 42, 57, 66, 78, 67, 63, 69, 52, 76, 65, 102, 61, 48, 30, 44, 60, 30, 77, 54, 75, 38, 44, 55, 73, 69, 62, 30, 43, 35, 34, 78, 32, 75, 46, 62, 61, 33, 76, 27, 30, 37, 40, 80, 33, 57, 54, 31, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5471888436918335, "mean_inference_ms": 2.9287166188843377, "mean_action_processing_ms": 0.5929630740179355, "mean_env_wait_ms": 0.14395956115293626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015327930450439453, "StateBufferConnector_ms": 0.015871047973632812, "ViewRequirementAgentConnector_ms": 0.5938184261322021}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.31055306831416, "num_env_steps_trained_throughput_per_sec": 429.31055306831416, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 8452.214, "sample_time_ms": 3015.525, "load_time_ms": 0.823, "load_throughput": 4859299.079, "learn_time_ms": 5412.616, "learn_throughput": 739.014, "synch_weights_time_ms": 21.568}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 7374, "training_iteration": 99, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-52-37", "timestamp": 1702018357, "time_this_iter_s": 9.351253509521484, "time_total_s": 22008.39406490326, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22008.39406490326, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 84.26923076923077, "ram_util_percent": 93.5153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1777630452596321e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 5.119834899902344, "policy_loss": -0.009709818288683891, "vf_loss": 5.129544734954834, "vf_explained_var": 0.6934999823570251, "kl": 0.0031574275344610214, "entropy": 0.1128273606300354, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92535.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 58.55933333333332, "episode_reward_min": 13.301666666666666, "episode_reward_mean": 24.306469999999994, "episode_len_mean": 53.75, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.27833333333332, 24.266999999999992, 34.81899999999998, 28.32166666666668, 26.166999999999994, 14.912999999999993, 18.47066666666666, 15.254666666666656, 13.863666666666658, 31.308999999999987, 14.726999999999995, 31.328333333333315, 22.759666666666664, 27.022333333333332, 24.34666666666666, 16.539666666666665, 42.16833333333335, 13.301666666666666, 13.368666666666664, 17.527666666666658, 19.020666666666664, 34.799, 17.141666666666662, 27.358999999999984, 21.648999999999983, 14.31133333333333, 20.43533333333334, 22.07899999999999, 26.65866666666665, 21.18166666666667, 18.98033333333332, 30.912666666666667, 15.921000000000001, 13.681666666666663, 13.663999999999998, 27.34633333333331, 16.92366666666666, 16.212666666666664, 45.483666666666664, 22.984666666666662, 36.318, 18.935999999999996, 16.62733333333333, 14.959999999999999, 20.165666666666652, 21.328333333333333, 18.01899999999999, 29.146666666666672, 19.538666666666657, 22.477666666666646, 35.086333333333336, 35.956999999999994, 17.00233333333333, 47.87433333333333, 31.092333333333304, 19.839999999999996, 17.969666666666654, 19.905333333333324, 13.922333333333327, 25.672000000000004, 15.804333333333325, 30.177333333333312, 28.537666666666667, 27.434000000000008, 17.73666666666666, 15.324333333333326, 25.795666666666662, 22.674000000000003, 14.131000000000002, 27.71266666666666, 34.39466666666665, 28.803666666666658, 24.836999999999986, 34.20399999999999, 34.03433333333332, 23.745000000000005, 21.988999999999994, 31.88, 15.756999999999996, 15.438333333333327, 24.79199999999999, 21.027333333333324, 18.342999999999993, 22.69366666666666, 21.366666666666656, 18.30766666666667, 58.55933333333332, 27.96466666666667, 39.94300000000001, 40.87766666666667, 20.660333333333334, 26.40633333333333, 38.905333333333324, 24.42699999999999, 21.70066666666666, 23.47833333333332, 36.916, 18.194333333333326, 29.14199999999998, 29.191999999999997], "episode_lengths": [44, 55, 73, 69, 62, 30, 43, 35, 34, 78, 32, 75, 46, 62, 61, 33, 76, 27, 30, 37, 40, 80, 33, 57, 54, 31, 47, 49, 75, 51, 56, 74, 31, 31, 34, 72, 34, 31, 88, 54, 76, 55, 39, 34, 44, 56, 34, 54, 40, 65, 63, 76, 36, 97, 97, 52, 36, 51, 28, 53, 37, 84, 64, 48, 41, 36, 55, 47, 29, 48, 77, 56, 62, 59, 67, 40, 45, 78, 32, 37, 55, 43, 45, 47, 57, 36, 125, 63, 81, 80, 39, 50, 98, 56, 46, 63, 74, 38, 61, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5576047580010155, "mean_inference_ms": 2.9572518041462104, "mean_action_processing_ms": 0.5966946650922966, "mean_env_wait_ms": 0.14472657344636905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10265922546386719, "StateBufferConnector_ms": 0.0194094181060791, "ViewRequirementAgentConnector_ms": 1.0643413066864014}}, "episode_reward_max": 58.55933333333332, "episode_reward_min": 13.301666666666666, "episode_reward_mean": 24.306469999999994, "episode_len_mean": 53.75, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.27833333333332, 24.266999999999992, 34.81899999999998, 28.32166666666668, 26.166999999999994, 14.912999999999993, 18.47066666666666, 15.254666666666656, 13.863666666666658, 31.308999999999987, 14.726999999999995, 31.328333333333315, 22.759666666666664, 27.022333333333332, 24.34666666666666, 16.539666666666665, 42.16833333333335, 13.301666666666666, 13.368666666666664, 17.527666666666658, 19.020666666666664, 34.799, 17.141666666666662, 27.358999999999984, 21.648999999999983, 14.31133333333333, 20.43533333333334, 22.07899999999999, 26.65866666666665, 21.18166666666667, 18.98033333333332, 30.912666666666667, 15.921000000000001, 13.681666666666663, 13.663999999999998, 27.34633333333331, 16.92366666666666, 16.212666666666664, 45.483666666666664, 22.984666666666662, 36.318, 18.935999999999996, 16.62733333333333, 14.959999999999999, 20.165666666666652, 21.328333333333333, 18.01899999999999, 29.146666666666672, 19.538666666666657, 22.477666666666646, 35.086333333333336, 35.956999999999994, 17.00233333333333, 47.87433333333333, 31.092333333333304, 19.839999999999996, 17.969666666666654, 19.905333333333324, 13.922333333333327, 25.672000000000004, 15.804333333333325, 30.177333333333312, 28.537666666666667, 27.434000000000008, 17.73666666666666, 15.324333333333326, 25.795666666666662, 22.674000000000003, 14.131000000000002, 27.71266666666666, 34.39466666666665, 28.803666666666658, 24.836999999999986, 34.20399999999999, 34.03433333333332, 23.745000000000005, 21.988999999999994, 31.88, 15.756999999999996, 15.438333333333327, 24.79199999999999, 21.027333333333324, 18.342999999999993, 22.69366666666666, 21.366666666666656, 18.30766666666667, 58.55933333333332, 27.96466666666667, 39.94300000000001, 40.87766666666667, 20.660333333333334, 26.40633333333333, 38.905333333333324, 24.42699999999999, 21.70066666666666, 23.47833333333332, 36.916, 18.194333333333326, 29.14199999999998, 29.191999999999997], "episode_lengths": [44, 55, 73, 69, 62, 30, 43, 35, 34, 78, 32, 75, 46, 62, 61, 33, 76, 27, 30, 37, 40, 80, 33, 57, 54, 31, 47, 49, 75, 51, 56, 74, 31, 31, 34, 72, 34, 31, 88, 54, 76, 55, 39, 34, 44, 56, 34, 54, 40, 65, 63, 76, 36, 97, 97, 52, 36, 51, 28, 53, 37, 84, 64, 48, 41, 36, 55, 47, 29, 48, 77, 56, 62, 59, 67, 40, 45, 78, 32, 37, 55, 43, 45, 47, 57, 36, 125, 63, 81, 80, 39, 50, 98, 56, 46, 63, 74, 38, 61, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5576047580010155, "mean_inference_ms": 2.9572518041462104, "mean_action_processing_ms": 0.5966946650922966, "mean_env_wait_ms": 0.14472657344636905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10265922546386719, "StateBufferConnector_ms": 0.0194094181060791, "ViewRequirementAgentConnector_ms": 1.0643413066864014}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.6768742807824, "num_env_steps_trained_throughput_per_sec": 320.6768742807824, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 8844.734, "sample_time_ms": 3406.067, "load_time_ms": 0.775, "load_throughput": 5164444.992, "learn_time_ms": 5413.125, "learn_throughput": 738.945, "synch_weights_time_ms": 23.006}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 7447, "training_iteration": 100, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-52-49", "timestamp": 1702018369, "time_this_iter_s": 12.524615287780762, "time_total_s": 22020.91868019104, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22020.91868019104, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 87.53571428571429, "ram_util_percent": 94.67142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.888815226298161e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 6.140579700469971, "policy_loss": -0.008931789547204971, "vf_loss": 6.149511814117432, "vf_explained_var": 0.5518316626548767, "kl": 0.0029396151658147573, "entropy": 0.10762695968151093, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": 62.637666666666675, "episode_reward_min": 13.710999999999999, "episode_reward_mean": 28.09439666666667, "episode_len_mean": 59.68, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.73666666666666, 15.324333333333326, 25.795666666666662, 22.674000000000003, 14.131000000000002, 27.71266666666666, 34.39466666666665, 28.803666666666658, 24.836999999999986, 34.20399999999999, 34.03433333333332, 23.745000000000005, 21.988999999999994, 31.88, 15.756999999999996, 15.438333333333327, 24.79199999999999, 21.027333333333324, 18.342999999999993, 22.69366666666666, 21.366666666666656, 18.30766666666667, 58.55933333333332, 27.96466666666667, 39.94300000000001, 40.87766666666667, 20.660333333333334, 26.40633333333333, 38.905333333333324, 24.42699999999999, 21.70066666666666, 23.47833333333332, 36.916, 18.194333333333326, 29.14199999999998, 29.191999999999997, 26.210999999999988, 50.944666666666706, 30.913666666666657, 16.674666666666656, 20.030999999999995, 27.547666666666665, 19.738000000000007, 20.43733333333333, 21.285, 42.58533333333331, 15.94666666666666, 38.90533333333334, 20.547666666666657, 29.781666666666663, 20.015333333333327, 35.810999999999986, 42.604666666666695, 32.44, 39.250666666666675, 33.00966666666667, 14.764999999999999, 48.24566666666667, 18.449333333333332, 19.158666666666665, 33.10700000000002, 16.580666666666666, 13.710999999999999, 25.60066666666666, 21.52966666666666, 17.257666666666665, 23.214999999999993, 27.280333333333335, 22.43966666666667, 38.60699999999999, 16.779000000000003, 24.129999999999995, 29.556666666666647, 21.346000000000004, 39.21633333333335, 34.41533333333332, 42.103666666666676, 17.54566666666666, 22.17933333333332, 62.637666666666675, 38.87766666666665, 52.47900000000001, 20.998999999999985, 16.211999999999996, 27.32499999999998, 22.627666666666652, 49.48599999999997, 46.50933333333333, 23.792666666666666, 16.213333333333328, 17.466999999999995, 25.02133333333332, 58.29333333333332, 44.684, 19.10166666666666, 24.156666666666663, 26.943666666666648, 36.34533333333333, 24.241666666666667, 32.77066666666668], "episode_lengths": [41, 36, 55, 47, 29, 48, 77, 56, 62, 59, 67, 40, 45, 78, 32, 37, 55, 43, 45, 47, 57, 36, 125, 63, 81, 80, 39, 50, 98, 56, 46, 63, 74, 38, 61, 66, 43, 96, 70, 48, 46, 58, 48, 53, 45, 83, 34, 111, 44, 58, 41, 80, 79, 61, 73, 56, 30, 87, 52, 43, 72, 35, 28, 58, 48, 32, 73, 48, 44, 76, 42, 47, 87, 53, 69, 72, 87, 41, 56, 128, 85, 96, 59, 34, 76, 45, 85, 114, 43, 36, 42, 69, 98, 76, 44, 45, 73, 69, 51, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.559833050580826, "mean_inference_ms": 2.9694468799884794, "mean_action_processing_ms": 0.5979963506278904, "mean_env_wait_ms": 0.1448108694034557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10239219665527344, "StateBufferConnector_ms": 0.013324975967407227, "ViewRequirementAgentConnector_ms": 0.8224508762359619}}, "episode_reward_max": 62.637666666666675, "episode_reward_min": 13.710999999999999, "episode_reward_mean": 28.09439666666667, "episode_len_mean": 59.68, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.73666666666666, 15.324333333333326, 25.795666666666662, 22.674000000000003, 14.131000000000002, 27.71266666666666, 34.39466666666665, 28.803666666666658, 24.836999999999986, 34.20399999999999, 34.03433333333332, 23.745000000000005, 21.988999999999994, 31.88, 15.756999999999996, 15.438333333333327, 24.79199999999999, 21.027333333333324, 18.342999999999993, 22.69366666666666, 21.366666666666656, 18.30766666666667, 58.55933333333332, 27.96466666666667, 39.94300000000001, 40.87766666666667, 20.660333333333334, 26.40633333333333, 38.905333333333324, 24.42699999999999, 21.70066666666666, 23.47833333333332, 36.916, 18.194333333333326, 29.14199999999998, 29.191999999999997, 26.210999999999988, 50.944666666666706, 30.913666666666657, 16.674666666666656, 20.030999999999995, 27.547666666666665, 19.738000000000007, 20.43733333333333, 21.285, 42.58533333333331, 15.94666666666666, 38.90533333333334, 20.547666666666657, 29.781666666666663, 20.015333333333327, 35.810999999999986, 42.604666666666695, 32.44, 39.250666666666675, 33.00966666666667, 14.764999999999999, 48.24566666666667, 18.449333333333332, 19.158666666666665, 33.10700000000002, 16.580666666666666, 13.710999999999999, 25.60066666666666, 21.52966666666666, 17.257666666666665, 23.214999999999993, 27.280333333333335, 22.43966666666667, 38.60699999999999, 16.779000000000003, 24.129999999999995, 29.556666666666647, 21.346000000000004, 39.21633333333335, 34.41533333333332, 42.103666666666676, 17.54566666666666, 22.17933333333332, 62.637666666666675, 38.87766666666665, 52.47900000000001, 20.998999999999985, 16.211999999999996, 27.32499999999998, 22.627666666666652, 49.48599999999997, 46.50933333333333, 23.792666666666666, 16.213333333333328, 17.466999999999995, 25.02133333333332, 58.29333333333332, 44.684, 19.10166666666666, 24.156666666666663, 26.943666666666648, 36.34533333333333, 24.241666666666667, 32.77066666666668], "episode_lengths": [41, 36, 55, 47, 29, 48, 77, 56, 62, 59, 67, 40, 45, 78, 32, 37, 55, 43, 45, 47, 57, 36, 125, 63, 81, 80, 39, 50, 98, 56, 46, 63, 74, 38, 61, 66, 43, 96, 70, 48, 46, 58, 48, 53, 45, 83, 34, 111, 44, 58, 41, 80, 79, 61, 73, 56, 30, 87, 52, 43, 72, 35, 28, 58, 48, 32, 73, 48, 44, 76, 42, 47, 87, 53, 69, 72, 87, 41, 56, 128, 85, 96, 59, 34, 76, 45, 85, 114, 43, 36, 42, 69, 98, 76, 44, 45, 73, 69, 51, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.559833050580826, "mean_inference_ms": 2.9694468799884794, "mean_action_processing_ms": 0.5979963506278904, "mean_env_wait_ms": 0.1448108694034557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10239219665527344, "StateBufferConnector_ms": 0.013324975967407227, "ViewRequirementAgentConnector_ms": 0.8224508762359619}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.5097156440029, "num_env_steps_trained_throughput_per_sec": 436.5097156440029, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 8816.725, "sample_time_ms": 3373.297, "load_time_ms": 0.775, "load_throughput": 5163650.242, "learn_time_ms": 5417.888, "learn_throughput": 738.295, "synch_weights_time_ms": 23.128}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 7511, "training_iteration": 101, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-52-59", "timestamp": 1702018379, "time_this_iter_s": 9.190579175949097, "time_total_s": 22030.10925936699, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22030.10925936699, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 75.36923076923077, "ram_util_percent": 91.87692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9444076131490804e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 5.212717533111572, "policy_loss": -0.0045122005976736546, "vf_loss": 5.21722936630249, "vf_explained_var": 0.606568455696106, "kl": 0.0017521713161841035, "entropy": 0.10290508717298508, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 94395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 65.72733333333338, "episode_reward_min": 13.710999999999999, "episode_reward_mean": 28.982666666666663, "episode_len_mean": 63.34, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.710999999999999, 25.60066666666666, 21.52966666666666, 17.257666666666665, 23.214999999999993, 27.280333333333335, 22.43966666666667, 38.60699999999999, 16.779000000000003, 24.129999999999995, 29.556666666666647, 21.346000000000004, 39.21633333333335, 34.41533333333332, 42.103666666666676, 17.54566666666666, 22.17933333333332, 62.637666666666675, 38.87766666666665, 52.47900000000001, 20.998999999999985, 16.211999999999996, 27.32499999999998, 22.627666666666652, 49.48599999999997, 46.50933333333333, 23.792666666666666, 16.213333333333328, 17.466999999999995, 25.02133333333332, 58.29333333333332, 44.684, 19.10166666666666, 24.156666666666663, 26.943666666666648, 36.34533333333333, 24.241666666666667, 32.77066666666668, 19.91666666666666, 21.106000000000005, 20.13799999999999, 35.06599999999997, 32.813999999999986, 25.04699999999999, 32.457666666666654, 41.16499999999999, 48.987333333333346, 58.481333333333346, 18.621999999999993, 22.223, 25.405333333333324, 54.47033333333341, 13.740333333333329, 30.283666666666658, 26.753666666666675, 15.896666666666663, 32.4, 18.193666666666665, 22.30933333333332, 20.999, 65.72733333333338, 22.632666666666672, 40.48633333333332, 51.759000000000015, 42.84566666666666, 15.609333333333332, 16.595999999999997, 18.939999999999994, 22.33966666666666, 20.124666666666666, 20.338666666666658, 28.385999999999964, 20.621, 24.463666666666672, 15.54833333333333, 14.809333333333331, 25.16999999999998, 22.14966666666667, 21.35866666666667, 27.941, 61.035333333333334, 55.73600000000004, 26.923666666666673, 36.11833333333329, 41.78166666666663, 47.288000000000004, 25.333666666666648, 26.225333333333307, 26.339666666666663, 19.09766666666667, 16.00166666666666, 19.68866666666666, 40.354, 21.99633333333332, 20.15533333333333, 19.06199999999999, 17.031333333333325, 19.850666666666655, 19.21699999999999, 41.60966666666668], "episode_lengths": [28, 58, 48, 32, 73, 48, 44, 76, 42, 47, 87, 53, 69, 72, 87, 41, 56, 128, 85, 96, 59, 34, 76, 45, 85, 114, 43, 36, 42, 69, 98, 76, 44, 45, 73, 69, 51, 61, 47, 50, 56, 93, 77, 55, 106, 72, 82, 96, 39, 47, 67, 106, 31, 60, 65, 33, 64, 42, 71, 50, 153, 47, 90, 88, 86, 32, 39, 34, 51, 49, 49, 103, 43, 47, 33, 28, 75, 50, 38, 60, 112, 106, 53, 127, 72, 94, 88, 75, 47, 42, 34, 41, 72, 57, 43, 51, 52, 54, 48, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5600204569256926, "mean_inference_ms": 2.96822952924493, "mean_action_processing_ms": 0.5978254472704083, "mean_env_wait_ms": 0.14481274894337626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02814650535583496, "StateBufferConnector_ms": 0.01681375503540039, "ViewRequirementAgentConnector_ms": 0.47165608406066895}}, "episode_reward_max": 65.72733333333338, "episode_reward_min": 13.710999999999999, "episode_reward_mean": 28.982666666666663, "episode_len_mean": 63.34, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.710999999999999, 25.60066666666666, 21.52966666666666, 17.257666666666665, 23.214999999999993, 27.280333333333335, 22.43966666666667, 38.60699999999999, 16.779000000000003, 24.129999999999995, 29.556666666666647, 21.346000000000004, 39.21633333333335, 34.41533333333332, 42.103666666666676, 17.54566666666666, 22.17933333333332, 62.637666666666675, 38.87766666666665, 52.47900000000001, 20.998999999999985, 16.211999999999996, 27.32499999999998, 22.627666666666652, 49.48599999999997, 46.50933333333333, 23.792666666666666, 16.213333333333328, 17.466999999999995, 25.02133333333332, 58.29333333333332, 44.684, 19.10166666666666, 24.156666666666663, 26.943666666666648, 36.34533333333333, 24.241666666666667, 32.77066666666668, 19.91666666666666, 21.106000000000005, 20.13799999999999, 35.06599999999997, 32.813999999999986, 25.04699999999999, 32.457666666666654, 41.16499999999999, 48.987333333333346, 58.481333333333346, 18.621999999999993, 22.223, 25.405333333333324, 54.47033333333341, 13.740333333333329, 30.283666666666658, 26.753666666666675, 15.896666666666663, 32.4, 18.193666666666665, 22.30933333333332, 20.999, 65.72733333333338, 22.632666666666672, 40.48633333333332, 51.759000000000015, 42.84566666666666, 15.609333333333332, 16.595999999999997, 18.939999999999994, 22.33966666666666, 20.124666666666666, 20.338666666666658, 28.385999999999964, 20.621, 24.463666666666672, 15.54833333333333, 14.809333333333331, 25.16999999999998, 22.14966666666667, 21.35866666666667, 27.941, 61.035333333333334, 55.73600000000004, 26.923666666666673, 36.11833333333329, 41.78166666666663, 47.288000000000004, 25.333666666666648, 26.225333333333307, 26.339666666666663, 19.09766666666667, 16.00166666666666, 19.68866666666666, 40.354, 21.99633333333332, 20.15533333333333, 19.06199999999999, 17.031333333333325, 19.850666666666655, 19.21699999999999, 41.60966666666668], "episode_lengths": [28, 58, 48, 32, 73, 48, 44, 76, 42, 47, 87, 53, 69, 72, 87, 41, 56, 128, 85, 96, 59, 34, 76, 45, 85, 114, 43, 36, 42, 69, 98, 76, 44, 45, 73, 69, 51, 61, 47, 50, 56, 93, 77, 55, 106, 72, 82, 96, 39, 47, 67, 106, 31, 60, 65, 33, 64, 42, 71, 50, 153, 47, 90, 88, 86, 32, 39, 34, 51, 49, 49, 103, 43, 47, 33, 28, 75, 50, 38, 60, 112, 106, 53, 127, 72, 94, 88, 75, 47, 42, 34, 41, 72, 57, 43, 51, 52, 54, 48, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5600204569256926, "mean_inference_ms": 2.96822952924493, "mean_action_processing_ms": 0.5978254472704083, "mean_env_wait_ms": 0.14481274894337626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02814650535583496, "StateBufferConnector_ms": 0.01681375503540039, "ViewRequirementAgentConnector_ms": 0.47165608406066895}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.1868114981799, "num_env_steps_trained_throughput_per_sec": 451.1868114981799, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 8833.833, "sample_time_ms": 3343.416, "load_time_ms": 0.663, "load_throughput": 6031064.778, "learn_time_ms": 5464.388, "learn_throughput": 732.012, "synch_weights_time_ms": 23.62}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 7573, "training_iteration": 102, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-53-08", "timestamp": 1702018388, "time_this_iter_s": 8.886953353881836, "time_total_s": 22038.99621272087, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22038.99621272087, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 75.58333333333334, "ram_util_percent": 91.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4722038065745402e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 4.634970188140869, "policy_loss": -0.005058282520622015, "vf_loss": 4.640028953552246, "vf_explained_var": 0.6237907409667969, "kl": 0.0021822804119437933, "entropy": 0.10626672953367233, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": 80.25366666666676, "episode_reward_min": 14.208999999999998, "episode_reward_mean": 25.60927333333333, "episode_len_mean": 56.82, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.54833333333333, 14.809333333333331, 25.16999999999998, 22.14966666666667, 21.35866666666667, 27.941, 61.035333333333334, 55.73600000000004, 26.923666666666673, 36.11833333333329, 41.78166666666663, 47.288000000000004, 25.333666666666648, 26.225333333333307, 26.339666666666663, 19.09766666666667, 16.00166666666666, 19.68866666666666, 40.354, 21.99633333333332, 20.15533333333333, 19.06199999999999, 17.031333333333325, 19.850666666666655, 19.21699999999999, 41.60966666666668, 26.96066666666665, 18.180666666666657, 16.759999999999998, 43.565333333333335, 15.861999999999993, 28.561666666666646, 29.92500000000002, 18.621999999999993, 19.318333333333328, 37.513666666666666, 21.537333333333322, 26.585666666666658, 26.541333333333334, 14.909999999999997, 16.710333333333327, 18.848666666666656, 16.663999999999994, 23.09433333333332, 30.462333333333333, 24.097333333333335, 14.858999999999998, 24.475999999999992, 18.445666666666664, 63.09566666666669, 80.25366666666676, 15.155666666666665, 15.761666666666661, 20.652999999999995, 19.068999999999996, 40.024666666666626, 18.15066666666666, 23.09366666666667, 16.643666666666658, 18.552999999999987, 19.85333333333333, 28.611666666666657, 15.63033333333333, 19.676333333333332, 28.874333333333333, 38.16366666666667, 20.40699999999999, 20.139333333333315, 17.143333333333327, 19.70466666666666, 19.743666666666666, 29.64066666666667, 35.60566666666663, 14.989333333333335, 26.363666666666635, 17.763333333333325, 19.37633333333332, 19.46033333333333, 18.801999999999996, 16.56533333333333, 17.483999999999995, 21.552666666666667, 44.30933333333329, 19.983333333333324, 32.38800000000001, 14.956666666666665, 21.028333333333332, 34.175666666666665, 18.694666666666663, 14.208999999999998, 34.92499999999998, 49.811333333333366, 40.48266666666667, 14.906999999999996, 14.922666666666661, 24.151999999999997, 15.19433333333333, 42.51933333333334, 19.96266666666666, 27.975666666666662], "episode_lengths": [33, 28, 75, 50, 38, 60, 112, 106, 53, 127, 72, 94, 88, 75, 47, 42, 34, 41, 72, 57, 43, 51, 52, 54, 48, 72, 61, 37, 35, 83, 33, 81, 62, 37, 47, 72, 52, 65, 53, 39, 40, 47, 39, 53, 67, 53, 30, 48, 38, 123, 141, 39, 32, 59, 48, 95, 43, 52, 40, 55, 35, 50, 35, 39, 55, 70, 52, 68, 35, 50, 37, 54, 103, 31, 80, 35, 51, 40, 41, 44, 36, 59, 95, 51, 64, 34, 54, 56, 43, 29, 88, 89, 101, 34, 31, 55, 30, 94, 48, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5627903362001956, "mean_inference_ms": 2.97150002521999, "mean_action_processing_ms": 0.5991944660708041, "mean_env_wait_ms": 0.1451343614772585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02939438819885254, "StateBufferConnector_ms": 0.018787384033203125, "ViewRequirementAgentConnector_ms": 0.5575170516967773}}, "episode_reward_max": 80.25366666666676, "episode_reward_min": 14.208999999999998, "episode_reward_mean": 25.60927333333333, "episode_len_mean": 56.82, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.54833333333333, 14.809333333333331, 25.16999999999998, 22.14966666666667, 21.35866666666667, 27.941, 61.035333333333334, 55.73600000000004, 26.923666666666673, 36.11833333333329, 41.78166666666663, 47.288000000000004, 25.333666666666648, 26.225333333333307, 26.339666666666663, 19.09766666666667, 16.00166666666666, 19.68866666666666, 40.354, 21.99633333333332, 20.15533333333333, 19.06199999999999, 17.031333333333325, 19.850666666666655, 19.21699999999999, 41.60966666666668, 26.96066666666665, 18.180666666666657, 16.759999999999998, 43.565333333333335, 15.861999999999993, 28.561666666666646, 29.92500000000002, 18.621999999999993, 19.318333333333328, 37.513666666666666, 21.537333333333322, 26.585666666666658, 26.541333333333334, 14.909999999999997, 16.710333333333327, 18.848666666666656, 16.663999999999994, 23.09433333333332, 30.462333333333333, 24.097333333333335, 14.858999999999998, 24.475999999999992, 18.445666666666664, 63.09566666666669, 80.25366666666676, 15.155666666666665, 15.761666666666661, 20.652999999999995, 19.068999999999996, 40.024666666666626, 18.15066666666666, 23.09366666666667, 16.643666666666658, 18.552999999999987, 19.85333333333333, 28.611666666666657, 15.63033333333333, 19.676333333333332, 28.874333333333333, 38.16366666666667, 20.40699999999999, 20.139333333333315, 17.143333333333327, 19.70466666666666, 19.743666666666666, 29.64066666666667, 35.60566666666663, 14.989333333333335, 26.363666666666635, 17.763333333333325, 19.37633333333332, 19.46033333333333, 18.801999999999996, 16.56533333333333, 17.483999999999995, 21.552666666666667, 44.30933333333329, 19.983333333333324, 32.38800000000001, 14.956666666666665, 21.028333333333332, 34.175666666666665, 18.694666666666663, 14.208999999999998, 34.92499999999998, 49.811333333333366, 40.48266666666667, 14.906999999999996, 14.922666666666661, 24.151999999999997, 15.19433333333333, 42.51933333333334, 19.96266666666666, 27.975666666666662], "episode_lengths": [33, 28, 75, 50, 38, 60, 112, 106, 53, 127, 72, 94, 88, 75, 47, 42, 34, 41, 72, 57, 43, 51, 52, 54, 48, 72, 61, 37, 35, 83, 33, 81, 62, 37, 47, 72, 52, 65, 53, 39, 40, 47, 39, 53, 67, 53, 30, 48, 38, 123, 141, 39, 32, 59, 48, 95, 43, 52, 40, 55, 35, 50, 35, 39, 55, 70, 52, 68, 35, 50, 37, 54, 103, 31, 80, 35, 51, 40, 41, 44, 36, 59, 95, 51, 64, 34, 54, 56, 43, 29, 88, 89, 101, 34, 31, 55, 30, 94, 48, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5627903362001956, "mean_inference_ms": 2.97150002521999, "mean_action_processing_ms": 0.5991944660708041, "mean_env_wait_ms": 0.1451343614772585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02939438819885254, "StateBufferConnector_ms": 0.018787384033203125, "ViewRequirementAgentConnector_ms": 0.5575170516967773}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.97628028052753, "num_env_steps_trained_throughput_per_sec": 396.97628028052753, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 9092.096, "sample_time_ms": 3425.434, "load_time_ms": 0.663, "load_throughput": 6033233.602, "learn_time_ms": 5639.934, "learn_throughput": 709.228, "synch_weights_time_ms": 24.32}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 7647, "training_iteration": 103, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-53-18", "timestamp": 1702018398, "time_this_iter_s": 10.129169225692749, "time_total_s": 22049.125381946564, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22049.125381946564, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 78.55714285714286, "ram_util_percent": 91.77857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.361019032872701e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 5.54738187789917, "policy_loss": -0.004525519907474518, "vf_loss": 5.551907062530518, "vf_explained_var": 0.6028279662132263, "kl": 0.0008368166745640337, "entropy": 0.08184291422367096, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 96255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": 59.35300000000001, "episode_reward_min": 12.774333333333331, "episode_reward_mean": 25.871199999999998, "episode_len_mean": 56.35, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.40699999999999, 20.139333333333315, 17.143333333333327, 19.70466666666666, 19.743666666666666, 29.64066666666667, 35.60566666666663, 14.989333333333335, 26.363666666666635, 17.763333333333325, 19.37633333333332, 19.46033333333333, 18.801999999999996, 16.56533333333333, 17.483999999999995, 21.552666666666667, 44.30933333333329, 19.983333333333324, 32.38800000000001, 14.956666666666665, 21.028333333333332, 34.175666666666665, 18.694666666666663, 14.208999999999998, 34.92499999999998, 49.811333333333366, 40.48266666666667, 14.906999999999996, 14.922666666666661, 24.151999999999997, 15.19433333333333, 42.51933333333334, 19.96266666666666, 27.975666666666662, 47.88300000000004, 18.26866666666666, 25.817333333333334, 52.846666666666664, 16.27866666666666, 24.195000000000004, 19.18233333333333, 18.92366666666666, 20.964666666666663, 17.029999999999994, 24.315, 17.90166666666666, 50.73266666666669, 17.483999999999988, 12.774333333333331, 21.368999999999996, 48.484000000000016, 34.17799999999999, 23.87866666666666, 38.67466666666665, 17.095666666666663, 50.253666666666675, 24.786999999999985, 14.989666666666663, 19.245333333333324, 24.724333333333323, 37.104, 24.068666666666665, 20.787000000000003, 17.22199999999999, 59.35300000000001, 15.800666666666658, 23.670333333333325, 27.045666666666673, 17.928999999999995, 21.04566666666666, 21.11566666666666, 36.51166666666668, 16.327666666666662, 45.22733333333335, 47.22133333333333, 30.984000000000012, 16.58299999999999, 21.248666666666654, 25.261999999999993, 43.18333333333334, 48.02633333333333, 30.478666666666662, 14.577333333333332, 23.698333333333334, 22.770666666666656, 17.59233333333333, 32.483333333333334, 27.23300000000001, 36.00033333333331, 21.69466666666666, 18.681333333333328, 17.296666666666667, 21.727666666666657, 17.192333333333327, 22.781666666666663, 22.158666666666655, 19.738999999999994, 29.951999999999973, 29.448666666666654, 24.279666666666657], "episode_lengths": [52, 68, 35, 50, 37, 54, 103, 31, 80, 35, 51, 40, 41, 44, 36, 59, 95, 51, 64, 34, 54, 56, 43, 29, 88, 89, 101, 34, 31, 55, 30, 94, 48, 63, 81, 35, 51, 108, 31, 51, 37, 36, 59, 35, 52, 42, 91, 47, 26, 50, 92, 84, 51, 79, 40, 85, 70, 31, 49, 74, 76, 53, 50, 42, 146, 38, 45, 53, 38, 42, 46, 72, 32, 83, 91, 63, 36, 45, 65, 77, 81, 67, 31, 52, 46, 40, 63, 63, 83, 51, 37, 33, 52, 34, 52, 44, 38, 90, 62, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5655480118502607, "mean_inference_ms": 2.9790303902427366, "mean_action_processing_ms": 0.5998399931544404, "mean_env_wait_ms": 0.14530613328463893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03266644477844238, "StateBufferConnector_ms": 0.02492547035217285, "ViewRequirementAgentConnector_ms": 0.702812671661377}}, "episode_reward_max": 59.35300000000001, "episode_reward_min": 12.774333333333331, "episode_reward_mean": 25.871199999999998, "episode_len_mean": 56.35, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.40699999999999, 20.139333333333315, 17.143333333333327, 19.70466666666666, 19.743666666666666, 29.64066666666667, 35.60566666666663, 14.989333333333335, 26.363666666666635, 17.763333333333325, 19.37633333333332, 19.46033333333333, 18.801999999999996, 16.56533333333333, 17.483999999999995, 21.552666666666667, 44.30933333333329, 19.983333333333324, 32.38800000000001, 14.956666666666665, 21.028333333333332, 34.175666666666665, 18.694666666666663, 14.208999999999998, 34.92499999999998, 49.811333333333366, 40.48266666666667, 14.906999999999996, 14.922666666666661, 24.151999999999997, 15.19433333333333, 42.51933333333334, 19.96266666666666, 27.975666666666662, 47.88300000000004, 18.26866666666666, 25.817333333333334, 52.846666666666664, 16.27866666666666, 24.195000000000004, 19.18233333333333, 18.92366666666666, 20.964666666666663, 17.029999999999994, 24.315, 17.90166666666666, 50.73266666666669, 17.483999999999988, 12.774333333333331, 21.368999999999996, 48.484000000000016, 34.17799999999999, 23.87866666666666, 38.67466666666665, 17.095666666666663, 50.253666666666675, 24.786999999999985, 14.989666666666663, 19.245333333333324, 24.724333333333323, 37.104, 24.068666666666665, 20.787000000000003, 17.22199999999999, 59.35300000000001, 15.800666666666658, 23.670333333333325, 27.045666666666673, 17.928999999999995, 21.04566666666666, 21.11566666666666, 36.51166666666668, 16.327666666666662, 45.22733333333335, 47.22133333333333, 30.984000000000012, 16.58299999999999, 21.248666666666654, 25.261999999999993, 43.18333333333334, 48.02633333333333, 30.478666666666662, 14.577333333333332, 23.698333333333334, 22.770666666666656, 17.59233333333333, 32.483333333333334, 27.23300000000001, 36.00033333333331, 21.69466666666666, 18.681333333333328, 17.296666666666667, 21.727666666666657, 17.192333333333327, 22.781666666666663, 22.158666666666655, 19.738999999999994, 29.951999999999973, 29.448666666666654, 24.279666666666657], "episode_lengths": [52, 68, 35, 50, 37, 54, 103, 31, 80, 35, 51, 40, 41, 44, 36, 59, 95, 51, 64, 34, 54, 56, 43, 29, 88, 89, 101, 34, 31, 55, 30, 94, 48, 63, 81, 35, 51, 108, 31, 51, 37, 36, 59, 35, 52, 42, 91, 47, 26, 50, 92, 84, 51, 79, 40, 85, 70, 31, 49, 74, 76, 53, 50, 42, 146, 38, 45, 53, 38, 42, 46, 72, 32, 83, 91, 63, 36, 45, 65, 77, 81, 67, 31, 52, 46, 40, 63, 63, 83, 51, 37, 33, 52, 34, 52, 44, 38, 90, 62, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5655480118502607, "mean_inference_ms": 2.9790303902427366, "mean_action_processing_ms": 0.5998399931544404, "mean_env_wait_ms": 0.14530613328463893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03266644477844238, "StateBufferConnector_ms": 0.02492547035217285, "ViewRequirementAgentConnector_ms": 0.702812671661377}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.83537860322457, "num_env_steps_trained_throughput_per_sec": 398.83537860322457, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 9325.658, "sample_time_ms": 3515.384, "load_time_ms": 0.658, "load_throughput": 6079362.25, "learn_time_ms": 5781.855, "learn_throughput": 691.82, "synch_weights_time_ms": 25.922}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 7713, "training_iteration": 104, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-53-28", "timestamp": 1702018408, "time_this_iter_s": 10.15867567062378, "time_total_s": 22059.284057617188, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22059.284057617188, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 81.95714285714284, "ram_util_percent": 93.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.6805095164363505e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 5.491241455078125, "policy_loss": 0.0005978959961794317, "vf_loss": 5.490643501281738, "vf_explained_var": 0.6520207524299622, "kl": 0.0009719405206851661, "entropy": 0.0849013701081276, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 97185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 61.64899999999998, "episode_reward_min": 14.577333333333332, "episode_reward_mean": 27.198003333333325, "episode_len_mean": 58.29, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.11566666666666, 36.51166666666668, 16.327666666666662, 45.22733333333335, 47.22133333333333, 30.984000000000012, 16.58299999999999, 21.248666666666654, 25.261999999999993, 43.18333333333334, 48.02633333333333, 30.478666666666662, 14.577333333333332, 23.698333333333334, 22.770666666666656, 17.59233333333333, 32.483333333333334, 27.23300000000001, 36.00033333333331, 21.69466666666666, 18.681333333333328, 17.296666666666667, 21.727666666666657, 17.192333333333327, 22.781666666666663, 22.158666666666655, 19.738999999999994, 29.951999999999973, 29.448666666666654, 24.279666666666657, 21.96766666666666, 23.242, 17.824666666666666, 18.064666666666657, 29.153333333333336, 35.281333333333336, 30.746666666666663, 20.162999999999997, 39.015, 17.667333333333332, 15.403999999999998, 36.17399999999999, 19.458999999999993, 38.736333333333334, 42.470333333333336, 17.49633333333333, 15.029333333333328, 25.306999999999995, 20.73533333333333, 19.13966666666666, 21.76866666666666, 31.77866666666663, 26.53366666666666, 17.246333333333332, 15.726666666666661, 37.30399999999998, 45.78699999999999, 19.011999999999997, 30.296333333333333, 33.416333333333334, 15.70066666666666, 38.68033333333333, 25.528, 26.588666666666647, 18.258000000000003, 19.117333333333324, 29.196999999999996, 30.20466666666665, 16.987666666666662, 33.99866666666666, 23.169666666666654, 32.59566666666666, 33.102999999999994, 22.428666666666658, 19.852999999999994, 32.80533333333335, 22.77433333333332, 35.97466666666667, 34.752333333333326, 42.89133333333334, 20.091999999999995, 61.64899999999998, 19.486999999999984, 15.610666666666662, 33.18433333333335, 19.71833333333333, 15.485666666666665, 20.736666666666665, 15.480999999999995, 49.71433333333335, 15.42999999999999, 55.58166666666667, 16.930333333333326, 32.18099999999999, 55.70900000000001, 36.74766666666665, 25.392999999999997, 15.447999999999999, 22.305333333333323, 34.88233333333332], "episode_lengths": [46, 72, 32, 83, 91, 63, 36, 45, 65, 77, 81, 67, 31, 52, 46, 40, 63, 63, 83, 51, 37, 33, 52, 34, 52, 44, 38, 90, 62, 61, 56, 44, 43, 45, 61, 71, 70, 54, 68, 40, 33, 67, 41, 82, 92, 34, 37, 64, 51, 41, 51, 87, 70, 41, 36, 80, 99, 43, 56, 74, 33, 67, 47, 75, 34, 48, 77, 69, 36, 75, 45, 81, 81, 55, 45, 73, 51, 64, 69, 71, 39, 124, 57, 36, 72, 47, 32, 45, 35, 86, 34, 117, 38, 78, 118, 65, 44, 30, 57, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5681200411868914, "mean_inference_ms": 2.984854012159639, "mean_action_processing_ms": 0.600821084192273, "mean_env_wait_ms": 0.14562078058432557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041551828384399414, "StateBufferConnector_ms": 0.016071796417236328, "ViewRequirementAgentConnector_ms": 0.6115572452545166}}, "episode_reward_max": 61.64899999999998, "episode_reward_min": 14.577333333333332, "episode_reward_mean": 27.198003333333325, "episode_len_mean": 58.29, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.11566666666666, 36.51166666666668, 16.327666666666662, 45.22733333333335, 47.22133333333333, 30.984000000000012, 16.58299999999999, 21.248666666666654, 25.261999999999993, 43.18333333333334, 48.02633333333333, 30.478666666666662, 14.577333333333332, 23.698333333333334, 22.770666666666656, 17.59233333333333, 32.483333333333334, 27.23300000000001, 36.00033333333331, 21.69466666666666, 18.681333333333328, 17.296666666666667, 21.727666666666657, 17.192333333333327, 22.781666666666663, 22.158666666666655, 19.738999999999994, 29.951999999999973, 29.448666666666654, 24.279666666666657, 21.96766666666666, 23.242, 17.824666666666666, 18.064666666666657, 29.153333333333336, 35.281333333333336, 30.746666666666663, 20.162999999999997, 39.015, 17.667333333333332, 15.403999999999998, 36.17399999999999, 19.458999999999993, 38.736333333333334, 42.470333333333336, 17.49633333333333, 15.029333333333328, 25.306999999999995, 20.73533333333333, 19.13966666666666, 21.76866666666666, 31.77866666666663, 26.53366666666666, 17.246333333333332, 15.726666666666661, 37.30399999999998, 45.78699999999999, 19.011999999999997, 30.296333333333333, 33.416333333333334, 15.70066666666666, 38.68033333333333, 25.528, 26.588666666666647, 18.258000000000003, 19.117333333333324, 29.196999999999996, 30.20466666666665, 16.987666666666662, 33.99866666666666, 23.169666666666654, 32.59566666666666, 33.102999999999994, 22.428666666666658, 19.852999999999994, 32.80533333333335, 22.77433333333332, 35.97466666666667, 34.752333333333326, 42.89133333333334, 20.091999999999995, 61.64899999999998, 19.486999999999984, 15.610666666666662, 33.18433333333335, 19.71833333333333, 15.485666666666665, 20.736666666666665, 15.480999999999995, 49.71433333333335, 15.42999999999999, 55.58166666666667, 16.930333333333326, 32.18099999999999, 55.70900000000001, 36.74766666666665, 25.392999999999997, 15.447999999999999, 22.305333333333323, 34.88233333333332], "episode_lengths": [46, 72, 32, 83, 91, 63, 36, 45, 65, 77, 81, 67, 31, 52, 46, 40, 63, 63, 83, 51, 37, 33, 52, 34, 52, 44, 38, 90, 62, 61, 56, 44, 43, 45, 61, 71, 70, 54, 68, 40, 33, 67, 41, 82, 92, 34, 37, 64, 51, 41, 51, 87, 70, 41, 36, 80, 99, 43, 56, 74, 33, 67, 47, 75, 34, 48, 77, 69, 36, 75, 45, 81, 81, 55, 45, 73, 51, 64, 69, 71, 39, 124, 57, 36, 72, 47, 32, 45, 35, 86, 34, 117, 38, 78, 118, 65, 44, 30, 57, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5681200411868914, "mean_inference_ms": 2.984854012159639, "mean_action_processing_ms": 0.600821084192273, "mean_env_wait_ms": 0.14562078058432557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041551828384399414, "StateBufferConnector_ms": 0.016071796417236328, "ViewRequirementAgentConnector_ms": 0.6115572452545166}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.76176044151117, "num_env_steps_trained_throughput_per_sec": 413.76176044151117, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 9592.529, "sample_time_ms": 3621.239, "load_time_ms": 0.701, "load_throughput": 5708089.276, "learn_time_ms": 5941.457, "learn_throughput": 673.236, "synch_weights_time_ms": 27.126}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 7783, "training_iteration": 105, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-53-38", "timestamp": 1702018418, "time_this_iter_s": 9.7003915309906, "time_total_s": 22068.984449148178, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22068.984449148178, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 78.77692307692307, "ram_util_percent": 91.94615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8402547582181752e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 5.810125350952148, "policy_loss": -0.004817086737602949, "vf_loss": 5.814941883087158, "vf_explained_var": 0.5761387944221497, "kl": 0.0011961255222558975, "entropy": 0.06531253457069397, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": 77.18800000000002, "episode_reward_min": 14.325333333333331, "episode_reward_mean": 28.960019999999997, "episode_len_mean": 61.82, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.258000000000003, 19.117333333333324, 29.196999999999996, 30.20466666666665, 16.987666666666662, 33.99866666666666, 23.169666666666654, 32.59566666666666, 33.102999999999994, 22.428666666666658, 19.852999999999994, 32.80533333333335, 22.77433333333332, 35.97466666666667, 34.752333333333326, 42.89133333333334, 20.091999999999995, 61.64899999999998, 19.486999999999984, 15.610666666666662, 33.18433333333335, 19.71833333333333, 15.485666666666665, 20.736666666666665, 15.480999999999995, 49.71433333333335, 15.42999999999999, 55.58166666666667, 16.930333333333326, 32.18099999999999, 55.70900000000001, 36.74766666666665, 25.392999999999997, 15.447999999999999, 22.305333333333323, 34.88233333333332, 17.411666666666658, 18.580666666666662, 22.297999999999995, 15.949333333333328, 14.325333333333331, 19.564333333333334, 19.445999999999998, 20.313666666666652, 16.203666666666663, 24.786333333333335, 16.658333333333328, 23.654666666666657, 24.723666666666666, 23.325333333333326, 19.028666666666666, 19.25033333333333, 16.06866666666666, 18.450333333333322, 73.12299999999986, 21.647666666666648, 28.377666666666673, 26.91166666666666, 27.885999999999996, 19.787333333333326, 18.06466666666666, 18.106999999999992, 33.69099999999998, 15.722333333333331, 25.510333333333318, 28.254666666666655, 40.04433333333334, 57.74500000000003, 28.858999999999995, 34.95933333333332, 43.98666666666665, 30.381999999999998, 40.17466666666668, 17.248999999999995, 20.586, 28.928333333333338, 18.158666666666658, 40.51833333333333, 65.19200000000004, 46.549666666666674, 26.182999999999993, 36.01866666666663, 16.06133333333333, 16.916333333333327, 38.75699999999998, 49.34399999999999, 17.281999999999996, 34.40133333333332, 16.670333333333325, 32.55166666666667, 27.374999999999996, 58.871666666666705, 21.27799999999999, 34.35366666666665, 48.824, 44.918666666666645, 25.352333333333313, 24.76999999999999, 77.18800000000002, 18.550999999999995], "episode_lengths": [34, 48, 77, 69, 36, 75, 45, 81, 81, 55, 45, 73, 51, 64, 69, 71, 39, 124, 57, 36, 72, 47, 32, 45, 35, 86, 34, 117, 38, 78, 118, 65, 44, 30, 57, 58, 40, 49, 45, 34, 30, 40, 46, 63, 34, 62, 32, 55, 47, 45, 43, 38, 39, 40, 156, 54, 58, 52, 79, 39, 38, 40, 84, 31, 67, 78, 91, 110, 64, 69, 80, 61, 84, 33, 39, 60, 35, 89, 111, 80, 54, 95, 35, 34, 111, 79, 35, 67, 37, 62, 50, 104, 69, 95, 107, 91, 74, 44, 140, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.570083917618553, "mean_inference_ms": 2.9915095426547227, "mean_action_processing_ms": 0.6023600005932295, "mean_env_wait_ms": 0.1458912792003397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02608489990234375, "StateBufferConnector_ms": 0.019642353057861328, "ViewRequirementAgentConnector_ms": 0.6008977890014648}}, "episode_reward_max": 77.18800000000002, "episode_reward_min": 14.325333333333331, "episode_reward_mean": 28.960019999999997, "episode_len_mean": 61.82, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.258000000000003, 19.117333333333324, 29.196999999999996, 30.20466666666665, 16.987666666666662, 33.99866666666666, 23.169666666666654, 32.59566666666666, 33.102999999999994, 22.428666666666658, 19.852999999999994, 32.80533333333335, 22.77433333333332, 35.97466666666667, 34.752333333333326, 42.89133333333334, 20.091999999999995, 61.64899999999998, 19.486999999999984, 15.610666666666662, 33.18433333333335, 19.71833333333333, 15.485666666666665, 20.736666666666665, 15.480999999999995, 49.71433333333335, 15.42999999999999, 55.58166666666667, 16.930333333333326, 32.18099999999999, 55.70900000000001, 36.74766666666665, 25.392999999999997, 15.447999999999999, 22.305333333333323, 34.88233333333332, 17.411666666666658, 18.580666666666662, 22.297999999999995, 15.949333333333328, 14.325333333333331, 19.564333333333334, 19.445999999999998, 20.313666666666652, 16.203666666666663, 24.786333333333335, 16.658333333333328, 23.654666666666657, 24.723666666666666, 23.325333333333326, 19.028666666666666, 19.25033333333333, 16.06866666666666, 18.450333333333322, 73.12299999999986, 21.647666666666648, 28.377666666666673, 26.91166666666666, 27.885999999999996, 19.787333333333326, 18.06466666666666, 18.106999999999992, 33.69099999999998, 15.722333333333331, 25.510333333333318, 28.254666666666655, 40.04433333333334, 57.74500000000003, 28.858999999999995, 34.95933333333332, 43.98666666666665, 30.381999999999998, 40.17466666666668, 17.248999999999995, 20.586, 28.928333333333338, 18.158666666666658, 40.51833333333333, 65.19200000000004, 46.549666666666674, 26.182999999999993, 36.01866666666663, 16.06133333333333, 16.916333333333327, 38.75699999999998, 49.34399999999999, 17.281999999999996, 34.40133333333332, 16.670333333333325, 32.55166666666667, 27.374999999999996, 58.871666666666705, 21.27799999999999, 34.35366666666665, 48.824, 44.918666666666645, 25.352333333333313, 24.76999999999999, 77.18800000000002, 18.550999999999995], "episode_lengths": [34, 48, 77, 69, 36, 75, 45, 81, 81, 55, 45, 73, 51, 64, 69, 71, 39, 124, 57, 36, 72, 47, 32, 45, 35, 86, 34, 117, 38, 78, 118, 65, 44, 30, 57, 58, 40, 49, 45, 34, 30, 40, 46, 63, 34, 62, 32, 55, 47, 45, 43, 38, 39, 40, 156, 54, 58, 52, 79, 39, 38, 40, 84, 31, 67, 78, 91, 110, 64, 69, 80, 61, 84, 33, 39, 60, 35, 89, 111, 80, 54, 95, 35, 34, 111, 79, 35, 67, 37, 62, 50, 104, 69, 95, 107, 91, 74, 44, 140, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.570083917618553, "mean_inference_ms": 2.9915095426547227, "mean_action_processing_ms": 0.6023600005932295, "mean_env_wait_ms": 0.1458912792003397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02608489990234375, "StateBufferConnector_ms": 0.019642353057861328, "ViewRequirementAgentConnector_ms": 0.6008977890014648}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.3335782731817, "num_env_steps_trained_throughput_per_sec": 399.3335782731817, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 9737.873, "sample_time_ms": 3741.848, "load_time_ms": 0.547, "load_throughput": 7318625.022, "learn_time_ms": 5964.496, "learn_throughput": 670.635, "synch_weights_time_ms": 28.818}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 7847, "training_iteration": 106, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-53-48", "timestamp": 1702018428, "time_this_iter_s": 10.049959659576416, "time_total_s": 22079.034408807755, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22079.034408807755, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 78.45384615384616, "ram_util_percent": 92.70769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.201273791090876e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 5.878330707550049, "policy_loss": -0.0017677901778370142, "vf_loss": 5.880099296569824, "vf_explained_var": 0.6368635296821594, "kl": 0.0014675832353532314, "entropy": 0.07617278397083282, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": 77.18800000000002, "episode_reward_min": 12.967333333333332, "episode_reward_mean": 30.665949999999995, "episode_len_mean": 66.21, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.510333333333318, 28.254666666666655, 40.04433333333334, 57.74500000000003, 28.858999999999995, 34.95933333333332, 43.98666666666665, 30.381999999999998, 40.17466666666668, 17.248999999999995, 20.586, 28.928333333333338, 18.158666666666658, 40.51833333333333, 65.19200000000004, 46.549666666666674, 26.182999999999993, 36.01866666666663, 16.06133333333333, 16.916333333333327, 38.75699999999998, 49.34399999999999, 17.281999999999996, 34.40133333333332, 16.670333333333325, 32.55166666666667, 27.374999999999996, 58.871666666666705, 21.27799999999999, 34.35366666666665, 48.824, 44.918666666666645, 25.352333333333313, 24.76999999999999, 77.18800000000002, 18.550999999999995, 20.777333333333328, 35.185666666666656, 32.50699999999998, 18.829666666666654, 49.23133333333336, 16.69233333333333, 20.126999999999992, 34.19399999999999, 39.59099999999998, 45.70966666666665, 28.06366666666666, 37.062, 31.51466666666665, 12.967333333333332, 44.00366666666667, 21.326333333333324, 26.630333333333326, 34.92366666666664, 27.660333333333316, 18.462333333333337, 25.097333333333317, 26.534333333333326, 28.710333333333335, 17.909333333333326, 18.649999999999988, 25.55399999999999, 16.871000000000002, 19.707, 17.841, 31.16666666666666, 28.65866666666668, 30.460333333333338, 15.570333333333329, 17.98399999999999, 29.23133333333334, 33.14633333333332, 30.894666666666655, 47.26833333333333, 35.720333333333336, 20.959666666666653, 20.107999999999993, 16.111666666666665, 17.248333333333328, 36.41866666666667, 16.83766666666666, 33.372333333333316, 57.704666666666604, 29.384999999999994, 16.536666666666665, 47.63366666666663, 42.50166666666666, 31.727333333333306, 17.29366666666667, 29.236999999999988, 21.15899999999999, 23.27333333333333, 23.166999999999994, 23.082333333333327, 59.82900000000004, 45.055666666666674, 24.750333333333334, 43.10599999999999, 28.546666666666656, 16.348999999999997], "episode_lengths": [67, 78, 91, 110, 64, 69, 80, 61, 84, 33, 39, 60, 35, 89, 111, 80, 54, 95, 35, 34, 111, 79, 35, 67, 37, 62, 50, 104, 69, 95, 107, 91, 74, 44, 140, 49, 49, 71, 78, 39, 98, 35, 40, 73, 94, 112, 72, 75, 87, 28, 78, 54, 48, 80, 65, 36, 50, 52, 61, 39, 45, 53, 44, 40, 42, 57, 65, 65, 30, 39, 63, 94, 75, 98, 60, 64, 41, 30, 35, 58, 38, 78, 132, 50, 32, 140, 82, 88, 39, 70, 43, 53, 50, 77, 143, 84, 44, 83, 67, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5719374235286554, "mean_inference_ms": 2.998228672741648, "mean_action_processing_ms": 0.6025497727203328, "mean_env_wait_ms": 0.1460348354632282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0312962532043457, "StateBufferConnector_ms": 0.01867818832397461, "ViewRequirementAgentConnector_ms": 0.6261482238769531}}, "episode_reward_max": 77.18800000000002, "episode_reward_min": 12.967333333333332, "episode_reward_mean": 30.665949999999995, "episode_len_mean": 66.21, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.510333333333318, 28.254666666666655, 40.04433333333334, 57.74500000000003, 28.858999999999995, 34.95933333333332, 43.98666666666665, 30.381999999999998, 40.17466666666668, 17.248999999999995, 20.586, 28.928333333333338, 18.158666666666658, 40.51833333333333, 65.19200000000004, 46.549666666666674, 26.182999999999993, 36.01866666666663, 16.06133333333333, 16.916333333333327, 38.75699999999998, 49.34399999999999, 17.281999999999996, 34.40133333333332, 16.670333333333325, 32.55166666666667, 27.374999999999996, 58.871666666666705, 21.27799999999999, 34.35366666666665, 48.824, 44.918666666666645, 25.352333333333313, 24.76999999999999, 77.18800000000002, 18.550999999999995, 20.777333333333328, 35.185666666666656, 32.50699999999998, 18.829666666666654, 49.23133333333336, 16.69233333333333, 20.126999999999992, 34.19399999999999, 39.59099999999998, 45.70966666666665, 28.06366666666666, 37.062, 31.51466666666665, 12.967333333333332, 44.00366666666667, 21.326333333333324, 26.630333333333326, 34.92366666666664, 27.660333333333316, 18.462333333333337, 25.097333333333317, 26.534333333333326, 28.710333333333335, 17.909333333333326, 18.649999999999988, 25.55399999999999, 16.871000000000002, 19.707, 17.841, 31.16666666666666, 28.65866666666668, 30.460333333333338, 15.570333333333329, 17.98399999999999, 29.23133333333334, 33.14633333333332, 30.894666666666655, 47.26833333333333, 35.720333333333336, 20.959666666666653, 20.107999999999993, 16.111666666666665, 17.248333333333328, 36.41866666666667, 16.83766666666666, 33.372333333333316, 57.704666666666604, 29.384999999999994, 16.536666666666665, 47.63366666666663, 42.50166666666666, 31.727333333333306, 17.29366666666667, 29.236999999999988, 21.15899999999999, 23.27333333333333, 23.166999999999994, 23.082333333333327, 59.82900000000004, 45.055666666666674, 24.750333333333334, 43.10599999999999, 28.546666666666656, 16.348999999999997], "episode_lengths": [67, 78, 91, 110, 64, 69, 80, 61, 84, 33, 39, 60, 35, 89, 111, 80, 54, 95, 35, 34, 111, 79, 35, 67, 37, 62, 50, 104, 69, 95, 107, 91, 74, 44, 140, 49, 49, 71, 78, 39, 98, 35, 40, 73, 94, 112, 72, 75, 87, 28, 78, 54, 48, 80, 65, 36, 50, 52, 61, 39, 45, 53, 44, 40, 42, 57, 65, 65, 30, 39, 63, 94, 75, 98, 60, 64, 41, 30, 35, 58, 38, 78, 132, 50, 32, 140, 82, 88, 39, 70, 43, 53, 50, 77, 143, 84, 44, 83, 67, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5719374235286554, "mean_inference_ms": 2.998228672741648, "mean_action_processing_ms": 0.6025497727203328, "mean_env_wait_ms": 0.1460348354632282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0312962532043457, "StateBufferConnector_ms": 0.01867818832397461, "ViewRequirementAgentConnector_ms": 0.6261482238769531}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.42309637118757, "num_env_steps_trained_throughput_per_sec": 502.42309637118757, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 9799.804, "sample_time_ms": 3846.956, "load_time_ms": 0.647, "load_throughput": 6182185.865, "learn_time_ms": 5920.808, "learn_throughput": 675.583, "synch_weights_time_ms": 29.111}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 7911, "training_iteration": 107, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-00", "timestamp": 1702018440, "time_this_iter_s": 11.824788331985474, "time_total_s": 22090.85919713974, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22090.85919713974, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 88.01249999999999, "ram_util_percent": 96.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.600636895545438e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 5.311731338500977, "policy_loss": -0.006928305607289076, "vf_loss": 5.318659782409668, "vf_explained_var": 0.5386712551116943, "kl": 0.0023513012565672398, "entropy": 0.09598460048437119, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 60.15500000000004, "episode_reward_min": 13.903000000000004, "episode_reward_mean": 27.52370666666666, "episode_len_mean": 58.2, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.26833333333333, 35.720333333333336, 20.959666666666653, 20.107999999999993, 16.111666666666665, 17.248333333333328, 36.41866666666667, 16.83766666666666, 33.372333333333316, 57.704666666666604, 29.384999999999994, 16.536666666666665, 47.63366666666663, 42.50166666666666, 31.727333333333306, 17.29366666666667, 29.236999999999988, 21.15899999999999, 23.27333333333333, 23.166999999999994, 23.082333333333327, 59.82900000000004, 45.055666666666674, 24.750333333333334, 43.10599999999999, 28.546666666666656, 16.348999999999997, 22.070999999999998, 17.66133333333333, 24.71666666666666, 35.42933333333334, 27.541666666666657, 22.00099999999999, 37.82166666666668, 20.125666666666664, 21.153666666666652, 31.872333333333348, 15.744666666666658, 17.15133333333333, 24.40466666666666, 42.421999999999976, 16.455999999999996, 21.098, 16.40199999999999, 27.017666666666663, 43.07433333333334, 24.160666666666668, 19.515333333333334, 49.877, 21.222999999999992, 19.000999999999987, 55.011999999999986, 26.715999999999983, 15.091999999999995, 22.226666666666656, 15.328999999999992, 23.911999999999985, 29.35033333333334, 22.758333333333333, 27.836666666666652, 45.495666666666644, 13.903000000000004, 23.43733333333333, 27.012999999999998, 15.407666666666662, 24.537000000000006, 21.309333333333335, 19.898666666666667, 19.58899999999999, 20.154000000000003, 29.011666666666653, 26.27933333333332, 18.42633333333333, 15.045999999999996, 19.759999999999998, 20.44366666666666, 27.958999999999993, 23.480333333333334, 19.190999999999992, 25.129666666666665, 29.076666666666647, 41.54766666666663, 23.58366666666664, 60.15500000000004, 16.022333333333336, 36.742, 41.33566666666665, 41.31766666666666, 24.955999999999992, 15.345666666666663, 34.16833333333333, 50.76033333333334, 18.082999999999988, 17.391999999999996, 37.396000000000015, 17.50733333333333, 40.968666666666664, 16.637333333333327, 21.53866666666666, 31.807000000000002], "episode_lengths": [98, 60, 64, 41, 30, 35, 58, 38, 78, 132, 50, 32, 140, 82, 88, 39, 70, 43, 53, 50, 77, 143, 84, 44, 83, 67, 33, 48, 35, 69, 72, 60, 56, 70, 67, 56, 50, 38, 38, 43, 102, 32, 41, 33, 46, 76, 43, 43, 90, 52, 42, 109, 79, 32, 44, 33, 67, 48, 51, 63, 68, 28, 49, 49, 34, 42, 37, 35, 39, 43, 55, 51, 53, 31, 50, 37, 68, 47, 50, 52, 75, 66, 57, 93, 33, 65, 102, 63, 66, 33, 82, 80, 48, 34, 71, 38, 104, 34, 50, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.570635869769782, "mean_inference_ms": 2.9955037727703946, "mean_action_processing_ms": 0.6022876071431233, "mean_env_wait_ms": 0.14614853143205178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021152257919311523, "StateBufferConnector_ms": 0.013906717300415039, "ViewRequirementAgentConnector_ms": 0.43488335609436035}}, "episode_reward_max": 60.15500000000004, "episode_reward_min": 13.903000000000004, "episode_reward_mean": 27.52370666666666, "episode_len_mean": 58.2, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.26833333333333, 35.720333333333336, 20.959666666666653, 20.107999999999993, 16.111666666666665, 17.248333333333328, 36.41866666666667, 16.83766666666666, 33.372333333333316, 57.704666666666604, 29.384999999999994, 16.536666666666665, 47.63366666666663, 42.50166666666666, 31.727333333333306, 17.29366666666667, 29.236999999999988, 21.15899999999999, 23.27333333333333, 23.166999999999994, 23.082333333333327, 59.82900000000004, 45.055666666666674, 24.750333333333334, 43.10599999999999, 28.546666666666656, 16.348999999999997, 22.070999999999998, 17.66133333333333, 24.71666666666666, 35.42933333333334, 27.541666666666657, 22.00099999999999, 37.82166666666668, 20.125666666666664, 21.153666666666652, 31.872333333333348, 15.744666666666658, 17.15133333333333, 24.40466666666666, 42.421999999999976, 16.455999999999996, 21.098, 16.40199999999999, 27.017666666666663, 43.07433333333334, 24.160666666666668, 19.515333333333334, 49.877, 21.222999999999992, 19.000999999999987, 55.011999999999986, 26.715999999999983, 15.091999999999995, 22.226666666666656, 15.328999999999992, 23.911999999999985, 29.35033333333334, 22.758333333333333, 27.836666666666652, 45.495666666666644, 13.903000000000004, 23.43733333333333, 27.012999999999998, 15.407666666666662, 24.537000000000006, 21.309333333333335, 19.898666666666667, 19.58899999999999, 20.154000000000003, 29.011666666666653, 26.27933333333332, 18.42633333333333, 15.045999999999996, 19.759999999999998, 20.44366666666666, 27.958999999999993, 23.480333333333334, 19.190999999999992, 25.129666666666665, 29.076666666666647, 41.54766666666663, 23.58366666666664, 60.15500000000004, 16.022333333333336, 36.742, 41.33566666666665, 41.31766666666666, 24.955999999999992, 15.345666666666663, 34.16833333333333, 50.76033333333334, 18.082999999999988, 17.391999999999996, 37.396000000000015, 17.50733333333333, 40.968666666666664, 16.637333333333327, 21.53866666666666, 31.807000000000002], "episode_lengths": [98, 60, 64, 41, 30, 35, 58, 38, 78, 132, 50, 32, 140, 82, 88, 39, 70, 43, 53, 50, 77, 143, 84, 44, 83, 67, 33, 48, 35, 69, 72, 60, 56, 70, 67, 56, 50, 38, 38, 43, 102, 32, 41, 33, 46, 76, 43, 43, 90, 52, 42, 109, 79, 32, 44, 33, 67, 48, 51, 63, 68, 28, 49, 49, 34, 42, 37, 35, 39, 43, 55, 51, 53, 31, 50, 37, 68, 47, 50, 52, 75, 66, 57, 93, 33, 65, 102, 63, 66, 33, 82, 80, 48, 34, 71, 38, 104, 34, 50, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.570635869769782, "mean_inference_ms": 2.9955037727703946, "mean_action_processing_ms": 0.6022876071431233, "mean_env_wait_ms": 0.14614853143205178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021152257919311523, "StateBufferConnector_ms": 0.013906717300415039, "ViewRequirementAgentConnector_ms": 0.43488335609436035}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 676.5795976353047, "num_env_steps_trained_throughput_per_sec": 676.5795976353047, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 9348.189, "sample_time_ms": 3735.503, "load_time_ms": 0.647, "load_throughput": 6182185.865, "learn_time_ms": 5581.146, "learn_throughput": 716.699, "synch_weights_time_ms": 28.609}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 7984, "training_iteration": 108, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-06", "timestamp": 1702018446, "time_this_iter_s": 5.933104038238525, "time_total_s": 22096.79230117798, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22096.79230117798, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 77.53333333333333, "ram_util_percent": 93.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.300318447772719e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 6.131978511810303, "policy_loss": -0.0039873081259429455, "vf_loss": 6.135965824127197, "vf_explained_var": 0.5550282597541809, "kl": 0.0016985854599624872, "entropy": 0.07116559892892838, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 100905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": 65.47300000000001, "episode_reward_min": 14.109, "episode_reward_mean": 28.486789999999996, "episode_len_mean": 59.09, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.537000000000006, 21.309333333333335, 19.898666666666667, 19.58899999999999, 20.154000000000003, 29.011666666666653, 26.27933333333332, 18.42633333333333, 15.045999999999996, 19.759999999999998, 20.44366666666666, 27.958999999999993, 23.480333333333334, 19.190999999999992, 25.129666666666665, 29.076666666666647, 41.54766666666663, 23.58366666666664, 60.15500000000004, 16.022333333333336, 36.742, 41.33566666666665, 41.31766666666666, 24.955999999999992, 15.345666666666663, 34.16833333333333, 50.76033333333334, 18.082999999999988, 17.391999999999996, 37.396000000000015, 17.50733333333333, 40.968666666666664, 16.637333333333327, 21.53866666666666, 31.807000000000002, 18.715000000000003, 27.155333333333324, 24.49866666666667, 28.005000000000003, 36.977, 25.59500000000001, 27.293666666666663, 41.67066666666667, 20.24033333333332, 32.943333333333314, 65.47300000000001, 24.412999999999993, 22.41366666666666, 51.52366666666666, 15.579666666666665, 30.697000000000013, 37.41733333333333, 24.193333333333324, 24.261333333333344, 46.80466666666664, 16.77133333333333, 16.46066666666667, 18.27966666666666, 30.676333333333332, 59.69433333333334, 22.48433333333333, 23.860666666666646, 29.897666666666648, 14.283333333333333, 19.486333333333324, 25.23666666666666, 15.017666666666658, 28.284999999999982, 23.644999999999975, 60.67833333333338, 31.068333333333317, 21.06766666666666, 17.940333333333328, 32.492333333333335, 22.930999999999994, 18.56733333333333, 33.96699999999997, 16.555999999999994, 43.97833333333333, 28.009333333333323, 14.682999999999995, 28.547333333333327, 62.96966666666668, 27.31833333333333, 18.81333333333333, 35.48766666666668, 23.16899999999999, 38.70066666666666, 46.78666666666668, 23.445333333333327, 18.548333333333325, 39.60033333333333, 16.816666666666663, 43.979666666666674, 19.622000000000003, 36.80799999999998, 18.555999999999994, 25.398666666666653, 14.109, 51.557666666666655], "episode_lengths": [42, 37, 35, 39, 43, 55, 51, 53, 31, 50, 37, 68, 47, 50, 52, 75, 66, 57, 93, 33, 65, 102, 63, 66, 33, 82, 80, 48, 34, 71, 38, 104, 34, 50, 68, 38, 47, 43, 50, 80, 55, 55, 69, 41, 77, 126, 48, 40, 125, 33, 55, 78, 45, 59, 101, 34, 34, 36, 54, 103, 41, 65, 76, 28, 48, 45, 36, 54, 74, 97, 81, 38, 51, 76, 46, 45, 85, 34, 82, 70, 29, 63, 116, 59, 43, 67, 57, 95, 85, 61, 46, 69, 41, 83, 41, 101, 36, 55, 30, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5686476753252803, "mean_inference_ms": 2.9927789520462795, "mean_action_processing_ms": 0.6015863987334508, "mean_env_wait_ms": 0.14606620284224284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01724982261657715, "StateBufferConnector_ms": 0.01729130744934082, "ViewRequirementAgentConnector_ms": 0.462566614151001}}, "episode_reward_max": 65.47300000000001, "episode_reward_min": 14.109, "episode_reward_mean": 28.486789999999996, "episode_len_mean": 59.09, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.537000000000006, 21.309333333333335, 19.898666666666667, 19.58899999999999, 20.154000000000003, 29.011666666666653, 26.27933333333332, 18.42633333333333, 15.045999999999996, 19.759999999999998, 20.44366666666666, 27.958999999999993, 23.480333333333334, 19.190999999999992, 25.129666666666665, 29.076666666666647, 41.54766666666663, 23.58366666666664, 60.15500000000004, 16.022333333333336, 36.742, 41.33566666666665, 41.31766666666666, 24.955999999999992, 15.345666666666663, 34.16833333333333, 50.76033333333334, 18.082999999999988, 17.391999999999996, 37.396000000000015, 17.50733333333333, 40.968666666666664, 16.637333333333327, 21.53866666666666, 31.807000000000002, 18.715000000000003, 27.155333333333324, 24.49866666666667, 28.005000000000003, 36.977, 25.59500000000001, 27.293666666666663, 41.67066666666667, 20.24033333333332, 32.943333333333314, 65.47300000000001, 24.412999999999993, 22.41366666666666, 51.52366666666666, 15.579666666666665, 30.697000000000013, 37.41733333333333, 24.193333333333324, 24.261333333333344, 46.80466666666664, 16.77133333333333, 16.46066666666667, 18.27966666666666, 30.676333333333332, 59.69433333333334, 22.48433333333333, 23.860666666666646, 29.897666666666648, 14.283333333333333, 19.486333333333324, 25.23666666666666, 15.017666666666658, 28.284999999999982, 23.644999999999975, 60.67833333333338, 31.068333333333317, 21.06766666666666, 17.940333333333328, 32.492333333333335, 22.930999999999994, 18.56733333333333, 33.96699999999997, 16.555999999999994, 43.97833333333333, 28.009333333333323, 14.682999999999995, 28.547333333333327, 62.96966666666668, 27.31833333333333, 18.81333333333333, 35.48766666666668, 23.16899999999999, 38.70066666666666, 46.78666666666668, 23.445333333333327, 18.548333333333325, 39.60033333333333, 16.816666666666663, 43.979666666666674, 19.622000000000003, 36.80799999999998, 18.555999999999994, 25.398666666666653, 14.109, 51.557666666666655], "episode_lengths": [42, 37, 35, 39, 43, 55, 51, 53, 31, 50, 37, 68, 47, 50, 52, 75, 66, 57, 93, 33, 65, 102, 63, 66, 33, 82, 80, 48, 34, 71, 38, 104, 34, 50, 68, 38, 47, 43, 50, 80, 55, 55, 69, 41, 77, 126, 48, 40, 125, 33, 55, 78, 45, 59, 101, 34, 34, 36, 54, 103, 41, 65, 76, 28, 48, 45, 36, 54, 74, 97, 81, 38, 51, 76, 46, 45, 85, 34, 82, 70, 29, 63, 116, 59, 43, 67, 57, 95, 85, 61, 46, 69, 41, 83, 41, 101, 36, 55, 30, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5686476753252803, "mean_inference_ms": 2.9927789520462795, "mean_action_processing_ms": 0.6015863987334508, "mean_env_wait_ms": 0.14606620284224284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01724982261657715, "StateBufferConnector_ms": 0.01729130744934082, "ViewRequirementAgentConnector_ms": 0.462566614151001}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 615.6086128469409, "num_env_steps_trained_throughput_per_sec": 615.6086128469409, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 9066.226, "sample_time_ms": 3672.172, "load_time_ms": 0.547, "load_throughput": 7314158.165, "learn_time_ms": 5363.16, "learn_throughput": 745.829, "synch_weights_time_ms": 27.963}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 8049, "training_iteration": 109, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-13", "timestamp": 1702018453, "time_this_iter_s": 6.516110420227051, "time_total_s": 22103.308411598206, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22103.308411598206, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 78.0375, "ram_util_percent": 93.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1501592238863595e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 5.1024298667907715, "policy_loss": -0.003870507935062051, "vf_loss": 5.106300354003906, "vf_explained_var": 0.6726122498512268, "kl": 0.001970279961824417, "entropy": 0.08777657151222229, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": 64.82233333333335, "episode_reward_min": 14.109, "episode_reward_mean": 27.838399999999996, "episode_len_mean": 60.87, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.644999999999975, 60.67833333333338, 31.068333333333317, 21.06766666666666, 17.940333333333328, 32.492333333333335, 22.930999999999994, 18.56733333333333, 33.96699999999997, 16.555999999999994, 43.97833333333333, 28.009333333333323, 14.682999999999995, 28.547333333333327, 62.96966666666668, 27.31833333333333, 18.81333333333333, 35.48766666666668, 23.16899999999999, 38.70066666666666, 46.78666666666668, 23.445333333333327, 18.548333333333325, 39.60033333333333, 16.816666666666663, 43.979666666666674, 19.622000000000003, 36.80799999999998, 18.555999999999994, 25.398666666666653, 14.109, 51.557666666666655, 27.991333333333323, 29.531000000000002, 23.912333333333333, 25.72366666666666, 16.196666666666662, 20.835666666666665, 25.253000000000004, 21.18533333333333, 18.925999999999995, 20.61399999999999, 15.738999999999992, 32.265, 26.944999999999993, 14.211333333333334, 18.36033333333332, 22.84033333333332, 33.51899999999998, 17.788999999999994, 17.32533333333333, 37.454666666666675, 19.237666666666666, 25.85099999999997, 26.38366666666666, 44.225666666666655, 31.507, 27.542999999999978, 24.066999999999993, 28.37033333333333, 41.91699999999998, 20.90399999999999, 19.977666666666657, 19.73466666666666, 19.426333333333332, 15.137000000000002, 28.84566666666666, 54.19466666666666, 40.48933333333334, 19.543999999999997, 22.267999999999997, 18.756999999999998, 28.977999999999973, 25.565333333333317, 21.87866666666666, 23.288666666666654, 51.76, 29.606999999999978, 17.110333333333333, 30.15399999999999, 30.24233333333331, 28.198333333333306, 34.43700000000001, 20.15999999999999, 19.403999999999993, 64.82233333333335, 27.302666666666667, 32.173999999999985, 17.143666666666668, 15.205999999999996, 16.656666666666666, 22.053666666666665, 35.566999999999986, 33.10033333333329, 21.294666666666664, 17.990999999999993, 41.87100000000002, 42.45033333333333, 34.55666666666668, 30.049333333333315], "episode_lengths": [74, 97, 81, 38, 51, 76, 46, 45, 85, 34, 82, 70, 29, 63, 116, 59, 43, 67, 57, 95, 85, 61, 46, 69, 41, 83, 41, 101, 36, 55, 30, 82, 64, 54, 48, 51, 34, 39, 62, 41, 45, 54, 38, 57, 80, 29, 50, 59, 94, 38, 37, 72, 52, 61, 62, 78, 64, 82, 54, 56, 99, 44, 49, 51, 44, 30, 80, 106, 100, 43, 44, 45, 79, 79, 56, 55, 87, 63, 38, 59, 80, 54, 70, 41, 46, 122, 46, 70, 38, 31, 32, 50, 84, 114, 44, 44, 76, 74, 73, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5646960027748116, "mean_inference_ms": 2.9856504152958125, "mean_action_processing_ms": 0.6007064833632705, "mean_env_wait_ms": 0.14575634232720666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015556812286376953, "StateBufferConnector_ms": 0.011862754821777344, "ViewRequirementAgentConnector_ms": 0.39341306686401367}}, "episode_reward_max": 64.82233333333335, "episode_reward_min": 14.109, "episode_reward_mean": 27.838399999999996, "episode_len_mean": 60.87, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.644999999999975, 60.67833333333338, 31.068333333333317, 21.06766666666666, 17.940333333333328, 32.492333333333335, 22.930999999999994, 18.56733333333333, 33.96699999999997, 16.555999999999994, 43.97833333333333, 28.009333333333323, 14.682999999999995, 28.547333333333327, 62.96966666666668, 27.31833333333333, 18.81333333333333, 35.48766666666668, 23.16899999999999, 38.70066666666666, 46.78666666666668, 23.445333333333327, 18.548333333333325, 39.60033333333333, 16.816666666666663, 43.979666666666674, 19.622000000000003, 36.80799999999998, 18.555999999999994, 25.398666666666653, 14.109, 51.557666666666655, 27.991333333333323, 29.531000000000002, 23.912333333333333, 25.72366666666666, 16.196666666666662, 20.835666666666665, 25.253000000000004, 21.18533333333333, 18.925999999999995, 20.61399999999999, 15.738999999999992, 32.265, 26.944999999999993, 14.211333333333334, 18.36033333333332, 22.84033333333332, 33.51899999999998, 17.788999999999994, 17.32533333333333, 37.454666666666675, 19.237666666666666, 25.85099999999997, 26.38366666666666, 44.225666666666655, 31.507, 27.542999999999978, 24.066999999999993, 28.37033333333333, 41.91699999999998, 20.90399999999999, 19.977666666666657, 19.73466666666666, 19.426333333333332, 15.137000000000002, 28.84566666666666, 54.19466666666666, 40.48933333333334, 19.543999999999997, 22.267999999999997, 18.756999999999998, 28.977999999999973, 25.565333333333317, 21.87866666666666, 23.288666666666654, 51.76, 29.606999999999978, 17.110333333333333, 30.15399999999999, 30.24233333333331, 28.198333333333306, 34.43700000000001, 20.15999999999999, 19.403999999999993, 64.82233333333335, 27.302666666666667, 32.173999999999985, 17.143666666666668, 15.205999999999996, 16.656666666666666, 22.053666666666665, 35.566999999999986, 33.10033333333329, 21.294666666666664, 17.990999999999993, 41.87100000000002, 42.45033333333333, 34.55666666666668, 30.049333333333315], "episode_lengths": [74, 97, 81, 38, 51, 76, 46, 45, 85, 34, 82, 70, 29, 63, 116, 59, 43, 67, 57, 95, 85, 61, 46, 69, 41, 83, 41, 101, 36, 55, 30, 82, 64, 54, 48, 51, 34, 39, 62, 41, 45, 54, 38, 57, 80, 29, 50, 59, 94, 38, 37, 72, 52, 61, 62, 78, 64, 82, 54, 56, 99, 44, 49, 51, 44, 30, 80, 106, 100, 43, 44, 45, 79, 79, 56, 55, 87, 63, 38, 59, 80, 54, 70, 41, 46, 122, 46, 70, 38, 31, 32, 50, 84, 114, 44, 44, 76, 74, 73, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5646960027748116, "mean_inference_ms": 2.9856504152958125, "mean_action_processing_ms": 0.6007064833632705, "mean_env_wait_ms": 0.14575634232720666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015556812286376953, "StateBufferConnector_ms": 0.011862754821777344, "ViewRequirementAgentConnector_ms": 0.39341306686401367}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 648.9419137741863, "num_env_steps_trained_throughput_per_sec": 648.9419137741863, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 8435.252, "sample_time_ms": 3250.02, "load_time_ms": 0.493, "load_throughput": 8117876.808, "learn_time_ms": 5154.728, "learn_throughput": 775.987, "synch_weights_time_ms": 27.477}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 8117, "training_iteration": 110, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-19", "timestamp": 1702018459, "time_this_iter_s": 6.18687891960144, "time_total_s": 22109.495290517807, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22109.495290517807, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 75.36666666666666, "ram_util_percent": 95.34444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.750796119431798e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 5.347968578338623, "policy_loss": -0.0028413161635398865, "vf_loss": 5.3508100509643555, "vf_explained_var": 0.603943407535553, "kl": 0.0010378553997725248, "entropy": 0.08179236948490143, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 102765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 64.82233333333335, "episode_reward_min": 14.010999999999997, "episode_reward_mean": 26.870343333333334, "episode_len_mean": 57.18, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.565333333333317, 21.87866666666666, 23.288666666666654, 51.76, 29.606999999999978, 17.110333333333333, 30.15399999999999, 30.24233333333331, 28.198333333333306, 34.43700000000001, 20.15999999999999, 19.403999999999993, 64.82233333333335, 27.302666666666667, 32.173999999999985, 17.143666666666668, 15.205999999999996, 16.656666666666666, 22.053666666666665, 35.566999999999986, 33.10033333333329, 21.294666666666664, 17.990999999999993, 41.87100000000002, 42.45033333333333, 34.55666666666668, 30.049333333333315, 19.78533333333333, 46.894000000000005, 16.411666666666665, 36.516666666666644, 19.606666666666662, 16.259999999999998, 14.010999999999997, 19.144999999999996, 22.478333333333328, 16.211999999999993, 27.892000000000003, 19.99899999999999, 23.473999999999975, 19.159666666666663, 30.480333333333324, 16.626333333333328, 44.48799999999999, 37.14, 24.04799999999999, 20.07833333333333, 15.259333333333329, 32.314000000000014, 27.09566666666666, 17.447999999999997, 19.334333333333333, 22.503333333333327, 19.644333333333336, 16.27933333333333, 18.356999999999992, 19.15433333333332, 23.19233333333333, 27.48033333333333, 18.73633333333333, 20.218666666666657, 20.68366666666666, 15.96933333333333, 16.46199999999999, 14.713999999999995, 29.262333333333338, 45.3936666666667, 43.713999999999984, 27.81933333333331, 27.240333333333325, 17.64466666666666, 19.958333333333325, 22.953333333333337, 20.941999999999997, 18.71066666666667, 26.056666666666665, 22.366999999999997, 20.37133333333332, 32.914333333333346, 41.18966666666668, 42.83866666666668, 18.908666666666665, 39.75966666666667, 26.97566666666666, 19.74699999999999, 24.059666666666647, 57.05900000000001, 18.309, 22.358999999999998, 21.897333333333332, 18.364, 27.73933333333333, 23.279666666666657, 54.94133333333334, 17.223, 31.040999999999997, 50.91533333333336, 26.304333333333325, 40.755666666666684, 48.421666666666695], "episode_lengths": [79, 56, 55, 87, 63, 38, 59, 80, 54, 70, 41, 46, 122, 46, 70, 38, 31, 32, 50, 84, 114, 44, 44, 76, 74, 73, 54, 44, 73, 32, 77, 40, 31, 30, 56, 59, 40, 48, 58, 69, 36, 65, 33, 103, 60, 59, 39, 32, 62, 51, 39, 49, 50, 38, 32, 39, 52, 46, 44, 35, 61, 37, 38, 42, 29, 58, 104, 103, 77, 52, 36, 52, 44, 40, 44, 62, 40, 39, 69, 75, 73, 45, 78, 53, 41, 67, 133, 34, 39, 53, 33, 60, 65, 109, 35, 54, 107, 58, 82, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5653503574693775, "mean_inference_ms": 2.9920113199470193, "mean_action_processing_ms": 0.6009436626638716, "mean_env_wait_ms": 0.14579160873272515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013286828994750977, "StateBufferConnector_ms": 0.017255306243896484, "ViewRequirementAgentConnector_ms": 0.5247044563293457}}, "episode_reward_max": 64.82233333333335, "episode_reward_min": 14.010999999999997, "episode_reward_mean": 26.870343333333334, "episode_len_mean": 57.18, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.565333333333317, 21.87866666666666, 23.288666666666654, 51.76, 29.606999999999978, 17.110333333333333, 30.15399999999999, 30.24233333333331, 28.198333333333306, 34.43700000000001, 20.15999999999999, 19.403999999999993, 64.82233333333335, 27.302666666666667, 32.173999999999985, 17.143666666666668, 15.205999999999996, 16.656666666666666, 22.053666666666665, 35.566999999999986, 33.10033333333329, 21.294666666666664, 17.990999999999993, 41.87100000000002, 42.45033333333333, 34.55666666666668, 30.049333333333315, 19.78533333333333, 46.894000000000005, 16.411666666666665, 36.516666666666644, 19.606666666666662, 16.259999999999998, 14.010999999999997, 19.144999999999996, 22.478333333333328, 16.211999999999993, 27.892000000000003, 19.99899999999999, 23.473999999999975, 19.159666666666663, 30.480333333333324, 16.626333333333328, 44.48799999999999, 37.14, 24.04799999999999, 20.07833333333333, 15.259333333333329, 32.314000000000014, 27.09566666666666, 17.447999999999997, 19.334333333333333, 22.503333333333327, 19.644333333333336, 16.27933333333333, 18.356999999999992, 19.15433333333332, 23.19233333333333, 27.48033333333333, 18.73633333333333, 20.218666666666657, 20.68366666666666, 15.96933333333333, 16.46199999999999, 14.713999999999995, 29.262333333333338, 45.3936666666667, 43.713999999999984, 27.81933333333331, 27.240333333333325, 17.64466666666666, 19.958333333333325, 22.953333333333337, 20.941999999999997, 18.71066666666667, 26.056666666666665, 22.366999999999997, 20.37133333333332, 32.914333333333346, 41.18966666666668, 42.83866666666668, 18.908666666666665, 39.75966666666667, 26.97566666666666, 19.74699999999999, 24.059666666666647, 57.05900000000001, 18.309, 22.358999999999998, 21.897333333333332, 18.364, 27.73933333333333, 23.279666666666657, 54.94133333333334, 17.223, 31.040999999999997, 50.91533333333336, 26.304333333333325, 40.755666666666684, 48.421666666666695], "episode_lengths": [79, 56, 55, 87, 63, 38, 59, 80, 54, 70, 41, 46, 122, 46, 70, 38, 31, 32, 50, 84, 114, 44, 44, 76, 74, 73, 54, 44, 73, 32, 77, 40, 31, 30, 56, 59, 40, 48, 58, 69, 36, 65, 33, 103, 60, 59, 39, 32, 62, 51, 39, 49, 50, 38, 32, 39, 52, 46, 44, 35, 61, 37, 38, 42, 29, 58, 104, 103, 77, 52, 36, 52, 44, 40, 44, 62, 40, 39, 69, 75, 73, 45, 78, 53, 41, 67, 133, 34, 39, 53, 33, 60, 65, 109, 35, 54, 107, 58, 82, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5653503574693775, "mean_inference_ms": 2.9920113199470193, "mean_action_processing_ms": 0.6009436626638716, "mean_env_wait_ms": 0.14579160873272515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013286828994750977, "StateBufferConnector_ms": 0.017255306243896484, "ViewRequirementAgentConnector_ms": 0.5247044563293457}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 405.16808825455365, "num_env_steps_trained_throughput_per_sec": 405.16808825455365, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 8506.137, "sample_time_ms": 3356.707, "load_time_ms": 0.493, "load_throughput": 8120627.299, "learn_time_ms": 5118.921, "learn_throughput": 781.415, "synch_weights_time_ms": 27.404}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 8190, "training_iteration": 111, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-29", "timestamp": 1702018469, "time_this_iter_s": 9.895417928695679, "time_total_s": 22119.390708446503, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22119.390708446503, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 88.53846153846153, "ram_util_percent": 96.5230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.875398059715899e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 5.542855739593506, "policy_loss": -0.005428774747997522, "vf_loss": 5.54828405380249, "vf_explained_var": 0.5094761252403259, "kl": 0.0026030796580016613, "entropy": 0.06773500889539719, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 103695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": 84.20366666666668, "episode_reward_min": 14.340666666666667, "episode_reward_mean": 29.166389999999993, "episode_len_mean": 59.85, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.713999999999984, 27.81933333333331, 27.240333333333325, 17.64466666666666, 19.958333333333325, 22.953333333333337, 20.941999999999997, 18.71066666666667, 26.056666666666665, 22.366999999999997, 20.37133333333332, 32.914333333333346, 41.18966666666668, 42.83866666666668, 18.908666666666665, 39.75966666666667, 26.97566666666666, 19.74699999999999, 24.059666666666647, 57.05900000000001, 18.309, 22.358999999999998, 21.897333333333332, 18.364, 27.73933333333333, 23.279666666666657, 54.94133333333334, 17.223, 31.040999999999997, 50.91533333333336, 26.304333333333325, 40.755666666666684, 48.421666666666695, 29.012, 17.917, 17.928666666666665, 36.098333333333336, 24.500333333333323, 36.370333333333335, 18.397333333333332, 24.72299999999998, 30.461333333333332, 37.48066666666667, 37.30266666666668, 24.673999999999992, 20.317666666666668, 41.21333333333332, 22.003333333333327, 25.25166666666665, 30.607999999999993, 23.57099999999999, 23.426333333333336, 17.09899999999999, 74.69199999999998, 16.662999999999993, 17.20633333333332, 19.11233333333332, 32.65466666666668, 37.86366666666667, 19.96066666666667, 24.567999999999998, 55.6903333333333, 20.256666666666657, 37.339666666666666, 19.077333333333332, 36.748999999999995, 56.93300000000004, 31.72566666666666, 21.182000000000006, 27.80566666666665, 22.35233333333334, 16.691333333333333, 26.786666666666648, 14.340666666666667, 18.35299999999999, 15.625999999999996, 14.472333333333323, 47.99166666666666, 32.123999999999995, 17.706333333333326, 31.692, 50.93866666666668, 28.667333333333342, 26.78766666666666, 28.8023333333333, 84.20366666666668, 28.86766666666665, 25.679333333333332, 33.60366666666667, 17.692666666666653, 22.966999999999988, 19.346999999999984, 29.10866666666665, 41.93466666666667, 20.030999999999988, 33.37199999999998, 16.890333333333327, 34.07933333333333, 36.95033333333333, 17.96266666666666], "episode_lengths": [103, 77, 52, 36, 52, 44, 40, 44, 62, 40, 39, 69, 75, 73, 45, 78, 53, 41, 67, 133, 34, 39, 53, 33, 60, 65, 109, 35, 54, 107, 58, 82, 96, 60, 36, 41, 60, 46, 66, 33, 68, 61, 61, 65, 59, 38, 77, 43, 62, 59, 49, 51, 34, 125, 33, 36, 43, 59, 87, 39, 73, 100, 52, 64, 38, 66, 110, 86, 44, 78, 39, 32, 77, 30, 39, 31, 34, 73, 67, 46, 55, 87, 53, 46, 91, 125, 54, 47, 63, 37, 58, 58, 86, 91, 41, 65, 39, 57, 72, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5676208890186585, "mean_inference_ms": 2.9989897515173687, "mean_action_processing_ms": 0.6015468008399396, "mean_env_wait_ms": 0.14603364951800638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018836021423339844, "StateBufferConnector_ms": 0.026982784271240234, "ViewRequirementAgentConnector_ms": 0.5620107650756836}}, "episode_reward_max": 84.20366666666668, "episode_reward_min": 14.340666666666667, "episode_reward_mean": 29.166389999999993, "episode_len_mean": 59.85, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.713999999999984, 27.81933333333331, 27.240333333333325, 17.64466666666666, 19.958333333333325, 22.953333333333337, 20.941999999999997, 18.71066666666667, 26.056666666666665, 22.366999999999997, 20.37133333333332, 32.914333333333346, 41.18966666666668, 42.83866666666668, 18.908666666666665, 39.75966666666667, 26.97566666666666, 19.74699999999999, 24.059666666666647, 57.05900000000001, 18.309, 22.358999999999998, 21.897333333333332, 18.364, 27.73933333333333, 23.279666666666657, 54.94133333333334, 17.223, 31.040999999999997, 50.91533333333336, 26.304333333333325, 40.755666666666684, 48.421666666666695, 29.012, 17.917, 17.928666666666665, 36.098333333333336, 24.500333333333323, 36.370333333333335, 18.397333333333332, 24.72299999999998, 30.461333333333332, 37.48066666666667, 37.30266666666668, 24.673999999999992, 20.317666666666668, 41.21333333333332, 22.003333333333327, 25.25166666666665, 30.607999999999993, 23.57099999999999, 23.426333333333336, 17.09899999999999, 74.69199999999998, 16.662999999999993, 17.20633333333332, 19.11233333333332, 32.65466666666668, 37.86366666666667, 19.96066666666667, 24.567999999999998, 55.6903333333333, 20.256666666666657, 37.339666666666666, 19.077333333333332, 36.748999999999995, 56.93300000000004, 31.72566666666666, 21.182000000000006, 27.80566666666665, 22.35233333333334, 16.691333333333333, 26.786666666666648, 14.340666666666667, 18.35299999999999, 15.625999999999996, 14.472333333333323, 47.99166666666666, 32.123999999999995, 17.706333333333326, 31.692, 50.93866666666668, 28.667333333333342, 26.78766666666666, 28.8023333333333, 84.20366666666668, 28.86766666666665, 25.679333333333332, 33.60366666666667, 17.692666666666653, 22.966999999999988, 19.346999999999984, 29.10866666666665, 41.93466666666667, 20.030999999999988, 33.37199999999998, 16.890333333333327, 34.07933333333333, 36.95033333333333, 17.96266666666666], "episode_lengths": [103, 77, 52, 36, 52, 44, 40, 44, 62, 40, 39, 69, 75, 73, 45, 78, 53, 41, 67, 133, 34, 39, 53, 33, 60, 65, 109, 35, 54, 107, 58, 82, 96, 60, 36, 41, 60, 46, 66, 33, 68, 61, 61, 65, 59, 38, 77, 43, 62, 59, 49, 51, 34, 125, 33, 36, 43, 59, 87, 39, 73, 100, 52, 64, 38, 66, 110, 86, 44, 78, 39, 32, 77, 30, 39, 31, 34, 73, 67, 46, 55, 87, 53, 46, 91, 125, 54, 47, 63, 37, 58, 58, 86, 91, 41, 65, 39, 57, 72, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5676208890186585, "mean_inference_ms": 2.9989897515173687, "mean_action_processing_ms": 0.6015468008399396, "mean_env_wait_ms": 0.14603364951800638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018836021423339844, "StateBufferConnector_ms": 0.026982784271240234, "ViewRequirementAgentConnector_ms": 0.5620107650756836}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.3576434849973, "num_env_steps_trained_throughput_per_sec": 409.3576434849973, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 8596.787, "sample_time_ms": 3422.96, "load_time_ms": 0.493, "load_throughput": 8120627.299, "learn_time_ms": 5143.518, "learn_throughput": 777.678, "synch_weights_time_ms": 27.313}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 8257, "training_iteration": 112, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-39", "timestamp": 1702018479, "time_this_iter_s": 9.795404434204102, "time_total_s": 22129.186112880707, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22129.186112880707, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 84.99090909090908, "ram_util_percent": 97.26363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4376990298579494e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 5.41203498840332, "policy_loss": -0.007264337036758661, "vf_loss": 5.419299125671387, "vf_explained_var": 0.5706642270088196, "kl": 0.0011714324355125427, "entropy": 0.06661270558834076, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 104625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": 84.20366666666668, "episode_reward_min": 13.220666666666666, "episode_reward_mean": 27.363549999999996, "episode_len_mean": 56.59, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.786666666666648, 14.340666666666667, 18.35299999999999, 15.625999999999996, 14.472333333333323, 47.99166666666666, 32.123999999999995, 17.706333333333326, 31.692, 50.93866666666668, 28.667333333333342, 26.78766666666666, 28.8023333333333, 84.20366666666668, 28.86766666666665, 25.679333333333332, 33.60366666666667, 17.692666666666653, 22.966999999999988, 19.346999999999984, 29.10866666666665, 41.93466666666667, 20.030999999999988, 33.37199999999998, 16.890333333333327, 34.07933333333333, 36.95033333333333, 17.96266666666666, 19.830999999999992, 31.475, 34.507000000000005, 17.327999999999996, 30.603999999999996, 18.611333333333327, 28.469666666666658, 47.68866666666668, 19.18933333333333, 24.55599999999997, 19.188666666666666, 27.536333333333324, 31.110666666666656, 22.946999999999985, 17.21166666666666, 18.305333333333326, 19.233999999999998, 27.783000000000015, 32.608000000000004, 39.85733333333332, 16.903999999999996, 25.022666666666662, 30.325666666666663, 27.41033333333332, 36.02933333333331, 44.88166666666664, 17.28466666666666, 19.051333333333325, 17.023999999999994, 28.554333333333325, 15.894333333333325, 28.340999999999983, 22.82866666666666, 20.346666666666664, 54.97499999999998, 42.116666666666674, 24.642999999999986, 40.03666666666668, 28.27799999999999, 32.67999999999999, 18.13633333333333, 20.21566666666666, 13.220666666666666, 16.19933333333333, 15.869333333333328, 14.67833333333333, 28.91066666666666, 23.034999999999997, 19.319333333333322, 17.245666666666665, 35.51066666666665, 23.314666666666653, 22.868999999999996, 32.857, 37.421666666666674, 15.190666666666656, 14.700333333333335, 20.147, 31.10066666666667, 16.27533333333333, 32.51200000000002, 16.267333333333326, 19.285666666666653, 37.693333333333335, 46.17299999999998, 35.670333333333346, 32.71533333333332, 22.938999999999993, 28.14033333333333, 53.473999999999975, 24.278666666666663, 33.34], "episode_lengths": [77, 30, 39, 31, 34, 73, 67, 46, 55, 87, 53, 46, 91, 125, 54, 47, 63, 37, 58, 58, 86, 91, 41, 65, 39, 57, 72, 42, 50, 61, 61, 37, 58, 43, 65, 71, 43, 70, 37, 64, 81, 42, 39, 38, 51, 61, 59, 73, 34, 46, 73, 67, 64, 80, 39, 38, 40, 54, 35, 67, 61, 48, 108, 111, 64, 63, 53, 65, 47, 39, 29, 35, 33, 31, 49, 72, 40, 38, 73, 57, 56, 77, 84, 33, 30, 46, 60, 42, 61, 33, 39, 71, 74, 61, 69, 43, 52, 91, 53, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5739164404831303, "mean_inference_ms": 3.0114073699495423, "mean_action_processing_ms": 0.6030427364919132, "mean_env_wait_ms": 0.1466309219531304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199625015258789, "StateBufferConnector_ms": 0.016320466995239258, "ViewRequirementAgentConnector_ms": 0.6673400402069092}}, "episode_reward_max": 84.20366666666668, "episode_reward_min": 13.220666666666666, "episode_reward_mean": 27.363549999999996, "episode_len_mean": 56.59, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.786666666666648, 14.340666666666667, 18.35299999999999, 15.625999999999996, 14.472333333333323, 47.99166666666666, 32.123999999999995, 17.706333333333326, 31.692, 50.93866666666668, 28.667333333333342, 26.78766666666666, 28.8023333333333, 84.20366666666668, 28.86766666666665, 25.679333333333332, 33.60366666666667, 17.692666666666653, 22.966999999999988, 19.346999999999984, 29.10866666666665, 41.93466666666667, 20.030999999999988, 33.37199999999998, 16.890333333333327, 34.07933333333333, 36.95033333333333, 17.96266666666666, 19.830999999999992, 31.475, 34.507000000000005, 17.327999999999996, 30.603999999999996, 18.611333333333327, 28.469666666666658, 47.68866666666668, 19.18933333333333, 24.55599999999997, 19.188666666666666, 27.536333333333324, 31.110666666666656, 22.946999999999985, 17.21166666666666, 18.305333333333326, 19.233999999999998, 27.783000000000015, 32.608000000000004, 39.85733333333332, 16.903999999999996, 25.022666666666662, 30.325666666666663, 27.41033333333332, 36.02933333333331, 44.88166666666664, 17.28466666666666, 19.051333333333325, 17.023999999999994, 28.554333333333325, 15.894333333333325, 28.340999999999983, 22.82866666666666, 20.346666666666664, 54.97499999999998, 42.116666666666674, 24.642999999999986, 40.03666666666668, 28.27799999999999, 32.67999999999999, 18.13633333333333, 20.21566666666666, 13.220666666666666, 16.19933333333333, 15.869333333333328, 14.67833333333333, 28.91066666666666, 23.034999999999997, 19.319333333333322, 17.245666666666665, 35.51066666666665, 23.314666666666653, 22.868999999999996, 32.857, 37.421666666666674, 15.190666666666656, 14.700333333333335, 20.147, 31.10066666666667, 16.27533333333333, 32.51200000000002, 16.267333333333326, 19.285666666666653, 37.693333333333335, 46.17299999999998, 35.670333333333346, 32.71533333333332, 22.938999999999993, 28.14033333333333, 53.473999999999975, 24.278666666666663, 33.34], "episode_lengths": [77, 30, 39, 31, 34, 73, 67, 46, 55, 87, 53, 46, 91, 125, 54, 47, 63, 37, 58, 58, 86, 91, 41, 65, 39, 57, 72, 42, 50, 61, 61, 37, 58, 43, 65, 71, 43, 70, 37, 64, 81, 42, 39, 38, 51, 61, 59, 73, 34, 46, 73, 67, 64, 80, 39, 38, 40, 54, 35, 67, 61, 48, 108, 111, 64, 63, 53, 65, 47, 39, 29, 35, 33, 31, 49, 72, 40, 38, 73, 57, 56, 77, 84, 33, 30, 46, 60, 42, 61, 33, 39, 71, 74, 61, 69, 43, 52, 91, 53, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5739164404831303, "mean_inference_ms": 3.0114073699495423, "mean_action_processing_ms": 0.6030427364919132, "mean_env_wait_ms": 0.1466309219531304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199625015258789, "StateBufferConnector_ms": 0.016320466995239258, "ViewRequirementAgentConnector_ms": 0.6673400402069092}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.55141599739756, "num_env_steps_trained_throughput_per_sec": 458.55141599739756, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 8461.483, "sample_time_ms": 3523.146, "load_time_ms": 0.493, "load_throughput": 8111596.964, "learn_time_ms": 4908.382, "learn_throughput": 814.932, "synch_weights_time_ms": 26.914}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 8329, "training_iteration": 113, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-48", "timestamp": 1702018488, "time_this_iter_s": 8.75660490989685, "time_total_s": 22137.942717790604, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22137.942717790604, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 85.52727272727272, "ram_util_percent": 96.10909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.188495149289747e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 5.732978820800781, "policy_loss": -0.0012752552283927798, "vf_loss": 5.734254360198975, "vf_explained_var": 0.5994182229042053, "kl": 0.012008735910058022, "entropy": 0.09049221873283386, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 65.21033333333337, "episode_reward_min": 13.220666666666666, "episode_reward_mean": 27.225176666666666, "episode_len_mean": 56.9, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.21566666666666, 13.220666666666666, 16.19933333333333, 15.869333333333328, 14.67833333333333, 28.91066666666666, 23.034999999999997, 19.319333333333322, 17.245666666666665, 35.51066666666665, 23.314666666666653, 22.868999999999996, 32.857, 37.421666666666674, 15.190666666666656, 14.700333333333335, 20.147, 31.10066666666667, 16.27533333333333, 32.51200000000002, 16.267333333333326, 19.285666666666653, 37.693333333333335, 46.17299999999998, 35.670333333333346, 32.71533333333332, 22.938999999999993, 28.14033333333333, 53.473999999999975, 24.278666666666663, 33.34, 20.83966666666666, 27.776333333333326, 55.768666666666704, 21.025999999999993, 41.95899999999999, 22.071666666666665, 26.79433333333333, 49.67100000000001, 23.851999999999993, 36.02433333333332, 38.402, 19.618, 22.118999999999996, 22.18566666666667, 31.89733333333333, 24.460333333333327, 19.15999999999999, 32.02766666666667, 21.502, 21.24399999999999, 20.081666666666663, 29.54633333333333, 37.96866666666671, 16.671666666666663, 20.31266666666666, 39.75066666666666, 18.62833333333333, 26.104666666666667, 18.976999999999997, 14.689666666666662, 16.80333333333333, 16.130999999999993, 18.353333333333335, 23.97699999999999, 14.580666666666659, 35.64866666666665, 20.288999999999994, 48.050999999999995, 46.637, 21.146999999999995, 15.74833333333333, 16.393666666666668, 17.838999999999995, 31.728333333333314, 39.88633333333332, 21.566666666666663, 53.80133333333334, 22.964333333333332, 19.299666666666656, 64.16099999999999, 34.25633333333334, 32.214, 65.21033333333337, 28.01266666666667, 43.467000000000006, 27.563999999999986, 14.830999999999994, 22.587999999999994, 16.09166666666666, 25.168666666666656, 37.92333333333335, 24.404666666666653, 22.166333333333334, 27.938666666666673, 29.585000000000004, 17.913333333333327, 16.44233333333333, 17.029333333333323, 33.004000000000005], "episode_lengths": [39, 29, 35, 33, 31, 49, 72, 40, 38, 73, 57, 56, 77, 84, 33, 30, 46, 60, 42, 61, 33, 39, 71, 74, 61, 69, 43, 52, 91, 53, 63, 43, 53, 104, 49, 88, 50, 56, 86, 52, 98, 79, 46, 51, 38, 64, 45, 49, 76, 40, 49, 50, 66, 65, 44, 38, 69, 35, 53, 45, 35, 34, 36, 36, 60, 33, 97, 38, 96, 80, 45, 34, 30, 50, 84, 111, 59, 102, 43, 52, 129, 67, 82, 115, 57, 72, 68, 30, 45, 37, 44, 67, 47, 50, 67, 77, 36, 33, 38, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5752829829051, "mean_inference_ms": 3.0145526212179163, "mean_action_processing_ms": 0.6024030043814148, "mean_env_wait_ms": 0.14660492313064213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026958227157592773, "StateBufferConnector_ms": 0.016446828842163086, "ViewRequirementAgentConnector_ms": 0.4988698959350586}}, "episode_reward_max": 65.21033333333337, "episode_reward_min": 13.220666666666666, "episode_reward_mean": 27.225176666666666, "episode_len_mean": 56.9, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.21566666666666, 13.220666666666666, 16.19933333333333, 15.869333333333328, 14.67833333333333, 28.91066666666666, 23.034999999999997, 19.319333333333322, 17.245666666666665, 35.51066666666665, 23.314666666666653, 22.868999999999996, 32.857, 37.421666666666674, 15.190666666666656, 14.700333333333335, 20.147, 31.10066666666667, 16.27533333333333, 32.51200000000002, 16.267333333333326, 19.285666666666653, 37.693333333333335, 46.17299999999998, 35.670333333333346, 32.71533333333332, 22.938999999999993, 28.14033333333333, 53.473999999999975, 24.278666666666663, 33.34, 20.83966666666666, 27.776333333333326, 55.768666666666704, 21.025999999999993, 41.95899999999999, 22.071666666666665, 26.79433333333333, 49.67100000000001, 23.851999999999993, 36.02433333333332, 38.402, 19.618, 22.118999999999996, 22.18566666666667, 31.89733333333333, 24.460333333333327, 19.15999999999999, 32.02766666666667, 21.502, 21.24399999999999, 20.081666666666663, 29.54633333333333, 37.96866666666671, 16.671666666666663, 20.31266666666666, 39.75066666666666, 18.62833333333333, 26.104666666666667, 18.976999999999997, 14.689666666666662, 16.80333333333333, 16.130999999999993, 18.353333333333335, 23.97699999999999, 14.580666666666659, 35.64866666666665, 20.288999999999994, 48.050999999999995, 46.637, 21.146999999999995, 15.74833333333333, 16.393666666666668, 17.838999999999995, 31.728333333333314, 39.88633333333332, 21.566666666666663, 53.80133333333334, 22.964333333333332, 19.299666666666656, 64.16099999999999, 34.25633333333334, 32.214, 65.21033333333337, 28.01266666666667, 43.467000000000006, 27.563999999999986, 14.830999999999994, 22.587999999999994, 16.09166666666666, 25.168666666666656, 37.92333333333335, 24.404666666666653, 22.166333333333334, 27.938666666666673, 29.585000000000004, 17.913333333333327, 16.44233333333333, 17.029333333333323, 33.004000000000005], "episode_lengths": [39, 29, 35, 33, 31, 49, 72, 40, 38, 73, 57, 56, 77, 84, 33, 30, 46, 60, 42, 61, 33, 39, 71, 74, 61, 69, 43, 52, 91, 53, 63, 43, 53, 104, 49, 88, 50, 56, 86, 52, 98, 79, 46, 51, 38, 64, 45, 49, 76, 40, 49, 50, 66, 65, 44, 38, 69, 35, 53, 45, 35, 34, 36, 36, 60, 33, 97, 38, 96, 80, 45, 34, 30, 50, 84, 111, 59, 102, 43, 52, 129, 67, 82, 115, 57, 72, 68, 30, 45, 37, 44, 67, 47, 50, 67, 77, 36, 33, 38, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5752829829051, "mean_inference_ms": 3.0145526212179163, "mean_action_processing_ms": 0.6024030043814148, "mean_env_wait_ms": 0.14660492313064213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026958227157592773, "StateBufferConnector_ms": 0.016446828842163086, "ViewRequirementAgentConnector_ms": 0.4988698959350586}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 600.9377617450174, "num_env_steps_trained_throughput_per_sec": 600.9377617450174, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 8124.235, "sample_time_ms": 3408.879, "load_time_ms": 0.398, "load_throughput": 10050449.889, "learn_time_ms": 4687.349, "learn_throughput": 853.361, "synch_weights_time_ms": 25.214}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 8398, "training_iteration": 114, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-54-54", "timestamp": 1702018494, "time_this_iter_s": 6.678259611129761, "time_total_s": 22144.620977401733, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22144.620977401733, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 81.37777777777778, "ram_util_percent": 95.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.188495149289747e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 5.67625617980957, "policy_loss": -0.004056102130562067, "vf_loss": 5.680312156677246, "vf_explained_var": 0.6245858669281006, "kl": 0.003868296043947339, "entropy": 0.13071687519550323, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 106485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": 65.21033333333337, "episode_reward_min": 13.492999999999995, "episode_reward_mean": 26.550506666666664, "episode_len_mean": 57.71, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.74833333333333, 16.393666666666668, 17.838999999999995, 31.728333333333314, 39.88633333333332, 21.566666666666663, 53.80133333333334, 22.964333333333332, 19.299666666666656, 64.16099999999999, 34.25633333333334, 32.214, 65.21033333333337, 28.01266666666667, 43.467000000000006, 27.563999999999986, 14.830999999999994, 22.587999999999994, 16.09166666666666, 25.168666666666656, 37.92333333333335, 24.404666666666653, 22.166333333333334, 27.938666666666673, 29.585000000000004, 17.913333333333327, 16.44233333333333, 17.029333333333323, 33.004000000000005, 17.252666666666663, 28.191999999999993, 32.402333333333324, 21.013333333333325, 19.36233333333332, 19.356999999999992, 24.901999999999997, 36.291999999999994, 28.04633333333333, 20.589666666666655, 17.126666666666654, 16.336333333333336, 34.08266666666665, 20.863666666666663, 27.749999999999996, 38.26700000000001, 33.86099999999999, 17.20933333333333, 22.36533333333333, 17.317999999999994, 16.42366666666667, 21.244000000000003, 43.98533333333334, 19.380666666666652, 15.159666666666656, 36.28466666666666, 17.141999999999996, 22.53333333333333, 13.966999999999995, 16.080333333333336, 40.73466666666664, 30.44500000000001, 21.835666666666665, 16.216999999999995, 22.239666666666665, 53.17866666666664, 15.286333333333333, 38.996000000000016, 40.138999999999996, 15.701666666666663, 21.09166666666665, 35.72033333333333, 28.227999999999987, 24.914333333333317, 24.288666666666668, 38.65899999999996, 14.183333333333332, 37.76066666666664, 35.84699999999999, 22.527666666666658, 17.66566666666666, 50.2313333333333, 13.983666666666668, 30.871999999999986, 37.66066666666666, 16.31566666666666, 33.76766666666666, 21.782999999999983, 14.680666666666662, 17.482666666666663, 33.02999999999999, 18.896999999999995, 15.015333333333334, 16.843666666666657, 24.896999999999984, 35.681, 34.31033333333334, 24.65366666666666, 13.492999999999995, 21.079, 30.72366666666665], "episode_lengths": [34, 30, 50, 84, 111, 59, 102, 43, 52, 129, 67, 82, 115, 57, 72, 68, 30, 45, 37, 44, 67, 47, 50, 67, 77, 36, 33, 38, 59, 37, 61, 63, 50, 60, 37, 48, 59, 54, 54, 51, 31, 77, 63, 64, 70, 71, 41, 43, 38, 30, 43, 93, 60, 36, 74, 43, 49, 30, 41, 66, 54, 56, 36, 56, 123, 31, 62, 78, 35, 55, 78, 74, 64, 42, 83, 29, 98, 100, 49, 50, 122, 30, 76, 73, 34, 63, 60, 29, 34, 57, 39, 32, 37, 64, 76, 80, 47, 30, 54, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5735223633373208, "mean_inference_ms": 3.0104635135147895, "mean_action_processing_ms": 0.6017473599581852, "mean_env_wait_ms": 0.14664717261285704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031360626220703125, "StateBufferConnector_ms": 0.01018071174621582, "ViewRequirementAgentConnector_ms": 0.44126415252685547}}, "episode_reward_max": 65.21033333333337, "episode_reward_min": 13.492999999999995, "episode_reward_mean": 26.550506666666664, "episode_len_mean": 57.71, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.74833333333333, 16.393666666666668, 17.838999999999995, 31.728333333333314, 39.88633333333332, 21.566666666666663, 53.80133333333334, 22.964333333333332, 19.299666666666656, 64.16099999999999, 34.25633333333334, 32.214, 65.21033333333337, 28.01266666666667, 43.467000000000006, 27.563999999999986, 14.830999999999994, 22.587999999999994, 16.09166666666666, 25.168666666666656, 37.92333333333335, 24.404666666666653, 22.166333333333334, 27.938666666666673, 29.585000000000004, 17.913333333333327, 16.44233333333333, 17.029333333333323, 33.004000000000005, 17.252666666666663, 28.191999999999993, 32.402333333333324, 21.013333333333325, 19.36233333333332, 19.356999999999992, 24.901999999999997, 36.291999999999994, 28.04633333333333, 20.589666666666655, 17.126666666666654, 16.336333333333336, 34.08266666666665, 20.863666666666663, 27.749999999999996, 38.26700000000001, 33.86099999999999, 17.20933333333333, 22.36533333333333, 17.317999999999994, 16.42366666666667, 21.244000000000003, 43.98533333333334, 19.380666666666652, 15.159666666666656, 36.28466666666666, 17.141999999999996, 22.53333333333333, 13.966999999999995, 16.080333333333336, 40.73466666666664, 30.44500000000001, 21.835666666666665, 16.216999999999995, 22.239666666666665, 53.17866666666664, 15.286333333333333, 38.996000000000016, 40.138999999999996, 15.701666666666663, 21.09166666666665, 35.72033333333333, 28.227999999999987, 24.914333333333317, 24.288666666666668, 38.65899999999996, 14.183333333333332, 37.76066666666664, 35.84699999999999, 22.527666666666658, 17.66566666666666, 50.2313333333333, 13.983666666666668, 30.871999999999986, 37.66066666666666, 16.31566666666666, 33.76766666666666, 21.782999999999983, 14.680666666666662, 17.482666666666663, 33.02999999999999, 18.896999999999995, 15.015333333333334, 16.843666666666657, 24.896999999999984, 35.681, 34.31033333333334, 24.65366666666666, 13.492999999999995, 21.079, 30.72366666666665], "episode_lengths": [34, 30, 50, 84, 111, 59, 102, 43, 52, 129, 67, 82, 115, 57, 72, 68, 30, 45, 37, 44, 67, 47, 50, 67, 77, 36, 33, 38, 59, 37, 61, 63, 50, 60, 37, 48, 59, 54, 54, 51, 31, 77, 63, 64, 70, 71, 41, 43, 38, 30, 43, 93, 60, 36, 74, 43, 49, 30, 41, 66, 54, 56, 36, 56, 123, 31, 62, 78, 35, 55, 78, 74, 64, 42, 83, 29, 98, 100, 49, 50, 122, 30, 76, 73, 34, 63, 60, 29, 34, 57, 39, 32, 37, 64, 76, 80, 47, 30, 54, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5735223633373208, "mean_inference_ms": 3.0104635135147895, "mean_action_processing_ms": 0.6017473599581852, "mean_env_wait_ms": 0.14664717261285704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031360626220703125, "StateBufferConnector_ms": 0.01018071174621582, "ViewRequirementAgentConnector_ms": 0.44126415252685547}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 605.053860352251, "num_env_steps_trained_throughput_per_sec": 605.053860352251, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 7818.593, "sample_time_ms": 3312.986, "load_time_ms": 0.368, "load_throughput": 10874524.242, "learn_time_ms": 4479.134, "learn_throughput": 893.03, "synch_weights_time_ms": 23.643}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 8469, "training_iteration": 115, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-01", "timestamp": 1702018501, "time_this_iter_s": 6.624974727630615, "time_total_s": 22151.245952129364, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22151.245952129364, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 81.45555555555556, "ram_util_percent": 96.88888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.5942475746448735e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 5.71779727935791, "policy_loss": -0.008994453586637974, "vf_loss": 5.7267913818359375, "vf_explained_var": 0.5913234353065491, "kl": 0.0026532611809670925, "entropy": 0.10326612740755081, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 107415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": 57.54700000000006, "episode_reward_min": 13.492999999999995, "episode_reward_mean": 27.507633333333327, "episode_len_mean": 60.01, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.286333333333333, 38.996000000000016, 40.138999999999996, 15.701666666666663, 21.09166666666665, 35.72033333333333, 28.227999999999987, 24.914333333333317, 24.288666666666668, 38.65899999999996, 14.183333333333332, 37.76066666666664, 35.84699999999999, 22.527666666666658, 17.66566666666666, 50.2313333333333, 13.983666666666668, 30.871999999999986, 37.66066666666666, 16.31566666666666, 33.76766666666666, 21.782999999999983, 14.680666666666662, 17.482666666666663, 33.02999999999999, 18.896999999999995, 15.015333333333334, 16.843666666666657, 24.896999999999984, 35.681, 34.31033333333334, 24.65366666666666, 13.492999999999995, 21.079, 30.72366666666665, 56.44533333333334, 20.50099999999999, 36.214999999999996, 22.602000000000004, 21.776999999999987, 22.207666666666647, 50.17333333333333, 20.120666666666658, 14.680666666666664, 19.631666666666668, 14.581, 25.416999999999977, 38.27933333333332, 57.54700000000006, 19.771666666666665, 34.27033333333333, 25.185666666666663, 21.717, 37.813666666666656, 20.523999999999983, 21.13899999999999, 44.62533333333333, 22.700999999999997, 21.40933333333332, 23.769, 28.88166666666666, 23.922666666666665, 46.58133333333332, 37.11966666666667, 19.175, 14.891999999999996, 17.739999999999995, 42.178666666666665, 16.033999999999995, 26.593000000000004, 18.53633333333333, 15.892666666666665, 19.407333333333327, 27.38366666666666, 53.48266666666666, 15.144666666666666, 37.10099999999999, 16.508999999999993, 26.06366666666667, 35.31933333333332, 15.49033333333333, 36.22266666666665, 17.829000000000004, 19.74133333333333, 25.090666666666657, 19.118333333333336, 45.19799999999997, 45.67800000000001, 26.515333333333327, 34.791999999999994, 25.646999999999995, 39.99899999999999, 33.81099999999998, 41.66566666666664, 30.996333333333332, 15.903666666666664, 20.886, 29.093999999999998, 39.90366666666666, 19.708], "episode_lengths": [31, 62, 78, 35, 55, 78, 74, 64, 42, 83, 29, 98, 100, 49, 50, 122, 30, 76, 73, 34, 63, 60, 29, 34, 57, 39, 32, 37, 64, 76, 80, 47, 30, 54, 59, 133, 40, 82, 43, 61, 46, 92, 49, 30, 62, 28, 65, 115, 108, 47, 83, 54, 46, 90, 66, 45, 90, 50, 80, 58, 61, 51, 79, 73, 37, 30, 53, 84, 36, 61, 42, 39, 44, 60, 105, 31, 71, 30, 55, 71, 30, 75, 44, 39, 49, 48, 76, 81, 55, 58, 58, 88, 83, 76, 54, 34, 44, 73, 93, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5705547326369012, "mean_inference_ms": 3.006450409291689, "mean_action_processing_ms": 0.6004313123266131, "mean_env_wait_ms": 0.14639870432800856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03331255912780762, "StateBufferConnector_ms": 0.007893800735473633, "ViewRequirementAgentConnector_ms": 0.39033937454223633}}, "episode_reward_max": 57.54700000000006, "episode_reward_min": 13.492999999999995, "episode_reward_mean": 27.507633333333327, "episode_len_mean": 60.01, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.286333333333333, 38.996000000000016, 40.138999999999996, 15.701666666666663, 21.09166666666665, 35.72033333333333, 28.227999999999987, 24.914333333333317, 24.288666666666668, 38.65899999999996, 14.183333333333332, 37.76066666666664, 35.84699999999999, 22.527666666666658, 17.66566666666666, 50.2313333333333, 13.983666666666668, 30.871999999999986, 37.66066666666666, 16.31566666666666, 33.76766666666666, 21.782999999999983, 14.680666666666662, 17.482666666666663, 33.02999999999999, 18.896999999999995, 15.015333333333334, 16.843666666666657, 24.896999999999984, 35.681, 34.31033333333334, 24.65366666666666, 13.492999999999995, 21.079, 30.72366666666665, 56.44533333333334, 20.50099999999999, 36.214999999999996, 22.602000000000004, 21.776999999999987, 22.207666666666647, 50.17333333333333, 20.120666666666658, 14.680666666666664, 19.631666666666668, 14.581, 25.416999999999977, 38.27933333333332, 57.54700000000006, 19.771666666666665, 34.27033333333333, 25.185666666666663, 21.717, 37.813666666666656, 20.523999999999983, 21.13899999999999, 44.62533333333333, 22.700999999999997, 21.40933333333332, 23.769, 28.88166666666666, 23.922666666666665, 46.58133333333332, 37.11966666666667, 19.175, 14.891999999999996, 17.739999999999995, 42.178666666666665, 16.033999999999995, 26.593000000000004, 18.53633333333333, 15.892666666666665, 19.407333333333327, 27.38366666666666, 53.48266666666666, 15.144666666666666, 37.10099999999999, 16.508999999999993, 26.06366666666667, 35.31933333333332, 15.49033333333333, 36.22266666666665, 17.829000000000004, 19.74133333333333, 25.090666666666657, 19.118333333333336, 45.19799999999997, 45.67800000000001, 26.515333333333327, 34.791999999999994, 25.646999999999995, 39.99899999999999, 33.81099999999998, 41.66566666666664, 30.996333333333332, 15.903666666666664, 20.886, 29.093999999999998, 39.90366666666666, 19.708], "episode_lengths": [31, 62, 78, 35, 55, 78, 74, 64, 42, 83, 29, 98, 100, 49, 50, 122, 30, 76, 73, 34, 63, 60, 29, 34, 57, 39, 32, 37, 64, 76, 80, 47, 30, 54, 59, 133, 40, 82, 43, 61, 46, 92, 49, 30, 62, 28, 65, 115, 108, 47, 83, 54, 46, 90, 66, 45, 90, 50, 80, 58, 61, 51, 79, 73, 37, 30, 53, 84, 36, 61, 42, 39, 44, 60, 105, 31, 71, 30, 55, 71, 30, 75, 44, 39, 49, 48, 76, 81, 55, 58, 58, 88, 83, 76, 54, 34, 44, 73, 93, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5705547326369012, "mean_inference_ms": 3.006450409291689, "mean_action_processing_ms": 0.6004313123266131, "mean_env_wait_ms": 0.14639870432800856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03331255912780762, "StateBufferConnector_ms": 0.007893800735473633, "ViewRequirementAgentConnector_ms": 0.39033937454223633}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 636.6399504203621, "num_env_steps_trained_throughput_per_sec": 636.6399504203621, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 7445.223, "sample_time_ms": 3173.241, "load_time_ms": 0.368, "load_throughput": 10874524.242, "learn_time_ms": 4247.099, "learn_throughput": 941.819, "synch_weights_time_ms": 22.192}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 8534, "training_iteration": 116, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-07", "timestamp": 1702018507, "time_this_iter_s": 6.296880722045898, "time_total_s": 22157.54283285141, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22157.54283285141, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 79.275, "ram_util_percent": 96.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7971237873224367e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 5.3998236656188965, "policy_loss": -0.004400931298732758, "vf_loss": 5.404224395751953, "vf_explained_var": 0.5754517912864685, "kl": 0.0031093216966837645, "entropy": 0.09759656339883804, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 108345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 60.45733333333335, "episode_reward_min": 14.385999999999994, "episode_reward_mean": 27.458593333333326, "episode_len_mean": 57.43, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.033999999999995, 26.593000000000004, 18.53633333333333, 15.892666666666665, 19.407333333333327, 27.38366666666666, 53.48266666666666, 15.144666666666666, 37.10099999999999, 16.508999999999993, 26.06366666666667, 35.31933333333332, 15.49033333333333, 36.22266666666665, 17.829000000000004, 19.74133333333333, 25.090666666666657, 19.118333333333336, 45.19799999999997, 45.67800000000001, 26.515333333333327, 34.791999999999994, 25.646999999999995, 39.99899999999999, 33.81099999999998, 41.66566666666664, 30.996333333333332, 15.903666666666664, 20.886, 29.093999999999998, 39.90366666666666, 19.708, 47.85066666666667, 21.986666666666657, 22.923666666666655, 26.791999999999994, 35.71099999999998, 14.876333333333326, 23.08566666666666, 55.13799999999999, 49.789666666666584, 17.071, 16.445333333333334, 29.57433333333333, 14.941333333333334, 18.013333333333332, 16.451333333333324, 16.151666666666664, 28.518999999999984, 17.725999999999996, 32.01133333333333, 26.091999999999977, 50.11399999999998, 22.719333333333335, 25.06633333333333, 44.99066666666668, 26.69133333333332, 51.614333333333335, 19.14966666666666, 39.49799999999998, 32.436333333333316, 18.309999999999988, 17.08333333333333, 15.35033333333333, 19.847333333333328, 54.894000000000005, 18.47066666666666, 29.389333333333322, 21.58266666666666, 22.18633333333333, 14.385999999999994, 18.461333333333325, 27.188, 60.45733333333335, 21.26199999999999, 15.713666666666663, 25.177999999999994, 24.632333333333325, 17.816999999999993, 21.136999999999993, 20.153999999999993, 37.24866666666666, 59.94966666666669, 20.079333333333327, 16.971666666666657, 49.03633333333331, 20.692999999999994, 19.97133333333333, 20.25933333333333, 18.91699999999999, 20.26933333333332, 23.731666666666666, 21.952999999999992, 20.07799999999999, 37.74099999999999, 19.613999999999994, 23.340666666666664, 40.37899999999999, 38.190333333333335, 19.74766666666666], "episode_lengths": [36, 61, 42, 39, 44, 60, 105, 31, 71, 30, 55, 71, 30, 75, 44, 39, 49, 48, 76, 81, 55, 58, 58, 88, 83, 76, 54, 34, 44, 73, 93, 43, 104, 45, 62, 68, 76, 31, 48, 109, 113, 36, 35, 52, 30, 35, 36, 33, 61, 38, 61, 77, 102, 52, 57, 89, 46, 98, 40, 84, 78, 46, 42, 36, 55, 88, 47, 65, 47, 43, 28, 37, 53, 113, 43, 30, 54, 52, 40, 50, 41, 71, 104, 36, 42, 86, 49, 44, 44, 45, 42, 50, 50, 51, 92, 54, 52, 72, 68, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5674653601231556, "mean_inference_ms": 3.0010117268432555, "mean_action_processing_ms": 0.5998914827659052, "mean_env_wait_ms": 0.14612835061478077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011209726333618164, "StateBufferConnector_ms": 0.014276742935180664, "ViewRequirementAgentConnector_ms": 0.4149339199066162}}, "episode_reward_max": 60.45733333333335, "episode_reward_min": 14.385999999999994, "episode_reward_mean": 27.458593333333326, "episode_len_mean": 57.43, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.033999999999995, 26.593000000000004, 18.53633333333333, 15.892666666666665, 19.407333333333327, 27.38366666666666, 53.48266666666666, 15.144666666666666, 37.10099999999999, 16.508999999999993, 26.06366666666667, 35.31933333333332, 15.49033333333333, 36.22266666666665, 17.829000000000004, 19.74133333333333, 25.090666666666657, 19.118333333333336, 45.19799999999997, 45.67800000000001, 26.515333333333327, 34.791999999999994, 25.646999999999995, 39.99899999999999, 33.81099999999998, 41.66566666666664, 30.996333333333332, 15.903666666666664, 20.886, 29.093999999999998, 39.90366666666666, 19.708, 47.85066666666667, 21.986666666666657, 22.923666666666655, 26.791999999999994, 35.71099999999998, 14.876333333333326, 23.08566666666666, 55.13799999999999, 49.789666666666584, 17.071, 16.445333333333334, 29.57433333333333, 14.941333333333334, 18.013333333333332, 16.451333333333324, 16.151666666666664, 28.518999999999984, 17.725999999999996, 32.01133333333333, 26.091999999999977, 50.11399999999998, 22.719333333333335, 25.06633333333333, 44.99066666666668, 26.69133333333332, 51.614333333333335, 19.14966666666666, 39.49799999999998, 32.436333333333316, 18.309999999999988, 17.08333333333333, 15.35033333333333, 19.847333333333328, 54.894000000000005, 18.47066666666666, 29.389333333333322, 21.58266666666666, 22.18633333333333, 14.385999999999994, 18.461333333333325, 27.188, 60.45733333333335, 21.26199999999999, 15.713666666666663, 25.177999999999994, 24.632333333333325, 17.816999999999993, 21.136999999999993, 20.153999999999993, 37.24866666666666, 59.94966666666669, 20.079333333333327, 16.971666666666657, 49.03633333333331, 20.692999999999994, 19.97133333333333, 20.25933333333333, 18.91699999999999, 20.26933333333332, 23.731666666666666, 21.952999999999992, 20.07799999999999, 37.74099999999999, 19.613999999999994, 23.340666666666664, 40.37899999999999, 38.190333333333335, 19.74766666666666], "episode_lengths": [36, 61, 42, 39, 44, 60, 105, 31, 71, 30, 55, 71, 30, 75, 44, 39, 49, 48, 76, 81, 55, 58, 58, 88, 83, 76, 54, 34, 44, 73, 93, 43, 104, 45, 62, 68, 76, 31, 48, 109, 113, 36, 35, 52, 30, 35, 36, 33, 61, 38, 61, 77, 102, 52, 57, 89, 46, 98, 40, 84, 78, 46, 42, 36, 55, 88, 47, 65, 47, 43, 28, 37, 53, 113, 43, 30, 54, 52, 40, 50, 41, 71, 104, 36, 42, 86, 49, 44, 44, 45, 42, 50, 50, 51, 92, 54, 52, 72, 68, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5674653601231556, "mean_inference_ms": 3.0010117268432555, "mean_action_processing_ms": 0.5998914827659052, "mean_env_wait_ms": 0.14612835061478077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011209726333618164, "StateBufferConnector_ms": 0.014276742935180664, "ViewRequirementAgentConnector_ms": 0.4149339199066162}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 616.4425378013997, "num_env_steps_trained_throughput_per_sec": 616.4425378013997, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 7297.966, "sample_time_ms": 3068.447, "load_time_ms": 0.267, "load_throughput": 14960955.948, "learn_time_ms": 4204.561, "learn_throughput": 951.348, "synch_weights_time_ms": 22.383}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 8602, "training_iteration": 117, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-14", "timestamp": 1702018514, "time_this_iter_s": 6.506853818893433, "time_total_s": 22164.049686670303, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22164.049686670303, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 82.1, "ram_util_percent": 93.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.985618936612184e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 5.863280296325684, "policy_loss": -0.007892750203609467, "vf_loss": 5.87117338180542, "vf_explained_var": 0.5896835923194885, "kl": 0.0039319321513175964, "entropy": 0.09299630671739578, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 109275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": 67.96333333333331, "episode_reward_min": 13.938333333333333, "episode_reward_mean": 27.87492333333333, "episode_len_mean": 58.89, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.389333333333322, 21.58266666666666, 22.18633333333333, 14.385999999999994, 18.461333333333325, 27.188, 60.45733333333335, 21.26199999999999, 15.713666666666663, 25.177999999999994, 24.632333333333325, 17.816999999999993, 21.136999999999993, 20.153999999999993, 37.24866666666666, 59.94966666666669, 20.079333333333327, 16.971666666666657, 49.03633333333331, 20.692999999999994, 19.97133333333333, 20.25933333333333, 18.91699999999999, 20.26933333333332, 23.731666666666666, 21.952999999999992, 20.07799999999999, 37.74099999999999, 19.613999999999994, 23.340666666666664, 40.37899999999999, 38.190333333333335, 19.74766666666666, 25.738333333333326, 37.681333333333335, 14.015, 31.643666666666665, 29.487666666666673, 33.339, 30.097333333333317, 14.838666666666668, 15.057999999999996, 24.032999999999987, 17.688666666666663, 40.80833333333334, 57.55866666666669, 18.68633333333333, 17.600666666666665, 18.464666666666663, 39.264666666666656, 17.933999999999994, 20.01166666666666, 53.766999999999996, 30.207333333333313, 16.82333333333333, 62.2736666666667, 36.59366666666666, 25.322, 23.825333333333326, 41.605666666666664, 22.966, 29.133666666666667, 31.15133333333334, 21.90833333333332, 21.80033333333332, 22.107999999999993, 35.395999999999994, 29.0, 46.39633333333335, 29.339000000000002, 20.12099999999999, 26.462999999999987, 17.610666666666663, 28.946333333333303, 26.709666666666646, 20.054999999999993, 32.67133333333333, 18.794999999999995, 30.363333333333337, 22.924333333333315, 51.38000000000004, 16.386666666666663, 42.01999999999999, 19.756666666666664, 19.829666666666654, 26.657666666666657, 22.953666666666656, 15.518666666666663, 37.56533333333334, 13.938333333333333, 14.935666666666664, 30.703999999999997, 18.360999999999994, 21.30999999999999, 67.96333333333331, 43.48133333333335, 35.074, 29.321333333333317, 45.477333333333306, 18.915333333333326], "episode_lengths": [65, 47, 43, 28, 37, 53, 113, 43, 30, 54, 52, 40, 50, 41, 71, 104, 36, 42, 86, 49, 44, 44, 45, 42, 50, 50, 51, 92, 54, 52, 72, 68, 39, 93, 71, 31, 50, 64, 58, 77, 30, 33, 54, 43, 68, 117, 38, 43, 42, 89, 33, 52, 112, 73, 32, 110, 76, 53, 57, 88, 51, 52, 61, 43, 70, 69, 72, 53, 98, 66, 52, 54, 43, 78, 75, 53, 79, 45, 68, 48, 87, 39, 82, 53, 44, 66, 44, 32, 57, 30, 29, 59, 36, 47, 117, 69, 72, 76, 101, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5648627117719045, "mean_inference_ms": 2.996413735543267, "mean_action_processing_ms": 0.5991556802693083, "mean_env_wait_ms": 0.1458204797497386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013854026794433594, "StateBufferConnector_ms": 0.009961605072021484, "ViewRequirementAgentConnector_ms": 0.42814207077026367}}, "episode_reward_max": 67.96333333333331, "episode_reward_min": 13.938333333333333, "episode_reward_mean": 27.87492333333333, "episode_len_mean": 58.89, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.389333333333322, 21.58266666666666, 22.18633333333333, 14.385999999999994, 18.461333333333325, 27.188, 60.45733333333335, 21.26199999999999, 15.713666666666663, 25.177999999999994, 24.632333333333325, 17.816999999999993, 21.136999999999993, 20.153999999999993, 37.24866666666666, 59.94966666666669, 20.079333333333327, 16.971666666666657, 49.03633333333331, 20.692999999999994, 19.97133333333333, 20.25933333333333, 18.91699999999999, 20.26933333333332, 23.731666666666666, 21.952999999999992, 20.07799999999999, 37.74099999999999, 19.613999999999994, 23.340666666666664, 40.37899999999999, 38.190333333333335, 19.74766666666666, 25.738333333333326, 37.681333333333335, 14.015, 31.643666666666665, 29.487666666666673, 33.339, 30.097333333333317, 14.838666666666668, 15.057999999999996, 24.032999999999987, 17.688666666666663, 40.80833333333334, 57.55866666666669, 18.68633333333333, 17.600666666666665, 18.464666666666663, 39.264666666666656, 17.933999999999994, 20.01166666666666, 53.766999999999996, 30.207333333333313, 16.82333333333333, 62.2736666666667, 36.59366666666666, 25.322, 23.825333333333326, 41.605666666666664, 22.966, 29.133666666666667, 31.15133333333334, 21.90833333333332, 21.80033333333332, 22.107999999999993, 35.395999999999994, 29.0, 46.39633333333335, 29.339000000000002, 20.12099999999999, 26.462999999999987, 17.610666666666663, 28.946333333333303, 26.709666666666646, 20.054999999999993, 32.67133333333333, 18.794999999999995, 30.363333333333337, 22.924333333333315, 51.38000000000004, 16.386666666666663, 42.01999999999999, 19.756666666666664, 19.829666666666654, 26.657666666666657, 22.953666666666656, 15.518666666666663, 37.56533333333334, 13.938333333333333, 14.935666666666664, 30.703999999999997, 18.360999999999994, 21.30999999999999, 67.96333333333331, 43.48133333333335, 35.074, 29.321333333333317, 45.477333333333306, 18.915333333333326], "episode_lengths": [65, 47, 43, 28, 37, 53, 113, 43, 30, 54, 52, 40, 50, 41, 71, 104, 36, 42, 86, 49, 44, 44, 45, 42, 50, 50, 51, 92, 54, 52, 72, 68, 39, 93, 71, 31, 50, 64, 58, 77, 30, 33, 54, 43, 68, 117, 38, 43, 42, 89, 33, 52, 112, 73, 32, 110, 76, 53, 57, 88, 51, 52, 61, 43, 70, 69, 72, 53, 98, 66, 52, 54, 43, 78, 75, 53, 79, 45, 68, 48, 87, 39, 82, 53, 44, 66, 44, 32, 57, 30, 29, 59, 36, 47, 117, 69, 72, 76, 101, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5648627117719045, "mean_inference_ms": 2.996413735543267, "mean_action_processing_ms": 0.5991556802693083, "mean_env_wait_ms": 0.1458204797497386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013854026794433594, "StateBufferConnector_ms": 0.009961605072021484, "ViewRequirementAgentConnector_ms": 0.42814207077026367}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 590.9177633890355, "num_env_steps_trained_throughput_per_sec": 590.9177633890355, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 7383.67, "sample_time_ms": 3080.16, "load_time_ms": 0.267, "load_throughput": 14960955.948, "learn_time_ms": 4279.108, "learn_throughput": 934.774, "synch_weights_time_ms": 21.885}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 8669, "training_iteration": 118, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-21", "timestamp": 1702018521, "time_this_iter_s": 6.824079513549805, "time_total_s": 22170.873766183853, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22170.873766183853, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 82.58888888888889, "ram_util_percent": 89.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.492809468306092e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 6.091054916381836, "policy_loss": -0.006775106769055128, "vf_loss": 6.097830772399902, "vf_explained_var": 0.5701263546943665, "kl": 0.0014242351753637195, "entropy": 0.07838277518749237, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 110205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": 67.96333333333331, "episode_reward_min": 13.236333333333334, "episode_reward_mean": 29.12381, "episode_len_mean": 62.81, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.15133333333334, 21.90833333333332, 21.80033333333332, 22.107999999999993, 35.395999999999994, 29.0, 46.39633333333335, 29.339000000000002, 20.12099999999999, 26.462999999999987, 17.610666666666663, 28.946333333333303, 26.709666666666646, 20.054999999999993, 32.67133333333333, 18.794999999999995, 30.363333333333337, 22.924333333333315, 51.38000000000004, 16.386666666666663, 42.01999999999999, 19.756666666666664, 19.829666666666654, 26.657666666666657, 22.953666666666656, 15.518666666666663, 37.56533333333334, 13.938333333333333, 14.935666666666664, 30.703999999999997, 18.360999999999994, 21.30999999999999, 67.96333333333331, 43.48133333333335, 35.074, 29.321333333333317, 45.477333333333306, 18.915333333333326, 66.73199999999999, 20.432999999999993, 34.13133333333333, 14.949666666666669, 41.220333333333336, 23.74766666666666, 24.655333333333328, 16.338666666666665, 35.504, 15.437666666666665, 38.57533333333332, 31.821333333333335, 18.849999999999994, 20.62799999999999, 30.61499999999999, 38.42766666666667, 26.192999999999984, 43.80766666666665, 36.03299999999999, 17.00033333333333, 20.033666666666658, 41.942999999999984, 37.389333333333326, 13.236333333333334, 16.685666666666666, 29.53833333333332, 36.705, 15.086999999999996, 35.23733333333334, 25.865000000000002, 47.98533333333336, 27.223666666666674, 22.532666666666646, 18.404, 39.007333333333335, 21.112999999999992, 33.76866666666665, 22.507333333333335, 24.497666666666667, 31.922333333333327, 22.046999999999997, 14.867333333333328, 17.832333333333327, 23.66133333333332, 16.979666666666663, 36.34966666666667, 57.24800000000001, 30.404666666666635, 23.213666666666672, 41.729666666666674, 29.325333333333322, 39.110333333333315, 37.059999999999974, 25.263333333333314, 46.78733333333336, 32.617999999999995, 19.460666666666654, 50.343666666666685, 21.86766666666666, 48.09233333333334, 19.878, 29.14833333333332], "episode_lengths": [61, 43, 70, 69, 72, 53, 98, 66, 52, 54, 43, 78, 75, 53, 79, 45, 68, 48, 87, 39, 82, 53, 44, 66, 44, 32, 57, 30, 29, 59, 36, 47, 117, 69, 72, 76, 101, 45, 135, 44, 69, 30, 72, 53, 49, 33, 67, 30, 64, 65, 38, 39, 74, 80, 54, 88, 85, 36, 52, 101, 92, 26, 42, 68, 88, 30, 82, 44, 95, 56, 67, 41, 84, 57, 90, 58, 56, 56, 44, 38, 38, 67, 37, 60, 113, 86, 40, 75, 67, 91, 98, 63, 88, 67, 44, 92, 55, 102, 42, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5670438063674943, "mean_inference_ms": 2.99902694271463, "mean_action_processing_ms": 0.5988715475811662, "mean_env_wait_ms": 0.14576108671562424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01920604705810547, "StateBufferConnector_ms": 0.008866071701049805, "ViewRequirementAgentConnector_ms": 0.4731578826904297}}, "episode_reward_max": 67.96333333333331, "episode_reward_min": 13.236333333333334, "episode_reward_mean": 29.12381, "episode_len_mean": 62.81, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.15133333333334, 21.90833333333332, 21.80033333333332, 22.107999999999993, 35.395999999999994, 29.0, 46.39633333333335, 29.339000000000002, 20.12099999999999, 26.462999999999987, 17.610666666666663, 28.946333333333303, 26.709666666666646, 20.054999999999993, 32.67133333333333, 18.794999999999995, 30.363333333333337, 22.924333333333315, 51.38000000000004, 16.386666666666663, 42.01999999999999, 19.756666666666664, 19.829666666666654, 26.657666666666657, 22.953666666666656, 15.518666666666663, 37.56533333333334, 13.938333333333333, 14.935666666666664, 30.703999999999997, 18.360999999999994, 21.30999999999999, 67.96333333333331, 43.48133333333335, 35.074, 29.321333333333317, 45.477333333333306, 18.915333333333326, 66.73199999999999, 20.432999999999993, 34.13133333333333, 14.949666666666669, 41.220333333333336, 23.74766666666666, 24.655333333333328, 16.338666666666665, 35.504, 15.437666666666665, 38.57533333333332, 31.821333333333335, 18.849999999999994, 20.62799999999999, 30.61499999999999, 38.42766666666667, 26.192999999999984, 43.80766666666665, 36.03299999999999, 17.00033333333333, 20.033666666666658, 41.942999999999984, 37.389333333333326, 13.236333333333334, 16.685666666666666, 29.53833333333332, 36.705, 15.086999999999996, 35.23733333333334, 25.865000000000002, 47.98533333333336, 27.223666666666674, 22.532666666666646, 18.404, 39.007333333333335, 21.112999999999992, 33.76866666666665, 22.507333333333335, 24.497666666666667, 31.922333333333327, 22.046999999999997, 14.867333333333328, 17.832333333333327, 23.66133333333332, 16.979666666666663, 36.34966666666667, 57.24800000000001, 30.404666666666635, 23.213666666666672, 41.729666666666674, 29.325333333333322, 39.110333333333315, 37.059999999999974, 25.263333333333314, 46.78733333333336, 32.617999999999995, 19.460666666666654, 50.343666666666685, 21.86766666666666, 48.09233333333334, 19.878, 29.14833333333332], "episode_lengths": [61, 43, 70, 69, 72, 53, 98, 66, 52, 54, 43, 78, 75, 53, 79, 45, 68, 48, 87, 39, 82, 53, 44, 66, 44, 32, 57, 30, 29, 59, 36, 47, 117, 69, 72, 76, 101, 45, 135, 44, 69, 30, 72, 53, 49, 33, 67, 30, 64, 65, 38, 39, 74, 80, 54, 88, 85, 36, 52, 101, 92, 26, 42, 68, 88, 30, 82, 44, 95, 56, 67, 41, 84, 57, 90, 58, 56, 56, 44, 38, 38, 67, 37, 60, 113, 86, 40, 75, 67, 91, 98, 63, 88, 67, 44, 92, 55, 102, 42, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5670438063674943, "mean_inference_ms": 2.99902694271463, "mean_action_processing_ms": 0.5988715475811662, "mean_env_wait_ms": 0.14576108671562424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01920604705810547, "StateBufferConnector_ms": 0.008866071701049805, "ViewRequirementAgentConnector_ms": 0.4731578826904297}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.22161357343776, "num_env_steps_trained_throughput_per_sec": 400.22161357343776, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 7733.352, "sample_time_ms": 3183.82, "load_time_ms": 0.367, "load_throughput": 10909172.248, "learn_time_ms": 4524.089, "learn_throughput": 884.156, "synch_weights_time_ms": 22.83}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 8731, "training_iteration": 119, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-31", "timestamp": 1702018531, "time_this_iter_s": 10.021464347839355, "time_total_s": 22180.895230531693, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22180.895230531693, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 88.70000000000002, "ram_util_percent": 91.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.246404734153046e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 5.248651504516602, "policy_loss": -0.007350214757025242, "vf_loss": 5.256001949310303, "vf_explained_var": 0.5895742774009705, "kl": 0.005786029156297445, "entropy": 0.10464617609977722, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 111135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 78.6816666666667, "episode_reward_min": 13.14733333333333, "episode_reward_mean": 27.449996666666657, "episode_len_mean": 58.03, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.76866666666665, 22.507333333333335, 24.497666666666667, 31.922333333333327, 22.046999999999997, 14.867333333333328, 17.832333333333327, 23.66133333333332, 16.979666666666663, 36.34966666666667, 57.24800000000001, 30.404666666666635, 23.213666666666672, 41.729666666666674, 29.325333333333322, 39.110333333333315, 37.059999999999974, 25.263333333333314, 46.78733333333336, 32.617999999999995, 19.460666666666654, 50.343666666666685, 21.86766666666666, 48.09233333333334, 19.878, 29.14833333333332, 35.43333333333333, 15.827999999999998, 22.46366666666666, 18.854333333333322, 13.14733333333333, 16.758333333333336, 20.782666666666664, 23.034666666666663, 15.649666666666661, 17.91833333333333, 32.45766666666667, 18.024666666666665, 29.65233333333333, 22.853333333333328, 30.313666666666656, 25.82866666666666, 17.621666666666663, 18.714333333333325, 15.270333333333328, 22.090333333333326, 14.77366666666666, 16.329333333333334, 38.11966666666665, 24.230333333333306, 16.72133333333333, 33.61966666666667, 31.413999999999984, 17.272666666666666, 18.880666666666666, 78.6816666666667, 19.295666666666662, 19.594, 23.58633333333333, 52.537333333333315, 27.73733333333334, 23.20433333333333, 16.166666666666657, 29.632333333333342, 16.223999999999997, 17.25, 67.40766666666667, 25.011999999999993, 13.572333333333331, 25.621333333333325, 37.68999999999999, 25.145666666666646, 55.682999999999986, 29.834666666666667, 33.064666666666646, 19.233333333333327, 25.208000000000006, 23.716666666666654, 32.97399999999997, 14.638333333333328, 15.675333333333331, 26.622666666666653, 58.1176666666667, 17.673, 18.45833333333333, 15.262333333333334, 16.872999999999994, 48.462666666666685, 52.46599999999997, 16.09366666666666, 31.465333333333323, 17.221999999999994, 36.08433333333334, 42.341333333333345, 14.46133333333333, 42.47299999999997, 16.175333333333327, 15.79433333333333, 14.65066666666666, 35.87299999999999], "episode_lengths": [90, 58, 56, 56, 44, 38, 38, 67, 37, 60, 113, 86, 40, 75, 67, 91, 98, 63, 88, 67, 44, 92, 55, 102, 42, 72, 78, 31, 43, 40, 29, 37, 41, 49, 30, 34, 56, 40, 66, 45, 74, 45, 38, 38, 34, 40, 32, 37, 78, 72, 39, 66, 83, 34, 38, 149, 40, 39, 44, 121, 62, 48, 34, 58, 35, 41, 132, 60, 28, 71, 60, 64, 90, 66, 81, 47, 46, 49, 83, 29, 30, 65, 103, 40, 45, 38, 46, 89, 82, 36, 85, 45, 66, 69, 29, 80, 33, 36, 34, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5680547247988903, "mean_inference_ms": 3.00289493837155, "mean_action_processing_ms": 0.6004982505283836, "mean_env_wait_ms": 0.14595464300245808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018841981887817383, "StateBufferConnector_ms": 0.011299848556518555, "ViewRequirementAgentConnector_ms": 0.5466263294219971}}, "episode_reward_max": 78.6816666666667, "episode_reward_min": 13.14733333333333, "episode_reward_mean": 27.449996666666657, "episode_len_mean": 58.03, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.76866666666665, 22.507333333333335, 24.497666666666667, 31.922333333333327, 22.046999999999997, 14.867333333333328, 17.832333333333327, 23.66133333333332, 16.979666666666663, 36.34966666666667, 57.24800000000001, 30.404666666666635, 23.213666666666672, 41.729666666666674, 29.325333333333322, 39.110333333333315, 37.059999999999974, 25.263333333333314, 46.78733333333336, 32.617999999999995, 19.460666666666654, 50.343666666666685, 21.86766666666666, 48.09233333333334, 19.878, 29.14833333333332, 35.43333333333333, 15.827999999999998, 22.46366666666666, 18.854333333333322, 13.14733333333333, 16.758333333333336, 20.782666666666664, 23.034666666666663, 15.649666666666661, 17.91833333333333, 32.45766666666667, 18.024666666666665, 29.65233333333333, 22.853333333333328, 30.313666666666656, 25.82866666666666, 17.621666666666663, 18.714333333333325, 15.270333333333328, 22.090333333333326, 14.77366666666666, 16.329333333333334, 38.11966666666665, 24.230333333333306, 16.72133333333333, 33.61966666666667, 31.413999999999984, 17.272666666666666, 18.880666666666666, 78.6816666666667, 19.295666666666662, 19.594, 23.58633333333333, 52.537333333333315, 27.73733333333334, 23.20433333333333, 16.166666666666657, 29.632333333333342, 16.223999999999997, 17.25, 67.40766666666667, 25.011999999999993, 13.572333333333331, 25.621333333333325, 37.68999999999999, 25.145666666666646, 55.682999999999986, 29.834666666666667, 33.064666666666646, 19.233333333333327, 25.208000000000006, 23.716666666666654, 32.97399999999997, 14.638333333333328, 15.675333333333331, 26.622666666666653, 58.1176666666667, 17.673, 18.45833333333333, 15.262333333333334, 16.872999999999994, 48.462666666666685, 52.46599999999997, 16.09366666666666, 31.465333333333323, 17.221999999999994, 36.08433333333334, 42.341333333333345, 14.46133333333333, 42.47299999999997, 16.175333333333327, 15.79433333333333, 14.65066666666666, 35.87299999999999], "episode_lengths": [90, 58, 56, 56, 44, 38, 38, 67, 37, 60, 113, 86, 40, 75, 67, 91, 98, 63, 88, 67, 44, 92, 55, 102, 42, 72, 78, 31, 43, 40, 29, 37, 41, 49, 30, 34, 56, 40, 66, 45, 74, 45, 38, 38, 34, 40, 32, 37, 78, 72, 39, 66, 83, 34, 38, 149, 40, 39, 44, 121, 62, 48, 34, 58, 35, 41, 132, 60, 28, 71, 60, 64, 90, 66, 81, 47, 46, 49, 83, 29, 30, 65, 103, 40, 45, 38, 46, 89, 82, 36, 85, 45, 66, 69, 29, 80, 33, 36, 34, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5680547247988903, "mean_inference_ms": 3.00289493837155, "mean_action_processing_ms": 0.6004982505283836, "mean_env_wait_ms": 0.14595464300245808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018841981887817383, "StateBufferConnector_ms": 0.011299848556518555, "ViewRequirementAgentConnector_ms": 0.5466263294219971}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.602644740778, "num_env_steps_trained_throughput_per_sec": 447.602644740778, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 8010.614, "sample_time_ms": 3305.963, "load_time_ms": 0.412, "load_throughput": 9710160.898, "learn_time_ms": 4680.594, "learn_throughput": 854.592, "synch_weights_time_ms": 21.716}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 8805, "training_iteration": 120, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-40", "timestamp": 1702018540, "time_this_iter_s": 8.967498064041138, "time_total_s": 22189.862728595734, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22189.862728595734, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 74.39166666666667, "ram_util_percent": 86.40833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.246404734153046e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 6.093465328216553, "policy_loss": -0.00648511154577136, "vf_loss": 6.099950790405273, "vf_explained_var": 0.5975732803344727, "kl": 0.0012015290558338165, "entropy": 0.08792384713888168, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": 67.40766666666667, "episode_reward_min": 13.51333333333333, "episode_reward_mean": 28.38123333333333, "episode_len_mean": 60.35, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.40766666666667, 25.011999999999993, 13.572333333333331, 25.621333333333325, 37.68999999999999, 25.145666666666646, 55.682999999999986, 29.834666666666667, 33.064666666666646, 19.233333333333327, 25.208000000000006, 23.716666666666654, 32.97399999999997, 14.638333333333328, 15.675333333333331, 26.622666666666653, 58.1176666666667, 17.673, 18.45833333333333, 15.262333333333334, 16.872999999999994, 48.462666666666685, 52.46599999999997, 16.09366666666666, 31.465333333333323, 17.221999999999994, 36.08433333333334, 42.341333333333345, 14.46133333333333, 42.47299999999997, 16.175333333333327, 15.79433333333333, 14.65066666666666, 35.87299999999999, 13.568666666666665, 16.522, 40.899333333333296, 21.089999999999982, 28.073333333333334, 33.33533333333332, 13.51333333333333, 25.90733333333333, 35.897, 36.15933333333329, 31.771999999999963, 34.401333333333326, 29.254, 14.662333333333327, 29.704333333333313, 36.727, 17.486333333333324, 19.092999999999993, 26.03366666666665, 26.89733333333333, 24.371, 37.497333333333344, 21.177666666666664, 16.102999999999994, 35.40633333333336, 27.14499999999999, 23.087666666666667, 19.261666666666663, 24.832999999999995, 31.135666666666683, 20.403333333333325, 22.95533333333333, 40.346666666666685, 36.300999999999995, 29.353666666666676, 15.094999999999992, 20.773666666666667, 33.669, 51.09666666666665, 25.888333333333332, 21.17933333333332, 38.52366666666667, 25.171999999999993, 24.20099999999999, 32.70833333333333, 32.22599999999997, 27.676333333333336, 17.958, 19.495666666666658, 18.217333333333325, 52.015666666666675, 33.41999999999999, 47.17700000000001, 40.70333333333333, 34.7563333333333, 17.569999999999997, 31.174666666666653, 22.37999999999999, 25.610999999999983, 39.691333333333304, 25.18366666666667, 38.68699999999998, 21.830333333333325, 23.35233333333333, 28.11833333333333, 31.149666666666658], "episode_lengths": [132, 60, 28, 71, 60, 64, 90, 66, 81, 47, 46, 49, 83, 29, 30, 65, 103, 40, 45, 38, 46, 89, 82, 36, 85, 45, 66, 69, 29, 80, 33, 36, 34, 69, 27, 37, 120, 63, 49, 65, 27, 52, 56, 89, 95, 77, 56, 29, 51, 78, 36, 40, 60, 71, 50, 69, 40, 33, 79, 54, 44, 40, 51, 70, 59, 44, 77, 70, 64, 33, 47, 59, 128, 51, 58, 76, 49, 48, 55, 93, 47, 39, 45, 43, 99, 77, 86, 85, 100, 34, 67, 59, 66, 86, 51, 79, 38, 52, 69, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.568104286251285, "mean_inference_ms": 3.002795779567836, "mean_action_processing_ms": 0.5995203781492117, "mean_env_wait_ms": 0.14578300769089408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02315378189086914, "StateBufferConnector_ms": 0.013559818267822266, "ViewRequirementAgentConnector_ms": 0.5252268314361572}}, "episode_reward_max": 67.40766666666667, "episode_reward_min": 13.51333333333333, "episode_reward_mean": 28.38123333333333, "episode_len_mean": 60.35, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.40766666666667, 25.011999999999993, 13.572333333333331, 25.621333333333325, 37.68999999999999, 25.145666666666646, 55.682999999999986, 29.834666666666667, 33.064666666666646, 19.233333333333327, 25.208000000000006, 23.716666666666654, 32.97399999999997, 14.638333333333328, 15.675333333333331, 26.622666666666653, 58.1176666666667, 17.673, 18.45833333333333, 15.262333333333334, 16.872999999999994, 48.462666666666685, 52.46599999999997, 16.09366666666666, 31.465333333333323, 17.221999999999994, 36.08433333333334, 42.341333333333345, 14.46133333333333, 42.47299999999997, 16.175333333333327, 15.79433333333333, 14.65066666666666, 35.87299999999999, 13.568666666666665, 16.522, 40.899333333333296, 21.089999999999982, 28.073333333333334, 33.33533333333332, 13.51333333333333, 25.90733333333333, 35.897, 36.15933333333329, 31.771999999999963, 34.401333333333326, 29.254, 14.662333333333327, 29.704333333333313, 36.727, 17.486333333333324, 19.092999999999993, 26.03366666666665, 26.89733333333333, 24.371, 37.497333333333344, 21.177666666666664, 16.102999999999994, 35.40633333333336, 27.14499999999999, 23.087666666666667, 19.261666666666663, 24.832999999999995, 31.135666666666683, 20.403333333333325, 22.95533333333333, 40.346666666666685, 36.300999999999995, 29.353666666666676, 15.094999999999992, 20.773666666666667, 33.669, 51.09666666666665, 25.888333333333332, 21.17933333333332, 38.52366666666667, 25.171999999999993, 24.20099999999999, 32.70833333333333, 32.22599999999997, 27.676333333333336, 17.958, 19.495666666666658, 18.217333333333325, 52.015666666666675, 33.41999999999999, 47.17700000000001, 40.70333333333333, 34.7563333333333, 17.569999999999997, 31.174666666666653, 22.37999999999999, 25.610999999999983, 39.691333333333304, 25.18366666666667, 38.68699999999998, 21.830333333333325, 23.35233333333333, 28.11833333333333, 31.149666666666658], "episode_lengths": [132, 60, 28, 71, 60, 64, 90, 66, 81, 47, 46, 49, 83, 29, 30, 65, 103, 40, 45, 38, 46, 89, 82, 36, 85, 45, 66, 69, 29, 80, 33, 36, 34, 69, 27, 37, 120, 63, 49, 65, 27, 52, 56, 89, 95, 77, 56, 29, 51, 78, 36, 40, 60, 71, 50, 69, 40, 33, 79, 54, 44, 40, 51, 70, 59, 44, 77, 70, 64, 33, 47, 59, 128, 51, 58, 76, 49, 48, 55, 93, 47, 39, 45, 43, 99, 77, 86, 85, 100, 34, 67, 59, 66, 86, 51, 79, 38, 52, 69, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.568104286251285, "mean_inference_ms": 3.002795779567836, "mean_action_processing_ms": 0.5995203781492117, "mean_env_wait_ms": 0.14578300769089408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02315378189086914, "StateBufferConnector_ms": 0.013559818267822266, "ViewRequirementAgentConnector_ms": 0.5252268314361572}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.42989199922187, "num_env_steps_trained_throughput_per_sec": 487.42989199922187, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 7843.901, "sample_time_ms": 3172.04, "load_time_ms": 0.333, "load_throughput": 11997437.071, "learn_time_ms": 4647.264, "learn_throughput": 860.722, "synch_weights_time_ms": 22.307}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 8871, "training_iteration": 121, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-48", "timestamp": 1702018548, "time_this_iter_s": 8.23100233078003, "time_total_s": 22198.093730926514, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22198.093730926514, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 76.1, "ram_util_percent": 89.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.123202367076523e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 5.36830997467041, "policy_loss": -0.011580219492316246, "vf_loss": 5.379889488220215, "vf_explained_var": 0.5959345102310181, "kl": 0.00288273673504591, "entropy": 0.08785431832075119, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": 63.61066666666668, "episode_reward_min": 13.681, "episode_reward_mean": 27.548363333333327, "episode_len_mean": 58.73, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.094999999999992, 20.773666666666667, 33.669, 51.09666666666665, 25.888333333333332, 21.17933333333332, 38.52366666666667, 25.171999999999993, 24.20099999999999, 32.70833333333333, 32.22599999999997, 27.676333333333336, 17.958, 19.495666666666658, 18.217333333333325, 52.015666666666675, 33.41999999999999, 47.17700000000001, 40.70333333333333, 34.7563333333333, 17.569999999999997, 31.174666666666653, 22.37999999999999, 25.610999999999983, 39.691333333333304, 25.18366666666667, 38.68699999999998, 21.830333333333325, 23.35233333333333, 28.11833333333333, 31.149666666666658, 24.543333333333337, 26.470333333333336, 32.43633333333332, 18.349666666666664, 28.524666666666675, 17.88333333333333, 19.572333333333326, 16.990666666666662, 46.33133333333332, 41.067333333333345, 22.60233333333332, 16.91266666666666, 35.18766666666665, 24.388666666666655, 16.777999999999995, 31.480666666666657, 20.927333333333326, 17.75699999999999, 19.577999999999996, 19.694666666666674, 27.111999999999984, 14.476999999999995, 18.95766666666666, 23.887, 22.229666666666656, 39.46566666666667, 22.474333333333323, 34.714666666666666, 48.31700000000002, 26.658999999999995, 14.209999999999997, 20.148999999999997, 20.429666666666666, 24.099999999999994, 15.281666666666665, 25.451666666666647, 37.02933333333331, 46.14599999999997, 20.256999999999998, 36.13233333333333, 17.820999999999994, 63.61066666666668, 13.681, 35.518999999999984, 23.587999999999997, 18.425333333333327, 31.930666666666653, 34.61999999999999, 30.537666666666656, 18.68233333333333, 30.201333333333302, 17.32033333333333, 32.35099999999999, 20.054999999999993, 21.004, 14.765333333333334, 15.51566666666666, 36.30033333333333, 41.472666666666655, 16.96666666666666, 47.21166666666665, 34.63099999999998, 31.702666666666644, 28.11466666666666, 19.268666666666658, 43.596000000000025, 23.287999999999986, 24.19466666666667, 16.80299999999999], "episode_lengths": [33, 47, 59, 128, 51, 58, 76, 49, 48, 55, 93, 47, 39, 45, 43, 99, 77, 86, 85, 100, 34, 67, 59, 66, 86, 51, 79, 38, 52, 69, 68, 53, 45, 68, 44, 59, 33, 44, 37, 89, 90, 57, 35, 87, 60, 40, 56, 41, 42, 47, 43, 65, 30, 42, 40, 60, 65, 52, 79, 86, 58, 29, 53, 38, 54, 32, 74, 67, 97, 42, 68, 38, 98, 28, 71, 60, 39, 61, 82, 77, 37, 80, 45, 68, 54, 43, 29, 30, 64, 77, 33, 111, 70, 80, 53, 44, 73, 57, 49, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5663624845955724, "mean_inference_ms": 2.999022020488974, "mean_action_processing_ms": 0.599313409570928, "mean_env_wait_ms": 0.14565617554164526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018247604370117188, "StateBufferConnector_ms": 0.019475698471069336, "ViewRequirementAgentConnector_ms": 0.46007585525512695}}, "episode_reward_max": 63.61066666666668, "episode_reward_min": 13.681, "episode_reward_mean": 27.548363333333327, "episode_len_mean": 58.73, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.094999999999992, 20.773666666666667, 33.669, 51.09666666666665, 25.888333333333332, 21.17933333333332, 38.52366666666667, 25.171999999999993, 24.20099999999999, 32.70833333333333, 32.22599999999997, 27.676333333333336, 17.958, 19.495666666666658, 18.217333333333325, 52.015666666666675, 33.41999999999999, 47.17700000000001, 40.70333333333333, 34.7563333333333, 17.569999999999997, 31.174666666666653, 22.37999999999999, 25.610999999999983, 39.691333333333304, 25.18366666666667, 38.68699999999998, 21.830333333333325, 23.35233333333333, 28.11833333333333, 31.149666666666658, 24.543333333333337, 26.470333333333336, 32.43633333333332, 18.349666666666664, 28.524666666666675, 17.88333333333333, 19.572333333333326, 16.990666666666662, 46.33133333333332, 41.067333333333345, 22.60233333333332, 16.91266666666666, 35.18766666666665, 24.388666666666655, 16.777999999999995, 31.480666666666657, 20.927333333333326, 17.75699999999999, 19.577999999999996, 19.694666666666674, 27.111999999999984, 14.476999999999995, 18.95766666666666, 23.887, 22.229666666666656, 39.46566666666667, 22.474333333333323, 34.714666666666666, 48.31700000000002, 26.658999999999995, 14.209999999999997, 20.148999999999997, 20.429666666666666, 24.099999999999994, 15.281666666666665, 25.451666666666647, 37.02933333333331, 46.14599999999997, 20.256999999999998, 36.13233333333333, 17.820999999999994, 63.61066666666668, 13.681, 35.518999999999984, 23.587999999999997, 18.425333333333327, 31.930666666666653, 34.61999999999999, 30.537666666666656, 18.68233333333333, 30.201333333333302, 17.32033333333333, 32.35099999999999, 20.054999999999993, 21.004, 14.765333333333334, 15.51566666666666, 36.30033333333333, 41.472666666666655, 16.96666666666666, 47.21166666666665, 34.63099999999998, 31.702666666666644, 28.11466666666666, 19.268666666666658, 43.596000000000025, 23.287999999999986, 24.19466666666667, 16.80299999999999], "episode_lengths": [33, 47, 59, 128, 51, 58, 76, 49, 48, 55, 93, 47, 39, 45, 43, 99, 77, 86, 85, 100, 34, 67, 59, 66, 86, 51, 79, 38, 52, 69, 68, 53, 45, 68, 44, 59, 33, 44, 37, 89, 90, 57, 35, 87, 60, 40, 56, 41, 42, 47, 43, 65, 30, 42, 40, 60, 65, 52, 79, 86, 58, 29, 53, 38, 54, 32, 74, 67, 97, 42, 68, 38, 98, 28, 71, 60, 39, 61, 82, 77, 37, 80, 45, 68, 54, 43, 29, 30, 64, 77, 33, 111, 70, 80, 53, 44, 73, 57, 49, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5663624845955724, "mean_inference_ms": 2.999022020488974, "mean_action_processing_ms": 0.599313409570928, "mean_env_wait_ms": 0.14565617554164526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018247604370117188, "StateBufferConnector_ms": 0.019475698471069336, "ViewRequirementAgentConnector_ms": 0.46007585525512695}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.14012503866843, "num_env_steps_trained_throughput_per_sec": 487.14012503866843, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 7687.879, "sample_time_ms": 3068.411, "load_time_ms": 0.333, "load_throughput": 11997437.071, "learn_time_ms": 4595.37, "learn_throughput": 870.441, "synch_weights_time_ms": 21.721}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 8940, "training_iteration": 122, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-55-57", "timestamp": 1702018557, "time_this_iter_s": 8.230185985565186, "time_total_s": 22206.32391691208, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22206.32391691208, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 74.93636363636364, "ram_util_percent": 88.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.616011835382615e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 6.030816555023193, "policy_loss": -0.005858534015715122, "vf_loss": 6.036675930023193, "vf_explained_var": 0.5263656377792358, "kl": 0.0023646350018680096, "entropy": 0.09772206097841263, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 113925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 102.97666666666673, "episode_reward_min": 13.681, "episode_reward_mean": 28.60554999999999, "episode_len_mean": 58.79, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.13233333333333, 17.820999999999994, 63.61066666666668, 13.681, 35.518999999999984, 23.587999999999997, 18.425333333333327, 31.930666666666653, 34.61999999999999, 30.537666666666656, 18.68233333333333, 30.201333333333302, 17.32033333333333, 32.35099999999999, 20.054999999999993, 21.004, 14.765333333333334, 15.51566666666666, 36.30033333333333, 41.472666666666655, 16.96666666666666, 47.21166666666665, 34.63099999999998, 31.702666666666644, 28.11466666666666, 19.268666666666658, 43.596000000000025, 23.287999999999986, 24.19466666666667, 16.80299999999999, 58.163666666666636, 20.141999999999992, 51.156999999999975, 27.50099999999998, 16.047, 20.61533333333332, 39.47566666666666, 14.755333333333333, 25.39266666666666, 37.68400000000001, 17.801666666666662, 17.56799999999999, 17.944, 24.378999999999987, 29.71266666666665, 31.713333333333328, 15.922333333333329, 17.521999999999995, 32.92599999999999, 18.564999999999994, 41.433666666666674, 20.98966666666665, 14.187666666666665, 21.778999999999996, 34.44033333333331, 19.856333333333325, 19.494666666666664, 41.52699999999999, 31.50366666666666, 25.54699999999999, 26.643999999999988, 21.39033333333333, 15.44299999999999, 28.88266666666666, 46.214666666666695, 65.41333333333328, 25.349333333333327, 61.47666666666666, 20.08899999999999, 22.403666666666663, 102.97666666666673, 17.256999999999998, 38.81133333333334, 32.475333333333346, 13.959333333333324, 23.345999999999997, 22.912333333333336, 22.204999999999988, 18.647333333333332, 27.175333333333324, 21.630333333333333, 36.695, 31.46233333333333, 49.36499999999999, 19.148000000000003, 32.99066666666665, 20.995666666666658, 29.41033333333333, 35.62966666666665, 18.250999999999987, 42.23866666666665, 26.755666666666652, 19.572666666666663, 28.81566666666666, 15.82433333333333, 38.318999999999996, 18.691666666666656, 23.824999999999992, 27.048333333333336, 25.756333333333327], "episode_lengths": [68, 38, 98, 28, 71, 60, 39, 61, 82, 77, 37, 80, 45, 68, 54, 43, 29, 30, 64, 77, 33, 111, 70, 80, 53, 44, 73, 57, 49, 34, 102, 36, 78, 60, 37, 47, 68, 30, 49, 67, 37, 36, 42, 68, 74, 62, 44, 39, 71, 39, 68, 54, 28, 42, 96, 44, 45, 65, 60, 45, 49, 40, 35, 65, 79, 127, 57, 117, 38, 41, 183, 38, 84, 63, 37, 48, 49, 59, 34, 64, 52, 72, 58, 99, 34, 71, 53, 56, 88, 46, 85, 75, 37, 58, 34, 68, 36, 58, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5640745018951479, "mean_inference_ms": 2.9936010971049645, "mean_action_processing_ms": 0.5985730655812108, "mean_env_wait_ms": 0.14555717579335256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0173189640045166, "StateBufferConnector_ms": 0.017037630081176758, "ViewRequirementAgentConnector_ms": 0.4000227451324463}}, "episode_reward_max": 102.97666666666673, "episode_reward_min": 13.681, "episode_reward_mean": 28.60554999999999, "episode_len_mean": 58.79, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.13233333333333, 17.820999999999994, 63.61066666666668, 13.681, 35.518999999999984, 23.587999999999997, 18.425333333333327, 31.930666666666653, 34.61999999999999, 30.537666666666656, 18.68233333333333, 30.201333333333302, 17.32033333333333, 32.35099999999999, 20.054999999999993, 21.004, 14.765333333333334, 15.51566666666666, 36.30033333333333, 41.472666666666655, 16.96666666666666, 47.21166666666665, 34.63099999999998, 31.702666666666644, 28.11466666666666, 19.268666666666658, 43.596000000000025, 23.287999999999986, 24.19466666666667, 16.80299999999999, 58.163666666666636, 20.141999999999992, 51.156999999999975, 27.50099999999998, 16.047, 20.61533333333332, 39.47566666666666, 14.755333333333333, 25.39266666666666, 37.68400000000001, 17.801666666666662, 17.56799999999999, 17.944, 24.378999999999987, 29.71266666666665, 31.713333333333328, 15.922333333333329, 17.521999999999995, 32.92599999999999, 18.564999999999994, 41.433666666666674, 20.98966666666665, 14.187666666666665, 21.778999999999996, 34.44033333333331, 19.856333333333325, 19.494666666666664, 41.52699999999999, 31.50366666666666, 25.54699999999999, 26.643999999999988, 21.39033333333333, 15.44299999999999, 28.88266666666666, 46.214666666666695, 65.41333333333328, 25.349333333333327, 61.47666666666666, 20.08899999999999, 22.403666666666663, 102.97666666666673, 17.256999999999998, 38.81133333333334, 32.475333333333346, 13.959333333333324, 23.345999999999997, 22.912333333333336, 22.204999999999988, 18.647333333333332, 27.175333333333324, 21.630333333333333, 36.695, 31.46233333333333, 49.36499999999999, 19.148000000000003, 32.99066666666665, 20.995666666666658, 29.41033333333333, 35.62966666666665, 18.250999999999987, 42.23866666666665, 26.755666666666652, 19.572666666666663, 28.81566666666666, 15.82433333333333, 38.318999999999996, 18.691666666666656, 23.824999999999992, 27.048333333333336, 25.756333333333327], "episode_lengths": [68, 38, 98, 28, 71, 60, 39, 61, 82, 77, 37, 80, 45, 68, 54, 43, 29, 30, 64, 77, 33, 111, 70, 80, 53, 44, 73, 57, 49, 34, 102, 36, 78, 60, 37, 47, 68, 30, 49, 67, 37, 36, 42, 68, 74, 62, 44, 39, 71, 39, 68, 54, 28, 42, 96, 44, 45, 65, 60, 45, 49, 40, 35, 65, 79, 127, 57, 117, 38, 41, 183, 38, 84, 63, 37, 48, 49, 59, 34, 64, 52, 72, 58, 99, 34, 71, 53, 56, 88, 46, 85, 75, 37, 58, 34, 68, 36, 58, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5640745018951479, "mean_inference_ms": 2.9936010971049645, "mean_action_processing_ms": 0.5985730655812108, "mean_env_wait_ms": 0.14555717579335256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0173189640045166, "StateBufferConnector_ms": 0.017037630081176758, "ViewRequirementAgentConnector_ms": 0.4000227451324463}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.9040412068155, "num_env_steps_trained_throughput_per_sec": 471.9040412068155, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 7663.197, "sample_time_ms": 2833.021, "load_time_ms": 0.233, "load_throughput": 17140596.649, "learn_time_ms": 4807.077, "learn_throughput": 832.107, "synch_weights_time_ms": 20.887}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 9010, "training_iteration": 123, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-56-05", "timestamp": 1702018565, "time_this_iter_s": 8.492830991744995, "time_total_s": 22214.816747903824, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22214.816747903824, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 76.18333333333332, "ram_util_percent": 88.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.8080059176913074e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 5.409426689147949, "policy_loss": -0.004246185068041086, "vf_loss": 5.413671970367432, "vf_explained_var": 0.6278334259986877, "kl": 0.007234085351228714, "entropy": 0.11081226170063019, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 114855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": 55.03933333333333, "episode_reward_min": 12.875333333333332, "episode_reward_mean": 26.534709999999997, "episode_len_mean": 56.89, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.256999999999998, 38.81133333333334, 32.475333333333346, 13.959333333333324, 23.345999999999997, 22.912333333333336, 22.204999999999988, 18.647333333333332, 27.175333333333324, 21.630333333333333, 36.695, 31.46233333333333, 49.36499999999999, 19.148000000000003, 32.99066666666665, 20.995666666666658, 29.41033333333333, 35.62966666666665, 18.250999999999987, 42.23866666666665, 26.755666666666652, 19.572666666666663, 28.81566666666666, 15.82433333333333, 38.318999999999996, 18.691666666666656, 23.824999999999992, 27.048333333333336, 25.756333333333327, 32.850333333333325, 47.53033333333331, 37.74966666666663, 16.813, 19.744333333333326, 16.718333333333334, 15.445, 27.241666666666656, 51.55466666666671, 24.269000000000013, 15.45066666666666, 21.250333333333323, 31.65966666666666, 15.613666666666663, 24.12566666666666, 17.872333333333327, 22.480666666666664, 55.03933333333333, 47.096333333333334, 25.721333333333323, 20.040666666666656, 34.66766666666664, 27.517999999999994, 35.51966666666665, 18.72966666666667, 48.347, 15.896666666666661, 28.102666666666654, 37.09066666666667, 33.64933333333334, 13.483666666666664, 27.91566666666665, 38.741333333333344, 27.503333333333323, 28.170999999999996, 48.019, 19.09933333333333, 15.058333333333335, 25.244000000000003, 25.275999999999986, 16.69033333333333, 36.686999999999955, 24.13966666666666, 18.820999999999994, 30.968333333333323, 14.175666666666668, 14.337666666666664, 12.875333333333332, 20.77066666666666, 28.86533333333332, 15.816999999999997, 23.600000000000012, 26.610666666666663, 31.00966666666665, 15.593, 19.992333333333324, 48.90033333333339, 20.656999999999996, 33.01866666666668, 25.49333333333332, 15.75433333333333, 22.21299999999999, 18.231666666666666, 22.197333333333326, 22.504666666666665, 28.08633333333333, 19.45099999999999, 21.04399999999999, 22.018666666666647, 16.013666666666662, 53.41900000000002], "episode_lengths": [38, 84, 63, 37, 48, 49, 59, 34, 64, 52, 72, 58, 99, 34, 71, 53, 56, 88, 46, 85, 75, 37, 58, 34, 68, 36, 58, 55, 51, 75, 86, 61, 39, 39, 32, 34, 59, 103, 48, 33, 69, 76, 30, 46, 37, 60, 131, 87, 59, 39, 104, 65, 72, 42, 75, 32, 81, 98, 71, 27, 84, 59, 55, 49, 109, 41, 32, 51, 77, 40, 98, 47, 43, 61, 28, 29, 27, 45, 50, 33, 46, 68, 72, 30, 45, 100, 45, 65, 51, 30, 45, 33, 43, 45, 50, 51, 53, 63, 35, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5625309139713588, "mean_inference_ms": 2.9899785703961697, "mean_action_processing_ms": 0.5979237323601132, "mean_env_wait_ms": 0.14557634608028996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01886892318725586, "StateBufferConnector_ms": 0.014518022537231445, "ViewRequirementAgentConnector_ms": 0.39055442810058594}}, "episode_reward_max": 55.03933333333333, "episode_reward_min": 12.875333333333332, "episode_reward_mean": 26.534709999999997, "episode_len_mean": 56.89, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.256999999999998, 38.81133333333334, 32.475333333333346, 13.959333333333324, 23.345999999999997, 22.912333333333336, 22.204999999999988, 18.647333333333332, 27.175333333333324, 21.630333333333333, 36.695, 31.46233333333333, 49.36499999999999, 19.148000000000003, 32.99066666666665, 20.995666666666658, 29.41033333333333, 35.62966666666665, 18.250999999999987, 42.23866666666665, 26.755666666666652, 19.572666666666663, 28.81566666666666, 15.82433333333333, 38.318999999999996, 18.691666666666656, 23.824999999999992, 27.048333333333336, 25.756333333333327, 32.850333333333325, 47.53033333333331, 37.74966666666663, 16.813, 19.744333333333326, 16.718333333333334, 15.445, 27.241666666666656, 51.55466666666671, 24.269000000000013, 15.45066666666666, 21.250333333333323, 31.65966666666666, 15.613666666666663, 24.12566666666666, 17.872333333333327, 22.480666666666664, 55.03933333333333, 47.096333333333334, 25.721333333333323, 20.040666666666656, 34.66766666666664, 27.517999999999994, 35.51966666666665, 18.72966666666667, 48.347, 15.896666666666661, 28.102666666666654, 37.09066666666667, 33.64933333333334, 13.483666666666664, 27.91566666666665, 38.741333333333344, 27.503333333333323, 28.170999999999996, 48.019, 19.09933333333333, 15.058333333333335, 25.244000000000003, 25.275999999999986, 16.69033333333333, 36.686999999999955, 24.13966666666666, 18.820999999999994, 30.968333333333323, 14.175666666666668, 14.337666666666664, 12.875333333333332, 20.77066666666666, 28.86533333333332, 15.816999999999997, 23.600000000000012, 26.610666666666663, 31.00966666666665, 15.593, 19.992333333333324, 48.90033333333339, 20.656999999999996, 33.01866666666668, 25.49333333333332, 15.75433333333333, 22.21299999999999, 18.231666666666666, 22.197333333333326, 22.504666666666665, 28.08633333333333, 19.45099999999999, 21.04399999999999, 22.018666666666647, 16.013666666666662, 53.41900000000002], "episode_lengths": [38, 84, 63, 37, 48, 49, 59, 34, 64, 52, 72, 58, 99, 34, 71, 53, 56, 88, 46, 85, 75, 37, 58, 34, 68, 36, 58, 55, 51, 75, 86, 61, 39, 39, 32, 34, 59, 103, 48, 33, 69, 76, 30, 46, 37, 60, 131, 87, 59, 39, 104, 65, 72, 42, 75, 32, 81, 98, 71, 27, 84, 59, 55, 49, 109, 41, 32, 51, 77, 40, 98, 47, 43, 61, 28, 29, 27, 45, 50, 33, 46, 68, 72, 30, 45, 100, 45, 65, 51, 30, 45, 33, 43, 45, 50, 51, 53, 63, 35, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5625309139713588, "mean_inference_ms": 2.9899785703961697, "mean_action_processing_ms": 0.5979237323601132, "mean_env_wait_ms": 0.14557634608028996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01886892318725586, "StateBufferConnector_ms": 0.014518022537231445, "ViewRequirementAgentConnector_ms": 0.39055442810058594}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.20482167055644, "num_env_steps_trained_throughput_per_sec": 442.20482167055644, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 7902.129, "sample_time_ms": 2835.352, "load_time_ms": 0.333, "load_throughput": 12004304.522, "learn_time_ms": 5042.181, "learn_throughput": 793.308, "synch_weights_time_ms": 22.285}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 9081, "training_iteration": 124, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-56-14", "timestamp": 1702018574, "time_this_iter_s": 9.087580919265747, "time_total_s": 22223.90432882309, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22223.90432882309, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 70.93846153846154, "ram_util_percent": 87.90769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.8080059176913074e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 5.057035446166992, "policy_loss": -0.004217067267745733, "vf_loss": 5.061252117156982, "vf_explained_var": 0.5978966355323792, "kl": 0.002480545314028859, "entropy": 0.09173533320426941, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 115785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": 62.20700000000006, "episode_reward_min": 12.875333333333332, "episode_reward_mean": 25.249283333333334, "episode_len_mean": 55.58, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.275999999999986, 16.69033333333333, 36.686999999999955, 24.13966666666666, 18.820999999999994, 30.968333333333323, 14.175666666666668, 14.337666666666664, 12.875333333333332, 20.77066666666666, 28.86533333333332, 15.816999999999997, 23.600000000000012, 26.610666666666663, 31.00966666666665, 15.593, 19.992333333333324, 48.90033333333339, 20.656999999999996, 33.01866666666668, 25.49333333333332, 15.75433333333333, 22.21299999999999, 18.231666666666666, 22.197333333333326, 22.504666666666665, 28.08633333333333, 19.45099999999999, 21.04399999999999, 22.018666666666647, 16.013666666666662, 53.41900000000002, 20.90266666666667, 18.549999999999997, 27.66666666666665, 24.926666666666655, 30.21666666666668, 38.4383333333333, 21.01966666666666, 13.78233333333333, 18.12166666666667, 27.418666666666663, 30.464666666666634, 19.22333333333333, 17.167333333333325, 29.10833333333333, 46.748666666666665, 41.38066666666666, 24.51866666666666, 18.57866666666666, 41.73533333333331, 25.09833333333333, 17.908666666666665, 19.251333333333335, 17.02633333333333, 28.500999999999994, 39.481666666666676, 26.156, 34.395666666666656, 36.441666666666634, 17.435333333333325, 26.533, 15.751999999999997, 27.928999999999995, 20.856333333333325, 50.933999999999976, 18.264333333333322, 19.25033333333333, 14.405333333333333, 22.016666666666655, 36.03533333333332, 24.050333333333327, 34.526333333333326, 14.29733333333333, 17.475666666666662, 20.038999999999998, 35.12533333333333, 14.496333333333332, 62.20700000000006, 17.83233333333333, 51.349999999999966, 30.05366666666667, 30.00699999999998, 22.613999999999994, 37.430000000000014, 18.057333333333332, 19.524333333333335, 15.669, 24.87966666666666, 17.41333333333333, 19.11099999999999, 17.510333333333325, 17.543666666666663, 15.829999999999998, 25.43266666666667, 44.474999999999966, 27.39066666666666, 28.620666666666654, 17.11133333333333, 15.981], "episode_lengths": [77, 40, 98, 47, 43, 61, 28, 29, 27, 45, 50, 33, 46, 68, 72, 30, 45, 100, 45, 65, 51, 30, 45, 33, 43, 45, 50, 51, 53, 63, 35, 89, 42, 46, 83, 47, 80, 101, 60, 29, 33, 67, 97, 43, 48, 47, 108, 83, 56, 47, 78, 62, 35, 41, 37, 71, 73, 51, 81, 98, 38, 52, 35, 60, 50, 83, 54, 49, 28, 46, 83, 56, 58, 31, 44, 45, 65, 29, 111, 34, 117, 80, 88, 60, 79, 33, 42, 35, 49, 44, 41, 37, 36, 32, 46, 106, 60, 71, 33, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5616514644052877, "mean_inference_ms": 2.987139760179636, "mean_action_processing_ms": 0.5975608622687406, "mean_env_wait_ms": 0.14558366071163759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02840137481689453, "StateBufferConnector_ms": 0.017268896102905273, "ViewRequirementAgentConnector_ms": 0.44229793548583984}}, "episode_reward_max": 62.20700000000006, "episode_reward_min": 12.875333333333332, "episode_reward_mean": 25.249283333333334, "episode_len_mean": 55.58, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.275999999999986, 16.69033333333333, 36.686999999999955, 24.13966666666666, 18.820999999999994, 30.968333333333323, 14.175666666666668, 14.337666666666664, 12.875333333333332, 20.77066666666666, 28.86533333333332, 15.816999999999997, 23.600000000000012, 26.610666666666663, 31.00966666666665, 15.593, 19.992333333333324, 48.90033333333339, 20.656999999999996, 33.01866666666668, 25.49333333333332, 15.75433333333333, 22.21299999999999, 18.231666666666666, 22.197333333333326, 22.504666666666665, 28.08633333333333, 19.45099999999999, 21.04399999999999, 22.018666666666647, 16.013666666666662, 53.41900000000002, 20.90266666666667, 18.549999999999997, 27.66666666666665, 24.926666666666655, 30.21666666666668, 38.4383333333333, 21.01966666666666, 13.78233333333333, 18.12166666666667, 27.418666666666663, 30.464666666666634, 19.22333333333333, 17.167333333333325, 29.10833333333333, 46.748666666666665, 41.38066666666666, 24.51866666666666, 18.57866666666666, 41.73533333333331, 25.09833333333333, 17.908666666666665, 19.251333333333335, 17.02633333333333, 28.500999999999994, 39.481666666666676, 26.156, 34.395666666666656, 36.441666666666634, 17.435333333333325, 26.533, 15.751999999999997, 27.928999999999995, 20.856333333333325, 50.933999999999976, 18.264333333333322, 19.25033333333333, 14.405333333333333, 22.016666666666655, 36.03533333333332, 24.050333333333327, 34.526333333333326, 14.29733333333333, 17.475666666666662, 20.038999999999998, 35.12533333333333, 14.496333333333332, 62.20700000000006, 17.83233333333333, 51.349999999999966, 30.05366666666667, 30.00699999999998, 22.613999999999994, 37.430000000000014, 18.057333333333332, 19.524333333333335, 15.669, 24.87966666666666, 17.41333333333333, 19.11099999999999, 17.510333333333325, 17.543666666666663, 15.829999999999998, 25.43266666666667, 44.474999999999966, 27.39066666666666, 28.620666666666654, 17.11133333333333, 15.981], "episode_lengths": [77, 40, 98, 47, 43, 61, 28, 29, 27, 45, 50, 33, 46, 68, 72, 30, 45, 100, 45, 65, 51, 30, 45, 33, 43, 45, 50, 51, 53, 63, 35, 89, 42, 46, 83, 47, 80, 101, 60, 29, 33, 67, 97, 43, 48, 47, 108, 83, 56, 47, 78, 62, 35, 41, 37, 71, 73, 51, 81, 98, 38, 52, 35, 60, 50, 83, 54, 49, 28, 46, 83, 56, 58, 31, 44, 45, 65, 29, 111, 34, 117, 80, 88, 60, 79, 33, 42, 35, 49, 44, 41, 37, 36, 32, 46, 106, 60, 71, 33, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5616514644052877, "mean_inference_ms": 2.987139760179636, "mean_action_processing_ms": 0.5975608622687406, "mean_env_wait_ms": 0.14558366071163759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02840137481689453, "StateBufferConnector_ms": 0.017268896102905273, "ViewRequirementAgentConnector_ms": 0.44229793548583984}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.7786301764687, "num_env_steps_trained_throughput_per_sec": 464.7786301764687, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 8101.655, "sample_time_ms": 2849.644, "load_time_ms": 0.366, "load_throughput": 10934056.309, "learn_time_ms": 5226.455, "learn_throughput": 765.337, "synch_weights_time_ms": 23.376}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 9149, "training_iteration": 125, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-56-23", "timestamp": 1702018583, "time_this_iter_s": 8.6297025680542, "time_total_s": 22232.534031391144, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22232.534031391144, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 74.69999999999999, "ram_util_percent": 89.88181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4040029588456537e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 5.682921886444092, "policy_loss": -0.006624115165323019, "vf_loss": 5.68954610824585, "vf_explained_var": 0.5063830018043518, "kl": 0.001566312974318862, "entropy": 0.09843792766332626, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 116715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 122.81300000000012, "episode_reward_min": 14.29733333333333, "episode_reward_mean": 27.888379999999998, "episode_len_mean": 57.72, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.405333333333333, 22.016666666666655, 36.03533333333332, 24.050333333333327, 34.526333333333326, 14.29733333333333, 17.475666666666662, 20.038999999999998, 35.12533333333333, 14.496333333333332, 62.20700000000006, 17.83233333333333, 51.349999999999966, 30.05366666666667, 30.00699999999998, 22.613999999999994, 37.430000000000014, 18.057333333333332, 19.524333333333335, 15.669, 24.87966666666666, 17.41333333333333, 19.11099999999999, 17.510333333333325, 17.543666666666663, 15.829999999999998, 25.43266666666667, 44.474999999999966, 27.39066666666666, 28.620666666666654, 17.11133333333333, 15.981, 55.23300000000002, 23.016333333333318, 32.52166666666665, 38.95300000000001, 21.441666666666656, 45.36199999999998, 18.674999999999994, 45.777000000000015, 23.02466666666666, 39.08533333333333, 14.911999999999997, 26.98499999999999, 18.983999999999998, 14.797666666666663, 17.540666666666667, 21.656666666666663, 18.97533333333332, 21.651666666666653, 27.793666666666663, 20.73166666666666, 18.238666666666667, 21.613666666666656, 18.12066666666666, 17.888999999999996, 31.460333333333335, 19.665666666666667, 20.480666666666657, 34.76099999999999, 19.892333333333326, 22.400333333333325, 16.97699999999999, 15.064999999999998, 20.03633333333333, 15.199666666666664, 32.401666666666664, 30.865, 22.10466666666666, 31.519666666666662, 34.083, 19.00199999999999, 46.976000000000006, 16.487000000000002, 26.468999999999987, 30.48866666666667, 37.586999999999996, 45.443333333333335, 29.381999999999998, 25.805999999999997, 50.26433333333336, 27.364333333333327, 23.874999999999996, 14.346999999999992, 122.81300000000012, 33.21099999999998, 26.931333333333328, 69.09800000000001, 23.90899999999998, 24.46399999999999, 32.17399999999998, 30.34833333333334, 16.411999999999995, 16.033333333333324, 14.84033333333333, 52.25700000000004, 16.165333333333326, 44.284000000000006, 38.63399999999999, 35.36766666666666], "episode_lengths": [28, 46, 83, 56, 58, 31, 44, 45, 65, 29, 111, 34, 117, 80, 88, 60, 79, 33, 42, 35, 49, 44, 41, 37, 36, 32, 46, 106, 60, 71, 33, 37, 91, 54, 73, 79, 59, 76, 48, 88, 56, 96, 31, 53, 41, 34, 38, 43, 50, 62, 57, 49, 51, 39, 46, 40, 52, 41, 55, 59, 38, 40, 46, 30, 39, 32, 66, 52, 57, 57, 56, 55, 93, 32, 66, 60, 57, 75, 64, 50, 93, 59, 48, 35, 210, 55, 49, 143, 65, 62, 73, 58, 43, 35, 30, 89, 32, 68, 71, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5603899734304292, "mean_inference_ms": 2.9839511216856263, "mean_action_processing_ms": 0.5977888477547227, "mean_env_wait_ms": 0.14549881558838565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020871639251708984, "StateBufferConnector_ms": 0.020119667053222656, "ViewRequirementAgentConnector_ms": 0.43366050720214844}}, "episode_reward_max": 122.81300000000012, "episode_reward_min": 14.29733333333333, "episode_reward_mean": 27.888379999999998, "episode_len_mean": 57.72, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.405333333333333, 22.016666666666655, 36.03533333333332, 24.050333333333327, 34.526333333333326, 14.29733333333333, 17.475666666666662, 20.038999999999998, 35.12533333333333, 14.496333333333332, 62.20700000000006, 17.83233333333333, 51.349999999999966, 30.05366666666667, 30.00699999999998, 22.613999999999994, 37.430000000000014, 18.057333333333332, 19.524333333333335, 15.669, 24.87966666666666, 17.41333333333333, 19.11099999999999, 17.510333333333325, 17.543666666666663, 15.829999999999998, 25.43266666666667, 44.474999999999966, 27.39066666666666, 28.620666666666654, 17.11133333333333, 15.981, 55.23300000000002, 23.016333333333318, 32.52166666666665, 38.95300000000001, 21.441666666666656, 45.36199999999998, 18.674999999999994, 45.777000000000015, 23.02466666666666, 39.08533333333333, 14.911999999999997, 26.98499999999999, 18.983999999999998, 14.797666666666663, 17.540666666666667, 21.656666666666663, 18.97533333333332, 21.651666666666653, 27.793666666666663, 20.73166666666666, 18.238666666666667, 21.613666666666656, 18.12066666666666, 17.888999999999996, 31.460333333333335, 19.665666666666667, 20.480666666666657, 34.76099999999999, 19.892333333333326, 22.400333333333325, 16.97699999999999, 15.064999999999998, 20.03633333333333, 15.199666666666664, 32.401666666666664, 30.865, 22.10466666666666, 31.519666666666662, 34.083, 19.00199999999999, 46.976000000000006, 16.487000000000002, 26.468999999999987, 30.48866666666667, 37.586999999999996, 45.443333333333335, 29.381999999999998, 25.805999999999997, 50.26433333333336, 27.364333333333327, 23.874999999999996, 14.346999999999992, 122.81300000000012, 33.21099999999998, 26.931333333333328, 69.09800000000001, 23.90899999999998, 24.46399999999999, 32.17399999999998, 30.34833333333334, 16.411999999999995, 16.033333333333324, 14.84033333333333, 52.25700000000004, 16.165333333333326, 44.284000000000006, 38.63399999999999, 35.36766666666666], "episode_lengths": [28, 46, 83, 56, 58, 31, 44, 45, 65, 29, 111, 34, 117, 80, 88, 60, 79, 33, 42, 35, 49, 44, 41, 37, 36, 32, 46, 106, 60, 71, 33, 37, 91, 54, 73, 79, 59, 76, 48, 88, 56, 96, 31, 53, 41, 34, 38, 43, 50, 62, 57, 49, 51, 39, 46, 40, 52, 41, 55, 59, 38, 40, 46, 30, 39, 32, 66, 52, 57, 57, 56, 55, 93, 32, 66, 60, 57, 75, 64, 50, 93, 59, 48, 35, 210, 55, 49, 143, 65, 62, 73, 58, 43, 35, 30, 89, 32, 68, 71, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5603899734304292, "mean_inference_ms": 2.9839511216856263, "mean_action_processing_ms": 0.5977888477547227, "mean_env_wait_ms": 0.14549881558838565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020871639251708984, "StateBufferConnector_ms": 0.020119667053222656, "ViewRequirementAgentConnector_ms": 0.43366050720214844}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.1286900823066, "num_env_steps_trained_throughput_per_sec": 470.1286900823066, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 8324.188, "sample_time_ms": 2864.491, "load_time_ms": 0.366, "load_throughput": 10934056.309, "learn_time_ms": 5432.757, "learn_throughput": 736.274, "synch_weights_time_ms": 24.522}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 9217, "training_iteration": 126, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-56-32", "timestamp": 1702018592, "time_this_iter_s": 8.52836537361145, "time_total_s": 22241.062396764755, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22241.062396764755, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 72.31666666666666, "ram_util_percent": 88.25833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.020014794228269e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 5.588119029998779, "policy_loss": -0.006970264948904514, "vf_loss": 5.595089435577393, "vf_explained_var": 0.5775001049041748, "kl": 0.0014903657138347626, "entropy": 0.0945289134979248, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 117645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": 122.81300000000012, "episode_reward_min": 13.048666666666666, "episode_reward_mean": 28.061149999999987, "episode_len_mean": 58.1, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.00199999999999, 46.976000000000006, 16.487000000000002, 26.468999999999987, 30.48866666666667, 37.586999999999996, 45.443333333333335, 29.381999999999998, 25.805999999999997, 50.26433333333336, 27.364333333333327, 23.874999999999996, 14.346999999999992, 122.81300000000012, 33.21099999999998, 26.931333333333328, 69.09800000000001, 23.90899999999998, 24.46399999999999, 32.17399999999998, 30.34833333333334, 16.411999999999995, 16.033333333333324, 14.84033333333333, 52.25700000000004, 16.165333333333326, 44.284000000000006, 38.63399999999999, 35.36766666666666, 17.162999999999993, 22.962999999999987, 31.405, 28.400999999999986, 14.91633333333333, 31.693666666666665, 31.38366666666666, 29.678333333333335, 27.124, 32.507333333333314, 40.678333333333306, 35.430666666666646, 24.531999999999993, 17.71433333333332, 16.354999999999997, 15.604999999999993, 24.151999999999983, 34.12466666666668, 19.54833333333333, 21.659666666666663, 21.378999999999998, 37.16233333333333, 18.499666666666656, 19.36333333333333, 43.402666666666654, 26.87733333333333, 24.676333333333332, 18.85666666666666, 14.622999999999992, 15.553666666666658, 42.960666666666654, 37.635666666666665, 47.839999999999996, 16.224333333333327, 18.878666666666668, 34.24933333333332, 21.611666666666668, 19.89733333333332, 16.46533333333333, 29.57733333333333, 22.689333333333327, 13.048666666666666, 14.868, 28.88999999999999, 31.552999999999983, 32.34733333333333, 36.205, 29.80266666666666, 33.71066666666666, 19.886333333333337, 22.419666666666657, 15.910999999999994, 19.296999999999993, 33.77633333333335, 20.251333333333324, 37.295999999999985, 32.070333333333316, 14.958999999999993, 17.101999999999993, 16.15166666666666, 15.275666666666659, 15.680333333333332, 21.998333333333328, 18.71099999999999, 37.30599999999999, 14.653333333333332, 38.959666666666685, 28.36099999999998, 16.175333333333327, 44.09766666666669, 29.45766666666665], "episode_lengths": [55, 93, 32, 66, 60, 57, 75, 64, 50, 93, 59, 48, 35, 210, 55, 49, 143, 65, 62, 73, 58, 43, 35, 30, 89, 32, 68, 71, 72, 49, 53, 70, 52, 37, 72, 60, 63, 54, 56, 98, 85, 41, 43, 34, 35, 62, 78, 39, 48, 54, 79, 37, 43, 77, 48, 43, 51, 31, 33, 69, 58, 109, 36, 50, 81, 47, 38, 32, 63, 58, 27, 30, 50, 55, 66, 85, 81, 59, 44, 49, 34, 51, 61, 46, 84, 63, 37, 47, 35, 34, 30, 54, 37, 81, 32, 77, 70, 37, 81, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.559135721484697, "mean_inference_ms": 2.9799890907367006, "mean_action_processing_ms": 0.5975657028158438, "mean_env_wait_ms": 0.14529280343115583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015915632247924805, "StateBufferConnector_ms": 0.021039485931396484, "ViewRequirementAgentConnector_ms": 0.47973203659057617}}, "episode_reward_max": 122.81300000000012, "episode_reward_min": 13.048666666666666, "episode_reward_mean": 28.061149999999987, "episode_len_mean": 58.1, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.00199999999999, 46.976000000000006, 16.487000000000002, 26.468999999999987, 30.48866666666667, 37.586999999999996, 45.443333333333335, 29.381999999999998, 25.805999999999997, 50.26433333333336, 27.364333333333327, 23.874999999999996, 14.346999999999992, 122.81300000000012, 33.21099999999998, 26.931333333333328, 69.09800000000001, 23.90899999999998, 24.46399999999999, 32.17399999999998, 30.34833333333334, 16.411999999999995, 16.033333333333324, 14.84033333333333, 52.25700000000004, 16.165333333333326, 44.284000000000006, 38.63399999999999, 35.36766666666666, 17.162999999999993, 22.962999999999987, 31.405, 28.400999999999986, 14.91633333333333, 31.693666666666665, 31.38366666666666, 29.678333333333335, 27.124, 32.507333333333314, 40.678333333333306, 35.430666666666646, 24.531999999999993, 17.71433333333332, 16.354999999999997, 15.604999999999993, 24.151999999999983, 34.12466666666668, 19.54833333333333, 21.659666666666663, 21.378999999999998, 37.16233333333333, 18.499666666666656, 19.36333333333333, 43.402666666666654, 26.87733333333333, 24.676333333333332, 18.85666666666666, 14.622999999999992, 15.553666666666658, 42.960666666666654, 37.635666666666665, 47.839999999999996, 16.224333333333327, 18.878666666666668, 34.24933333333332, 21.611666666666668, 19.89733333333332, 16.46533333333333, 29.57733333333333, 22.689333333333327, 13.048666666666666, 14.868, 28.88999999999999, 31.552999999999983, 32.34733333333333, 36.205, 29.80266666666666, 33.71066666666666, 19.886333333333337, 22.419666666666657, 15.910999999999994, 19.296999999999993, 33.77633333333335, 20.251333333333324, 37.295999999999985, 32.070333333333316, 14.958999999999993, 17.101999999999993, 16.15166666666666, 15.275666666666659, 15.680333333333332, 21.998333333333328, 18.71099999999999, 37.30599999999999, 14.653333333333332, 38.959666666666685, 28.36099999999998, 16.175333333333327, 44.09766666666669, 29.45766666666665], "episode_lengths": [55, 93, 32, 66, 60, 57, 75, 64, 50, 93, 59, 48, 35, 210, 55, 49, 143, 65, 62, 73, 58, 43, 35, 30, 89, 32, 68, 71, 72, 49, 53, 70, 52, 37, 72, 60, 63, 54, 56, 98, 85, 41, 43, 34, 35, 62, 78, 39, 48, 54, 79, 37, 43, 77, 48, 43, 51, 31, 33, 69, 58, 109, 36, 50, 81, 47, 38, 32, 63, 58, 27, 30, 50, 55, 66, 85, 81, 59, 44, 49, 34, 51, 61, 46, 84, 63, 37, 47, 35, 34, 30, 54, 37, 81, 32, 77, 70, 37, 81, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.559135721484697, "mean_inference_ms": 2.9799890907367006, "mean_action_processing_ms": 0.5975657028158438, "mean_env_wait_ms": 0.14529280343115583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015915632247924805, "StateBufferConnector_ms": 0.021039485931396484, "ViewRequirementAgentConnector_ms": 0.47973203659057617}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.6322228927254, "num_env_steps_trained_throughput_per_sec": 446.6322228927254, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 8570.895, "sample_time_ms": 2901.398, "load_time_ms": 0.366, "load_throughput": 10934056.309, "learn_time_ms": 5641.646, "learn_throughput": 709.013, "synch_weights_time_ms": 25.334}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 9288, "training_iteration": 127, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-56-41", "timestamp": 1702018601, "time_this_iter_s": 8.977943181991577, "time_total_s": 22250.040339946747, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22250.040339946747, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 70.67692307692307, "ram_util_percent": 89.53846153846153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.510007397114134e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 5.388091087341309, "policy_loss": -0.0027138341683894396, "vf_loss": 5.390804767608643, "vf_explained_var": 0.5921728014945984, "kl": 0.0024065335746854544, "entropy": 0.08680975437164307, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 118575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": 74.22399999999996, "episode_reward_min": 13.048666666666666, "episode_reward_mean": 26.733106666666657, "episode_len_mean": 57.82, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.57733333333333, 22.689333333333327, 13.048666666666666, 14.868, 28.88999999999999, 31.552999999999983, 32.34733333333333, 36.205, 29.80266666666666, 33.71066666666666, 19.886333333333337, 22.419666666666657, 15.910999999999994, 19.296999999999993, 33.77633333333335, 20.251333333333324, 37.295999999999985, 32.070333333333316, 14.958999999999993, 17.101999999999993, 16.15166666666666, 15.275666666666659, 15.680333333333332, 21.998333333333328, 18.71099999999999, 37.30599999999999, 14.653333333333332, 38.959666666666685, 28.36099999999998, 16.175333333333327, 44.09766666666669, 29.45766666666665, 38.952666666666644, 21.44666666666666, 22.870666666666665, 29.890000000000004, 45.476000000000006, 26.698666666666664, 15.47199999999999, 46.346666666666664, 30.891999999999992, 17.646333333333327, 18.475666666666655, 55.88533333333329, 59.84733333333333, 26.62566666666666, 26.26633333333334, 22.565333333333328, 18.693333333333324, 26.610333333333323, 25.112000000000002, 39.546333333333315, 22.672333333333327, 25.246333333333325, 17.262999999999998, 33.125999999999976, 19.08166666666666, 14.931333333333333, 26.991999999999987, 48.462999999999994, 19.358666666666657, 17.443666666666665, 17.321, 16.482333333333326, 40.38933333333334, 22.176999999999992, 16.820999999999994, 35.37866666666666, 35.130333333333326, 35.28233333333332, 15.060999999999996, 17.107333333333326, 19.437333333333328, 33.137999999999984, 19.576999999999995, 74.22399999999996, 58.037999999999975, 14.022999999999996, 20.247333333333312, 16.733999999999988, 27.453666666666653, 16.105666666666657, 23.308666666666657, 19.976333333333322, 18.8, 24.59833333333333, 53.17900000000001, 22.48866666666666, 22.705999999999996, 15.312999999999995, 19.883999999999983, 20.742333333333335, 24.256333333333323, 15.354999999999999, 26.95399999999999, 37.75633333333334, 26.167000000000005, 36.678666666666665, 27.75633333333332, 24.876333333333324], "episode_lengths": [63, 58, 27, 30, 50, 55, 66, 85, 81, 59, 44, 49, 34, 51, 61, 46, 84, 63, 37, 47, 35, 34, 30, 54, 37, 81, 32, 77, 70, 37, 81, 65, 86, 53, 60, 64, 95, 50, 38, 103, 52, 41, 51, 109, 114, 46, 54, 61, 48, 89, 56, 91, 51, 60, 34, 92, 41, 30, 62, 101, 38, 37, 31, 49, 65, 44, 36, 62, 76, 64, 30, 44, 39, 87, 59, 133, 99, 36, 51, 39, 77, 37, 48, 53, 37, 69, 84, 58, 43, 30, 66, 44, 43, 34, 60, 65, 63, 63, 76, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5586328925806345, "mean_inference_ms": 2.977609496067925, "mean_action_processing_ms": 0.5969670724396748, "mean_env_wait_ms": 0.1451918380897655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01808786392211914, "StateBufferConnector_ms": 0.01213836669921875, "ViewRequirementAgentConnector_ms": 0.49761223793029785}}, "episode_reward_max": 74.22399999999996, "episode_reward_min": 13.048666666666666, "episode_reward_mean": 26.733106666666657, "episode_len_mean": 57.82, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.57733333333333, 22.689333333333327, 13.048666666666666, 14.868, 28.88999999999999, 31.552999999999983, 32.34733333333333, 36.205, 29.80266666666666, 33.71066666666666, 19.886333333333337, 22.419666666666657, 15.910999999999994, 19.296999999999993, 33.77633333333335, 20.251333333333324, 37.295999999999985, 32.070333333333316, 14.958999999999993, 17.101999999999993, 16.15166666666666, 15.275666666666659, 15.680333333333332, 21.998333333333328, 18.71099999999999, 37.30599999999999, 14.653333333333332, 38.959666666666685, 28.36099999999998, 16.175333333333327, 44.09766666666669, 29.45766666666665, 38.952666666666644, 21.44666666666666, 22.870666666666665, 29.890000000000004, 45.476000000000006, 26.698666666666664, 15.47199999999999, 46.346666666666664, 30.891999999999992, 17.646333333333327, 18.475666666666655, 55.88533333333329, 59.84733333333333, 26.62566666666666, 26.26633333333334, 22.565333333333328, 18.693333333333324, 26.610333333333323, 25.112000000000002, 39.546333333333315, 22.672333333333327, 25.246333333333325, 17.262999999999998, 33.125999999999976, 19.08166666666666, 14.931333333333333, 26.991999999999987, 48.462999999999994, 19.358666666666657, 17.443666666666665, 17.321, 16.482333333333326, 40.38933333333334, 22.176999999999992, 16.820999999999994, 35.37866666666666, 35.130333333333326, 35.28233333333332, 15.060999999999996, 17.107333333333326, 19.437333333333328, 33.137999999999984, 19.576999999999995, 74.22399999999996, 58.037999999999975, 14.022999999999996, 20.247333333333312, 16.733999999999988, 27.453666666666653, 16.105666666666657, 23.308666666666657, 19.976333333333322, 18.8, 24.59833333333333, 53.17900000000001, 22.48866666666666, 22.705999999999996, 15.312999999999995, 19.883999999999983, 20.742333333333335, 24.256333333333323, 15.354999999999999, 26.95399999999999, 37.75633333333334, 26.167000000000005, 36.678666666666665, 27.75633333333332, 24.876333333333324], "episode_lengths": [63, 58, 27, 30, 50, 55, 66, 85, 81, 59, 44, 49, 34, 51, 61, 46, 84, 63, 37, 47, 35, 34, 30, 54, 37, 81, 32, 77, 70, 37, 81, 65, 86, 53, 60, 64, 95, 50, 38, 103, 52, 41, 51, 109, 114, 46, 54, 61, 48, 89, 56, 91, 51, 60, 34, 92, 41, 30, 62, 101, 38, 37, 31, 49, 65, 44, 36, 62, 76, 64, 30, 44, 39, 87, 59, 133, 99, 36, 51, 39, 77, 37, 48, 53, 37, 69, 84, 58, 43, 30, 66, 44, 43, 34, 60, 65, 63, 63, 76, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5586328925806345, "mean_inference_ms": 2.977609496067925, "mean_action_processing_ms": 0.5969670724396748, "mean_env_wait_ms": 0.1451918380897655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01808786392211914, "StateBufferConnector_ms": 0.01213836669921875, "ViewRequirementAgentConnector_ms": 0.49761223793029785}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.8658595481056, "num_env_steps_trained_throughput_per_sec": 462.8658595481056, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 8758.163, "sample_time_ms": 2940.348, "load_time_ms": 0.366, "load_throughput": 10934056.309, "learn_time_ms": 5790.307, "learn_throughput": 690.81, "synch_weights_time_ms": 24.935}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 9356, "training_iteration": 128, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-56-50", "timestamp": 1702018610, "time_this_iter_s": 8.658807277679443, "time_total_s": 22258.699147224426, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22258.699147224426, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 74.39999999999999, "ram_util_percent": 91.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.755003698557067e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 5.7207794189453125, "policy_loss": -0.0036657541058957577, "vf_loss": 5.724445343017578, "vf_explained_var": 0.5276037454605103, "kl": 0.002817802131175995, "entropy": 0.08798058331012726, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 119505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 74.22399999999996, "episode_reward_min": 14.022999999999996, "episode_reward_mean": 27.84552999999999, "episode_len_mean": 58.81, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.820999999999994, 35.37866666666666, 35.130333333333326, 35.28233333333332, 15.060999999999996, 17.107333333333326, 19.437333333333328, 33.137999999999984, 19.576999999999995, 74.22399999999996, 58.037999999999975, 14.022999999999996, 20.247333333333312, 16.733999999999988, 27.453666666666653, 16.105666666666657, 23.308666666666657, 19.976333333333322, 18.8, 24.59833333333333, 53.17900000000001, 22.48866666666666, 22.705999999999996, 15.312999999999995, 19.883999999999983, 20.742333333333335, 24.256333333333323, 15.354999999999999, 26.95399999999999, 37.75633333333334, 26.167000000000005, 36.678666666666665, 27.75633333333332, 24.876333333333324, 49.53866666666667, 16.310999999999996, 47.36600000000001, 18.331999999999997, 22.00866666666666, 59.88633333333337, 18.254666666666655, 33.75133333333331, 15.512333333333324, 31.326666666666664, 15.16033333333333, 17.893333333333324, 19.814333333333327, 32.26199999999999, 16.62399999999999, 18.839333333333336, 38.95233333333335, 30.984333333333314, 27.867999999999995, 19.670333333333335, 35.023999999999965, 20.980666666666668, 46.95066666666667, 28.68533333333332, 39.12166666666667, 26.231333333333332, 17.979666666666667, 20.690333333333328, 36.85299999999999, 15.618666666666659, 27.700333333333333, 24.563666666666656, 21.789, 32.31466666666664, 39.085666666666654, 23.451666666666647, 19.43333333333333, 20.503666666666664, 33.99999999999999, 31.710000000000015, 30.74833333333332, 22.521333333333324, 15.333333333333336, 59.660000000000025, 43.45333333333334, 16.261666666666667, 14.555333333333328, 16.76533333333333, 25.242666666666647, 34.332, 41.16233333333333, 22.48033333333332, 33.600333333333325, 21.28133333333333, 19.15499999999999, 28.214333333333336, 64.7826666666667, 33.031000000000006, 20.569, 24.66699999999999, 45.73099999999999, 35.72399999999998, 17.25366666666666, 22.922999999999995, 16.060333333333325, 31.445999999999998], "episode_lengths": [36, 62, 76, 64, 30, 44, 39, 87, 59, 133, 99, 36, 51, 39, 77, 37, 48, 53, 37, 69, 84, 58, 43, 30, 66, 44, 43, 34, 60, 65, 63, 63, 76, 58, 88, 31, 95, 38, 55, 113, 39, 84, 41, 86, 40, 45, 40, 63, 40, 41, 65, 53, 57, 50, 99, 44, 82, 65, 72, 55, 36, 50, 86, 33, 52, 59, 39, 77, 93, 56, 48, 50, 53, 54, 52, 55, 35, 107, 71, 39, 34, 33, 71, 67, 64, 53, 52, 46, 37, 56, 112, 70, 42, 70, 82, 84, 46, 64, 36, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5575742907010732, "mean_inference_ms": 2.975053040879228, "mean_action_processing_ms": 0.596839142463873, "mean_env_wait_ms": 0.14514201024458445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013758659362792969, "StateBufferConnector_ms": 0.018798112869262695, "ViewRequirementAgentConnector_ms": 0.4893672466278076}}, "episode_reward_max": 74.22399999999996, "episode_reward_min": 14.022999999999996, "episode_reward_mean": 27.84552999999999, "episode_len_mean": 58.81, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.820999999999994, 35.37866666666666, 35.130333333333326, 35.28233333333332, 15.060999999999996, 17.107333333333326, 19.437333333333328, 33.137999999999984, 19.576999999999995, 74.22399999999996, 58.037999999999975, 14.022999999999996, 20.247333333333312, 16.733999999999988, 27.453666666666653, 16.105666666666657, 23.308666666666657, 19.976333333333322, 18.8, 24.59833333333333, 53.17900000000001, 22.48866666666666, 22.705999999999996, 15.312999999999995, 19.883999999999983, 20.742333333333335, 24.256333333333323, 15.354999999999999, 26.95399999999999, 37.75633333333334, 26.167000000000005, 36.678666666666665, 27.75633333333332, 24.876333333333324, 49.53866666666667, 16.310999999999996, 47.36600000000001, 18.331999999999997, 22.00866666666666, 59.88633333333337, 18.254666666666655, 33.75133333333331, 15.512333333333324, 31.326666666666664, 15.16033333333333, 17.893333333333324, 19.814333333333327, 32.26199999999999, 16.62399999999999, 18.839333333333336, 38.95233333333335, 30.984333333333314, 27.867999999999995, 19.670333333333335, 35.023999999999965, 20.980666666666668, 46.95066666666667, 28.68533333333332, 39.12166666666667, 26.231333333333332, 17.979666666666667, 20.690333333333328, 36.85299999999999, 15.618666666666659, 27.700333333333333, 24.563666666666656, 21.789, 32.31466666666664, 39.085666666666654, 23.451666666666647, 19.43333333333333, 20.503666666666664, 33.99999999999999, 31.710000000000015, 30.74833333333332, 22.521333333333324, 15.333333333333336, 59.660000000000025, 43.45333333333334, 16.261666666666667, 14.555333333333328, 16.76533333333333, 25.242666666666647, 34.332, 41.16233333333333, 22.48033333333332, 33.600333333333325, 21.28133333333333, 19.15499999999999, 28.214333333333336, 64.7826666666667, 33.031000000000006, 20.569, 24.66699999999999, 45.73099999999999, 35.72399999999998, 17.25366666666666, 22.922999999999995, 16.060333333333325, 31.445999999999998], "episode_lengths": [36, 62, 76, 64, 30, 44, 39, 87, 59, 133, 99, 36, 51, 39, 77, 37, 48, 53, 37, 69, 84, 58, 43, 30, 66, 44, 43, 34, 60, 65, 63, 63, 76, 58, 88, 31, 95, 38, 55, 113, 39, 84, 41, 86, 40, 45, 40, 63, 40, 41, 65, 53, 57, 50, 99, 44, 82, 65, 72, 55, 36, 50, 86, 33, 52, 59, 39, 77, 93, 56, 48, 50, 53, 54, 52, 55, 35, 107, 71, 39, 34, 33, 71, 67, 64, 53, 52, 46, 37, 56, 112, 70, 42, 70, 82, 84, 46, 64, 36, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5575742907010732, "mean_inference_ms": 2.975053040879228, "mean_action_processing_ms": 0.596839142463873, "mean_env_wait_ms": 0.14514201024458445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013758659362792969, "StateBufferConnector_ms": 0.018798112869262695, "ViewRequirementAgentConnector_ms": 0.4893672466278076}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.96854874242825, "num_env_steps_trained_throughput_per_sec": 488.96854874242825, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 8576.765, "sample_time_ms": 2813.957, "load_time_ms": 0.367, "load_throughput": 10893588.728, "learn_time_ms": 5735.701, "learn_throughput": 697.386, "synch_weights_time_ms": 24.731}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 9422, "training_iteration": 129, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-56-58", "timestamp": 1702018618, "time_this_iter_s": 8.220496892929077, "time_total_s": 22266.919644117355, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22266.919644117355, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 73.44545454545454, "ram_util_percent": 91.85454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.775018492785336e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 5.368142127990723, "policy_loss": 0.004324361216276884, "vf_loss": 5.36381721496582, "vf_explained_var": 0.6598988771438599, "kl": 0.002897277008742094, "entropy": 0.09402632713317871, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": 80.68166666666674, "episode_reward_min": 12.966333333333331, "episode_reward_mean": 28.055363333333336, "episode_len_mean": 57.58, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.43333333333333, 20.503666666666664, 33.99999999999999, 31.710000000000015, 30.74833333333332, 22.521333333333324, 15.333333333333336, 59.660000000000025, 43.45333333333334, 16.261666666666667, 14.555333333333328, 16.76533333333333, 25.242666666666647, 34.332, 41.16233333333333, 22.48033333333332, 33.600333333333325, 21.28133333333333, 19.15499999999999, 28.214333333333336, 64.7826666666667, 33.031000000000006, 20.569, 24.66699999999999, 45.73099999999999, 35.72399999999998, 17.25366666666666, 22.922999999999995, 16.060333333333325, 31.445999999999998, 31.452999999999985, 27.72999999999999, 14.66666666666666, 28.983999999999998, 25.198666666666664, 80.68166666666674, 39.078, 49.387333333333345, 27.52833333333333, 20.876, 17.62166666666666, 26.724999999999987, 35.67199999999998, 28.921333333333322, 52.09466666666672, 38.77866666666669, 15.669666666666664, 33.779666666666664, 28.930333333333323, 56.26533333333333, 18.213333333333328, 26.429999999999993, 26.577999999999996, 58.54633333333333, 19.068666666666665, 22.169333333333334, 22.25133333333333, 20.674333333333326, 20.236999999999988, 22.332666666666668, 18.592333333333336, 21.299333333333326, 19.735333333333333, 18.186999999999994, 28.986999999999988, 17.991666666666667, 33.60833333333333, 47.299666666666674, 70.66033333333337, 19.975999999999996, 42.050333333333306, 19.664666666666662, 29.792333333333318, 18.054666666666662, 17.68833333333333, 25.166666666666664, 17.023999999999994, 17.016666666666666, 17.049333333333337, 16.06033333333333, 34.90633333333331, 14.71233333333333, 38.89766666666666, 21.61733333333332, 36.280333333333324, 23.47566666666666, 12.966333333333331, 25.150000000000006, 15.334666666666655, 40.114, 19.34133333333333, 34.12800000000001, 18.74099999999999, 27.010666666666644, 22.28066666666667, 27.767333333333326, 22.472999999999995, 17.98933333333333, 14.529999999999996, 22.771333333333327], "episode_lengths": [48, 50, 53, 54, 52, 55, 35, 107, 71, 39, 34, 33, 71, 67, 64, 53, 52, 46, 37, 56, 112, 70, 42, 70, 82, 84, 46, 64, 36, 73, 80, 61, 35, 67, 56, 143, 84, 99, 50, 47, 37, 69, 73, 57, 79, 65, 38, 71, 52, 112, 41, 52, 59, 96, 37, 41, 43, 42, 44, 41, 47, 45, 38, 40, 62, 34, 70, 76, 119, 37, 82, 46, 86, 34, 38, 44, 37, 34, 38, 32, 88, 30, 72, 55, 90, 60, 26, 54, 37, 89, 38, 71, 39, 67, 55, 54, 59, 36, 30, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5551864563594888, "mean_inference_ms": 2.9723450536524547, "mean_action_processing_ms": 0.5957288191703694, "mean_env_wait_ms": 0.14493794001696692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018325090408325195, "StateBufferConnector_ms": 0.020397186279296875, "ViewRequirementAgentConnector_ms": 0.3860452175140381}}, "episode_reward_max": 80.68166666666674, "episode_reward_min": 12.966333333333331, "episode_reward_mean": 28.055363333333336, "episode_len_mean": 57.58, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.43333333333333, 20.503666666666664, 33.99999999999999, 31.710000000000015, 30.74833333333332, 22.521333333333324, 15.333333333333336, 59.660000000000025, 43.45333333333334, 16.261666666666667, 14.555333333333328, 16.76533333333333, 25.242666666666647, 34.332, 41.16233333333333, 22.48033333333332, 33.600333333333325, 21.28133333333333, 19.15499999999999, 28.214333333333336, 64.7826666666667, 33.031000000000006, 20.569, 24.66699999999999, 45.73099999999999, 35.72399999999998, 17.25366666666666, 22.922999999999995, 16.060333333333325, 31.445999999999998, 31.452999999999985, 27.72999999999999, 14.66666666666666, 28.983999999999998, 25.198666666666664, 80.68166666666674, 39.078, 49.387333333333345, 27.52833333333333, 20.876, 17.62166666666666, 26.724999999999987, 35.67199999999998, 28.921333333333322, 52.09466666666672, 38.77866666666669, 15.669666666666664, 33.779666666666664, 28.930333333333323, 56.26533333333333, 18.213333333333328, 26.429999999999993, 26.577999999999996, 58.54633333333333, 19.068666666666665, 22.169333333333334, 22.25133333333333, 20.674333333333326, 20.236999999999988, 22.332666666666668, 18.592333333333336, 21.299333333333326, 19.735333333333333, 18.186999999999994, 28.986999999999988, 17.991666666666667, 33.60833333333333, 47.299666666666674, 70.66033333333337, 19.975999999999996, 42.050333333333306, 19.664666666666662, 29.792333333333318, 18.054666666666662, 17.68833333333333, 25.166666666666664, 17.023999999999994, 17.016666666666666, 17.049333333333337, 16.06033333333333, 34.90633333333331, 14.71233333333333, 38.89766666666666, 21.61733333333332, 36.280333333333324, 23.47566666666666, 12.966333333333331, 25.150000000000006, 15.334666666666655, 40.114, 19.34133333333333, 34.12800000000001, 18.74099999999999, 27.010666666666644, 22.28066666666667, 27.767333333333326, 22.472999999999995, 17.98933333333333, 14.529999999999996, 22.771333333333327], "episode_lengths": [48, 50, 53, 54, 52, 55, 35, 107, 71, 39, 34, 33, 71, 67, 64, 53, 52, 46, 37, 56, 112, 70, 42, 70, 82, 84, 46, 64, 36, 73, 80, 61, 35, 67, 56, 143, 84, 99, 50, 47, 37, 69, 73, 57, 79, 65, 38, 71, 52, 112, 41, 52, 59, 96, 37, 41, 43, 42, 44, 41, 47, 45, 38, 40, 62, 34, 70, 76, 119, 37, 82, 46, 86, 34, 38, 44, 37, 34, 38, 32, 88, 30, 72, 55, 90, 60, 26, 54, 37, 89, 38, 71, 39, 67, 55, 54, 59, 36, 30, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5551864563594888, "mean_inference_ms": 2.9723450536524547, "mean_action_processing_ms": 0.5957288191703694, "mean_env_wait_ms": 0.14493794001696692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018325090408325195, "StateBufferConnector_ms": 0.020397186279296875, "ViewRequirementAgentConnector_ms": 0.3860452175140381}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.5649099606508, "num_env_steps_trained_throughput_per_sec": 507.5649099606508, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 8471.192, "sample_time_ms": 2738.245, "load_time_ms": 0.322, "load_throughput": 12425726.559, "learn_time_ms": 5704.619, "learn_throughput": 701.186, "synch_weights_time_ms": 25.858}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 9492, "training_iteration": 130, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-06", "timestamp": 1702018626, "time_this_iter_s": 7.9027910232543945, "time_total_s": 22274.82243514061, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22274.82243514061, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 74.9090909090909, "ram_util_percent": 92.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.387509246392668e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 5.418823719024658, "policy_loss": 7.926892430987209e-05, "vf_loss": 5.41874361038208, "vf_explained_var": 0.598963737487793, "kl": 0.001546629355289042, "entropy": 0.08319580554962158, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 121365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": 62.06366666666664, "episode_reward_min": 12.966333333333331, "episode_reward_mean": 26.624806666666665, "episode_len_mean": 57.26, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.050333333333306, 19.664666666666662, 29.792333333333318, 18.054666666666662, 17.68833333333333, 25.166666666666664, 17.023999999999994, 17.016666666666666, 17.049333333333337, 16.06033333333333, 34.90633333333331, 14.71233333333333, 38.89766666666666, 21.61733333333332, 36.280333333333324, 23.47566666666666, 12.966333333333331, 25.150000000000006, 15.334666666666655, 40.114, 19.34133333333333, 34.12800000000001, 18.74099999999999, 27.010666666666644, 22.28066666666667, 27.767333333333326, 22.472999999999995, 17.98933333333333, 14.529999999999996, 22.771333333333327, 37.15799999999997, 62.06366666666664, 43.44733333333335, 34.293666666666645, 20.707333333333327, 18.08166666666666, 45.13966666666666, 13.901999999999997, 15.344333333333328, 17.128333333333316, 55.14133333333336, 40.07133333333332, 14.189333333333328, 30.211666666666652, 39.592999999999996, 19.76566666666666, 46.22566666666662, 16.83866666666666, 32.56633333333334, 24.163999999999984, 16.066333333333333, 27.88866666666664, 26.066999999999993, 16.96433333333333, 20.468333333333323, 44.57633333333335, 20.031666666666666, 18.651333333333323, 40.787000000000006, 22.56233333333333, 43.94466666666667, 38.86133333333331, 38.386666666666656, 39.6503333333333, 45.750333333333316, 15.705999999999996, 19.718666666666667, 32.468666666666664, 32.18500000000002, 14.512666666666659, 18.96066666666666, 35.67033333333331, 18.479999999999993, 20.245999999999995, 19.11333333333333, 13.616666666666667, 21.26633333333333, 19.110333333333323, 19.291, 21.58966666666666, 19.361666666666665, 33.738, 15.493333333333332, 30.431333333333328, 28.792999999999996, 14.331333333333331, 28.370666666666654, 17.910333333333334, 39.69666666666665, 22.161999999999995, 21.43266666666665, 41.50466666666665, 15.010999999999994, 35.515999999999984, 18.814666666666657, 30.720000000000006, 27.823, 40.22633333333333, 37.94266666666665, 24.521666666666654], "episode_lengths": [82, 46, 86, 34, 38, 44, 37, 34, 38, 32, 88, 30, 72, 55, 90, 60, 26, 54, 37, 89, 38, 71, 39, 67, 55, 54, 59, 36, 30, 42, 103, 91, 96, 81, 48, 39, 76, 27, 31, 44, 96, 64, 30, 82, 70, 46, 105, 39, 77, 53, 30, 80, 73, 34, 42, 81, 42, 43, 67, 53, 96, 80, 83, 85, 86, 36, 39, 74, 69, 31, 39, 82, 40, 39, 36, 28, 52, 51, 39, 50, 39, 59, 30, 60, 69, 29, 71, 37, 97, 58, 64, 76, 32, 84, 46, 72, 68, 70, 62, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5540750939349086, "mean_inference_ms": 2.9698365762304335, "mean_action_processing_ms": 0.5963489817731916, "mean_env_wait_ms": 0.14492130659394906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023717641830444336, "StateBufferConnector_ms": 0.025883913040161133, "ViewRequirementAgentConnector_ms": 0.4502372741699219}}, "episode_reward_max": 62.06366666666664, "episode_reward_min": 12.966333333333331, "episode_reward_mean": 26.624806666666665, "episode_len_mean": 57.26, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.050333333333306, 19.664666666666662, 29.792333333333318, 18.054666666666662, 17.68833333333333, 25.166666666666664, 17.023999999999994, 17.016666666666666, 17.049333333333337, 16.06033333333333, 34.90633333333331, 14.71233333333333, 38.89766666666666, 21.61733333333332, 36.280333333333324, 23.47566666666666, 12.966333333333331, 25.150000000000006, 15.334666666666655, 40.114, 19.34133333333333, 34.12800000000001, 18.74099999999999, 27.010666666666644, 22.28066666666667, 27.767333333333326, 22.472999999999995, 17.98933333333333, 14.529999999999996, 22.771333333333327, 37.15799999999997, 62.06366666666664, 43.44733333333335, 34.293666666666645, 20.707333333333327, 18.08166666666666, 45.13966666666666, 13.901999999999997, 15.344333333333328, 17.128333333333316, 55.14133333333336, 40.07133333333332, 14.189333333333328, 30.211666666666652, 39.592999999999996, 19.76566666666666, 46.22566666666662, 16.83866666666666, 32.56633333333334, 24.163999999999984, 16.066333333333333, 27.88866666666664, 26.066999999999993, 16.96433333333333, 20.468333333333323, 44.57633333333335, 20.031666666666666, 18.651333333333323, 40.787000000000006, 22.56233333333333, 43.94466666666667, 38.86133333333331, 38.386666666666656, 39.6503333333333, 45.750333333333316, 15.705999999999996, 19.718666666666667, 32.468666666666664, 32.18500000000002, 14.512666666666659, 18.96066666666666, 35.67033333333331, 18.479999999999993, 20.245999999999995, 19.11333333333333, 13.616666666666667, 21.26633333333333, 19.110333333333323, 19.291, 21.58966666666666, 19.361666666666665, 33.738, 15.493333333333332, 30.431333333333328, 28.792999999999996, 14.331333333333331, 28.370666666666654, 17.910333333333334, 39.69666666666665, 22.161999999999995, 21.43266666666665, 41.50466666666665, 15.010999999999994, 35.515999999999984, 18.814666666666657, 30.720000000000006, 27.823, 40.22633333333333, 37.94266666666665, 24.521666666666654], "episode_lengths": [82, 46, 86, 34, 38, 44, 37, 34, 38, 32, 88, 30, 72, 55, 90, 60, 26, 54, 37, 89, 38, 71, 39, 67, 55, 54, 59, 36, 30, 42, 103, 91, 96, 81, 48, 39, 76, 27, 31, 44, 96, 64, 30, 82, 70, 46, 105, 39, 77, 53, 30, 80, 73, 34, 42, 81, 42, 43, 67, 53, 96, 80, 83, 85, 86, 36, 39, 74, 69, 31, 39, 82, 40, 39, 36, 28, 52, 51, 39, 50, 39, 59, 30, 60, 69, 29, 71, 37, 97, 58, 64, 76, 32, 84, 46, 72, 68, 70, 62, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5540750939349086, "mean_inference_ms": 2.9698365762304335, "mean_action_processing_ms": 0.5963489817731916, "mean_env_wait_ms": 0.14492130659394906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023717641830444336, "StateBufferConnector_ms": 0.025883913040161133, "ViewRequirementAgentConnector_ms": 0.4502372741699219}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.6420076137364, "num_env_steps_trained_throughput_per_sec": 479.6420076137364, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 8484.616, "sample_time_ms": 2744.691, "load_time_ms": 0.342, "load_throughput": 11689810.479, "learn_time_ms": 5712.84, "learn_throughput": 700.177, "synch_weights_time_ms": 24.626}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 9562, "training_iteration": 131, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-14", "timestamp": 1702018634, "time_this_iter_s": 8.349549531936646, "time_total_s": 22283.171984672546, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22283.171984672546, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 72.0, "ram_util_percent": 93.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.193754623196334e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 5.083128452301025, "policy_loss": 0.0012960584135726094, "vf_loss": 5.081832408905029, "vf_explained_var": 0.6366673707962036, "kl": 0.0021220422349870205, "entropy": 0.08285755664110184, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 122295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 58.42699999999999, "episode_reward_min": 13.616666666666667, "episode_reward_mean": 25.525243333333325, "episode_len_mean": 55.42, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.96066666666666, 35.67033333333331, 18.479999999999993, 20.245999999999995, 19.11333333333333, 13.616666666666667, 21.26633333333333, 19.110333333333323, 19.291, 21.58966666666666, 19.361666666666665, 33.738, 15.493333333333332, 30.431333333333328, 28.792999999999996, 14.331333333333331, 28.370666666666654, 17.910333333333334, 39.69666666666665, 22.161999999999995, 21.43266666666665, 41.50466666666665, 15.010999999999994, 35.515999999999984, 18.814666666666657, 30.720000000000006, 27.823, 40.22633333333333, 37.94266666666665, 24.521666666666654, 22.031333333333333, 20.31433333333333, 47.13566666666667, 18.008999999999997, 17.884, 28.483000000000004, 22.62699999999998, 20.29033333333333, 15.278999999999996, 16.566999999999997, 18.074666666666662, 42.18033333333336, 31.272333333333307, 15.770666666666664, 25.417000000000012, 21.60733333333333, 17.173333333333332, 26.483333333333317, 26.599666666666675, 40.37166666666664, 40.664666666666676, 18.520333333333323, 18.876666666666665, 28.262333333333334, 17.916333333333323, 22.239333333333327, 30.45, 14.197, 58.42699999999999, 35.667333333333325, 18.514999999999997, 24.870333333333324, 25.242999999999995, 18.30699999999999, 22.95866666666666, 18.732333333333322, 21.863999999999987, 26.55033333333332, 16.217999999999996, 31.59633333333334, 25.601333333333326, 35.258999999999986, 17.50466666666666, 21.884999999999984, 21.560999999999996, 20.122333333333323, 32.05166666666666, 25.651333333333323, 26.060666666666656, 20.373999999999995, 25.612666666666648, 14.993333333333325, 29.38766666666665, 26.659999999999993, 53.559666666666665, 40.171, 14.849666666666664, 18.048666666666662, 27.119666666666657, 41.72066666666663, 30.83899999999999, 21.283999999999992, 18.010999999999992, 41.15499999999999, 25.538333333333327, 30.951333333333316, 28.922999999999988, 13.654666666666667, 22.127000000000002, 27.054666666666648], "episode_lengths": [39, 82, 40, 39, 36, 28, 52, 51, 39, 50, 39, 59, 30, 60, 69, 29, 71, 37, 97, 58, 64, 76, 32, 84, 46, 72, 68, 70, 62, 62, 43, 56, 78, 35, 44, 55, 70, 45, 35, 38, 36, 76, 74, 31, 43, 39, 35, 61, 52, 75, 85, 38, 37, 55, 51, 40, 49, 29, 92, 76, 38, 60, 56, 38, 49, 43, 60, 85, 46, 70, 59, 66, 37, 48, 47, 43, 68, 57, 63, 45, 79, 32, 77, 61, 92, 83, 34, 42, 51, 99, 71, 44, 39, 96, 59, 69, 63, 31, 47, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5510710620533046, "mean_inference_ms": 2.9651718745896587, "mean_action_processing_ms": 0.5954349824803568, "mean_env_wait_ms": 0.1446250960350954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013788223266601562, "StateBufferConnector_ms": 0.012177705764770508, "ViewRequirementAgentConnector_ms": 0.3878140449523926}}, "episode_reward_max": 58.42699999999999, "episode_reward_min": 13.616666666666667, "episode_reward_mean": 25.525243333333325, "episode_len_mean": 55.42, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.96066666666666, 35.67033333333331, 18.479999999999993, 20.245999999999995, 19.11333333333333, 13.616666666666667, 21.26633333333333, 19.110333333333323, 19.291, 21.58966666666666, 19.361666666666665, 33.738, 15.493333333333332, 30.431333333333328, 28.792999999999996, 14.331333333333331, 28.370666666666654, 17.910333333333334, 39.69666666666665, 22.161999999999995, 21.43266666666665, 41.50466666666665, 15.010999999999994, 35.515999999999984, 18.814666666666657, 30.720000000000006, 27.823, 40.22633333333333, 37.94266666666665, 24.521666666666654, 22.031333333333333, 20.31433333333333, 47.13566666666667, 18.008999999999997, 17.884, 28.483000000000004, 22.62699999999998, 20.29033333333333, 15.278999999999996, 16.566999999999997, 18.074666666666662, 42.18033333333336, 31.272333333333307, 15.770666666666664, 25.417000000000012, 21.60733333333333, 17.173333333333332, 26.483333333333317, 26.599666666666675, 40.37166666666664, 40.664666666666676, 18.520333333333323, 18.876666666666665, 28.262333333333334, 17.916333333333323, 22.239333333333327, 30.45, 14.197, 58.42699999999999, 35.667333333333325, 18.514999999999997, 24.870333333333324, 25.242999999999995, 18.30699999999999, 22.95866666666666, 18.732333333333322, 21.863999999999987, 26.55033333333332, 16.217999999999996, 31.59633333333334, 25.601333333333326, 35.258999999999986, 17.50466666666666, 21.884999999999984, 21.560999999999996, 20.122333333333323, 32.05166666666666, 25.651333333333323, 26.060666666666656, 20.373999999999995, 25.612666666666648, 14.993333333333325, 29.38766666666665, 26.659999999999993, 53.559666666666665, 40.171, 14.849666666666664, 18.048666666666662, 27.119666666666657, 41.72066666666663, 30.83899999999999, 21.283999999999992, 18.010999999999992, 41.15499999999999, 25.538333333333327, 30.951333333333316, 28.922999999999988, 13.654666666666667, 22.127000000000002, 27.054666666666648], "episode_lengths": [39, 82, 40, 39, 36, 28, 52, 51, 39, 50, 39, 59, 30, 60, 69, 29, 71, 37, 97, 58, 64, 76, 32, 84, 46, 72, 68, 70, 62, 62, 43, 56, 78, 35, 44, 55, 70, 45, 35, 38, 36, 76, 74, 31, 43, 39, 35, 61, 52, 75, 85, 38, 37, 55, 51, 40, 49, 29, 92, 76, 38, 60, 56, 38, 49, 43, 60, 85, 46, 70, 59, 66, 37, 48, 47, 43, 68, 57, 63, 45, 79, 32, 77, 61, 92, 83, 34, 42, 51, 99, 71, 44, 39, 96, 59, 69, 63, 31, 47, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5510710620533046, "mean_inference_ms": 2.9651718745896587, "mean_action_processing_ms": 0.5954349824803568, "mean_env_wait_ms": 0.1446250960350954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013788223266601562, "StateBufferConnector_ms": 0.012177705764770508, "ViewRequirementAgentConnector_ms": 0.3878140449523926}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 746.937448967871, "num_env_steps_trained_throughput_per_sec": 746.937448967871, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 8199.017, "sample_time_ms": 2696.538, "load_time_ms": 0.442, "load_throughput": 9047247.627, "learn_time_ms": 5475.693, "learn_throughput": 730.501, "synch_weights_time_ms": 24.211}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 9632, "training_iteration": 132, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-20", "timestamp": 1702018640, "time_this_iter_s": 5.365191459655762, "time_total_s": 22288.537176132202, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22288.537176132202, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 77.15714285714286, "ram_util_percent": 93.32857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.096877311598167e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 5.732088088989258, "policy_loss": -0.005702946800738573, "vf_loss": 5.737791061401367, "vf_explained_var": 0.6130238771438599, "kl": 0.00846017338335514, "entropy": 0.10273630172014236, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 123225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": 60.71633333333332, "episode_reward_min": 13.212333333333332, "episode_reward_mean": 27.31427666666666, "episode_len_mean": 57.8, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.601333333333326, 35.258999999999986, 17.50466666666666, 21.884999999999984, 21.560999999999996, 20.122333333333323, 32.05166666666666, 25.651333333333323, 26.060666666666656, 20.373999999999995, 25.612666666666648, 14.993333333333325, 29.38766666666665, 26.659999999999993, 53.559666666666665, 40.171, 14.849666666666664, 18.048666666666662, 27.119666666666657, 41.72066666666663, 30.83899999999999, 21.283999999999992, 18.010999999999992, 41.15499999999999, 25.538333333333327, 30.951333333333316, 28.922999999999988, 13.654666666666667, 22.127000000000002, 27.054666666666648, 48.687333333333335, 42.22766666666667, 31.248666666666658, 34.461000000000006, 21.428333333333327, 13.212333333333332, 27.24799999999999, 25.22233333333333, 46.182666666666655, 53.668333333333315, 47.82600000000003, 57.82866666666669, 18.201999999999995, 24.615666666666662, 14.367666666666665, 32.230999999999995, 23.01333333333333, 15.349666666666657, 25.944666666666667, 17.587999999999997, 21.57633333333332, 18.868, 30.34633333333331, 18.52333333333333, 17.860666666666656, 27.97433333333332, 50.967666666666645, 19.502666666666663, 17.303333333333327, 43.15999999999998, 18.579333333333324, 17.143333333333327, 25.89733333333333, 21.571666666666662, 27.88033333333331, 23.00433333333333, 16.700333333333326, 15.343999999999994, 17.73966666666666, 13.433999999999997, 24.613999999999976, 49.63433333333336, 16.22266666666666, 21.817333333333327, 60.71633333333332, 16.037000000000003, 32.91833333333332, 40.402333333333345, 44.84433333333335, 25.34733333333333, 18.900666666666663, 18.543999999999993, 26.512999999999987, 35.65099999999998, 36.739666666666665, 31.787666666666656, 26.671999999999993, 32.844666666666654, 20.682000000000002, 49.1616666666667, 35.09933333333333, 16.64433333333333, 17.28933333333333, 20.440333333333314, 18.60566666666666, 17.585333333333327, 16.328666666666663, 25.65799999999999, 30.863999999999987, 21.199999999999985], "episode_lengths": [59, 66, 37, 48, 47, 43, 68, 57, 63, 45, 79, 32, 77, 61, 92, 83, 34, 42, 51, 99, 71, 44, 39, 96, 59, 69, 63, 31, 47, 81, 84, 85, 69, 62, 41, 28, 53, 49, 93, 91, 83, 121, 42, 58, 31, 56, 49, 30, 48, 41, 54, 35, 50, 42, 52, 47, 96, 40, 35, 78, 39, 32, 52, 49, 80, 42, 36, 35, 40, 29, 92, 89, 34, 45, 117, 30, 60, 68, 95, 46, 42, 38, 64, 99, 76, 67, 57, 79, 43, 84, 61, 34, 39, 57, 39, 40, 43, 56, 72, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5464602903374536, "mean_inference_ms": 2.9560830600166836, "mean_action_processing_ms": 0.5930576341832408, "mean_env_wait_ms": 0.14430946383899237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012382984161376953, "StateBufferConnector_ms": 0.007258892059326172, "ViewRequirementAgentConnector_ms": 0.28411364555358887}}, "episode_reward_max": 60.71633333333332, "episode_reward_min": 13.212333333333332, "episode_reward_mean": 27.31427666666666, "episode_len_mean": 57.8, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.601333333333326, 35.258999999999986, 17.50466666666666, 21.884999999999984, 21.560999999999996, 20.122333333333323, 32.05166666666666, 25.651333333333323, 26.060666666666656, 20.373999999999995, 25.612666666666648, 14.993333333333325, 29.38766666666665, 26.659999999999993, 53.559666666666665, 40.171, 14.849666666666664, 18.048666666666662, 27.119666666666657, 41.72066666666663, 30.83899999999999, 21.283999999999992, 18.010999999999992, 41.15499999999999, 25.538333333333327, 30.951333333333316, 28.922999999999988, 13.654666666666667, 22.127000000000002, 27.054666666666648, 48.687333333333335, 42.22766666666667, 31.248666666666658, 34.461000000000006, 21.428333333333327, 13.212333333333332, 27.24799999999999, 25.22233333333333, 46.182666666666655, 53.668333333333315, 47.82600000000003, 57.82866666666669, 18.201999999999995, 24.615666666666662, 14.367666666666665, 32.230999999999995, 23.01333333333333, 15.349666666666657, 25.944666666666667, 17.587999999999997, 21.57633333333332, 18.868, 30.34633333333331, 18.52333333333333, 17.860666666666656, 27.97433333333332, 50.967666666666645, 19.502666666666663, 17.303333333333327, 43.15999999999998, 18.579333333333324, 17.143333333333327, 25.89733333333333, 21.571666666666662, 27.88033333333331, 23.00433333333333, 16.700333333333326, 15.343999999999994, 17.73966666666666, 13.433999999999997, 24.613999999999976, 49.63433333333336, 16.22266666666666, 21.817333333333327, 60.71633333333332, 16.037000000000003, 32.91833333333332, 40.402333333333345, 44.84433333333335, 25.34733333333333, 18.900666666666663, 18.543999999999993, 26.512999999999987, 35.65099999999998, 36.739666666666665, 31.787666666666656, 26.671999999999993, 32.844666666666654, 20.682000000000002, 49.1616666666667, 35.09933333333333, 16.64433333333333, 17.28933333333333, 20.440333333333314, 18.60566666666666, 17.585333333333327, 16.328666666666663, 25.65799999999999, 30.863999999999987, 21.199999999999985], "episode_lengths": [59, 66, 37, 48, 47, 43, 68, 57, 63, 45, 79, 32, 77, 61, 92, 83, 34, 42, 51, 99, 71, 44, 39, 96, 59, 69, 63, 31, 47, 81, 84, 85, 69, 62, 41, 28, 53, 49, 93, 91, 83, 121, 42, 58, 31, 56, 49, 30, 48, 41, 54, 35, 50, 42, 52, 47, 96, 40, 35, 78, 39, 32, 52, 49, 80, 42, 36, 35, 40, 29, 92, 89, 34, 45, 117, 30, 60, 68, 95, 46, 42, 38, 64, 99, 76, 67, 57, 79, 43, 84, 61, 34, 39, 57, 39, 40, 43, 56, 72, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5464602903374536, "mean_inference_ms": 2.9560830600166836, "mean_action_processing_ms": 0.5930576341832408, "mean_env_wait_ms": 0.14430946383899237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012382984161376953, "StateBufferConnector_ms": 0.007258892059326172, "ViewRequirementAgentConnector_ms": 0.28411364555358887}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 968.2671369447534, "num_env_steps_trained_throughput_per_sec": 968.2671369447534, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 7764.496, "sample_time_ms": 2605.341, "load_time_ms": 0.542, "load_throughput": 7376870.246, "learn_time_ms": 5131.918, "learn_throughput": 779.436, "synch_weights_time_ms": 24.642}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 9702, "training_iteration": 133, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-24", "timestamp": 1702018644, "time_this_iter_s": 4.141107559204102, "time_total_s": 22292.678283691406, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22292.678283691406, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 67.71666666666667, "ram_util_percent": 92.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.096877311598167e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 5.524724960327148, "policy_loss": -0.004674111492931843, "vf_loss": 5.5293989181518555, "vf_explained_var": 0.614165723323822, "kl": 0.0034918603487312794, "entropy": 0.11448290199041367, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 124155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": 65.71933333333338, "episode_reward_min": 13.433999999999997, "episode_reward_mean": 27.552696666666662, "episode_len_mean": 60.62, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.343999999999994, 17.73966666666666, 13.433999999999997, 24.613999999999976, 49.63433333333336, 16.22266666666666, 21.817333333333327, 60.71633333333332, 16.037000000000003, 32.91833333333332, 40.402333333333345, 44.84433333333335, 25.34733333333333, 18.900666666666663, 18.543999999999993, 26.512999999999987, 35.65099999999998, 36.739666666666665, 31.787666666666656, 26.671999999999993, 32.844666666666654, 20.682000000000002, 49.1616666666667, 35.09933333333333, 16.64433333333333, 17.28933333333333, 20.440333333333314, 18.60566666666666, 17.585333333333327, 16.328666666666663, 25.65799999999999, 30.863999999999987, 21.199999999999985, 38.903000000000006, 14.76733333333333, 24.105333333333324, 24.666333333333327, 21.091000000000005, 31.39833333333332, 32.93199999999998, 30.76733333333332, 22.222999999999992, 56.770333333333355, 55.58733333333331, 17.053999999999995, 36.23033333333333, 40.20700000000003, 30.28300000000001, 18.29866666666666, 15.805999999999996, 33.54699999999998, 22.97499999999998, 25.167, 24.042666666666662, 23.89666666666665, 65.71933333333338, 27.326999999999984, 30.004999999999992, 20.886, 32.886333333333326, 27.133333333333326, 27.56533333333333, 41.18733333333333, 15.89833333333333, 16.03233333333333, 26.05166666666666, 47.56266666666665, 14.621333333333332, 35.19099999999999, 31.511666666666663, 21.430666666666653, 42.679999999999964, 15.848333333333326, 21.781999999999996, 24.48066666666665, 15.945333333333332, 43.88699999999998, 16.392333333333326, 17.522666666666666, 20.78499999999999, 16.822666666666663, 18.646999999999995, 32.36666666666665, 33.67499999999997, 21.224999999999994, 24.250333333333323, 17.491999999999994, 14.347333333333328, 30.15733333333332, 35.47499999999999, 40.435, 16.570999999999994, 40.492666666666665, 21.93333333333333, 18.727, 17.265333333333324, 25.501666666666665, 43.06500000000002, 35.20133333333331, 14.284666666666666], "episode_lengths": [35, 40, 29, 92, 89, 34, 45, 117, 30, 60, 68, 95, 46, 42, 38, 64, 99, 76, 67, 57, 79, 43, 84, 61, 34, 39, 57, 39, 40, 43, 56, 72, 54, 77, 36, 86, 55, 43, 76, 92, 66, 52, 102, 98, 36, 84, 76, 54, 39, 45, 70, 63, 56, 58, 76, 110, 75, 68, 43, 96, 59, 48, 87, 39, 37, 63, 94, 30, 87, 77, 60, 103, 50, 49, 52, 32, 103, 33, 47, 39, 34, 42, 89, 92, 39, 60, 45, 30, 54, 77, 81, 37, 75, 44, 37, 40, 63, 78, 71, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.542410004191744, "mean_inference_ms": 2.9472869423444674, "mean_action_processing_ms": 0.5913580715380022, "mean_env_wait_ms": 0.14399866578004616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020032167434692383, "StateBufferConnector_ms": 0.009371757507324219, "ViewRequirementAgentConnector_ms": 0.31383609771728516}}, "episode_reward_max": 65.71933333333338, "episode_reward_min": 13.433999999999997, "episode_reward_mean": 27.552696666666662, "episode_len_mean": 60.62, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.343999999999994, 17.73966666666666, 13.433999999999997, 24.613999999999976, 49.63433333333336, 16.22266666666666, 21.817333333333327, 60.71633333333332, 16.037000000000003, 32.91833333333332, 40.402333333333345, 44.84433333333335, 25.34733333333333, 18.900666666666663, 18.543999999999993, 26.512999999999987, 35.65099999999998, 36.739666666666665, 31.787666666666656, 26.671999999999993, 32.844666666666654, 20.682000000000002, 49.1616666666667, 35.09933333333333, 16.64433333333333, 17.28933333333333, 20.440333333333314, 18.60566666666666, 17.585333333333327, 16.328666666666663, 25.65799999999999, 30.863999999999987, 21.199999999999985, 38.903000000000006, 14.76733333333333, 24.105333333333324, 24.666333333333327, 21.091000000000005, 31.39833333333332, 32.93199999999998, 30.76733333333332, 22.222999999999992, 56.770333333333355, 55.58733333333331, 17.053999999999995, 36.23033333333333, 40.20700000000003, 30.28300000000001, 18.29866666666666, 15.805999999999996, 33.54699999999998, 22.97499999999998, 25.167, 24.042666666666662, 23.89666666666665, 65.71933333333338, 27.326999999999984, 30.004999999999992, 20.886, 32.886333333333326, 27.133333333333326, 27.56533333333333, 41.18733333333333, 15.89833333333333, 16.03233333333333, 26.05166666666666, 47.56266666666665, 14.621333333333332, 35.19099999999999, 31.511666666666663, 21.430666666666653, 42.679999999999964, 15.848333333333326, 21.781999999999996, 24.48066666666665, 15.945333333333332, 43.88699999999998, 16.392333333333326, 17.522666666666666, 20.78499999999999, 16.822666666666663, 18.646999999999995, 32.36666666666665, 33.67499999999997, 21.224999999999994, 24.250333333333323, 17.491999999999994, 14.347333333333328, 30.15733333333332, 35.47499999999999, 40.435, 16.570999999999994, 40.492666666666665, 21.93333333333333, 18.727, 17.265333333333324, 25.501666666666665, 43.06500000000002, 35.20133333333331, 14.284666666666666], "episode_lengths": [35, 40, 29, 92, 89, 34, 45, 117, 30, 60, 68, 95, 46, 42, 38, 64, 99, 76, 67, 57, 79, 43, 84, 61, 34, 39, 57, 39, 40, 43, 56, 72, 54, 77, 36, 86, 55, 43, 76, 92, 66, 52, 102, 98, 36, 84, 76, 54, 39, 45, 70, 63, 56, 58, 76, 110, 75, 68, 43, 96, 59, 48, 87, 39, 37, 63, 94, 30, 87, 77, 60, 103, 50, 49, 52, 32, 103, 33, 47, 39, 34, 42, 89, 92, 39, 60, 45, 30, 54, 77, 81, 37, 75, 44, 37, 40, 63, 78, 71, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.542410004191744, "mean_inference_ms": 2.9472869423444674, "mean_action_processing_ms": 0.5913580715380022, "mean_env_wait_ms": 0.14399866578004616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020032167434692383, "StateBufferConnector_ms": 0.009371757507324219, "ViewRequirementAgentConnector_ms": 0.31383609771728516}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.5084023702087, "num_env_steps_trained_throughput_per_sec": 729.5084023702087, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 7408.252, "sample_time_ms": 2527.51, "load_time_ms": 0.542, "load_throughput": 7373628.093, "learn_time_ms": 4855.604, "learn_throughput": 823.79, "synch_weights_time_ms": 22.542}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 9769, "training_iteration": 134, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-29", "timestamp": 1702018649, "time_this_iter_s": 5.4951393604278564, "time_total_s": 22298.173423051834, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22298.173423051834, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 69.89999999999999, "ram_util_percent": 91.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.484386557990835e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 5.381261348724365, "policy_loss": -0.0035108376760035753, "vf_loss": 5.384772777557373, "vf_explained_var": 0.620549201965332, "kl": 0.0035742258187383413, "entropy": 0.11545009911060333, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 125085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 52.003333333333295, "episode_reward_min": 12.255333333333335, "episode_reward_mean": 25.493543333333324, "episode_len_mean": 57.18, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.19099999999999, 31.511666666666663, 21.430666666666653, 42.679999999999964, 15.848333333333326, 21.781999999999996, 24.48066666666665, 15.945333333333332, 43.88699999999998, 16.392333333333326, 17.522666666666666, 20.78499999999999, 16.822666666666663, 18.646999999999995, 32.36666666666665, 33.67499999999997, 21.224999999999994, 24.250333333333323, 17.491999999999994, 14.347333333333328, 30.15733333333332, 35.47499999999999, 40.435, 16.570999999999994, 40.492666666666665, 21.93333333333333, 18.727, 17.265333333333324, 25.501666666666665, 43.06500000000002, 35.20133333333331, 14.284666666666666, 34.08366666666664, 41.140666666666654, 20.236666666666665, 14.799333333333328, 47.78333333333332, 20.18433333333332, 20.909333333333326, 45.573000000000015, 22.528333333333332, 15.282999999999994, 33.91233333333333, 36.93866666666665, 21.628666666666646, 18.352666666666664, 26.59266666666665, 15.041666666666664, 20.578666666666667, 24.825666666666653, 20.467333333333325, 45.12333333333334, 16.056666666666665, 17.513666666666666, 27.33566666666665, 22.872333333333327, 30.147999999999982, 14.362666666666662, 14.520999999999997, 20.33566666666667, 27.22666666666664, 22.944666666666663, 26.38666666666666, 28.06833333333332, 18.705666666666666, 18.067999999999994, 36.27599999999999, 13.744999999999997, 50.783, 34.598333333333336, 31.343999999999987, 30.526333333333326, 32.53833333333333, 14.501666666666669, 28.97066666666664, 16.401999999999997, 29.63033333333332, 16.671000000000003, 16.198333333333323, 21.41499999999999, 37.965999999999994, 44.73199999999999, 18.551999999999985, 26.982, 17.314999999999994, 13.102333333333329, 15.678666666666663, 27.157666666666657, 23.376333333333328, 21.90133333333333, 23.74233333333332, 25.688333333333322, 52.003333333333295, 12.255333333333335, 40.403666666666666, 32.52299999999998, 16.259333333333327, 16.725333333333328, 17.99566666666666, 15.473666666666666], "episode_lengths": [87, 77, 60, 103, 50, 49, 52, 32, 103, 33, 47, 39, 34, 42, 89, 92, 39, 60, 45, 30, 54, 77, 81, 37, 75, 44, 37, 40, 63, 78, 71, 29, 94, 124, 49, 36, 103, 53, 51, 76, 51, 35, 68, 70, 54, 34, 73, 29, 47, 66, 57, 86, 33, 35, 79, 57, 61, 33, 36, 44, 71, 50, 61, 60, 38, 40, 58, 30, 88, 64, 78, 67, 77, 32, 94, 36, 78, 36, 36, 44, 65, 84, 49, 55, 41, 28, 38, 63, 53, 43, 49, 48, 118, 25, 97, 92, 36, 43, 38, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5380423754747985, "mean_inference_ms": 2.93823686565555, "mean_action_processing_ms": 0.5896723867925449, "mean_env_wait_ms": 0.143544470321765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01945638656616211, "StateBufferConnector_ms": 0.010332107543945312, "ViewRequirementAgentConnector_ms": 0.31865859031677246}}, "episode_reward_max": 52.003333333333295, "episode_reward_min": 12.255333333333335, "episode_reward_mean": 25.493543333333324, "episode_len_mean": 57.18, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.19099999999999, 31.511666666666663, 21.430666666666653, 42.679999999999964, 15.848333333333326, 21.781999999999996, 24.48066666666665, 15.945333333333332, 43.88699999999998, 16.392333333333326, 17.522666666666666, 20.78499999999999, 16.822666666666663, 18.646999999999995, 32.36666666666665, 33.67499999999997, 21.224999999999994, 24.250333333333323, 17.491999999999994, 14.347333333333328, 30.15733333333332, 35.47499999999999, 40.435, 16.570999999999994, 40.492666666666665, 21.93333333333333, 18.727, 17.265333333333324, 25.501666666666665, 43.06500000000002, 35.20133333333331, 14.284666666666666, 34.08366666666664, 41.140666666666654, 20.236666666666665, 14.799333333333328, 47.78333333333332, 20.18433333333332, 20.909333333333326, 45.573000000000015, 22.528333333333332, 15.282999999999994, 33.91233333333333, 36.93866666666665, 21.628666666666646, 18.352666666666664, 26.59266666666665, 15.041666666666664, 20.578666666666667, 24.825666666666653, 20.467333333333325, 45.12333333333334, 16.056666666666665, 17.513666666666666, 27.33566666666665, 22.872333333333327, 30.147999999999982, 14.362666666666662, 14.520999999999997, 20.33566666666667, 27.22666666666664, 22.944666666666663, 26.38666666666666, 28.06833333333332, 18.705666666666666, 18.067999999999994, 36.27599999999999, 13.744999999999997, 50.783, 34.598333333333336, 31.343999999999987, 30.526333333333326, 32.53833333333333, 14.501666666666669, 28.97066666666664, 16.401999999999997, 29.63033333333332, 16.671000000000003, 16.198333333333323, 21.41499999999999, 37.965999999999994, 44.73199999999999, 18.551999999999985, 26.982, 17.314999999999994, 13.102333333333329, 15.678666666666663, 27.157666666666657, 23.376333333333328, 21.90133333333333, 23.74233333333332, 25.688333333333322, 52.003333333333295, 12.255333333333335, 40.403666666666666, 32.52299999999998, 16.259333333333327, 16.725333333333328, 17.99566666666666, 15.473666666666666], "episode_lengths": [87, 77, 60, 103, 50, 49, 52, 32, 103, 33, 47, 39, 34, 42, 89, 92, 39, 60, 45, 30, 54, 77, 81, 37, 75, 44, 37, 40, 63, 78, 71, 29, 94, 124, 49, 36, 103, 53, 51, 76, 51, 35, 68, 70, 54, 34, 73, 29, 47, 66, 57, 86, 33, 35, 79, 57, 61, 33, 36, 44, 71, 50, 61, 60, 38, 40, 58, 30, 88, 64, 78, 67, 77, 32, 94, 36, 78, 36, 36, 44, 65, 84, 49, 55, 41, 28, 38, 63, 53, 43, 49, 48, 118, 25, 97, 92, 36, 43, 38, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5380423754747985, "mean_inference_ms": 2.93823686565555, "mean_action_processing_ms": 0.5896723867925449, "mean_env_wait_ms": 0.143544470321765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01945638656616211, "StateBufferConnector_ms": 0.010332107543945312, "ViewRequirementAgentConnector_ms": 0.31865859031677246}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 731.3015526739566, "num_env_steps_trained_throughput_per_sec": 731.3015526739566, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 7094.598, "sample_time_ms": 2435.468, "load_time_ms": 0.542, "load_throughput": 7378816.906, "learn_time_ms": 4635.518, "learn_throughput": 862.903, "synch_weights_time_ms": 20.935}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 9837, "training_iteration": 135, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-35", "timestamp": 1702018655, "time_this_iter_s": 5.479708433151245, "time_total_s": 22303.653131484985, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22303.653131484985, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 67.03750000000001, "ram_util_percent": 91.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7421932789954174e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 5.473821640014648, "policy_loss": -0.007872877642512321, "vf_loss": 5.481694221496582, "vf_explained_var": 0.6240682005882263, "kl": 0.004219724331051111, "entropy": 0.10886967182159424, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": 54.63433333333338, "episode_reward_min": 12.255333333333335, "episode_reward_mean": 26.285783333333328, "episode_len_mean": 57.67, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.343999999999987, 30.526333333333326, 32.53833333333333, 14.501666666666669, 28.97066666666664, 16.401999999999997, 29.63033333333332, 16.671000000000003, 16.198333333333323, 21.41499999999999, 37.965999999999994, 44.73199999999999, 18.551999999999985, 26.982, 17.314999999999994, 13.102333333333329, 15.678666666666663, 27.157666666666657, 23.376333333333328, 21.90133333333333, 23.74233333333332, 25.688333333333322, 52.003333333333295, 12.255333333333335, 40.403666666666666, 32.52299999999998, 16.259333333333327, 16.725333333333328, 17.99566666666666, 15.473666666666666, 20.851, 29.81733333333332, 36.686666666666675, 15.030333333333331, 30.959, 39.32933333333334, 39.08799999999999, 16.218999999999994, 21.982999999999993, 18.13666666666666, 39.903, 19.545, 37.929999999999986, 23.190999999999992, 17.035333333333327, 36.23133333333331, 47.08566666666669, 20.569333333333336, 21.68133333333334, 24.890333333333317, 16.883333333333333, 26.19199999999999, 54.63433333333338, 17.814999999999998, 36.509, 21.025000000000002, 44.392333333333326, 49.83566666666667, 16.222999999999995, 50.18566666666665, 16.525999999999996, 12.927999999999999, 15.84033333333333, 26.524333333333324, 15.961999999999996, 20.548666666666666, 54.03633333333336, 23.565666666666665, 46.46166666666668, 15.97233333333333, 48.63866666666669, 16.717, 25.44366666666665, 21.24633333333333, 26.14833333333333, 36.78166666666664, 19.458666666666662, 18.42966666666666, 21.517999999999994, 17.63233333333334, 18.287333333333326, 18.587666666666664, 19.086333333333332, 40.28366666666667, 16.15533333333333, 18.063666666666652, 20.432333333333325, 33.41133333333332, 22.592666666666656, 35.68866666666666, 25.20733333333332, 16.156333333333325, 29.637999999999998, 38.74133333333333, 16.028999999999996, 19.636666666666656, 30.840999999999994, 36.24133333333333, 28.285999999999987, 16.94366666666666], "episode_lengths": [78, 67, 77, 32, 94, 36, 78, 36, 36, 44, 65, 84, 49, 55, 41, 28, 38, 63, 53, 43, 49, 48, 118, 25, 97, 92, 36, 43, 38, 32, 41, 53, 64, 42, 82, 73, 79, 33, 42, 41, 92, 34, 73, 52, 42, 89, 83, 41, 41, 60, 35, 59, 104, 36, 69, 56, 90, 97, 31, 99, 37, 26, 36, 66, 35, 50, 100, 49, 89, 39, 81, 34, 68, 54, 65, 105, 42, 56, 48, 46, 39, 36, 47, 82, 34, 56, 40, 86, 54, 78, 58, 35, 66, 89, 40, 60, 70, 80, 48, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5333580888088847, "mean_inference_ms": 2.9287280280527614, "mean_action_processing_ms": 0.588314317720262, "mean_env_wait_ms": 0.14318911771354265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01933121681213379, "StateBufferConnector_ms": 0.010239601135253906, "ViewRequirementAgentConnector_ms": 0.3079521656036377}}, "episode_reward_max": 54.63433333333338, "episode_reward_min": 12.255333333333335, "episode_reward_mean": 26.285783333333328, "episode_len_mean": 57.67, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.343999999999987, 30.526333333333326, 32.53833333333333, 14.501666666666669, 28.97066666666664, 16.401999999999997, 29.63033333333332, 16.671000000000003, 16.198333333333323, 21.41499999999999, 37.965999999999994, 44.73199999999999, 18.551999999999985, 26.982, 17.314999999999994, 13.102333333333329, 15.678666666666663, 27.157666666666657, 23.376333333333328, 21.90133333333333, 23.74233333333332, 25.688333333333322, 52.003333333333295, 12.255333333333335, 40.403666666666666, 32.52299999999998, 16.259333333333327, 16.725333333333328, 17.99566666666666, 15.473666666666666, 20.851, 29.81733333333332, 36.686666666666675, 15.030333333333331, 30.959, 39.32933333333334, 39.08799999999999, 16.218999999999994, 21.982999999999993, 18.13666666666666, 39.903, 19.545, 37.929999999999986, 23.190999999999992, 17.035333333333327, 36.23133333333331, 47.08566666666669, 20.569333333333336, 21.68133333333334, 24.890333333333317, 16.883333333333333, 26.19199999999999, 54.63433333333338, 17.814999999999998, 36.509, 21.025000000000002, 44.392333333333326, 49.83566666666667, 16.222999999999995, 50.18566666666665, 16.525999999999996, 12.927999999999999, 15.84033333333333, 26.524333333333324, 15.961999999999996, 20.548666666666666, 54.03633333333336, 23.565666666666665, 46.46166666666668, 15.97233333333333, 48.63866666666669, 16.717, 25.44366666666665, 21.24633333333333, 26.14833333333333, 36.78166666666664, 19.458666666666662, 18.42966666666666, 21.517999999999994, 17.63233333333334, 18.287333333333326, 18.587666666666664, 19.086333333333332, 40.28366666666667, 16.15533333333333, 18.063666666666652, 20.432333333333325, 33.41133333333332, 22.592666666666656, 35.68866666666666, 25.20733333333332, 16.156333333333325, 29.637999999999998, 38.74133333333333, 16.028999999999996, 19.636666666666656, 30.840999999999994, 36.24133333333333, 28.285999999999987, 16.94366666666666], "episode_lengths": [78, 67, 77, 32, 94, 36, 78, 36, 36, 44, 65, 84, 49, 55, 41, 28, 38, 63, 53, 43, 49, 48, 118, 25, 97, 92, 36, 43, 38, 32, 41, 53, 64, 42, 82, 73, 79, 33, 42, 41, 92, 34, 73, 52, 42, 89, 83, 41, 41, 60, 35, 59, 104, 36, 69, 56, 90, 97, 31, 99, 37, 26, 36, 66, 35, 50, 100, 49, 89, 39, 81, 34, 68, 54, 65, 105, 42, 56, 48, 46, 39, 36, 47, 82, 34, 56, 40, 86, 54, 78, 58, 35, 66, 89, 40, 60, 70, 80, 48, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5333580888088847, "mean_inference_ms": 2.9287280280527614, "mean_action_processing_ms": 0.588314317720262, "mean_env_wait_ms": 0.14318911771354265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01933121681213379, "StateBufferConnector_ms": 0.010239601135253906, "ViewRequirementAgentConnector_ms": 0.3079521656036377}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 760.8360372512356, "num_env_steps_trained_throughput_per_sec": 760.8360372512356, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 6769.504, "sample_time_ms": 2344.242, "load_time_ms": 0.542, "load_throughput": 7378816.906, "learn_time_ms": 4403.244, "learn_throughput": 908.421, "synch_weights_time_ms": 19.35}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 9907, "training_iteration": 136, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-40", "timestamp": 1702018660, "time_this_iter_s": 5.267378091812134, "time_total_s": 22308.920509576797, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22308.920509576797, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 66.50000000000001, "ram_util_percent": 90.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3710966394977087e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 5.401784896850586, "policy_loss": -0.0037399933207780123, "vf_loss": 5.405524730682373, "vf_explained_var": 0.6360553503036499, "kl": 0.002620703773573041, "entropy": 0.11135490238666534, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": 84.43866666666663, "episode_reward_min": 13.436666666666666, "episode_reward_mean": 24.978449999999988, "episode_len_mean": 54.52, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.14833333333333, 36.78166666666664, 19.458666666666662, 18.42966666666666, 21.517999999999994, 17.63233333333334, 18.287333333333326, 18.587666666666664, 19.086333333333332, 40.28366666666667, 16.15533333333333, 18.063666666666652, 20.432333333333325, 33.41133333333332, 22.592666666666656, 35.68866666666666, 25.20733333333332, 16.156333333333325, 29.637999999999998, 38.74133333333333, 16.028999999999996, 19.636666666666656, 30.840999999999994, 36.24133333333333, 28.285999999999987, 16.94366666666666, 36.06266666666666, 35.42233333333332, 21.279333333333323, 16.13833333333332, 25.639666666666663, 15.603000000000002, 25.983333333333338, 15.182333333333332, 17.30933333333332, 21.908999999999985, 22.43499999999999, 22.356999999999992, 14.095999999999995, 14.604999999999999, 24.72666666666666, 40.30866666666663, 24.56766666666667, 13.436666666666666, 18.524333333333317, 36.09233333333332, 22.604333333333336, 27.695666666666646, 19.341333333333324, 31.728333333333335, 84.43866666666663, 16.982666666666667, 19.700999999999986, 48.98900000000002, 16.43766666666666, 37.93566666666665, 13.945999999999994, 16.86233333333333, 21.529333333333323, 37.80033333333333, 33.35733333333332, 29.270999999999983, 17.926666666666662, 16.74433333333333, 15.892666666666669, 20.84266666666666, 18.20733333333332, 35.214666666666645, 16.688333333333325, 25.830666666666655, 21.751333333333335, 20.302000000000003, 42.13466666666666, 20.525333333333325, 23.104666666666663, 20.365666666666662, 19.307333333333332, 21.088333333333324, 29.867333333333324, 31.55666666666667, 15.522666666666662, 19.084999999999994, 25.853666666666665, 23.094666666666654, 24.815666666666665, 16.04066666666666, 24.164333333333328, 17.861999999999995, 14.855333333333334, 22.54833333333332, 27.718333333333327, 29.473, 17.255999999999993, 39.00633333333335, 23.29033333333333, 41.08333333333333, 16.021333333333335, 14.41233333333333, 47.59566666666665, 40.21766666666668], "episode_lengths": [65, 105, 42, 56, 48, 46, 39, 36, 47, 82, 34, 56, 40, 86, 54, 78, 58, 35, 66, 89, 40, 60, 70, 80, 48, 35, 65, 88, 52, 42, 48, 32, 44, 38, 42, 45, 44, 47, 31, 30, 59, 95, 42, 27, 43, 69, 41, 75, 36, 54, 163, 40, 46, 95, 42, 79, 28, 40, 55, 76, 84, 83, 41, 34, 31, 46, 39, 81, 41, 50, 40, 37, 99, 49, 52, 44, 33, 57, 49, 73, 31, 39, 62, 52, 51, 33, 56, 36, 30, 46, 58, 50, 46, 79, 47, 76, 30, 30, 92, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5289306514367025, "mean_inference_ms": 2.919429484182591, "mean_action_processing_ms": 0.5871029005655064, "mean_env_wait_ms": 0.1427528899091429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012875080108642578, "StateBufferConnector_ms": 0.008471488952636719, "ViewRequirementAgentConnector_ms": 0.33257412910461426}}, "episode_reward_max": 84.43866666666663, "episode_reward_min": 13.436666666666666, "episode_reward_mean": 24.978449999999988, "episode_len_mean": 54.52, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.14833333333333, 36.78166666666664, 19.458666666666662, 18.42966666666666, 21.517999999999994, 17.63233333333334, 18.287333333333326, 18.587666666666664, 19.086333333333332, 40.28366666666667, 16.15533333333333, 18.063666666666652, 20.432333333333325, 33.41133333333332, 22.592666666666656, 35.68866666666666, 25.20733333333332, 16.156333333333325, 29.637999999999998, 38.74133333333333, 16.028999999999996, 19.636666666666656, 30.840999999999994, 36.24133333333333, 28.285999999999987, 16.94366666666666, 36.06266666666666, 35.42233333333332, 21.279333333333323, 16.13833333333332, 25.639666666666663, 15.603000000000002, 25.983333333333338, 15.182333333333332, 17.30933333333332, 21.908999999999985, 22.43499999999999, 22.356999999999992, 14.095999999999995, 14.604999999999999, 24.72666666666666, 40.30866666666663, 24.56766666666667, 13.436666666666666, 18.524333333333317, 36.09233333333332, 22.604333333333336, 27.695666666666646, 19.341333333333324, 31.728333333333335, 84.43866666666663, 16.982666666666667, 19.700999999999986, 48.98900000000002, 16.43766666666666, 37.93566666666665, 13.945999999999994, 16.86233333333333, 21.529333333333323, 37.80033333333333, 33.35733333333332, 29.270999999999983, 17.926666666666662, 16.74433333333333, 15.892666666666669, 20.84266666666666, 18.20733333333332, 35.214666666666645, 16.688333333333325, 25.830666666666655, 21.751333333333335, 20.302000000000003, 42.13466666666666, 20.525333333333325, 23.104666666666663, 20.365666666666662, 19.307333333333332, 21.088333333333324, 29.867333333333324, 31.55666666666667, 15.522666666666662, 19.084999999999994, 25.853666666666665, 23.094666666666654, 24.815666666666665, 16.04066666666666, 24.164333333333328, 17.861999999999995, 14.855333333333334, 22.54833333333332, 27.718333333333327, 29.473, 17.255999999999993, 39.00633333333335, 23.29033333333333, 41.08333333333333, 16.021333333333335, 14.41233333333333, 47.59566666666665, 40.21766666666668], "episode_lengths": [65, 105, 42, 56, 48, 46, 39, 36, 47, 82, 34, 56, 40, 86, 54, 78, 58, 35, 66, 89, 40, 60, 70, 80, 48, 35, 65, 88, 52, 42, 48, 32, 44, 38, 42, 45, 44, 47, 31, 30, 59, 95, 42, 27, 43, 69, 41, 75, 36, 54, 163, 40, 46, 95, 42, 79, 28, 40, 55, 76, 84, 83, 41, 34, 31, 46, 39, 81, 41, 50, 40, 37, 99, 49, 52, 44, 33, 57, 49, 73, 31, 39, 62, 52, 51, 33, 56, 36, 30, 46, 58, 50, 46, 79, 47, 76, 30, 30, 92, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5289306514367025, "mean_inference_ms": 2.919429484182591, "mean_action_processing_ms": 0.5871029005655064, "mean_env_wait_ms": 0.1427528899091429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012875080108642578, "StateBufferConnector_ms": 0.008471488952636719, "ViewRequirementAgentConnector_ms": 0.33257412910461426}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 767.6630463380286, "num_env_steps_trained_throughput_per_sec": 767.6630463380286, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 6394.975, "sample_time_ms": 2253.395, "load_time_ms": 0.542, "load_throughput": 7378816.906, "learn_time_ms": 4119.915, "learn_throughput": 970.894, "synch_weights_time_ms": 19.171}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 9981, "training_iteration": 137, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-46", "timestamp": 1702018666, "time_this_iter_s": 5.226175308227539, "time_total_s": 22314.146684885025, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22314.146684885025, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 65.075, "ram_util_percent": 91.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.855483197488543e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 6.045383453369141, "policy_loss": -0.007053521927446127, "vf_loss": 6.0524373054504395, "vf_explained_var": 0.548587441444397, "kl": 0.0016618319787085056, "entropy": 0.09471550583839417, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 127875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 70.24300000000004, "episode_reward_min": 14.41233333333333, "episode_reward_mean": 27.45311666666666, "episode_len_mean": 59.27, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.74433333333333, 15.892666666666669, 20.84266666666666, 18.20733333333332, 35.214666666666645, 16.688333333333325, 25.830666666666655, 21.751333333333335, 20.302000000000003, 42.13466666666666, 20.525333333333325, 23.104666666666663, 20.365666666666662, 19.307333333333332, 21.088333333333324, 29.867333333333324, 31.55666666666667, 15.522666666666662, 19.084999999999994, 25.853666666666665, 23.094666666666654, 24.815666666666665, 16.04066666666666, 24.164333333333328, 17.861999999999995, 14.855333333333334, 22.54833333333332, 27.718333333333327, 29.473, 17.255999999999993, 39.00633333333335, 23.29033333333333, 41.08333333333333, 16.021333333333335, 14.41233333333333, 47.59566666666665, 40.21766666666668, 28.621333333333318, 27.264333333333333, 21.41733333333333, 22.434666666666665, 48.53866666666667, 19.326, 15.95933333333333, 16.975333333333325, 38.70899999999999, 17.409666666666663, 38.11933333333332, 28.06233333333332, 27.585333333333327, 21.999999999999996, 22.758333333333333, 19.049666666666667, 30.532333333333334, 23.355999999999995, 34.39666666666664, 21.119666666666667, 37.421666666666646, 35.10033333333334, 50.32366666666664, 49.01900000000004, 28.18866666666665, 21.528666666666663, 30.238333333333294, 15.560999999999993, 15.793999999999999, 19.644000000000002, 49.96133333333338, 30.82733333333333, 19.059, 46.593, 20.518666666666654, 19.462666666666664, 27.584999999999997, 42.42366666666666, 24.639666666666663, 70.24300000000004, 39.25466666666667, 24.767999999999994, 26.31, 29.85666666666668, 35.187333333333335, 48.96199999999997, 26.06433333333333, 18.206666666666656, 42.321999999999996, 22.837666666666653, 36.56100000000001, 20.231999999999996, 24.478000000000005, 25.45133333333333, 34.73066666666666, 29.216333333333328, 16.129666666666665, 26.990333333333314, 19.253333333333323, 18.584666666666653, 31.796333333333333, 29.277000000000008, 41.73299999999999], "episode_lengths": [34, 31, 46, 39, 81, 41, 50, 40, 37, 99, 49, 52, 44, 33, 57, 49, 73, 31, 39, 62, 52, 51, 33, 56, 36, 30, 46, 58, 50, 46, 79, 47, 76, 30, 30, 92, 97, 61, 58, 53, 45, 91, 47, 31, 33, 62, 40, 92, 81, 49, 39, 42, 39, 66, 41, 69, 56, 74, 86, 111, 95, 75, 51, 80, 34, 30, 43, 87, 59, 37, 97, 66, 40, 52, 72, 61, 140, 75, 48, 53, 69, 91, 133, 59, 38, 96, 53, 73, 46, 57, 51, 89, 61, 47, 68, 55, 59, 54, 64, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.526413920187435, "mean_inference_ms": 2.9140045832938894, "mean_action_processing_ms": 0.5858886380637262, "mean_env_wait_ms": 0.14243267087435899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018348217010498047, "StateBufferConnector_ms": 0.008608579635620117, "ViewRequirementAgentConnector_ms": 0.3827688694000244}}, "episode_reward_max": 70.24300000000004, "episode_reward_min": 14.41233333333333, "episode_reward_mean": 27.45311666666666, "episode_len_mean": 59.27, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.74433333333333, 15.892666666666669, 20.84266666666666, 18.20733333333332, 35.214666666666645, 16.688333333333325, 25.830666666666655, 21.751333333333335, 20.302000000000003, 42.13466666666666, 20.525333333333325, 23.104666666666663, 20.365666666666662, 19.307333333333332, 21.088333333333324, 29.867333333333324, 31.55666666666667, 15.522666666666662, 19.084999999999994, 25.853666666666665, 23.094666666666654, 24.815666666666665, 16.04066666666666, 24.164333333333328, 17.861999999999995, 14.855333333333334, 22.54833333333332, 27.718333333333327, 29.473, 17.255999999999993, 39.00633333333335, 23.29033333333333, 41.08333333333333, 16.021333333333335, 14.41233333333333, 47.59566666666665, 40.21766666666668, 28.621333333333318, 27.264333333333333, 21.41733333333333, 22.434666666666665, 48.53866666666667, 19.326, 15.95933333333333, 16.975333333333325, 38.70899999999999, 17.409666666666663, 38.11933333333332, 28.06233333333332, 27.585333333333327, 21.999999999999996, 22.758333333333333, 19.049666666666667, 30.532333333333334, 23.355999999999995, 34.39666666666664, 21.119666666666667, 37.421666666666646, 35.10033333333334, 50.32366666666664, 49.01900000000004, 28.18866666666665, 21.528666666666663, 30.238333333333294, 15.560999999999993, 15.793999999999999, 19.644000000000002, 49.96133333333338, 30.82733333333333, 19.059, 46.593, 20.518666666666654, 19.462666666666664, 27.584999999999997, 42.42366666666666, 24.639666666666663, 70.24300000000004, 39.25466666666667, 24.767999999999994, 26.31, 29.85666666666668, 35.187333333333335, 48.96199999999997, 26.06433333333333, 18.206666666666656, 42.321999999999996, 22.837666666666653, 36.56100000000001, 20.231999999999996, 24.478000000000005, 25.45133333333333, 34.73066666666666, 29.216333333333328, 16.129666666666665, 26.990333333333314, 19.253333333333323, 18.584666666666653, 31.796333333333333, 29.277000000000008, 41.73299999999999], "episode_lengths": [34, 31, 46, 39, 81, 41, 50, 40, 37, 99, 49, 52, 44, 33, 57, 49, 73, 31, 39, 62, 52, 51, 33, 56, 36, 30, 46, 58, 50, 46, 79, 47, 76, 30, 30, 92, 97, 61, 58, 53, 45, 91, 47, 31, 33, 62, 40, 92, 81, 49, 39, 42, 39, 66, 41, 69, 56, 74, 86, 111, 95, 75, 51, 80, 34, 30, 43, 87, 59, 37, 97, 66, 40, 52, 72, 61, 140, 75, 48, 53, 69, 91, 133, 59, 38, 96, 53, 73, 46, 57, 51, 89, 61, 47, 68, 55, 59, 54, 64, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.526413920187435, "mean_inference_ms": 2.9140045832938894, "mean_action_processing_ms": 0.5858886380637262, "mean_env_wait_ms": 0.14243267087435899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018348217010498047, "StateBufferConnector_ms": 0.008608579635620117, "ViewRequirementAgentConnector_ms": 0.3827688694000244}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.231585806939, "num_env_steps_trained_throughput_per_sec": 730.231585806939, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 6078.565, "sample_time_ms": 2181.1, "load_time_ms": 0.542, "load_throughput": 7378816.906, "learn_time_ms": 3875.702, "learn_throughput": 1032.071, "synch_weights_time_ms": 19.288}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 10044, "training_iteration": 138, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-51", "timestamp": 1702018671, "time_this_iter_s": 5.487735033035278, "time_total_s": 22319.63441991806, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22319.63441991806, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 71.34285714285714, "ram_util_percent": 90.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.427741598744272e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 5.505702972412109, "policy_loss": -0.0016877914313226938, "vf_loss": 5.50739049911499, "vf_explained_var": 0.580581784248352, "kl": 0.0014997158432379365, "entropy": 0.0961533859372139, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 128805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": 70.24300000000004, "episode_reward_min": 11.98533333333333, "episode_reward_mean": 27.802789999999995, "episode_len_mean": 61.5, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.82733333333333, 19.059, 46.593, 20.518666666666654, 19.462666666666664, 27.584999999999997, 42.42366666666666, 24.639666666666663, 70.24300000000004, 39.25466666666667, 24.767999999999994, 26.31, 29.85666666666668, 35.187333333333335, 48.96199999999997, 26.06433333333333, 18.206666666666656, 42.321999999999996, 22.837666666666653, 36.56100000000001, 20.231999999999996, 24.478000000000005, 25.45133333333333, 34.73066666666666, 29.216333333333328, 16.129666666666665, 26.990333333333314, 19.253333333333323, 18.584666666666653, 31.796333333333333, 29.277000000000008, 41.73299999999999, 35.33566666666666, 31.965999999999994, 14.678666666666661, 17.76566666666666, 20.63733333333333, 21.692999999999998, 31.403999999999993, 49.41833333333328, 52.54633333333336, 15.228333333333332, 15.363666666666665, 27.406666666666666, 16.027333333333335, 18.53366666666666, 34.53433333333332, 32.35033333333332, 20.227999999999987, 35.869, 16.739666666666665, 25.642, 22.599000000000004, 15.11366666666666, 17.038333333333323, 22.874333333333325, 28.420333333333303, 39.442666666666675, 17.485999999999994, 17.81666666666666, 55.93266666666665, 19.722999999999992, 55.491333333333365, 34.87899999999999, 16.804999999999993, 15.997666666666658, 14.37266666666666, 15.272333333333334, 22.473666666666656, 28.795666666666676, 18.12233333333333, 16.070666666666664, 53.721, 32.203999999999965, 20.505999999999997, 15.914666666666665, 23.632, 22.36633333333333, 19.141999999999996, 52.0133333333333, 15.956666666666667, 18.201999999999998, 23.650333333333325, 42.048000000000016, 46.216, 27.945666666666675, 34.57366666666667, 25.70766666666666, 35.16766666666668, 25.492000000000008, 20.142, 43.719, 22.52899999999999, 18.326333333333334, 23.94666666666665, 22.594333333333324, 27.326666666666643, 32.465, 11.98533333333333, 25.135666666666655], "episode_lengths": [59, 37, 97, 66, 40, 52, 72, 61, 140, 75, 48, 53, 69, 91, 133, 59, 38, 96, 53, 73, 46, 57, 51, 89, 61, 47, 68, 55, 59, 54, 64, 107, 85, 67, 30, 43, 39, 45, 69, 111, 97, 29, 30, 57, 33, 45, 86, 55, 49, 62, 41, 49, 51, 51, 33, 43, 85, 79, 39, 43, 105, 52, 89, 80, 38, 35, 31, 29, 55, 64, 35, 38, 110, 102, 42, 32, 63, 49, 47, 131, 38, 40, 60, 76, 105, 54, 72, 70, 78, 57, 37, 94, 67, 34, 57, 58, 73, 61, 27, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5234502269717973, "mean_inference_ms": 2.907469019725949, "mean_action_processing_ms": 0.5846112949769804, "mean_env_wait_ms": 0.14200559259063586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021157264709472656, "StateBufferConnector_ms": 0.010776281356811523, "ViewRequirementAgentConnector_ms": 0.370682954788208}}, "episode_reward_max": 70.24300000000004, "episode_reward_min": 11.98533333333333, "episode_reward_mean": 27.802789999999995, "episode_len_mean": 61.5, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.82733333333333, 19.059, 46.593, 20.518666666666654, 19.462666666666664, 27.584999999999997, 42.42366666666666, 24.639666666666663, 70.24300000000004, 39.25466666666667, 24.767999999999994, 26.31, 29.85666666666668, 35.187333333333335, 48.96199999999997, 26.06433333333333, 18.206666666666656, 42.321999999999996, 22.837666666666653, 36.56100000000001, 20.231999999999996, 24.478000000000005, 25.45133333333333, 34.73066666666666, 29.216333333333328, 16.129666666666665, 26.990333333333314, 19.253333333333323, 18.584666666666653, 31.796333333333333, 29.277000000000008, 41.73299999999999, 35.33566666666666, 31.965999999999994, 14.678666666666661, 17.76566666666666, 20.63733333333333, 21.692999999999998, 31.403999999999993, 49.41833333333328, 52.54633333333336, 15.228333333333332, 15.363666666666665, 27.406666666666666, 16.027333333333335, 18.53366666666666, 34.53433333333332, 32.35033333333332, 20.227999999999987, 35.869, 16.739666666666665, 25.642, 22.599000000000004, 15.11366666666666, 17.038333333333323, 22.874333333333325, 28.420333333333303, 39.442666666666675, 17.485999999999994, 17.81666666666666, 55.93266666666665, 19.722999999999992, 55.491333333333365, 34.87899999999999, 16.804999999999993, 15.997666666666658, 14.37266666666666, 15.272333333333334, 22.473666666666656, 28.795666666666676, 18.12233333333333, 16.070666666666664, 53.721, 32.203999999999965, 20.505999999999997, 15.914666666666665, 23.632, 22.36633333333333, 19.141999999999996, 52.0133333333333, 15.956666666666667, 18.201999999999998, 23.650333333333325, 42.048000000000016, 46.216, 27.945666666666675, 34.57366666666667, 25.70766666666666, 35.16766666666668, 25.492000000000008, 20.142, 43.719, 22.52899999999999, 18.326333333333334, 23.94666666666665, 22.594333333333324, 27.326666666666643, 32.465, 11.98533333333333, 25.135666666666655], "episode_lengths": [59, 37, 97, 66, 40, 52, 72, 61, 140, 75, 48, 53, 69, 91, 133, 59, 38, 96, 53, 73, 46, 57, 51, 89, 61, 47, 68, 55, 59, 54, 64, 107, 85, 67, 30, 43, 39, 45, 69, 111, 97, 29, 30, 57, 33, 45, 86, 55, 49, 62, 41, 49, 51, 51, 33, 43, 85, 79, 39, 43, 105, 52, 89, 80, 38, 35, 31, 29, 55, 64, 35, 38, 110, 102, 42, 32, 63, 49, 47, 131, 38, 40, 60, 76, 105, 54, 72, 70, 78, 57, 37, 94, 67, 34, 57, 58, 73, 61, 27, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5234502269717973, "mean_inference_ms": 2.907469019725949, "mean_action_processing_ms": 0.5846112949769804, "mean_env_wait_ms": 0.14200559259063586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021157264709472656, "StateBufferConnector_ms": 0.010776281356811523, "ViewRequirementAgentConnector_ms": 0.370682954788208}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 778.598303487836, "num_env_steps_trained_throughput_per_sec": 778.598303487836, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 5774.26, "sample_time_ms": 2117.316, "load_time_ms": 0.441, "load_throughput": 9061418.309, "learn_time_ms": 3636.48, "learn_throughput": 1099.965, "synch_weights_time_ms": 17.889}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 10112, "training_iteration": 139, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-57-56", "timestamp": 1702018676, "time_this_iter_s": 5.154454708099365, "time_total_s": 22324.78887462616, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22324.78887462616, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 66.78571428571429, "ram_util_percent": 90.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.713870799372136e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 5.06727933883667, "policy_loss": -0.0053435987792909145, "vf_loss": 5.072623252868652, "vf_explained_var": 0.5943430066108704, "kl": 0.0025558765046298504, "entropy": 0.09337176382541656, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 129735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": 57.77866666666669, "episode_reward_min": 11.98533333333333, "episode_reward_mean": 25.988576666666663, "episode_len_mean": 56.12, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.914666666666665, 23.632, 22.36633333333333, 19.141999999999996, 52.0133333333333, 15.956666666666667, 18.201999999999998, 23.650333333333325, 42.048000000000016, 46.216, 27.945666666666675, 34.57366666666667, 25.70766666666666, 35.16766666666668, 25.492000000000008, 20.142, 43.719, 22.52899999999999, 18.326333333333334, 23.94666666666665, 22.594333333333324, 27.326666666666643, 32.465, 11.98533333333333, 25.135666666666655, 16.65366666666666, 27.947999999999983, 36.65200000000001, 14.540666666666663, 24.98166666666665, 21.35266666666666, 44.473, 25.068333333333328, 42.49300000000001, 18.137666666666664, 45.731333333333325, 22.184999999999985, 26.986999999999995, 15.88466666666666, 19.005666666666663, 20.707666666666658, 17.789333333333328, 33.339666666666666, 18.863999999999987, 42.51166666666667, 19.84699999999999, 15.665333333333331, 16.98466666666666, 42.351999999999975, 34.012, 26.211666666666652, 14.215666666666666, 45.765666666666604, 15.870999999999997, 20.63633333333333, 28.584333333333333, 22.04033333333333, 18.451999999999988, 30.835666666666665, 21.15933333333333, 17.96266666666666, 21.78066666666665, 23.747666666666664, 16.677333333333326, 22.21533333333332, 26.988999999999994, 24.582333333333334, 36.515, 27.258333333333326, 35.32033333333334, 15.594333333333331, 19.374999999999993, 57.77866666666669, 24.867333333333335, 28.551666666666666, 21.941333333333333, 16.759, 18.725666666666665, 13.694333333333336, 19.23966666666666, 17.871666666666663, 30.500666666666657, 26.773666666666664, 38.10266666666666, 25.673999999999985, 16.367333333333328, 19.811666666666664, 16.163333333333327, 41.248333333333306, 31.42266666666666, 16.174999999999994, 17.33033333333332, 27.167666666666676, 53.751000000000026, 15.353333333333326, 18.084999999999997, 23.17766666666665, 23.857666666666667, 47.18766666666667, 19.122999999999998], "episode_lengths": [32, 63, 49, 47, 131, 38, 40, 60, 76, 105, 54, 72, 70, 78, 57, 37, 94, 67, 34, 57, 58, 73, 61, 27, 49, 37, 71, 59, 30, 64, 43, 81, 52, 89, 37, 79, 53, 57, 41, 53, 47, 38, 52, 39, 104, 50, 32, 34, 81, 62, 46, 32, 89, 35, 39, 52, 53, 55, 62, 52, 48, 53, 44, 37, 54, 55, 44, 81, 70, 66, 32, 39, 113, 60, 72, 51, 44, 34, 28, 43, 38, 54, 50, 84, 63, 34, 48, 43, 78, 62, 37, 42, 59, 119, 32, 38, 63, 48, 86, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5199114810733116, "mean_inference_ms": 2.900151975654103, "mean_action_processing_ms": 0.5833313954019936, "mean_env_wait_ms": 0.1417508525105225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018292665481567383, "StateBufferConnector_ms": 0.009721040725708008, "ViewRequirementAgentConnector_ms": 0.37627410888671875}}, "episode_reward_max": 57.77866666666669, "episode_reward_min": 11.98533333333333, "episode_reward_mean": 25.988576666666663, "episode_len_mean": 56.12, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.914666666666665, 23.632, 22.36633333333333, 19.141999999999996, 52.0133333333333, 15.956666666666667, 18.201999999999998, 23.650333333333325, 42.048000000000016, 46.216, 27.945666666666675, 34.57366666666667, 25.70766666666666, 35.16766666666668, 25.492000000000008, 20.142, 43.719, 22.52899999999999, 18.326333333333334, 23.94666666666665, 22.594333333333324, 27.326666666666643, 32.465, 11.98533333333333, 25.135666666666655, 16.65366666666666, 27.947999999999983, 36.65200000000001, 14.540666666666663, 24.98166666666665, 21.35266666666666, 44.473, 25.068333333333328, 42.49300000000001, 18.137666666666664, 45.731333333333325, 22.184999999999985, 26.986999999999995, 15.88466666666666, 19.005666666666663, 20.707666666666658, 17.789333333333328, 33.339666666666666, 18.863999999999987, 42.51166666666667, 19.84699999999999, 15.665333333333331, 16.98466666666666, 42.351999999999975, 34.012, 26.211666666666652, 14.215666666666666, 45.765666666666604, 15.870999999999997, 20.63633333333333, 28.584333333333333, 22.04033333333333, 18.451999999999988, 30.835666666666665, 21.15933333333333, 17.96266666666666, 21.78066666666665, 23.747666666666664, 16.677333333333326, 22.21533333333332, 26.988999999999994, 24.582333333333334, 36.515, 27.258333333333326, 35.32033333333334, 15.594333333333331, 19.374999999999993, 57.77866666666669, 24.867333333333335, 28.551666666666666, 21.941333333333333, 16.759, 18.725666666666665, 13.694333333333336, 19.23966666666666, 17.871666666666663, 30.500666666666657, 26.773666666666664, 38.10266666666666, 25.673999999999985, 16.367333333333328, 19.811666666666664, 16.163333333333327, 41.248333333333306, 31.42266666666666, 16.174999999999994, 17.33033333333332, 27.167666666666676, 53.751000000000026, 15.353333333333326, 18.084999999999997, 23.17766666666665, 23.857666666666667, 47.18766666666667, 19.122999999999998], "episode_lengths": [32, 63, 49, 47, 131, 38, 40, 60, 76, 105, 54, 72, 70, 78, 57, 37, 94, 67, 34, 57, 58, 73, 61, 27, 49, 37, 71, 59, 30, 64, 43, 81, 52, 89, 37, 79, 53, 57, 41, 53, 47, 38, 52, 39, 104, 50, 32, 34, 81, 62, 46, 32, 89, 35, 39, 52, 53, 55, 62, 52, 48, 53, 44, 37, 54, 55, 44, 81, 70, 66, 32, 39, 113, 60, 72, 51, 44, 34, 28, 43, 38, 54, 50, 84, 63, 34, 48, 43, 78, 62, 37, 42, 59, 119, 32, 38, 63, 48, 86, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5199114810733116, "mean_inference_ms": 2.900151975654103, "mean_action_processing_ms": 0.5833313954019936, "mean_env_wait_ms": 0.1417508525105225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018292665481567383, "StateBufferConnector_ms": 0.009721040725708008, "ViewRequirementAgentConnector_ms": 0.37627410888671875}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.1294161693096, "num_env_steps_trained_throughput_per_sec": 713.1294161693096, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 5547.092, "sample_time_ms": 2070.736, "load_time_ms": 0.541, "load_throughput": 7389867.418, "learn_time_ms": 3457.615, "learn_throughput": 1156.867, "synch_weights_time_ms": 16.369}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 10187, "training_iteration": 140, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-02", "timestamp": 1702018682, "time_this_iter_s": 5.622026443481445, "time_total_s": 22330.41090106964, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22330.41090106964, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 68.0, "ram_util_percent": 90.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.56935399686068e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 5.8324480056762695, "policy_loss": -0.006061614491045475, "vf_loss": 5.838509559631348, "vf_explained_var": 0.5516440272331238, "kl": 0.0042639984749257565, "entropy": 0.08481574803590775, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 130665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 71.68733333333344, "episode_reward_min": 13.459, "episode_reward_mean": 27.746019999999994, "episode_len_mean": 58.61, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.582333333333334, 36.515, 27.258333333333326, 35.32033333333334, 15.594333333333331, 19.374999999999993, 57.77866666666669, 24.867333333333335, 28.551666666666666, 21.941333333333333, 16.759, 18.725666666666665, 13.694333333333336, 19.23966666666666, 17.871666666666663, 30.500666666666657, 26.773666666666664, 38.10266666666666, 25.673999999999985, 16.367333333333328, 19.811666666666664, 16.163333333333327, 41.248333333333306, 31.42266666666666, 16.174999999999994, 17.33033333333332, 27.167666666666676, 53.751000000000026, 15.353333333333326, 18.084999999999997, 23.17766666666665, 23.857666666666667, 47.18766666666667, 19.122999999999998, 21.097666666666658, 26.751666666666647, 30.355666666666675, 22.469333333333324, 20.424333333333333, 19.52033333333333, 26.251999999999985, 19.906, 22.390666666666657, 30.138666666666662, 26.148333333333326, 26.748666666666654, 19.016, 20.300000000000008, 19.419333333333324, 32.27566666666667, 16.176333333333336, 46.934333333333306, 34.75433333333332, 56.13133333333333, 19.607999999999983, 25.943000000000012, 43.489666666666665, 15.77999999999999, 43.93433333333336, 40.13166666666667, 14.981333333333328, 32.75599999999999, 14.958666666666662, 17.085666666666658, 21.19233333333333, 29.18400000000001, 25.640666666666643, 15.131666666666662, 17.918999999999993, 21.041666666666664, 64.77133333333337, 16.371999999999993, 30.148666666666657, 32.69233333333334, 23.028333333333318, 16.557999999999996, 28.566999999999986, 42.06900000000002, 14.824666666666664, 23.160666666666657, 43.38466666666669, 16.535666666666657, 42.58100000000001, 39.453000000000024, 23.760333333333328, 26.48366666666666, 24.278666666666663, 16.790666666666667, 13.459, 24.912666666666656, 31.504666666666648, 34.70233333333332, 43.02733333333337, 26.384666666666647, 21.490666666666662, 53.765333333333295, 45.307333333333354, 71.68733333333344, 43.04800000000001, 18.51733333333333], "episode_lengths": [44, 81, 70, 66, 32, 39, 113, 60, 72, 51, 44, 34, 28, 43, 38, 54, 50, 84, 63, 34, 48, 43, 78, 62, 37, 42, 59, 119, 32, 38, 63, 48, 86, 37, 48, 52, 68, 51, 53, 37, 72, 37, 53, 72, 54, 50, 45, 48, 57, 61, 36, 85, 75, 114, 46, 41, 81, 40, 86, 70, 37, 51, 35, 35, 55, 64, 75, 33, 36, 48, 107, 37, 72, 58, 58, 35, 75, 67, 33, 53, 88, 33, 76, 86, 44, 54, 62, 42, 28, 51, 85, 57, 93, 75, 44, 115, 79, 139, 85, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.515862771387393, "mean_inference_ms": 2.89280331693736, "mean_action_processing_ms": 0.5821037042398854, "mean_env_wait_ms": 0.141363367731957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014611005783081055, "StateBufferConnector_ms": 0.0070269107818603516, "ViewRequirementAgentConnector_ms": 0.31694555282592773}}, "episode_reward_max": 71.68733333333344, "episode_reward_min": 13.459, "episode_reward_mean": 27.746019999999994, "episode_len_mean": 58.61, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.582333333333334, 36.515, 27.258333333333326, 35.32033333333334, 15.594333333333331, 19.374999999999993, 57.77866666666669, 24.867333333333335, 28.551666666666666, 21.941333333333333, 16.759, 18.725666666666665, 13.694333333333336, 19.23966666666666, 17.871666666666663, 30.500666666666657, 26.773666666666664, 38.10266666666666, 25.673999999999985, 16.367333333333328, 19.811666666666664, 16.163333333333327, 41.248333333333306, 31.42266666666666, 16.174999999999994, 17.33033333333332, 27.167666666666676, 53.751000000000026, 15.353333333333326, 18.084999999999997, 23.17766666666665, 23.857666666666667, 47.18766666666667, 19.122999999999998, 21.097666666666658, 26.751666666666647, 30.355666666666675, 22.469333333333324, 20.424333333333333, 19.52033333333333, 26.251999999999985, 19.906, 22.390666666666657, 30.138666666666662, 26.148333333333326, 26.748666666666654, 19.016, 20.300000000000008, 19.419333333333324, 32.27566666666667, 16.176333333333336, 46.934333333333306, 34.75433333333332, 56.13133333333333, 19.607999999999983, 25.943000000000012, 43.489666666666665, 15.77999999999999, 43.93433333333336, 40.13166666666667, 14.981333333333328, 32.75599999999999, 14.958666666666662, 17.085666666666658, 21.19233333333333, 29.18400000000001, 25.640666666666643, 15.131666666666662, 17.918999999999993, 21.041666666666664, 64.77133333333337, 16.371999999999993, 30.148666666666657, 32.69233333333334, 23.028333333333318, 16.557999999999996, 28.566999999999986, 42.06900000000002, 14.824666666666664, 23.160666666666657, 43.38466666666669, 16.535666666666657, 42.58100000000001, 39.453000000000024, 23.760333333333328, 26.48366666666666, 24.278666666666663, 16.790666666666667, 13.459, 24.912666666666656, 31.504666666666648, 34.70233333333332, 43.02733333333337, 26.384666666666647, 21.490666666666662, 53.765333333333295, 45.307333333333354, 71.68733333333344, 43.04800000000001, 18.51733333333333], "episode_lengths": [44, 81, 70, 66, 32, 39, 113, 60, 72, 51, 44, 34, 28, 43, 38, 54, 50, 84, 63, 34, 48, 43, 78, 62, 37, 42, 59, 119, 32, 38, 63, 48, 86, 37, 48, 52, 68, 51, 53, 37, 72, 37, 53, 72, 54, 50, 45, 48, 57, 61, 36, 85, 75, 114, 46, 41, 81, 40, 86, 70, 37, 51, 35, 35, 55, 64, 75, 33, 36, 48, 107, 37, 72, 58, 58, 35, 75, 67, 33, 53, 88, 33, 76, 86, 44, 54, 62, 42, 28, 51, 85, 57, 93, 75, 44, 115, 79, 139, 85, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.515862771387393, "mean_inference_ms": 2.89280331693736, "mean_action_processing_ms": 0.5821037042398854, "mean_env_wait_ms": 0.141363367731957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014611005783081055, "StateBufferConnector_ms": 0.0070269107818603516, "ViewRequirementAgentConnector_ms": 0.31694555282592773}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.6056462978798, "num_env_steps_trained_throughput_per_sec": 730.6056462978798, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 5260.627, "sample_time_ms": 1954.188, "load_time_ms": 0.6, "load_throughput": 6672187.711, "learn_time_ms": 3287.841, "learn_throughput": 1216.604, "synch_weights_time_ms": 16.076}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 10253, "training_iteration": 141, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-08", "timestamp": 1702018688, "time_this_iter_s": 5.485356330871582, "time_total_s": 22335.896257400513, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22335.896257400513, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 65.975, "ram_util_percent": 90.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.28467699843034e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 5.4998459815979, "policy_loss": -0.006596905179321766, "vf_loss": 5.506442070007324, "vf_explained_var": 0.5957791805267334, "kl": 0.006128660868853331, "entropy": 0.10273399949073792, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 131595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": 71.68733333333344, "episode_reward_min": 13.459, "episode_reward_mean": 28.710493333333332, "episode_len_mean": 59.47, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.77133333333337, 16.371999999999993, 30.148666666666657, 32.69233333333334, 23.028333333333318, 16.557999999999996, 28.566999999999986, 42.06900000000002, 14.824666666666664, 23.160666666666657, 43.38466666666669, 16.535666666666657, 42.58100000000001, 39.453000000000024, 23.760333333333328, 26.48366666666666, 24.278666666666663, 16.790666666666667, 13.459, 24.912666666666656, 31.504666666666648, 34.70233333333332, 43.02733333333337, 26.384666666666647, 21.490666666666662, 53.765333333333295, 45.307333333333354, 71.68733333333344, 43.04800000000001, 18.51733333333333, 33.21733333333333, 19.45366666666666, 20.992666666666658, 21.27366666666666, 43.89900000000001, 27.280333333333324, 14.525999999999996, 32.28466666666668, 30.82499999999999, 27.582, 25.408333333333324, 24.353333333333328, 26.24533333333333, 21.331333333333323, 56.154999999999994, 23.708999999999996, 33.367, 20.443666666666665, 20.30166666666666, 42.70133333333333, 35.192333333333316, 32.52099999999999, 15.854333333333331, 24.37066666666667, 20.371333333333332, 23.100333333333325, 16.109333333333332, 29.21399999999998, 49.6536666666667, 20.14233333333332, 31.953000000000007, 17.203333333333326, 27.273666666666667, 17.384666666666664, 54.26033333333337, 16.702333333333332, 23.244666666666667, 18.376666666666654, 19.92733333333333, 30.480999999999977, 65.31033333333336, 30.892666666666667, 24.938666666666663, 19.454333333333327, 53.699333333333364, 21.044666666666657, 21.566333333333333, 21.571666666666655, 37.28033333333336, 13.923666666666664, 17.92699999999999, 23.875999999999973, 27.42399999999999, 26.37966666666665, 57.52200000000002, 25.22499999999999, 31.19366666666666, 34.81366666666668, 18.67, 18.57133333333333, 20.53999999999999, 29.25866666666666, 19.17966666666666, 25.089666666666645, 26.362333333333325, 15.63466666666666, 17.285999999999994, 29.355666666666643, 18.269666666666662, 36.83566666666667], "episode_lengths": [107, 37, 72, 58, 58, 35, 75, 67, 33, 53, 88, 33, 76, 86, 44, 54, 62, 42, 28, 51, 85, 57, 93, 75, 44, 115, 79, 139, 85, 37, 70, 41, 42, 49, 74, 47, 28, 55, 70, 51, 60, 50, 45, 41, 100, 53, 70, 40, 45, 81, 72, 58, 36, 50, 43, 42, 31, 77, 96, 55, 56, 43, 61, 34, 95, 41, 45, 39, 48, 77, 116, 61, 46, 40, 107, 51, 44, 60, 68, 28, 48, 77, 49, 73, 113, 44, 75, 72, 38, 43, 37, 57, 42, 76, 54, 31, 39, 79, 34, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5115333000738098, "mean_inference_ms": 2.883618096086592, "mean_action_processing_ms": 0.5803859817664333, "mean_env_wait_ms": 0.14098381611565414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015126705169677734, "StateBufferConnector_ms": 0.0060520172119140625, "ViewRequirementAgentConnector_ms": 0.2700800895690918}}, "episode_reward_max": 71.68733333333344, "episode_reward_min": 13.459, "episode_reward_mean": 28.710493333333332, "episode_len_mean": 59.47, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.77133333333337, 16.371999999999993, 30.148666666666657, 32.69233333333334, 23.028333333333318, 16.557999999999996, 28.566999999999986, 42.06900000000002, 14.824666666666664, 23.160666666666657, 43.38466666666669, 16.535666666666657, 42.58100000000001, 39.453000000000024, 23.760333333333328, 26.48366666666666, 24.278666666666663, 16.790666666666667, 13.459, 24.912666666666656, 31.504666666666648, 34.70233333333332, 43.02733333333337, 26.384666666666647, 21.490666666666662, 53.765333333333295, 45.307333333333354, 71.68733333333344, 43.04800000000001, 18.51733333333333, 33.21733333333333, 19.45366666666666, 20.992666666666658, 21.27366666666666, 43.89900000000001, 27.280333333333324, 14.525999999999996, 32.28466666666668, 30.82499999999999, 27.582, 25.408333333333324, 24.353333333333328, 26.24533333333333, 21.331333333333323, 56.154999999999994, 23.708999999999996, 33.367, 20.443666666666665, 20.30166666666666, 42.70133333333333, 35.192333333333316, 32.52099999999999, 15.854333333333331, 24.37066666666667, 20.371333333333332, 23.100333333333325, 16.109333333333332, 29.21399999999998, 49.6536666666667, 20.14233333333332, 31.953000000000007, 17.203333333333326, 27.273666666666667, 17.384666666666664, 54.26033333333337, 16.702333333333332, 23.244666666666667, 18.376666666666654, 19.92733333333333, 30.480999999999977, 65.31033333333336, 30.892666666666667, 24.938666666666663, 19.454333333333327, 53.699333333333364, 21.044666666666657, 21.566333333333333, 21.571666666666655, 37.28033333333336, 13.923666666666664, 17.92699999999999, 23.875999999999973, 27.42399999999999, 26.37966666666665, 57.52200000000002, 25.22499999999999, 31.19366666666666, 34.81366666666668, 18.67, 18.57133333333333, 20.53999999999999, 29.25866666666666, 19.17966666666666, 25.089666666666645, 26.362333333333325, 15.63466666666666, 17.285999999999994, 29.355666666666643, 18.269666666666662, 36.83566666666667], "episode_lengths": [107, 37, 72, 58, 58, 35, 75, 67, 33, 53, 88, 33, 76, 86, 44, 54, 62, 42, 28, 51, 85, 57, 93, 75, 44, 115, 79, 139, 85, 37, 70, 41, 42, 49, 74, 47, 28, 55, 70, 51, 60, 50, 45, 41, 100, 53, 70, 40, 45, 81, 72, 58, 36, 50, 43, 42, 31, 77, 96, 55, 56, 43, 61, 34, 95, 41, 45, 39, 48, 77, 116, 61, 46, 40, 107, 51, 44, 60, 68, 28, 48, 77, 49, 73, 113, 44, 75, 72, 38, 43, 37, 57, 42, 76, 54, 31, 39, 79, 34, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5115333000738098, "mean_inference_ms": 2.883618096086592, "mean_action_processing_ms": 0.5803859817664333, "mean_env_wait_ms": 0.14098381611565414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015126705169677734, "StateBufferConnector_ms": 0.0060520172119140625, "ViewRequirementAgentConnector_ms": 0.2700800895690918}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 778.7921704937331, "num_env_steps_trained_throughput_per_sec": 778.7921704937331, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 5238.723, "sample_time_ms": 1908.009, "load_time_ms": 0.5, "load_throughput": 8007071.064, "learn_time_ms": 3312.734, "learn_throughput": 1207.462, "synch_weights_time_ms": 15.828}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 10323, "training_iteration": 142, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-13", "timestamp": 1702018693, "time_this_iter_s": 5.190065383911133, "time_total_s": 22341.086322784424, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22341.086322784424, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 68.55714285714285, "ram_util_percent": 90.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.28467699843034e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 5.01206111907959, "policy_loss": -0.0005898682866245508, "vf_loss": 5.012650489807129, "vf_explained_var": 0.6279188394546509, "kl": 0.0013835293939337134, "entropy": 0.09489665180444717, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 132525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": 65.31033333333336, "episode_reward_min": 13.923666666666664, "episode_reward_mean": 26.791023333333325, "episode_len_mean": 57.98, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.480999999999977, 65.31033333333336, 30.892666666666667, 24.938666666666663, 19.454333333333327, 53.699333333333364, 21.044666666666657, 21.566333333333333, 21.571666666666655, 37.28033333333336, 13.923666666666664, 17.92699999999999, 23.875999999999973, 27.42399999999999, 26.37966666666665, 57.52200000000002, 25.22499999999999, 31.19366666666666, 34.81366666666668, 18.67, 18.57133333333333, 20.53999999999999, 29.25866666666666, 19.17966666666666, 25.089666666666645, 26.362333333333325, 15.63466666666666, 17.285999999999994, 29.355666666666643, 18.269666666666662, 36.83566666666667, 59.012, 32.81300000000001, 16.41733333333333, 30.506999999999973, 22.353666666666665, 17.13133333333333, 62.87166666666667, 51.782, 17.84166666666666, 22.789333333333317, 17.980666666666664, 21.603333333333325, 20.28166666666667, 20.25599999999999, 23.337999999999994, 16.429333333333332, 15.203333333333328, 18.759666666666654, 14.825666666666667, 17.763666666666662, 30.25866666666668, 27.232666666666663, 23.05166666666667, 35.046666666666646, 20.41233333333333, 23.183333333333323, 20.656000000000006, 19.943999999999996, 17.130999999999997, 28.089333333333325, 48.35366666666669, 31.23066666666666, 24.99966666666665, 24.58099999999999, 18.951666666666657, 16.312999999999995, 29.942333333333302, 16.44066666666666, 56.010333333333335, 18.514, 17.42299999999999, 45.46033333333337, 14.315999999999995, 19.08533333333333, 23.031999999999996, 20.502999999999997, 33.80599999999998, 46.12066666666668, 15.26233333333333, 17.15066666666666, 33.449666666666644, 22.507333333333325, 32.91866666666669, 54.89933333333335, 17.060999999999996, 27.42733333333333, 30.094999999999995, 19.97233333333332, 27.388666666666662, 14.848999999999998, 14.868333333333329, 45.49133333333333, 42.92033333333336, 32.75599999999998, 17.335333333333327, 17.397333333333332, 17.82699999999999, 16.929999999999993, 30.968666666666675], "episode_lengths": [77, 116, 61, 46, 40, 107, 51, 44, 60, 68, 28, 48, 77, 49, 73, 113, 44, 75, 72, 38, 43, 37, 57, 42, 76, 54, 31, 39, 79, 34, 66, 128, 69, 33, 75, 45, 39, 119, 96, 39, 60, 35, 57, 40, 65, 58, 47, 34, 40, 33, 40, 67, 73, 53, 87, 55, 45, 41, 36, 45, 71, 94, 67, 46, 72, 58, 33, 83, 39, 99, 44, 36, 79, 34, 39, 47, 46, 90, 77, 37, 43, 84, 52, 62, 98, 35, 49, 56, 45, 60, 33, 39, 89, 77, 72, 37, 35, 35, 47, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5076419123904727, "mean_inference_ms": 2.8757096099543435, "mean_action_processing_ms": 0.5786411116131949, "mean_env_wait_ms": 0.140714411738207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020922422409057617, "StateBufferConnector_ms": 0.010170221328735352, "ViewRequirementAgentConnector_ms": 0.29770970344543457}}, "episode_reward_max": 65.31033333333336, "episode_reward_min": 13.923666666666664, "episode_reward_mean": 26.791023333333325, "episode_len_mean": 57.98, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.480999999999977, 65.31033333333336, 30.892666666666667, 24.938666666666663, 19.454333333333327, 53.699333333333364, 21.044666666666657, 21.566333333333333, 21.571666666666655, 37.28033333333336, 13.923666666666664, 17.92699999999999, 23.875999999999973, 27.42399999999999, 26.37966666666665, 57.52200000000002, 25.22499999999999, 31.19366666666666, 34.81366666666668, 18.67, 18.57133333333333, 20.53999999999999, 29.25866666666666, 19.17966666666666, 25.089666666666645, 26.362333333333325, 15.63466666666666, 17.285999999999994, 29.355666666666643, 18.269666666666662, 36.83566666666667, 59.012, 32.81300000000001, 16.41733333333333, 30.506999999999973, 22.353666666666665, 17.13133333333333, 62.87166666666667, 51.782, 17.84166666666666, 22.789333333333317, 17.980666666666664, 21.603333333333325, 20.28166666666667, 20.25599999999999, 23.337999999999994, 16.429333333333332, 15.203333333333328, 18.759666666666654, 14.825666666666667, 17.763666666666662, 30.25866666666668, 27.232666666666663, 23.05166666666667, 35.046666666666646, 20.41233333333333, 23.183333333333323, 20.656000000000006, 19.943999999999996, 17.130999999999997, 28.089333333333325, 48.35366666666669, 31.23066666666666, 24.99966666666665, 24.58099999999999, 18.951666666666657, 16.312999999999995, 29.942333333333302, 16.44066666666666, 56.010333333333335, 18.514, 17.42299999999999, 45.46033333333337, 14.315999999999995, 19.08533333333333, 23.031999999999996, 20.502999999999997, 33.80599999999998, 46.12066666666668, 15.26233333333333, 17.15066666666666, 33.449666666666644, 22.507333333333325, 32.91866666666669, 54.89933333333335, 17.060999999999996, 27.42733333333333, 30.094999999999995, 19.97233333333332, 27.388666666666662, 14.848999999999998, 14.868333333333329, 45.49133333333333, 42.92033333333336, 32.75599999999998, 17.335333333333327, 17.397333333333332, 17.82699999999999, 16.929999999999993, 30.968666666666675], "episode_lengths": [77, 116, 61, 46, 40, 107, 51, 44, 60, 68, 28, 48, 77, 49, 73, 113, 44, 75, 72, 38, 43, 37, 57, 42, 76, 54, 31, 39, 79, 34, 66, 128, 69, 33, 75, 45, 39, 119, 96, 39, 60, 35, 57, 40, 65, 58, 47, 34, 40, 33, 40, 67, 73, 53, 87, 55, 45, 41, 36, 45, 71, 94, 67, 46, 72, 58, 33, 83, 39, 99, 44, 36, 79, 34, 39, 47, 46, 90, 77, 37, 43, 84, 52, 62, 98, 35, 49, 56, 45, 60, 33, 39, 89, 77, 72, 37, 35, 35, 47, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5076419123904727, "mean_inference_ms": 2.8757096099543435, "mean_action_processing_ms": 0.5786411116131949, "mean_env_wait_ms": 0.140714411738207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020922422409057617, "StateBufferConnector_ms": 0.010170221328735352, "ViewRequirementAgentConnector_ms": 0.29770970344543457}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 767.547606485051, "num_env_steps_trained_throughput_per_sec": 767.547606485051, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 5346.653, "sample_time_ms": 1937.223, "load_time_ms": 0.399, "load_throughput": 10013856.989, "learn_time_ms": 3392.376, "learn_throughput": 1179.114, "synch_weights_time_ms": 15.001}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 10392, "training_iteration": 143, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-18", "timestamp": 1702018698, "time_this_iter_s": 5.258540153503418, "time_total_s": 22346.344862937927, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22346.344862937927, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 68.87142857142857, "ram_util_percent": 90.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.14233849921517e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 5.407423973083496, "policy_loss": -0.006460659671574831, "vf_loss": 5.41388463973999, "vf_explained_var": 0.603724479675293, "kl": 0.0018279998330399394, "entropy": 0.07795310020446777, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 133455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 74.25533333333335, "episode_reward_min": 13.984666666666664, "episode_reward_mean": 26.843739999999993, "episode_len_mean": 58.89, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.942333333333302, 16.44066666666666, 56.010333333333335, 18.514, 17.42299999999999, 45.46033333333337, 14.315999999999995, 19.08533333333333, 23.031999999999996, 20.502999999999997, 33.80599999999998, 46.12066666666668, 15.26233333333333, 17.15066666666666, 33.449666666666644, 22.507333333333325, 32.91866666666669, 54.89933333333335, 17.060999999999996, 27.42733333333333, 30.094999999999995, 19.97233333333332, 27.388666666666662, 14.848999999999998, 14.868333333333329, 45.49133333333333, 42.92033333333336, 32.75599999999998, 17.335333333333327, 17.397333333333332, 17.82699999999999, 16.929999999999993, 30.968666666666675, 15.372999999999994, 21.58999999999999, 14.24, 19.66366666666665, 44.74966666666669, 20.48566666666666, 26.486666666666654, 16.247333333333323, 32.77466666666664, 13.984666666666664, 24.958999999999985, 40.632999999999996, 31.463333333333317, 17.52766666666666, 20.280333333333328, 40.414666666666655, 14.817666666666662, 55.06700000000001, 21.007333333333325, 31.635999999999992, 18.30233333333333, 17.82, 37.87566666666665, 34.18233333333334, 44.22899999999995, 18.67266666666666, 19.646333333333327, 19.923, 35.69533333333331, 74.25533333333335, 17.30033333333333, 29.244333333333323, 21.094333333333324, 37.34533333333333, 17.32966666666666, 15.094000000000001, 22.092666666666663, 19.93933333333333, 20.853, 16.19333333333333, 55.670333333333275, 30.016333333333332, 21.388333333333325, 34.45699999999998, 29.276333333333305, 31.939999999999994, 35.66266666666668, 25.877666666666663, 15.87899999999999, 32.471000000000004, 14.34633333333333, 17.109666666666666, 21.186999999999994, 28.285999999999976, 17.925333333333327, 15.65599999999999, 28.89533333333333, 37.46566666666665, 17.993666666666662, 16.87333333333333, 23.837333333333333, 30.509999999999977, 25.51633333333333, 28.33466666666667, 19.613999999999994, 60.8186666666667, 16.74699999999999], "episode_lengths": [83, 39, 99, 44, 36, 79, 34, 39, 47, 46, 90, 77, 37, 43, 84, 52, 62, 98, 35, 49, 56, 45, 60, 33, 39, 89, 77, 72, 37, 35, 35, 47, 60, 38, 42, 28, 60, 94, 49, 67, 37, 80, 29, 63, 84, 75, 36, 45, 101, 31, 120, 48, 53, 36, 36, 93, 79, 133, 48, 66, 42, 112, 160, 40, 70, 36, 73, 36, 31, 49, 41, 41, 38, 110, 61, 43, 67, 83, 67, 69, 51, 34, 64, 32, 34, 40, 73, 34, 35, 73, 102, 38, 43, 45, 84, 57, 59, 43, 110, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5037930412619358, "mean_inference_ms": 2.868169581416897, "mean_action_processing_ms": 0.5774878259816332, "mean_env_wait_ms": 0.1403680167367677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019644737243652344, "StateBufferConnector_ms": 0.010709047317504883, "ViewRequirementAgentConnector_ms": 0.3407163619995117}}, "episode_reward_max": 74.25533333333335, "episode_reward_min": 13.984666666666664, "episode_reward_mean": 26.843739999999993, "episode_len_mean": 58.89, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.942333333333302, 16.44066666666666, 56.010333333333335, 18.514, 17.42299999999999, 45.46033333333337, 14.315999999999995, 19.08533333333333, 23.031999999999996, 20.502999999999997, 33.80599999999998, 46.12066666666668, 15.26233333333333, 17.15066666666666, 33.449666666666644, 22.507333333333325, 32.91866666666669, 54.89933333333335, 17.060999999999996, 27.42733333333333, 30.094999999999995, 19.97233333333332, 27.388666666666662, 14.848999999999998, 14.868333333333329, 45.49133333333333, 42.92033333333336, 32.75599999999998, 17.335333333333327, 17.397333333333332, 17.82699999999999, 16.929999999999993, 30.968666666666675, 15.372999999999994, 21.58999999999999, 14.24, 19.66366666666665, 44.74966666666669, 20.48566666666666, 26.486666666666654, 16.247333333333323, 32.77466666666664, 13.984666666666664, 24.958999999999985, 40.632999999999996, 31.463333333333317, 17.52766666666666, 20.280333333333328, 40.414666666666655, 14.817666666666662, 55.06700000000001, 21.007333333333325, 31.635999999999992, 18.30233333333333, 17.82, 37.87566666666665, 34.18233333333334, 44.22899999999995, 18.67266666666666, 19.646333333333327, 19.923, 35.69533333333331, 74.25533333333335, 17.30033333333333, 29.244333333333323, 21.094333333333324, 37.34533333333333, 17.32966666666666, 15.094000000000001, 22.092666666666663, 19.93933333333333, 20.853, 16.19333333333333, 55.670333333333275, 30.016333333333332, 21.388333333333325, 34.45699999999998, 29.276333333333305, 31.939999999999994, 35.66266666666668, 25.877666666666663, 15.87899999999999, 32.471000000000004, 14.34633333333333, 17.109666666666666, 21.186999999999994, 28.285999999999976, 17.925333333333327, 15.65599999999999, 28.89533333333333, 37.46566666666665, 17.993666666666662, 16.87333333333333, 23.837333333333333, 30.509999999999977, 25.51633333333333, 28.33466666666667, 19.613999999999994, 60.8186666666667, 16.74699999999999], "episode_lengths": [83, 39, 99, 44, 36, 79, 34, 39, 47, 46, 90, 77, 37, 43, 84, 52, 62, 98, 35, 49, 56, 45, 60, 33, 39, 89, 77, 72, 37, 35, 35, 47, 60, 38, 42, 28, 60, 94, 49, 67, 37, 80, 29, 63, 84, 75, 36, 45, 101, 31, 120, 48, 53, 36, 36, 93, 79, 133, 48, 66, 42, 112, 160, 40, 70, 36, 73, 36, 31, 49, 41, 41, 38, 110, 61, 43, 67, 83, 67, 69, 51, 34, 64, 32, 34, 40, 73, 34, 35, 73, 102, 38, 43, 45, 84, 57, 59, 43, 110, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5037930412619358, "mean_inference_ms": 2.868169581416897, "mean_action_processing_ms": 0.5774878259816332, "mean_env_wait_ms": 0.1403680167367677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019644737243652344, "StateBufferConnector_ms": 0.010709047317504883, "ViewRequirementAgentConnector_ms": 0.3407163619995117}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 762.3691749624046, "num_env_steps_trained_throughput_per_sec": 762.3691749624046, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 5323.008, "sample_time_ms": 1931.828, "load_time_ms": 0.299, "load_throughput": 13361911.437, "learn_time_ms": 3373.827, "learn_throughput": 1185.597, "synch_weights_time_ms": 15.296}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 10459, "training_iteration": 144, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-24", "timestamp": 1702018704, "time_this_iter_s": 5.292839527130127, "time_total_s": 22351.637702465057, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22351.637702465057, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 66.725, "ram_util_percent": 91.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.071169249607585e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 5.636666774749756, "policy_loss": -0.0044192783534526825, "vf_loss": 5.641086101531982, "vf_explained_var": 0.5802769660949707, "kl": 0.0019430835964158177, "entropy": 0.07713653147220612, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 134385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": 67.17133333333332, "episode_reward_min": 13.844666666666665, "episode_reward_mean": 27.199606666666664, "episode_len_mean": 57.56, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.93933333333333, 20.853, 16.19333333333333, 55.670333333333275, 30.016333333333332, 21.388333333333325, 34.45699999999998, 29.276333333333305, 31.939999999999994, 35.66266666666668, 25.877666666666663, 15.87899999999999, 32.471000000000004, 14.34633333333333, 17.109666666666666, 21.186999999999994, 28.285999999999976, 17.925333333333327, 15.65599999999999, 28.89533333333333, 37.46566666666665, 17.993666666666662, 16.87333333333333, 23.837333333333333, 30.509999999999977, 25.51633333333333, 28.33466666666667, 19.613999999999994, 60.8186666666667, 16.74699999999999, 19.86333333333332, 18.37299999999999, 20.31066666666667, 54.838666666666704, 17.175666666666658, 20.862333333333336, 29.30533333333332, 32.48433333333331, 29.022999999999985, 43.257666666666665, 37.102333333333334, 19.635999999999992, 15.420666666666664, 21.527666666666654, 15.840999999999992, 44.94933333333334, 17.186333333333327, 41.664666666666676, 21.34333333333333, 45.38166666666667, 14.668, 34.98533333333335, 19.30966666666666, 24.503999999999998, 20.904, 17.48833333333333, 21.846333333333334, 39.93033333333332, 23.651666666666664, 14.125, 20.656999999999986, 67.17133333333332, 23.044666666666664, 18.134999999999994, 23.19799999999999, 15.414999999999994, 25.756999999999994, 46.82899999999997, 51.67633333333331, 24.76899999999999, 24.128666666666653, 18.681333333333324, 23.08933333333333, 40.41133333333337, 19.423666666666655, 31.292333333333332, 16.965666666666664, 33.66666666666668, 45.58800000000003, 39.45133333333334, 26.595999999999993, 30.72433333333334, 16.383999999999997, 20.342999999999993, 58.12533333333335, 45.63833333333334, 23.361999999999995, 16.868333333333332, 27.13866666666665, 13.844666666666665, 17.105666666666668, 24.483333333333345, 33.77800000000001, 29.496666666666673, 37.251333333333335, 17.912, 22.464666666666663, 24.80033333333333, 14.535333333333332, 22.057666666666652], "episode_lengths": [41, 41, 38, 110, 61, 43, 67, 83, 67, 69, 51, 34, 64, 32, 34, 40, 73, 34, 35, 73, 102, 38, 43, 45, 84, 57, 59, 43, 110, 40, 58, 40, 44, 116, 39, 50, 77, 64, 64, 86, 60, 41, 36, 56, 32, 87, 39, 74, 39, 87, 31, 57, 41, 46, 43, 46, 54, 92, 45, 28, 50, 131, 49, 38, 47, 32, 46, 95, 99, 55, 75, 36, 47, 76, 40, 67, 35, 84, 89, 82, 53, 62, 41, 61, 121, 82, 58, 40, 53, 28, 39, 55, 69, 60, 74, 36, 51, 48, 28, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.500623581279429, "mean_inference_ms": 2.8608405241302393, "mean_action_processing_ms": 0.5757225900028807, "mean_env_wait_ms": 0.14003706973460123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016309261322021484, "StateBufferConnector_ms": 0.011682748794555664, "ViewRequirementAgentConnector_ms": 0.3303408622741699}}, "episode_reward_max": 67.17133333333332, "episode_reward_min": 13.844666666666665, "episode_reward_mean": 27.199606666666664, "episode_len_mean": 57.56, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.93933333333333, 20.853, 16.19333333333333, 55.670333333333275, 30.016333333333332, 21.388333333333325, 34.45699999999998, 29.276333333333305, 31.939999999999994, 35.66266666666668, 25.877666666666663, 15.87899999999999, 32.471000000000004, 14.34633333333333, 17.109666666666666, 21.186999999999994, 28.285999999999976, 17.925333333333327, 15.65599999999999, 28.89533333333333, 37.46566666666665, 17.993666666666662, 16.87333333333333, 23.837333333333333, 30.509999999999977, 25.51633333333333, 28.33466666666667, 19.613999999999994, 60.8186666666667, 16.74699999999999, 19.86333333333332, 18.37299999999999, 20.31066666666667, 54.838666666666704, 17.175666666666658, 20.862333333333336, 29.30533333333332, 32.48433333333331, 29.022999999999985, 43.257666666666665, 37.102333333333334, 19.635999999999992, 15.420666666666664, 21.527666666666654, 15.840999999999992, 44.94933333333334, 17.186333333333327, 41.664666666666676, 21.34333333333333, 45.38166666666667, 14.668, 34.98533333333335, 19.30966666666666, 24.503999999999998, 20.904, 17.48833333333333, 21.846333333333334, 39.93033333333332, 23.651666666666664, 14.125, 20.656999999999986, 67.17133333333332, 23.044666666666664, 18.134999999999994, 23.19799999999999, 15.414999999999994, 25.756999999999994, 46.82899999999997, 51.67633333333331, 24.76899999999999, 24.128666666666653, 18.681333333333324, 23.08933333333333, 40.41133333333337, 19.423666666666655, 31.292333333333332, 16.965666666666664, 33.66666666666668, 45.58800000000003, 39.45133333333334, 26.595999999999993, 30.72433333333334, 16.383999999999997, 20.342999999999993, 58.12533333333335, 45.63833333333334, 23.361999999999995, 16.868333333333332, 27.13866666666665, 13.844666666666665, 17.105666666666668, 24.483333333333345, 33.77800000000001, 29.496666666666673, 37.251333333333335, 17.912, 22.464666666666663, 24.80033333333333, 14.535333333333332, 22.057666666666652], "episode_lengths": [41, 41, 38, 110, 61, 43, 67, 83, 67, 69, 51, 34, 64, 32, 34, 40, 73, 34, 35, 73, 102, 38, 43, 45, 84, 57, 59, 43, 110, 40, 58, 40, 44, 116, 39, 50, 77, 64, 64, 86, 60, 41, 36, 56, 32, 87, 39, 74, 39, 87, 31, 57, 41, 46, 43, 46, 54, 92, 45, 28, 50, 131, 49, 38, 47, 32, 46, 95, 99, 55, 75, 36, 47, 76, 40, 67, 35, 84, 89, 82, 53, 62, 41, 61, 121, 82, 58, 40, 53, 28, 39, 55, 69, 60, 74, 36, 51, 48, 28, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.500623581279429, "mean_inference_ms": 2.8608405241302393, "mean_action_processing_ms": 0.5757225900028807, "mean_env_wait_ms": 0.14003706973460123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016309261322021484, "StateBufferConnector_ms": 0.011682748794555664, "ViewRequirementAgentConnector_ms": 0.3303408622741699}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 739.9424125190452, "num_env_steps_trained_throughput_per_sec": 739.9424125190452, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 5316.621, "sample_time_ms": 1939.353, "load_time_ms": 0.3, "load_throughput": 13350215.644, "learn_time_ms": 3359.605, "learn_throughput": 1190.616, "synch_weights_time_ms": 15.733}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 10529, "training_iteration": 145, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-29", "timestamp": 1702018709, "time_this_iter_s": 5.446691513061523, "time_total_s": 22357.08439397812, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22357.08439397812, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 63.575, "ram_util_percent": 90.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.355846248037925e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 5.373666286468506, "policy_loss": -0.0062004756182432175, "vf_loss": 5.379866600036621, "vf_explained_var": 0.6017636060714722, "kl": 0.003746161935850978, "entropy": 0.09216941893100739, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 135315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": 71.42600000000004, "episode_reward_min": 13.844666666666665, "episode_reward_mean": 27.29355333333333, "episode_len_mean": 57.92, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.67633333333331, 24.76899999999999, 24.128666666666653, 18.681333333333324, 23.08933333333333, 40.41133333333337, 19.423666666666655, 31.292333333333332, 16.965666666666664, 33.66666666666668, 45.58800000000003, 39.45133333333334, 26.595999999999993, 30.72433333333334, 16.383999999999997, 20.342999999999993, 58.12533333333335, 45.63833333333334, 23.361999999999995, 16.868333333333332, 27.13866666666665, 13.844666666666665, 17.105666666666668, 24.483333333333345, 33.77800000000001, 29.496666666666673, 37.251333333333335, 17.912, 22.464666666666663, 24.80033333333333, 14.535333333333332, 22.057666666666652, 48.09199999999998, 17.355333333333324, 18.481333333333325, 19.225666666666665, 19.844333333333328, 29.776666666666657, 25.43566666666666, 28.34133333333333, 46.51666666666668, 24.418666666666663, 71.42600000000004, 21.060333333333332, 16.83166666666666, 27.525999999999986, 24.52399999999998, 16.853666666666665, 16.319666666666663, 20.398999999999997, 21.160333333333323, 32.30466666666668, 24.552666666666664, 24.857666666666663, 18.004333333333335, 35.36233333333334, 18.292333333333332, 23.883999999999986, 17.35966666666666, 20.95133333333333, 46.46966666666665, 18.395, 18.82366666666666, 28.87199999999999, 16.502333333333326, 25.989666666666647, 27.25699999999999, 26.286999999999995, 18.500333333333327, 27.534000000000006, 27.931, 20.604666666666656, 20.292666666666662, 14.924999999999995, 42.73033333333334, 20.70033333333333, 21.755333333333326, 21.63633333333334, 27.28766666666667, 67.32533333333335, 26.66899999999998, 41.24299999999999, 30.502666666666663, 15.081999999999995, 16.61733333333333, 36.66666666666665, 41.85466666666665, 33.32566666666667, 36.837333333333355, 41.01699999999998, 28.136666666666653, 21.01233333333333, 21.518666666666665, 21.66966666666666, 19.451666666666664, 15.629666666666663, 20.158666666666655, 24.622666666666657, 57.06799999999997, 19.24199999999999], "episode_lengths": [99, 55, 75, 36, 47, 76, 40, 67, 35, 84, 89, 82, 53, 62, 41, 61, 121, 82, 58, 40, 53, 28, 39, 55, 69, 60, 74, 36, 51, 48, 28, 41, 99, 33, 49, 42, 46, 47, 70, 66, 76, 45, 141, 48, 37, 68, 47, 30, 30, 42, 48, 73, 53, 47, 36, 76, 48, 48, 34, 46, 96, 48, 48, 48, 40, 74, 60, 58, 46, 51, 58, 41, 47, 34, 84, 39, 64, 50, 56, 125, 68, 104, 57, 31, 40, 80, 75, 63, 68, 88, 66, 43, 39, 65, 52, 30, 51, 51, 109, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4980704583522806, "mean_inference_ms": 2.855192321289526, "mean_action_processing_ms": 0.5747952300080306, "mean_env_wait_ms": 0.13980129090809296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023934125900268555, "StateBufferConnector_ms": 0.008554697036743164, "ViewRequirementAgentConnector_ms": 0.33238959312438965}}, "episode_reward_max": 71.42600000000004, "episode_reward_min": 13.844666666666665, "episode_reward_mean": 27.29355333333333, "episode_len_mean": 57.92, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.67633333333331, 24.76899999999999, 24.128666666666653, 18.681333333333324, 23.08933333333333, 40.41133333333337, 19.423666666666655, 31.292333333333332, 16.965666666666664, 33.66666666666668, 45.58800000000003, 39.45133333333334, 26.595999999999993, 30.72433333333334, 16.383999999999997, 20.342999999999993, 58.12533333333335, 45.63833333333334, 23.361999999999995, 16.868333333333332, 27.13866666666665, 13.844666666666665, 17.105666666666668, 24.483333333333345, 33.77800000000001, 29.496666666666673, 37.251333333333335, 17.912, 22.464666666666663, 24.80033333333333, 14.535333333333332, 22.057666666666652, 48.09199999999998, 17.355333333333324, 18.481333333333325, 19.225666666666665, 19.844333333333328, 29.776666666666657, 25.43566666666666, 28.34133333333333, 46.51666666666668, 24.418666666666663, 71.42600000000004, 21.060333333333332, 16.83166666666666, 27.525999999999986, 24.52399999999998, 16.853666666666665, 16.319666666666663, 20.398999999999997, 21.160333333333323, 32.30466666666668, 24.552666666666664, 24.857666666666663, 18.004333333333335, 35.36233333333334, 18.292333333333332, 23.883999999999986, 17.35966666666666, 20.95133333333333, 46.46966666666665, 18.395, 18.82366666666666, 28.87199999999999, 16.502333333333326, 25.989666666666647, 27.25699999999999, 26.286999999999995, 18.500333333333327, 27.534000000000006, 27.931, 20.604666666666656, 20.292666666666662, 14.924999999999995, 42.73033333333334, 20.70033333333333, 21.755333333333326, 21.63633333333334, 27.28766666666667, 67.32533333333335, 26.66899999999998, 41.24299999999999, 30.502666666666663, 15.081999999999995, 16.61733333333333, 36.66666666666665, 41.85466666666665, 33.32566666666667, 36.837333333333355, 41.01699999999998, 28.136666666666653, 21.01233333333333, 21.518666666666665, 21.66966666666666, 19.451666666666664, 15.629666666666663, 20.158666666666655, 24.622666666666657, 57.06799999999997, 19.24199999999999], "episode_lengths": [99, 55, 75, 36, 47, 76, 40, 67, 35, 84, 89, 82, 53, 62, 41, 61, 121, 82, 58, 40, 53, 28, 39, 55, 69, 60, 74, 36, 51, 48, 28, 41, 99, 33, 49, 42, 46, 47, 70, 66, 76, 45, 141, 48, 37, 68, 47, 30, 30, 42, 48, 73, 53, 47, 36, 76, 48, 48, 34, 46, 96, 48, 48, 48, 40, 74, 60, 58, 46, 51, 58, 41, 47, 34, 84, 39, 64, 50, 56, 125, 68, 104, 57, 31, 40, 80, 75, 63, 68, 88, 66, 43, 39, 65, 52, 30, 51, 51, 109, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4980704583522806, "mean_inference_ms": 2.855192321289526, "mean_action_processing_ms": 0.5747952300080306, "mean_env_wait_ms": 0.13980129090809296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023934125900268555, "StateBufferConnector_ms": 0.008554697036743164, "ViewRequirementAgentConnector_ms": 0.33238959312438965}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 743.7714432238648, "num_env_steps_trained_throughput_per_sec": 743.7714432238648, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 5328.683, "sample_time_ms": 1981.689, "load_time_ms": 0.3, "load_throughput": 13350215.644, "learn_time_ms": 3329.106, "learn_throughput": 1201.524, "synch_weights_time_ms": 16.065}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 10597, "training_iteration": 146, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-34", "timestamp": 1702018714, "time_this_iter_s": 5.417875289916992, "time_total_s": 22362.502269268036, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22362.502269268036, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 70.67142857142856, "ram_util_percent": 92.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.6779231240189623e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 5.215956687927246, "policy_loss": 0.003185841254889965, "vf_loss": 5.212770938873291, "vf_explained_var": 0.5630624294281006, "kl": 0.0019553769379854202, "entropy": 0.08099483698606491, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 136245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 67.32533333333335, "episode_reward_min": 13.333999999999993, "episode_reward_mean": 27.033063333333324, "episode_len_mean": 57.01, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.292666666666662, 14.924999999999995, 42.73033333333334, 20.70033333333333, 21.755333333333326, 21.63633333333334, 27.28766666666667, 67.32533333333335, 26.66899999999998, 41.24299999999999, 30.502666666666663, 15.081999999999995, 16.61733333333333, 36.66666666666665, 41.85466666666665, 33.32566666666667, 36.837333333333355, 41.01699999999998, 28.136666666666653, 21.01233333333333, 21.518666666666665, 21.66966666666666, 19.451666666666664, 15.629666666666663, 20.158666666666655, 24.622666666666657, 57.06799999999997, 19.24199999999999, 21.962999999999994, 16.696999999999996, 16.510333333333335, 36.906, 46.665333333333294, 23.686, 19.815666666666655, 41.49933333333333, 19.90233333333333, 23.138666666666655, 16.88099999999999, 20.546666666666663, 30.247333333333323, 18.753, 50.09500000000002, 25.697333333333315, 38.18699999999998, 17.23766666666666, 18.392333333333333, 15.58, 41.46133333333336, 17.734, 19.389333333333322, 56.18766666666668, 17.494, 16.252333333333326, 19.917333333333335, 58.74133333333335, 23.788999999999998, 15.378666666666666, 40.16166666666666, 19.683999999999994, 13.333999999999993, 25.64466666666668, 32.724333333333334, 18.738333333333326, 27.420333333333343, 18.45566666666666, 20.546333333333326, 20.805333333333337, 15.156333333333327, 37.709666666666685, 19.58266666666666, 31.956333333333333, 20.651999999999994, 17.24833333333333, 35.65099999999998, 23.297333333333327, 26.70566666666666, 21.51033333333332, 28.623666666666665, 19.079666666666668, 32.663333333333334, 62.19766666666668, 20.14, 34.44799999999999, 29.191666666666652, 26.29566666666666, 26.622999999999998, 20.33466666666666, 16.186666666666664, 29.080999999999978, 21.243666666666666, 23.96166666666666, 20.28733333333333, 18.581, 40.07766666666666, 18.65966666666666, 25.06233333333334, 24.802000000000003, 17.669333333333324, 51.387999999999984], "episode_lengths": [47, 34, 84, 39, 64, 50, 56, 125, 68, 104, 57, 31, 40, 80, 75, 63, 68, 88, 66, 43, 39, 65, 52, 30, 51, 51, 109, 35, 50, 40, 32, 66, 94, 42, 56, 74, 48, 43, 42, 37, 61, 38, 97, 68, 98, 35, 38, 43, 73, 34, 41, 97, 37, 33, 39, 111, 58, 33, 74, 47, 28, 59, 66, 35, 63, 38, 46, 51, 34, 88, 39, 57, 50, 35, 70, 48, 70, 40, 53, 39, 65, 125, 49, 58, 88, 78, 50, 39, 35, 71, 41, 57, 48, 40, 66, 35, 49, 47, 37, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4946560822874306, "mean_inference_ms": 2.8487438450522933, "mean_action_processing_ms": 0.5736433130423313, "mean_env_wait_ms": 0.1394277231476278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025082826614379883, "StateBufferConnector_ms": 0.005899190902709961, "ViewRequirementAgentConnector_ms": 0.3649725914001465}}, "episode_reward_max": 67.32533333333335, "episode_reward_min": 13.333999999999993, "episode_reward_mean": 27.033063333333324, "episode_len_mean": 57.01, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.292666666666662, 14.924999999999995, 42.73033333333334, 20.70033333333333, 21.755333333333326, 21.63633333333334, 27.28766666666667, 67.32533333333335, 26.66899999999998, 41.24299999999999, 30.502666666666663, 15.081999999999995, 16.61733333333333, 36.66666666666665, 41.85466666666665, 33.32566666666667, 36.837333333333355, 41.01699999999998, 28.136666666666653, 21.01233333333333, 21.518666666666665, 21.66966666666666, 19.451666666666664, 15.629666666666663, 20.158666666666655, 24.622666666666657, 57.06799999999997, 19.24199999999999, 21.962999999999994, 16.696999999999996, 16.510333333333335, 36.906, 46.665333333333294, 23.686, 19.815666666666655, 41.49933333333333, 19.90233333333333, 23.138666666666655, 16.88099999999999, 20.546666666666663, 30.247333333333323, 18.753, 50.09500000000002, 25.697333333333315, 38.18699999999998, 17.23766666666666, 18.392333333333333, 15.58, 41.46133333333336, 17.734, 19.389333333333322, 56.18766666666668, 17.494, 16.252333333333326, 19.917333333333335, 58.74133333333335, 23.788999999999998, 15.378666666666666, 40.16166666666666, 19.683999999999994, 13.333999999999993, 25.64466666666668, 32.724333333333334, 18.738333333333326, 27.420333333333343, 18.45566666666666, 20.546333333333326, 20.805333333333337, 15.156333333333327, 37.709666666666685, 19.58266666666666, 31.956333333333333, 20.651999999999994, 17.24833333333333, 35.65099999999998, 23.297333333333327, 26.70566666666666, 21.51033333333332, 28.623666666666665, 19.079666666666668, 32.663333333333334, 62.19766666666668, 20.14, 34.44799999999999, 29.191666666666652, 26.29566666666666, 26.622999999999998, 20.33466666666666, 16.186666666666664, 29.080999999999978, 21.243666666666666, 23.96166666666666, 20.28733333333333, 18.581, 40.07766666666666, 18.65966666666666, 25.06233333333334, 24.802000000000003, 17.669333333333324, 51.387999999999984], "episode_lengths": [47, 34, 84, 39, 64, 50, 56, 125, 68, 104, 57, 31, 40, 80, 75, 63, 68, 88, 66, 43, 39, 65, 52, 30, 51, 51, 109, 35, 50, 40, 32, 66, 94, 42, 56, 74, 48, 43, 42, 37, 61, 38, 97, 68, 98, 35, 38, 43, 73, 34, 41, 97, 37, 33, 39, 111, 58, 33, 74, 47, 28, 59, 66, 35, 63, 38, 46, 51, 34, 88, 39, 57, 50, 35, 70, 48, 70, 40, 53, 39, 65, 125, 49, 58, 88, 78, 50, 39, 35, 71, 41, 57, 48, 40, 66, 35, 49, 47, 37, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4946560822874306, "mean_inference_ms": 2.8487438450522933, "mean_action_processing_ms": 0.5736433130423313, "mean_env_wait_ms": 0.1394277231476278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025082826614379883, "StateBufferConnector_ms": 0.005899190902709961, "ViewRequirementAgentConnector_ms": 0.3649725914001465}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 706.0106371965902, "num_env_steps_trained_throughput_per_sec": 706.0106371965902, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 5374.185, "sample_time_ms": 1989.783, "load_time_ms": 0.3, "load_throughput": 13350215.644, "learn_time_ms": 3367.53, "learn_throughput": 1187.814, "synch_weights_time_ms": 15.045}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 10669, "training_iteration": 147, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-40", "timestamp": 1702018720, "time_this_iter_s": 5.675359010696411, "time_total_s": 22368.177628278732, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22368.177628278732, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 69.9875, "ram_util_percent": 91.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3389615620094812e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 5.983426570892334, "policy_loss": -0.007467099465429783, "vf_loss": 5.990893840789795, "vf_explained_var": 0.6072790026664734, "kl": 0.0038997347000986338, "entropy": 0.0862095057964325, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 137175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": 64.43499999999996, "episode_reward_min": 14.303666666666661, "episode_reward_mean": 27.85119666666666, "episode_len_mean": 57.26, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.651999999999994, 17.24833333333333, 35.65099999999998, 23.297333333333327, 26.70566666666666, 21.51033333333332, 28.623666666666665, 19.079666666666668, 32.663333333333334, 62.19766666666668, 20.14, 34.44799999999999, 29.191666666666652, 26.29566666666666, 26.622999999999998, 20.33466666666666, 16.186666666666664, 29.080999999999978, 21.243666666666666, 23.96166666666666, 20.28733333333333, 18.581, 40.07766666666666, 18.65966666666666, 25.06233333333334, 24.802000000000003, 17.669333333333324, 51.387999999999984, 49.620000000000026, 29.842000000000002, 16.63933333333333, 41.72066666666666, 35.14199999999999, 27.477333333333334, 16.73333333333333, 16.521666666666665, 30.931, 18.905333333333328, 17.92633333333333, 18.19333333333333, 29.798666666666662, 14.786999999999995, 24.606333333333332, 27.792666666666655, 26.805333333333337, 64.43499999999996, 20.459666666666653, 14.303666666666661, 18.555666666666657, 31.56966666666664, 47.96699999999998, 20.258, 17.491333333333333, 27.660999999999998, 18.112666666666666, 23.198999999999998, 16.456666666666663, 19.22633333333333, 14.465333333333332, 21.70633333333333, 14.820333333333329, 30.020666666666656, 17.218999999999994, 32.616666666666674, 27.839333333333336, 18.82999999999999, 24.319333333333333, 17.671999999999993, 44.195666666666696, 25.395999999999994, 15.323333333333332, 28.937333333333342, 15.311999999999996, 19.790999999999997, 38.042, 50.66699999999996, 45.58199999999997, 17.656333333333325, 39.107, 15.934999999999997, 25.503666666666653, 54.43533333333332, 24.457666666666658, 35.77, 17.34633333333333, 35.43099999999999, 18.782333333333334, 19.584333333333326, 34.08933333333332, 51.50533333333334, 30.860333333333315, 60.51566666666667, 27.76133333333333, 28.85866666666665, 25.479, 42.21733333333334, 45.41733333333333, 27.983666666666664, 31.432666666666655, 37.43433333333332], "episode_lengths": [50, 35, 70, 48, 70, 40, 53, 39, 65, 125, 49, 58, 88, 78, 50, 39, 35, 71, 41, 57, 48, 40, 66, 35, 49, 47, 37, 121, 87, 52, 38, 71, 60, 70, 32, 32, 52, 37, 48, 35, 52, 30, 49, 51, 47, 172, 47, 29, 49, 74, 95, 39, 40, 56, 46, 58, 32, 40, 30, 44, 30, 51, 34, 67, 48, 42, 61, 37, 92, 47, 31, 63, 33, 36, 64, 111, 94, 58, 73, 32, 46, 90, 53, 72, 32, 70, 43, 37, 56, 95, 69, 108, 55, 56, 49, 64, 91, 54, 101, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4909215118192247, "mean_inference_ms": 2.8412317824258846, "mean_action_processing_ms": 0.5723769668778957, "mean_env_wait_ms": 0.1390557854947833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023752689361572266, "StateBufferConnector_ms": 0.012067317962646484, "ViewRequirementAgentConnector_ms": 0.3196835517883301}}, "episode_reward_max": 64.43499999999996, "episode_reward_min": 14.303666666666661, "episode_reward_mean": 27.85119666666666, "episode_len_mean": 57.26, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.651999999999994, 17.24833333333333, 35.65099999999998, 23.297333333333327, 26.70566666666666, 21.51033333333332, 28.623666666666665, 19.079666666666668, 32.663333333333334, 62.19766666666668, 20.14, 34.44799999999999, 29.191666666666652, 26.29566666666666, 26.622999999999998, 20.33466666666666, 16.186666666666664, 29.080999999999978, 21.243666666666666, 23.96166666666666, 20.28733333333333, 18.581, 40.07766666666666, 18.65966666666666, 25.06233333333334, 24.802000000000003, 17.669333333333324, 51.387999999999984, 49.620000000000026, 29.842000000000002, 16.63933333333333, 41.72066666666666, 35.14199999999999, 27.477333333333334, 16.73333333333333, 16.521666666666665, 30.931, 18.905333333333328, 17.92633333333333, 18.19333333333333, 29.798666666666662, 14.786999999999995, 24.606333333333332, 27.792666666666655, 26.805333333333337, 64.43499999999996, 20.459666666666653, 14.303666666666661, 18.555666666666657, 31.56966666666664, 47.96699999999998, 20.258, 17.491333333333333, 27.660999999999998, 18.112666666666666, 23.198999999999998, 16.456666666666663, 19.22633333333333, 14.465333333333332, 21.70633333333333, 14.820333333333329, 30.020666666666656, 17.218999999999994, 32.616666666666674, 27.839333333333336, 18.82999999999999, 24.319333333333333, 17.671999999999993, 44.195666666666696, 25.395999999999994, 15.323333333333332, 28.937333333333342, 15.311999999999996, 19.790999999999997, 38.042, 50.66699999999996, 45.58199999999997, 17.656333333333325, 39.107, 15.934999999999997, 25.503666666666653, 54.43533333333332, 24.457666666666658, 35.77, 17.34633333333333, 35.43099999999999, 18.782333333333334, 19.584333333333326, 34.08933333333332, 51.50533333333334, 30.860333333333315, 60.51566666666667, 27.76133333333333, 28.85866666666665, 25.479, 42.21733333333334, 45.41733333333333, 27.983666666666664, 31.432666666666655, 37.43433333333332], "episode_lengths": [50, 35, 70, 48, 70, 40, 53, 39, 65, 125, 49, 58, 88, 78, 50, 39, 35, 71, 41, 57, 48, 40, 66, 35, 49, 47, 37, 121, 87, 52, 38, 71, 60, 70, 32, 32, 52, 37, 48, 35, 52, 30, 49, 51, 47, 172, 47, 29, 49, 74, 95, 39, 40, 56, 46, 58, 32, 40, 30, 44, 30, 51, 34, 67, 48, 42, 61, 37, 92, 47, 31, 63, 33, 36, 64, 111, 94, 58, 73, 32, 46, 90, 53, 72, 32, 70, 43, 37, 56, 95, 69, 108, 55, 56, 49, 64, 91, 54, 101, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4909215118192247, "mean_inference_ms": 2.8412317824258846, "mean_action_processing_ms": 0.5723769668778957, "mean_env_wait_ms": 0.1390557854947833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023752689361572266, "StateBufferConnector_ms": 0.012067317962646484, "ViewRequirementAgentConnector_ms": 0.3196835517883301}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.9881369656218, "num_env_steps_trained_throughput_per_sec": 742.9881369656218, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 5364.78, "sample_time_ms": 1952.941, "load_time_ms": 0.401, "load_throughput": 9973970.632, "learn_time_ms": 3395.288, "learn_throughput": 1178.103, "synch_weights_time_ms": 14.725}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 10741, "training_iteration": 148, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-46", "timestamp": 1702018726, "time_this_iter_s": 5.414850473403931, "time_total_s": 22373.592478752136, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22373.592478752136, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 65.88749999999999, "ram_util_percent": 92.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 5.515370845794678, "policy_loss": -0.004585477523505688, "vf_loss": 5.519957065582275, "vf_explained_var": 0.6304258108139038, "kl": 0.0111859031021595, "entropy": 0.09740342944860458, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 138105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": 74.9043333333334, "episode_reward_min": 14.347666666666663, "episode_reward_mean": 28.87866333333333, "episode_len_mean": 60.2, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.82999999999999, 24.319333333333333, 17.671999999999993, 44.195666666666696, 25.395999999999994, 15.323333333333332, 28.937333333333342, 15.311999999999996, 19.790999999999997, 38.042, 50.66699999999996, 45.58199999999997, 17.656333333333325, 39.107, 15.934999999999997, 25.503666666666653, 54.43533333333332, 24.457666666666658, 35.77, 17.34633333333333, 35.43099999999999, 18.782333333333334, 19.584333333333326, 34.08933333333332, 51.50533333333334, 30.860333333333315, 60.51566666666667, 27.76133333333333, 28.85866666666665, 25.479, 42.21733333333334, 45.41733333333333, 27.983666666666664, 31.432666666666655, 37.43433333333332, 34.24199999999999, 39.177, 15.73199999999999, 31.705666666666687, 30.79700000000001, 42.71366666666666, 29.134333333333313, 20.13633333333332, 24.81133333333333, 52.312999999999995, 23.247999999999994, 33.188333333333325, 19.631999999999998, 24.816333333333333, 18.150999999999993, 31.866333333333316, 19.27733333333333, 45.06266666666664, 29.897000000000006, 14.830333333333328, 33.504999999999974, 19.32533333333333, 19.574, 18.64333333333333, 23.419333333333327, 22.259999999999998, 20.49533333333332, 21.855333333333334, 35.350333333333325, 74.9043333333334, 28.546666666666653, 22.32066666666666, 55.41166666666669, 20.058999999999997, 20.589666666666666, 32.027999999999984, 22.88433333333332, 14.347666666666663, 31.487999999999985, 28.431333333333335, 18.51466666666666, 25.660333333333334, 19.578999999999994, 48.635333333333314, 21.68633333333333, 29.100333333333325, 30.162, 16.636666666666656, 23.438999999999997, 38.319333333333326, 45.22333333333334, 18.877, 34.093666666666664, 17.781999999999996, 19.053999999999995, 22.016999999999985, 16.26766666666666, 23.23966666666667, 17.719999999999995, 31.280666666666672, 21.20133333333332, 21.681333333333317, 33.64033333333334, 33.19066666666667, 23.061999999999998], "episode_lengths": [42, 61, 37, 92, 47, 31, 63, 33, 36, 64, 111, 94, 58, 73, 32, 46, 90, 53, 72, 32, 70, 43, 37, 56, 95, 69, 108, 55, 56, 49, 64, 91, 54, 101, 83, 63, 74, 38, 64, 50, 74, 75, 46, 56, 108, 44, 79, 35, 48, 37, 90, 40, 102, 68, 35, 98, 45, 51, 52, 71, 64, 50, 47, 79, 121, 69, 43, 100, 38, 39, 80, 61, 30, 73, 63, 39, 50, 36, 97, 48, 57, 69, 39, 43, 67, 77, 35, 70, 39, 51, 62, 35, 47, 36, 54, 55, 47, 57, 63, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4876073846157702, "mean_inference_ms": 2.834481802160823, "mean_action_processing_ms": 0.570810704187834, "mean_env_wait_ms": 0.1388337044137563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01827406883239746, "StateBufferConnector_ms": 0.007502079010009766, "ViewRequirementAgentConnector_ms": 0.3021421432495117}}, "episode_reward_max": 74.9043333333334, "episode_reward_min": 14.347666666666663, "episode_reward_mean": 28.87866333333333, "episode_len_mean": 60.2, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.82999999999999, 24.319333333333333, 17.671999999999993, 44.195666666666696, 25.395999999999994, 15.323333333333332, 28.937333333333342, 15.311999999999996, 19.790999999999997, 38.042, 50.66699999999996, 45.58199999999997, 17.656333333333325, 39.107, 15.934999999999997, 25.503666666666653, 54.43533333333332, 24.457666666666658, 35.77, 17.34633333333333, 35.43099999999999, 18.782333333333334, 19.584333333333326, 34.08933333333332, 51.50533333333334, 30.860333333333315, 60.51566666666667, 27.76133333333333, 28.85866666666665, 25.479, 42.21733333333334, 45.41733333333333, 27.983666666666664, 31.432666666666655, 37.43433333333332, 34.24199999999999, 39.177, 15.73199999999999, 31.705666666666687, 30.79700000000001, 42.71366666666666, 29.134333333333313, 20.13633333333332, 24.81133333333333, 52.312999999999995, 23.247999999999994, 33.188333333333325, 19.631999999999998, 24.816333333333333, 18.150999999999993, 31.866333333333316, 19.27733333333333, 45.06266666666664, 29.897000000000006, 14.830333333333328, 33.504999999999974, 19.32533333333333, 19.574, 18.64333333333333, 23.419333333333327, 22.259999999999998, 20.49533333333332, 21.855333333333334, 35.350333333333325, 74.9043333333334, 28.546666666666653, 22.32066666666666, 55.41166666666669, 20.058999999999997, 20.589666666666666, 32.027999999999984, 22.88433333333332, 14.347666666666663, 31.487999999999985, 28.431333333333335, 18.51466666666666, 25.660333333333334, 19.578999999999994, 48.635333333333314, 21.68633333333333, 29.100333333333325, 30.162, 16.636666666666656, 23.438999999999997, 38.319333333333326, 45.22333333333334, 18.877, 34.093666666666664, 17.781999999999996, 19.053999999999995, 22.016999999999985, 16.26766666666666, 23.23966666666667, 17.719999999999995, 31.280666666666672, 21.20133333333332, 21.681333333333317, 33.64033333333334, 33.19066666666667, 23.061999999999998], "episode_lengths": [42, 61, 37, 92, 47, 31, 63, 33, 36, 64, 111, 94, 58, 73, 32, 46, 90, 53, 72, 32, 70, 43, 37, 56, 95, 69, 108, 55, 56, 49, 64, 91, 54, 101, 83, 63, 74, 38, 64, 50, 74, 75, 46, 56, 108, 44, 79, 35, 48, 37, 90, 40, 102, 68, 35, 98, 45, 51, 52, 71, 64, 50, 47, 79, 121, 69, 43, 100, 38, 39, 80, 61, 30, 73, 63, 39, 50, 36, 97, 48, 57, 69, 39, 43, 67, 77, 35, 70, 39, 51, 62, 35, 47, 36, 54, 55, 47, 57, 63, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4876073846157702, "mean_inference_ms": 2.834481802160823, "mean_action_processing_ms": 0.570810704187834, "mean_env_wait_ms": 0.1388337044137563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01827406883239746, "StateBufferConnector_ms": 0.007502079010009766, "ViewRequirementAgentConnector_ms": 0.3021421432495117}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 766.1120976022557, "num_env_steps_trained_throughput_per_sec": 766.1120976022557, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 5373.153, "sample_time_ms": 1928.538, "load_time_ms": 0.401, "load_throughput": 9973970.632, "learn_time_ms": 3428.272, "learn_throughput": 1166.769, "synch_weights_time_ms": 14.621}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 10806, "training_iteration": 149, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-51", "timestamp": 1702018731, "time_this_iter_s": 5.232155799865723, "time_total_s": 22378.824634552002, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22378.824634552002, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 69.77142857142857, "ram_util_percent": 92.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4.919871807098389, "policy_loss": -0.008139636367559433, "vf_loss": 4.928011417388916, "vf_explained_var": 0.6307846903800964, "kl": 0.003390452591702342, "entropy": 0.10723084211349487, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 139035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 58.06566666666673, "episode_reward_min": 13.955666666666668, "episode_reward_mean": 25.872456666666668, "episode_len_mean": 54.14, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.578999999999994, 48.635333333333314, 21.68633333333333, 29.100333333333325, 30.162, 16.636666666666656, 23.438999999999997, 38.319333333333326, 45.22333333333334, 18.877, 34.093666666666664, 17.781999999999996, 19.053999999999995, 22.016999999999985, 16.26766666666666, 23.23966666666667, 17.719999999999995, 31.280666666666672, 21.20133333333332, 21.681333333333317, 33.64033333333334, 33.19066666666667, 23.061999999999998, 58.06566666666673, 47.72866666666668, 30.81, 16.752333333333336, 20.92733333333333, 30.403666666666645, 26.218999999999987, 34.21300000000001, 25.519666666666662, 20.217666666666656, 17.191999999999997, 17.927333333333323, 21.479999999999997, 17.923333333333332, 35.9883333333333, 16.718666666666664, 26.836666666666666, 23.514666666666656, 55.62300000000003, 19.151999999999994, 35.115999999999985, 20.501333333333324, 17.84266666666666, 28.265333333333334, 15.69133333333333, 41.60099999999998, 24.85666666666666, 33.68433333333334, 44.82933333333334, 36.57433333333334, 14.265666666666666, 28.81566666666666, 22.68233333333332, 34.18599999999999, 25.493333333333325, 23.321666666666655, 19.58633333333333, 18.654666666666664, 34.16866666666667, 16.668666666666656, 18.03399999999999, 24.08533333333331, 30.646999999999995, 30.53599999999999, 24.069000000000003, 17.543333333333326, 35.88566666666667, 17.757999999999996, 33.995333333333335, 17.27199999999999, 28.23500000000001, 17.844666666666658, 17.608999999999995, 18.654666666666657, 32.898333333333305, 14.051666666666671, 19.54333333333333, 24.083666666666662, 16.504666666666665, 14.888333333333327, 16.604666666666667, 25.407666666666664, 19.426333333333325, 27.142666666666663, 17.928333333333327, 20.444333333333326, 17.036333333333324, 28.464666666666663, 24.254333333333328, 26.256, 35.601999999999975, 13.955666666666668, 18.965333333333323, 42.62600000000001, 19.022333333333325, 38.69200000000003, 35.37099999999998], "episode_lengths": [36, 97, 48, 57, 69, 39, 43, 67, 77, 35, 70, 39, 51, 62, 35, 47, 36, 54, 55, 47, 57, 63, 49, 103, 102, 54, 37, 52, 78, 59, 76, 57, 40, 34, 37, 54, 35, 104, 36, 46, 54, 81, 36, 80, 45, 47, 47, 32, 75, 53, 56, 79, 78, 29, 56, 56, 58, 49, 61, 52, 33, 62, 37, 35, 66, 50, 66, 54, 34, 71, 40, 68, 36, 56, 36, 39, 40, 82, 27, 42, 59, 32, 29, 31, 45, 39, 54, 36, 56, 40, 61, 62, 54, 82, 28, 62, 81, 44, 77, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.484419290295279, "mean_inference_ms": 2.8266065311115938, "mean_action_processing_ms": 0.5693455189520104, "mean_env_wait_ms": 0.1385650711533054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016448259353637695, "StateBufferConnector_ms": 0.019698143005371094, "ViewRequirementAgentConnector_ms": 0.332813024520874}}, "episode_reward_max": 58.06566666666673, "episode_reward_min": 13.955666666666668, "episode_reward_mean": 25.872456666666668, "episode_len_mean": 54.14, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.578999999999994, 48.635333333333314, 21.68633333333333, 29.100333333333325, 30.162, 16.636666666666656, 23.438999999999997, 38.319333333333326, 45.22333333333334, 18.877, 34.093666666666664, 17.781999999999996, 19.053999999999995, 22.016999999999985, 16.26766666666666, 23.23966666666667, 17.719999999999995, 31.280666666666672, 21.20133333333332, 21.681333333333317, 33.64033333333334, 33.19066666666667, 23.061999999999998, 58.06566666666673, 47.72866666666668, 30.81, 16.752333333333336, 20.92733333333333, 30.403666666666645, 26.218999999999987, 34.21300000000001, 25.519666666666662, 20.217666666666656, 17.191999999999997, 17.927333333333323, 21.479999999999997, 17.923333333333332, 35.9883333333333, 16.718666666666664, 26.836666666666666, 23.514666666666656, 55.62300000000003, 19.151999999999994, 35.115999999999985, 20.501333333333324, 17.84266666666666, 28.265333333333334, 15.69133333333333, 41.60099999999998, 24.85666666666666, 33.68433333333334, 44.82933333333334, 36.57433333333334, 14.265666666666666, 28.81566666666666, 22.68233333333332, 34.18599999999999, 25.493333333333325, 23.321666666666655, 19.58633333333333, 18.654666666666664, 34.16866666666667, 16.668666666666656, 18.03399999999999, 24.08533333333331, 30.646999999999995, 30.53599999999999, 24.069000000000003, 17.543333333333326, 35.88566666666667, 17.757999999999996, 33.995333333333335, 17.27199999999999, 28.23500000000001, 17.844666666666658, 17.608999999999995, 18.654666666666657, 32.898333333333305, 14.051666666666671, 19.54333333333333, 24.083666666666662, 16.504666666666665, 14.888333333333327, 16.604666666666667, 25.407666666666664, 19.426333333333325, 27.142666666666663, 17.928333333333327, 20.444333333333326, 17.036333333333324, 28.464666666666663, 24.254333333333328, 26.256, 35.601999999999975, 13.955666666666668, 18.965333333333323, 42.62600000000001, 19.022333333333325, 38.69200000000003, 35.37099999999998], "episode_lengths": [36, 97, 48, 57, 69, 39, 43, 67, 77, 35, 70, 39, 51, 62, 35, 47, 36, 54, 55, 47, 57, 63, 49, 103, 102, 54, 37, 52, 78, 59, 76, 57, 40, 34, 37, 54, 35, 104, 36, 46, 54, 81, 36, 80, 45, 47, 47, 32, 75, 53, 56, 79, 78, 29, 56, 56, 58, 49, 61, 52, 33, 62, 37, 35, 66, 50, 66, 54, 34, 71, 40, 68, 36, 56, 36, 39, 40, 82, 27, 42, 59, 32, 29, 31, 45, 39, 54, 36, 56, 40, 61, 62, 54, 82, 28, 62, 81, 44, 77, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.484419290295279, "mean_inference_ms": 2.8266065311115938, "mean_action_processing_ms": 0.5693455189520104, "mean_env_wait_ms": 0.1385650711533054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016448259353637695, "StateBufferConnector_ms": 0.019698143005371094, "ViewRequirementAgentConnector_ms": 0.332813024520874}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 724.9174740237289, "num_env_steps_trained_throughput_per_sec": 724.9174740237289, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 5364.032, "sample_time_ms": 1929.18, "load_time_ms": 0.401, "load_throughput": 9968636.958, "learn_time_ms": 3418.115, "learn_throughput": 1170.236, "synch_weights_time_ms": 14.915}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": true, "episodes_total": 10883, "training_iteration": 150, "trial_id": "ebb9e_00000", "date": "2023-12-07_22-58-57", "timestamp": 1702018737, "time_this_iter_s": 5.571167230606079, "time_total_s": 22384.395801782608, "pid": 8908, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001CB91C020E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22384.395801782608, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 69.44999999999999, "ram_util_percent": 91.8125}}
