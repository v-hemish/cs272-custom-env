{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 4.284846782684326, "policy_loss": -0.019449902698397636, "vf_loss": 4.300168037414551, "vf_explained_var": 0.3089064657688141, "kl": 0.02064448967576027, "entropy": 1.0783110857009888, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 17.019666666666666, "episode_reward_min": 5.476666666666667, "episode_reward_mean": 8.935190243902438, "episode_len_mean": 19.13658536585366, "episode_media": {}, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.998666666666667, 9.352666666666664, 9.709666666666665, 8.333, 9.513666666666662, 9.605666666666664, 9.480333333333336, 7.58833333333333, 10.551666666666666, 8.847333333333331, 8.942333333333334, 8.817666666666664, 7.235000000000001, 10.998999999999999, 8.888666666666664, 11.912000000000003, 9.812333333333333, 15.25066666666666, 7.832333333333332, 9.752666666666665, 8.776666666666667, 8.036333333333333, 7.280666666666666, 7.103333333333333, 9.379666666666665, 8.789333333333332, 6.866, 8.055666666666665, 7.482666666666667, 9.24033333333333, 9.303, 5.688, 8.072, 5.476666666666667, 7.829333333333332, 8.479333333333335, 9.613333333333333, 9.324333333333334, 7.814333333333332, 7.406, 10.262666666666666, 7.657666666666667, 12.112, 10.001999999999997, 8.721999999999998, 7.925333333333333, 8.377999999999997, 10.536999999999999, 14.201333333333336, 8.181999999999997, 7.904666666666666, 7.701999999999997, 7.1486666666666645, 7.727333333333332, 10.165999999999995, 7.9433333333333325, 9.939, 6.920999999999999, 9.401999999999997, 7.368333333333334, 9.304666666666664, 6.664666666666665, 9.301333333333332, 12.123000000000005, 10.427999999999997, 10.390666666666664, 9.610666666666665, 7.008666666666666, 6.377333333333333, 8.642, 7.258999999999999, 7.392666666666664, 8.610333333333331, 8.492666666666665, 10.996666666666666, 10.879999999999997, 8.091333333333333, 11.509666666666662, 9.476666666666665, 9.451999999999998, 8.135999999999997, 10.149666666666667, 8.64, 10.976999999999999, 9.98433333333333, 10.315333333333335, 8.530666666666669, 7.6003333333333325, 7.587999999999998, 11.08333333333333, 10.087333333333332, 6.987666666666668, 7.8726666666666665, 7.156999999999999, 8.249666666666666, 6.7799999999999985, 9.572333333333333, 8.074, 8.678333333333333, 10.504333333333332, 10.424999999999995, 10.329333333333334, 6.908666666666665, 8.142, 9.207333333333333, 8.212333333333332, 8.390666666666664, 9.948, 7.908666666666666, 8.399666666666667, 8.485333333333333, 8.31033333333333, 9.703666666666665, 13.547000000000002, 8.551999999999998, 7.826666666666667, 9.921666666666669, 9.577333333333332, 8.82033333333333, 7.027666666666666, 9.546333333333333, 10.602666666666662, 12.530999999999997, 7.680666666666667, 9.659333333333333, 11.123999999999999, 8.098666666666666, 9.677999999999997, 7.563333333333333, 6.909000000000002, 7.971666666666668, 10.44166666666667, 10.612999999999998, 7.137333333333334, 8.315999999999999, 9.041666666666664, 8.61833333333333, 9.217333333333332, 6.824000000000001, 6.466666666666665, 6.773666666666667, 7.743333333333332, 8.194333333333333, 9.604666666666665, 9.735999999999995, 9.039666666666665, 7.169666666666665, 7.09133333333333, 7.799999999999997, 7.050333333333334, 9.651999999999997, 9.390666666666666, 7.897000000000001, 10.88633333333333, 17.019666666666666, 10.619666666666664, 8.515666666666664, 9.866999999999999, 7.707000000000001, 8.276666666666666, 7.136666666666667, 8.991999999999999, 6.101, 6.023666666666666, 8.010666666666667, 9.183000000000002, 8.827, 6.629, 9.478666666666667, 8.951666666666666, 11.033000000000001, 9.009333333333332, 11.762999999999996, 6.143000000000001, 10.193999999999997, 8.498999999999999, 9.582333333333333, 12.096666666666664, 7.901999999999998, 7.444666666666668, 7.3389999999999995, 6.172333333333333, 9.015999999999998, 7.571999999999999, 7.432333333333332, 6.076999999999998, 11.118333333333334, 9.351, 10.24333333333333, 10.972333333333331, 8.382999999999997, 9.537, 12.072999999999999, 16.838666666666665, 8.57333333333333, 7.8373333333333335, 8.781666666666666, 10.066999999999995, 9.558333333333332, 7.429000000000001, 7.440666666666665, 11.986333333333334, 6.570999999999999, 12.979666666666665, 9.021999999999998], "episode_lengths": [16, 19, 24, 18, 19, 20, 21, 17, 23, 18, 19, 19, 17, 24, 22, 25, 21, 28, 19, 18, 18, 17, 18, 17, 18, 17, 15, 18, 17, 21, 20, 13, 18, 12, 20, 17, 21, 21, 16, 16, 20, 17, 24, 20, 17, 17, 19, 20, 28, 16, 16, 17, 16, 19, 20, 16, 20, 16, 19, 16, 18, 14, 19, 30, 20, 21, 20, 15, 14, 20, 17, 17, 17, 19, 25, 21, 17, 25, 19, 19, 17, 24, 20, 21, 24, 23, 18, 15, 16, 23, 23, 16, 17, 16, 16, 16, 22, 19, 20, 21, 23, 21, 15, 18, 18, 17, 18, 21, 19, 17, 17, 18, 21, 30, 22, 16, 21, 20, 20, 15, 20, 27, 25, 16, 19, 22, 16, 20, 17, 17, 16, 22, 25, 16, 19, 23, 17, 22, 16, 15, 16, 16, 18, 19, 20, 21, 16, 14, 18, 17, 21, 20, 18, 25, 34, 20, 19, 19, 18, 16, 16, 18, 15, 13, 17, 19, 18, 15, 19, 20, 26, 19, 25, 14, 21, 17, 21, 24, 16, 16, 19, 14, 20, 17, 16, 14, 25, 20, 21, 21, 18, 19, 23, 28, 18, 17, 19, 21, 21, 15, 16, 25, 16, 26, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1437625646440663, "mean_inference_ms": 2.103229476677327, "mean_action_processing_ms": 0.4166947003041265, "mean_env_wait_ms": 0.1002898959852583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02252916010414682, "StateBufferConnector_ms": 0.016234444408881957, "ViewRequirementAgentConnector_ms": 0.3517013642846084}}, "episode_reward_max": 17.019666666666666, "episode_reward_min": 5.476666666666667, "episode_reward_mean": 8.935190243902438, "episode_len_mean": 19.13658536585366, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.998666666666667, 9.352666666666664, 9.709666666666665, 8.333, 9.513666666666662, 9.605666666666664, 9.480333333333336, 7.58833333333333, 10.551666666666666, 8.847333333333331, 8.942333333333334, 8.817666666666664, 7.235000000000001, 10.998999999999999, 8.888666666666664, 11.912000000000003, 9.812333333333333, 15.25066666666666, 7.832333333333332, 9.752666666666665, 8.776666666666667, 8.036333333333333, 7.280666666666666, 7.103333333333333, 9.379666666666665, 8.789333333333332, 6.866, 8.055666666666665, 7.482666666666667, 9.24033333333333, 9.303, 5.688, 8.072, 5.476666666666667, 7.829333333333332, 8.479333333333335, 9.613333333333333, 9.324333333333334, 7.814333333333332, 7.406, 10.262666666666666, 7.657666666666667, 12.112, 10.001999999999997, 8.721999999999998, 7.925333333333333, 8.377999999999997, 10.536999999999999, 14.201333333333336, 8.181999999999997, 7.904666666666666, 7.701999999999997, 7.1486666666666645, 7.727333333333332, 10.165999999999995, 7.9433333333333325, 9.939, 6.920999999999999, 9.401999999999997, 7.368333333333334, 9.304666666666664, 6.664666666666665, 9.301333333333332, 12.123000000000005, 10.427999999999997, 10.390666666666664, 9.610666666666665, 7.008666666666666, 6.377333333333333, 8.642, 7.258999999999999, 7.392666666666664, 8.610333333333331, 8.492666666666665, 10.996666666666666, 10.879999999999997, 8.091333333333333, 11.509666666666662, 9.476666666666665, 9.451999999999998, 8.135999999999997, 10.149666666666667, 8.64, 10.976999999999999, 9.98433333333333, 10.315333333333335, 8.530666666666669, 7.6003333333333325, 7.587999999999998, 11.08333333333333, 10.087333333333332, 6.987666666666668, 7.8726666666666665, 7.156999999999999, 8.249666666666666, 6.7799999999999985, 9.572333333333333, 8.074, 8.678333333333333, 10.504333333333332, 10.424999999999995, 10.329333333333334, 6.908666666666665, 8.142, 9.207333333333333, 8.212333333333332, 8.390666666666664, 9.948, 7.908666666666666, 8.399666666666667, 8.485333333333333, 8.31033333333333, 9.703666666666665, 13.547000000000002, 8.551999999999998, 7.826666666666667, 9.921666666666669, 9.577333333333332, 8.82033333333333, 7.027666666666666, 9.546333333333333, 10.602666666666662, 12.530999999999997, 7.680666666666667, 9.659333333333333, 11.123999999999999, 8.098666666666666, 9.677999999999997, 7.563333333333333, 6.909000000000002, 7.971666666666668, 10.44166666666667, 10.612999999999998, 7.137333333333334, 8.315999999999999, 9.041666666666664, 8.61833333333333, 9.217333333333332, 6.824000000000001, 6.466666666666665, 6.773666666666667, 7.743333333333332, 8.194333333333333, 9.604666666666665, 9.735999999999995, 9.039666666666665, 7.169666666666665, 7.09133333333333, 7.799999999999997, 7.050333333333334, 9.651999999999997, 9.390666666666666, 7.897000000000001, 10.88633333333333, 17.019666666666666, 10.619666666666664, 8.515666666666664, 9.866999999999999, 7.707000000000001, 8.276666666666666, 7.136666666666667, 8.991999999999999, 6.101, 6.023666666666666, 8.010666666666667, 9.183000000000002, 8.827, 6.629, 9.478666666666667, 8.951666666666666, 11.033000000000001, 9.009333333333332, 11.762999999999996, 6.143000000000001, 10.193999999999997, 8.498999999999999, 9.582333333333333, 12.096666666666664, 7.901999999999998, 7.444666666666668, 7.3389999999999995, 6.172333333333333, 9.015999999999998, 7.571999999999999, 7.432333333333332, 6.076999999999998, 11.118333333333334, 9.351, 10.24333333333333, 10.972333333333331, 8.382999999999997, 9.537, 12.072999999999999, 16.838666666666665, 8.57333333333333, 7.8373333333333335, 8.781666666666666, 10.066999999999995, 9.558333333333332, 7.429000000000001, 7.440666666666665, 11.986333333333334, 6.570999999999999, 12.979666666666665, 9.021999999999998], "episode_lengths": [16, 19, 24, 18, 19, 20, 21, 17, 23, 18, 19, 19, 17, 24, 22, 25, 21, 28, 19, 18, 18, 17, 18, 17, 18, 17, 15, 18, 17, 21, 20, 13, 18, 12, 20, 17, 21, 21, 16, 16, 20, 17, 24, 20, 17, 17, 19, 20, 28, 16, 16, 17, 16, 19, 20, 16, 20, 16, 19, 16, 18, 14, 19, 30, 20, 21, 20, 15, 14, 20, 17, 17, 17, 19, 25, 21, 17, 25, 19, 19, 17, 24, 20, 21, 24, 23, 18, 15, 16, 23, 23, 16, 17, 16, 16, 16, 22, 19, 20, 21, 23, 21, 15, 18, 18, 17, 18, 21, 19, 17, 17, 18, 21, 30, 22, 16, 21, 20, 20, 15, 20, 27, 25, 16, 19, 22, 16, 20, 17, 17, 16, 22, 25, 16, 19, 23, 17, 22, 16, 15, 16, 16, 18, 19, 20, 21, 16, 14, 18, 17, 21, 20, 18, 25, 34, 20, 19, 19, 18, 16, 16, 18, 15, 13, 17, 19, 18, 15, 19, 20, 26, 19, 25, 14, 21, 17, 21, 24, 16, 16, 19, 14, 20, 17, 16, 14, 25, 20, 21, 21, 18, 19, 23, 28, 18, 17, 19, 21, 21, 15, 16, 25, 16, 26, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1437625646440663, "mean_inference_ms": 2.103229476677327, "mean_action_processing_ms": 0.4166947003041265, "mean_env_wait_ms": 0.1002898959852583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02252916010414682, "StateBufferConnector_ms": 0.016234444408881957, "ViewRequirementAgentConnector_ms": 0.3517013642846084}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 652.0869311599092, "num_env_steps_trained_throughput_per_sec": 652.0869311599092, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 6133.081, "sample_time_ms": 2217.193, "load_time_ms": 1.002, "load_throughput": 3990774.5, "learn_time_ms": 3879.888, "learn_throughput": 1030.958, "synch_weights_time_ms": 18.071}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 205, "training_iteration": 1, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-10", "timestamp": 1701995170, "time_this_iter_s": 6.147841691970825, "time_total_s": 6.147841691970825, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.147841691970825, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 70.07777777777777, "ram_util_percent": 95.52222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8278628587722778, "policy_loss": -0.02612949348986149, "vf_loss": 1.8466665744781494, "vf_explained_var": 0.7736490964889526, "kl": 0.02441946603357792, "entropy": 1.0090190172195435, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 17.749999999999993, "episode_reward_min": 6.263333333333334, "episode_reward_mean": 9.816743986254295, "episode_len_mean": 20.608247422680414, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.092666666666668, 7.766000000000001, 8.160333333333334, 9.902666666666665, 14.22033333333333, 9.611, 9.500666666666667, 8.278333333333336, 7.527333333333333, 10.84633333333333, 14.164333333333332, 7.872, 8.460333333333335, 9.565333333333333, 7.464666666666665, 7.570666666666665, 7.331999999999999, 10.676999999999998, 9.247666666666667, 10.208333333333332, 14.652000000000001, 8.743333333333332, 14.961666666666657, 9.941666666666666, 7.905333333333332, 9.153333333333334, 7.313999999999998, 9.904666666666662, 9.144, 10.254999999999999, 13.188666666666666, 7.602666666666668, 8.426666666666666, 8.677666666666665, 9.185333333333332, 10.98233333333333, 9.168666666666667, 11.747999999999998, 8.505333333333333, 10.790999999999997, 10.335333333333331, 7.874, 9.857, 8.692333333333334, 10.861666666666666, 12.04866666666667, 9.037333333333331, 7.807999999999999, 9.671999999999999, 10.003333333333334, 15.184333333333335, 11.969999999999999, 9.627666666666666, 6.552666666666666, 12.54433333333333, 12.84733333333333, 8.279000000000002, 8.319999999999999, 9.205333333333334, 10.77833333333333, 10.711666666666662, 11.622999999999996, 9.466666666666669, 7.773333333333332, 8.220999999999997, 9.158999999999997, 9.104666666666663, 8.812000000000001, 8.318666666666667, 6.674666666666664, 10.187666666666669, 8.873666666666663, 11.429333333333332, 7.826999999999999, 11.13933333333333, 9.899333333333333, 7.468666666666666, 12.37933333333333, 8.994666666666665, 9.862666666666668, 7.508666666666665, 7.555333333333332, 12.586333333333334, 8.686333333333332, 8.243333333333332, 12.365333333333327, 9.08933333333333, 9.736333333333333, 10.071, 9.574666666666666, 8.583666666666666, 9.140666666666668, 8.693000000000001, 10.521, 8.107999999999999, 7.962999999999999, 11.021999999999997, 11.261666666666668, 8.569333333333333, 8.499, 9.778333333333332, 10.622666666666662, 17.749999999999993, 14.614666666666666, 10.460666666666665, 11.294, 8.318999999999999, 9.186666666666667, 9.501, 11.321999999999994, 9.129999999999999, 9.675333333333331, 13.716999999999999, 12.090666666666667, 7.490333333333334, 11.732, 11.776000000000003, 11.467666666666668, 15.663666666666666, 9.981, 8.568, 10.894, 14.467666666666664, 8.267999999999999, 7.832333333333333, 8.068666666666665, 9.080666666666668, 12.244333333333335, 10.33666666666667, 9.057666666666664, 6.782666666666666, 6.389333333333333, 12.207333333333331, 8.278333333333334, 10.371333333333334, 8.515, 10.807333333333332, 11.948999999999998, 8.342333333333334, 6.263333333333334, 10.131666666666664, 7.648666666666665, 11.513, 8.111999999999998, 12.159666666666666, 7.075, 11.819999999999997, 8.219666666666663, 10.427333333333333, 9.00333333333333, 9.830666666666662, 9.530333333333335, 8.288666666666666, 7.759, 8.805333333333333, 8.024666666666665, 7.651333333333333, 7.309333333333332, 12.055000000000001, 10.532, 10.462, 10.162999999999997, 11.739999999999997, 10.010666666666664, 10.469999999999999, 10.229666666666667, 11.771333333333333, 7.169999999999998, 10.002666666666666, 13.551666666666662, 9.115999999999998, 8.644666666666664, 6.403666666666666, 11.732666666666669, 7.808, 6.898, 9.657666666666666, 14.140999999999998, 7.885333333333332, 10.329999999999998, 6.957666666666666, 8.097999999999999, 7.978666666666665, 9.823, 7.365666666666665, 12.543999999999999, 11.203999999999997, 9.692333333333332, 10.831666666666667, 9.503, 9.242333333333333, 10.644000000000002, 10.845666666666668, 10.414666666666667], "episode_lengths": [30, 17, 18, 19, 29, 20, 21, 18, 16, 20, 32, 16, 19, 23, 18, 18, 15, 24, 21, 20, 29, 18, 29, 22, 16, 18, 19, 20, 17, 20, 27, 16, 17, 19, 18, 22, 19, 24, 17, 23, 21, 17, 22, 19, 22, 28, 19, 16, 20, 22, 30, 22, 19, 14, 27, 24, 21, 18, 19, 23, 21, 25, 17, 15, 16, 18, 20, 19, 16, 16, 23, 20, 22, 18, 26, 20, 16, 26, 20, 24, 16, 19, 26, 18, 19, 25, 21, 21, 20, 19, 18, 18, 18, 20, 19, 15, 21, 28, 17, 17, 22, 22, 34, 30, 23, 23, 17, 17, 19, 25, 18, 19, 29, 24, 17, 23, 25, 24, 32, 23, 18, 23, 29, 19, 17, 17, 18, 26, 21, 18, 15, 14, 24, 17, 20, 18, 23, 24, 18, 13, 24, 16, 24, 17, 27, 15, 25, 16, 21, 19, 21, 20, 17, 16, 17, 17, 15, 17, 22, 21, 23, 22, 25, 22, 24, 20, 24, 15, 21, 25, 21, 19, 16, 24, 16, 14, 19, 29, 16, 22, 17, 17, 16, 22, 17, 29, 21, 22, 23, 23, 20, 24, 23, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1547991853931636, "mean_inference_ms": 2.111538004806391, "mean_action_processing_ms": 0.4321371903826814, "mean_env_wait_ms": 0.10491130121274146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02089148944186181, "StateBufferConnector_ms": 0.013073080593777686, "ViewRequirementAgentConnector_ms": 0.35537370701426085}}, "episode_reward_max": 17.749999999999993, "episode_reward_min": 6.263333333333334, "episode_reward_mean": 9.816743986254295, "episode_len_mean": 20.608247422680414, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.092666666666668, 7.766000000000001, 8.160333333333334, 9.902666666666665, 14.22033333333333, 9.611, 9.500666666666667, 8.278333333333336, 7.527333333333333, 10.84633333333333, 14.164333333333332, 7.872, 8.460333333333335, 9.565333333333333, 7.464666666666665, 7.570666666666665, 7.331999999999999, 10.676999999999998, 9.247666666666667, 10.208333333333332, 14.652000000000001, 8.743333333333332, 14.961666666666657, 9.941666666666666, 7.905333333333332, 9.153333333333334, 7.313999999999998, 9.904666666666662, 9.144, 10.254999999999999, 13.188666666666666, 7.602666666666668, 8.426666666666666, 8.677666666666665, 9.185333333333332, 10.98233333333333, 9.168666666666667, 11.747999999999998, 8.505333333333333, 10.790999999999997, 10.335333333333331, 7.874, 9.857, 8.692333333333334, 10.861666666666666, 12.04866666666667, 9.037333333333331, 7.807999999999999, 9.671999999999999, 10.003333333333334, 15.184333333333335, 11.969999999999999, 9.627666666666666, 6.552666666666666, 12.54433333333333, 12.84733333333333, 8.279000000000002, 8.319999999999999, 9.205333333333334, 10.77833333333333, 10.711666666666662, 11.622999999999996, 9.466666666666669, 7.773333333333332, 8.220999999999997, 9.158999999999997, 9.104666666666663, 8.812000000000001, 8.318666666666667, 6.674666666666664, 10.187666666666669, 8.873666666666663, 11.429333333333332, 7.826999999999999, 11.13933333333333, 9.899333333333333, 7.468666666666666, 12.37933333333333, 8.994666666666665, 9.862666666666668, 7.508666666666665, 7.555333333333332, 12.586333333333334, 8.686333333333332, 8.243333333333332, 12.365333333333327, 9.08933333333333, 9.736333333333333, 10.071, 9.574666666666666, 8.583666666666666, 9.140666666666668, 8.693000000000001, 10.521, 8.107999999999999, 7.962999999999999, 11.021999999999997, 11.261666666666668, 8.569333333333333, 8.499, 9.778333333333332, 10.622666666666662, 17.749999999999993, 14.614666666666666, 10.460666666666665, 11.294, 8.318999999999999, 9.186666666666667, 9.501, 11.321999999999994, 9.129999999999999, 9.675333333333331, 13.716999999999999, 12.090666666666667, 7.490333333333334, 11.732, 11.776000000000003, 11.467666666666668, 15.663666666666666, 9.981, 8.568, 10.894, 14.467666666666664, 8.267999999999999, 7.832333333333333, 8.068666666666665, 9.080666666666668, 12.244333333333335, 10.33666666666667, 9.057666666666664, 6.782666666666666, 6.389333333333333, 12.207333333333331, 8.278333333333334, 10.371333333333334, 8.515, 10.807333333333332, 11.948999999999998, 8.342333333333334, 6.263333333333334, 10.131666666666664, 7.648666666666665, 11.513, 8.111999999999998, 12.159666666666666, 7.075, 11.819999999999997, 8.219666666666663, 10.427333333333333, 9.00333333333333, 9.830666666666662, 9.530333333333335, 8.288666666666666, 7.759, 8.805333333333333, 8.024666666666665, 7.651333333333333, 7.309333333333332, 12.055000000000001, 10.532, 10.462, 10.162999999999997, 11.739999999999997, 10.010666666666664, 10.469999999999999, 10.229666666666667, 11.771333333333333, 7.169999999999998, 10.002666666666666, 13.551666666666662, 9.115999999999998, 8.644666666666664, 6.403666666666666, 11.732666666666669, 7.808, 6.898, 9.657666666666666, 14.140999999999998, 7.885333333333332, 10.329999999999998, 6.957666666666666, 8.097999999999999, 7.978666666666665, 9.823, 7.365666666666665, 12.543999999999999, 11.203999999999997, 9.692333333333332, 10.831666666666667, 9.503, 9.242333333333333, 10.644000000000002, 10.845666666666668, 10.414666666666667], "episode_lengths": [30, 17, 18, 19, 29, 20, 21, 18, 16, 20, 32, 16, 19, 23, 18, 18, 15, 24, 21, 20, 29, 18, 29, 22, 16, 18, 19, 20, 17, 20, 27, 16, 17, 19, 18, 22, 19, 24, 17, 23, 21, 17, 22, 19, 22, 28, 19, 16, 20, 22, 30, 22, 19, 14, 27, 24, 21, 18, 19, 23, 21, 25, 17, 15, 16, 18, 20, 19, 16, 16, 23, 20, 22, 18, 26, 20, 16, 26, 20, 24, 16, 19, 26, 18, 19, 25, 21, 21, 20, 19, 18, 18, 18, 20, 19, 15, 21, 28, 17, 17, 22, 22, 34, 30, 23, 23, 17, 17, 19, 25, 18, 19, 29, 24, 17, 23, 25, 24, 32, 23, 18, 23, 29, 19, 17, 17, 18, 26, 21, 18, 15, 14, 24, 17, 20, 18, 23, 24, 18, 13, 24, 16, 24, 17, 27, 15, 25, 16, 21, 19, 21, 20, 17, 16, 17, 17, 15, 17, 22, 21, 23, 22, 25, 22, 24, 20, 24, 15, 21, 25, 21, 19, 16, 24, 16, 14, 19, 29, 16, 22, 17, 17, 16, 22, 17, 29, 21, 22, 23, 23, 20, 24, 23, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1547991853931636, "mean_inference_ms": 2.111538004806391, "mean_action_processing_ms": 0.4321371903826814, "mean_env_wait_ms": 0.10491130121274146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02089148944186181, "StateBufferConnector_ms": 0.013073080593777686, "ViewRequirementAgentConnector_ms": 0.35537370701426085}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 665.9042557350598, "num_env_steps_trained_throughput_per_sec": 665.9042557350598, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 6069.975, "sample_time_ms": 2239.341, "load_time_ms": 0.501, "load_throughput": 7981549.001, "learn_time_ms": 3805.134, "learn_throughput": 1051.211, "synch_weights_time_ms": 15.537}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 399, "training_iteration": 2, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-16", "timestamp": 1701995176, "time_this_iter_s": 6.018866539001465, "time_total_s": 12.16670823097229, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 12.16670823097229, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 66.375, "ram_util_percent": 89.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 4.999999873689376e-05, "total_loss": 2.117102861404419, "policy_loss": -0.038359615951776505, "vf_loss": 2.144136667251587, "vf_explained_var": 0.7885146141052246, "kl": 0.025168897584080696, "entropy": 0.9020469784736633, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 18.58866666666666, "episode_reward_min": 6.099666666666666, "episode_reward_mean": 10.881041666666665, "episode_len_mean": 22.789772727272727, "episode_media": {}, "episodes_this_iter": 176, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.052333333333333, 10.442333333333334, 11.677999999999999, 8.901333333333334, 10.206333333333331, 9.032999999999998, 8.830666666666664, 10.620000000000001, 9.096333333333334, 11.586666666666662, 9.158, 12.144666666666664, 13.001333333333331, 9.445333333333332, 15.209333333333333, 13.08633333333333, 10.800999999999998, 9.253666666666668, 13.849666666666659, 8.217333333333332, 10.27266666666667, 11.522333333333334, 15.516666666666662, 12.347999999999994, 6.099666666666666, 8.893333333333334, 12.702666666666666, 8.440666666666665, 7.5, 9.164333333333332, 11.693666666666665, 11.153999999999998, 8.533333333333331, 8.784666666666666, 10.35533333333333, 8.377333333333333, 12.645333333333326, 11.769999999999998, 12.174, 11.31033333333333, 8.874999999999998, 12.578999999999999, 12.284999999999995, 12.400666666666671, 16.11733333333333, 10.460333333333333, 14.985333333333326, 13.985333333333324, 8.583999999999998, 14.821333333333333, 9.431333333333331, 11.319666666666667, 10.513999999999998, 10.120666666666667, 11.782, 11.821333333333326, 13.77766666666666, 11.107999999999997, 13.231, 8.416333333333332, 16.96666666666666, 12.568666666666664, 9.183333333333332, 8.630666666666665, 11.823333333333332, 9.204666666666665, 9.89433333333333, 11.558666666666666, 11.625999999999998, 10.680666666666669, 16.944333333333333, 7.948666666666665, 16.97466666666666, 10.92133333333333, 9.118666666666668, 9.004666666666665, 9.210666666666667, 7.3726666666666665, 10.480666666666668, 6.715333333333333, 10.319666666666667, 9.653000000000002, 9.320666666666664, 11.893666666666666, 9.628333333333332, 9.849666666666666, 9.64533333333333, 9.187333333333331, 9.562000000000003, 10.410666666666664, 8.469999999999999, 8.769000000000002, 11.089000000000002, 9.856666666666664, 8.851666666666667, 15.020666666666662, 13.669999999999996, 8.142333333333333, 8.198333333333332, 14.398999999999997, 8.474, 8.235333333333335, 11.751333333333331, 10.127333333333329, 13.812, 10.366333333333332, 14.141999999999998, 15.250666666666659, 15.00699999999999, 13.052666666666667, 8.498666666666663, 9.691999999999998, 12.85733333333333, 10.127666666666666, 9.687333333333333, 11.352666666666664, 10.066333333333333, 10.282, 9.715666666666666, 10.190333333333333, 10.263333333333332, 12.663333333333332, 11.114333333333333, 10.724999999999998, 7.312666666666667, 9.252666666666665, 7.973999999999999, 7.729666666666667, 9.261333333333333, 8.77, 10.947999999999999, 18.58866666666666, 8.295333333333332, 8.124666666666666, 14.604, 10.221, 12.715666666666664, 12.213999999999999, 9.801333333333332, 10.791333333333332, 13.384333333333332, 10.535999999999996, 9.353666666666667, 10.105999999999998, 6.481333333333333, 7.584333333333333, 10.01, 11.842333333333332, 17.595666666666663, 13.195999999999996, 12.141999999999998, 11.308333333333335, 14.378666666666657, 10.09533333333333, 12.429999999999994, 10.861666666666666, 8.513, 9.465666666666667, 8.742, 10.459999999999996, 10.863999999999999, 13.495333333333331, 12.170666666666667, 9.003999999999998, 8.551333333333332, 11.882666666666667, 14.186333333333332, 9.939666666666668, 12.124666666666664, 16.11133333333332, 9.315999999999999, 10.645000000000001, 12.94866666666666, 12.867333333333335, 9.445, 7.712999999999999], "episode_lengths": [18, 24, 27, 22, 22, 18, 20, 23, 21, 23, 21, 23, 28, 21, 29, 29, 22, 21, 29, 18, 25, 23, 35, 27, 13, 19, 25, 17, 16, 21, 21, 22, 17, 18, 20, 18, 27, 24, 27, 23, 20, 26, 25, 27, 30, 22, 32, 34, 19, 31, 21, 23, 22, 23, 25, 22, 29, 23, 27, 19, 33, 25, 19, 17, 26, 18, 18, 24, 21, 25, 35, 18, 34, 23, 20, 21, 21, 16, 21, 15, 22, 20, 19, 25, 19, 20, 20, 19, 19, 22, 17, 20, 26, 19, 17, 32, 30, 17, 16, 25, 18, 18, 26, 22, 32, 24, 35, 30, 29, 27, 19, 19, 25, 23, 23, 25, 20, 24, 23, 22, 21, 23, 23, 21, 16, 22, 17, 17, 19, 16, 21, 32, 18, 19, 28, 22, 29, 24, 18, 25, 28, 21, 23, 20, 15, 17, 23, 24, 34, 25, 26, 23, 29, 20, 22, 21, 20, 21, 20, 22, 21, 25, 23, 21, 17, 25, 29, 24, 23, 30, 20, 23, 27, 26, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1323871632900377, "mean_inference_ms": 2.084459723113108, "mean_action_processing_ms": 0.4288296456880721, "mean_env_wait_ms": 0.10746000277590334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013189695098183372, "StateBufferConnector_ms": 0.012311339378356934, "ViewRequirementAgentConnector_ms": 0.3361235965381969}}, "episode_reward_max": 18.58866666666666, "episode_reward_min": 6.099666666666666, "episode_reward_mean": 10.881041666666665, "episode_len_mean": 22.789772727272727, "episodes_this_iter": 176, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.052333333333333, 10.442333333333334, 11.677999999999999, 8.901333333333334, 10.206333333333331, 9.032999999999998, 8.830666666666664, 10.620000000000001, 9.096333333333334, 11.586666666666662, 9.158, 12.144666666666664, 13.001333333333331, 9.445333333333332, 15.209333333333333, 13.08633333333333, 10.800999999999998, 9.253666666666668, 13.849666666666659, 8.217333333333332, 10.27266666666667, 11.522333333333334, 15.516666666666662, 12.347999999999994, 6.099666666666666, 8.893333333333334, 12.702666666666666, 8.440666666666665, 7.5, 9.164333333333332, 11.693666666666665, 11.153999999999998, 8.533333333333331, 8.784666666666666, 10.35533333333333, 8.377333333333333, 12.645333333333326, 11.769999999999998, 12.174, 11.31033333333333, 8.874999999999998, 12.578999999999999, 12.284999999999995, 12.400666666666671, 16.11733333333333, 10.460333333333333, 14.985333333333326, 13.985333333333324, 8.583999999999998, 14.821333333333333, 9.431333333333331, 11.319666666666667, 10.513999999999998, 10.120666666666667, 11.782, 11.821333333333326, 13.77766666666666, 11.107999999999997, 13.231, 8.416333333333332, 16.96666666666666, 12.568666666666664, 9.183333333333332, 8.630666666666665, 11.823333333333332, 9.204666666666665, 9.89433333333333, 11.558666666666666, 11.625999999999998, 10.680666666666669, 16.944333333333333, 7.948666666666665, 16.97466666666666, 10.92133333333333, 9.118666666666668, 9.004666666666665, 9.210666666666667, 7.3726666666666665, 10.480666666666668, 6.715333333333333, 10.319666666666667, 9.653000000000002, 9.320666666666664, 11.893666666666666, 9.628333333333332, 9.849666666666666, 9.64533333333333, 9.187333333333331, 9.562000000000003, 10.410666666666664, 8.469999999999999, 8.769000000000002, 11.089000000000002, 9.856666666666664, 8.851666666666667, 15.020666666666662, 13.669999999999996, 8.142333333333333, 8.198333333333332, 14.398999999999997, 8.474, 8.235333333333335, 11.751333333333331, 10.127333333333329, 13.812, 10.366333333333332, 14.141999999999998, 15.250666666666659, 15.00699999999999, 13.052666666666667, 8.498666666666663, 9.691999999999998, 12.85733333333333, 10.127666666666666, 9.687333333333333, 11.352666666666664, 10.066333333333333, 10.282, 9.715666666666666, 10.190333333333333, 10.263333333333332, 12.663333333333332, 11.114333333333333, 10.724999999999998, 7.312666666666667, 9.252666666666665, 7.973999999999999, 7.729666666666667, 9.261333333333333, 8.77, 10.947999999999999, 18.58866666666666, 8.295333333333332, 8.124666666666666, 14.604, 10.221, 12.715666666666664, 12.213999999999999, 9.801333333333332, 10.791333333333332, 13.384333333333332, 10.535999999999996, 9.353666666666667, 10.105999999999998, 6.481333333333333, 7.584333333333333, 10.01, 11.842333333333332, 17.595666666666663, 13.195999999999996, 12.141999999999998, 11.308333333333335, 14.378666666666657, 10.09533333333333, 12.429999999999994, 10.861666666666666, 8.513, 9.465666666666667, 8.742, 10.459999999999996, 10.863999999999999, 13.495333333333331, 12.170666666666667, 9.003999999999998, 8.551333333333332, 11.882666666666667, 14.186333333333332, 9.939666666666668, 12.124666666666664, 16.11133333333332, 9.315999999999999, 10.645000000000001, 12.94866666666666, 12.867333333333335, 9.445, 7.712999999999999], "episode_lengths": [18, 24, 27, 22, 22, 18, 20, 23, 21, 23, 21, 23, 28, 21, 29, 29, 22, 21, 29, 18, 25, 23, 35, 27, 13, 19, 25, 17, 16, 21, 21, 22, 17, 18, 20, 18, 27, 24, 27, 23, 20, 26, 25, 27, 30, 22, 32, 34, 19, 31, 21, 23, 22, 23, 25, 22, 29, 23, 27, 19, 33, 25, 19, 17, 26, 18, 18, 24, 21, 25, 35, 18, 34, 23, 20, 21, 21, 16, 21, 15, 22, 20, 19, 25, 19, 20, 20, 19, 19, 22, 17, 20, 26, 19, 17, 32, 30, 17, 16, 25, 18, 18, 26, 22, 32, 24, 35, 30, 29, 27, 19, 19, 25, 23, 23, 25, 20, 24, 23, 22, 21, 23, 23, 21, 16, 22, 17, 17, 19, 16, 21, 32, 18, 19, 28, 22, 29, 24, 18, 25, 28, 21, 23, 20, 15, 17, 23, 24, 34, 25, 26, 23, 29, 20, 22, 21, 20, 21, 20, 22, 21, 25, 23, 21, 17, 25, 29, 24, 23, 30, 20, 23, 27, 26, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1323871632900377, "mean_inference_ms": 2.084459723113108, "mean_action_processing_ms": 0.4288296456880721, "mean_env_wait_ms": 0.10746000277590334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013189695098183372, "StateBufferConnector_ms": 0.012311339378356934, "ViewRequirementAgentConnector_ms": 0.3361235965381969}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 752.311668348588, "num_env_steps_trained_throughput_per_sec": 752.311668348588, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 5818.965, "sample_time_ms": 2207.707, "load_time_ms": 0.667, "load_throughput": 5994003.573, "learn_time_ms": 3587.891, "learn_throughput": 1114.861, "synch_weights_time_ms": 16.027}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 575, "training_iteration": 3, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-21", "timestamp": 1701995181, "time_this_iter_s": 5.34103536605835, "time_total_s": 17.50774359703064, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.50774359703064, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 76.41428571428571, "ram_util_percent": 91.95714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 4.999999873689376e-05, "total_loss": 3.019742012023926, "policy_loss": -0.02319824881851673, "vf_loss": 3.0356693267822266, "vf_explained_var": 0.7329639196395874, "kl": 0.010771894827485085, "entropy": 0.8159406185150146, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 25.25333333333332, "episode_reward_min": 7.691999999999998, "episode_reward_mean": 12.421838709677418, "episode_len_mean": 25.670967741935485, "episode_media": {}, "episodes_this_iter": 155, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.809000000000005, 17.40733333333333, 9.638666666666666, 10.475333333333333, 11.973333333333327, 9.423666666666666, 12.654666666666659, 17.018, 10.120666666666665, 16.113333333333337, 15.622333333333332, 12.252333333333333, 10.276666666666666, 8.895999999999997, 10.758666666666663, 14.558666666666669, 11.476000000000003, 10.26, 8.061333333333334, 11.922666666666668, 14.585333333333333, 9.992999999999999, 12.886666666666663, 14.76266666666666, 12.097333333333333, 13.899333333333331, 11.813999999999998, 12.586999999999998, 15.905666666666656, 15.04633333333333, 16.55866666666666, 14.722999999999995, 12.89066666666667, 14.140333333333329, 9.286666666666669, 13.093333333333327, 11.255666666666663, 19.082666666666658, 11.967333333333327, 16.14366666666666, 11.556333333333333, 11.913666666666666, 9.544, 10.945666666666664, 10.035999999999998, 13.20133333333333, 11.798666666666664, 15.284333333333326, 17.476, 11.411000000000003, 15.783666666666672, 9.528, 11.778333333333332, 15.496999999999993, 11.125666666666664, 11.446666666666664, 10.331333333333335, 20.850666666666662, 10.911333333333333, 12.232000000000001, 11.144666666666662, 12.578000000000001, 9.621999999999998, 9.318666666666664, 10.125666666666667, 10.357333333333333, 12.412999999999998, 12.28733333333333, 9.567999999999998, 11.629333333333333, 9.465333333333332, 11.839333333333332, 11.576999999999998, 11.915333333333331, 10.763000000000002, 13.576999999999998, 16.283999999999995, 10.623666666666665, 8.435333333333334, 13.646999999999997, 9.475999999999999, 17.054999999999996, 9.976666666666663, 11.176333333333332, 17.025000000000002, 11.853333333333335, 10.482, 9.849333333333332, 8.590999999999998, 10.902333333333333, 9.125333333333332, 8.214666666666668, 10.288666666666668, 16.061999999999998, 18.885999999999996, 15.384666666666659, 17.17466666666666, 10.803666666666665, 19.867333333333338, 17.467333333333325, 17.028333333333325, 21.76166666666667, 10.800333333333333, 9.459333333333332, 10.515, 15.522, 25.25333333333332, 13.22733333333333, 9.063666666666668, 11.871666666666666, 9.170333333333332, 7.967333333333334, 10.904666666666667, 13.898, 11.322, 10.120000000000001, 13.145999999999997, 7.725333333333333, 13.874333333333333, 9.876, 10.690666666666667, 8.695333333333334, 12.114666666666666, 11.962000000000002, 7.691999999999998, 18.16999999999999, 8.513000000000002, 13.925666666666661, 8.117999999999999, 9.538, 8.68233333333333, 19.943333333333324, 12.654666666666667, 11.451666666666668, 8.468666666666664, 17.114, 15.085999999999995, 8.632333333333332, 13.250666666666664, 9.891999999999996, 10.122666666666667, 9.157333333333334, 11.157, 12.09933333333333, 11.649333333333333, 14.073333333333329, 13.136666666666667, 13.317333333333332, 9.593333333333328, 11.399999999999999, 18.841999999999995, 9.049333333333333, 15.217666666666663, 13.495666666666661, 10.050333333333333], "episode_lengths": [28, 38, 19, 20, 24, 23, 26, 38, 24, 38, 30, 29, 24, 19, 21, 27, 27, 25, 17, 24, 28, 20, 25, 36, 28, 28, 23, 28, 34, 32, 35, 30, 27, 30, 22, 27, 22, 40, 26, 31, 26, 23, 21, 22, 21, 26, 22, 28, 35, 22, 34, 20, 23, 30, 21, 22, 20, 43, 21, 23, 22, 25, 22, 20, 21, 19, 26, 26, 23, 22, 19, 24, 23, 29, 22, 28, 32, 24, 18, 31, 20, 37, 21, 24, 32, 22, 22, 24, 17, 22, 22, 16, 19, 31, 35, 29, 34, 25, 41, 29, 42, 36, 21, 20, 21, 30, 51, 25, 20, 27, 21, 17, 21, 31, 28, 21, 25, 16, 30, 24, 23, 17, 26, 24, 15, 32, 20, 31, 16, 21, 20, 35, 29, 25, 17, 35, 29, 18, 30, 20, 21, 19, 24, 23, 21, 35, 29, 23, 20, 27, 35, 20, 29, 29, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1413988972837188, "mean_inference_ms": 2.0690862328348443, "mean_action_processing_ms": 0.42637588374055035, "mean_env_wait_ms": 0.10650227292138703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018181800842285156, "StateBufferConnector_ms": 0.007626318162487399, "ViewRequirementAgentConnector_ms": 0.37113035878827494}}, "episode_reward_max": 25.25333333333332, "episode_reward_min": 7.691999999999998, "episode_reward_mean": 12.421838709677418, "episode_len_mean": 25.670967741935485, "episodes_this_iter": 155, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.809000000000005, 17.40733333333333, 9.638666666666666, 10.475333333333333, 11.973333333333327, 9.423666666666666, 12.654666666666659, 17.018, 10.120666666666665, 16.113333333333337, 15.622333333333332, 12.252333333333333, 10.276666666666666, 8.895999999999997, 10.758666666666663, 14.558666666666669, 11.476000000000003, 10.26, 8.061333333333334, 11.922666666666668, 14.585333333333333, 9.992999999999999, 12.886666666666663, 14.76266666666666, 12.097333333333333, 13.899333333333331, 11.813999999999998, 12.586999999999998, 15.905666666666656, 15.04633333333333, 16.55866666666666, 14.722999999999995, 12.89066666666667, 14.140333333333329, 9.286666666666669, 13.093333333333327, 11.255666666666663, 19.082666666666658, 11.967333333333327, 16.14366666666666, 11.556333333333333, 11.913666666666666, 9.544, 10.945666666666664, 10.035999999999998, 13.20133333333333, 11.798666666666664, 15.284333333333326, 17.476, 11.411000000000003, 15.783666666666672, 9.528, 11.778333333333332, 15.496999999999993, 11.125666666666664, 11.446666666666664, 10.331333333333335, 20.850666666666662, 10.911333333333333, 12.232000000000001, 11.144666666666662, 12.578000000000001, 9.621999999999998, 9.318666666666664, 10.125666666666667, 10.357333333333333, 12.412999999999998, 12.28733333333333, 9.567999999999998, 11.629333333333333, 9.465333333333332, 11.839333333333332, 11.576999999999998, 11.915333333333331, 10.763000000000002, 13.576999999999998, 16.283999999999995, 10.623666666666665, 8.435333333333334, 13.646999999999997, 9.475999999999999, 17.054999999999996, 9.976666666666663, 11.176333333333332, 17.025000000000002, 11.853333333333335, 10.482, 9.849333333333332, 8.590999999999998, 10.902333333333333, 9.125333333333332, 8.214666666666668, 10.288666666666668, 16.061999999999998, 18.885999999999996, 15.384666666666659, 17.17466666666666, 10.803666666666665, 19.867333333333338, 17.467333333333325, 17.028333333333325, 21.76166666666667, 10.800333333333333, 9.459333333333332, 10.515, 15.522, 25.25333333333332, 13.22733333333333, 9.063666666666668, 11.871666666666666, 9.170333333333332, 7.967333333333334, 10.904666666666667, 13.898, 11.322, 10.120000000000001, 13.145999999999997, 7.725333333333333, 13.874333333333333, 9.876, 10.690666666666667, 8.695333333333334, 12.114666666666666, 11.962000000000002, 7.691999999999998, 18.16999999999999, 8.513000000000002, 13.925666666666661, 8.117999999999999, 9.538, 8.68233333333333, 19.943333333333324, 12.654666666666667, 11.451666666666668, 8.468666666666664, 17.114, 15.085999999999995, 8.632333333333332, 13.250666666666664, 9.891999999999996, 10.122666666666667, 9.157333333333334, 11.157, 12.09933333333333, 11.649333333333333, 14.073333333333329, 13.136666666666667, 13.317333333333332, 9.593333333333328, 11.399999999999999, 18.841999999999995, 9.049333333333333, 15.217666666666663, 13.495666666666661, 10.050333333333333], "episode_lengths": [28, 38, 19, 20, 24, 23, 26, 38, 24, 38, 30, 29, 24, 19, 21, 27, 27, 25, 17, 24, 28, 20, 25, 36, 28, 28, 23, 28, 34, 32, 35, 30, 27, 30, 22, 27, 22, 40, 26, 31, 26, 23, 21, 22, 21, 26, 22, 28, 35, 22, 34, 20, 23, 30, 21, 22, 20, 43, 21, 23, 22, 25, 22, 20, 21, 19, 26, 26, 23, 22, 19, 24, 23, 29, 22, 28, 32, 24, 18, 31, 20, 37, 21, 24, 32, 22, 22, 24, 17, 22, 22, 16, 19, 31, 35, 29, 34, 25, 41, 29, 42, 36, 21, 20, 21, 30, 51, 25, 20, 27, 21, 17, 21, 31, 28, 21, 25, 16, 30, 24, 23, 17, 26, 24, 15, 32, 20, 31, 16, 21, 20, 35, 29, 25, 17, 35, 29, 18, 30, 20, 21, 19, 24, 23, 21, 35, 29, 23, 20, 27, 35, 20, 29, 29, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1413988972837188, "mean_inference_ms": 2.0690862328348443, "mean_action_processing_ms": 0.42637588374055035, "mean_env_wait_ms": 0.10650227292138703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018181800842285156, "StateBufferConnector_ms": 0.007626318162487399, "ViewRequirementAgentConnector_ms": 0.37113035878827494}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 758.2994802797893, "num_env_steps_trained_throughput_per_sec": 758.2994802797893, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 5682.964, "sample_time_ms": 2202.252, "load_time_ms": 0.739, "load_throughput": 5413751.533, "learn_time_ms": 3458.452, "learn_throughput": 1156.587, "synch_weights_time_ms": 16.268}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 730, "training_iteration": 4, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-27", "timestamp": 1701995187, "time_this_iter_s": 5.350405693054199, "time_total_s": 22.85814929008484, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.85814929008484, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 74.85714285714286, "ram_util_percent": 92.8142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 4.999999873689376e-05, "total_loss": 4.115459442138672, "policy_loss": -0.0178558137267828, "vf_loss": 4.128122329711914, "vf_explained_var": 0.6633357405662537, "kl": 0.007693353109061718, "entropy": 0.7224493622779846, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 36.88600000000001, "episode_reward_min": 7.338333333333333, "episode_reward_mean": 15.060170483460558, "episode_len_mean": 30.358778625954198, "episode_media": {}, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.345999999999997, 11.911666666666669, 12.130333333333331, 20.45266666666666, 10.707999999999997, 13.677333333333332, 15.097666666666662, 12.750666666666664, 11.70133333333333, 10.367333333333331, 10.844666666666669, 19.780333333333328, 13.046666666666665, 20.48433333333332, 25.818333333333335, 8.838999999999999, 12.74366666666666, 9.331999999999999, 16.918333333333326, 16.119333333333323, 12.575333333333328, 18.721999999999994, 19.367333333333328, 12.273999999999996, 13.819999999999999, 14.907333333333327, 12.89633333333333, 9.736, 16.194, 13.908666666666662, 12.002333333333333, 15.641333333333328, 13.520333333333326, 22.81966666666668, 11.603333333333332, 10.978666666666669, 23.022333333333336, 12.233333333333334, 17.414666666666665, 27.72966666666666, 14.565333333333335, 20.06433333333333, 15.541, 10.331, 17.092999999999993, 16.67666666666667, 11.716666666666669, 14.48033333333333, 15.321333333333323, 10.574, 20.864666666666658, 11.776, 16.42533333333332, 12.953999999999995, 14.622333333333334, 10.297333333333336, 10.951999999999998, 12.153333333333329, 10.914999999999996, 20.719333333333335, 14.641333333333321, 11.319666666666663, 12.934, 12.821333333333328, 9.399666666666667, 11.221999999999994, 13.336999999999996, 8.850000000000001, 10.572666666666667, 13.362333333333329, 7.338333333333333, 17.733999999999988, 26.968666666666675, 36.88600000000001, 12.826999999999995, 10.16933333333333, 21.521, 15.868, 15.130666666666661, 13.365999999999996, 14.438666666666663, 14.990666666666664, 28.355999999999987, 11.429, 13.215333333333334, 18.761333333333337, 16.688333333333333, 13.319999999999997, 10.758333333333331, 11.524666666666667, 12.030999999999997, 12.208999999999998, 17.746, 20.627333333333333, 9.267333333333331, 17.15633333333333, 19.529666666666657, 12.942666666666664, 13.680666666666665, 10.861333333333329, 10.608333333333334, 13.188999999999998, 14.443333333333332, 15.912000000000003, 18.19666666666666, 17.741333333333326, 13.018666666666661, 25.087333333333323, 10.531666666666666, 11.540666666666667, 19.725333333333335, 12.63433333333333, 14.647333333333332, 16.752, 14.399999999999999, 30.631000000000004, 11.406666666666668, 14.485333333333331, 20.654666666666664, 13.270333333333332, 12.130333333333333, 9.12733333333333, 26.182666666666645, 20.414999999999992, 23.713666666666654, 10.675333333333331, 8.882666666666667, 13.256, 10.295333333333328, 21.225333333333317, 13.820666666666666], "episode_lengths": [35, 24, 24, 42, 21, 26, 33, 27, 25, 20, 23, 42, 31, 46, 53, 19, 26, 18, 32, 37, 31, 35, 37, 24, 33, 29, 24, 24, 31, 28, 25, 34, 28, 42, 21, 23, 39, 26, 37, 54, 26, 37, 36, 21, 33, 32, 23, 33, 36, 23, 37, 23, 32, 25, 29, 20, 20, 26, 22, 35, 29, 24, 25, 26, 21, 22, 26, 21, 21, 29, 16, 41, 52, 63, 28, 23, 37, 28, 29, 30, 28, 31, 64, 25, 28, 45, 32, 25, 23, 22, 24, 23, 33, 38, 19, 42, 38, 25, 25, 24, 23, 24, 26, 29, 35, 32, 26, 43, 23, 26, 38, 28, 32, 34, 28, 58, 25, 29, 50, 28, 28, 19, 54, 42, 43, 21, 19, 26, 18, 38, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.263883691031156, "mean_inference_ms": 2.307771316769888, "mean_action_processing_ms": 0.4525819844455506, "mean_env_wait_ms": 0.11089571390261531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026992077135857735, "StateBufferConnector_ms": 0.014320766652813394, "ViewRequirementAgentConnector_ms": 0.44529583617931107}}, "episode_reward_max": 36.88600000000001, "episode_reward_min": 7.338333333333333, "episode_reward_mean": 15.060170483460558, "episode_len_mean": 30.358778625954198, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.345999999999997, 11.911666666666669, 12.130333333333331, 20.45266666666666, 10.707999999999997, 13.677333333333332, 15.097666666666662, 12.750666666666664, 11.70133333333333, 10.367333333333331, 10.844666666666669, 19.780333333333328, 13.046666666666665, 20.48433333333332, 25.818333333333335, 8.838999999999999, 12.74366666666666, 9.331999999999999, 16.918333333333326, 16.119333333333323, 12.575333333333328, 18.721999999999994, 19.367333333333328, 12.273999999999996, 13.819999999999999, 14.907333333333327, 12.89633333333333, 9.736, 16.194, 13.908666666666662, 12.002333333333333, 15.641333333333328, 13.520333333333326, 22.81966666666668, 11.603333333333332, 10.978666666666669, 23.022333333333336, 12.233333333333334, 17.414666666666665, 27.72966666666666, 14.565333333333335, 20.06433333333333, 15.541, 10.331, 17.092999999999993, 16.67666666666667, 11.716666666666669, 14.48033333333333, 15.321333333333323, 10.574, 20.864666666666658, 11.776, 16.42533333333332, 12.953999999999995, 14.622333333333334, 10.297333333333336, 10.951999999999998, 12.153333333333329, 10.914999999999996, 20.719333333333335, 14.641333333333321, 11.319666666666663, 12.934, 12.821333333333328, 9.399666666666667, 11.221999999999994, 13.336999999999996, 8.850000000000001, 10.572666666666667, 13.362333333333329, 7.338333333333333, 17.733999999999988, 26.968666666666675, 36.88600000000001, 12.826999999999995, 10.16933333333333, 21.521, 15.868, 15.130666666666661, 13.365999999999996, 14.438666666666663, 14.990666666666664, 28.355999999999987, 11.429, 13.215333333333334, 18.761333333333337, 16.688333333333333, 13.319999999999997, 10.758333333333331, 11.524666666666667, 12.030999999999997, 12.208999999999998, 17.746, 20.627333333333333, 9.267333333333331, 17.15633333333333, 19.529666666666657, 12.942666666666664, 13.680666666666665, 10.861333333333329, 10.608333333333334, 13.188999999999998, 14.443333333333332, 15.912000000000003, 18.19666666666666, 17.741333333333326, 13.018666666666661, 25.087333333333323, 10.531666666666666, 11.540666666666667, 19.725333333333335, 12.63433333333333, 14.647333333333332, 16.752, 14.399999999999999, 30.631000000000004, 11.406666666666668, 14.485333333333331, 20.654666666666664, 13.270333333333332, 12.130333333333333, 9.12733333333333, 26.182666666666645, 20.414999999999992, 23.713666666666654, 10.675333333333331, 8.882666666666667, 13.256, 10.295333333333328, 21.225333333333317, 13.820666666666666], "episode_lengths": [35, 24, 24, 42, 21, 26, 33, 27, 25, 20, 23, 42, 31, 46, 53, 19, 26, 18, 32, 37, 31, 35, 37, 24, 33, 29, 24, 24, 31, 28, 25, 34, 28, 42, 21, 23, 39, 26, 37, 54, 26, 37, 36, 21, 33, 32, 23, 33, 36, 23, 37, 23, 32, 25, 29, 20, 20, 26, 22, 35, 29, 24, 25, 26, 21, 22, 26, 21, 21, 29, 16, 41, 52, 63, 28, 23, 37, 28, 29, 30, 28, 31, 64, 25, 28, 45, 32, 25, 23, 22, 24, 23, 33, 38, 19, 42, 38, 25, 25, 24, 23, 24, 26, 29, 35, 32, 26, 43, 23, 26, 38, 28, 32, 34, 28, 58, 25, 29, 50, 28, 28, 19, 54, 42, 43, 21, 19, 26, 18, 38, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.263883691031156, "mean_inference_ms": 2.307771316769888, "mean_action_processing_ms": 0.4525819844455506, "mean_env_wait_ms": 0.11089571390261531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026992077135857735, "StateBufferConnector_ms": 0.014320766652813394, "ViewRequirementAgentConnector_ms": 0.44529583617931107}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 519.9388254616315, "num_env_steps_trained_throughput_per_sec": 519.9388254616315, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 6085.014, "sample_time_ms": 2438.711, "load_time_ms": 0.795, "load_throughput": 5031554.702, "learn_time_ms": 3624.891, "learn_throughput": 1103.481, "synch_weights_time_ms": 16.414}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 861, "training_iteration": 5, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-35", "timestamp": 1701995195, "time_this_iter_s": 7.710215330123901, "time_total_s": 30.56836462020874, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 30.56836462020874, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 82.89090909090909, "ram_util_percent": 96.38181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 4.999999873689376e-05, "total_loss": 4.635133266448975, "policy_loss": -0.009661543183028698, "vf_loss": 4.642553806304932, "vf_explained_var": 0.6175320744514465, "kl": 0.003320349846035242, "entropy": 0.6576074361801147, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 42.69533333333334, "episode_reward_min": 9.221, "episode_reward_mean": 17.821412844036693, "episode_len_mean": 36.477064220183486, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.725999999999996, 14.81533333333333, 14.527999999999997, 16.668999999999997, 13.416666666666663, 10.654666666666666, 17.392000000000003, 16.933333333333326, 16.811333333333327, 13.303999999999998, 23.90200000000001, 21.68466666666665, 13.329666666666666, 12.312999999999999, 9.495333333333331, 16.353666666666665, 14.194333333333335, 22.799666666666663, 21.549666666666667, 20.35299999999999, 22.27033333333333, 42.69533333333334, 14.216999999999995, 12.678999999999997, 16.825666666666663, 12.698333333333327, 18.031000000000002, 33.57933333333333, 18.054333333333336, 14.860666666666665, 13.015999999999996, 17.034999999999997, 12.369999999999997, 20.919333333333327, 18.561666666666664, 11.50633333333333, 10.170999999999998, 11.493999999999994, 25.232333333333326, 13.732999999999997, 30.224000000000004, 22.351666666666656, 23.800333333333345, 9.221, 16.156999999999996, 16.981333333333325, 16.961333333333325, 11.451333333333332, 10.20433333333333, 21.03033333333333, 21.021666666666658, 21.21666666666666, 15.702666666666659, 16.13066666666666, 20.975000000000005, 19.196, 17.042666666666666, 22.374333333333322, 13.373999999999999, 21.370333333333335, 18.389999999999993, 17.65766666666666, 12.975333333333332, 14.661333333333328, 16.573999999999987, 19.07866666666666, 33.527, 13.188999999999993, 18.49433333333332, 15.077999999999992, 9.57, 12.701999999999996, 30.25666666666666, 12.546, 11.87533333333333, 13.859333333333327, 23.828333333333305, 14.323999999999995, 14.832333333333333, 16.38466666666666, 39.49933333333334, 14.177666666666667, 11.913333333333327, 9.898666666666664, 21.210666666666665, 15.390666666666661, 12.859333333333332, 23.559999999999985, 12.711333333333329, 12.568333333333328, 42.33400000000001, 22.658999999999992, 23.634666666666657, 25.066666666666656, 13.239999999999993, 19.41066666666667, 23.32433333333332, 22.839666666666666, 11.386999999999997, 28.95233333333332, 12.514333333333331, 11.098333333333327, 14.661000000000001, 16.46166666666666, 16.892000000000003, 19.885333333333335, 11.198666666666664, 19.309000000000008, 17.11033333333333], "episode_lengths": [33, 31, 29, 39, 28, 23, 37, 28, 35, 27, 52, 49, 27, 27, 20, 36, 29, 41, 40, 43, 58, 73, 27, 30, 36, 32, 34, 61, 40, 32, 27, 34, 24, 36, 35, 29, 20, 23, 42, 26, 54, 41, 58, 21, 35, 33, 34, 22, 25, 40, 38, 47, 41, 30, 45, 35, 28, 50, 28, 41, 40, 37, 24, 26, 34, 37, 61, 30, 47, 35, 23, 27, 48, 28, 25, 29, 51, 30, 36, 31, 71, 32, 22, 20, 41, 29, 25, 40, 26, 25, 77, 48, 46, 67, 27, 44, 46, 56, 23, 58, 26, 29, 30, 32, 44, 43, 21, 54, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.244468637354074, "mean_inference_ms": 2.266357206606575, "mean_action_processing_ms": 0.455387330248851, "mean_env_wait_ms": 0.10952880404094228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02273332088365467, "StateBufferConnector_ms": 0.015101301560708142, "ViewRequirementAgentConnector_ms": 0.38755530611090705}}, "episode_reward_max": 42.69533333333334, "episode_reward_min": 9.221, "episode_reward_mean": 17.821412844036693, "episode_len_mean": 36.477064220183486, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.725999999999996, 14.81533333333333, 14.527999999999997, 16.668999999999997, 13.416666666666663, 10.654666666666666, 17.392000000000003, 16.933333333333326, 16.811333333333327, 13.303999999999998, 23.90200000000001, 21.68466666666665, 13.329666666666666, 12.312999999999999, 9.495333333333331, 16.353666666666665, 14.194333333333335, 22.799666666666663, 21.549666666666667, 20.35299999999999, 22.27033333333333, 42.69533333333334, 14.216999999999995, 12.678999999999997, 16.825666666666663, 12.698333333333327, 18.031000000000002, 33.57933333333333, 18.054333333333336, 14.860666666666665, 13.015999999999996, 17.034999999999997, 12.369999999999997, 20.919333333333327, 18.561666666666664, 11.50633333333333, 10.170999999999998, 11.493999999999994, 25.232333333333326, 13.732999999999997, 30.224000000000004, 22.351666666666656, 23.800333333333345, 9.221, 16.156999999999996, 16.981333333333325, 16.961333333333325, 11.451333333333332, 10.20433333333333, 21.03033333333333, 21.021666666666658, 21.21666666666666, 15.702666666666659, 16.13066666666666, 20.975000000000005, 19.196, 17.042666666666666, 22.374333333333322, 13.373999999999999, 21.370333333333335, 18.389999999999993, 17.65766666666666, 12.975333333333332, 14.661333333333328, 16.573999999999987, 19.07866666666666, 33.527, 13.188999999999993, 18.49433333333332, 15.077999999999992, 9.57, 12.701999999999996, 30.25666666666666, 12.546, 11.87533333333333, 13.859333333333327, 23.828333333333305, 14.323999999999995, 14.832333333333333, 16.38466666666666, 39.49933333333334, 14.177666666666667, 11.913333333333327, 9.898666666666664, 21.210666666666665, 15.390666666666661, 12.859333333333332, 23.559999999999985, 12.711333333333329, 12.568333333333328, 42.33400000000001, 22.658999999999992, 23.634666666666657, 25.066666666666656, 13.239999999999993, 19.41066666666667, 23.32433333333332, 22.839666666666666, 11.386999999999997, 28.95233333333332, 12.514333333333331, 11.098333333333327, 14.661000000000001, 16.46166666666666, 16.892000000000003, 19.885333333333335, 11.198666666666664, 19.309000000000008, 17.11033333333333], "episode_lengths": [33, 31, 29, 39, 28, 23, 37, 28, 35, 27, 52, 49, 27, 27, 20, 36, 29, 41, 40, 43, 58, 73, 27, 30, 36, 32, 34, 61, 40, 32, 27, 34, 24, 36, 35, 29, 20, 23, 42, 26, 54, 41, 58, 21, 35, 33, 34, 22, 25, 40, 38, 47, 41, 30, 45, 35, 28, 50, 28, 41, 40, 37, 24, 26, 34, 37, 61, 30, 47, 35, 23, 27, 48, 28, 25, 29, 51, 30, 36, 31, 71, 32, 22, 20, 41, 29, 25, 40, 26, 25, 77, 48, 46, 67, 27, 44, 46, 56, 23, 58, 26, 29, 30, 32, 44, 43, 21, 54, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.244468637354074, "mean_inference_ms": 2.266357206606575, "mean_action_processing_ms": 0.455387330248851, "mean_env_wait_ms": 0.10952880404094228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02273332088365467, "StateBufferConnector_ms": 0.015101301560708142, "ViewRequirementAgentConnector_ms": 0.38755530611090705}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 640.8848398211535, "num_env_steps_trained_throughput_per_sec": 640.8848398211535, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 6111.073, "sample_time_ms": 2402.308, "load_time_ms": 0.684, "load_throughput": 5845040.994, "learn_time_ms": 3685.681, "learn_throughput": 1085.281, "synch_weights_time_ms": 18.355}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 970, "training_iteration": 6, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-41", "timestamp": 1701995201, "time_this_iter_s": 6.259370803833008, "time_total_s": 36.82773542404175, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 36.82773542404175, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 73.6875, "ram_util_percent": 96.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3375000059604645, "cur_lr": 4.999999873689376e-05, "total_loss": 5.382732391357422, "policy_loss": -0.01773482747375965, "vf_loss": 5.39679479598999, "vf_explained_var": 0.6292224526405334, "kl": 0.010880743153393269, "entropy": 0.5662214159965515, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 54.43833333333331, "episode_reward_min": 8.244999999999997, "episode_reward_mean": 19.77674333333333, "episode_len_mean": 40.5, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.198666666666664, 19.309000000000008, 17.11033333333333, 19.41133333333333, 21.615333333333325, 30.353333333333325, 19.414999999999992, 18.550999999999995, 15.499666666666664, 18.287000000000003, 22.872666666666657, 23.022666666666655, 13.121333333333329, 13.862333333333332, 22.367000000000004, 23.506333333333323, 14.344999999999995, 21.518666666666665, 12.250666666666667, 20.546999999999993, 16.60566666666666, 23.513666666666662, 13.520666666666667, 54.43833333333331, 15.457333333333333, 14.488999999999992, 16.584, 16.068999999999996, 20.725, 18.868999999999986, 21.517333333333326, 11.153999999999996, 14.94066666666666, 8.244999999999997, 22.36099999999999, 18.367999999999995, 9.020000000000003, 23.68966666666666, 15.726666666666665, 9.626999999999997, 20.694666666666667, 15.273666666666665, 14.776333333333326, 21.287999999999986, 19.229333333333326, 16.800333333333327, 41.20066666666669, 22.30533333333332, 23.006666666666664, 27.872999999999987, 32.775666666666645, 18.093999999999998, 13.440666666666667, 19.488666666666667, 35.311333333333344, 36.46733333333333, 16.988666666666667, 10.597666666666663, 19.093999999999994, 21.25266666666666, 15.023333333333333, 11.809666666666667, 10.998999999999999, 11.787666666666665, 16.214666666666655, 14.237999999999996, 12.282666666666664, 15.413666666666666, 29.037666666666677, 19.077666666666666, 24.560333333333322, 35.127666666666656, 20.911666666666665, 11.875333333333334, 21.745000000000005, 15.781999999999998, 31.318999999999996, 26.931333333333317, 22.733000000000004, 16.196999999999992, 38.92600000000001, 36.148999999999994, 19.178666666666665, 27.647000000000002, 12.598333333333331, 19.34766666666666, 16.610333333333333, 13.971, 19.288666666666664, 11.505333333333327, 19.262666666666664, 14.816000000000004, 13.867, 18.77133333333333, 25.736333333333327, 21.104999999999993, 24.145666666666642, 15.426333333333334, 20.927999999999994, 16.283666666666658], "episode_lengths": [21, 54, 36, 39, 39, 50, 49, 40, 29, 35, 41, 41, 25, 44, 41, 51, 32, 37, 22, 45, 35, 54, 29, 111, 27, 38, 33, 32, 43, 39, 51, 26, 30, 18, 43, 45, 21, 41, 41, 24, 38, 29, 32, 46, 36, 35, 70, 54, 45, 54, 70, 42, 27, 40, 69, 64, 34, 27, 38, 44, 42, 26, 30, 26, 34, 27, 29, 32, 54, 41, 43, 75, 44, 29, 45, 34, 57, 59, 40, 36, 67, 75, 35, 49, 29, 40, 33, 30, 43, 21, 39, 32, 27, 37, 60, 37, 53, 26, 37, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.257384712338571, "mean_inference_ms": 2.2988939780134285, "mean_action_processing_ms": 0.46462374742314183, "mean_env_wait_ms": 0.11080964112143019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019966602325439453, "StateBufferConnector_ms": 0.019921302795410156, "ViewRequirementAgentConnector_ms": 0.445345401763916}}, "episode_reward_max": 54.43833333333331, "episode_reward_min": 8.244999999999997, "episode_reward_mean": 19.77674333333333, "episode_len_mean": 40.5, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.198666666666664, 19.309000000000008, 17.11033333333333, 19.41133333333333, 21.615333333333325, 30.353333333333325, 19.414999999999992, 18.550999999999995, 15.499666666666664, 18.287000000000003, 22.872666666666657, 23.022666666666655, 13.121333333333329, 13.862333333333332, 22.367000000000004, 23.506333333333323, 14.344999999999995, 21.518666666666665, 12.250666666666667, 20.546999999999993, 16.60566666666666, 23.513666666666662, 13.520666666666667, 54.43833333333331, 15.457333333333333, 14.488999999999992, 16.584, 16.068999999999996, 20.725, 18.868999999999986, 21.517333333333326, 11.153999999999996, 14.94066666666666, 8.244999999999997, 22.36099999999999, 18.367999999999995, 9.020000000000003, 23.68966666666666, 15.726666666666665, 9.626999999999997, 20.694666666666667, 15.273666666666665, 14.776333333333326, 21.287999999999986, 19.229333333333326, 16.800333333333327, 41.20066666666669, 22.30533333333332, 23.006666666666664, 27.872999999999987, 32.775666666666645, 18.093999999999998, 13.440666666666667, 19.488666666666667, 35.311333333333344, 36.46733333333333, 16.988666666666667, 10.597666666666663, 19.093999999999994, 21.25266666666666, 15.023333333333333, 11.809666666666667, 10.998999999999999, 11.787666666666665, 16.214666666666655, 14.237999999999996, 12.282666666666664, 15.413666666666666, 29.037666666666677, 19.077666666666666, 24.560333333333322, 35.127666666666656, 20.911666666666665, 11.875333333333334, 21.745000000000005, 15.781999999999998, 31.318999999999996, 26.931333333333317, 22.733000000000004, 16.196999999999992, 38.92600000000001, 36.148999999999994, 19.178666666666665, 27.647000000000002, 12.598333333333331, 19.34766666666666, 16.610333333333333, 13.971, 19.288666666666664, 11.505333333333327, 19.262666666666664, 14.816000000000004, 13.867, 18.77133333333333, 25.736333333333327, 21.104999999999993, 24.145666666666642, 15.426333333333334, 20.927999999999994, 16.283666666666658], "episode_lengths": [21, 54, 36, 39, 39, 50, 49, 40, 29, 35, 41, 41, 25, 44, 41, 51, 32, 37, 22, 45, 35, 54, 29, 111, 27, 38, 33, 32, 43, 39, 51, 26, 30, 18, 43, 45, 21, 41, 41, 24, 38, 29, 32, 46, 36, 35, 70, 54, 45, 54, 70, 42, 27, 40, 69, 64, 34, 27, 38, 44, 42, 26, 30, 26, 34, 27, 29, 32, 54, 41, 43, 75, 44, 29, 45, 34, 57, 59, 40, 36, 67, 75, 35, 49, 29, 40, 33, 30, 43, 21, 39, 32, 27, 37, 60, 37, 53, 26, 37, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.257384712338571, "mean_inference_ms": 2.2988939780134285, "mean_action_processing_ms": 0.46462374742314183, "mean_env_wait_ms": 0.11080964112143019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019966602325439453, "StateBufferConnector_ms": 0.019921302795410156, "ViewRequirementAgentConnector_ms": 0.445345401763916}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 631.3689658131109, "num_env_steps_trained_throughput_per_sec": 631.3689658131109, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 6143.126, "sample_time_ms": 2434.626, "load_time_ms": 0.746, "load_throughput": 5359154.513, "learn_time_ms": 3686.125, "learn_throughput": 1085.15, "synch_weights_time_ms": 18.16}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 1067, "training_iteration": 7, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-47", "timestamp": 1701995207, "time_this_iter_s": 6.348443269729614, "time_total_s": 43.17617869377136, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.17617869377136, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 70.39999999999999, "ram_util_percent": 97.1222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3375000059604645, "cur_lr": 4.999999873689376e-05, "total_loss": 4.991454124450684, "policy_loss": -0.0023924107663333416, "vf_loss": 4.991240501403809, "vf_explained_var": 0.6802302598953247, "kl": 0.007722843904048204, "entropy": 0.45223599672317505, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 42.987000000000016, "episode_reward_min": 11.87133333333333, "episode_reward_mean": 21.666823333333333, "episode_len_mean": 43.95, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.816000000000004, 13.867, 18.77133333333333, 25.736333333333327, 21.104999999999993, 24.145666666666642, 15.426333333333334, 20.927999999999994, 16.283666666666658, 15.027999999999997, 17.105999999999995, 18.933333333333326, 25.564333333333327, 21.59599999999999, 18.213999999999995, 13.034, 28.667333333333325, 18.363333333333326, 20.02299999999999, 19.130333333333322, 26.11800000000001, 41.926, 24.413333333333316, 19.82033333333333, 41.988, 19.16166666666666, 18.71333333333333, 20.181999999999988, 16.02566666666666, 29.99866666666667, 26.195333333333338, 11.87133333333333, 15.75966666666666, 13.237999999999998, 12.158666666666665, 23.988666666666663, 29.50399999999999, 25.379333333333328, 17.034666666666663, 27.894000000000002, 17.328666666666663, 20.156, 18.574999999999996, 31.724999999999998, 21.88099999999999, 17.73899999999999, 29.275333333333315, 14.311333333333332, 17.33633333333333, 23.590666666666664, 18.627666666666666, 37.44600000000001, 17.81466666666666, 17.483, 17.962999999999994, 25.590666666666674, 19.746333333333325, 22.594333333333335, 29.58, 37.64266666666665, 17.265666666666668, 18.230999999999998, 42.987000000000016, 30.52633333333334, 13.959666666666662, 19.127000000000002, 22.918333333333347, 17.81999999999999, 15.955999999999994, 12.614666666666661, 11.883333333333328, 24.81266666666667, 27.627333333333326, 16.82266666666666, 37.64533333333335, 24.874, 25.114, 14.613, 17.589666666666663, 29.18333333333332, 23.05700000000001, 24.421999999999986, 13.607666666666661, 15.05733333333333, 22.406666666666656, 14.203999999999995, 20.741333333333326, 15.607333333333333, 16.712666666666657, 31.921333333333344, 27.14799999999999, 17.998333333333324, 20.98, 19.190999999999995, 20.317333333333334, 28.027666666666647, 16.073666666666664, 27.01599999999999, 17.23133333333333, 28.874333333333325], "episode_lengths": [32, 27, 37, 60, 37, 53, 26, 37, 31, 35, 38, 42, 50, 48, 40, 24, 63, 37, 40, 44, 50, 64, 63, 45, 88, 45, 34, 42, 30, 61, 61, 23, 35, 28, 25, 43, 45, 42, 30, 66, 35, 43, 40, 66, 39, 38, 60, 30, 35, 51, 36, 75, 39, 33, 41, 50, 40, 45, 51, 64, 34, 43, 76, 53, 30, 35, 50, 37, 31, 25, 25, 39, 58, 31, 74, 65, 57, 27, 34, 47, 44, 54, 30, 31, 55, 27, 56, 32, 36, 68, 56, 36, 47, 36, 34, 52, 32, 64, 36, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2764584559373133, "mean_inference_ms": 2.3347805132076345, "mean_action_processing_ms": 0.4733234766342312, "mean_env_wait_ms": 0.1127563978255989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023902177810668945, "StateBufferConnector_ms": 0.02212691307067871, "ViewRequirementAgentConnector_ms": 0.4360685348510742}}, "episode_reward_max": 42.987000000000016, "episode_reward_min": 11.87133333333333, "episode_reward_mean": 21.666823333333333, "episode_len_mean": 43.95, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.816000000000004, 13.867, 18.77133333333333, 25.736333333333327, 21.104999999999993, 24.145666666666642, 15.426333333333334, 20.927999999999994, 16.283666666666658, 15.027999999999997, 17.105999999999995, 18.933333333333326, 25.564333333333327, 21.59599999999999, 18.213999999999995, 13.034, 28.667333333333325, 18.363333333333326, 20.02299999999999, 19.130333333333322, 26.11800000000001, 41.926, 24.413333333333316, 19.82033333333333, 41.988, 19.16166666666666, 18.71333333333333, 20.181999999999988, 16.02566666666666, 29.99866666666667, 26.195333333333338, 11.87133333333333, 15.75966666666666, 13.237999999999998, 12.158666666666665, 23.988666666666663, 29.50399999999999, 25.379333333333328, 17.034666666666663, 27.894000000000002, 17.328666666666663, 20.156, 18.574999999999996, 31.724999999999998, 21.88099999999999, 17.73899999999999, 29.275333333333315, 14.311333333333332, 17.33633333333333, 23.590666666666664, 18.627666666666666, 37.44600000000001, 17.81466666666666, 17.483, 17.962999999999994, 25.590666666666674, 19.746333333333325, 22.594333333333335, 29.58, 37.64266666666665, 17.265666666666668, 18.230999999999998, 42.987000000000016, 30.52633333333334, 13.959666666666662, 19.127000000000002, 22.918333333333347, 17.81999999999999, 15.955999999999994, 12.614666666666661, 11.883333333333328, 24.81266666666667, 27.627333333333326, 16.82266666666666, 37.64533333333335, 24.874, 25.114, 14.613, 17.589666666666663, 29.18333333333332, 23.05700000000001, 24.421999999999986, 13.607666666666661, 15.05733333333333, 22.406666666666656, 14.203999999999995, 20.741333333333326, 15.607333333333333, 16.712666666666657, 31.921333333333344, 27.14799999999999, 17.998333333333324, 20.98, 19.190999999999995, 20.317333333333334, 28.027666666666647, 16.073666666666664, 27.01599999999999, 17.23133333333333, 28.874333333333325], "episode_lengths": [32, 27, 37, 60, 37, 53, 26, 37, 31, 35, 38, 42, 50, 48, 40, 24, 63, 37, 40, 44, 50, 64, 63, 45, 88, 45, 34, 42, 30, 61, 61, 23, 35, 28, 25, 43, 45, 42, 30, 66, 35, 43, 40, 66, 39, 38, 60, 30, 35, 51, 36, 75, 39, 33, 41, 50, 40, 45, 51, 64, 34, 43, 76, 53, 30, 35, 50, 37, 31, 25, 25, 39, 58, 31, 74, 65, 57, 27, 34, 47, 44, 54, 30, 31, 55, 27, 56, 32, 36, 68, 56, 36, 47, 36, 34, 52, 32, 64, 36, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2764584559373133, "mean_inference_ms": 2.3347805132076345, "mean_action_processing_ms": 0.4733234766342312, "mean_env_wait_ms": 0.1127563978255989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023902177810668945, "StateBufferConnector_ms": 0.02212691307067871, "ViewRequirementAgentConnector_ms": 0.4360685348510742}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 606.1682397439855, "num_env_steps_trained_throughput_per_sec": 606.1682397439855, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 6200.089, "sample_time_ms": 2474.41, "load_time_ms": 0.786, "load_throughput": 5090753.954, "learn_time_ms": 3703.468, "learn_throughput": 1080.069, "synch_weights_time_ms": 18.141}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 1158, "training_iteration": 8, "trial_id": "432ea_00000", "date": "2023-12-07_16-26-54", "timestamp": 1701995214, "time_this_iter_s": 6.6128315925598145, "time_total_s": 49.78901028633118, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.78901028633118, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 74.26666666666667, "ram_util_percent": 97.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.3375000059604645, "cur_lr": 4.999999873689376e-05, "total_loss": 5.48151159286499, "policy_loss": -0.0062228040769696236, "vf_loss": 5.486897945404053, "vf_explained_var": 0.6229605078697205, "kl": 0.0024796659126877785, "entropy": 0.4936940371990204, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 60.01100000000007, "episode_reward_min": 12.730333333333334, "episode_reward_mean": 23.19507333333333, "episode_len_mean": 47.66, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.607666666666661, 15.05733333333333, 22.406666666666656, 14.203999999999995, 20.741333333333326, 15.607333333333333, 16.712666666666657, 31.921333333333344, 27.14799999999999, 17.998333333333324, 20.98, 19.190999999999995, 20.317333333333334, 28.027666666666647, 16.073666666666664, 27.01599999999999, 17.23133333333333, 28.874333333333325, 22.401666666666653, 23.53033333333332, 16.359666666666662, 26.619999999999976, 14.843333333333327, 17.398999999999994, 21.129999999999995, 17.197666666666663, 18.388999999999985, 12.730333333333334, 17.465666666666664, 28.681333333333335, 19.515666666666657, 25.158999999999992, 23.034666666666656, 15.197333333333331, 27.800333333333327, 24.889333333333322, 38.595666666666666, 16.35833333333333, 20.847666666666672, 15.026333333333332, 14.690999999999995, 17.320999999999994, 15.166666666666664, 16.23333333333333, 50.19666666666668, 21.190333333333328, 24.767666666666663, 42.049000000000014, 31.702666666666648, 23.913333333333323, 60.01100000000007, 16.350333333333328, 27.815333333333328, 19.676999999999996, 24.18233333333334, 39.79766666666667, 23.478666666666655, 39.288666666666686, 31.52599999999999, 31.872333333333344, 28.98533333333333, 15.485999999999992, 27.360666666666663, 14.684333333333326, 31.157333333333302, 42.64033333333333, 34.955666666666666, 16.85833333333333, 24.935333333333336, 15.062666666666663, 21.000999999999994, 22.899999999999988, 22.375333333333337, 14.10366666666666, 17.99966666666667, 20.927333333333326, 32.27500000000002, 13.181333333333333, 17.736999999999988, 27.41966666666666, 14.976333333333326, 20.913666666666664, 17.587, 26.62899999999999, 26.37466666666666, 19.66233333333333, 16.557666666666663, 14.882999999999997, 27.755, 29.074333333333335, 23.80066666666666, 19.093, 20.59566666666666, 29.608999999999995, 18.714666666666663, 17.494333333333323, 34.857000000000006, 23.73499999999999, 23.586666666666662, 24.043], "episode_lengths": [30, 31, 55, 27, 56, 32, 36, 68, 56, 36, 47, 36, 34, 52, 32, 64, 36, 66, 57, 57, 36, 51, 33, 41, 38, 45, 45, 24, 34, 55, 48, 47, 53, 33, 68, 49, 73, 32, 50, 28, 30, 36, 32, 29, 97, 45, 46, 84, 55, 50, 99, 38, 47, 40, 62, 84, 49, 70, 52, 60, 61, 32, 86, 32, 63, 87, 60, 33, 51, 31, 50, 45, 50, 30, 34, 52, 56, 27, 42, 54, 33, 42, 39, 53, 51, 39, 36, 30, 50, 56, 39, 44, 37, 54, 36, 44, 57, 54, 59, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2616537185745662, "mean_inference_ms": 2.3109422485632627, "mean_action_processing_ms": 0.47071348949512826, "mean_env_wait_ms": 0.11191648279789135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0159912109375, "StateBufferConnector_ms": 0.01431584358215332, "ViewRequirementAgentConnector_ms": 0.3954753875732422}}, "episode_reward_max": 60.01100000000007, "episode_reward_min": 12.730333333333334, "episode_reward_mean": 23.19507333333333, "episode_len_mean": 47.66, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.607666666666661, 15.05733333333333, 22.406666666666656, 14.203999999999995, 20.741333333333326, 15.607333333333333, 16.712666666666657, 31.921333333333344, 27.14799999999999, 17.998333333333324, 20.98, 19.190999999999995, 20.317333333333334, 28.027666666666647, 16.073666666666664, 27.01599999999999, 17.23133333333333, 28.874333333333325, 22.401666666666653, 23.53033333333332, 16.359666666666662, 26.619999999999976, 14.843333333333327, 17.398999999999994, 21.129999999999995, 17.197666666666663, 18.388999999999985, 12.730333333333334, 17.465666666666664, 28.681333333333335, 19.515666666666657, 25.158999999999992, 23.034666666666656, 15.197333333333331, 27.800333333333327, 24.889333333333322, 38.595666666666666, 16.35833333333333, 20.847666666666672, 15.026333333333332, 14.690999999999995, 17.320999999999994, 15.166666666666664, 16.23333333333333, 50.19666666666668, 21.190333333333328, 24.767666666666663, 42.049000000000014, 31.702666666666648, 23.913333333333323, 60.01100000000007, 16.350333333333328, 27.815333333333328, 19.676999999999996, 24.18233333333334, 39.79766666666667, 23.478666666666655, 39.288666666666686, 31.52599999999999, 31.872333333333344, 28.98533333333333, 15.485999999999992, 27.360666666666663, 14.684333333333326, 31.157333333333302, 42.64033333333333, 34.955666666666666, 16.85833333333333, 24.935333333333336, 15.062666666666663, 21.000999999999994, 22.899999999999988, 22.375333333333337, 14.10366666666666, 17.99966666666667, 20.927333333333326, 32.27500000000002, 13.181333333333333, 17.736999999999988, 27.41966666666666, 14.976333333333326, 20.913666666666664, 17.587, 26.62899999999999, 26.37466666666666, 19.66233333333333, 16.557666666666663, 14.882999999999997, 27.755, 29.074333333333335, 23.80066666666666, 19.093, 20.59566666666666, 29.608999999999995, 18.714666666666663, 17.494333333333323, 34.857000000000006, 23.73499999999999, 23.586666666666662, 24.043], "episode_lengths": [30, 31, 55, 27, 56, 32, 36, 68, 56, 36, 47, 36, 34, 52, 32, 64, 36, 66, 57, 57, 36, 51, 33, 41, 38, 45, 45, 24, 34, 55, 48, 47, 53, 33, 68, 49, 73, 32, 50, 28, 30, 36, 32, 29, 97, 45, 46, 84, 55, 50, 99, 38, 47, 40, 62, 84, 49, 70, 52, 60, 61, 32, 86, 32, 63, 87, 60, 33, 51, 31, 50, 45, 50, 30, 34, 52, 56, 27, 42, 54, 33, 42, 39, 53, 51, 39, 36, 30, 50, 56, 39, 44, 37, 54, 36, 44, 57, 54, 59, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2616537185745662, "mean_inference_ms": 2.3109422485632627, "mean_action_processing_ms": 0.47071348949512826, "mean_env_wait_ms": 0.11191648279789135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0159912109375, "StateBufferConnector_ms": 0.01431584358215332, "ViewRequirementAgentConnector_ms": 0.3954753875732422}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 695.9134597935233, "num_env_steps_trained_throughput_per_sec": 695.9134597935233, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 6149.839, "sample_time_ms": 2441.169, "load_time_ms": 0.757, "load_throughput": 5283977.604, "learn_time_ms": 3686.935, "learn_throughput": 1084.912, "synch_weights_time_ms": 17.834}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 1240, "training_iteration": 9, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-00", "timestamp": 1701995220, "time_this_iter_s": 5.761852979660034, "time_total_s": 55.55086326599121, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.55086326599121, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 71.7875, "ram_util_percent": 98.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 5.366328716278076, "policy_loss": -0.007938232272863388, "vf_loss": 5.373025894165039, "vf_explained_var": 0.6425977349281311, "kl": 0.007355601526796818, "entropy": 0.4023371934890747, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 48.33466666666667, "episode_reward_min": 8.977999999999998, "episode_reward_mean": 22.88695666666666, "episode_len_mean": 46.21, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.755, 29.074333333333335, 23.80066666666666, 19.093, 20.59566666666666, 29.608999999999995, 18.714666666666663, 17.494333333333323, 34.857000000000006, 23.73499999999999, 23.586666666666662, 24.043, 20.634666666666657, 17.640666666666664, 15.277666666666663, 24.749333333333325, 31.18233333333334, 23.697999999999986, 16.29466666666666, 18.718999999999987, 15.67833333333333, 15.923333333333325, 16.074, 31.494333333333326, 23.771999999999988, 39.52800000000001, 48.33466666666667, 16.277, 27.150666666666673, 27.944666666666667, 23.745999999999995, 29.89, 20.060333333333322, 16.279666666666664, 21.849999999999994, 15.232333333333333, 8.977999999999998, 16.971333333333327, 25.684666666666654, 17.720999999999997, 47.82233333333332, 26.256999999999994, 18.052999999999997, 17.824333333333335, 26.69733333333333, 15.64633333333333, 20.346666666666664, 20.767666666666663, 19.067333333333323, 31.125999999999983, 25.689000000000004, 19.308999999999994, 24.44566666666665, 24.21633333333332, 16.763333333333325, 27.262999999999984, 14.507666666666665, 16.826, 24.19866666666665, 17.270999999999994, 18.13866666666666, 31.707666666666658, 20.108666666666657, 16.808999999999994, 15.947000000000001, 27.30466666666666, 17.587666666666667, 21.763666666666655, 13.547999999999998, 17.021666666666665, 18.51366666666666, 14.566333333333331, 34.60833333333334, 29.244666666666674, 40.769000000000005, 15.427999999999997, 21.16099999999999, 21.442333333333334, 18.54133333333333, 39.82666666666665, 14.977333333333338, 37.31033333333334, 17.696666666666665, 24.536666666666665, 21.991666666666656, 11.801333333333329, 23.89966666666666, 19.90333333333333, 15.749999999999996, 23.328333333333333, 15.413999999999996, 34.755, 16.669999999999995, 22.09766666666666, 19.62399999999999, 46.515333333333324, 23.211666666666662, 12.982000000000003, 33.602000000000004, 25.347999999999992], "episode_lengths": [50, 56, 39, 44, 37, 54, 36, 44, 57, 54, 59, 41, 39, 43, 29, 61, 63, 55, 38, 54, 32, 37, 33, 49, 57, 74, 79, 35, 55, 55, 57, 72, 39, 31, 47, 29, 18, 33, 48, 32, 79, 50, 32, 32, 59, 33, 44, 40, 34, 54, 45, 42, 47, 63, 28, 52, 30, 39, 50, 35, 35, 76, 48, 32, 33, 65, 40, 40, 27, 36, 39, 28, 60, 49, 90, 29, 48, 36, 37, 65, 29, 61, 36, 47, 53, 21, 39, 40, 29, 57, 33, 81, 29, 53, 37, 110, 42, 30, 84, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2648901322396535, "mean_inference_ms": 2.3193868314127615, "mean_action_processing_ms": 0.4747092917277339, "mean_env_wait_ms": 0.11253626394108726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02376103401184082, "StateBufferConnector_ms": 0.015149116516113281, "ViewRequirementAgentConnector_ms": 0.39032959938049316}}, "episode_reward_max": 48.33466666666667, "episode_reward_min": 8.977999999999998, "episode_reward_mean": 22.88695666666666, "episode_len_mean": 46.21, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.755, 29.074333333333335, 23.80066666666666, 19.093, 20.59566666666666, 29.608999999999995, 18.714666666666663, 17.494333333333323, 34.857000000000006, 23.73499999999999, 23.586666666666662, 24.043, 20.634666666666657, 17.640666666666664, 15.277666666666663, 24.749333333333325, 31.18233333333334, 23.697999999999986, 16.29466666666666, 18.718999999999987, 15.67833333333333, 15.923333333333325, 16.074, 31.494333333333326, 23.771999999999988, 39.52800000000001, 48.33466666666667, 16.277, 27.150666666666673, 27.944666666666667, 23.745999999999995, 29.89, 20.060333333333322, 16.279666666666664, 21.849999999999994, 15.232333333333333, 8.977999999999998, 16.971333333333327, 25.684666666666654, 17.720999999999997, 47.82233333333332, 26.256999999999994, 18.052999999999997, 17.824333333333335, 26.69733333333333, 15.64633333333333, 20.346666666666664, 20.767666666666663, 19.067333333333323, 31.125999999999983, 25.689000000000004, 19.308999999999994, 24.44566666666665, 24.21633333333332, 16.763333333333325, 27.262999999999984, 14.507666666666665, 16.826, 24.19866666666665, 17.270999999999994, 18.13866666666666, 31.707666666666658, 20.108666666666657, 16.808999999999994, 15.947000000000001, 27.30466666666666, 17.587666666666667, 21.763666666666655, 13.547999999999998, 17.021666666666665, 18.51366666666666, 14.566333333333331, 34.60833333333334, 29.244666666666674, 40.769000000000005, 15.427999999999997, 21.16099999999999, 21.442333333333334, 18.54133333333333, 39.82666666666665, 14.977333333333338, 37.31033333333334, 17.696666666666665, 24.536666666666665, 21.991666666666656, 11.801333333333329, 23.89966666666666, 19.90333333333333, 15.749999999999996, 23.328333333333333, 15.413999999999996, 34.755, 16.669999999999995, 22.09766666666666, 19.62399999999999, 46.515333333333324, 23.211666666666662, 12.982000000000003, 33.602000000000004, 25.347999999999992], "episode_lengths": [50, 56, 39, 44, 37, 54, 36, 44, 57, 54, 59, 41, 39, 43, 29, 61, 63, 55, 38, 54, 32, 37, 33, 49, 57, 74, 79, 35, 55, 55, 57, 72, 39, 31, 47, 29, 18, 33, 48, 32, 79, 50, 32, 32, 59, 33, 44, 40, 34, 54, 45, 42, 47, 63, 28, 52, 30, 39, 50, 35, 35, 76, 48, 32, 33, 65, 40, 40, 27, 36, 39, 28, 60, 49, 90, 29, 48, 36, 37, 65, 29, 61, 36, 47, 53, 21, 39, 40, 29, 57, 33, 81, 29, 53, 37, 110, 42, 30, 84, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2648901322396535, "mean_inference_ms": 2.3193868314127615, "mean_action_processing_ms": 0.4747092917277339, "mean_env_wait_ms": 0.11253626394108726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02376103401184082, "StateBufferConnector_ms": 0.015149116516113281, "ViewRequirementAgentConnector_ms": 0.39032959938049316}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 600.7549642034932, "num_env_steps_trained_throughput_per_sec": 600.7549642034932, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 6200.684, "sample_time_ms": 2460.251, "load_time_ms": 0.681, "load_throughput": 5871086.226, "learn_time_ms": 3719.145, "learn_throughput": 1075.516, "synch_weights_time_ms": 17.651}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 1328, "training_iteration": 10, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-07", "timestamp": 1701995227, "time_this_iter_s": 6.674292325973511, "time_total_s": 62.22515559196472, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 62.22515559196472, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 73.43, "ram_util_percent": 98.11999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 6.04905366897583, "policy_loss": -0.006834178231656551, "vf_loss": 6.05506706237793, "vf_explained_var": 0.6647146940231323, "kl": 0.0048638456501066685, "entropy": 0.3411613404750824, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 58.95266666666665, "episode_reward_min": 11.631999999999998, "episode_reward_mean": 24.63210666666667, "episode_len_mean": 50.18, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.427999999999997, 21.16099999999999, 21.442333333333334, 18.54133333333333, 39.82666666666665, 14.977333333333338, 37.31033333333334, 17.696666666666665, 24.536666666666665, 21.991666666666656, 11.801333333333329, 23.89966666666666, 19.90333333333333, 15.749999999999996, 23.328333333333333, 15.413999999999996, 34.755, 16.669999999999995, 22.09766666666666, 19.62399999999999, 46.515333333333324, 23.211666666666662, 12.982000000000003, 33.602000000000004, 25.347999999999992, 35.94666666666667, 56.11166666666673, 27.126999999999995, 17.046333333333337, 14.089333333333334, 25.483333333333327, 29.42999999999999, 16.580333333333336, 28.24633333333333, 13.202000000000005, 17.43633333333333, 35.00366666666668, 42.09833333333333, 12.681999999999999, 14.17233333333333, 21.410333333333334, 11.631999999999998, 21.514000000000003, 40.322, 20.254333333333324, 18.76933333333333, 17.292333333333332, 21.92733333333332, 19.643999999999988, 31.44133333333334, 54.409, 12.203999999999999, 31.74733333333333, 31.534666666666652, 45.27333333333335, 32.251999999999995, 16.473666666666663, 19.250666666666664, 25.95166666666667, 21.453666666666667, 33.85666666666668, 26.897999999999982, 17.377999999999997, 19.640999999999995, 24.596, 29.928666666666665, 27.537999999999993, 17.79033333333333, 17.064333333333337, 58.95266666666665, 32.76166666666667, 13.31, 16.69966666666667, 17.533999999999995, 21.09266666666666, 32.698333333333345, 25.834, 19.17033333333333, 19.988000000000003, 22.799333333333323, 48.18533333333333, 32.90833333333333, 50.02400000000002, 22.05799999999999, 18.15433333333333, 19.564333333333323, 18.78366666666667, 22.967999999999993, 25.583999999999996, 16.232666666666663, 33.62333333333333, 16.614999999999995, 25.068, 16.698666666666664, 17.518333333333324, 17.91533333333333, 28.029999999999994, 17.558, 26.59699999999999, 16.36566666666666], "episode_lengths": [29, 48, 36, 37, 65, 29, 61, 36, 47, 53, 21, 39, 40, 29, 57, 33, 81, 29, 53, 37, 110, 42, 30, 84, 44, 70, 113, 48, 31, 26, 45, 49, 34, 49, 25, 40, 68, 96, 24, 29, 38, 25, 39, 97, 36, 37, 35, 51, 53, 64, 121, 24, 65, 79, 97, 53, 34, 46, 44, 48, 68, 80, 37, 41, 39, 76, 45, 36, 34, 131, 60, 27, 31, 37, 42, 53, 64, 41, 41, 47, 103, 54, 83, 41, 36, 36, 34, 50, 46, 31, 81, 36, 51, 33, 34, 37, 66, 45, 57, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2563404064257282, "mean_inference_ms": 2.3063208005926255, "mean_action_processing_ms": 0.4728502019965717, "mean_env_wait_ms": 0.11133938042181375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270688533782959, "StateBufferConnector_ms": 0.010153532028198242, "ViewRequirementAgentConnector_ms": 0.3615987300872803}}, "episode_reward_max": 58.95266666666665, "episode_reward_min": 11.631999999999998, "episode_reward_mean": 24.63210666666667, "episode_len_mean": 50.18, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.427999999999997, 21.16099999999999, 21.442333333333334, 18.54133333333333, 39.82666666666665, 14.977333333333338, 37.31033333333334, 17.696666666666665, 24.536666666666665, 21.991666666666656, 11.801333333333329, 23.89966666666666, 19.90333333333333, 15.749999999999996, 23.328333333333333, 15.413999999999996, 34.755, 16.669999999999995, 22.09766666666666, 19.62399999999999, 46.515333333333324, 23.211666666666662, 12.982000000000003, 33.602000000000004, 25.347999999999992, 35.94666666666667, 56.11166666666673, 27.126999999999995, 17.046333333333337, 14.089333333333334, 25.483333333333327, 29.42999999999999, 16.580333333333336, 28.24633333333333, 13.202000000000005, 17.43633333333333, 35.00366666666668, 42.09833333333333, 12.681999999999999, 14.17233333333333, 21.410333333333334, 11.631999999999998, 21.514000000000003, 40.322, 20.254333333333324, 18.76933333333333, 17.292333333333332, 21.92733333333332, 19.643999999999988, 31.44133333333334, 54.409, 12.203999999999999, 31.74733333333333, 31.534666666666652, 45.27333333333335, 32.251999999999995, 16.473666666666663, 19.250666666666664, 25.95166666666667, 21.453666666666667, 33.85666666666668, 26.897999999999982, 17.377999999999997, 19.640999999999995, 24.596, 29.928666666666665, 27.537999999999993, 17.79033333333333, 17.064333333333337, 58.95266666666665, 32.76166666666667, 13.31, 16.69966666666667, 17.533999999999995, 21.09266666666666, 32.698333333333345, 25.834, 19.17033333333333, 19.988000000000003, 22.799333333333323, 48.18533333333333, 32.90833333333333, 50.02400000000002, 22.05799999999999, 18.15433333333333, 19.564333333333323, 18.78366666666667, 22.967999999999993, 25.583999999999996, 16.232666666666663, 33.62333333333333, 16.614999999999995, 25.068, 16.698666666666664, 17.518333333333324, 17.91533333333333, 28.029999999999994, 17.558, 26.59699999999999, 16.36566666666666], "episode_lengths": [29, 48, 36, 37, 65, 29, 61, 36, 47, 53, 21, 39, 40, 29, 57, 33, 81, 29, 53, 37, 110, 42, 30, 84, 44, 70, 113, 48, 31, 26, 45, 49, 34, 49, 25, 40, 68, 96, 24, 29, 38, 25, 39, 97, 36, 37, 35, 51, 53, 64, 121, 24, 65, 79, 97, 53, 34, 46, 44, 48, 68, 80, 37, 41, 39, 76, 45, 36, 34, 131, 60, 27, 31, 37, 42, 53, 64, 41, 41, 47, 103, 54, 83, 41, 36, 36, 34, 50, 46, 31, 81, 36, 51, 33, 34, 37, 66, 45, 57, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2563404064257282, "mean_inference_ms": 2.3063208005926255, "mean_action_processing_ms": 0.4728502019965717, "mean_env_wait_ms": 0.11133938042181375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270688533782959, "StateBufferConnector_ms": 0.010153532028198242, "ViewRequirementAgentConnector_ms": 0.3615987300872803}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 688.3404054472599, "num_env_steps_trained_throughput_per_sec": 688.3404054472599, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 6168.484, "sample_time_ms": 2456.864, "load_time_ms": 0.581, "load_throughput": 6883807.648, "learn_time_ms": 3691.933, "learn_throughput": 1083.443, "synch_weights_time_ms": 17.743}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 1403, "training_iteration": 11, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-12", "timestamp": 1701995232, "time_this_iter_s": 5.829081773757935, "time_total_s": 68.05423736572266, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 68.05423736572266, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 73.5625, "ram_util_percent": 94.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 6.271022319793701, "policy_loss": -0.009477613493800163, "vf_loss": 6.280300617218018, "vf_explained_var": 0.5708480477333069, "kl": 0.002354328753426671, "entropy": 0.36273398995399475, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 76.38200000000006, "episode_reward_min": 11.69133333333333, "episode_reward_mean": 26.444933333333335, "episode_len_mean": 54.04, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.69966666666667, 17.533999999999995, 21.09266666666666, 32.698333333333345, 25.834, 19.17033333333333, 19.988000000000003, 22.799333333333323, 48.18533333333333, 32.90833333333333, 50.02400000000002, 22.05799999999999, 18.15433333333333, 19.564333333333323, 18.78366666666667, 22.967999999999993, 25.583999999999996, 16.232666666666663, 33.62333333333333, 16.614999999999995, 25.068, 16.698666666666664, 17.518333333333324, 17.91533333333333, 28.029999999999994, 17.558, 26.59699999999999, 16.36566666666666, 26.110666666666663, 49.33833333333332, 31.670333333333335, 31.436999999999976, 38.253666666666675, 11.69133333333333, 26.115, 22.377666666666663, 16.33433333333333, 29.078333333333326, 25.92799999999999, 62.51799999999999, 30.129999999999995, 29.31233333333333, 26.449666666666662, 28.95233333333332, 21.606999999999992, 52.368333333333354, 24.084666666666653, 19.96466666666666, 33.694, 22.160666666666657, 47.84533333333334, 31.621000000000006, 16.986333333333327, 26.671000000000003, 15.832666666666663, 20.70133333333333, 17.430000000000003, 29.026, 35.43433333333333, 22.429333333333325, 19.90899999999999, 26.03366666666667, 35.531666666666666, 15.41799999999999, 31.728333333333314, 39.502333333333326, 15.909666666666665, 24.050333333333324, 38.51566666666669, 26.38366666666667, 20.840666666666664, 25.60899999999999, 36.14700000000001, 40.90666666666664, 21.046999999999993, 13.877666666666665, 23.562666666666672, 30.23066666666665, 33.812, 15.34666666666666, 19.669999999999995, 14.316999999999993, 29.83033333333334, 31.92866666666668, 24.91733333333332, 76.38200000000006, 30.597, 17.745333333333335, 17.738999999999997, 33.748999999999995, 22.423000000000005, 18.04033333333333, 16.95066666666666, 28.165000000000003, 24.11133333333333, 17.612666666666655, 18.475333333333328, 23.64233333333333, 31.159000000000013, 22.853666666666665], "episode_lengths": [31, 37, 42, 53, 64, 41, 41, 47, 103, 54, 83, 41, 36, 36, 34, 50, 46, 31, 81, 36, 51, 33, 34, 37, 66, 45, 57, 31, 44, 94, 55, 82, 74, 22, 46, 47, 31, 62, 66, 104, 60, 54, 45, 57, 56, 113, 52, 39, 78, 57, 94, 66, 48, 51, 41, 41, 35, 46, 56, 66, 44, 60, 67, 38, 91, 76, 36, 66, 66, 52, 39, 71, 66, 90, 46, 28, 49, 58, 60, 39, 37, 28, 62, 62, 49, 134, 55, 33, 36, 54, 46, 34, 33, 47, 63, 44, 37, 54, 60, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.257659812146612, "mean_inference_ms": 2.313578384630735, "mean_action_processing_ms": 0.47570045465793936, "mean_env_wait_ms": 0.11124792547018329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027282238006591797, "StateBufferConnector_ms": 0.011480569839477539, "ViewRequirementAgentConnector_ms": 0.4583907127380371}}, "episode_reward_max": 76.38200000000006, "episode_reward_min": 11.69133333333333, "episode_reward_mean": 26.444933333333335, "episode_len_mean": 54.04, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.69966666666667, 17.533999999999995, 21.09266666666666, 32.698333333333345, 25.834, 19.17033333333333, 19.988000000000003, 22.799333333333323, 48.18533333333333, 32.90833333333333, 50.02400000000002, 22.05799999999999, 18.15433333333333, 19.564333333333323, 18.78366666666667, 22.967999999999993, 25.583999999999996, 16.232666666666663, 33.62333333333333, 16.614999999999995, 25.068, 16.698666666666664, 17.518333333333324, 17.91533333333333, 28.029999999999994, 17.558, 26.59699999999999, 16.36566666666666, 26.110666666666663, 49.33833333333332, 31.670333333333335, 31.436999999999976, 38.253666666666675, 11.69133333333333, 26.115, 22.377666666666663, 16.33433333333333, 29.078333333333326, 25.92799999999999, 62.51799999999999, 30.129999999999995, 29.31233333333333, 26.449666666666662, 28.95233333333332, 21.606999999999992, 52.368333333333354, 24.084666666666653, 19.96466666666666, 33.694, 22.160666666666657, 47.84533333333334, 31.621000000000006, 16.986333333333327, 26.671000000000003, 15.832666666666663, 20.70133333333333, 17.430000000000003, 29.026, 35.43433333333333, 22.429333333333325, 19.90899999999999, 26.03366666666667, 35.531666666666666, 15.41799999999999, 31.728333333333314, 39.502333333333326, 15.909666666666665, 24.050333333333324, 38.51566666666669, 26.38366666666667, 20.840666666666664, 25.60899999999999, 36.14700000000001, 40.90666666666664, 21.046999999999993, 13.877666666666665, 23.562666666666672, 30.23066666666665, 33.812, 15.34666666666666, 19.669999999999995, 14.316999999999993, 29.83033333333334, 31.92866666666668, 24.91733333333332, 76.38200000000006, 30.597, 17.745333333333335, 17.738999999999997, 33.748999999999995, 22.423000000000005, 18.04033333333333, 16.95066666666666, 28.165000000000003, 24.11133333333333, 17.612666666666655, 18.475333333333328, 23.64233333333333, 31.159000000000013, 22.853666666666665], "episode_lengths": [31, 37, 42, 53, 64, 41, 41, 47, 103, 54, 83, 41, 36, 36, 34, 50, 46, 31, 81, 36, 51, 33, 34, 37, 66, 45, 57, 31, 44, 94, 55, 82, 74, 22, 46, 47, 31, 62, 66, 104, 60, 54, 45, 57, 56, 113, 52, 39, 78, 57, 94, 66, 48, 51, 41, 41, 35, 46, 56, 66, 44, 60, 67, 38, 91, 76, 36, 66, 66, 52, 39, 71, 66, 90, 46, 28, 49, 58, 60, 39, 37, 28, 62, 62, 49, 134, 55, 33, 36, 54, 46, 34, 33, 47, 63, 44, 37, 54, 60, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.257659812146612, "mean_inference_ms": 2.313578384630735, "mean_action_processing_ms": 0.47570045465793936, "mean_env_wait_ms": 0.11124792547018329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027282238006591797, "StateBufferConnector_ms": 0.011480569839477539, "ViewRequirementAgentConnector_ms": 0.4583907127380371}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 616.0944929969683, "num_env_steps_trained_throughput_per_sec": 616.0944929969683, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 6217.048, "sample_time_ms": 2497.027, "load_time_ms": 0.683, "load_throughput": 5857148.443, "learn_time_ms": 3699.233, "learn_throughput": 1081.305, "synch_weights_time_ms": 18.841}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 1475, "training_iteration": 12, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-19", "timestamp": 1701995239, "time_this_iter_s": 6.558645009994507, "time_total_s": 74.61288237571716, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 74.61288237571716, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 75.3, "ram_util_percent": 94.11111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.04218750074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.363916397094727, "policy_loss": -0.0076996516436338425, "vf_loss": 5.371505260467529, "vf_explained_var": 0.5915781259536743, "kl": 0.002638197038322687, "entropy": 0.30827295780181885, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 76.38200000000006, "episode_reward_min": 12.27833333333333, "episode_reward_mean": 24.298569999999998, "episode_len_mean": 49.07, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.92866666666668, 24.91733333333332, 76.38200000000006, 30.597, 17.745333333333335, 17.738999999999997, 33.748999999999995, 22.423000000000005, 18.04033333333333, 16.95066666666666, 28.165000000000003, 24.11133333333333, 17.612666666666655, 18.475333333333328, 23.64233333333333, 31.159000000000013, 22.853666666666665, 27.219000000000012, 24.256, 14.622333333333327, 40.25899999999999, 20.302666666666664, 18.528666666666656, 31.75233333333334, 21.80333333333332, 27.73733333333333, 36.48900000000002, 32.998, 27.077999999999992, 12.27833333333333, 22.253333333333334, 22.17066666666666, 57.97133333333334, 31.71633333333334, 14.486999999999997, 25.099333333333323, 13.848666666666666, 15.127333333333333, 29.175999999999995, 30.935666666666652, 24.219333333333328, 18.813666666666666, 16.734999999999996, 24.47133333333333, 14.794999999999995, 52.295000000000044, 14.812333333333328, 20.284999999999993, 19.312333333333328, 30.143333333333317, 12.704333333333327, 38.24933333333335, 18.54933333333333, 33.15966666666666, 35.362, 16.85733333333333, 22.62366666666667, 13.685333333333332, 16.353666666666665, 14.13533333333333, 36.20533333333333, 23.197999999999997, 19.63833333333333, 21.122333333333327, 19.91233333333333, 19.944666666666663, 14.757666666666664, 15.436999999999998, 26.508666666666656, 22.611666666666665, 14.668999999999999, 17.470333333333333, 42.987000000000016, 18.274333333333335, 20.64133333333332, 32.36900000000001, 34.973000000000006, 21.29266666666666, 15.374999999999996, 15.95666666666666, 18.951333333333334, 45.95566666666669, 25.588333333333324, 19.247333333333327, 15.523666666666657, 26.935333333333336, 19.043666666666663, 18.61933333333333, 17.575333333333337, 21.575333333333333, 35.187, 14.641333333333327, 14.663333333333336, 22.31333333333332, 16.875999999999994, 39.38933333333332, 30.582666666666665, 23.353666666666662, 14.162666666666663, 24.16433333333333], "episode_lengths": [62, 49, 134, 55, 33, 36, 54, 46, 34, 33, 47, 63, 44, 37, 54, 60, 71, 59, 55, 26, 72, 41, 39, 56, 43, 70, 69, 60, 71, 23, 41, 53, 95, 71, 30, 47, 25, 30, 59, 63, 44, 44, 32, 53, 30, 100, 34, 42, 43, 53, 28, 87, 39, 61, 61, 28, 45, 27, 32, 27, 64, 47, 43, 49, 41, 40, 31, 30, 62, 50, 28, 34, 96, 37, 56, 51, 57, 37, 32, 45, 44, 68, 52, 53, 35, 55, 35, 39, 34, 50, 72, 29, 27, 47, 33, 91, 60, 55, 30, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2794410435317831, "mean_inference_ms": 2.3677723299918068, "mean_action_processing_ms": 0.483519040033358, "mean_env_wait_ms": 0.11498465151513354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026030778884887695, "StateBufferConnector_ms": 0.013422012329101562, "ViewRequirementAgentConnector_ms": 0.5224735736846924}}, "episode_reward_max": 76.38200000000006, "episode_reward_min": 12.27833333333333, "episode_reward_mean": 24.298569999999998, "episode_len_mean": 49.07, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.92866666666668, 24.91733333333332, 76.38200000000006, 30.597, 17.745333333333335, 17.738999999999997, 33.748999999999995, 22.423000000000005, 18.04033333333333, 16.95066666666666, 28.165000000000003, 24.11133333333333, 17.612666666666655, 18.475333333333328, 23.64233333333333, 31.159000000000013, 22.853666666666665, 27.219000000000012, 24.256, 14.622333333333327, 40.25899999999999, 20.302666666666664, 18.528666666666656, 31.75233333333334, 21.80333333333332, 27.73733333333333, 36.48900000000002, 32.998, 27.077999999999992, 12.27833333333333, 22.253333333333334, 22.17066666666666, 57.97133333333334, 31.71633333333334, 14.486999999999997, 25.099333333333323, 13.848666666666666, 15.127333333333333, 29.175999999999995, 30.935666666666652, 24.219333333333328, 18.813666666666666, 16.734999999999996, 24.47133333333333, 14.794999999999995, 52.295000000000044, 14.812333333333328, 20.284999999999993, 19.312333333333328, 30.143333333333317, 12.704333333333327, 38.24933333333335, 18.54933333333333, 33.15966666666666, 35.362, 16.85733333333333, 22.62366666666667, 13.685333333333332, 16.353666666666665, 14.13533333333333, 36.20533333333333, 23.197999999999997, 19.63833333333333, 21.122333333333327, 19.91233333333333, 19.944666666666663, 14.757666666666664, 15.436999999999998, 26.508666666666656, 22.611666666666665, 14.668999999999999, 17.470333333333333, 42.987000000000016, 18.274333333333335, 20.64133333333332, 32.36900000000001, 34.973000000000006, 21.29266666666666, 15.374999999999996, 15.95666666666666, 18.951333333333334, 45.95566666666669, 25.588333333333324, 19.247333333333327, 15.523666666666657, 26.935333333333336, 19.043666666666663, 18.61933333333333, 17.575333333333337, 21.575333333333333, 35.187, 14.641333333333327, 14.663333333333336, 22.31333333333332, 16.875999999999994, 39.38933333333332, 30.582666666666665, 23.353666666666662, 14.162666666666663, 24.16433333333333], "episode_lengths": [62, 49, 134, 55, 33, 36, 54, 46, 34, 33, 47, 63, 44, 37, 54, 60, 71, 59, 55, 26, 72, 41, 39, 56, 43, 70, 69, 60, 71, 23, 41, 53, 95, 71, 30, 47, 25, 30, 59, 63, 44, 44, 32, 53, 30, 100, 34, 42, 43, 53, 28, 87, 39, 61, 61, 28, 45, 27, 32, 27, 64, 47, 43, 49, 41, 40, 31, 30, 62, 50, 28, 34, 96, 37, 56, 51, 57, 37, 32, 45, 44, 68, 52, 53, 35, 55, 35, 39, 34, 50, 72, 29, 27, 47, 33, 91, 60, 55, 30, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2794410435317831, "mean_inference_ms": 2.3677723299918068, "mean_action_processing_ms": 0.483519040033358, "mean_env_wait_ms": 0.11498465151513354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026030778884887695, "StateBufferConnector_ms": 0.013422012329101562, "ViewRequirementAgentConnector_ms": 0.5224735736846924}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.3525951036395, "num_env_steps_trained_throughput_per_sec": 513.3525951036395, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 6464.545, "sample_time_ms": 2602.214, "load_time_ms": 0.699, "load_throughput": 5722301.579, "learn_time_ms": 3840.939, "learn_throughput": 1041.412, "synch_weights_time_ms": 19.338}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 1558, "training_iteration": 13, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-27", "timestamp": 1701995247, "time_this_iter_s": 7.804928541183472, "time_total_s": 82.41781091690063, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 82.41781091690063, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 86.02000000000001, "ram_util_percent": 94.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02109375037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 6.586447715759277, "policy_loss": -0.010510682128369808, "vf_loss": 6.596879005432129, "vf_explained_var": 0.5941123366355896, "kl": 0.003727491246536374, "entropy": 0.28897586464881897, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 64.25333333333332, "episode_reward_min": 13.692333333333329, "episode_reward_mean": 26.95520333333333, "episode_len_mean": 54.23, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.987000000000016, 18.274333333333335, 20.64133333333332, 32.36900000000001, 34.973000000000006, 21.29266666666666, 15.374999999999996, 15.95666666666666, 18.951333333333334, 45.95566666666669, 25.588333333333324, 19.247333333333327, 15.523666666666657, 26.935333333333336, 19.043666666666663, 18.61933333333333, 17.575333333333337, 21.575333333333333, 35.187, 14.641333333333327, 14.663333333333336, 22.31333333333332, 16.875999999999994, 39.38933333333332, 30.582666666666665, 23.353666666666662, 14.162666666666663, 24.16433333333333, 40.753999999999984, 41.69633333333331, 20.65333333333332, 24.321666666666662, 32.66633333333335, 16.278, 36.51133333333334, 34.92899999999998, 19.279, 17.456333333333323, 30.226666666666677, 37.79700000000002, 20.070333333333334, 21.087666666666657, 31.62199999999999, 14.874999999999996, 64.25333333333332, 26.93766666666667, 16.595999999999993, 51.14666666666666, 56.56833333333335, 29.943, 30.379333333333317, 26.55666666666667, 52.487000000000016, 62.12533333333333, 21.472333333333328, 22.532666666666678, 21.203666666666663, 18.096333333333334, 18.482999999999997, 22.845333333333322, 46.73233333333335, 19.137999999999995, 18.968666666666657, 23.46466666666666, 30.16800000000001, 16.772000000000006, 15.378000000000002, 15.191999999999998, 20.16, 13.692333333333329, 45.2286666666667, 19.551666666666655, 34.982000000000006, 18.603666666666655, 43.36099999999997, 20.30866666666665, 27.620999999999995, 38.93599999999999, 14.507999999999996, 33.702666666666666, 45.031, 29.89066666666664, 15.988666666666669, 30.88500000000002, 15.765999999999995, 34.81399999999998, 25.446999999999996, 32.00833333333334, 16.01433333333333, 20.525666666666663, 37.87233333333333, 22.01466666666666, 35.574333333333314, 41.62300000000002, 17.96633333333333, 14.029, 32.65033333333333, 30.118666666666655, 18.209333333333333, 14.553666666666665], "episode_lengths": [96, 37, 56, 51, 57, 37, 32, 45, 44, 68, 52, 53, 35, 55, 35, 39, 34, 50, 72, 29, 27, 47, 33, 91, 60, 55, 30, 48, 99, 85, 45, 52, 71, 33, 71, 70, 44, 33, 58, 75, 46, 35, 55, 27, 122, 51, 31, 98, 95, 66, 61, 47, 101, 117, 41, 45, 42, 34, 36, 47, 101, 40, 44, 41, 70, 37, 33, 32, 37, 28, 77, 44, 73, 44, 70, 56, 67, 89, 29, 63, 88, 77, 30, 57, 31, 59, 52, 79, 34, 46, 63, 37, 72, 74, 34, 28, 52, 66, 38, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2880742331868165, "mean_inference_ms": 2.393319505682529, "mean_action_processing_ms": 0.4859610955401804, "mean_env_wait_ms": 0.11461940906864868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027356863021850586, "StateBufferConnector_ms": 0.011325359344482422, "ViewRequirementAgentConnector_ms": 0.4883272647857666}}, "episode_reward_max": 64.25333333333332, "episode_reward_min": 13.692333333333329, "episode_reward_mean": 26.95520333333333, "episode_len_mean": 54.23, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.987000000000016, 18.274333333333335, 20.64133333333332, 32.36900000000001, 34.973000000000006, 21.29266666666666, 15.374999999999996, 15.95666666666666, 18.951333333333334, 45.95566666666669, 25.588333333333324, 19.247333333333327, 15.523666666666657, 26.935333333333336, 19.043666666666663, 18.61933333333333, 17.575333333333337, 21.575333333333333, 35.187, 14.641333333333327, 14.663333333333336, 22.31333333333332, 16.875999999999994, 39.38933333333332, 30.582666666666665, 23.353666666666662, 14.162666666666663, 24.16433333333333, 40.753999999999984, 41.69633333333331, 20.65333333333332, 24.321666666666662, 32.66633333333335, 16.278, 36.51133333333334, 34.92899999999998, 19.279, 17.456333333333323, 30.226666666666677, 37.79700000000002, 20.070333333333334, 21.087666666666657, 31.62199999999999, 14.874999999999996, 64.25333333333332, 26.93766666666667, 16.595999999999993, 51.14666666666666, 56.56833333333335, 29.943, 30.379333333333317, 26.55666666666667, 52.487000000000016, 62.12533333333333, 21.472333333333328, 22.532666666666678, 21.203666666666663, 18.096333333333334, 18.482999999999997, 22.845333333333322, 46.73233333333335, 19.137999999999995, 18.968666666666657, 23.46466666666666, 30.16800000000001, 16.772000000000006, 15.378000000000002, 15.191999999999998, 20.16, 13.692333333333329, 45.2286666666667, 19.551666666666655, 34.982000000000006, 18.603666666666655, 43.36099999999997, 20.30866666666665, 27.620999999999995, 38.93599999999999, 14.507999999999996, 33.702666666666666, 45.031, 29.89066666666664, 15.988666666666669, 30.88500000000002, 15.765999999999995, 34.81399999999998, 25.446999999999996, 32.00833333333334, 16.01433333333333, 20.525666666666663, 37.87233333333333, 22.01466666666666, 35.574333333333314, 41.62300000000002, 17.96633333333333, 14.029, 32.65033333333333, 30.118666666666655, 18.209333333333333, 14.553666666666665], "episode_lengths": [96, 37, 56, 51, 57, 37, 32, 45, 44, 68, 52, 53, 35, 55, 35, 39, 34, 50, 72, 29, 27, 47, 33, 91, 60, 55, 30, 48, 99, 85, 45, 52, 71, 33, 71, 70, 44, 33, 58, 75, 46, 35, 55, 27, 122, 51, 31, 98, 95, 66, 61, 47, 101, 117, 41, 45, 42, 34, 36, 47, 101, 40, 44, 41, 70, 37, 33, 32, 37, 28, 77, 44, 73, 44, 70, 56, 67, 89, 29, 63, 88, 77, 30, 57, 31, 59, 52, 79, 34, 46, 63, 37, 72, 74, 34, 28, 52, 66, 38, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2880742331868165, "mean_inference_ms": 2.393319505682529, "mean_action_processing_ms": 0.4859610955401804, "mean_env_wait_ms": 0.11461940906864868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027356863021850586, "StateBufferConnector_ms": 0.011325359344482422, "ViewRequirementAgentConnector_ms": 0.4883272647857666}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 574.5209128467413, "num_env_steps_trained_throughput_per_sec": 574.5209128467413, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 6633.281, "sample_time_ms": 2658.763, "load_time_ms": 0.703, "load_throughput": 5690471.119, "learn_time_ms": 3952.463, "learn_throughput": 1012.027, "synch_weights_time_ms": 19.733}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 1630, "training_iteration": 14, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-34", "timestamp": 1701995254, "time_this_iter_s": 6.985208749771118, "time_total_s": 89.40301966667175, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 89.40301966667175, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 73.74, "ram_util_percent": 95.01000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.010546875186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 6.363965034484863, "policy_loss": -0.005994289647787809, "vf_loss": 6.369935512542725, "vf_explained_var": 0.5632104873657227, "kl": 0.002261000918224454, "entropy": 0.2678936719894409, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 73.5523333333334, "episode_reward_min": 12.529999999999996, "episode_reward_mean": 28.04783333333333, "episode_len_mean": 55.57, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.692333333333329, 45.2286666666667, 19.551666666666655, 34.982000000000006, 18.603666666666655, 43.36099999999997, 20.30866666666665, 27.620999999999995, 38.93599999999999, 14.507999999999996, 33.702666666666666, 45.031, 29.89066666666664, 15.988666666666669, 30.88500000000002, 15.765999999999995, 34.81399999999998, 25.446999999999996, 32.00833333333334, 16.01433333333333, 20.525666666666663, 37.87233333333333, 22.01466666666666, 35.574333333333314, 41.62300000000002, 17.96633333333333, 14.029, 32.65033333333333, 30.118666666666655, 18.209333333333333, 14.553666666666665, 17.386999999999997, 29.93633333333335, 55.61166666666666, 49.33600000000002, 20.991999999999987, 19.931333333333328, 36.562333333333335, 21.587999999999997, 43.14199999999996, 38.37333333333334, 19.695999999999994, 31.83166666666667, 32.010333333333335, 21.381000000000004, 19.15533333333333, 27.062333333333328, 32.28699999999999, 18.90166666666666, 24.566666666666674, 45.41633333333334, 20.94833333333333, 23.56633333333332, 29.659333333333343, 21.697333333333336, 18.257999999999996, 44.569333333333304, 31.560666666666666, 23.75066666666666, 52.0553333333333, 33.76300000000001, 16.686666666666664, 28.373666666666672, 16.293999999999993, 14.650333333333329, 15.170000000000002, 73.5523333333334, 15.991666666666667, 24.383999999999997, 18.416333333333327, 23.34333333333334, 15.137999999999996, 22.237666666666673, 47.10866666666668, 19.08, 28.725666666666662, 18.914333333333325, 18.494, 30.597000000000005, 20.401333333333326, 28.45433333333332, 18.47033333333333, 17.31966666666667, 22.59133333333333, 24.024666666666665, 25.16933333333333, 50.71899999999999, 26.807999999999982, 15.595999999999998, 12.529999999999996, 38.291666666666664, 26.183000000000003, 49.53600000000002, 19.302666666666656, 34.651666666666664, 47.27366666666665, 33.852000000000004, 49.05333333333331, 24.811333333333344, 26.111666666666668], "episode_lengths": [28, 77, 44, 73, 44, 70, 56, 67, 89, 29, 63, 88, 77, 30, 57, 31, 59, 52, 79, 34, 46, 63, 37, 72, 74, 34, 28, 52, 66, 38, 30, 37, 56, 83, 75, 56, 39, 70, 54, 70, 66, 41, 63, 76, 52, 35, 51, 78, 42, 57, 87, 43, 48, 54, 45, 41, 91, 68, 47, 104, 63, 29, 60, 33, 28, 30, 128, 32, 49, 35, 45, 31, 44, 83, 42, 71, 37, 33, 52, 52, 56, 34, 34, 41, 57, 41, 110, 48, 31, 28, 72, 56, 95, 37, 79, 83, 67, 101, 49, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297634327610391, "mean_inference_ms": 2.420986971214465, "mean_action_processing_ms": 0.48889834041898134, "mean_env_wait_ms": 0.11504116440077752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020949125289916992, "StateBufferConnector_ms": 0.008773565292358398, "ViewRequirementAgentConnector_ms": 0.51011061668396}}, "episode_reward_max": 73.5523333333334, "episode_reward_min": 12.529999999999996, "episode_reward_mean": 28.04783333333333, "episode_len_mean": 55.57, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.692333333333329, 45.2286666666667, 19.551666666666655, 34.982000000000006, 18.603666666666655, 43.36099999999997, 20.30866666666665, 27.620999999999995, 38.93599999999999, 14.507999999999996, 33.702666666666666, 45.031, 29.89066666666664, 15.988666666666669, 30.88500000000002, 15.765999999999995, 34.81399999999998, 25.446999999999996, 32.00833333333334, 16.01433333333333, 20.525666666666663, 37.87233333333333, 22.01466666666666, 35.574333333333314, 41.62300000000002, 17.96633333333333, 14.029, 32.65033333333333, 30.118666666666655, 18.209333333333333, 14.553666666666665, 17.386999999999997, 29.93633333333335, 55.61166666666666, 49.33600000000002, 20.991999999999987, 19.931333333333328, 36.562333333333335, 21.587999999999997, 43.14199999999996, 38.37333333333334, 19.695999999999994, 31.83166666666667, 32.010333333333335, 21.381000000000004, 19.15533333333333, 27.062333333333328, 32.28699999999999, 18.90166666666666, 24.566666666666674, 45.41633333333334, 20.94833333333333, 23.56633333333332, 29.659333333333343, 21.697333333333336, 18.257999999999996, 44.569333333333304, 31.560666666666666, 23.75066666666666, 52.0553333333333, 33.76300000000001, 16.686666666666664, 28.373666666666672, 16.293999999999993, 14.650333333333329, 15.170000000000002, 73.5523333333334, 15.991666666666667, 24.383999999999997, 18.416333333333327, 23.34333333333334, 15.137999999999996, 22.237666666666673, 47.10866666666668, 19.08, 28.725666666666662, 18.914333333333325, 18.494, 30.597000000000005, 20.401333333333326, 28.45433333333332, 18.47033333333333, 17.31966666666667, 22.59133333333333, 24.024666666666665, 25.16933333333333, 50.71899999999999, 26.807999999999982, 15.595999999999998, 12.529999999999996, 38.291666666666664, 26.183000000000003, 49.53600000000002, 19.302666666666656, 34.651666666666664, 47.27366666666665, 33.852000000000004, 49.05333333333331, 24.811333333333344, 26.111666666666668], "episode_lengths": [28, 77, 44, 73, 44, 70, 56, 67, 89, 29, 63, 88, 77, 30, 57, 31, 59, 52, 79, 34, 46, 63, 37, 72, 74, 34, 28, 52, 66, 38, 30, 37, 56, 83, 75, 56, 39, 70, 54, 70, 66, 41, 63, 76, 52, 35, 51, 78, 42, 57, 87, 43, 48, 54, 45, 41, 91, 68, 47, 104, 63, 29, 60, 33, 28, 30, 128, 32, 49, 35, 45, 31, 44, 83, 42, 71, 37, 33, 52, 52, 56, 34, 34, 41, 57, 41, 110, 48, 31, 28, 72, 56, 95, 37, 79, 83, 67, 101, 49, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297634327610391, "mean_inference_ms": 2.420986971214465, "mean_action_processing_ms": 0.48889834041898134, "mean_env_wait_ms": 0.11504116440077752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020949125289916992, "StateBufferConnector_ms": 0.008773565292358398, "ViewRequirementAgentConnector_ms": 0.51011061668396}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 600.1021702193626, "num_env_steps_trained_throughput_per_sec": 600.1021702193626, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 6530.513, "sample_time_ms": 2614.571, "load_time_ms": 0.601, "load_throughput": 6655776.57, "learn_time_ms": 3893.088, "learn_throughput": 1027.462, "synch_weights_time_ms": 20.365}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 1699, "training_iteration": 15, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-41", "timestamp": 1701995261, "time_this_iter_s": 6.682056903839111, "time_total_s": 96.08507657051086, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.08507657051086, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 77.30000000000001, "ram_util_percent": 93.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0052734375931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 5.737565040588379, "policy_loss": -0.0009772572666406631, "vf_loss": 5.738523960113525, "vf_explained_var": 0.5749496221542358, "kl": 0.0034726844169199467, "entropy": 0.22779248654842377, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 65.81666666666668, "episode_reward_min": 12.529999999999996, "episode_reward_mean": 27.0669, "episode_len_mean": 54.86, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.08, 28.725666666666662, 18.914333333333325, 18.494, 30.597000000000005, 20.401333333333326, 28.45433333333332, 18.47033333333333, 17.31966666666667, 22.59133333333333, 24.024666666666665, 25.16933333333333, 50.71899999999999, 26.807999999999982, 15.595999999999998, 12.529999999999996, 38.291666666666664, 26.183000000000003, 49.53600000000002, 19.302666666666656, 34.651666666666664, 47.27366666666665, 33.852000000000004, 49.05333333333331, 24.811333333333344, 26.111666666666668, 24.120333333333328, 19.215666666666657, 59.14000000000001, 16.717666666666663, 22.52166666666666, 20.878666666666664, 42.112, 36.773999999999994, 24.68766666666667, 19.401666666666667, 35.30833333333333, 25.379333333333335, 28.350666666666655, 13.57166666666666, 18.132999999999996, 21.98166666666666, 16.279333333333334, 21.058333333333337, 39.34866666666666, 18.029666666666667, 15.893333333333327, 40.56133333333334, 35.482666666666674, 28.719666666666658, 16.59766666666666, 35.73433333333334, 23.87966666666667, 32.34066666666668, 26.08300000000001, 35.63366666666667, 27.535333333333323, 37.959, 49.70800000000001, 23.326999999999995, 21.425666666666675, 34.849000000000004, 20.738666666666656, 19.498333333333328, 16.490000000000002, 39.55433333333334, 22.44599999999999, 19.108999999999995, 38.08700000000001, 16.578999999999994, 17.274, 26.10266666666667, 28.04866666666666, 31.467333333333336, 26.341666666666654, 14.626999999999997, 21.34466666666666, 17.057999999999996, 65.81666666666668, 41.62933333333334, 17.276666666666664, 27.08199999999999, 28.597666666666665, 26.873666666666672, 17.903333333333325, 49.804000000000016, 18.967999999999996, 20.18366666666666, 28.969999999999995, 43.212666666666664, 23.372333333333327, 22.073666666666668, 30.93000000000001, 17.789999999999996, 24.321000000000005, 16.17033333333333, 14.273000000000001, 32.65233333333333, 13.234666666666662, 15.086666666666659], "episode_lengths": [42, 71, 37, 33, 52, 52, 56, 34, 34, 41, 57, 41, 110, 48, 31, 28, 72, 56, 95, 37, 79, 83, 67, 101, 49, 45, 49, 39, 115, 36, 52, 48, 79, 58, 57, 47, 60, 44, 62, 32, 36, 44, 31, 45, 73, 36, 35, 88, 62, 52, 32, 66, 62, 67, 54, 74, 53, 75, 89, 50, 48, 63, 45, 36, 35, 80, 50, 48, 75, 34, 49, 55, 48, 59, 50, 29, 45, 33, 125, 87, 35, 70, 71, 53, 37, 111, 33, 42, 47, 101, 55, 44, 75, 35, 53, 34, 28, 56, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991761654416587, "mean_inference_ms": 2.436726518695205, "mean_action_processing_ms": 0.491809796053194, "mean_env_wait_ms": 0.11590802582096466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01668262481689453, "StateBufferConnector_ms": 0.011346817016601562, "ViewRequirementAgentConnector_ms": 0.4199941158294678}}, "episode_reward_max": 65.81666666666668, "episode_reward_min": 12.529999999999996, "episode_reward_mean": 27.0669, "episode_len_mean": 54.86, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.08, 28.725666666666662, 18.914333333333325, 18.494, 30.597000000000005, 20.401333333333326, 28.45433333333332, 18.47033333333333, 17.31966666666667, 22.59133333333333, 24.024666666666665, 25.16933333333333, 50.71899999999999, 26.807999999999982, 15.595999999999998, 12.529999999999996, 38.291666666666664, 26.183000000000003, 49.53600000000002, 19.302666666666656, 34.651666666666664, 47.27366666666665, 33.852000000000004, 49.05333333333331, 24.811333333333344, 26.111666666666668, 24.120333333333328, 19.215666666666657, 59.14000000000001, 16.717666666666663, 22.52166666666666, 20.878666666666664, 42.112, 36.773999999999994, 24.68766666666667, 19.401666666666667, 35.30833333333333, 25.379333333333335, 28.350666666666655, 13.57166666666666, 18.132999999999996, 21.98166666666666, 16.279333333333334, 21.058333333333337, 39.34866666666666, 18.029666666666667, 15.893333333333327, 40.56133333333334, 35.482666666666674, 28.719666666666658, 16.59766666666666, 35.73433333333334, 23.87966666666667, 32.34066666666668, 26.08300000000001, 35.63366666666667, 27.535333333333323, 37.959, 49.70800000000001, 23.326999999999995, 21.425666666666675, 34.849000000000004, 20.738666666666656, 19.498333333333328, 16.490000000000002, 39.55433333333334, 22.44599999999999, 19.108999999999995, 38.08700000000001, 16.578999999999994, 17.274, 26.10266666666667, 28.04866666666666, 31.467333333333336, 26.341666666666654, 14.626999999999997, 21.34466666666666, 17.057999999999996, 65.81666666666668, 41.62933333333334, 17.276666666666664, 27.08199999999999, 28.597666666666665, 26.873666666666672, 17.903333333333325, 49.804000000000016, 18.967999999999996, 20.18366666666666, 28.969999999999995, 43.212666666666664, 23.372333333333327, 22.073666666666668, 30.93000000000001, 17.789999999999996, 24.321000000000005, 16.17033333333333, 14.273000000000001, 32.65233333333333, 13.234666666666662, 15.086666666666659], "episode_lengths": [42, 71, 37, 33, 52, 52, 56, 34, 34, 41, 57, 41, 110, 48, 31, 28, 72, 56, 95, 37, 79, 83, 67, 101, 49, 45, 49, 39, 115, 36, 52, 48, 79, 58, 57, 47, 60, 44, 62, 32, 36, 44, 31, 45, 73, 36, 35, 88, 62, 52, 32, 66, 62, 67, 54, 74, 53, 75, 89, 50, 48, 63, 45, 36, 35, 80, 50, 48, 75, 34, 49, 55, 48, 59, 50, 29, 45, 33, 125, 87, 35, 70, 71, 53, 37, 111, 33, 42, 47, 101, 55, 44, 75, 35, 53, 34, 28, 56, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2991761654416587, "mean_inference_ms": 2.436726518695205, "mean_action_processing_ms": 0.491809796053194, "mean_env_wait_ms": 0.11590802582096466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01668262481689453, "StateBufferConnector_ms": 0.011346817016601562, "ViewRequirementAgentConnector_ms": 0.4199941158294678}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 643.6457232638314, "num_env_steps_trained_throughput_per_sec": 643.6457232638314, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 6527.836, "sample_time_ms": 2655.945, "load_time_ms": 0.687, "load_throughput": 5818553.097, "learn_time_ms": 3850.442, "learn_throughput": 1038.842, "synch_weights_time_ms": 19.071}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 1773, "training_iteration": 16, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-47", "timestamp": 1701995267, "time_this_iter_s": 6.225196838378906, "time_total_s": 102.31027340888977, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.31027340888977, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 76.61111111111111, "ram_util_percent": 93.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0026367187965661287, "cur_lr": 4.999999873689376e-05, "total_loss": 5.513770580291748, "policy_loss": -0.004576895385980606, "vf_loss": 5.518345832824707, "vf_explained_var": 0.650231122970581, "kl": 0.0008852435857988894, "entropy": 0.2266215980052948, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 65.81666666666668, "episode_reward_min": 13.234666666666662, "episode_reward_mean": 26.201866666666664, "episode_len_mean": 53.61, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.626999999999997, 21.34466666666666, 17.057999999999996, 65.81666666666668, 41.62933333333334, 17.276666666666664, 27.08199999999999, 28.597666666666665, 26.873666666666672, 17.903333333333325, 49.804000000000016, 18.967999999999996, 20.18366666666666, 28.969999999999995, 43.212666666666664, 23.372333333333327, 22.073666666666668, 30.93000000000001, 17.789999999999996, 24.321000000000005, 16.17033333333333, 14.273000000000001, 32.65233333333333, 13.234666666666662, 15.086666666666659, 18.376, 19.287999999999993, 45.64300000000001, 22.726333333333333, 24.094999999999985, 23.27766666666667, 26.10033333333333, 37.688666666666656, 15.584999999999994, 55.15366666666667, 18.22699999999999, 14.124333333333325, 29.76533333333335, 37.283333333333324, 18.769999999999996, 18.760999999999992, 20.775000000000002, 24.020666666666667, 18.918333333333326, 25.36233333333333, 18.083666666666666, 17.459666666666664, 20.47899999999999, 36.99666666666666, 47.24633333333335, 42.856333333333346, 14.61933333333333, 45.050000000000004, 29.576333333333338, 54.076333333333366, 43.68633333333333, 19.035666666666653, 18.933, 37.80566666666668, 15.43699999999999, 25.058333333333337, 22.883666666666667, 35.06400000000001, 21.678333333333335, 27.39466666666667, 21.583666666666655, 42.30366666666666, 17.90033333333333, 33.61333333333333, 34.87700000000001, 45.32533333333329, 21.744333333333334, 17.726, 32.78433333333334, 37.378666666666675, 14.817, 19.623, 23.407333333333327, 18.693333333333324, 22.957666666666658, 27.448333333333327, 14.473666666666663, 31.562000000000012, 34.63433333333334, 22.74366666666667, 23.688666666666663, 44.82400000000003, 16.96933333333333, 20.154333333333327, 23.174999999999997, 21.769, 23.097333333333317, 24.04233333333334, 20.53033333333333, 21.172666666666668, 20.40233333333333, 21.14633333333333, 16.272666666666662, 15.573999999999993, 15.158666666666667], "episode_lengths": [29, 45, 33, 125, 87, 35, 70, 71, 53, 37, 111, 33, 42, 47, 101, 55, 44, 75, 35, 53, 34, 28, 56, 29, 30, 43, 43, 74, 54, 49, 42, 61, 73, 30, 98, 38, 30, 55, 69, 35, 36, 50, 49, 41, 59, 42, 36, 45, 75, 115, 76, 27, 81, 54, 112, 86, 44, 36, 80, 32, 52, 46, 94, 42, 59, 62, 74, 33, 62, 57, 98, 47, 35, 70, 80, 32, 48, 45, 47, 42, 54, 30, 55, 59, 58, 43, 96, 31, 46, 42, 38, 51, 49, 38, 47, 34, 44, 31, 33, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2924812054506518, "mean_inference_ms": 2.4159451084025965, "mean_action_processing_ms": 0.48943217699885266, "mean_env_wait_ms": 0.11553545270364868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017232656478881836, "StateBufferConnector_ms": 0.015591621398925781, "ViewRequirementAgentConnector_ms": 0.3739640712738037}}, "episode_reward_max": 65.81666666666668, "episode_reward_min": 13.234666666666662, "episode_reward_mean": 26.201866666666664, "episode_len_mean": 53.61, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.626999999999997, 21.34466666666666, 17.057999999999996, 65.81666666666668, 41.62933333333334, 17.276666666666664, 27.08199999999999, 28.597666666666665, 26.873666666666672, 17.903333333333325, 49.804000000000016, 18.967999999999996, 20.18366666666666, 28.969999999999995, 43.212666666666664, 23.372333333333327, 22.073666666666668, 30.93000000000001, 17.789999999999996, 24.321000000000005, 16.17033333333333, 14.273000000000001, 32.65233333333333, 13.234666666666662, 15.086666666666659, 18.376, 19.287999999999993, 45.64300000000001, 22.726333333333333, 24.094999999999985, 23.27766666666667, 26.10033333333333, 37.688666666666656, 15.584999999999994, 55.15366666666667, 18.22699999999999, 14.124333333333325, 29.76533333333335, 37.283333333333324, 18.769999999999996, 18.760999999999992, 20.775000000000002, 24.020666666666667, 18.918333333333326, 25.36233333333333, 18.083666666666666, 17.459666666666664, 20.47899999999999, 36.99666666666666, 47.24633333333335, 42.856333333333346, 14.61933333333333, 45.050000000000004, 29.576333333333338, 54.076333333333366, 43.68633333333333, 19.035666666666653, 18.933, 37.80566666666668, 15.43699999999999, 25.058333333333337, 22.883666666666667, 35.06400000000001, 21.678333333333335, 27.39466666666667, 21.583666666666655, 42.30366666666666, 17.90033333333333, 33.61333333333333, 34.87700000000001, 45.32533333333329, 21.744333333333334, 17.726, 32.78433333333334, 37.378666666666675, 14.817, 19.623, 23.407333333333327, 18.693333333333324, 22.957666666666658, 27.448333333333327, 14.473666666666663, 31.562000000000012, 34.63433333333334, 22.74366666666667, 23.688666666666663, 44.82400000000003, 16.96933333333333, 20.154333333333327, 23.174999999999997, 21.769, 23.097333333333317, 24.04233333333334, 20.53033333333333, 21.172666666666668, 20.40233333333333, 21.14633333333333, 16.272666666666662, 15.573999999999993, 15.158666666666667], "episode_lengths": [29, 45, 33, 125, 87, 35, 70, 71, 53, 37, 111, 33, 42, 47, 101, 55, 44, 75, 35, 53, 34, 28, 56, 29, 30, 43, 43, 74, 54, 49, 42, 61, 73, 30, 98, 38, 30, 55, 69, 35, 36, 50, 49, 41, 59, 42, 36, 45, 75, 115, 76, 27, 81, 54, 112, 86, 44, 36, 80, 32, 52, 46, 94, 42, 59, 62, 74, 33, 62, 57, 98, 47, 35, 70, 80, 32, 48, 45, 47, 42, 54, 30, 55, 59, 58, 43, 96, 31, 46, 42, 38, 51, 49, 38, 47, 34, 44, 31, 33, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2924812054506518, "mean_inference_ms": 2.4159451084025965, "mean_action_processing_ms": 0.48943217699885266, "mean_env_wait_ms": 0.11553545270364868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017232656478881836, "StateBufferConnector_ms": 0.015591621398925781, "ViewRequirementAgentConnector_ms": 0.3739640712738037}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.9523708850238, "num_env_steps_trained_throughput_per_sec": 711.9523708850238, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 6456.127, "sample_time_ms": 2602.886, "load_time_ms": 0.628, "load_throughput": 6368031.58, "learn_time_ms": 3831.811, "learn_throughput": 1043.893, "synch_weights_time_ms": 18.972}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 1848, "training_iteration": 17, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-53", "timestamp": 1701995273, "time_this_iter_s": 5.635365962982178, "time_total_s": 107.94563937187195, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 107.94563937187195, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 74.53750000000001, "ram_util_percent": 93.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0013183593982830644, "cur_lr": 4.999999873689376e-05, "total_loss": 6.464062690734863, "policy_loss": -0.008044573478400707, "vf_loss": 6.472105979919434, "vf_explained_var": 0.561327338218689, "kl": 0.0012033693492412567, "entropy": 0.24193266034126282, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 60.68533333333333, "episode_reward_min": 14.473666666666663, "episode_reward_mean": 28.83215, "episode_len_mean": 56.94, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30366666666666, 17.90033333333333, 33.61333333333333, 34.87700000000001, 45.32533333333329, 21.744333333333334, 17.726, 32.78433333333334, 37.378666666666675, 14.817, 19.623, 23.407333333333327, 18.693333333333324, 22.957666666666658, 27.448333333333327, 14.473666666666663, 31.562000000000012, 34.63433333333334, 22.74366666666667, 23.688666666666663, 44.82400000000003, 16.96933333333333, 20.154333333333327, 23.174999999999997, 21.769, 23.097333333333317, 24.04233333333334, 20.53033333333333, 21.172666666666668, 20.40233333333333, 21.14633333333333, 16.272666666666662, 15.573999999999993, 15.158666666666667, 23.358333333333327, 43.13266666666667, 27.790333333333326, 35.657, 15.985999999999997, 25.673999999999996, 23.84266666666667, 22.477666666666668, 48.206333333333355, 19.710999999999995, 36.601666666666645, 30.889000000000006, 60.68533333333333, 45.32666666666666, 33.39266666666665, 29.634000000000004, 47.60300000000002, 16.981333333333325, 59.731, 17.169666666666668, 28.772666666666662, 18.929, 18.504666666666658, 43.51833333333334, 31.93399999999999, 16.542333333333332, 42.447666666666656, 17.200999999999997, 23.62999999999999, 25.98533333333333, 28.936999999999998, 26.461, 54.27800000000002, 32.99166666666666, 49.16366666666665, 18.904999999999998, 30.022000000000002, 25.754666666666665, 21.196999999999992, 39.09966666666667, 19.521333333333327, 18.08766666666666, 51.282666666666664, 31.793666666666674, 16.866333333333326, 20.811666666666664, 26.708666666666662, 16.322999999999997, 33.28366666666669, 25.149000000000004, 17.21133333333332, 15.515333333333333, 30.328666666666663, 23.97366666666667, 35.01099999999999, 46.61666666666667, 20.194999999999993, 48.295333333333325, 28.777333333333324, 17.882666666666662, 45.63133333333333, 29.22599999999999, 32.815999999999995, 58.998666666666665, 26.549333333333326, 46.24366666666666], "episode_lengths": [74, 33, 62, 57, 98, 47, 35, 70, 80, 32, 48, 45, 47, 42, 54, 30, 55, 59, 58, 43, 96, 31, 46, 42, 38, 51, 49, 38, 47, 34, 44, 31, 33, 29, 52, 81, 50, 60, 31, 68, 51, 51, 87, 36, 72, 69, 115, 74, 67, 55, 94, 58, 97, 32, 68, 38, 39, 72, 68, 33, 91, 36, 51, 45, 50, 47, 94, 53, 104, 47, 51, 47, 40, 74, 43, 36, 87, 70, 34, 40, 70, 37, 50, 48, 39, 31, 68, 59, 76, 79, 42, 73, 62, 35, 86, 55, 69, 110, 72, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2831257872060242, "mean_inference_ms": 2.396231969864849, "mean_action_processing_ms": 0.4874258811529454, "mean_env_wait_ms": 0.11497070639746265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019527673721313477, "StateBufferConnector_ms": 0.010320425033569336, "ViewRequirementAgentConnector_ms": 0.3268582820892334}}, "episode_reward_max": 60.68533333333333, "episode_reward_min": 14.473666666666663, "episode_reward_mean": 28.83215, "episode_len_mean": 56.94, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30366666666666, 17.90033333333333, 33.61333333333333, 34.87700000000001, 45.32533333333329, 21.744333333333334, 17.726, 32.78433333333334, 37.378666666666675, 14.817, 19.623, 23.407333333333327, 18.693333333333324, 22.957666666666658, 27.448333333333327, 14.473666666666663, 31.562000000000012, 34.63433333333334, 22.74366666666667, 23.688666666666663, 44.82400000000003, 16.96933333333333, 20.154333333333327, 23.174999999999997, 21.769, 23.097333333333317, 24.04233333333334, 20.53033333333333, 21.172666666666668, 20.40233333333333, 21.14633333333333, 16.272666666666662, 15.573999999999993, 15.158666666666667, 23.358333333333327, 43.13266666666667, 27.790333333333326, 35.657, 15.985999999999997, 25.673999999999996, 23.84266666666667, 22.477666666666668, 48.206333333333355, 19.710999999999995, 36.601666666666645, 30.889000000000006, 60.68533333333333, 45.32666666666666, 33.39266666666665, 29.634000000000004, 47.60300000000002, 16.981333333333325, 59.731, 17.169666666666668, 28.772666666666662, 18.929, 18.504666666666658, 43.51833333333334, 31.93399999999999, 16.542333333333332, 42.447666666666656, 17.200999999999997, 23.62999999999999, 25.98533333333333, 28.936999999999998, 26.461, 54.27800000000002, 32.99166666666666, 49.16366666666665, 18.904999999999998, 30.022000000000002, 25.754666666666665, 21.196999999999992, 39.09966666666667, 19.521333333333327, 18.08766666666666, 51.282666666666664, 31.793666666666674, 16.866333333333326, 20.811666666666664, 26.708666666666662, 16.322999999999997, 33.28366666666669, 25.149000000000004, 17.21133333333332, 15.515333333333333, 30.328666666666663, 23.97366666666667, 35.01099999999999, 46.61666666666667, 20.194999999999993, 48.295333333333325, 28.777333333333324, 17.882666666666662, 45.63133333333333, 29.22599999999999, 32.815999999999995, 58.998666666666665, 26.549333333333326, 46.24366666666666], "episode_lengths": [74, 33, 62, 57, 98, 47, 35, 70, 80, 32, 48, 45, 47, 42, 54, 30, 55, 59, 58, 43, 96, 31, 46, 42, 38, 51, 49, 38, 47, 34, 44, 31, 33, 29, 52, 81, 50, 60, 31, 68, 51, 51, 87, 36, 72, 69, 115, 74, 67, 55, 94, 58, 97, 32, 68, 38, 39, 72, 68, 33, 91, 36, 51, 45, 50, 47, 94, 53, 104, 47, 51, 47, 40, 74, 43, 36, 87, 70, 34, 40, 70, 37, 50, 48, 39, 31, 68, 59, 76, 79, 42, 73, 62, 35, 86, 55, 69, 110, 72, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2831257872060242, "mean_inference_ms": 2.396231969864849, "mean_action_processing_ms": 0.4874258811529454, "mean_env_wait_ms": 0.11497070639746265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019527673721313477, "StateBufferConnector_ms": 0.010320425033569336, "ViewRequirementAgentConnector_ms": 0.3268582820892334}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 719.6828031483755, "num_env_steps_trained_throughput_per_sec": 719.6828031483755, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 6352.044, "sample_time_ms": 2546.662, "load_time_ms": 0.622, "load_throughput": 6431748.514, "learn_time_ms": 3782.797, "learn_throughput": 1057.419, "synch_weights_time_ms": 20.172}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 1914, "training_iteration": 18, "trial_id": "432ea_00000", "date": "2023-12-07_16-27-58", "timestamp": 1701995278, "time_this_iter_s": 5.586939573287964, "time_total_s": 113.53257894515991, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 113.53257894515991, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 73.94285714285715, "ram_util_percent": 92.08571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0006591796991415322, "cur_lr": 4.999999873689376e-05, "total_loss": 5.977451801300049, "policy_loss": -0.005063595250248909, "vf_loss": 5.982514381408691, "vf_explained_var": 0.6486229300498962, "kl": 0.0009368967148475349, "entropy": 0.2231803983449936, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 58.998666666666665, "episode_reward_min": 12.775333333333329, "episode_reward_mean": 27.443506666666668, "episode_len_mean": 54.57, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.793666666666674, 16.866333333333326, 20.811666666666664, 26.708666666666662, 16.322999999999997, 33.28366666666669, 25.149000000000004, 17.21133333333332, 15.515333333333333, 30.328666666666663, 23.97366666666667, 35.01099999999999, 46.61666666666667, 20.194999999999993, 48.295333333333325, 28.777333333333324, 17.882666666666662, 45.63133333333333, 29.22599999999999, 32.815999999999995, 58.998666666666665, 26.549333333333326, 46.24366666666666, 19.778666666666666, 40.32533333333336, 20.725999999999996, 26.355333333333334, 17.791000000000004, 36.86033333333334, 15.206999999999994, 35.24733333333333, 23.164333333333335, 16.140666666666668, 21.673, 21.51066666666667, 50.361666666666686, 14.871999999999998, 17.695666666666664, 27.08766666666666, 33.58799999999998, 42.79366666666669, 28.80099999999999, 35.800666666666665, 39.69533333333336, 24.065333333333328, 20.686, 36.62466666666665, 22.202333333333325, 24.730666666666664, 16.56999999999999, 44.76299999999997, 45.21766666666665, 25.052333333333323, 30.220666666666656, 26.333333333333325, 12.775333333333329, 30.858666666666657, 26.205333333333325, 39.698333333333345, 28.472333333333324, 46.42333333333334, 20.145999999999994, 15.141666666666662, 22.348666666666663, 40.83433333333335, 26.328666666666656, 20.624666666666663, 16.641999999999996, 30.857000000000017, 27.969999999999995, 28.055999999999983, 20.064666666666664, 21.350333333333335, 17.21966666666666, 16.30166666666666, 26.86633333333335, 18.34966666666666, 19.350333333333328, 38.210666666666675, 22.991000000000003, 36.37366666666667, 26.12800000000001, 16.093999999999998, 23.765333333333324, 32.49966666666668, 23.36233333333332, 17.784999999999997, 31.493666666666666, 17.83633333333333, 17.85333333333332, 33.566666666666656, 15.737666666666664, 45.419000000000004, 14.941000000000003, 25.81533333333333, 17.07633333333333, 37.62900000000001, 30.45533333333333, 30.84666666666668, 19.43633333333333], "episode_lengths": [70, 34, 40, 70, 37, 50, 48, 39, 31, 68, 59, 76, 79, 42, 73, 62, 35, 86, 55, 69, 110, 72, 97, 45, 74, 43, 45, 42, 82, 32, 73, 43, 33, 44, 43, 95, 29, 36, 62, 55, 68, 50, 62, 60, 55, 38, 94, 42, 44, 31, 84, 86, 63, 55, 46, 27, 75, 55, 73, 50, 102, 41, 30, 39, 86, 50, 41, 33, 60, 47, 59, 49, 44, 41, 32, 55, 40, 40, 73, 46, 70, 52, 33, 57, 58, 50, 32, 65, 34, 35, 57, 32, 88, 35, 56, 35, 68, 66, 47, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2851408539875115, "mean_inference_ms": 2.4066614040488967, "mean_action_processing_ms": 0.48849496423817407, "mean_env_wait_ms": 0.11664302599711295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01665639877319336, "StateBufferConnector_ms": 0.010642766952514648, "ViewRequirementAgentConnector_ms": 0.48343801498413086}}, "episode_reward_max": 58.998666666666665, "episode_reward_min": 12.775333333333329, "episode_reward_mean": 27.443506666666668, "episode_len_mean": 54.57, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.793666666666674, 16.866333333333326, 20.811666666666664, 26.708666666666662, 16.322999999999997, 33.28366666666669, 25.149000000000004, 17.21133333333332, 15.515333333333333, 30.328666666666663, 23.97366666666667, 35.01099999999999, 46.61666666666667, 20.194999999999993, 48.295333333333325, 28.777333333333324, 17.882666666666662, 45.63133333333333, 29.22599999999999, 32.815999999999995, 58.998666666666665, 26.549333333333326, 46.24366666666666, 19.778666666666666, 40.32533333333336, 20.725999999999996, 26.355333333333334, 17.791000000000004, 36.86033333333334, 15.206999999999994, 35.24733333333333, 23.164333333333335, 16.140666666666668, 21.673, 21.51066666666667, 50.361666666666686, 14.871999999999998, 17.695666666666664, 27.08766666666666, 33.58799999999998, 42.79366666666669, 28.80099999999999, 35.800666666666665, 39.69533333333336, 24.065333333333328, 20.686, 36.62466666666665, 22.202333333333325, 24.730666666666664, 16.56999999999999, 44.76299999999997, 45.21766666666665, 25.052333333333323, 30.220666666666656, 26.333333333333325, 12.775333333333329, 30.858666666666657, 26.205333333333325, 39.698333333333345, 28.472333333333324, 46.42333333333334, 20.145999999999994, 15.141666666666662, 22.348666666666663, 40.83433333333335, 26.328666666666656, 20.624666666666663, 16.641999999999996, 30.857000000000017, 27.969999999999995, 28.055999999999983, 20.064666666666664, 21.350333333333335, 17.21966666666666, 16.30166666666666, 26.86633333333335, 18.34966666666666, 19.350333333333328, 38.210666666666675, 22.991000000000003, 36.37366666666667, 26.12800000000001, 16.093999999999998, 23.765333333333324, 32.49966666666668, 23.36233333333332, 17.784999999999997, 31.493666666666666, 17.83633333333333, 17.85333333333332, 33.566666666666656, 15.737666666666664, 45.419000000000004, 14.941000000000003, 25.81533333333333, 17.07633333333333, 37.62900000000001, 30.45533333333333, 30.84666666666668, 19.43633333333333], "episode_lengths": [70, 34, 40, 70, 37, 50, 48, 39, 31, 68, 59, 76, 79, 42, 73, 62, 35, 86, 55, 69, 110, 72, 97, 45, 74, 43, 45, 42, 82, 32, 73, 43, 33, 44, 43, 95, 29, 36, 62, 55, 68, 50, 62, 60, 55, 38, 94, 42, 44, 31, 84, 86, 63, 55, 46, 27, 75, 55, 73, 50, 102, 41, 30, 39, 86, 50, 41, 33, 60, 47, 59, 49, 44, 41, 32, 55, 40, 40, 73, 46, 70, 52, 33, 57, 58, 50, 32, 65, 34, 35, 57, 32, 88, 35, 56, 35, 68, 66, 47, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2851408539875115, "mean_inference_ms": 2.4066614040488967, "mean_action_processing_ms": 0.48849496423817407, "mean_env_wait_ms": 0.11664302599711295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01665639877319336, "StateBufferConnector_ms": 0.010642766952514648, "ViewRequirementAgentConnector_ms": 0.48343801498413086}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 638.4562959516029, "num_env_steps_trained_throughput_per_sec": 638.4562959516029, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 6403.772, "sample_time_ms": 2618.082, "load_time_ms": 0.569, "load_throughput": 7027400.519, "learn_time_ms": 3763.296, "learn_throughput": 1062.898, "synch_weights_time_ms": 20.148}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1991, "training_iteration": 19, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-05", "timestamp": 1701995285, "time_this_iter_s": 6.276120662689209, "time_total_s": 119.80869960784912, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 119.80869960784912, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 74.32222222222222, "ram_util_percent": 93.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003295898495707661, "cur_lr": 4.999999873689376e-05, "total_loss": 6.201380252838135, "policy_loss": 0.0028451683465391397, "vf_loss": 6.1985344886779785, "vf_explained_var": 0.5346276164054871, "kl": 0.0020514167845249176, "entropy": 0.2056829035282135, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 73.88133333333339, "episode_reward_min": 14.19833333333333, "episode_reward_mean": 27.86425, "episode_len_mean": 55.37, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.969999999999995, 28.055999999999983, 20.064666666666664, 21.350333333333335, 17.21966666666666, 16.30166666666666, 26.86633333333335, 18.34966666666666, 19.350333333333328, 38.210666666666675, 22.991000000000003, 36.37366666666667, 26.12800000000001, 16.093999999999998, 23.765333333333324, 32.49966666666668, 23.36233333333332, 17.784999999999997, 31.493666666666666, 17.83633333333333, 17.85333333333332, 33.566666666666656, 15.737666666666664, 45.419000000000004, 14.941000000000003, 25.81533333333333, 17.07633333333333, 37.62900000000001, 30.45533333333333, 30.84666666666668, 19.43633333333333, 22.64666666666665, 19.766666666666662, 36.31366666666668, 19.811333333333327, 40.943666666666644, 73.88133333333339, 19.207666666666665, 30.39366666666666, 22.423333333333325, 21.57666666666667, 45.99533333333333, 18.60733333333333, 15.983666666666663, 38.099666666666664, 16.764999999999993, 24.38799999999998, 34.16799999999999, 54.91200000000005, 34.194333333333326, 21.036999999999992, 43.47166666666667, 21.95633333333333, 35.625666666666675, 18.624000000000002, 45.55033333333334, 18.055666666666664, 20.121333333333325, 17.180666666666664, 31.21966666666666, 23.284, 53.09966666666669, 19.915999999999997, 29.373333333333335, 33.952333333333335, 17.071999999999992, 23.12566666666666, 22.528666666666666, 49.71633333333333, 28.236333333333324, 27.535333333333327, 16.80933333333333, 19.951666666666657, 21.373666666666665, 34.59499999999999, 22.226999999999993, 40.76799999999999, 17.96433333333333, 18.494333333333334, 28.719999999999988, 38.105666666666664, 20.875333333333334, 18.76233333333333, 14.19833333333333, 29.640000000000004, 14.742333333333328, 27.03666666666666, 17.179, 21.903666666666666, 42.99033333333334, 24.655333333333317, 22.854333333333322, 59.973666666666695, 14.308333333333328, 53.04233333333336, 20.33899999999999, 46.15833333333334, 62.913333333333306, 16.53066666666667, 37.70766666666665], "episode_lengths": [47, 59, 49, 44, 41, 32, 55, 40, 40, 73, 46, 70, 52, 33, 57, 58, 50, 32, 65, 34, 35, 57, 32, 88, 35, 56, 35, 68, 66, 47, 43, 57, 39, 62, 39, 88, 126, 42, 48, 49, 43, 90, 43, 34, 73, 32, 43, 74, 102, 78, 50, 81, 44, 62, 39, 94, 36, 39, 33, 59, 43, 84, 37, 65, 64, 41, 48, 53, 82, 69, 62, 31, 43, 44, 64, 42, 85, 50, 36, 57, 79, 53, 38, 32, 57, 28, 65, 34, 50, 66, 59, 46, 109, 30, 91, 44, 87, 116, 43, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2767680499015188, "mean_inference_ms": 2.3950656721485912, "mean_action_processing_ms": 0.48720743597931915, "mean_env_wait_ms": 0.11610412970951231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019535541534423828, "StateBufferConnector_ms": 0.010306835174560547, "ViewRequirementAgentConnector_ms": 0.40697264671325684}}, "episode_reward_max": 73.88133333333339, "episode_reward_min": 14.19833333333333, "episode_reward_mean": 27.86425, "episode_len_mean": 55.37, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.969999999999995, 28.055999999999983, 20.064666666666664, 21.350333333333335, 17.21966666666666, 16.30166666666666, 26.86633333333335, 18.34966666666666, 19.350333333333328, 38.210666666666675, 22.991000000000003, 36.37366666666667, 26.12800000000001, 16.093999999999998, 23.765333333333324, 32.49966666666668, 23.36233333333332, 17.784999999999997, 31.493666666666666, 17.83633333333333, 17.85333333333332, 33.566666666666656, 15.737666666666664, 45.419000000000004, 14.941000000000003, 25.81533333333333, 17.07633333333333, 37.62900000000001, 30.45533333333333, 30.84666666666668, 19.43633333333333, 22.64666666666665, 19.766666666666662, 36.31366666666668, 19.811333333333327, 40.943666666666644, 73.88133333333339, 19.207666666666665, 30.39366666666666, 22.423333333333325, 21.57666666666667, 45.99533333333333, 18.60733333333333, 15.983666666666663, 38.099666666666664, 16.764999999999993, 24.38799999999998, 34.16799999999999, 54.91200000000005, 34.194333333333326, 21.036999999999992, 43.47166666666667, 21.95633333333333, 35.625666666666675, 18.624000000000002, 45.55033333333334, 18.055666666666664, 20.121333333333325, 17.180666666666664, 31.21966666666666, 23.284, 53.09966666666669, 19.915999999999997, 29.373333333333335, 33.952333333333335, 17.071999999999992, 23.12566666666666, 22.528666666666666, 49.71633333333333, 28.236333333333324, 27.535333333333327, 16.80933333333333, 19.951666666666657, 21.373666666666665, 34.59499999999999, 22.226999999999993, 40.76799999999999, 17.96433333333333, 18.494333333333334, 28.719999999999988, 38.105666666666664, 20.875333333333334, 18.76233333333333, 14.19833333333333, 29.640000000000004, 14.742333333333328, 27.03666666666666, 17.179, 21.903666666666666, 42.99033333333334, 24.655333333333317, 22.854333333333322, 59.973666666666695, 14.308333333333328, 53.04233333333336, 20.33899999999999, 46.15833333333334, 62.913333333333306, 16.53066666666667, 37.70766666666665], "episode_lengths": [47, 59, 49, 44, 41, 32, 55, 40, 40, 73, 46, 70, 52, 33, 57, 58, 50, 32, 65, 34, 35, 57, 32, 88, 35, 56, 35, 68, 66, 47, 43, 57, 39, 62, 39, 88, 126, 42, 48, 49, 43, 90, 43, 34, 73, 32, 43, 74, 102, 78, 50, 81, 44, 62, 39, 94, 36, 39, 33, 59, 43, 84, 37, 65, 64, 41, 48, 53, 82, 69, 62, 31, 43, 44, 64, 42, 85, 50, 36, 57, 79, 53, 38, 32, 57, 28, 65, 34, 50, 66, 59, 46, 109, 30, 91, 44, 87, 116, 43, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2767680499015188, "mean_inference_ms": 2.3950656721485912, "mean_action_processing_ms": 0.48720743597931915, "mean_env_wait_ms": 0.11610412970951231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019535541534423828, "StateBufferConnector_ms": 0.010306835174560547, "ViewRequirementAgentConnector_ms": 0.40697264671325684}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 771.9144718550227, "num_env_steps_trained_throughput_per_sec": 771.9144718550227, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 6256.135, "sample_time_ms": 2555.559, "load_time_ms": 0.669, "load_throughput": 5976494.728, "learn_time_ms": 3677.927, "learn_throughput": 1087.569, "synch_weights_time_ms": 20.247}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 2060, "training_iteration": 20, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-10", "timestamp": 1701995290, "time_this_iter_s": 5.196901559829712, "time_total_s": 125.00560116767883, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 125.00560116767883, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 71.0142857142857, "ram_util_percent": 92.55714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00016479492478538305, "cur_lr": 4.999999873689376e-05, "total_loss": 6.011963367462158, "policy_loss": -0.007080016657710075, "vf_loss": 6.01904296875, "vf_explained_var": 0.5670362710952759, "kl": 0.0027156975120306015, "entropy": 0.17573244869709015, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 70.51766666666671, "episode_reward_min": 13.779666666666662, "episode_reward_mean": 28.747530000000005, "episode_len_mean": 57.36, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.535333333333327, 16.80933333333333, 19.951666666666657, 21.373666666666665, 34.59499999999999, 22.226999999999993, 40.76799999999999, 17.96433333333333, 18.494333333333334, 28.719999999999988, 38.105666666666664, 20.875333333333334, 18.76233333333333, 14.19833333333333, 29.640000000000004, 14.742333333333328, 27.03666666666666, 17.179, 21.903666666666666, 42.99033333333334, 24.655333333333317, 22.854333333333322, 59.973666666666695, 14.308333333333328, 53.04233333333336, 20.33899999999999, 46.15833333333334, 62.913333333333306, 16.53066666666667, 37.70766666666665, 21.61733333333332, 37.86033333333333, 31.931666666666676, 36.742, 21.166999999999994, 21.94866666666666, 17.220333333333325, 15.232999999999992, 25.115999999999996, 23.375666666666653, 21.186999999999994, 70.51766666666671, 19.040666666666663, 45.673333333333346, 17.548666666666662, 17.15366666666666, 47.380666666666635, 19.654333333333334, 26.258333333333336, 36.98566666666667, 15.597, 15.794666666666663, 24.75166666666666, 20.49166666666667, 60.03733333333332, 29.62833333333331, 19.440999999999992, 23.16166666666666, 54.158666666666676, 13.779666666666662, 26.467666666666652, 33.552, 36.591666666666654, 24.668666666666653, 54.52466666666665, 54.63566666666671, 14.823666666666666, 22.02333333333333, 49.21333333333334, 29.25466666666667, 20.96966666666667, 21.179666666666655, 16.123666666666665, 22.594333333333328, 20.56733333333333, 52.25133333333335, 21.118999999999996, 20.810999999999996, 28.346999999999987, 25.37766666666667, 37.59433333333331, 22.119333333333326, 18.05033333333333, 26.263333333333332, 31.637666666666657, 22.563999999999997, 48.23800000000001, 23.72566666666666, 20.820999999999984, 32.050999999999995, 25.285333333333323, 40.70433333333333, 19.44033333333333, 31.897666666666673, 33.079333333333345, 24.252333333333336, 25.84633333333333, 32.17966666666668, 37.298, 23.799999999999994], "episode_lengths": [62, 31, 43, 44, 64, 42, 85, 50, 36, 57, 79, 53, 38, 32, 57, 28, 65, 34, 50, 66, 59, 46, 109, 30, 91, 44, 87, 116, 43, 72, 49, 80, 60, 61, 54, 43, 44, 36, 60, 44, 42, 125, 36, 82, 37, 36, 73, 55, 58, 68, 30, 31, 52, 50, 101, 55, 37, 42, 101, 29, 55, 65, 75, 53, 107, 94, 29, 45, 91, 61, 44, 44, 33, 48, 39, 94, 50, 40, 55, 56, 64, 41, 38, 59, 61, 53, 94, 50, 45, 71, 55, 85, 40, 66, 78, 55, 59, 54, 59, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2652322985688484, "mean_inference_ms": 2.371468211832325, "mean_action_processing_ms": 0.4842495939365395, "mean_env_wait_ms": 0.1157406941288344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020092248916625977, "StateBufferConnector_ms": 0.014504671096801758, "ViewRequirementAgentConnector_ms": 0.3731675148010254}}, "episode_reward_max": 70.51766666666671, "episode_reward_min": 13.779666666666662, "episode_reward_mean": 28.747530000000005, "episode_len_mean": 57.36, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.535333333333327, 16.80933333333333, 19.951666666666657, 21.373666666666665, 34.59499999999999, 22.226999999999993, 40.76799999999999, 17.96433333333333, 18.494333333333334, 28.719999999999988, 38.105666666666664, 20.875333333333334, 18.76233333333333, 14.19833333333333, 29.640000000000004, 14.742333333333328, 27.03666666666666, 17.179, 21.903666666666666, 42.99033333333334, 24.655333333333317, 22.854333333333322, 59.973666666666695, 14.308333333333328, 53.04233333333336, 20.33899999999999, 46.15833333333334, 62.913333333333306, 16.53066666666667, 37.70766666666665, 21.61733333333332, 37.86033333333333, 31.931666666666676, 36.742, 21.166999999999994, 21.94866666666666, 17.220333333333325, 15.232999999999992, 25.115999999999996, 23.375666666666653, 21.186999999999994, 70.51766666666671, 19.040666666666663, 45.673333333333346, 17.548666666666662, 17.15366666666666, 47.380666666666635, 19.654333333333334, 26.258333333333336, 36.98566666666667, 15.597, 15.794666666666663, 24.75166666666666, 20.49166666666667, 60.03733333333332, 29.62833333333331, 19.440999999999992, 23.16166666666666, 54.158666666666676, 13.779666666666662, 26.467666666666652, 33.552, 36.591666666666654, 24.668666666666653, 54.52466666666665, 54.63566666666671, 14.823666666666666, 22.02333333333333, 49.21333333333334, 29.25466666666667, 20.96966666666667, 21.179666666666655, 16.123666666666665, 22.594333333333328, 20.56733333333333, 52.25133333333335, 21.118999999999996, 20.810999999999996, 28.346999999999987, 25.37766666666667, 37.59433333333331, 22.119333333333326, 18.05033333333333, 26.263333333333332, 31.637666666666657, 22.563999999999997, 48.23800000000001, 23.72566666666666, 20.820999999999984, 32.050999999999995, 25.285333333333323, 40.70433333333333, 19.44033333333333, 31.897666666666673, 33.079333333333345, 24.252333333333336, 25.84633333333333, 32.17966666666668, 37.298, 23.799999999999994], "episode_lengths": [62, 31, 43, 44, 64, 42, 85, 50, 36, 57, 79, 53, 38, 32, 57, 28, 65, 34, 50, 66, 59, 46, 109, 30, 91, 44, 87, 116, 43, 72, 49, 80, 60, 61, 54, 43, 44, 36, 60, 44, 42, 125, 36, 82, 37, 36, 73, 55, 58, 68, 30, 31, 52, 50, 101, 55, 37, 42, 101, 29, 55, 65, 75, 53, 107, 94, 29, 45, 91, 61, 44, 44, 33, 48, 39, 94, 50, 40, 55, 56, 64, 41, 38, 59, 61, 53, 94, 50, 45, 71, 55, 85, 40, 66, 78, 55, 59, 54, 59, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2652322985688484, "mean_inference_ms": 2.371468211832325, "mean_action_processing_ms": 0.4842495939365395, "mean_env_wait_ms": 0.1157406941288344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020092248916625977, "StateBufferConnector_ms": 0.014504671096801758, "ViewRequirementAgentConnector_ms": 0.3731675148010254}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.6948451153112, "num_env_steps_trained_throughput_per_sec": 692.6948451153112, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 6252.482, "sample_time_ms": 2545.02, "load_time_ms": 0.779, "load_throughput": 5133001.683, "learn_time_ms": 3684.802, "learn_throughput": 1085.54, "synch_weights_time_ms": 20.048}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 2130, "training_iteration": 21, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-16", "timestamp": 1701995296, "time_this_iter_s": 5.7845659255981445, "time_total_s": 130.79016709327698, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 130.79016709327698, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 71.7875, "ram_util_percent": 92.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.239746239269152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5.588662624359131, "policy_loss": 0.0015857279067859054, "vf_loss": 5.587076187133789, "vf_explained_var": 0.7271228432655334, "kl": 0.0014469154411926866, "entropy": 0.19591881334781647, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 58.1453333333334, "episode_reward_min": 13.162666666666667, "episode_reward_mean": 27.05315333333333, "episode_len_mean": 56.23, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.96966666666667, 21.179666666666655, 16.123666666666665, 22.594333333333328, 20.56733333333333, 52.25133333333335, 21.118999999999996, 20.810999999999996, 28.346999999999987, 25.37766666666667, 37.59433333333331, 22.119333333333326, 18.05033333333333, 26.263333333333332, 31.637666666666657, 22.563999999999997, 48.23800000000001, 23.72566666666666, 20.820999999999984, 32.050999999999995, 25.285333333333323, 40.70433333333333, 19.44033333333333, 31.897666666666673, 33.079333333333345, 24.252333333333336, 25.84633333333333, 32.17966666666668, 37.298, 23.799999999999994, 18.248999999999995, 30.17400000000001, 20.513999999999996, 24.18566666666666, 23.268666666666668, 34.07433333333334, 16.706333333333326, 23.244333333333334, 24.10199999999999, 22.553999999999995, 22.182999999999993, 21.457333333333327, 26.97033333333332, 21.02433333333333, 23.169999999999995, 17.235, 21.958666666666655, 54.23566666666669, 29.323999999999984, 27.18233333333333, 26.960666666666654, 29.12033333333333, 22.17733333333334, 33.22266666666667, 33.97566666666665, 25.228999999999992, 15.437666666666663, 35.205333333333336, 33.412, 17.011999999999997, 15.748666666666654, 20.56266666666666, 16.48566666666666, 30.93766666666667, 16.298333333333325, 31.47833333333334, 27.876666666666644, 58.1453333333334, 29.298, 42.56100000000001, 51.11500000000001, 25.269666666666676, 34.966, 18.200999999999997, 40.63433333333334, 20.91733333333333, 45.59700000000001, 26.66733333333331, 27.486999999999995, 17.452999999999996, 22.649666666666675, 21.29233333333333, 25.921, 24.14033333333333, 18.441, 17.08733333333333, 13.162666666666667, 34.37766666666666, 21.17299999999999, 33.98433333333332, 23.76366666666665, 16.499666666666663, 24.175666666666675, 35.43466666666667, 36.000666666666675, 19.20233333333333, 27.355000000000004, 29.813333333333325, 19.57066666666666, 43.816], "episode_lengths": [44, 44, 33, 48, 39, 94, 50, 40, 55, 56, 64, 41, 38, 59, 61, 53, 94, 50, 45, 71, 55, 85, 40, 66, 78, 55, 59, 54, 59, 47, 40, 67, 45, 47, 45, 66, 34, 49, 57, 47, 44, 41, 59, 41, 45, 32, 43, 102, 68, 66, 64, 46, 39, 73, 80, 52, 35, 75, 55, 35, 35, 45, 37, 65, 32, 54, 63, 113, 49, 94, 96, 61, 81, 36, 76, 41, 92, 71, 46, 36, 54, 52, 66, 50, 36, 35, 27, 78, 44, 78, 58, 32, 49, 61, 83, 54, 70, 73, 39, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2558521779645033, "mean_inference_ms": 2.3537362413438574, "mean_action_processing_ms": 0.48229453614830864, "mean_env_wait_ms": 0.11577147830844642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021372556686401367, "StateBufferConnector_ms": 0.010546445846557617, "ViewRequirementAgentConnector_ms": 0.3749570846557617}}, "episode_reward_max": 58.1453333333334, "episode_reward_min": 13.162666666666667, "episode_reward_mean": 27.05315333333333, "episode_len_mean": 56.23, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.96966666666667, 21.179666666666655, 16.123666666666665, 22.594333333333328, 20.56733333333333, 52.25133333333335, 21.118999999999996, 20.810999999999996, 28.346999999999987, 25.37766666666667, 37.59433333333331, 22.119333333333326, 18.05033333333333, 26.263333333333332, 31.637666666666657, 22.563999999999997, 48.23800000000001, 23.72566666666666, 20.820999999999984, 32.050999999999995, 25.285333333333323, 40.70433333333333, 19.44033333333333, 31.897666666666673, 33.079333333333345, 24.252333333333336, 25.84633333333333, 32.17966666666668, 37.298, 23.799999999999994, 18.248999999999995, 30.17400000000001, 20.513999999999996, 24.18566666666666, 23.268666666666668, 34.07433333333334, 16.706333333333326, 23.244333333333334, 24.10199999999999, 22.553999999999995, 22.182999999999993, 21.457333333333327, 26.97033333333332, 21.02433333333333, 23.169999999999995, 17.235, 21.958666666666655, 54.23566666666669, 29.323999999999984, 27.18233333333333, 26.960666666666654, 29.12033333333333, 22.17733333333334, 33.22266666666667, 33.97566666666665, 25.228999999999992, 15.437666666666663, 35.205333333333336, 33.412, 17.011999999999997, 15.748666666666654, 20.56266666666666, 16.48566666666666, 30.93766666666667, 16.298333333333325, 31.47833333333334, 27.876666666666644, 58.1453333333334, 29.298, 42.56100000000001, 51.11500000000001, 25.269666666666676, 34.966, 18.200999999999997, 40.63433333333334, 20.91733333333333, 45.59700000000001, 26.66733333333331, 27.486999999999995, 17.452999999999996, 22.649666666666675, 21.29233333333333, 25.921, 24.14033333333333, 18.441, 17.08733333333333, 13.162666666666667, 34.37766666666666, 21.17299999999999, 33.98433333333332, 23.76366666666665, 16.499666666666663, 24.175666666666675, 35.43466666666667, 36.000666666666675, 19.20233333333333, 27.355000000000004, 29.813333333333325, 19.57066666666666, 43.816], "episode_lengths": [44, 44, 33, 48, 39, 94, 50, 40, 55, 56, 64, 41, 38, 59, 61, 53, 94, 50, 45, 71, 55, 85, 40, 66, 78, 55, 59, 54, 59, 47, 40, 67, 45, 47, 45, 66, 34, 49, 57, 47, 44, 41, 59, 41, 45, 32, 43, 102, 68, 66, 64, 46, 39, 73, 80, 52, 35, 75, 55, 35, 35, 45, 37, 65, 32, 54, 63, 113, 49, 94, 96, 61, 81, 36, 76, 41, 92, 71, 46, 36, 54, 52, 66, 50, 36, 35, 27, 78, 44, 78, 58, 32, 49, 61, 83, 54, 70, 73, 39, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2558521779645033, "mean_inference_ms": 2.3537362413438574, "mean_action_processing_ms": 0.48229453614830864, "mean_env_wait_ms": 0.11577147830844642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021372556686401367, "StateBufferConnector_ms": 0.010546445846557617, "ViewRequirementAgentConnector_ms": 0.3749570846557617}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 633.163345926116, "num_env_steps_trained_throughput_per_sec": 633.163345926116, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 6234.979, "sample_time_ms": 2490.566, "load_time_ms": 0.677, "load_throughput": 5904767.536, "learn_time_ms": 3722.157, "learn_throughput": 1074.646, "synch_weights_time_ms": 19.649}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 2200, "training_iteration": 22, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-22", "timestamp": 1701995302, "time_this_iter_s": 6.33248233795166, "time_total_s": 137.12264943122864, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 137.12264943122864, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 78.25555555555555, "ram_util_percent": 93.34444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.119873119634576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6.119381427764893, "policy_loss": -0.0025045196525752544, "vf_loss": 6.121886253356934, "vf_explained_var": 0.6210762858390808, "kl": 0.0011162698501721025, "entropy": 0.19346603751182556, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 67.628, "episode_reward_min": 13.162666666666667, "episode_reward_mean": 28.219883333333335, "episode_len_mean": 57.97, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.11500000000001, 25.269666666666676, 34.966, 18.200999999999997, 40.63433333333334, 20.91733333333333, 45.59700000000001, 26.66733333333331, 27.486999999999995, 17.452999999999996, 22.649666666666675, 21.29233333333333, 25.921, 24.14033333333333, 18.441, 17.08733333333333, 13.162666666666667, 34.37766666666666, 21.17299999999999, 33.98433333333332, 23.76366666666665, 16.499666666666663, 24.175666666666675, 35.43466666666667, 36.000666666666675, 19.20233333333333, 27.355000000000004, 29.813333333333325, 19.57066666666666, 43.816, 41.96866666666666, 19.64899999999999, 37.89066666666665, 21.285999999999994, 17.887666666666657, 39.65700000000001, 25.926, 24.468333333333344, 18.972666666666658, 27.49600000000001, 22.08566666666667, 31.57366666666667, 51.977, 21.991333333333323, 23.85533333333332, 59.460333333333374, 42.508333333333354, 16.061666666666664, 16.14133333333333, 35.482, 34.07899999999999, 40.29100000000001, 26.01133333333333, 20.16699999999999, 48.023666666666664, 30.420999999999985, 39.799666666666674, 27.84266666666667, 21.790333333333322, 36.78899999999998, 31.192000000000007, 21.66633333333333, 43.688, 38.557, 20.422333333333324, 16.11366666666666, 15.207666666666666, 24.557666666666663, 25.08833333333333, 16.229, 16.80466666666666, 13.69999999999999, 16.623333333333324, 23.08633333333333, 20.70566666666666, 28.929000000000006, 29.38966666666667, 67.628, 28.29533333333332, 30.297999999999995, 19.764999999999997, 40.87133333333334, 15.984333333333332, 40.23233333333333, 23.85299999999998, 38.91133333333332, 25.164666666666662, 34.91433333333331, 39.926333333333346, 54.206666666666706, 14.784666666666665, 17.34533333333333, 33.549666666666674, 22.088999999999995, 17.23599999999999, 21.282333333333327, 25.87933333333333, 17.869333333333323, 23.212999999999997, 29.006333333333313], "episode_lengths": [96, 61, 81, 36, 76, 41, 92, 71, 46, 36, 54, 52, 66, 50, 36, 35, 27, 78, 44, 78, 58, 32, 49, 61, 83, 54, 70, 73, 39, 92, 71, 46, 70, 43, 36, 90, 55, 50, 36, 69, 58, 56, 90, 59, 45, 125, 91, 32, 33, 78, 79, 86, 59, 48, 90, 66, 70, 53, 46, 60, 57, 46, 83, 76, 40, 36, 30, 53, 53, 44, 35, 37, 35, 40, 42, 56, 52, 108, 58, 61, 42, 66, 32, 87, 57, 63, 47, 56, 65, 97, 29, 31, 69, 48, 41, 46, 61, 53, 44, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2512938142927272, "mean_inference_ms": 2.344362199944865, "mean_action_processing_ms": 0.48165174148856793, "mean_env_wait_ms": 0.11524326776149524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02611994743347168, "StateBufferConnector_ms": 0.013997077941894531, "ViewRequirementAgentConnector_ms": 0.355083703994751}}, "episode_reward_max": 67.628, "episode_reward_min": 13.162666666666667, "episode_reward_mean": 28.219883333333335, "episode_len_mean": 57.97, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.11500000000001, 25.269666666666676, 34.966, 18.200999999999997, 40.63433333333334, 20.91733333333333, 45.59700000000001, 26.66733333333331, 27.486999999999995, 17.452999999999996, 22.649666666666675, 21.29233333333333, 25.921, 24.14033333333333, 18.441, 17.08733333333333, 13.162666666666667, 34.37766666666666, 21.17299999999999, 33.98433333333332, 23.76366666666665, 16.499666666666663, 24.175666666666675, 35.43466666666667, 36.000666666666675, 19.20233333333333, 27.355000000000004, 29.813333333333325, 19.57066666666666, 43.816, 41.96866666666666, 19.64899999999999, 37.89066666666665, 21.285999999999994, 17.887666666666657, 39.65700000000001, 25.926, 24.468333333333344, 18.972666666666658, 27.49600000000001, 22.08566666666667, 31.57366666666667, 51.977, 21.991333333333323, 23.85533333333332, 59.460333333333374, 42.508333333333354, 16.061666666666664, 16.14133333333333, 35.482, 34.07899999999999, 40.29100000000001, 26.01133333333333, 20.16699999999999, 48.023666666666664, 30.420999999999985, 39.799666666666674, 27.84266666666667, 21.790333333333322, 36.78899999999998, 31.192000000000007, 21.66633333333333, 43.688, 38.557, 20.422333333333324, 16.11366666666666, 15.207666666666666, 24.557666666666663, 25.08833333333333, 16.229, 16.80466666666666, 13.69999999999999, 16.623333333333324, 23.08633333333333, 20.70566666666666, 28.929000000000006, 29.38966666666667, 67.628, 28.29533333333332, 30.297999999999995, 19.764999999999997, 40.87133333333334, 15.984333333333332, 40.23233333333333, 23.85299999999998, 38.91133333333332, 25.164666666666662, 34.91433333333331, 39.926333333333346, 54.206666666666706, 14.784666666666665, 17.34533333333333, 33.549666666666674, 22.088999999999995, 17.23599999999999, 21.282333333333327, 25.87933333333333, 17.869333333333323, 23.212999999999997, 29.006333333333313], "episode_lengths": [96, 61, 81, 36, 76, 41, 92, 71, 46, 36, 54, 52, 66, 50, 36, 35, 27, 78, 44, 78, 58, 32, 49, 61, 83, 54, 70, 73, 39, 92, 71, 46, 70, 43, 36, 90, 55, 50, 36, 69, 58, 56, 90, 59, 45, 125, 91, 32, 33, 78, 79, 86, 59, 48, 90, 66, 70, 53, 46, 60, 57, 46, 83, 76, 40, 36, 30, 53, 53, 44, 35, 37, 35, 40, 42, 56, 52, 108, 58, 61, 42, 66, 32, 87, 57, 63, 47, 56, 65, 97, 29, 31, 69, 48, 41, 46, 61, 53, 44, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2512938142927272, "mean_inference_ms": 2.344362199944865, "mean_action_processing_ms": 0.48165174148856793, "mean_env_wait_ms": 0.11524326776149524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02611994743347168, "StateBufferConnector_ms": 0.013997077941894531, "ViewRequirementAgentConnector_ms": 0.355083703994751}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 604.1282707289452, "num_env_steps_trained_throughput_per_sec": 604.1282707289452, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 6117.899, "sample_time_ms": 2403.28, "load_time_ms": 0.654, "load_throughput": 6118828.55, "learn_time_ms": 3692.768, "learn_throughput": 1083.198, "synch_weights_time_ms": 19.367}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 2270, "training_iteration": 23, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-29", "timestamp": 1701995309, "time_this_iter_s": 6.633114337921143, "time_total_s": 143.75576376914978, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 143.75576376914978, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 73.13333333333333, "ram_util_percent": 92.26666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.059936559817288e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6.558920383453369, "policy_loss": -0.007391512393951416, "vf_loss": 6.566311836242676, "vf_explained_var": 0.5658925175666809, "kl": 0.0019823473412543535, "entropy": 0.15679822862148285, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 67.628, "episode_reward_min": 13.69999999999999, "episode_reward_mean": 29.12057666666666, "episode_len_mean": 57.65, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.207666666666666, 24.557666666666663, 25.08833333333333, 16.229, 16.80466666666666, 13.69999999999999, 16.623333333333324, 23.08633333333333, 20.70566666666666, 28.929000000000006, 29.38966666666667, 67.628, 28.29533333333332, 30.297999999999995, 19.764999999999997, 40.87133333333334, 15.984333333333332, 40.23233333333333, 23.85299999999998, 38.91133333333332, 25.164666666666662, 34.91433333333331, 39.926333333333346, 54.206666666666706, 14.784666666666665, 17.34533333333333, 33.549666666666674, 22.088999999999995, 17.23599999999999, 21.282333333333327, 25.87933333333333, 17.869333333333323, 23.212999999999997, 29.006333333333313, 19.99033333333333, 35.27133333333332, 13.742666666666665, 34.39533333333333, 35.978666666666676, 37.57033333333332, 48.65966666666665, 17.847333333333335, 31.828, 31.038666666666654, 22.376666666666658, 29.788, 40.99200000000002, 17.10299999999999, 21.148666666666667, 31.15499999999999, 41.51733333333333, 51.11766666666668, 20.967, 18.755333333333326, 19.661666666666665, 35.67133333333333, 30.532666666666657, 35.65666666666665, 22.195333333333327, 23.175666666666654, 65.46499999999995, 18.416333333333323, 18.90233333333332, 16.823999999999998, 24.245333333333317, 46.91833333333334, 48.30266666666664, 18.822999999999986, 32.06766666666666, 21.052, 23.333333333333318, 18.687666666666665, 27.450999999999993, 20.164333333333328, 28.996000000000002, 23.34366666666666, 16.91733333333333, 50.210333333333374, 43.73999999999996, 38.17133333333332, 20.781999999999982, 16.729, 16.767999999999994, 35.065333333333335, 29.217666666666656, 17.85199999999999, 36.52666666666665, 41.777000000000015, 66.54866666666669, 20.40166666666666, 40.57833333333334, 44.702999999999996, 29.459000000000007, 45.009, 22.61966666666666, 18.750666666666657, 43.62233333333336, 23.901, 40.52466666666668, 18.42699999999999], "episode_lengths": [30, 53, 53, 44, 35, 37, 35, 40, 42, 56, 52, 108, 58, 61, 42, 66, 32, 87, 57, 63, 47, 56, 65, 97, 29, 31, 69, 48, 41, 46, 61, 53, 44, 64, 40, 72, 25, 77, 67, 56, 82, 33, 55, 72, 63, 60, 82, 33, 43, 53, 82, 109, 45, 37, 42, 61, 51, 71, 53, 56, 115, 50, 37, 33, 48, 105, 97, 45, 63, 47, 57, 36, 50, 38, 51, 42, 36, 79, 83, 78, 42, 34, 33, 74, 64, 35, 67, 93, 115, 44, 76, 86, 74, 80, 46, 40, 83, 56, 69, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2465035931212898, "mean_inference_ms": 2.3333950291857706, "mean_action_processing_ms": 0.4811274677265645, "mean_env_wait_ms": 0.11507064904035022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01748180389404297, "StateBufferConnector_ms": 0.013309001922607422, "ViewRequirementAgentConnector_ms": 0.3696584701538086}}, "episode_reward_max": 67.628, "episode_reward_min": 13.69999999999999, "episode_reward_mean": 29.12057666666666, "episode_len_mean": 57.65, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.207666666666666, 24.557666666666663, 25.08833333333333, 16.229, 16.80466666666666, 13.69999999999999, 16.623333333333324, 23.08633333333333, 20.70566666666666, 28.929000000000006, 29.38966666666667, 67.628, 28.29533333333332, 30.297999999999995, 19.764999999999997, 40.87133333333334, 15.984333333333332, 40.23233333333333, 23.85299999999998, 38.91133333333332, 25.164666666666662, 34.91433333333331, 39.926333333333346, 54.206666666666706, 14.784666666666665, 17.34533333333333, 33.549666666666674, 22.088999999999995, 17.23599999999999, 21.282333333333327, 25.87933333333333, 17.869333333333323, 23.212999999999997, 29.006333333333313, 19.99033333333333, 35.27133333333332, 13.742666666666665, 34.39533333333333, 35.978666666666676, 37.57033333333332, 48.65966666666665, 17.847333333333335, 31.828, 31.038666666666654, 22.376666666666658, 29.788, 40.99200000000002, 17.10299999999999, 21.148666666666667, 31.15499999999999, 41.51733333333333, 51.11766666666668, 20.967, 18.755333333333326, 19.661666666666665, 35.67133333333333, 30.532666666666657, 35.65666666666665, 22.195333333333327, 23.175666666666654, 65.46499999999995, 18.416333333333323, 18.90233333333332, 16.823999999999998, 24.245333333333317, 46.91833333333334, 48.30266666666664, 18.822999999999986, 32.06766666666666, 21.052, 23.333333333333318, 18.687666666666665, 27.450999999999993, 20.164333333333328, 28.996000000000002, 23.34366666666666, 16.91733333333333, 50.210333333333374, 43.73999999999996, 38.17133333333332, 20.781999999999982, 16.729, 16.767999999999994, 35.065333333333335, 29.217666666666656, 17.85199999999999, 36.52666666666665, 41.777000000000015, 66.54866666666669, 20.40166666666666, 40.57833333333334, 44.702999999999996, 29.459000000000007, 45.009, 22.61966666666666, 18.750666666666657, 43.62233333333336, 23.901, 40.52466666666668, 18.42699999999999], "episode_lengths": [30, 53, 53, 44, 35, 37, 35, 40, 42, 56, 52, 108, 58, 61, 42, 66, 32, 87, 57, 63, 47, 56, 65, 97, 29, 31, 69, 48, 41, 46, 61, 53, 44, 64, 40, 72, 25, 77, 67, 56, 82, 33, 55, 72, 63, 60, 82, 33, 43, 53, 82, 109, 45, 37, 42, 61, 51, 71, 53, 56, 115, 50, 37, 33, 48, 105, 97, 45, 63, 47, 57, 36, 50, 38, 51, 42, 36, 79, 83, 78, 42, 34, 33, 74, 64, 35, 67, 93, 115, 44, 76, 86, 74, 80, 46, 40, 83, 56, 69, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2465035931212898, "mean_inference_ms": 2.3333950291857706, "mean_action_processing_ms": 0.4811274677265645, "mean_env_wait_ms": 0.11507064904035022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01748180389404297, "StateBufferConnector_ms": 0.013309001922607422, "ViewRequirementAgentConnector_ms": 0.3696584701538086}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.2875073019769, "num_env_steps_trained_throughput_per_sec": 801.2875073019769, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 5920.763, "sample_time_ms": 2346.225, "load_time_ms": 0.654, "load_throughput": 6112141.062, "learn_time_ms": 3553.418, "learn_throughput": 1125.677, "synch_weights_time_ms": 18.899}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 2336, "training_iteration": 24, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-34", "timestamp": 1701995314, "time_this_iter_s": 5.002502202987671, "time_total_s": 148.75826597213745, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 148.75826597213745, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 69.51428571428572, "ram_util_percent": 92.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.029968279908644e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5.710451126098633, "policy_loss": -0.004287674557417631, "vf_loss": 5.7147393226623535, "vf_explained_var": 0.5464504361152649, "kl": 0.0011352032888680696, "entropy": 0.18665480613708496, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 70.16600000000001, "episode_reward_min": 14.628999999999996, "episode_reward_mean": 29.460566666666665, "episode_len_mean": 59.34, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.052, 23.333333333333318, 18.687666666666665, 27.450999999999993, 20.164333333333328, 28.996000000000002, 23.34366666666666, 16.91733333333333, 50.210333333333374, 43.73999999999996, 38.17133333333332, 20.781999999999982, 16.729, 16.767999999999994, 35.065333333333335, 29.217666666666656, 17.85199999999999, 36.52666666666665, 41.777000000000015, 66.54866666666669, 20.40166666666666, 40.57833333333334, 44.702999999999996, 29.459000000000007, 45.009, 22.61966666666666, 18.750666666666657, 43.62233333333336, 23.901, 40.52466666666668, 18.42699999999999, 27.86466666666666, 21.647999999999996, 18.179666666666655, 39.93900000000002, 18.394999999999992, 15.746999999999995, 14.628999999999996, 36.193999999999996, 18.779666666666664, 18.66899999999999, 49.13866666666668, 17.098333333333336, 37.96933333333332, 30.610333333333344, 22.37766666666667, 27.915000000000006, 18.57633333333333, 57.486333333333334, 15.381999999999996, 27.83733333333332, 20.635999999999996, 18.772999999999993, 46.39433333333338, 35.810666666666656, 22.791, 34.33433333333333, 29.76066666666666, 46.98899999999998, 58.97499999999999, 19.257666666666662, 20.441666666666656, 38.506333333333316, 17.517999999999997, 18.251, 23.523666666666664, 42.95233333333333, 31.385333333333328, 16.56499999999999, 24.32766666666665, 24.096666666666643, 23.366333333333337, 30.599333333333337, 18.930333333333326, 30.946333333333317, 33.609666666666676, 22.27166666666666, 26.74299999999999, 36.735333333333344, 22.493333333333332, 32.254000000000005, 16.77099999999999, 34.497000000000014, 39.737, 31.625333333333323, 25.676666666666655, 24.759999999999984, 23.372333333333327, 18.37733333333333, 30.64966666666666, 22.039999999999996, 40.286333333333324, 38.139333333333326, 43.445333333333316, 32.467333333333336, 70.16600000000001, 26.88433333333332, 17.446666666666665, 37.35166666666666, 27.35866666666667], "episode_lengths": [47, 57, 36, 50, 38, 51, 42, 36, 79, 83, 78, 42, 34, 33, 74, 64, 35, 67, 93, 115, 44, 76, 86, 74, 80, 46, 40, 83, 56, 69, 42, 65, 49, 40, 76, 42, 30, 31, 67, 38, 42, 73, 32, 95, 66, 46, 57, 34, 108, 33, 76, 43, 49, 76, 63, 48, 72, 53, 108, 100, 42, 42, 76, 45, 42, 40, 104, 64, 40, 70, 55, 54, 61, 45, 64, 75, 46, 59, 67, 47, 53, 32, 69, 60, 68, 49, 57, 48, 43, 54, 47, 76, 84, 77, 77, 124, 56, 35, 70, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.242859368447267, "mean_inference_ms": 2.320022668600003, "mean_action_processing_ms": 0.4799873304964351, "mean_env_wait_ms": 0.11533462765912508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016482114791870117, "StateBufferConnector_ms": 0.013611316680908203, "ViewRequirementAgentConnector_ms": 0.3540337085723877}}, "episode_reward_max": 70.16600000000001, "episode_reward_min": 14.628999999999996, "episode_reward_mean": 29.460566666666665, "episode_len_mean": 59.34, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.052, 23.333333333333318, 18.687666666666665, 27.450999999999993, 20.164333333333328, 28.996000000000002, 23.34366666666666, 16.91733333333333, 50.210333333333374, 43.73999999999996, 38.17133333333332, 20.781999999999982, 16.729, 16.767999999999994, 35.065333333333335, 29.217666666666656, 17.85199999999999, 36.52666666666665, 41.777000000000015, 66.54866666666669, 20.40166666666666, 40.57833333333334, 44.702999999999996, 29.459000000000007, 45.009, 22.61966666666666, 18.750666666666657, 43.62233333333336, 23.901, 40.52466666666668, 18.42699999999999, 27.86466666666666, 21.647999999999996, 18.179666666666655, 39.93900000000002, 18.394999999999992, 15.746999999999995, 14.628999999999996, 36.193999999999996, 18.779666666666664, 18.66899999999999, 49.13866666666668, 17.098333333333336, 37.96933333333332, 30.610333333333344, 22.37766666666667, 27.915000000000006, 18.57633333333333, 57.486333333333334, 15.381999999999996, 27.83733333333332, 20.635999999999996, 18.772999999999993, 46.39433333333338, 35.810666666666656, 22.791, 34.33433333333333, 29.76066666666666, 46.98899999999998, 58.97499999999999, 19.257666666666662, 20.441666666666656, 38.506333333333316, 17.517999999999997, 18.251, 23.523666666666664, 42.95233333333333, 31.385333333333328, 16.56499999999999, 24.32766666666665, 24.096666666666643, 23.366333333333337, 30.599333333333337, 18.930333333333326, 30.946333333333317, 33.609666666666676, 22.27166666666666, 26.74299999999999, 36.735333333333344, 22.493333333333332, 32.254000000000005, 16.77099999999999, 34.497000000000014, 39.737, 31.625333333333323, 25.676666666666655, 24.759999999999984, 23.372333333333327, 18.37733333333333, 30.64966666666666, 22.039999999999996, 40.286333333333324, 38.139333333333326, 43.445333333333316, 32.467333333333336, 70.16600000000001, 26.88433333333332, 17.446666666666665, 37.35166666666666, 27.35866666666667], "episode_lengths": [47, 57, 36, 50, 38, 51, 42, 36, 79, 83, 78, 42, 34, 33, 74, 64, 35, 67, 93, 115, 44, 76, 86, 74, 80, 46, 40, 83, 56, 69, 42, 65, 49, 40, 76, 42, 30, 31, 67, 38, 42, 73, 32, 95, 66, 46, 57, 34, 108, 33, 76, 43, 49, 76, 63, 48, 72, 53, 108, 100, 42, 42, 76, 45, 42, 40, 104, 64, 40, 70, 55, 54, 61, 45, 64, 75, 46, 59, 67, 47, 53, 32, 69, 60, 68, 49, 57, 48, 43, 54, 47, 76, 84, 77, 77, 124, 56, 35, 70, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.242859368447267, "mean_inference_ms": 2.320022668600003, "mean_action_processing_ms": 0.4799873304964351, "mean_env_wait_ms": 0.11533462765912508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016482114791870117, "StateBufferConnector_ms": 0.013611316680908203, "ViewRequirementAgentConnector_ms": 0.3540337085723877}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 625.8955979889674, "num_env_steps_trained_throughput_per_sec": 625.8955979889674, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 5893.294, "sample_time_ms": 2272.906, "load_time_ms": 0.654, "load_throughput": 6112141.062, "learn_time_ms": 3599.754, "learn_throughput": 1111.187, "synch_weights_time_ms": 18.479}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 2405, "training_iteration": 25, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-40", "timestamp": 1701995320, "time_this_iter_s": 6.4048542976379395, "time_total_s": 155.1631202697754, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 155.1631202697754, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 67.34444444444443, "ram_util_percent": 92.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.14984139954322e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 5.877133846282959, "policy_loss": -0.0007577432552352548, "vf_loss": 5.8778910636901855, "vf_explained_var": 0.6012598276138306, "kl": 0.0013302669394761324, "entropy": 0.1745736002922058, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 70.16600000000001, "episode_reward_min": 13.827999999999992, "episode_reward_mean": 28.369156666666658, "episode_len_mean": 56.92, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.096666666666643, 23.366333333333337, 30.599333333333337, 18.930333333333326, 30.946333333333317, 33.609666666666676, 22.27166666666666, 26.74299999999999, 36.735333333333344, 22.493333333333332, 32.254000000000005, 16.77099999999999, 34.497000000000014, 39.737, 31.625333333333323, 25.676666666666655, 24.759999999999984, 23.372333333333327, 18.37733333333333, 30.64966666666666, 22.039999999999996, 40.286333333333324, 38.139333333333326, 43.445333333333316, 32.467333333333336, 70.16600000000001, 26.88433333333332, 17.446666666666665, 37.35166666666666, 27.35866666666667, 33.52899999999999, 30.38033333333334, 15.373666666666661, 18.281999999999996, 17.663666666666668, 29.117333333333328, 20.746333333333325, 42.937000000000005, 21.183333333333337, 17.773333333333326, 19.712333333333326, 16.190999999999995, 17.028666666666663, 17.56366666666666, 15.97766666666666, 23.50766666666666, 28.815, 25.49633333333333, 65.19266666666665, 21.264999999999986, 22.397000000000006, 32.422666666666665, 31.86933333333333, 29.002666666666652, 31.005000000000003, 19.342333333333322, 36.398999999999994, 38.28200000000001, 24.65299999999999, 30.80766666666667, 22.893666666666665, 21.32966666666666, 36.953000000000024, 18.504666666666665, 21.848666666666656, 20.64399999999999, 13.827999999999992, 21.250666666666653, 61.92900000000004, 18.073666666666657, 26.34033333333333, 24.640333333333327, 27.205333333333325, 30.630333333333322, 26.974666666666664, 19.95433333333333, 47.02466666666669, 27.90366666666666, 16.331666666666663, 24.886333333333337, 23.160999999999987, 25.92866666666667, 29.71466666666667, 22.86299999999999, 24.86433333333333, 14.483666666666663, 40.72999999999999, 53.26300000000002, 17.321999999999996, 22.813666666666663, 28.555666666666657, 17.517999999999994, 63.71133333333339, 26.026666666666664, 30.230999999999998, 35.39166666666666, 31.262333333333334, 40.87400000000001, 41.076333333333324, 20.963333333333328], "episode_lengths": [55, 54, 61, 45, 64, 75, 46, 59, 67, 47, 53, 32, 69, 60, 68, 49, 57, 48, 43, 54, 47, 76, 84, 77, 77, 124, 56, 35, 70, 55, 62, 69, 32, 37, 34, 58, 44, 85, 37, 39, 46, 36, 37, 34, 32, 48, 60, 48, 104, 46, 44, 55, 57, 65, 82, 39, 92, 69, 66, 60, 51, 56, 66, 37, 45, 43, 29, 43, 108, 34, 64, 54, 49, 50, 56, 40, 89, 50, 32, 50, 49, 62, 57, 41, 57, 32, 85, 124, 37, 46, 49, 42, 107, 47, 61, 62, 64, 89, 74, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2397445576968529, "mean_inference_ms": 2.308664756906646, "mean_action_processing_ms": 0.47972008879325967, "mean_env_wait_ms": 0.11489283618516767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012708425521850586, "StateBufferConnector_ms": 0.011668205261230469, "ViewRequirementAgentConnector_ms": 0.3899819850921631}}, "episode_reward_max": 70.16600000000001, "episode_reward_min": 13.827999999999992, "episode_reward_mean": 28.369156666666658, "episode_len_mean": 56.92, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.096666666666643, 23.366333333333337, 30.599333333333337, 18.930333333333326, 30.946333333333317, 33.609666666666676, 22.27166666666666, 26.74299999999999, 36.735333333333344, 22.493333333333332, 32.254000000000005, 16.77099999999999, 34.497000000000014, 39.737, 31.625333333333323, 25.676666666666655, 24.759999999999984, 23.372333333333327, 18.37733333333333, 30.64966666666666, 22.039999999999996, 40.286333333333324, 38.139333333333326, 43.445333333333316, 32.467333333333336, 70.16600000000001, 26.88433333333332, 17.446666666666665, 37.35166666666666, 27.35866666666667, 33.52899999999999, 30.38033333333334, 15.373666666666661, 18.281999999999996, 17.663666666666668, 29.117333333333328, 20.746333333333325, 42.937000000000005, 21.183333333333337, 17.773333333333326, 19.712333333333326, 16.190999999999995, 17.028666666666663, 17.56366666666666, 15.97766666666666, 23.50766666666666, 28.815, 25.49633333333333, 65.19266666666665, 21.264999999999986, 22.397000000000006, 32.422666666666665, 31.86933333333333, 29.002666666666652, 31.005000000000003, 19.342333333333322, 36.398999999999994, 38.28200000000001, 24.65299999999999, 30.80766666666667, 22.893666666666665, 21.32966666666666, 36.953000000000024, 18.504666666666665, 21.848666666666656, 20.64399999999999, 13.827999999999992, 21.250666666666653, 61.92900000000004, 18.073666666666657, 26.34033333333333, 24.640333333333327, 27.205333333333325, 30.630333333333322, 26.974666666666664, 19.95433333333333, 47.02466666666669, 27.90366666666666, 16.331666666666663, 24.886333333333337, 23.160999999999987, 25.92866666666667, 29.71466666666667, 22.86299999999999, 24.86433333333333, 14.483666666666663, 40.72999999999999, 53.26300000000002, 17.321999999999996, 22.813666666666663, 28.555666666666657, 17.517999999999994, 63.71133333333339, 26.026666666666664, 30.230999999999998, 35.39166666666666, 31.262333333333334, 40.87400000000001, 41.076333333333324, 20.963333333333328], "episode_lengths": [55, 54, 61, 45, 64, 75, 46, 59, 67, 47, 53, 32, 69, 60, 68, 49, 57, 48, 43, 54, 47, 76, 84, 77, 77, 124, 56, 35, 70, 55, 62, 69, 32, 37, 34, 58, 44, 85, 37, 39, 46, 36, 37, 34, 32, 48, 60, 48, 104, 46, 44, 55, 57, 65, 82, 39, 92, 69, 66, 60, 51, 56, 66, 37, 45, 43, 29, 43, 108, 34, 64, 54, 49, 50, 56, 40, 89, 50, 32, 50, 49, 62, 57, 41, 57, 32, 85, 124, 37, 46, 49, 42, 107, 47, 61, 62, 64, 89, 74, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2397445576968529, "mean_inference_ms": 2.308664756906646, "mean_action_processing_ms": 0.47972008879325967, "mean_env_wait_ms": 0.11489283618516767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012708425521850586, "StateBufferConnector_ms": 0.011668205261230469, "ViewRequirementAgentConnector_ms": 0.3899819850921631}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.5677657655824, "num_env_steps_trained_throughput_per_sec": 797.5677657655824, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 5773.359, "sample_time_ms": 2229.475, "load_time_ms": 0.555, "load_throughput": 7209185.287, "learn_time_ms": 3523.49, "learn_throughput": 1135.238, "synch_weights_time_ms": 18.367}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 2475, "training_iteration": 26, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-45", "timestamp": 1701995325, "time_this_iter_s": 5.026266813278198, "time_total_s": 160.1893870830536, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 160.1893870830536, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 68.94285714285715, "ram_util_percent": 92.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.57492069977161e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 6.146465301513672, "policy_loss": -0.008138146251440048, "vf_loss": 6.154603481292725, "vf_explained_var": 0.5843667984008789, "kl": 0.001537856413051486, "entropy": 0.19119013845920563, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 74.49400000000004, "episode_reward_min": 13.995666666666663, "episode_reward_mean": 30.387143333333334, "episode_len_mean": 59.44, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.92900000000004, 18.073666666666657, 26.34033333333333, 24.640333333333327, 27.205333333333325, 30.630333333333322, 26.974666666666664, 19.95433333333333, 47.02466666666669, 27.90366666666666, 16.331666666666663, 24.886333333333337, 23.160999999999987, 25.92866666666667, 29.71466666666667, 22.86299999999999, 24.86433333333333, 14.483666666666663, 40.72999999999999, 53.26300000000002, 17.321999999999996, 22.813666666666663, 28.555666666666657, 17.517999999999994, 63.71133333333339, 26.026666666666664, 30.230999999999998, 35.39166666666666, 31.262333333333334, 40.87400000000001, 41.076333333333324, 20.963333333333328, 55.083666666666694, 32.13533333333334, 24.001333333333324, 51.85700000000002, 33.179, 23.721000000000004, 33.46700000000001, 15.352333333333332, 19.485333333333326, 15.067999999999994, 22.190333333333324, 26.86266666666667, 23.871999999999996, 28.97533333333335, 13.995666666666663, 18.836333333333332, 20.280333333333328, 28.723666666666666, 35.73866666666667, 21.079000000000008, 52.48566666666668, 49.81266666666664, 34.52366666666666, 28.483666666666664, 55.04666666666665, 24.94666666666666, 16.30333333333333, 24.09833333333333, 23.23233333333332, 31.935333333333325, 21.743666666666655, 74.49400000000004, 38.00566666666667, 15.71899999999999, 30.078, 17.471666666666664, 38.20566666666667, 17.30966666666666, 25.629333333333342, 34.003666666666675, 24.650333333333332, 30.152666666666665, 26.547333333333345, 20.779666666666667, 22.39333333333333, 22.345333333333325, 33.80900000000001, 42.60966666666669, 25.48699999999999, 42.537000000000006, 52.6436666666667, 35.319, 15.83833333333333, 16.51833333333333, 45.708666666666694, 34.19533333333335, 29.409666666666656, 17.709666666666656, 21.486999999999995, 22.631999999999998, 40.455333333333314, 35.486333333333334, 35.04066666666666, 43.09066666666665, 17.419666666666668, 49.157333333333334, 53.56566666666667, 21.644333333333325], "episode_lengths": [108, 34, 64, 54, 49, 50, 56, 40, 89, 50, 32, 50, 49, 62, 57, 41, 57, 32, 85, 124, 37, 46, 49, 42, 107, 47, 61, 62, 64, 89, 74, 37, 92, 57, 49, 78, 66, 46, 60, 28, 41, 29, 54, 51, 55, 56, 28, 37, 43, 56, 59, 52, 88, 76, 70, 64, 104, 54, 36, 50, 56, 65, 40, 146, 68, 32, 68, 36, 68, 36, 51, 62, 49, 52, 67, 41, 47, 47, 63, 76, 48, 70, 80, 74, 32, 32, 85, 66, 59, 36, 57, 47, 83, 70, 77, 79, 44, 101, 99, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2361514652922652, "mean_inference_ms": 2.297121489406432, "mean_action_processing_ms": 0.47882484191663144, "mean_env_wait_ms": 0.114928162589874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014201879501342773, "StateBufferConnector_ms": 0.017517805099487305, "ViewRequirementAgentConnector_ms": 0.36988234519958496}}, "episode_reward_max": 74.49400000000004, "episode_reward_min": 13.995666666666663, "episode_reward_mean": 30.387143333333334, "episode_len_mean": 59.44, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [61.92900000000004, 18.073666666666657, 26.34033333333333, 24.640333333333327, 27.205333333333325, 30.630333333333322, 26.974666666666664, 19.95433333333333, 47.02466666666669, 27.90366666666666, 16.331666666666663, 24.886333333333337, 23.160999999999987, 25.92866666666667, 29.71466666666667, 22.86299999999999, 24.86433333333333, 14.483666666666663, 40.72999999999999, 53.26300000000002, 17.321999999999996, 22.813666666666663, 28.555666666666657, 17.517999999999994, 63.71133333333339, 26.026666666666664, 30.230999999999998, 35.39166666666666, 31.262333333333334, 40.87400000000001, 41.076333333333324, 20.963333333333328, 55.083666666666694, 32.13533333333334, 24.001333333333324, 51.85700000000002, 33.179, 23.721000000000004, 33.46700000000001, 15.352333333333332, 19.485333333333326, 15.067999999999994, 22.190333333333324, 26.86266666666667, 23.871999999999996, 28.97533333333335, 13.995666666666663, 18.836333333333332, 20.280333333333328, 28.723666666666666, 35.73866666666667, 21.079000000000008, 52.48566666666668, 49.81266666666664, 34.52366666666666, 28.483666666666664, 55.04666666666665, 24.94666666666666, 16.30333333333333, 24.09833333333333, 23.23233333333332, 31.935333333333325, 21.743666666666655, 74.49400000000004, 38.00566666666667, 15.71899999999999, 30.078, 17.471666666666664, 38.20566666666667, 17.30966666666666, 25.629333333333342, 34.003666666666675, 24.650333333333332, 30.152666666666665, 26.547333333333345, 20.779666666666667, 22.39333333333333, 22.345333333333325, 33.80900000000001, 42.60966666666669, 25.48699999999999, 42.537000000000006, 52.6436666666667, 35.319, 15.83833333333333, 16.51833333333333, 45.708666666666694, 34.19533333333335, 29.409666666666656, 17.709666666666656, 21.486999999999995, 22.631999999999998, 40.455333333333314, 35.486333333333334, 35.04066666666666, 43.09066666666665, 17.419666666666668, 49.157333333333334, 53.56566666666667, 21.644333333333325], "episode_lengths": [108, 34, 64, 54, 49, 50, 56, 40, 89, 50, 32, 50, 49, 62, 57, 41, 57, 32, 85, 124, 37, 46, 49, 42, 107, 47, 61, 62, 64, 89, 74, 37, 92, 57, 49, 78, 66, 46, 60, 28, 41, 29, 54, 51, 55, 56, 28, 37, 43, 56, 59, 52, 88, 76, 70, 64, 104, 54, 36, 50, 56, 65, 40, 146, 68, 32, 68, 36, 68, 36, 51, 62, 49, 52, 67, 41, 47, 47, 63, 76, 48, 70, 80, 74, 32, 32, 85, 66, 59, 36, 57, 47, 83, 70, 77, 79, 44, 101, 99, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2361514652922652, "mean_inference_ms": 2.297121489406432, "mean_action_processing_ms": 0.47882484191663144, "mean_env_wait_ms": 0.114928162589874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014201879501342773, "StateBufferConnector_ms": 0.017517805099487305, "ViewRequirementAgentConnector_ms": 0.36988234519958496}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.7907925540871, "num_env_steps_trained_throughput_per_sec": 774.7907925540871, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 5727.792, "sample_time_ms": 2233.556, "load_time_ms": 0.502, "load_throughput": 7963364.344, "learn_time_ms": 3474.016, "learn_throughput": 1151.405, "synch_weights_time_ms": 18.167}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 2543, "training_iteration": 27, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-51", "timestamp": 1701995331, "time_this_iter_s": 5.173537492752075, "time_total_s": 165.36292457580566, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 165.36292457580566, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 70.65714285714286, "ram_util_percent": 92.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.287460349885805e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 6.70454216003418, "policy_loss": -0.0009110509417951107, "vf_loss": 6.705453395843506, "vf_explained_var": 0.5386983752250671, "kl": 0.0021630681585520506, "entropy": 0.17538613080978394, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 61.09633333333332, "episode_reward_min": 14.314999999999996, "episode_reward_mean": 30.835840000000005, "episode_len_mean": 60.8, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.078, 17.471666666666664, 38.20566666666667, 17.30966666666666, 25.629333333333342, 34.003666666666675, 24.650333333333332, 30.152666666666665, 26.547333333333345, 20.779666666666667, 22.39333333333333, 22.345333333333325, 33.80900000000001, 42.60966666666669, 25.48699999999999, 42.537000000000006, 52.6436666666667, 35.319, 15.83833333333333, 16.51833333333333, 45.708666666666694, 34.19533333333335, 29.409666666666656, 17.709666666666656, 21.486999999999995, 22.631999999999998, 40.455333333333314, 35.486333333333334, 35.04066666666666, 43.09066666666665, 17.419666666666668, 49.157333333333334, 53.56566666666667, 21.644333333333325, 41.572333333333326, 26.642333333333333, 59.511666666666706, 51.88033333333335, 15.895666666666665, 35.55433333333331, 14.314999999999996, 31.965333333333337, 33.378, 15.630666666666661, 22.539666666666655, 18.074333333333332, 46.32433333333334, 48.457000000000015, 16.96633333333333, 34.49899999999999, 15.948333333333327, 44.09533333333329, 39.005666666666656, 24.273666666666657, 27.196999999999996, 17.609666666666662, 33.37499999999999, 29.098333333333326, 29.55366666666667, 18.475666666666662, 16.03766666666666, 30.855666666666664, 49.0036666666667, 26.263999999999985, 28.889666666666663, 19.976333333333333, 27.23166666666666, 30.685666666666663, 14.37533333333333, 22.054333333333318, 17.86833333333333, 17.320333333333327, 51.850333333333346, 16.085333333333327, 26.303666666666647, 54.39533333333336, 21.874333333333325, 38.548333333333346, 44.82433333333335, 19.43133333333333, 15.503666666666659, 61.09633333333332, 16.376000000000005, 30.75633333333332, 42.476, 39.71400000000001, 45.47233333333334, 34.91699999999999, 23.69400000000001, 24.590000000000007, 51.31200000000002, 19.405666666666658, 21.341666666666665, 45.910000000000004, 50.490333333333346, 40.46033333333334, 44.65033333333335, 17.526666666666664, 24.915666666666667, 25.930333333333323], "episode_lengths": [68, 36, 68, 36, 51, 62, 49, 52, 67, 41, 47, 47, 63, 76, 48, 70, 80, 74, 32, 32, 85, 66, 59, 36, 57, 47, 83, 70, 77, 79, 44, 101, 99, 58, 93, 63, 103, 105, 38, 62, 28, 81, 69, 37, 52, 40, 80, 80, 38, 67, 32, 87, 77, 44, 52, 34, 52, 48, 62, 38, 36, 54, 84, 57, 58, 48, 52, 58, 29, 46, 42, 42, 102, 33, 50, 84, 40, 80, 70, 43, 33, 101, 37, 72, 78, 83, 110, 56, 49, 55, 87, 44, 42, 100, 83, 80, 90, 35, 53, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2346655613486568, "mean_inference_ms": 2.288005645511816, "mean_action_processing_ms": 0.47802693012056297, "mean_env_wait_ms": 0.11488626687296623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017436742782592773, "StateBufferConnector_ms": 0.020663022994995117, "ViewRequirementAgentConnector_ms": 0.3731708526611328}}, "episode_reward_max": 61.09633333333332, "episode_reward_min": 14.314999999999996, "episode_reward_mean": 30.835840000000005, "episode_len_mean": 60.8, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.078, 17.471666666666664, 38.20566666666667, 17.30966666666666, 25.629333333333342, 34.003666666666675, 24.650333333333332, 30.152666666666665, 26.547333333333345, 20.779666666666667, 22.39333333333333, 22.345333333333325, 33.80900000000001, 42.60966666666669, 25.48699999999999, 42.537000000000006, 52.6436666666667, 35.319, 15.83833333333333, 16.51833333333333, 45.708666666666694, 34.19533333333335, 29.409666666666656, 17.709666666666656, 21.486999999999995, 22.631999999999998, 40.455333333333314, 35.486333333333334, 35.04066666666666, 43.09066666666665, 17.419666666666668, 49.157333333333334, 53.56566666666667, 21.644333333333325, 41.572333333333326, 26.642333333333333, 59.511666666666706, 51.88033333333335, 15.895666666666665, 35.55433333333331, 14.314999999999996, 31.965333333333337, 33.378, 15.630666666666661, 22.539666666666655, 18.074333333333332, 46.32433333333334, 48.457000000000015, 16.96633333333333, 34.49899999999999, 15.948333333333327, 44.09533333333329, 39.005666666666656, 24.273666666666657, 27.196999999999996, 17.609666666666662, 33.37499999999999, 29.098333333333326, 29.55366666666667, 18.475666666666662, 16.03766666666666, 30.855666666666664, 49.0036666666667, 26.263999999999985, 28.889666666666663, 19.976333333333333, 27.23166666666666, 30.685666666666663, 14.37533333333333, 22.054333333333318, 17.86833333333333, 17.320333333333327, 51.850333333333346, 16.085333333333327, 26.303666666666647, 54.39533333333336, 21.874333333333325, 38.548333333333346, 44.82433333333335, 19.43133333333333, 15.503666666666659, 61.09633333333332, 16.376000000000005, 30.75633333333332, 42.476, 39.71400000000001, 45.47233333333334, 34.91699999999999, 23.69400000000001, 24.590000000000007, 51.31200000000002, 19.405666666666658, 21.341666666666665, 45.910000000000004, 50.490333333333346, 40.46033333333334, 44.65033333333335, 17.526666666666664, 24.915666666666667, 25.930333333333323], "episode_lengths": [68, 36, 68, 36, 51, 62, 49, 52, 67, 41, 47, 47, 63, 76, 48, 70, 80, 74, 32, 32, 85, 66, 59, 36, 57, 47, 83, 70, 77, 79, 44, 101, 99, 58, 93, 63, 103, 105, 38, 62, 28, 81, 69, 37, 52, 40, 80, 80, 38, 67, 32, 87, 77, 44, 52, 34, 52, 48, 62, 38, 36, 54, 84, 57, 58, 48, 52, 58, 29, 46, 42, 42, 102, 33, 50, 84, 40, 80, 70, 43, 33, 101, 37, 72, 78, 83, 110, 56, 49, 55, 87, 44, 42, 100, 83, 80, 90, 35, 53, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2346655613486568, "mean_inference_ms": 2.288005645511816, "mean_action_processing_ms": 0.47802693012056297, "mean_env_wait_ms": 0.11488626687296623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017436742782592773, "StateBufferConnector_ms": 0.020663022994995117, "ViewRequirementAgentConnector_ms": 0.3731708526611328}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.2550207991228, "num_env_steps_trained_throughput_per_sec": 791.2550207991228, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 5677.518, "sample_time_ms": 2239.431, "load_time_ms": 0.502, "load_throughput": 7960341.621, "learn_time_ms": 3419.527, "learn_throughput": 1169.752, "synch_weights_time_ms": 16.567}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 2609, "training_iteration": 28, "trial_id": "432ea_00000", "date": "2023-12-07_16-28-56", "timestamp": 1701995336, "time_this_iter_s": 5.06646728515625, "time_total_s": 170.4293918609619, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 170.4293918609619, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 67.75714285714285, "ram_util_percent": 92.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.437301749429025e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 6.224048137664795, "policy_loss": -0.0046395426616072655, "vf_loss": 6.228687763214111, "vf_explained_var": 0.5573434233665466, "kl": 0.0013202959671616554, "entropy": 0.16287919878959656, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 67.44900000000005, "episode_reward_min": 13.279999999999996, "episode_reward_mean": 29.87114666666666, "episode_len_mean": 58.56, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.86833333333333, 17.320333333333327, 51.850333333333346, 16.085333333333327, 26.303666666666647, 54.39533333333336, 21.874333333333325, 38.548333333333346, 44.82433333333335, 19.43133333333333, 15.503666666666659, 61.09633333333332, 16.376000000000005, 30.75633333333332, 42.476, 39.71400000000001, 45.47233333333334, 34.91699999999999, 23.69400000000001, 24.590000000000007, 51.31200000000002, 19.405666666666658, 21.341666666666665, 45.910000000000004, 50.490333333333346, 40.46033333333334, 44.65033333333335, 17.526666666666664, 24.915666666666667, 25.930333333333323, 46.55866666666669, 14.563333333333327, 26.63000000000001, 67.44900000000005, 19.035666666666668, 25.383999999999993, 19.548333333333332, 17.121999999999996, 28.138999999999992, 27.02333333333333, 17.645333333333326, 27.648666666666653, 19.971666666666668, 25.793000000000003, 22.186000000000007, 41.505666666666656, 30.12766666666667, 27.58833333333334, 15.84966666666666, 16.168333333333333, 23.081666666666653, 33.48499999999999, 22.57966666666666, 20.308999999999987, 48.22000000000002, 34.717999999999996, 60.7103333333333, 26.07366666666665, 41.40666666666667, 26.73933333333333, 18.44733333333332, 44.148666666666685, 19.730666666666664, 13.279999999999996, 14.853666666666664, 21.018333333333327, 20.108999999999998, 36.230333333333334, 18.485333333333333, 19.98533333333333, 19.49899999999999, 54.27633333333333, 13.803333333333331, 34.94499999999999, 31.97166666666665, 33.57966666666665, 15.956999999999994, 17.206333333333326, 60.33733333333335, 65.91200000000006, 17.88833333333333, 26.447999999999997, 36.36033333333335, 20.356333333333332, 23.84066666666666, 27.063000000000006, 27.078333333333322, 20.00899999999999, 46.30533333333333, 26.56266666666665, 36.838999999999984, 30.371999999999986, 29.676999999999996, 19.375999999999994, 26.69766666666666, 22.22966666666666, 30.646333333333327, 20.021666666666665, 39.354666666666674, 27.91099999999999], "episode_lengths": [42, 42, 102, 33, 50, 84, 40, 80, 70, 43, 33, 101, 37, 72, 78, 83, 110, 56, 49, 55, 87, 44, 42, 100, 83, 80, 90, 35, 53, 62, 97, 33, 47, 115, 36, 67, 51, 37, 61, 57, 35, 45, 42, 44, 41, 76, 54, 50, 34, 42, 50, 57, 49, 40, 84, 59, 102, 56, 75, 61, 42, 79, 43, 27, 30, 42, 48, 67, 35, 37, 38, 94, 27, 57, 62, 62, 34, 36, 93, 129, 40, 49, 86, 39, 43, 60, 50, 41, 77, 61, 67, 69, 52, 46, 70, 54, 66, 40, 69, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2335398856566884, "mean_inference_ms": 2.2825023109941465, "mean_action_processing_ms": 0.4781907524924196, "mean_env_wait_ms": 0.11487082961131495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019639015197753906, "StateBufferConnector_ms": 0.019533634185791016, "ViewRequirementAgentConnector_ms": 0.4136474132537842}}, "episode_reward_max": 67.44900000000005, "episode_reward_min": 13.279999999999996, "episode_reward_mean": 29.87114666666666, "episode_len_mean": 58.56, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.86833333333333, 17.320333333333327, 51.850333333333346, 16.085333333333327, 26.303666666666647, 54.39533333333336, 21.874333333333325, 38.548333333333346, 44.82433333333335, 19.43133333333333, 15.503666666666659, 61.09633333333332, 16.376000000000005, 30.75633333333332, 42.476, 39.71400000000001, 45.47233333333334, 34.91699999999999, 23.69400000000001, 24.590000000000007, 51.31200000000002, 19.405666666666658, 21.341666666666665, 45.910000000000004, 50.490333333333346, 40.46033333333334, 44.65033333333335, 17.526666666666664, 24.915666666666667, 25.930333333333323, 46.55866666666669, 14.563333333333327, 26.63000000000001, 67.44900000000005, 19.035666666666668, 25.383999999999993, 19.548333333333332, 17.121999999999996, 28.138999999999992, 27.02333333333333, 17.645333333333326, 27.648666666666653, 19.971666666666668, 25.793000000000003, 22.186000000000007, 41.505666666666656, 30.12766666666667, 27.58833333333334, 15.84966666666666, 16.168333333333333, 23.081666666666653, 33.48499999999999, 22.57966666666666, 20.308999999999987, 48.22000000000002, 34.717999999999996, 60.7103333333333, 26.07366666666665, 41.40666666666667, 26.73933333333333, 18.44733333333332, 44.148666666666685, 19.730666666666664, 13.279999999999996, 14.853666666666664, 21.018333333333327, 20.108999999999998, 36.230333333333334, 18.485333333333333, 19.98533333333333, 19.49899999999999, 54.27633333333333, 13.803333333333331, 34.94499999999999, 31.97166666666665, 33.57966666666665, 15.956999999999994, 17.206333333333326, 60.33733333333335, 65.91200000000006, 17.88833333333333, 26.447999999999997, 36.36033333333335, 20.356333333333332, 23.84066666666666, 27.063000000000006, 27.078333333333322, 20.00899999999999, 46.30533333333333, 26.56266666666665, 36.838999999999984, 30.371999999999986, 29.676999999999996, 19.375999999999994, 26.69766666666666, 22.22966666666666, 30.646333333333327, 20.021666666666665, 39.354666666666674, 27.91099999999999], "episode_lengths": [42, 42, 102, 33, 50, 84, 40, 80, 70, 43, 33, 101, 37, 72, 78, 83, 110, 56, 49, 55, 87, 44, 42, 100, 83, 80, 90, 35, 53, 62, 97, 33, 47, 115, 36, 67, 51, 37, 61, 57, 35, 45, 42, 44, 41, 76, 54, 50, 34, 42, 50, 57, 49, 40, 84, 59, 102, 56, 75, 61, 42, 79, 43, 27, 30, 42, 48, 67, 35, 37, 38, 94, 27, 57, 62, 62, 34, 36, 93, 129, 40, 49, 86, 39, 43, 60, 50, 41, 77, 61, 67, 69, 52, 46, 70, 54, 66, 40, 69, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2335398856566884, "mean_inference_ms": 2.2825023109941465, "mean_action_processing_ms": 0.4781907524924196, "mean_env_wait_ms": 0.11487082961131495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019639015197753906, "StateBufferConnector_ms": 0.019533634185791016, "ViewRequirementAgentConnector_ms": 0.4136474132537842}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 643.6672315867005, "num_env_steps_trained_throughput_per_sec": 643.6672315867005, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 5672.446, "sample_time_ms": 2181.422, "load_time_ms": 0.603, "load_throughput": 6638920.502, "learn_time_ms": 3472.267, "learn_throughput": 1151.985, "synch_weights_time_ms": 16.677}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 2679, "training_iteration": 29, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-02", "timestamp": 1701995342, "time_this_iter_s": 6.226398944854736, "time_total_s": 176.65579080581665, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 176.65579080581665, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 68.64444444444445, "ram_util_percent": 92.5888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.2186508747145126e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 6.3363566398620605, "policy_loss": 0.00314205139875412, "vf_loss": 6.333214282989502, "vf_explained_var": 0.5443590879440308, "kl": 0.0010048610856756568, "entropy": 0.15700627863407135, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 73.52066666666668, "episode_reward_min": 13.803333333333331, "episode_reward_mean": 29.798609999999993, "episode_len_mean": 57.65, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.27633333333333, 13.803333333333331, 34.94499999999999, 31.97166666666665, 33.57966666666665, 15.956999999999994, 17.206333333333326, 60.33733333333335, 65.91200000000006, 17.88833333333333, 26.447999999999997, 36.36033333333335, 20.356333333333332, 23.84066666666666, 27.063000000000006, 27.078333333333322, 20.00899999999999, 46.30533333333333, 26.56266666666665, 36.838999999999984, 30.371999999999986, 29.676999999999996, 19.375999999999994, 26.69766666666666, 22.22966666666666, 30.646333333333327, 20.021666666666665, 39.354666666666674, 27.91099999999999, 30.855666666666654, 25.175666666666654, 73.52066666666668, 31.39299999999999, 35.385999999999996, 65.33400000000002, 16.323666666666664, 15.786333333333324, 41.67899999999998, 22.66133333333332, 20.366666666666656, 18.427333333333326, 30.043, 36.86733333333333, 16.383666666666663, 17.04766666666666, 33.27133333333333, 22.853333333333325, 20.632666666666672, 30.697, 32.64733333333332, 46.11866666666665, 46.92099999999997, 25.465333333333323, 39.048666666666655, 25.87866666666666, 31.923666666666655, 20.882333333333325, 22.89633333333333, 39.034000000000006, 25.319666666666667, 53.04300000000003, 18.544333333333327, 33.830333333333314, 37.94266666666668, 14.839666666666659, 65.61766666666672, 23.720666666666656, 24.466333333333324, 16.767666666666663, 15.430333333333332, 14.546999999999997, 38.245, 31.368666666666655, 28.73333333333333, 48.49466666666665, 60.840333333333376, 48.82333333333336, 28.123, 14.860333333333331, 21.958333333333325, 21.154666666666657, 22.51466666666666, 47.855666666666664, 38.55466666666664, 14.421333333333328, 16.13833333333333, 24.599, 23.259666666666668, 36.50033333333334, 14.563666666666663, 21.570999999999994, 24.730999999999995, 17.32466666666666, 16.62066666666667, 16.690333333333328, 17.534666666666663, 19.559333333333324, 30.01766666666666, 18.052999999999994, 54.13333333333328], "episode_lengths": [94, 27, 57, 62, 62, 34, 36, 93, 129, 40, 49, 86, 39, 43, 60, 50, 41, 77, 61, 67, 69, 52, 46, 70, 54, 66, 40, 69, 62, 58, 48, 123, 62, 93, 111, 38, 32, 76, 53, 40, 41, 56, 64, 33, 30, 66, 45, 41, 62, 57, 79, 72, 47, 87, 63, 62, 44, 48, 71, 45, 86, 36, 57, 61, 34, 114, 44, 58, 36, 30, 29, 68, 53, 52, 93, 90, 88, 66, 29, 40, 45, 55, 96, 77, 29, 38, 48, 46, 88, 30, 36, 47, 35, 39, 36, 39, 44, 60, 36, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2301577297801607, "mean_inference_ms": 2.278152653816487, "mean_action_processing_ms": 0.4787003988383709, "mean_env_wait_ms": 0.11490351894819392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023893117904663086, "StateBufferConnector_ms": 0.008385896682739258, "ViewRequirementAgentConnector_ms": 0.4239077568054199}}, "episode_reward_max": 73.52066666666668, "episode_reward_min": 13.803333333333331, "episode_reward_mean": 29.798609999999993, "episode_len_mean": 57.65, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.27633333333333, 13.803333333333331, 34.94499999999999, 31.97166666666665, 33.57966666666665, 15.956999999999994, 17.206333333333326, 60.33733333333335, 65.91200000000006, 17.88833333333333, 26.447999999999997, 36.36033333333335, 20.356333333333332, 23.84066666666666, 27.063000000000006, 27.078333333333322, 20.00899999999999, 46.30533333333333, 26.56266666666665, 36.838999999999984, 30.371999999999986, 29.676999999999996, 19.375999999999994, 26.69766666666666, 22.22966666666666, 30.646333333333327, 20.021666666666665, 39.354666666666674, 27.91099999999999, 30.855666666666654, 25.175666666666654, 73.52066666666668, 31.39299999999999, 35.385999999999996, 65.33400000000002, 16.323666666666664, 15.786333333333324, 41.67899999999998, 22.66133333333332, 20.366666666666656, 18.427333333333326, 30.043, 36.86733333333333, 16.383666666666663, 17.04766666666666, 33.27133333333333, 22.853333333333325, 20.632666666666672, 30.697, 32.64733333333332, 46.11866666666665, 46.92099999999997, 25.465333333333323, 39.048666666666655, 25.87866666666666, 31.923666666666655, 20.882333333333325, 22.89633333333333, 39.034000000000006, 25.319666666666667, 53.04300000000003, 18.544333333333327, 33.830333333333314, 37.94266666666668, 14.839666666666659, 65.61766666666672, 23.720666666666656, 24.466333333333324, 16.767666666666663, 15.430333333333332, 14.546999999999997, 38.245, 31.368666666666655, 28.73333333333333, 48.49466666666665, 60.840333333333376, 48.82333333333336, 28.123, 14.860333333333331, 21.958333333333325, 21.154666666666657, 22.51466666666666, 47.855666666666664, 38.55466666666664, 14.421333333333328, 16.13833333333333, 24.599, 23.259666666666668, 36.50033333333334, 14.563666666666663, 21.570999999999994, 24.730999999999995, 17.32466666666666, 16.62066666666667, 16.690333333333328, 17.534666666666663, 19.559333333333324, 30.01766666666666, 18.052999999999994, 54.13333333333328], "episode_lengths": [94, 27, 57, 62, 62, 34, 36, 93, 129, 40, 49, 86, 39, 43, 60, 50, 41, 77, 61, 67, 69, 52, 46, 70, 54, 66, 40, 69, 62, 58, 48, 123, 62, 93, 111, 38, 32, 76, 53, 40, 41, 56, 64, 33, 30, 66, 45, 41, 62, 57, 79, 72, 47, 87, 63, 62, 44, 48, 71, 45, 86, 36, 57, 61, 34, 114, 44, 58, 36, 30, 29, 68, 53, 52, 93, 90, 88, 66, 29, 40, 45, 55, 96, 77, 29, 38, 48, 46, 88, 30, 36, 47, 35, 39, 36, 39, 44, 60, 36, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2301577297801607, "mean_inference_ms": 2.278152653816487, "mean_action_processing_ms": 0.4787003988383709, "mean_env_wait_ms": 0.11490351894819392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023893117904663086, "StateBufferConnector_ms": 0.008385896682739258, "ViewRequirementAgentConnector_ms": 0.4239077568054199}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.4259308150565, "num_env_steps_trained_throughput_per_sec": 545.4259308150565, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 5887.625, "sample_time_ms": 2207.121, "load_time_ms": 0.502, "load_throughput": 7961474.873, "learn_time_ms": 3661.835, "learn_throughput": 1092.348, "synch_weights_time_ms": 16.742}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 2750, "training_iteration": 30, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-09", "timestamp": 1701995349, "time_this_iter_s": 7.345729351043701, "time_total_s": 184.00152015686035, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 184.00152015686035, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 68.2, "ram_util_percent": 92.66999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6093254373572563e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 5.827749252319336, "policy_loss": -0.007763496600091457, "vf_loss": 5.835513114929199, "vf_explained_var": 0.5491273999214172, "kl": 0.0011513568460941315, "entropy": 0.15504799783229828, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 65.70933333333336, "episode_reward_min": 11.397999999999996, "episode_reward_mean": 27.553503333333328, "episode_len_mean": 54.32, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.73333333333333, 48.49466666666665, 60.840333333333376, 48.82333333333336, 28.123, 14.860333333333331, 21.958333333333325, 21.154666666666657, 22.51466666666666, 47.855666666666664, 38.55466666666664, 14.421333333333328, 16.13833333333333, 24.599, 23.259666666666668, 36.50033333333334, 14.563666666666663, 21.570999999999994, 24.730999999999995, 17.32466666666666, 16.62066666666667, 16.690333333333328, 17.534666666666663, 19.559333333333324, 30.01766666666666, 18.052999999999994, 54.13333333333328, 46.478999999999964, 49.88466666666667, 20.334333333333323, 21.196999999999996, 24.448333333333327, 25.213666666666665, 16.26533333333333, 29.645333333333326, 47.611333333333334, 11.397999999999996, 18.408999999999995, 21.707333333333338, 25.33700000000001, 65.70933333333336, 38.32666666666666, 20.307999999999996, 24.576999999999998, 22.03533333333334, 25.61366666666667, 52.16166666666667, 19.836666666666652, 17.73233333333333, 16.94066666666666, 42.94533333333334, 30.46033333333333, 31.806333333333335, 29.641333333333318, 19.08766666666666, 19.013333333333332, 35.117666666666665, 31.707666666666668, 23.263333333333332, 12.967666666666666, 22.161333333333328, 17.326999999999998, 19.36366666666666, 54.369666666666696, 29.302999999999994, 16.08933333333333, 12.02, 28.105999999999995, 18.614666666666654, 33.950333333333326, 22.95933333333333, 28.580333333333336, 41.080666666666666, 27.203999999999986, 13.663999999999994, 26.312666666666654, 27.705666666666666, 27.65699999999999, 15.204000000000002, 19.952999999999992, 31.635, 22.141000000000002, 20.06533333333333, 44.57866666666664, 14.639333333333326, 51.553, 28.844333333333335, 29.772999999999985, 16.223666666666663, 22.607000000000003, 45.04766666666665, 14.916999999999998, 16.955333333333332, 23.52133333333332, 36.05299999999999, 37.16999999999999, 40.24766666666668, 36.35199999999999, 18.828999999999983, 17.757999999999992], "episode_lengths": [52, 93, 90, 88, 66, 29, 40, 45, 55, 96, 77, 29, 38, 48, 46, 88, 30, 36, 47, 35, 39, 36, 39, 44, 60, 36, 95, 84, 84, 46, 44, 45, 53, 37, 67, 81, 26, 38, 43, 57, 108, 87, 49, 52, 47, 53, 101, 41, 34, 33, 75, 61, 64, 49, 45, 35, 80, 58, 47, 26, 41, 35, 40, 90, 54, 35, 25, 55, 37, 64, 51, 57, 73, 55, 26, 67, 48, 48, 33, 40, 62, 52, 54, 71, 31, 96, 66, 52, 32, 50, 97, 32, 35, 52, 59, 73, 72, 69, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2289906869774427, "mean_inference_ms": 2.2709384950614733, "mean_action_processing_ms": 0.4784472335052882, "mean_env_wait_ms": 0.11510212841700064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016370058059692383, "StateBufferConnector_ms": 0.005239963531494141, "ViewRequirementAgentConnector_ms": 0.3913605213165283}}, "episode_reward_max": 65.70933333333336, "episode_reward_min": 11.397999999999996, "episode_reward_mean": 27.553503333333328, "episode_len_mean": 54.32, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.73333333333333, 48.49466666666665, 60.840333333333376, 48.82333333333336, 28.123, 14.860333333333331, 21.958333333333325, 21.154666666666657, 22.51466666666666, 47.855666666666664, 38.55466666666664, 14.421333333333328, 16.13833333333333, 24.599, 23.259666666666668, 36.50033333333334, 14.563666666666663, 21.570999999999994, 24.730999999999995, 17.32466666666666, 16.62066666666667, 16.690333333333328, 17.534666666666663, 19.559333333333324, 30.01766666666666, 18.052999999999994, 54.13333333333328, 46.478999999999964, 49.88466666666667, 20.334333333333323, 21.196999999999996, 24.448333333333327, 25.213666666666665, 16.26533333333333, 29.645333333333326, 47.611333333333334, 11.397999999999996, 18.408999999999995, 21.707333333333338, 25.33700000000001, 65.70933333333336, 38.32666666666666, 20.307999999999996, 24.576999999999998, 22.03533333333334, 25.61366666666667, 52.16166666666667, 19.836666666666652, 17.73233333333333, 16.94066666666666, 42.94533333333334, 30.46033333333333, 31.806333333333335, 29.641333333333318, 19.08766666666666, 19.013333333333332, 35.117666666666665, 31.707666666666668, 23.263333333333332, 12.967666666666666, 22.161333333333328, 17.326999999999998, 19.36366666666666, 54.369666666666696, 29.302999999999994, 16.08933333333333, 12.02, 28.105999999999995, 18.614666666666654, 33.950333333333326, 22.95933333333333, 28.580333333333336, 41.080666666666666, 27.203999999999986, 13.663999999999994, 26.312666666666654, 27.705666666666666, 27.65699999999999, 15.204000000000002, 19.952999999999992, 31.635, 22.141000000000002, 20.06533333333333, 44.57866666666664, 14.639333333333326, 51.553, 28.844333333333335, 29.772999999999985, 16.223666666666663, 22.607000000000003, 45.04766666666665, 14.916999999999998, 16.955333333333332, 23.52133333333332, 36.05299999999999, 37.16999999999999, 40.24766666666668, 36.35199999999999, 18.828999999999983, 17.757999999999992], "episode_lengths": [52, 93, 90, 88, 66, 29, 40, 45, 55, 96, 77, 29, 38, 48, 46, 88, 30, 36, 47, 35, 39, 36, 39, 44, 60, 36, 95, 84, 84, 46, 44, 45, 53, 37, 67, 81, 26, 38, 43, 57, 108, 87, 49, 52, 47, 53, 101, 41, 34, 33, 75, 61, 64, 49, 45, 35, 80, 58, 47, 26, 41, 35, 40, 90, 54, 35, 25, 55, 37, 64, 51, 57, 73, 55, 26, 67, 48, 48, 33, 40, 62, 52, 54, 71, 31, 96, 66, 52, 32, 50, 97, 32, 35, 52, 59, 73, 72, 69, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2289906869774427, "mean_inference_ms": 2.2709384950614733, "mean_action_processing_ms": 0.4784472335052882, "mean_env_wait_ms": 0.11510212841700064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016370058059692383, "StateBufferConnector_ms": 0.005239963531494141, "ViewRequirementAgentConnector_ms": 0.3913605213165283}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.9317642099975, "num_env_steps_trained_throughput_per_sec": 681.9317642099975, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 5896.74, "sample_time_ms": 2223.957, "load_time_ms": 0.392, "load_throughput": 10192719.32, "learn_time_ms": 3652.812, "learn_throughput": 1095.047, "synch_weights_time_ms": 18.153}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 2823, "training_iteration": 31, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-15", "timestamp": 1701995355, "time_this_iter_s": 5.8858418464660645, "time_total_s": 189.88736200332642, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 189.88736200332642, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 69.2125, "ram_util_percent": 92.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.046627186786282e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 5.545652866363525, "policy_loss": -0.0057355365715920925, "vf_loss": 5.551388263702393, "vf_explained_var": 0.6021739840507507, "kl": 0.0019496699096634984, "entropy": 0.1698138564825058, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 79.66500000000003, "episode_reward_min": 11.46933333333333, "episode_reward_mean": 26.50094333333333, "episode_len_mean": 52.29, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.635, 22.141000000000002, 20.06533333333333, 44.57866666666664, 14.639333333333326, 51.553, 28.844333333333335, 29.772999999999985, 16.223666666666663, 22.607000000000003, 45.04766666666665, 14.916999999999998, 16.955333333333332, 23.52133333333332, 36.05299999999999, 37.16999999999999, 40.24766666666668, 36.35199999999999, 18.828999999999983, 17.757999999999992, 25.552666666666653, 29.20133333333334, 13.732333333333328, 23.664333333333325, 79.66500000000003, 16.981666666666662, 28.97466666666668, 23.57633333333333, 20.954333333333334, 36.205000000000005, 49.50766666666665, 16.89666666666666, 29.711666666666677, 35.40199999999999, 18.24233333333333, 14.612, 11.46933333333333, 25.928666666666665, 39.858666666666664, 14.041333333333327, 32.123666666666665, 30.87233333333331, 54.049666666666745, 23.771666666666654, 16.320333333333327, 17.687333333333328, 42.155999999999985, 41.31733333333333, 14.995999999999995, 28.542666666666666, 17.276333333333326, 18.845999999999993, 33.41766666666668, 14.173999999999996, 35.16633333333332, 43.52166666666667, 23.661, 37.592333333333315, 20.164666666666662, 38.39300000000002, 21.915333333333322, 20.575666666666667, 15.99666666666666, 20.411333333333324, 29.551999999999996, 20.634999999999987, 20.211666666666655, 15.241999999999996, 20.07833333333333, 30.885666666666662, 17.924333333333326, 16.303666666666665, 28.758666666666663, 25.654666666666653, 15.371333333333336, 24.35, 18.169999999999998, 20.93233333333333, 17.054999999999996, 48.738666666666695, 19.837999999999997, 32.89633333333333, 36.702666666666666, 28.020666666666667, 18.887333333333324, 26.579999999999995, 14.555333333333332, 20.71866666666667, 15.194666666666661, 13.718333333333335, 27.052999999999983, 23.03233333333333, 17.831666666666663, 46.47366666666668, 21.744999999999994, 21.16699999999999, 19.85833333333333, 15.561333333333328, 38.50900000000001, 35.84933333333333], "episode_lengths": [62, 52, 54, 71, 31, 96, 66, 52, 32, 50, 97, 32, 35, 52, 59, 73, 72, 69, 38, 38, 50, 71, 27, 53, 127, 37, 65, 48, 36, 80, 84, 43, 68, 65, 38, 29, 30, 50, 63, 31, 56, 62, 97, 44, 38, 39, 91, 79, 34, 63, 37, 40, 58, 29, 54, 82, 52, 57, 44, 68, 45, 41, 35, 44, 68, 50, 41, 31, 40, 72, 36, 33, 59, 39, 29, 49, 37, 41, 40, 85, 38, 64, 61, 64, 39, 49, 27, 47, 31, 30, 51, 48, 37, 80, 40, 42, 42, 34, 75, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2271505511595855, "mean_inference_ms": 2.264551787105493, "mean_action_processing_ms": 0.4784444724268389, "mean_env_wait_ms": 0.11485810639136318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017037630081176758, "StateBufferConnector_ms": 0.006489992141723633, "ViewRequirementAgentConnector_ms": 0.393002986907959}}, "episode_reward_max": 79.66500000000003, "episode_reward_min": 11.46933333333333, "episode_reward_mean": 26.50094333333333, "episode_len_mean": 52.29, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.635, 22.141000000000002, 20.06533333333333, 44.57866666666664, 14.639333333333326, 51.553, 28.844333333333335, 29.772999999999985, 16.223666666666663, 22.607000000000003, 45.04766666666665, 14.916999999999998, 16.955333333333332, 23.52133333333332, 36.05299999999999, 37.16999999999999, 40.24766666666668, 36.35199999999999, 18.828999999999983, 17.757999999999992, 25.552666666666653, 29.20133333333334, 13.732333333333328, 23.664333333333325, 79.66500000000003, 16.981666666666662, 28.97466666666668, 23.57633333333333, 20.954333333333334, 36.205000000000005, 49.50766666666665, 16.89666666666666, 29.711666666666677, 35.40199999999999, 18.24233333333333, 14.612, 11.46933333333333, 25.928666666666665, 39.858666666666664, 14.041333333333327, 32.123666666666665, 30.87233333333331, 54.049666666666745, 23.771666666666654, 16.320333333333327, 17.687333333333328, 42.155999999999985, 41.31733333333333, 14.995999999999995, 28.542666666666666, 17.276333333333326, 18.845999999999993, 33.41766666666668, 14.173999999999996, 35.16633333333332, 43.52166666666667, 23.661, 37.592333333333315, 20.164666666666662, 38.39300000000002, 21.915333333333322, 20.575666666666667, 15.99666666666666, 20.411333333333324, 29.551999999999996, 20.634999999999987, 20.211666666666655, 15.241999999999996, 20.07833333333333, 30.885666666666662, 17.924333333333326, 16.303666666666665, 28.758666666666663, 25.654666666666653, 15.371333333333336, 24.35, 18.169999999999998, 20.93233333333333, 17.054999999999996, 48.738666666666695, 19.837999999999997, 32.89633333333333, 36.702666666666666, 28.020666666666667, 18.887333333333324, 26.579999999999995, 14.555333333333332, 20.71866666666667, 15.194666666666661, 13.718333333333335, 27.052999999999983, 23.03233333333333, 17.831666666666663, 46.47366666666668, 21.744999999999994, 21.16699999999999, 19.85833333333333, 15.561333333333328, 38.50900000000001, 35.84933333333333], "episode_lengths": [62, 52, 54, 71, 31, 96, 66, 52, 32, 50, 97, 32, 35, 52, 59, 73, 72, 69, 38, 38, 50, 71, 27, 53, 127, 37, 65, 48, 36, 80, 84, 43, 68, 65, 38, 29, 30, 50, 63, 31, 56, 62, 97, 44, 38, 39, 91, 79, 34, 63, 37, 40, 58, 29, 54, 82, 52, 57, 44, 68, 45, 41, 35, 44, 68, 50, 41, 31, 40, 72, 36, 33, 59, 39, 29, 49, 37, 41, 40, 85, 38, 64, 61, 64, 39, 49, 27, 47, 31, 30, 51, 48, 37, 80, 40, 42, 42, 34, 75, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2271505511595855, "mean_inference_ms": 2.264551787105493, "mean_action_processing_ms": 0.4784444724268389, "mean_env_wait_ms": 0.11485810639136318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017037630081176758, "StateBufferConnector_ms": 0.006489992141723633, "ViewRequirementAgentConnector_ms": 0.393002986907959}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 782.5175780840063, "num_env_steps_trained_throughput_per_sec": 782.5175780840063, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 5776.162, "sample_time_ms": 2238.1, "load_time_ms": 0.392, "load_throughput": 10192719.32, "learn_time_ms": 3518.789, "learn_throughput": 1136.755, "synch_weights_time_ms": 17.553}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 2903, "training_iteration": 32, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-20", "timestamp": 1701995360, "time_this_iter_s": 5.123406887054443, "time_total_s": 195.01076889038086, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 195.01076889038086, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 67.97142857142858, "ram_util_percent": 93.04285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.023313593393141e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 5.639492988586426, "policy_loss": -0.007154025603085756, "vf_loss": 5.646646976470947, "vf_explained_var": 0.6420519351959229, "kl": 0.001246464904397726, "entropy": 0.16025590896606445, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 65.06933333333332, "episode_reward_min": 13.718333333333335, "episode_reward_mean": 26.28629666666667, "episode_len_mean": 51.73, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.169999999999998, 20.93233333333333, 17.054999999999996, 48.738666666666695, 19.837999999999997, 32.89633333333333, 36.702666666666666, 28.020666666666667, 18.887333333333324, 26.579999999999995, 14.555333333333332, 20.71866666666667, 15.194666666666661, 13.718333333333335, 27.052999999999983, 23.03233333333333, 17.831666666666663, 46.47366666666668, 21.744999999999994, 21.16699999999999, 19.85833333333333, 15.561333333333328, 38.50900000000001, 35.84933333333333, 16.310000000000002, 26.996666666666655, 18.823333333333327, 21.321, 23.71899999999999, 27.38666666666665, 28.37366666666667, 16.893666666666658, 33.397, 30.34999999999999, 27.97033333333334, 20.031999999999993, 16.222999999999992, 39.25200000000001, 18.51733333333334, 39.74699999999999, 21.145666666666653, 21.146999999999995, 20.587333333333326, 27.21699999999999, 28.99433333333332, 19.504999999999985, 14.219666666666662, 15.906333333333327, 27.574333333333332, 28.95333333333334, 18.098666666666666, 39.04866666666665, 20.157333333333337, 15.837999999999997, 65.06933333333332, 20.00366666666666, 30.888666666666666, 29.536666666666665, 39.14733333333334, 15.148999999999992, 18.49899999999999, 21.776333333333337, 30.189333333333337, 17.19833333333333, 20.198, 21.334333333333326, 26.756999999999987, 36.195000000000014, 31.967333333333322, 20.819999999999997, 24.701, 27.660333333333323, 19.353333333333335, 25.15366666666666, 22.12166666666666, 25.31966666666667, 52.33933333333334, 45.27966666666671, 29.705333333333304, 20.657666666666653, 49.83266666666668, 36.22233333333333, 20.18533333333332, 21.337999999999997, 15.686999999999998, 15.434666666666663, 21.173666666666666, 18.369999999999994, 24.56266666666667, 23.505333333333326, 23.996999999999996, 16.904999999999994, 32.255, 64.12433333333337, 16.43399999999999, 41.55533333333333, 32.743, 18.637, 39.358, 36.494333333333316], "episode_lengths": [37, 41, 40, 85, 38, 64, 61, 64, 39, 49, 27, 47, 31, 30, 51, 48, 37, 80, 40, 42, 42, 34, 75, 65, 32, 53, 37, 46, 50, 49, 53, 36, 62, 61, 64, 43, 34, 73, 43, 72, 45, 41, 49, 54, 63, 38, 29, 35, 54, 61, 33, 77, 43, 31, 101, 44, 65, 55, 79, 34, 40, 44, 53, 37, 38, 48, 60, 74, 67, 37, 46, 48, 47, 55, 50, 44, 95, 86, 55, 48, 75, 71, 41, 39, 34, 35, 38, 33, 55, 56, 56, 36, 77, 106, 34, 75, 56, 38, 72, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2252583644260377, "mean_inference_ms": 2.256876754868627, "mean_action_processing_ms": 0.4774282508923357, "mean_env_wait_ms": 0.11484033111429018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02083420753479004, "StateBufferConnector_ms": 0.011254549026489258, "ViewRequirementAgentConnector_ms": 0.3813319206237793}}, "episode_reward_max": 65.06933333333332, "episode_reward_min": 13.718333333333335, "episode_reward_mean": 26.28629666666667, "episode_len_mean": 51.73, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.169999999999998, 20.93233333333333, 17.054999999999996, 48.738666666666695, 19.837999999999997, 32.89633333333333, 36.702666666666666, 28.020666666666667, 18.887333333333324, 26.579999999999995, 14.555333333333332, 20.71866666666667, 15.194666666666661, 13.718333333333335, 27.052999999999983, 23.03233333333333, 17.831666666666663, 46.47366666666668, 21.744999999999994, 21.16699999999999, 19.85833333333333, 15.561333333333328, 38.50900000000001, 35.84933333333333, 16.310000000000002, 26.996666666666655, 18.823333333333327, 21.321, 23.71899999999999, 27.38666666666665, 28.37366666666667, 16.893666666666658, 33.397, 30.34999999999999, 27.97033333333334, 20.031999999999993, 16.222999999999992, 39.25200000000001, 18.51733333333334, 39.74699999999999, 21.145666666666653, 21.146999999999995, 20.587333333333326, 27.21699999999999, 28.99433333333332, 19.504999999999985, 14.219666666666662, 15.906333333333327, 27.574333333333332, 28.95333333333334, 18.098666666666666, 39.04866666666665, 20.157333333333337, 15.837999999999997, 65.06933333333332, 20.00366666666666, 30.888666666666666, 29.536666666666665, 39.14733333333334, 15.148999999999992, 18.49899999999999, 21.776333333333337, 30.189333333333337, 17.19833333333333, 20.198, 21.334333333333326, 26.756999999999987, 36.195000000000014, 31.967333333333322, 20.819999999999997, 24.701, 27.660333333333323, 19.353333333333335, 25.15366666666666, 22.12166666666666, 25.31966666666667, 52.33933333333334, 45.27966666666671, 29.705333333333304, 20.657666666666653, 49.83266666666668, 36.22233333333333, 20.18533333333332, 21.337999999999997, 15.686999999999998, 15.434666666666663, 21.173666666666666, 18.369999999999994, 24.56266666666667, 23.505333333333326, 23.996999999999996, 16.904999999999994, 32.255, 64.12433333333337, 16.43399999999999, 41.55533333333333, 32.743, 18.637, 39.358, 36.494333333333316], "episode_lengths": [37, 41, 40, 85, 38, 64, 61, 64, 39, 49, 27, 47, 31, 30, 51, 48, 37, 80, 40, 42, 42, 34, 75, 65, 32, 53, 37, 46, 50, 49, 53, 36, 62, 61, 64, 43, 34, 73, 43, 72, 45, 41, 49, 54, 63, 38, 29, 35, 54, 61, 33, 77, 43, 31, 101, 44, 65, 55, 79, 34, 40, 44, 53, 37, 38, 48, 60, 74, 67, 37, 46, 48, 47, 55, 50, 44, 95, 86, 55, 48, 75, 71, 41, 39, 34, 35, 38, 33, 55, 56, 56, 36, 77, 106, 34, 75, 56, 38, 72, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2252583644260377, "mean_inference_ms": 2.256876754868627, "mean_action_processing_ms": 0.4774282508923357, "mean_env_wait_ms": 0.11484033111429018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02083420753479004, "StateBufferConnector_ms": 0.011254549026489258, "ViewRequirementAgentConnector_ms": 0.3813319206237793}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 576.6579682728432, "num_env_steps_trained_throughput_per_sec": 576.6579682728432, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 5807.703, "sample_time_ms": 2222.218, "load_time_ms": 0.3, "load_throughput": 13330061.974, "learn_time_ms": 3566.929, "learn_throughput": 1121.413, "synch_weights_time_ms": 16.848}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 2979, "training_iteration": 33, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-27", "timestamp": 1701995367, "time_this_iter_s": 6.954516410827637, "time_total_s": 201.9652853012085, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 201.9652853012085, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 67.57000000000001, "ram_util_percent": 93.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0116567966965704e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 6.01275110244751, "policy_loss": -0.006816551089286804, "vf_loss": 6.019567012786865, "vf_explained_var": 0.6094349026679993, "kl": 0.0008363892557099462, "entropy": 0.16051727533340454, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 68.35133333333343, "episode_reward_min": 13.074999999999994, "episode_reward_mean": 27.63079333333333, "episode_len_mean": 53.42, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.33933333333334, 45.27966666666671, 29.705333333333304, 20.657666666666653, 49.83266666666668, 36.22233333333333, 20.18533333333332, 21.337999999999997, 15.686999999999998, 15.434666666666663, 21.173666666666666, 18.369999999999994, 24.56266666666667, 23.505333333333326, 23.996999999999996, 16.904999999999994, 32.255, 64.12433333333337, 16.43399999999999, 41.55533333333333, 32.743, 18.637, 39.358, 36.494333333333316, 27.48666666666665, 43.64500000000002, 15.656999999999995, 19.40499999999999, 13.59033333333333, 38.38733333333333, 27.193333333333335, 28.39299999999999, 24.34899999999999, 17.206333333333326, 16.187999999999995, 22.273666666666657, 28.69466666666666, 43.87333333333332, 32.17633333333333, 23.890999999999995, 20.229333333333333, 14.889999999999997, 36.74366666666668, 14.911999999999994, 21.492333333333328, 20.15533333333332, 48.36100000000005, 46.80366666666668, 30.411666666666672, 44.08133333333334, 29.107999999999983, 28.68733333333332, 29.001333333333342, 26.18633333333333, 68.35133333333343, 25.035666666666657, 31.398666666666653, 32.761, 27.03366666666667, 17.81433333333332, 18.396333333333335, 26.49333333333333, 26.000333333333316, 24.417999999999992, 18.565666666666665, 35.81333333333335, 15.007333333333328, 22.735333333333333, 25.97366666666666, 28.20166666666667, 23.720333333333322, 26.139999999999986, 23.945333333333334, 13.074999999999994, 39.26166666666667, 17.09533333333333, 16.247, 27.41033333333333, 54.55366666666667, 15.434666666666663, 20.247666666666664, 27.550333333333327, 29.471999999999998, 23.371666666666677, 16.389666666666667, 36.292000000000016, 13.563666666666661, 18.026999999999997, 22.750666666666653, 62.092666666666666, 25.158999999999985, 31.44566666666668, 17.317999999999998, 30.04933333333334, 20.535999999999998, 40.71966666666666, 14.198999999999991, 17.44433333333333, 19.609333333333332, 25.68866666666667], "episode_lengths": [95, 86, 55, 48, 75, 71, 41, 39, 34, 35, 38, 33, 55, 56, 56, 36, 77, 106, 34, 75, 56, 38, 72, 68, 53, 85, 30, 44, 28, 77, 61, 56, 54, 30, 37, 42, 49, 79, 59, 46, 41, 31, 80, 29, 41, 41, 89, 76, 60, 84, 61, 63, 51, 46, 117, 46, 57, 66, 57, 34, 34, 55, 55, 51, 50, 83, 29, 47, 58, 46, 47, 53, 47, 30, 70, 38, 30, 58, 94, 35, 36, 50, 57, 42, 36, 67, 28, 38, 45, 93, 58, 47, 35, 47, 43, 59, 29, 41, 47, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2221523534491923, "mean_inference_ms": 2.24999225420755, "mean_action_processing_ms": 0.47704915505916723, "mean_env_wait_ms": 0.11456982813242249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018890380859375, "StateBufferConnector_ms": 0.011753559112548828, "ViewRequirementAgentConnector_ms": 0.3837270736694336}}, "episode_reward_max": 68.35133333333343, "episode_reward_min": 13.074999999999994, "episode_reward_mean": 27.63079333333333, "episode_len_mean": 53.42, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.33933333333334, 45.27966666666671, 29.705333333333304, 20.657666666666653, 49.83266666666668, 36.22233333333333, 20.18533333333332, 21.337999999999997, 15.686999999999998, 15.434666666666663, 21.173666666666666, 18.369999999999994, 24.56266666666667, 23.505333333333326, 23.996999999999996, 16.904999999999994, 32.255, 64.12433333333337, 16.43399999999999, 41.55533333333333, 32.743, 18.637, 39.358, 36.494333333333316, 27.48666666666665, 43.64500000000002, 15.656999999999995, 19.40499999999999, 13.59033333333333, 38.38733333333333, 27.193333333333335, 28.39299999999999, 24.34899999999999, 17.206333333333326, 16.187999999999995, 22.273666666666657, 28.69466666666666, 43.87333333333332, 32.17633333333333, 23.890999999999995, 20.229333333333333, 14.889999999999997, 36.74366666666668, 14.911999999999994, 21.492333333333328, 20.15533333333332, 48.36100000000005, 46.80366666666668, 30.411666666666672, 44.08133333333334, 29.107999999999983, 28.68733333333332, 29.001333333333342, 26.18633333333333, 68.35133333333343, 25.035666666666657, 31.398666666666653, 32.761, 27.03366666666667, 17.81433333333332, 18.396333333333335, 26.49333333333333, 26.000333333333316, 24.417999999999992, 18.565666666666665, 35.81333333333335, 15.007333333333328, 22.735333333333333, 25.97366666666666, 28.20166666666667, 23.720333333333322, 26.139999999999986, 23.945333333333334, 13.074999999999994, 39.26166666666667, 17.09533333333333, 16.247, 27.41033333333333, 54.55366666666667, 15.434666666666663, 20.247666666666664, 27.550333333333327, 29.471999999999998, 23.371666666666677, 16.389666666666667, 36.292000000000016, 13.563666666666661, 18.026999999999997, 22.750666666666653, 62.092666666666666, 25.158999999999985, 31.44566666666668, 17.317999999999998, 30.04933333333334, 20.535999999999998, 40.71966666666666, 14.198999999999991, 17.44433333333333, 19.609333333333332, 25.68866666666667], "episode_lengths": [95, 86, 55, 48, 75, 71, 41, 39, 34, 35, 38, 33, 55, 56, 56, 36, 77, 106, 34, 75, 56, 38, 72, 68, 53, 85, 30, 44, 28, 77, 61, 56, 54, 30, 37, 42, 49, 79, 59, 46, 41, 31, 80, 29, 41, 41, 89, 76, 60, 84, 61, 63, 51, 46, 117, 46, 57, 66, 57, 34, 34, 55, 55, 51, 50, 83, 29, 47, 58, 46, 47, 53, 47, 30, 70, 38, 30, 58, 94, 35, 36, 50, 57, 42, 36, 67, 28, 38, 45, 93, 58, 47, 35, 47, 43, 59, 29, 41, 47, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2221523534491923, "mean_inference_ms": 2.24999225420755, "mean_action_processing_ms": 0.47704915505916723, "mean_env_wait_ms": 0.11456982813242249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018890380859375, "StateBufferConnector_ms": 0.011753559112548828, "ViewRequirementAgentConnector_ms": 0.3837270736694336}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.2282126887465, "num_env_steps_trained_throughput_per_sec": 813.2282126887465, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 5800.473, "sample_time_ms": 2220.432, "load_time_ms": 0.2, "load_throughput": 19989534.136, "learn_time_ms": 3561.714, "learn_throughput": 1123.055, "synch_weights_time_ms": 16.559}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 3055, "training_iteration": 34, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-32", "timestamp": 1701995372, "time_this_iter_s": 4.9286744594573975, "time_total_s": 206.8939597606659, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 206.8939597606659, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 71.12857142857143, "ram_util_percent": 93.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0058283983482852e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 5.495802879333496, "policy_loss": -0.007986817508935928, "vf_loss": 5.503789901733398, "vf_explained_var": 0.6528451442718506, "kl": 0.0012863887241110206, "entropy": 0.1555284559726715, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 62.092666666666666, "episode_reward_min": 11.805333333333332, "episode_reward_mean": 24.707609999999995, "episode_len_mean": 47.69, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.371666666666677, 16.389666666666667, 36.292000000000016, 13.563666666666661, 18.026999999999997, 22.750666666666653, 62.092666666666666, 25.158999999999985, 31.44566666666668, 17.317999999999998, 30.04933333333334, 20.535999999999998, 40.71966666666666, 14.198999999999991, 17.44433333333333, 19.609333333333332, 25.68866666666667, 15.625333333333327, 16.97533333333333, 14.360666666666662, 17.828999999999997, 20.152666666666647, 16.104666666666667, 40.35000000000001, 16.49833333333333, 35.54733333333335, 48.07099999999996, 20.757666666666665, 30.576, 35.124666666666656, 21.17233333333333, 27.043666666666667, 60.71366666666664, 42.007000000000005, 16.839666666666663, 29.939999999999987, 16.64033333333333, 18.355333333333324, 15.225666666666665, 18.231, 16.46, 39.172000000000004, 27.871333333333332, 16.371999999999996, 15.932666666666668, 24.225333333333328, 17.578333333333337, 19.132999999999992, 46.91533333333334, 35.653000000000006, 15.237999999999998, 18.12466666666666, 18.815999999999992, 27.194333333333333, 51.956666666666656, 13.685999999999996, 18.972, 16.450999999999993, 40.9063333333333, 19.453999999999994, 17.282333333333327, 20.822999999999993, 15.364999999999997, 46.874999999999986, 31.204333333333334, 14.386000000000001, 18.495, 16.75366666666666, 21.11599999999999, 15.78733333333333, 15.917999999999996, 13.680333333333328, 17.856333333333332, 20.067999999999994, 15.31233333333333, 25.01533333333333, 42.93133333333334, 29.217333333333315, 25.700333333333333, 22.878333333333323, 23.343666666666667, 26.943333333333324, 15.282000000000002, 29.973666666666663, 21.532999999999987, 40.821333333333335, 42.66333333333333, 16.21366666666666, 14.938999999999997, 42.67766666666668, 35.91133333333333, 22.32399999999999, 16.45933333333333, 11.805333333333332, 17.77566666666666, 25.029333333333334, 21.178333333333335, 24.612999999999992, 22.953666666666663, 22.745333333333335], "episode_lengths": [42, 36, 67, 28, 38, 45, 93, 58, 47, 35, 47, 43, 59, 29, 41, 47, 55, 36, 35, 27, 40, 41, 29, 79, 32, 65, 78, 36, 65, 59, 50, 48, 101, 80, 34, 67, 32, 39, 32, 36, 34, 64, 67, 35, 31, 51, 45, 42, 75, 58, 33, 39, 37, 60, 94, 27, 39, 34, 71, 33, 33, 42, 32, 92, 56, 30, 40, 35, 41, 33, 33, 26, 36, 39, 36, 45, 89, 53, 62, 42, 50, 45, 29, 54, 40, 77, 77, 29, 34, 86, 59, 52, 35, 23, 35, 45, 40, 44, 52, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2214173428283452, "mean_inference_ms": 2.2398178967444236, "mean_action_processing_ms": 0.4776986745283155, "mean_env_wait_ms": 0.11423425277800893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016791105270385742, "StateBufferConnector_ms": 0.014399290084838867, "ViewRequirementAgentConnector_ms": 0.39177465438842773}}, "episode_reward_max": 62.092666666666666, "episode_reward_min": 11.805333333333332, "episode_reward_mean": 24.707609999999995, "episode_len_mean": 47.69, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.371666666666677, 16.389666666666667, 36.292000000000016, 13.563666666666661, 18.026999999999997, 22.750666666666653, 62.092666666666666, 25.158999999999985, 31.44566666666668, 17.317999999999998, 30.04933333333334, 20.535999999999998, 40.71966666666666, 14.198999999999991, 17.44433333333333, 19.609333333333332, 25.68866666666667, 15.625333333333327, 16.97533333333333, 14.360666666666662, 17.828999999999997, 20.152666666666647, 16.104666666666667, 40.35000000000001, 16.49833333333333, 35.54733333333335, 48.07099999999996, 20.757666666666665, 30.576, 35.124666666666656, 21.17233333333333, 27.043666666666667, 60.71366666666664, 42.007000000000005, 16.839666666666663, 29.939999999999987, 16.64033333333333, 18.355333333333324, 15.225666666666665, 18.231, 16.46, 39.172000000000004, 27.871333333333332, 16.371999999999996, 15.932666666666668, 24.225333333333328, 17.578333333333337, 19.132999999999992, 46.91533333333334, 35.653000000000006, 15.237999999999998, 18.12466666666666, 18.815999999999992, 27.194333333333333, 51.956666666666656, 13.685999999999996, 18.972, 16.450999999999993, 40.9063333333333, 19.453999999999994, 17.282333333333327, 20.822999999999993, 15.364999999999997, 46.874999999999986, 31.204333333333334, 14.386000000000001, 18.495, 16.75366666666666, 21.11599999999999, 15.78733333333333, 15.917999999999996, 13.680333333333328, 17.856333333333332, 20.067999999999994, 15.31233333333333, 25.01533333333333, 42.93133333333334, 29.217333333333315, 25.700333333333333, 22.878333333333323, 23.343666666666667, 26.943333333333324, 15.282000000000002, 29.973666666666663, 21.532999999999987, 40.821333333333335, 42.66333333333333, 16.21366666666666, 14.938999999999997, 42.67766666666668, 35.91133333333333, 22.32399999999999, 16.45933333333333, 11.805333333333332, 17.77566666666666, 25.029333333333334, 21.178333333333335, 24.612999999999992, 22.953666666666663, 22.745333333333335], "episode_lengths": [42, 36, 67, 28, 38, 45, 93, 58, 47, 35, 47, 43, 59, 29, 41, 47, 55, 36, 35, 27, 40, 41, 29, 79, 32, 65, 78, 36, 65, 59, 50, 48, 101, 80, 34, 67, 32, 39, 32, 36, 34, 64, 67, 35, 31, 51, 45, 42, 75, 58, 33, 39, 37, 60, 94, 27, 39, 34, 71, 33, 33, 42, 32, 92, 56, 30, 40, 35, 41, 33, 33, 26, 36, 39, 36, 45, 89, 53, 62, 42, 50, 45, 29, 54, 40, 77, 77, 29, 34, 86, 59, 52, 35, 23, 35, 45, 40, 44, 52, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2214173428283452, "mean_inference_ms": 2.2398178967444236, "mean_action_processing_ms": 0.4776986745283155, "mean_env_wait_ms": 0.11423425277800893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016791105270385742, "StateBufferConnector_ms": 0.014399290084838867, "ViewRequirementAgentConnector_ms": 0.39177465438842773}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.1664420358763, "num_env_steps_trained_throughput_per_sec": 811.1664420358763, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 5654.506, "sample_time_ms": 2216.142, "load_time_ms": 0.2, "load_throughput": 19989534.136, "learn_time_ms": 3420.408, "learn_throughput": 1169.451, "synch_weights_time_ms": 16.187}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 3138, "training_iteration": 35, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-37", "timestamp": 1701995377, "time_this_iter_s": 4.949183225631714, "time_total_s": 211.8431429862976, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 211.8431429862976, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 69.18571428571428, "ram_util_percent": 93.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.029141991741426e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 6.0015950202941895, "policy_loss": -0.006069378927350044, "vf_loss": 6.007664203643799, "vf_explained_var": 0.5961524248123169, "kl": 0.001359765650704503, "entropy": 0.16573171317577362, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 76.77133333333335, "episode_reward_min": 11.805333333333332, "episode_reward_mean": 27.913939999999997, "episode_len_mean": 53.67, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.31233333333333, 25.01533333333333, 42.93133333333334, 29.217333333333315, 25.700333333333333, 22.878333333333323, 23.343666666666667, 26.943333333333324, 15.282000000000002, 29.973666666666663, 21.532999999999987, 40.821333333333335, 42.66333333333333, 16.21366666666666, 14.938999999999997, 42.67766666666668, 35.91133333333333, 22.32399999999999, 16.45933333333333, 11.805333333333332, 17.77566666666666, 25.029333333333334, 21.178333333333335, 24.612999999999992, 22.953666666666663, 22.745333333333335, 33.92900000000001, 21.69033333333333, 25.735666666666663, 16.76566666666666, 56.55666666666666, 17.63799999999999, 16.243666666666666, 24.979333333333333, 23.86466666666666, 35.003666666666675, 35.937666666666644, 31.46633333333334, 25.134, 32.87966666666665, 31.302999999999997, 18.32466666666666, 31.953666666666663, 55.65199999999992, 35.157, 17.56066666666666, 27.234666666666666, 47.137666666666675, 24.96633333333333, 18.565666666666658, 29.566, 22.958666666666673, 30.030666666666654, 27.382, 29.473666666666663, 34.17166666666666, 25.22899999999998, 23.30866666666667, 41.40033333333332, 20.94966666666666, 17.156333333333325, 18.870333333333328, 76.77133333333335, 16.951333333333327, 20.318333333333324, 15.736999999999993, 34.93133333333332, 36.26899999999998, 15.660333333333329, 19.62366666666666, 26.05433333333333, 19.193333333333324, 17.68, 29.492999999999988, 30.120333333333328, 39.78966666666665, 21.75633333333333, 28.999666666666663, 65.52966666666661, 20.838666666666658, 15.414333333333335, 22.777, 23.640333333333338, 28.221666666666668, 18.040333333333326, 22.162333333333336, 25.861999999999988, 23.140333333333334, 27.293666666666663, 26.611999999999995, 30.220666666666666, 16.785333333333327, 26.01633333333334, 31.686999999999998, 46.757000000000026, 40.97766666666667, 37.024666666666675, 40.134, 48.95166666666666, 21.540666666666656], "episode_lengths": [36, 45, 89, 53, 62, 42, 50, 45, 29, 54, 40, 77, 77, 29, 34, 86, 59, 52, 35, 23, 35, 45, 40, 44, 52, 48, 60, 42, 56, 34, 97, 39, 34, 58, 41, 62, 74, 64, 49, 58, 66, 37, 52, 81, 62, 39, 49, 88, 50, 38, 61, 47, 63, 55, 65, 67, 62, 47, 64, 42, 34, 38, 145, 37, 47, 32, 69, 65, 36, 45, 61, 37, 32, 56, 52, 69, 46, 54, 102, 37, 34, 48, 42, 50, 36, 39, 57, 46, 52, 45, 55, 37, 54, 60, 86, 77, 63, 79, 90, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2184080544452816, "mean_inference_ms": 2.235280407836658, "mean_action_processing_ms": 0.47709801210557673, "mean_env_wait_ms": 0.11432002418299719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0160677433013916, "StateBufferConnector_ms": 0.00887751579284668, "ViewRequirementAgentConnector_ms": 0.38884592056274414}}, "episode_reward_max": 76.77133333333335, "episode_reward_min": 11.805333333333332, "episode_reward_mean": 27.913939999999997, "episode_len_mean": 53.67, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.31233333333333, 25.01533333333333, 42.93133333333334, 29.217333333333315, 25.700333333333333, 22.878333333333323, 23.343666666666667, 26.943333333333324, 15.282000000000002, 29.973666666666663, 21.532999999999987, 40.821333333333335, 42.66333333333333, 16.21366666666666, 14.938999999999997, 42.67766666666668, 35.91133333333333, 22.32399999999999, 16.45933333333333, 11.805333333333332, 17.77566666666666, 25.029333333333334, 21.178333333333335, 24.612999999999992, 22.953666666666663, 22.745333333333335, 33.92900000000001, 21.69033333333333, 25.735666666666663, 16.76566666666666, 56.55666666666666, 17.63799999999999, 16.243666666666666, 24.979333333333333, 23.86466666666666, 35.003666666666675, 35.937666666666644, 31.46633333333334, 25.134, 32.87966666666665, 31.302999999999997, 18.32466666666666, 31.953666666666663, 55.65199999999992, 35.157, 17.56066666666666, 27.234666666666666, 47.137666666666675, 24.96633333333333, 18.565666666666658, 29.566, 22.958666666666673, 30.030666666666654, 27.382, 29.473666666666663, 34.17166666666666, 25.22899999999998, 23.30866666666667, 41.40033333333332, 20.94966666666666, 17.156333333333325, 18.870333333333328, 76.77133333333335, 16.951333333333327, 20.318333333333324, 15.736999999999993, 34.93133333333332, 36.26899999999998, 15.660333333333329, 19.62366666666666, 26.05433333333333, 19.193333333333324, 17.68, 29.492999999999988, 30.120333333333328, 39.78966666666665, 21.75633333333333, 28.999666666666663, 65.52966666666661, 20.838666666666658, 15.414333333333335, 22.777, 23.640333333333338, 28.221666666666668, 18.040333333333326, 22.162333333333336, 25.861999999999988, 23.140333333333334, 27.293666666666663, 26.611999999999995, 30.220666666666666, 16.785333333333327, 26.01633333333334, 31.686999999999998, 46.757000000000026, 40.97766666666667, 37.024666666666675, 40.134, 48.95166666666666, 21.540666666666656], "episode_lengths": [36, 45, 89, 53, 62, 42, 50, 45, 29, 54, 40, 77, 77, 29, 34, 86, 59, 52, 35, 23, 35, 45, 40, 44, 52, 48, 60, 42, 56, 34, 97, 39, 34, 58, 41, 62, 74, 64, 49, 58, 66, 37, 52, 81, 62, 39, 49, 88, 50, 38, 61, 47, 63, 55, 65, 67, 62, 47, 64, 42, 34, 38, 145, 37, 47, 32, 69, 65, 36, 45, 61, 37, 32, 56, 52, 69, 46, 54, 102, 37, 34, 48, 42, 50, 36, 39, 57, 46, 52, 45, 55, 37, 54, 60, 86, 77, 63, 79, 90, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2184080544452816, "mean_inference_ms": 2.235280407836658, "mean_action_processing_ms": 0.47709801210557673, "mean_env_wait_ms": 0.11432002418299719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0160677433013916, "StateBufferConnector_ms": 0.00887751579284668, "ViewRequirementAgentConnector_ms": 0.38884592056274414}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 628.099900030186, "num_env_steps_trained_throughput_per_sec": 628.099900030186, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 5789.822, "sample_time_ms": 2215.407, "load_time_ms": 0.2, "load_throughput": 19989534.136, "learn_time_ms": 3556.362, "learn_throughput": 1124.745, "synch_weights_time_ms": 16.285}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 3212, "training_iteration": 36, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-44", "timestamp": 1701995384, "time_this_iter_s": 6.378419637680054, "time_total_s": 218.22156262397766, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 218.22156262397766, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 67.33333333333333, "ram_util_percent": 93.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.514570995870713e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 5.347667217254639, "policy_loss": -0.005760666914284229, "vf_loss": 5.353427886962891, "vf_explained_var": 0.6068555116653442, "kl": 0.0011983390431851149, "entropy": 0.1609315425157547, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 65.83033333333337, "episode_reward_min": 13.737666666666668, "episode_reward_mean": 27.04268, "episode_len_mean": 51.7, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.52966666666661, 20.838666666666658, 15.414333333333335, 22.777, 23.640333333333338, 28.221666666666668, 18.040333333333326, 22.162333333333336, 25.861999999999988, 23.140333333333334, 27.293666666666663, 26.611999999999995, 30.220666666666666, 16.785333333333327, 26.01633333333334, 31.686999999999998, 46.757000000000026, 40.97766666666667, 37.024666666666675, 40.134, 48.95166666666666, 21.540666666666656, 21.672666666666654, 39.57866666666668, 21.652666666666658, 65.83033333333337, 20.557666666666666, 17.443999999999996, 25.99166666666666, 25.396666666666665, 30.599999999999994, 34.382, 25.298999999999992, 61.203, 17.33466666666666, 13.737666666666668, 46.27233333333333, 17.47799999999999, 17.874333333333333, 19.265333333333324, 27.827333333333335, 25.85233333333334, 25.387333333333334, 42.57533333333331, 36.04266666666666, 20.144999999999992, 31.152999999999984, 31.298333333333336, 20.600666666666665, 21.067666666666653, 14.45366666666666, 17.260333333333328, 43.34033333333335, 20.67666666666667, 20.798999999999992, 41.471000000000004, 23.212999999999994, 45.06066666666664, 33.39600000000001, 18.988999999999997, 15.312999999999995, 14.190333333333328, 29.247666666666664, 37.199999999999996, 44.03533333333333, 28.126666666666644, 17.739666666666658, 37.832999999999984, 41.26800000000003, 18.104999999999993, 27.261, 13.965999999999996, 21.999000000000002, 19.293333333333326, 22.240999999999996, 25.040333333333336, 18.328333333333337, 29.12199999999999, 17.647999999999996, 16.24866666666666, 18.547666666666668, 19.92233333333333, 30.159, 16.92266666666666, 18.595, 29.067666666666675, 40.797, 17.122666666666664, 18.201999999999995, 16.80033333333333, 34.45466666666665, 24.745333333333328, 35.60266666666668, 17.081666666666667, 18.864333333333324, 16.753999999999998, 20.423333333333325, 16.498333333333335, 18.39233333333334, 39.30133333333335], "episode_lengths": [102, 37, 34, 48, 42, 50, 36, 39, 57, 46, 52, 45, 55, 37, 54, 60, 86, 77, 63, 79, 90, 39, 41, 58, 47, 108, 46, 38, 63, 58, 57, 53, 51, 98, 34, 26, 94, 39, 36, 35, 59, 50, 57, 75, 75, 38, 56, 60, 45, 44, 32, 33, 75, 39, 38, 66, 53, 71, 55, 38, 33, 29, 55, 57, 69, 63, 32, 62, 77, 37, 60, 29, 49, 37, 51, 44, 42, 57, 41, 31, 41, 42, 58, 36, 41, 56, 80, 31, 39, 32, 73, 55, 74, 32, 36, 33, 41, 34, 33, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2171116572625105, "mean_inference_ms": 2.228064523969748, "mean_action_processing_ms": 0.4765349084282994, "mean_env_wait_ms": 0.11434580009332082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016781091690063477, "StateBufferConnector_ms": 0.01513218879699707, "ViewRequirementAgentConnector_ms": 0.38116908073425293}}, "episode_reward_max": 65.83033333333337, "episode_reward_min": 13.737666666666668, "episode_reward_mean": 27.04268, "episode_len_mean": 51.7, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.52966666666661, 20.838666666666658, 15.414333333333335, 22.777, 23.640333333333338, 28.221666666666668, 18.040333333333326, 22.162333333333336, 25.861999999999988, 23.140333333333334, 27.293666666666663, 26.611999999999995, 30.220666666666666, 16.785333333333327, 26.01633333333334, 31.686999999999998, 46.757000000000026, 40.97766666666667, 37.024666666666675, 40.134, 48.95166666666666, 21.540666666666656, 21.672666666666654, 39.57866666666668, 21.652666666666658, 65.83033333333337, 20.557666666666666, 17.443999999999996, 25.99166666666666, 25.396666666666665, 30.599999999999994, 34.382, 25.298999999999992, 61.203, 17.33466666666666, 13.737666666666668, 46.27233333333333, 17.47799999999999, 17.874333333333333, 19.265333333333324, 27.827333333333335, 25.85233333333334, 25.387333333333334, 42.57533333333331, 36.04266666666666, 20.144999999999992, 31.152999999999984, 31.298333333333336, 20.600666666666665, 21.067666666666653, 14.45366666666666, 17.260333333333328, 43.34033333333335, 20.67666666666667, 20.798999999999992, 41.471000000000004, 23.212999999999994, 45.06066666666664, 33.39600000000001, 18.988999999999997, 15.312999999999995, 14.190333333333328, 29.247666666666664, 37.199999999999996, 44.03533333333333, 28.126666666666644, 17.739666666666658, 37.832999999999984, 41.26800000000003, 18.104999999999993, 27.261, 13.965999999999996, 21.999000000000002, 19.293333333333326, 22.240999999999996, 25.040333333333336, 18.328333333333337, 29.12199999999999, 17.647999999999996, 16.24866666666666, 18.547666666666668, 19.92233333333333, 30.159, 16.92266666666666, 18.595, 29.067666666666675, 40.797, 17.122666666666664, 18.201999999999995, 16.80033333333333, 34.45466666666665, 24.745333333333328, 35.60266666666668, 17.081666666666667, 18.864333333333324, 16.753999999999998, 20.423333333333325, 16.498333333333335, 18.39233333333334, 39.30133333333335], "episode_lengths": [102, 37, 34, 48, 42, 50, 36, 39, 57, 46, 52, 45, 55, 37, 54, 60, 86, 77, 63, 79, 90, 39, 41, 58, 47, 108, 46, 38, 63, 58, 57, 53, 51, 98, 34, 26, 94, 39, 36, 35, 59, 50, 57, 75, 75, 38, 56, 60, 45, 44, 32, 33, 75, 39, 38, 66, 53, 71, 55, 38, 33, 29, 55, 57, 69, 63, 32, 62, 77, 37, 60, 29, 49, 37, 51, 44, 42, 57, 41, 31, 41, 42, 58, 36, 41, 56, 80, 31, 39, 32, 73, 55, 74, 32, 36, 33, 41, 34, 33, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2171116572625105, "mean_inference_ms": 2.228064523969748, "mean_action_processing_ms": 0.4765349084282994, "mean_env_wait_ms": 0.11434580009332082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016781091690063477, "StateBufferConnector_ms": 0.01513218879699707, "ViewRequirementAgentConnector_ms": 0.38116908073425293}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 763.9128169825144, "num_env_steps_trained_throughput_per_sec": 763.9128169825144, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 5797.174, "sample_time_ms": 2220.558, "load_time_ms": 0.3, "load_throughput": 13332180.547, "learn_time_ms": 3557.884, "learn_throughput": 1124.264, "synch_weights_time_ms": 16.882}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 3290, "training_iteration": 37, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-49", "timestamp": 1701995389, "time_this_iter_s": 5.248226165771484, "time_total_s": 223.46978878974915, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 223.46978878974915, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 68.95714285714286, "ram_util_percent": 93.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2572854979353565e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 5.810029029846191, "policy_loss": -0.008023872040212154, "vf_loss": 5.818052768707275, "vf_explained_var": 0.5688675045967102, "kl": 0.0017581927822902799, "entropy": 0.15813684463500977, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 77.28966666666663, "episode_reward_min": 14.659666666666666, "episode_reward_mean": 27.55947333333333, "episode_len_mean": 53.05, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.293333333333326, 22.240999999999996, 25.040333333333336, 18.328333333333337, 29.12199999999999, 17.647999999999996, 16.24866666666666, 18.547666666666668, 19.92233333333333, 30.159, 16.92266666666666, 18.595, 29.067666666666675, 40.797, 17.122666666666664, 18.201999999999995, 16.80033333333333, 34.45466666666665, 24.745333333333328, 35.60266666666668, 17.081666666666667, 18.864333333333324, 16.753999999999998, 20.423333333333325, 16.498333333333335, 18.39233333333334, 39.30133333333335, 30.16, 19.822666666666656, 58.246666666666684, 15.75233333333333, 39.666999999999994, 28.383, 31.414999999999992, 19.512333333333327, 26.503000000000004, 40.17366666666667, 26.68066666666666, 20.471333333333327, 21.011999999999997, 53.89766666666669, 14.659666666666666, 26.667000000000016, 32.600333333333325, 18.726000000000003, 18.79033333333333, 24.600666666666662, 18.642666666666663, 17.28033333333333, 32.979666666666674, 17.187666666666665, 32.221666666666685, 63.47266666666673, 35.09266666666666, 61.008666666666684, 22.882999999999992, 17.357666666666663, 25.97899999999999, 23.395666666666664, 30.10033333333333, 22.906666666666652, 19.84233333333333, 77.28966666666663, 17.137999999999998, 17.755999999999993, 27.682333333333318, 48.94966666666668, 22.910999999999994, 25.898333333333323, 34.12766666666667, 32.44366666666668, 21.592666666666656, 24.080666666666655, 49.95033333333333, 19.481666666666666, 18.127666666666666, 22.790999999999993, 20.830999999999996, 16.497333333333327, 26.32633333333332, 49.37033333333332, 24.023333333333323, 55.66433333333329, 16.726666666666663, 21.345000000000002, 34.096333333333334, 17.161666666666658, 19.303333333333327, 46.167000000000044, 17.42366666666666, 17.979666666666663, 43.17466666666665, 43.00533333333334, 24.139666666666656, 19.606333333333335, 24.516333333333318, 31.790333333333326, 39.19233333333334, 46.31833333333333, 16.79966666666666], "episode_lengths": [37, 51, 44, 42, 57, 41, 31, 41, 42, 58, 36, 41, 56, 80, 31, 39, 32, 73, 55, 74, 32, 36, 33, 41, 34, 33, 79, 60, 39, 103, 30, 64, 55, 62, 38, 49, 66, 47, 45, 41, 100, 32, 50, 62, 31, 44, 53, 37, 32, 66, 37, 62, 116, 63, 111, 44, 34, 63, 44, 50, 47, 43, 115, 34, 31, 60, 84, 48, 54, 60, 60, 45, 49, 90, 40, 36, 54, 46, 33, 48, 85, 52, 102, 35, 38, 70, 32, 35, 90, 34, 34, 89, 65, 55, 46, 46, 53, 74, 80, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2145865160997475, "mean_inference_ms": 2.2217784710529993, "mean_action_processing_ms": 0.47635501420217286, "mean_env_wait_ms": 0.11426039958956348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024980545043945312, "StateBufferConnector_ms": 0.011103153228759766, "ViewRequirementAgentConnector_ms": 0.3724195957183838}}, "episode_reward_max": 77.28966666666663, "episode_reward_min": 14.659666666666666, "episode_reward_mean": 27.55947333333333, "episode_len_mean": 53.05, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.293333333333326, 22.240999999999996, 25.040333333333336, 18.328333333333337, 29.12199999999999, 17.647999999999996, 16.24866666666666, 18.547666666666668, 19.92233333333333, 30.159, 16.92266666666666, 18.595, 29.067666666666675, 40.797, 17.122666666666664, 18.201999999999995, 16.80033333333333, 34.45466666666665, 24.745333333333328, 35.60266666666668, 17.081666666666667, 18.864333333333324, 16.753999999999998, 20.423333333333325, 16.498333333333335, 18.39233333333334, 39.30133333333335, 30.16, 19.822666666666656, 58.246666666666684, 15.75233333333333, 39.666999999999994, 28.383, 31.414999999999992, 19.512333333333327, 26.503000000000004, 40.17366666666667, 26.68066666666666, 20.471333333333327, 21.011999999999997, 53.89766666666669, 14.659666666666666, 26.667000000000016, 32.600333333333325, 18.726000000000003, 18.79033333333333, 24.600666666666662, 18.642666666666663, 17.28033333333333, 32.979666666666674, 17.187666666666665, 32.221666666666685, 63.47266666666673, 35.09266666666666, 61.008666666666684, 22.882999999999992, 17.357666666666663, 25.97899999999999, 23.395666666666664, 30.10033333333333, 22.906666666666652, 19.84233333333333, 77.28966666666663, 17.137999999999998, 17.755999999999993, 27.682333333333318, 48.94966666666668, 22.910999999999994, 25.898333333333323, 34.12766666666667, 32.44366666666668, 21.592666666666656, 24.080666666666655, 49.95033333333333, 19.481666666666666, 18.127666666666666, 22.790999999999993, 20.830999999999996, 16.497333333333327, 26.32633333333332, 49.37033333333332, 24.023333333333323, 55.66433333333329, 16.726666666666663, 21.345000000000002, 34.096333333333334, 17.161666666666658, 19.303333333333327, 46.167000000000044, 17.42366666666666, 17.979666666666663, 43.17466666666665, 43.00533333333334, 24.139666666666656, 19.606333333333335, 24.516333333333318, 31.790333333333326, 39.19233333333334, 46.31833333333333, 16.79966666666666], "episode_lengths": [37, 51, 44, 42, 57, 41, 31, 41, 42, 58, 36, 41, 56, 80, 31, 39, 32, 73, 55, 74, 32, 36, 33, 41, 34, 33, 79, 60, 39, 103, 30, 64, 55, 62, 38, 49, 66, 47, 45, 41, 100, 32, 50, 62, 31, 44, 53, 37, 32, 66, 37, 62, 116, 63, 111, 44, 34, 63, 44, 50, 47, 43, 115, 34, 31, 60, 84, 48, 54, 60, 60, 45, 49, 90, 40, 36, 54, 46, 33, 48, 85, 52, 102, 35, 38, 70, 32, 35, 90, 34, 34, 89, 65, 55, 46, 46, 53, 74, 80, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2145865160997475, "mean_inference_ms": 2.2217784710529993, "mean_action_processing_ms": 0.47635501420217286, "mean_env_wait_ms": 0.11426039958956348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024980545043945312, "StateBufferConnector_ms": 0.011103153228759766, "ViewRequirementAgentConnector_ms": 0.3724195957183838}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 823.0756494263884, "num_env_steps_trained_throughput_per_sec": 823.0756494263884, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 5777.63, "sample_time_ms": 2208.503, "load_time_ms": 0.25, "load_throughput": 16007266.482, "learn_time_ms": 3550.347, "learn_throughput": 1126.651, "synch_weights_time_ms": 16.881}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 3363, "training_iteration": 38, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-54", "timestamp": 1701995394, "time_this_iter_s": 4.8764026165008545, "time_total_s": 228.34619140625, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 228.34619140625, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 69.52857142857144, "ram_util_percent": 93.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.286427489676782e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 5.767848014831543, "policy_loss": -0.0027284196112304926, "vf_loss": 5.770576000213623, "vf_explained_var": 0.5948750972747803, "kl": 0.0017273385310545564, "entropy": 0.12188766896724701, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 66.39366666666668, "episode_reward_min": 13.427999999999995, "episode_reward_mean": 26.972009999999997, "episode_len_mean": 51.84, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.497333333333327, 26.32633333333332, 49.37033333333332, 24.023333333333323, 55.66433333333329, 16.726666666666663, 21.345000000000002, 34.096333333333334, 17.161666666666658, 19.303333333333327, 46.167000000000044, 17.42366666666666, 17.979666666666663, 43.17466666666665, 43.00533333333334, 24.139666666666656, 19.606333333333335, 24.516333333333318, 31.790333333333326, 39.19233333333334, 46.31833333333333, 16.79966666666666, 30.627333333333343, 22.387666666666664, 30.698666666666664, 30.612333333333336, 20.433666666666664, 50.833666666666694, 22.066666666666652, 18.270999999999994, 21.506666666666657, 18.085333333333327, 37.12799999999999, 20.053999999999995, 23.467666666666666, 24.148, 17.907, 20.406333333333322, 46.04866666666667, 41.00233333333333, 15.300999999999997, 23.221666666666653, 48.75700000000001, 22.190333333333335, 18.099999999999998, 19.351666666666667, 27.431333333333335, 13.427999999999995, 32.769, 53.401333333333355, 30.21733333333333, 15.81, 36.57500000000001, 13.460333333333333, 18.517333333333326, 25.83533333333332, 29.508000000000003, 17.898999999999994, 15.641333333333332, 15.051666666666662, 30.019666666666662, 27.033000000000005, 24.09433333333333, 23.461666666666673, 17.54533333333333, 18.759999999999998, 22.594999999999995, 17.163333333333323, 33.75466666666667, 20.625666666666653, 20.651333333333326, 22.486333333333327, 17.888666666666666, 27.060333333333325, 28.112666666666666, 14.702999999999992, 26.27433333333333, 15.06733333333333, 21.042333333333325, 16.65033333333333, 20.398666666666667, 16.092999999999996, 40.65166666666666, 43.34966666666668, 38.20466666666666, 17.262333333333327, 44.22366666666666, 66.39366666666668, 17.914333333333335, 16.848333333333333, 16.05666666666666, 20.405666666666654, 18.804333333333325, 24.258999999999986, 20.574333333333325, 19.725333333333325, 64.75100000000005, 30.343999999999998, 55.594666666666704, 21.576999999999988], "episode_lengths": [33, 48, 85, 52, 102, 35, 38, 70, 32, 35, 90, 34, 34, 89, 65, 55, 46, 46, 53, 74, 80, 34, 59, 46, 67, 61, 42, 95, 47, 33, 45, 35, 61, 43, 46, 53, 34, 41, 97, 84, 32, 50, 83, 51, 39, 42, 51, 26, 70, 94, 51, 35, 62, 30, 33, 49, 51, 34, 31, 32, 54, 46, 46, 50, 37, 35, 42, 39, 61, 50, 39, 38, 45, 50, 51, 30, 46, 29, 41, 33, 43, 31, 79, 88, 59, 36, 78, 114, 38, 34, 35, 43, 36, 54, 47, 37, 108, 57, 99, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2130251766285363, "mean_inference_ms": 2.213861303555726, "mean_action_processing_ms": 0.47635027029475, "mean_env_wait_ms": 0.11421756085549921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024180889129638672, "StateBufferConnector_ms": 0.01648688316345215, "ViewRequirementAgentConnector_ms": 0.3928534984588623}}, "episode_reward_max": 66.39366666666668, "episode_reward_min": 13.427999999999995, "episode_reward_mean": 26.972009999999997, "episode_len_mean": 51.84, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.497333333333327, 26.32633333333332, 49.37033333333332, 24.023333333333323, 55.66433333333329, 16.726666666666663, 21.345000000000002, 34.096333333333334, 17.161666666666658, 19.303333333333327, 46.167000000000044, 17.42366666666666, 17.979666666666663, 43.17466666666665, 43.00533333333334, 24.139666666666656, 19.606333333333335, 24.516333333333318, 31.790333333333326, 39.19233333333334, 46.31833333333333, 16.79966666666666, 30.627333333333343, 22.387666666666664, 30.698666666666664, 30.612333333333336, 20.433666666666664, 50.833666666666694, 22.066666666666652, 18.270999999999994, 21.506666666666657, 18.085333333333327, 37.12799999999999, 20.053999999999995, 23.467666666666666, 24.148, 17.907, 20.406333333333322, 46.04866666666667, 41.00233333333333, 15.300999999999997, 23.221666666666653, 48.75700000000001, 22.190333333333335, 18.099999999999998, 19.351666666666667, 27.431333333333335, 13.427999999999995, 32.769, 53.401333333333355, 30.21733333333333, 15.81, 36.57500000000001, 13.460333333333333, 18.517333333333326, 25.83533333333332, 29.508000000000003, 17.898999999999994, 15.641333333333332, 15.051666666666662, 30.019666666666662, 27.033000000000005, 24.09433333333333, 23.461666666666673, 17.54533333333333, 18.759999999999998, 22.594999999999995, 17.163333333333323, 33.75466666666667, 20.625666666666653, 20.651333333333326, 22.486333333333327, 17.888666666666666, 27.060333333333325, 28.112666666666666, 14.702999999999992, 26.27433333333333, 15.06733333333333, 21.042333333333325, 16.65033333333333, 20.398666666666667, 16.092999999999996, 40.65166666666666, 43.34966666666668, 38.20466666666666, 17.262333333333327, 44.22366666666666, 66.39366666666668, 17.914333333333335, 16.848333333333333, 16.05666666666666, 20.405666666666654, 18.804333333333325, 24.258999999999986, 20.574333333333325, 19.725333333333325, 64.75100000000005, 30.343999999999998, 55.594666666666704, 21.576999999999988], "episode_lengths": [33, 48, 85, 52, 102, 35, 38, 70, 32, 35, 90, 34, 34, 89, 65, 55, 46, 46, 53, 74, 80, 34, 59, 46, 67, 61, 42, 95, 47, 33, 45, 35, 61, 43, 46, 53, 34, 41, 97, 84, 32, 50, 83, 51, 39, 42, 51, 26, 70, 94, 51, 35, 62, 30, 33, 49, 51, 34, 31, 32, 54, 46, 46, 50, 37, 35, 42, 39, 61, 50, 39, 38, 45, 50, 51, 30, 46, 29, 41, 33, 43, 31, 79, 88, 59, 36, 78, 114, 38, 34, 35, 43, 36, 54, 47, 37, 108, 57, 99, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2130251766285363, "mean_inference_ms": 2.213861303555726, "mean_action_processing_ms": 0.47635027029475, "mean_env_wait_ms": 0.11421756085549921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024180889129638672, "StateBufferConnector_ms": 0.01648688316345215, "ViewRequirementAgentConnector_ms": 0.3928534984588623}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 763.6123400750677, "num_env_steps_trained_throughput_per_sec": 763.6123400750677, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 5680.017, "sample_time_ms": 2193.687, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3467.546, "learn_throughput": 1153.553, "synch_weights_time_ms": 16.857}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 3441, "training_iteration": 39, "trial_id": "432ea_00000", "date": "2023-12-07_16-29-59", "timestamp": 1701995399, "time_this_iter_s": 5.250249862670898, "time_total_s": 233.5964412689209, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 233.5964412689209, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 71.8, "ram_util_percent": 92.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.143213744838391e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 6.518695831298828, "policy_loss": -0.006485697813332081, "vf_loss": 6.525181770324707, "vf_explained_var": 0.5575965046882629, "kl": 0.0011709087993949652, "entropy": 0.11423006653785706, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 66.39366666666668, "episode_reward_min": 10.677666666666662, "episode_reward_mean": 28.904323333333338, "episode_len_mean": 54.46, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.702999999999992, 26.27433333333333, 15.06733333333333, 21.042333333333325, 16.65033333333333, 20.398666666666667, 16.092999999999996, 40.65166666666666, 43.34966666666668, 38.20466666666666, 17.262333333333327, 44.22366666666666, 66.39366666666668, 17.914333333333335, 16.848333333333333, 16.05666666666666, 20.405666666666654, 18.804333333333325, 24.258999999999986, 20.574333333333325, 19.725333333333325, 64.75100000000005, 30.343999999999998, 55.594666666666704, 21.576999999999988, 30.45499999999998, 54.64166666666668, 22.707333333333327, 24.32133333333333, 15.998333333333324, 37.23433333333332, 17.081999999999997, 47.17433333333334, 29.141666666666666, 39.80199999999999, 45.876000000000005, 21.41366666666666, 22.850333333333325, 34.57933333333332, 12.523666666666662, 32.93433333333333, 22.684666666666665, 23.876333333333324, 16.869333333333334, 12.461666666666662, 16.270333333333333, 33.394999999999996, 23.656333333333336, 23.02299999999999, 25.608, 51.122666666666674, 43.85566666666668, 14.664666666666664, 37.28899999999999, 36.36533333333333, 22.56366666666666, 20.636666666666663, 17.208333333333325, 30.437999999999988, 34.32633333333332, 38.43566666666667, 16.811666666666657, 61.698000000000086, 22.709999999999994, 15.197, 36.982, 37.87233333333333, 24.22899999999999, 14.625999999999998, 17.06233333333332, 55.633666666666656, 21.098999999999993, 10.677666666666662, 28.878666666666643, 31.05966666666667, 46.899666666666675, 27.683000000000003, 24.967333333333336, 37.157000000000004, 15.515999999999993, 21.066666666666656, 47.31933333333333, 32.30533333333332, 28.881666666666675, 18.116999999999994, 27.213000000000005, 23.858666666666668, 27.200000000000006, 19.438999999999993, 32.700666666666656, 41.66633333333332, 19.389999999999997, 27.942333333333327, 28.83166666666666, 36.42833333333332, 40.33700000000002, 34.02166666666666, 13.670666666666662, 54.78399999999994, 27.843666666666664], "episode_lengths": [30, 46, 29, 41, 33, 43, 31, 79, 88, 59, 36, 78, 114, 38, 34, 35, 43, 36, 54, 47, 37, 108, 57, 99, 41, 49, 88, 49, 43, 34, 62, 33, 72, 52, 83, 85, 40, 40, 63, 23, 58, 37, 56, 31, 25, 30, 72, 44, 60, 61, 70, 82, 31, 70, 65, 44, 45, 41, 56, 58, 76, 32, 119, 43, 30, 59, 68, 50, 31, 34, 100, 46, 24, 65, 66, 86, 54, 49, 72, 31, 37, 81, 64, 52, 38, 46, 45, 60, 38, 60, 76, 41, 50, 60, 63, 72, 61, 31, 86, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2105668288090532, "mean_inference_ms": 2.210076910681522, "mean_action_processing_ms": 0.47615129171529824, "mean_env_wait_ms": 0.11411575398879488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013717889785766602, "StateBufferConnector_ms": 0.012996912002563477, "ViewRequirementAgentConnector_ms": 0.38903260231018066}}, "episode_reward_max": 66.39366666666668, "episode_reward_min": 10.677666666666662, "episode_reward_mean": 28.904323333333338, "episode_len_mean": 54.46, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.702999999999992, 26.27433333333333, 15.06733333333333, 21.042333333333325, 16.65033333333333, 20.398666666666667, 16.092999999999996, 40.65166666666666, 43.34966666666668, 38.20466666666666, 17.262333333333327, 44.22366666666666, 66.39366666666668, 17.914333333333335, 16.848333333333333, 16.05666666666666, 20.405666666666654, 18.804333333333325, 24.258999999999986, 20.574333333333325, 19.725333333333325, 64.75100000000005, 30.343999999999998, 55.594666666666704, 21.576999999999988, 30.45499999999998, 54.64166666666668, 22.707333333333327, 24.32133333333333, 15.998333333333324, 37.23433333333332, 17.081999999999997, 47.17433333333334, 29.141666666666666, 39.80199999999999, 45.876000000000005, 21.41366666666666, 22.850333333333325, 34.57933333333332, 12.523666666666662, 32.93433333333333, 22.684666666666665, 23.876333333333324, 16.869333333333334, 12.461666666666662, 16.270333333333333, 33.394999999999996, 23.656333333333336, 23.02299999999999, 25.608, 51.122666666666674, 43.85566666666668, 14.664666666666664, 37.28899999999999, 36.36533333333333, 22.56366666666666, 20.636666666666663, 17.208333333333325, 30.437999999999988, 34.32633333333332, 38.43566666666667, 16.811666666666657, 61.698000000000086, 22.709999999999994, 15.197, 36.982, 37.87233333333333, 24.22899999999999, 14.625999999999998, 17.06233333333332, 55.633666666666656, 21.098999999999993, 10.677666666666662, 28.878666666666643, 31.05966666666667, 46.899666666666675, 27.683000000000003, 24.967333333333336, 37.157000000000004, 15.515999999999993, 21.066666666666656, 47.31933333333333, 32.30533333333332, 28.881666666666675, 18.116999999999994, 27.213000000000005, 23.858666666666668, 27.200000000000006, 19.438999999999993, 32.700666666666656, 41.66633333333332, 19.389999999999997, 27.942333333333327, 28.83166666666666, 36.42833333333332, 40.33700000000002, 34.02166666666666, 13.670666666666662, 54.78399999999994, 27.843666666666664], "episode_lengths": [30, 46, 29, 41, 33, 43, 31, 79, 88, 59, 36, 78, 114, 38, 34, 35, 43, 36, 54, 47, 37, 108, 57, 99, 41, 49, 88, 49, 43, 34, 62, 33, 72, 52, 83, 85, 40, 40, 63, 23, 58, 37, 56, 31, 25, 30, 72, 44, 60, 61, 70, 82, 31, 70, 65, 44, 45, 41, 56, 58, 76, 32, 119, 43, 30, 59, 68, 50, 31, 34, 100, 46, 24, 65, 66, 86, 54, 49, 72, 31, 37, 81, 64, 52, 38, 46, 45, 60, 38, 60, 76, 41, 50, 60, 63, 72, 61, 31, 86, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2105668288090532, "mean_inference_ms": 2.210076910681522, "mean_action_processing_ms": 0.47615129171529824, "mean_env_wait_ms": 0.11411575398879488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013717889785766602, "StateBufferConnector_ms": 0.012996912002563477, "ViewRequirementAgentConnector_ms": 0.38903260231018066}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.4664277910044, "num_env_steps_trained_throughput_per_sec": 800.4664277910044, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 5446.254, "sample_time_ms": 2186.654, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3241.211, "learn_throughput": 1234.107, "synch_weights_time_ms": 16.559}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 3516, "training_iteration": 40, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-04", "timestamp": 1701995404, "time_this_iter_s": 5.014765501022339, "time_total_s": 238.61120676994324, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 238.61120676994324, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 70.9142857142857, "ram_util_percent": 93.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5716068724191956e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 5.400101661682129, "policy_loss": 0.003836366580799222, "vf_loss": 5.396265029907227, "vf_explained_var": 0.6361434459686279, "kl": 0.002595151076093316, "entropy": 0.13858091831207275, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 54.78399999999994, "episode_reward_min": 13.670666666666662, "episode_reward_mean": 27.66135, "episode_len_mean": 54.0, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.878666666666643, 31.05966666666667, 46.899666666666675, 27.683000000000003, 24.967333333333336, 37.157000000000004, 15.515999999999993, 21.066666666666656, 47.31933333333333, 32.30533333333332, 28.881666666666675, 18.116999999999994, 27.213000000000005, 23.858666666666668, 27.200000000000006, 19.438999999999993, 32.700666666666656, 41.66633333333332, 19.389999999999997, 27.942333333333327, 28.83166666666666, 36.42833333333332, 40.33700000000002, 34.02166666666666, 13.670666666666662, 54.78399999999994, 27.843666666666664, 51.687999999999995, 21.459000000000003, 26.454666666666668, 26.337666666666667, 32.33466666666668, 18.10433333333333, 32.01533333333333, 26.396, 16.538999999999998, 25.204333333333324, 24.85866666666667, 28.991666666666664, 24.35133333333332, 28.70633333333333, 34.64833333333333, 18.301, 21.461333333333336, 17.789666666666662, 35.196333333333335, 45.7443333333333, 15.466999999999995, 30.38533333333332, 36.43166666666667, 15.932666666666664, 21.254666666666665, 33.664, 39.28933333333334, 48.395333333333326, 35.305666666666696, 15.175333333333331, 17.78299999999999, 40.535333333333355, 19.96866666666666, 26.575333333333333, 22.324999999999992, 21.82133333333333, 29.313000000000013, 25.357999999999997, 25.83566666666666, 29.122333333333327, 17.272999999999996, 17.68533333333333, 32.495333333333335, 28.914999999999996, 17.66533333333333, 15.168666666666663, 26.558666666666667, 47.996999999999986, 19.354333333333322, 24.044333333333324, 17.310666666666666, 17.815999999999995, 16.272333333333332, 31.505333333333333, 31.069666666666656, 17.81633333333333, 20.383666666666667, 27.052000000000003, 36.40766666666666, 21.136333333333326, 22.306666666666658, 49.68866666666668, 33.61733333333332, 27.05866666666666, 25.622666666666667, 16.481666666666662, 53.36066666666669, 16.800333333333327, 30.113333333333323, 28.419000000000004, 17.04033333333333, 21.308333333333326, 18.691333333333326], "episode_lengths": [65, 66, 86, 54, 49, 72, 31, 37, 81, 64, 52, 38, 46, 45, 60, 38, 60, 76, 41, 50, 60, 63, 72, 61, 31, 86, 62, 94, 41, 45, 60, 77, 38, 63, 47, 34, 56, 51, 54, 53, 62, 65, 34, 48, 38, 66, 67, 34, 65, 72, 35, 39, 63, 81, 89, 58, 35, 36, 77, 42, 57, 46, 49, 57, 49, 50, 56, 34, 35, 68, 52, 35, 31, 63, 84, 38, 56, 37, 36, 33, 70, 54, 36, 40, 53, 66, 46, 39, 83, 67, 55, 61, 32, 93, 34, 57, 58, 34, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209305922389796, "mean_inference_ms": 2.205164071292239, "mean_action_processing_ms": 0.47594056077501234, "mean_env_wait_ms": 0.11428476819914732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010361194610595703, "StateBufferConnector_ms": 0.012437582015991211, "ViewRequirementAgentConnector_ms": 0.39607810974121094}}, "episode_reward_max": 54.78399999999994, "episode_reward_min": 13.670666666666662, "episode_reward_mean": 27.66135, "episode_len_mean": 54.0, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.878666666666643, 31.05966666666667, 46.899666666666675, 27.683000000000003, 24.967333333333336, 37.157000000000004, 15.515999999999993, 21.066666666666656, 47.31933333333333, 32.30533333333332, 28.881666666666675, 18.116999999999994, 27.213000000000005, 23.858666666666668, 27.200000000000006, 19.438999999999993, 32.700666666666656, 41.66633333333332, 19.389999999999997, 27.942333333333327, 28.83166666666666, 36.42833333333332, 40.33700000000002, 34.02166666666666, 13.670666666666662, 54.78399999999994, 27.843666666666664, 51.687999999999995, 21.459000000000003, 26.454666666666668, 26.337666666666667, 32.33466666666668, 18.10433333333333, 32.01533333333333, 26.396, 16.538999999999998, 25.204333333333324, 24.85866666666667, 28.991666666666664, 24.35133333333332, 28.70633333333333, 34.64833333333333, 18.301, 21.461333333333336, 17.789666666666662, 35.196333333333335, 45.7443333333333, 15.466999999999995, 30.38533333333332, 36.43166666666667, 15.932666666666664, 21.254666666666665, 33.664, 39.28933333333334, 48.395333333333326, 35.305666666666696, 15.175333333333331, 17.78299999999999, 40.535333333333355, 19.96866666666666, 26.575333333333333, 22.324999999999992, 21.82133333333333, 29.313000000000013, 25.357999999999997, 25.83566666666666, 29.122333333333327, 17.272999999999996, 17.68533333333333, 32.495333333333335, 28.914999999999996, 17.66533333333333, 15.168666666666663, 26.558666666666667, 47.996999999999986, 19.354333333333322, 24.044333333333324, 17.310666666666666, 17.815999999999995, 16.272333333333332, 31.505333333333333, 31.069666666666656, 17.81633333333333, 20.383666666666667, 27.052000000000003, 36.40766666666666, 21.136333333333326, 22.306666666666658, 49.68866666666668, 33.61733333333332, 27.05866666666666, 25.622666666666667, 16.481666666666662, 53.36066666666669, 16.800333333333327, 30.113333333333323, 28.419000000000004, 17.04033333333333, 21.308333333333326, 18.691333333333326], "episode_lengths": [65, 66, 86, 54, 49, 72, 31, 37, 81, 64, 52, 38, 46, 45, 60, 38, 60, 76, 41, 50, 60, 63, 72, 61, 31, 86, 62, 94, 41, 45, 60, 77, 38, 63, 47, 34, 56, 51, 54, 53, 62, 65, 34, 48, 38, 66, 67, 34, 65, 72, 35, 39, 63, 81, 89, 58, 35, 36, 77, 42, 57, 46, 49, 57, 49, 50, 56, 34, 35, 68, 52, 35, 31, 63, 84, 38, 56, 37, 36, 33, 70, 54, 36, 40, 53, 66, 46, 39, 83, 67, 55, 61, 32, 93, 34, 57, 58, 34, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209305922389796, "mean_inference_ms": 2.205164071292239, "mean_action_processing_ms": 0.47594056077501234, "mean_env_wait_ms": 0.11428476819914732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010361194610595703, "StateBufferConnector_ms": 0.012437582015991211, "ViewRequirementAgentConnector_ms": 0.39607810974121094}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.6237091013196, "num_env_steps_trained_throughput_per_sec": 521.6237091013196, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 5626.521, "sample_time_ms": 2180.279, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3429.267, "learn_throughput": 1166.43, "synch_weights_time_ms": 15.249}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 3589, "training_iteration": 41, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-12", "timestamp": 1701995412, "time_this_iter_s": 7.6793718338012695, "time_total_s": 246.2905786037445, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 246.2905786037445, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 62.790909090909096, "ram_util_percent": 93.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.858034362095978e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 6.026439666748047, "policy_loss": -0.0031805529724806547, "vf_loss": 6.029620170593262, "vf_explained_var": 0.5749529004096985, "kl": 0.0011880516540259123, "entropy": 0.13325317203998566, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 72.52866666666671, "episode_reward_min": 11.225666666666665, "episode_reward_mean": 26.782223333333327, "episode_len_mean": 51.29, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.815999999999995, 16.272333333333332, 31.505333333333333, 31.069666666666656, 17.81633333333333, 20.383666666666667, 27.052000000000003, 36.40766666666666, 21.136333333333326, 22.306666666666658, 49.68866666666668, 33.61733333333332, 27.05866666666666, 25.622666666666667, 16.481666666666662, 53.36066666666669, 16.800333333333327, 30.113333333333323, 28.419000000000004, 17.04033333333333, 21.308333333333326, 18.691333333333326, 21.98066666666666, 22.445333333333334, 35.33033333333332, 17.943, 29.478000000000016, 16.561333333333323, 16.480999999999995, 20.82966666666665, 43.33266666666666, 16.71033333333333, 13.873999999999993, 21.312333333333335, 28.87866666666667, 31.31600000000002, 15.988333333333332, 36.76766666666667, 18.070999999999987, 31.506999999999994, 20.06299999999999, 35.816999999999986, 15.779333333333334, 14.159999999999997, 16.09666666666666, 19.351666666666667, 16.04099999999999, 11.225666666666665, 31.193333333333328, 17.343999999999994, 22.845666666666666, 32.83333333333333, 23.115999999999985, 35.91100000000001, 41.35266666666668, 23.08466666666666, 27.46, 49.83366666666671, 33.723000000000006, 38.18333333333333, 27.85999999999999, 49.53733333333332, 16.184333333333328, 15.386999999999999, 37.05666666666667, 21.653333333333332, 27.06, 27.104999999999983, 29.036333333333335, 24.986333333333334, 14.35133333333333, 16.115999999999996, 12.738999999999997, 23.59066666666666, 53.714333333333336, 13.89, 51.84366666666666, 20.298, 24.61766666666665, 22.227, 14.763999999999992, 14.906999999999993, 51.262333333333316, 16.78866666666666, 27.741999999999997, 36.227666666666636, 32.93899999999997, 29.316333333333326, 72.52866666666671, 47.78966666666668, 17.305666666666664, 18.771333333333335, 26.806666666666654, 19.418666666666656, 29.475999999999974, 18.56766666666666, 64.61766666666665, 31.04166666666666, 17.663666666666654, 16.843333333333334], "episode_lengths": [36, 33, 70, 54, 36, 40, 53, 66, 46, 39, 83, 67, 55, 61, 32, 93, 34, 57, 58, 34, 50, 41, 43, 43, 58, 34, 53, 34, 34, 46, 81, 34, 27, 38, 53, 55, 35, 78, 36, 60, 38, 89, 31, 29, 37, 39, 35, 24, 57, 37, 51, 63, 41, 74, 67, 42, 55, 100, 58, 72, 52, 89, 31, 28, 75, 49, 57, 54, 54, 50, 31, 31, 24, 48, 80, 27, 85, 42, 52, 50, 29, 30, 82, 37, 57, 71, 56, 56, 117, 82, 34, 39, 48, 35, 57, 36, 96, 66, 40, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2083964878269526, "mean_inference_ms": 2.199170364281035, "mean_action_processing_ms": 0.47561610260077053, "mean_env_wait_ms": 0.11425083136590748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019215822219848633, "StateBufferConnector_ms": 0.0097198486328125, "ViewRequirementAgentConnector_ms": 0.3901710510253906}}, "episode_reward_max": 72.52866666666671, "episode_reward_min": 11.225666666666665, "episode_reward_mean": 26.782223333333327, "episode_len_mean": 51.29, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.815999999999995, 16.272333333333332, 31.505333333333333, 31.069666666666656, 17.81633333333333, 20.383666666666667, 27.052000000000003, 36.40766666666666, 21.136333333333326, 22.306666666666658, 49.68866666666668, 33.61733333333332, 27.05866666666666, 25.622666666666667, 16.481666666666662, 53.36066666666669, 16.800333333333327, 30.113333333333323, 28.419000000000004, 17.04033333333333, 21.308333333333326, 18.691333333333326, 21.98066666666666, 22.445333333333334, 35.33033333333332, 17.943, 29.478000000000016, 16.561333333333323, 16.480999999999995, 20.82966666666665, 43.33266666666666, 16.71033333333333, 13.873999999999993, 21.312333333333335, 28.87866666666667, 31.31600000000002, 15.988333333333332, 36.76766666666667, 18.070999999999987, 31.506999999999994, 20.06299999999999, 35.816999999999986, 15.779333333333334, 14.159999999999997, 16.09666666666666, 19.351666666666667, 16.04099999999999, 11.225666666666665, 31.193333333333328, 17.343999999999994, 22.845666666666666, 32.83333333333333, 23.115999999999985, 35.91100000000001, 41.35266666666668, 23.08466666666666, 27.46, 49.83366666666671, 33.723000000000006, 38.18333333333333, 27.85999999999999, 49.53733333333332, 16.184333333333328, 15.386999999999999, 37.05666666666667, 21.653333333333332, 27.06, 27.104999999999983, 29.036333333333335, 24.986333333333334, 14.35133333333333, 16.115999999999996, 12.738999999999997, 23.59066666666666, 53.714333333333336, 13.89, 51.84366666666666, 20.298, 24.61766666666665, 22.227, 14.763999999999992, 14.906999999999993, 51.262333333333316, 16.78866666666666, 27.741999999999997, 36.227666666666636, 32.93899999999997, 29.316333333333326, 72.52866666666671, 47.78966666666668, 17.305666666666664, 18.771333333333335, 26.806666666666654, 19.418666666666656, 29.475999999999974, 18.56766666666666, 64.61766666666665, 31.04166666666666, 17.663666666666654, 16.843333333333334], "episode_lengths": [36, 33, 70, 54, 36, 40, 53, 66, 46, 39, 83, 67, 55, 61, 32, 93, 34, 57, 58, 34, 50, 41, 43, 43, 58, 34, 53, 34, 34, 46, 81, 34, 27, 38, 53, 55, 35, 78, 36, 60, 38, 89, 31, 29, 37, 39, 35, 24, 57, 37, 51, 63, 41, 74, 67, 42, 55, 100, 58, 72, 52, 89, 31, 28, 75, 49, 57, 54, 54, 50, 31, 31, 24, 48, 80, 27, 85, 42, 52, 50, 29, 30, 82, 37, 57, 71, 56, 56, 117, 82, 34, 39, 48, 35, 57, 36, 96, 66, 40, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2083964878269526, "mean_inference_ms": 2.199170364281035, "mean_action_processing_ms": 0.47561610260077053, "mean_env_wait_ms": 0.11425083136590748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019215822219848633, "StateBufferConnector_ms": 0.0097198486328125, "ViewRequirementAgentConnector_ms": 0.3901710510253906}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.86602084849636, "num_env_steps_trained_throughput_per_sec": 488.86602084849636, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 5933.546, "sample_time_ms": 2171.892, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3744.163, "learn_throughput": 1068.33, "synch_weights_time_ms": 15.666}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 3667, "training_iteration": 42, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-20", "timestamp": 1701995420, "time_this_iter_s": 8.193207740783691, "time_total_s": 254.4837863445282, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 254.4837863445282, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 64.65454545454546, "ram_util_percent": 93.28181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.929017181047989e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 5.953904628753662, "policy_loss": -0.00616028904914856, "vf_loss": 5.960064888000488, "vf_explained_var": 0.604523241519928, "kl": 0.0014575140085071325, "entropy": 0.1407480686903, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 72.52866666666671, "episode_reward_min": 11.516, "episode_reward_mean": 27.09862333333333, "episode_len_mean": 51.94, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.763999999999992, 14.906999999999993, 51.262333333333316, 16.78866666666666, 27.741999999999997, 36.227666666666636, 32.93899999999997, 29.316333333333326, 72.52866666666671, 47.78966666666668, 17.305666666666664, 18.771333333333335, 26.806666666666654, 19.418666666666656, 29.475999999999974, 18.56766666666666, 64.61766666666665, 31.04166666666666, 17.663666666666654, 16.843333333333334, 30.411999999999992, 23.584000000000003, 26.675666666666658, 51.03500000000001, 31.35966666666666, 23.90566666666666, 12.873999999999997, 22.835333333333324, 15.586333333333323, 35.487666666666684, 30.488666666666646, 32.306333333333306, 14.146333333333333, 20.621666666666663, 23.432999999999996, 21.371666666666652, 38.42033333333333, 37.090333333333334, 21.480000000000004, 34.290666666666674, 18.87866666666666, 16.628333333333327, 17.33033333333332, 36.69566666666667, 34.88666666666667, 19.08833333333333, 24.78666666666666, 36.84633333333333, 24.060666666666652, 32.08866666666667, 15.666333333333325, 19.98833333333332, 29.55166666666666, 43.551, 16.799333333333326, 18.211666666666662, 17.728999999999992, 11.516, 24.45733333333333, 15.92966666666666, 48.39599999999999, 14.757999999999996, 20.161666666666665, 19.96933333333333, 39.16966666666665, 26.787333333333322, 39.04466666666667, 18.66866666666666, 25.55366666666666, 36.64499999999999, 21.04699999999999, 39.66633333333332, 17.270333333333326, 26.259333333333334, 21.04666666666665, 13.02833333333333, 18.928333333333324, 37.25399999999998, 18.244333333333326, 26.501999999999995, 31.999333333333333, 22.18199999999999, 20.21833333333333, 24.539666666666655, 20.670333333333318, 21.488999999999994, 25.44433333333332, 26.131333333333327, 42.25833333333333, 19.654999999999994, 41.047999999999995, 26.483666666666668, 50.03266666666669, 13.969666666666667, 22.015333333333324, 41.20433333333331, 31.464999999999982, 25.95033333333334, 15.71033333333333, 32.121999999999986], "episode_lengths": [29, 30, 82, 37, 57, 71, 56, 56, 117, 82, 34, 39, 48, 35, 57, 36, 96, 66, 40, 33, 70, 44, 54, 88, 61, 47, 27, 46, 34, 64, 49, 57, 28, 45, 46, 38, 77, 76, 42, 69, 39, 34, 35, 64, 59, 40, 45, 74, 53, 51, 36, 37, 48, 76, 35, 40, 38, 23, 45, 34, 86, 33, 50, 45, 89, 49, 81, 39, 49, 60, 53, 72, 34, 51, 43, 27, 38, 71, 36, 51, 57, 43, 38, 58, 44, 40, 42, 54, 77, 38, 79, 61, 96, 28, 45, 66, 58, 55, 32, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2070784519076951, "mean_inference_ms": 2.1940139010195012, "mean_action_processing_ms": 0.47495346924016985, "mean_env_wait_ms": 0.11422114035323769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0186309814453125, "StateBufferConnector_ms": 0.013358592987060547, "ViewRequirementAgentConnector_ms": 0.3808927536010742}}, "episode_reward_max": 72.52866666666671, "episode_reward_min": 11.516, "episode_reward_mean": 27.09862333333333, "episode_len_mean": 51.94, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.763999999999992, 14.906999999999993, 51.262333333333316, 16.78866666666666, 27.741999999999997, 36.227666666666636, 32.93899999999997, 29.316333333333326, 72.52866666666671, 47.78966666666668, 17.305666666666664, 18.771333333333335, 26.806666666666654, 19.418666666666656, 29.475999999999974, 18.56766666666666, 64.61766666666665, 31.04166666666666, 17.663666666666654, 16.843333333333334, 30.411999999999992, 23.584000000000003, 26.675666666666658, 51.03500000000001, 31.35966666666666, 23.90566666666666, 12.873999999999997, 22.835333333333324, 15.586333333333323, 35.487666666666684, 30.488666666666646, 32.306333333333306, 14.146333333333333, 20.621666666666663, 23.432999999999996, 21.371666666666652, 38.42033333333333, 37.090333333333334, 21.480000000000004, 34.290666666666674, 18.87866666666666, 16.628333333333327, 17.33033333333332, 36.69566666666667, 34.88666666666667, 19.08833333333333, 24.78666666666666, 36.84633333333333, 24.060666666666652, 32.08866666666667, 15.666333333333325, 19.98833333333332, 29.55166666666666, 43.551, 16.799333333333326, 18.211666666666662, 17.728999999999992, 11.516, 24.45733333333333, 15.92966666666666, 48.39599999999999, 14.757999999999996, 20.161666666666665, 19.96933333333333, 39.16966666666665, 26.787333333333322, 39.04466666666667, 18.66866666666666, 25.55366666666666, 36.64499999999999, 21.04699999999999, 39.66633333333332, 17.270333333333326, 26.259333333333334, 21.04666666666665, 13.02833333333333, 18.928333333333324, 37.25399999999998, 18.244333333333326, 26.501999999999995, 31.999333333333333, 22.18199999999999, 20.21833333333333, 24.539666666666655, 20.670333333333318, 21.488999999999994, 25.44433333333332, 26.131333333333327, 42.25833333333333, 19.654999999999994, 41.047999999999995, 26.483666666666668, 50.03266666666669, 13.969666666666667, 22.015333333333324, 41.20433333333331, 31.464999999999982, 25.95033333333334, 15.71033333333333, 32.121999999999986], "episode_lengths": [29, 30, 82, 37, 57, 71, 56, 56, 117, 82, 34, 39, 48, 35, 57, 36, 96, 66, 40, 33, 70, 44, 54, 88, 61, 47, 27, 46, 34, 64, 49, 57, 28, 45, 46, 38, 77, 76, 42, 69, 39, 34, 35, 64, 59, 40, 45, 74, 53, 51, 36, 37, 48, 76, 35, 40, 38, 23, 45, 34, 86, 33, 50, 45, 89, 49, 81, 39, 49, 60, 53, 72, 34, 51, 43, 27, 38, 71, 36, 51, 57, 43, 38, 58, 44, 40, 42, 54, 77, 38, 79, 61, 96, 28, 45, 66, 58, 55, 32, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2070784519076951, "mean_inference_ms": 2.1940139010195012, "mean_action_processing_ms": 0.47495346924016985, "mean_env_wait_ms": 0.11422114035323769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0186309814453125, "StateBufferConnector_ms": 0.013358592987060547, "ViewRequirementAgentConnector_ms": 0.3808927536010742}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 728.7767095049686, "num_env_steps_trained_throughput_per_sec": 728.7767095049686, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 5788.759, "sample_time_ms": 2171.436, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3599.622, "learn_throughput": 1111.228, "synch_weights_time_ms": 15.956}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 3747, "training_iteration": 43, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-26", "timestamp": 1701995426, "time_this_iter_s": 5.4996514320373535, "time_total_s": 259.98343777656555, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 259.98343777656555, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 68.025, "ram_util_percent": 93.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9645085905239945e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 6.0304436683654785, "policy_loss": -0.007839559577405453, "vf_loss": 6.03828239440918, "vf_explained_var": 0.6023838520050049, "kl": 0.001475795404985547, "entropy": 0.11902186274528503, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 50.97666666666667, "episode_reward_min": 13.02833333333333, "episode_reward_mean": 27.76325333333333, "episode_len_mean": 53.55, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.02833333333333, 18.928333333333324, 37.25399999999998, 18.244333333333326, 26.501999999999995, 31.999333333333333, 22.18199999999999, 20.21833333333333, 24.539666666666655, 20.670333333333318, 21.488999999999994, 25.44433333333332, 26.131333333333327, 42.25833333333333, 19.654999999999994, 41.047999999999995, 26.483666666666668, 50.03266666666669, 13.969666666666667, 22.015333333333324, 41.20433333333331, 31.464999999999982, 25.95033333333334, 15.71033333333333, 32.121999999999986, 33.77433333333334, 26.592000000000002, 20.040666666666663, 20.051999999999996, 14.363999999999995, 37.63633333333334, 26.27633333333332, 49.46, 19.08099999999999, 17.16466666666667, 38.33133333333334, 22.950333333333326, 23.543333333333333, 18.86866666666666, 39.00366666666668, 46.14966666666665, 38.988333333333344, 14.331333333333328, 49.867666666666686, 41.16100000000001, 26.286333333333324, 16.582333333333324, 18.213666666666665, 46.593666666666685, 42.486333333333334, 21.90899999999999, 32.40433333333335, 26.802333333333344, 20.96233333333332, 16.329999999999995, 24.269666666666666, 19.05533333333333, 22.184666666666665, 18.358999999999988, 28.86566666666667, 22.753333333333327, 27.740000000000002, 34.64033333333331, 21.485999999999994, 21.696333333333335, 46.49166666666668, 14.00933333333333, 32.102666666666664, 46.8313333333333, 23.319666666666656, 26.62166666666667, 14.704666666666668, 26.044333333333334, 22.315666666666647, 15.391333333333327, 43.78566666666669, 24.891999999999996, 34.52033333333333, 32.818666666666665, 19.453666666666667, 25.86000000000001, 17.231999999999992, 25.094999999999978, 32.019000000000005, 43.22900000000001, 13.068666666666664, 19.275, 29.65866666666667, 41.848, 32.18266666666667, 50.97666666666667, 41.30299999999996, 18.935999999999996, 37.08833333333334, 28.081999999999987, 13.902999999999999, 18.755999999999997, 34.28666666666666, 15.988333333333328, 38.43133333333334], "episode_lengths": [27, 38, 71, 36, 51, 57, 43, 38, 58, 44, 40, 42, 54, 77, 38, 79, 61, 96, 28, 45, 66, 58, 55, 32, 57, 56, 59, 47, 39, 27, 81, 44, 85, 40, 33, 69, 48, 43, 39, 79, 94, 70, 31, 98, 76, 59, 37, 40, 90, 78, 48, 56, 53, 38, 35, 44, 39, 48, 40, 56, 49, 53, 60, 41, 44, 92, 29, 68, 79, 46, 50, 31, 46, 44, 31, 88, 45, 60, 65, 35, 47, 35, 46, 66, 68, 27, 44, 61, 79, 65, 97, 64, 37, 67, 45, 28, 41, 69, 30, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.205872013011574, "mean_inference_ms": 2.1898531722040837, "mean_action_processing_ms": 0.4748479123154036, "mean_env_wait_ms": 0.11416000493037753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01759195327758789, "StateBufferConnector_ms": 0.013219356536865234, "ViewRequirementAgentConnector_ms": 0.38356828689575195}}, "episode_reward_max": 50.97666666666667, "episode_reward_min": 13.02833333333333, "episode_reward_mean": 27.76325333333333, "episode_len_mean": 53.55, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.02833333333333, 18.928333333333324, 37.25399999999998, 18.244333333333326, 26.501999999999995, 31.999333333333333, 22.18199999999999, 20.21833333333333, 24.539666666666655, 20.670333333333318, 21.488999999999994, 25.44433333333332, 26.131333333333327, 42.25833333333333, 19.654999999999994, 41.047999999999995, 26.483666666666668, 50.03266666666669, 13.969666666666667, 22.015333333333324, 41.20433333333331, 31.464999999999982, 25.95033333333334, 15.71033333333333, 32.121999999999986, 33.77433333333334, 26.592000000000002, 20.040666666666663, 20.051999999999996, 14.363999999999995, 37.63633333333334, 26.27633333333332, 49.46, 19.08099999999999, 17.16466666666667, 38.33133333333334, 22.950333333333326, 23.543333333333333, 18.86866666666666, 39.00366666666668, 46.14966666666665, 38.988333333333344, 14.331333333333328, 49.867666666666686, 41.16100000000001, 26.286333333333324, 16.582333333333324, 18.213666666666665, 46.593666666666685, 42.486333333333334, 21.90899999999999, 32.40433333333335, 26.802333333333344, 20.96233333333332, 16.329999999999995, 24.269666666666666, 19.05533333333333, 22.184666666666665, 18.358999999999988, 28.86566666666667, 22.753333333333327, 27.740000000000002, 34.64033333333331, 21.485999999999994, 21.696333333333335, 46.49166666666668, 14.00933333333333, 32.102666666666664, 46.8313333333333, 23.319666666666656, 26.62166666666667, 14.704666666666668, 26.044333333333334, 22.315666666666647, 15.391333333333327, 43.78566666666669, 24.891999999999996, 34.52033333333333, 32.818666666666665, 19.453666666666667, 25.86000000000001, 17.231999999999992, 25.094999999999978, 32.019000000000005, 43.22900000000001, 13.068666666666664, 19.275, 29.65866666666667, 41.848, 32.18266666666667, 50.97666666666667, 41.30299999999996, 18.935999999999996, 37.08833333333334, 28.081999999999987, 13.902999999999999, 18.755999999999997, 34.28666666666666, 15.988333333333328, 38.43133333333334], "episode_lengths": [27, 38, 71, 36, 51, 57, 43, 38, 58, 44, 40, 42, 54, 77, 38, 79, 61, 96, 28, 45, 66, 58, 55, 32, 57, 56, 59, 47, 39, 27, 81, 44, 85, 40, 33, 69, 48, 43, 39, 79, 94, 70, 31, 98, 76, 59, 37, 40, 90, 78, 48, 56, 53, 38, 35, 44, 39, 48, 40, 56, 49, 53, 60, 41, 44, 92, 29, 68, 79, 46, 50, 31, 46, 44, 31, 88, 45, 60, 65, 35, 47, 35, 46, 66, 68, 27, 44, 61, 79, 65, 97, 64, 37, 67, 45, 28, 41, 69, 30, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.205872013011574, "mean_inference_ms": 2.1898531722040837, "mean_action_processing_ms": 0.4748479123154036, "mean_env_wait_ms": 0.11416000493037753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01759195327758789, "StateBufferConnector_ms": 0.013219356536865234, "ViewRequirementAgentConnector_ms": 0.38356828689575195}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.9192851384233, "num_env_steps_trained_throughput_per_sec": 713.9192851384233, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5857.08, "sample_time_ms": 2172.229, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3667.048, "learn_throughput": 1090.796, "synch_weights_time_ms": 16.184}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3822, "training_iteration": 44, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-32", "timestamp": 1701995432, "time_this_iter_s": 5.614210605621338, "time_total_s": 265.5976483821869, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 265.5976483821869, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 69.35, "ram_util_percent": 93.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.822542952619973e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 6.179978370666504, "policy_loss": -0.006636360194534063, "vf_loss": 6.186615467071533, "vf_explained_var": 0.6140833497047424, "kl": 0.0009343133424408734, "entropy": 0.12539903819561005, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 54.72566666666666, "episode_reward_min": 13.068666666666664, "episode_reward_mean": 29.104449999999996, "episode_len_mean": 55.48, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.8313333333333, 23.319666666666656, 26.62166666666667, 14.704666666666668, 26.044333333333334, 22.315666666666647, 15.391333333333327, 43.78566666666669, 24.891999999999996, 34.52033333333333, 32.818666666666665, 19.453666666666667, 25.86000000000001, 17.231999999999992, 25.094999999999978, 32.019000000000005, 43.22900000000001, 13.068666666666664, 19.275, 29.65866666666667, 41.848, 32.18266666666667, 50.97666666666667, 41.30299999999996, 18.935999999999996, 37.08833333333334, 28.081999999999987, 13.902999999999999, 18.755999999999997, 34.28666666666666, 15.988333333333328, 38.43133333333334, 51.73166666666664, 28.099000000000004, 20.882999999999992, 23.25433333333333, 17.176999999999992, 41.182666666666655, 22.947666666666663, 38.742, 26.970333333333325, 42.304333333333325, 27.236333333333327, 18.41233333333333, 23.093999999999998, 43.36466666666662, 37.16233333333333, 42.67033333333334, 31.508333333333322, 23.123666666666658, 54.72566666666666, 18.77233333333333, 22.311999999999998, 39.093000000000025, 32.37366666666665, 49.55666666666668, 17.139333333333337, 20.681333333333324, 36.736666666666665, 25.572333333333315, 24.98633333333332, 23.920999999999992, 17.08333333333333, 22.778333333333325, 38.34266666666666, 45.52699999999998, 36.455333333333336, 33.44366666666666, 35.37033333333334, 15.800999999999995, 36.81433333333334, 51.549666666666674, 25.383000000000003, 24.86533333333334, 19.351, 14.706999999999997, 23.97566666666666, 21.53233333333332, 15.411333333333332, 23.19466666666666, 18.30133333333333, 45.37900000000001, 28.507, 30.39433333333333, 17.94833333333333, 39.286666666666655, 28.913999999999984, 17.830999999999992, 18.141666666666662, 13.812999999999992, 15.065999999999995, 27.104999999999997, 48.851000000000006, 18.952999999999992, 54.53633333333332, 39.93733333333335, 35.93600000000003, 32.748333333333335, 19.761, 23.795999999999996], "episode_lengths": [79, 46, 50, 31, 46, 44, 31, 88, 45, 60, 65, 35, 47, 35, 46, 66, 68, 27, 44, 61, 79, 65, 97, 64, 37, 67, 45, 28, 41, 69, 30, 73, 97, 62, 42, 50, 36, 81, 40, 57, 61, 78, 54, 38, 43, 101, 78, 85, 67, 47, 96, 38, 47, 72, 63, 87, 31, 41, 57, 56, 54, 45, 33, 52, 77, 87, 57, 60, 70, 40, 64, 82, 52, 57, 38, 30, 57, 43, 29, 51, 33, 88, 50, 55, 32, 65, 47, 36, 32, 28, 31, 52, 76, 39, 98, 81, 61, 73, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2042436012389808, "mean_inference_ms": 2.186937907405439, "mean_action_processing_ms": 0.4755955312343984, "mean_env_wait_ms": 0.11390060398409617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012714862823486328, "StateBufferConnector_ms": 0.007561445236206055, "ViewRequirementAgentConnector_ms": 0.3763909339904785}}, "episode_reward_max": 54.72566666666666, "episode_reward_min": 13.068666666666664, "episode_reward_mean": 29.104449999999996, "episode_len_mean": 55.48, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.8313333333333, 23.319666666666656, 26.62166666666667, 14.704666666666668, 26.044333333333334, 22.315666666666647, 15.391333333333327, 43.78566666666669, 24.891999999999996, 34.52033333333333, 32.818666666666665, 19.453666666666667, 25.86000000000001, 17.231999999999992, 25.094999999999978, 32.019000000000005, 43.22900000000001, 13.068666666666664, 19.275, 29.65866666666667, 41.848, 32.18266666666667, 50.97666666666667, 41.30299999999996, 18.935999999999996, 37.08833333333334, 28.081999999999987, 13.902999999999999, 18.755999999999997, 34.28666666666666, 15.988333333333328, 38.43133333333334, 51.73166666666664, 28.099000000000004, 20.882999999999992, 23.25433333333333, 17.176999999999992, 41.182666666666655, 22.947666666666663, 38.742, 26.970333333333325, 42.304333333333325, 27.236333333333327, 18.41233333333333, 23.093999999999998, 43.36466666666662, 37.16233333333333, 42.67033333333334, 31.508333333333322, 23.123666666666658, 54.72566666666666, 18.77233333333333, 22.311999999999998, 39.093000000000025, 32.37366666666665, 49.55666666666668, 17.139333333333337, 20.681333333333324, 36.736666666666665, 25.572333333333315, 24.98633333333332, 23.920999999999992, 17.08333333333333, 22.778333333333325, 38.34266666666666, 45.52699999999998, 36.455333333333336, 33.44366666666666, 35.37033333333334, 15.800999999999995, 36.81433333333334, 51.549666666666674, 25.383000000000003, 24.86533333333334, 19.351, 14.706999999999997, 23.97566666666666, 21.53233333333332, 15.411333333333332, 23.19466666666666, 18.30133333333333, 45.37900000000001, 28.507, 30.39433333333333, 17.94833333333333, 39.286666666666655, 28.913999999999984, 17.830999999999992, 18.141666666666662, 13.812999999999992, 15.065999999999995, 27.104999999999997, 48.851000000000006, 18.952999999999992, 54.53633333333332, 39.93733333333335, 35.93600000000003, 32.748333333333335, 19.761, 23.795999999999996], "episode_lengths": [79, 46, 50, 31, 46, 44, 31, 88, 45, 60, 65, 35, 47, 35, 46, 66, 68, 27, 44, 61, 79, 65, 97, 64, 37, 67, 45, 28, 41, 69, 30, 73, 97, 62, 42, 50, 36, 81, 40, 57, 61, 78, 54, 38, 43, 101, 78, 85, 67, 47, 96, 38, 47, 72, 63, 87, 31, 41, 57, 56, 54, 45, 33, 52, 77, 87, 57, 60, 70, 40, 64, 82, 52, 57, 38, 30, 57, 43, 29, 51, 33, 88, 50, 55, 32, 65, 47, 36, 32, 28, 31, 52, 76, 39, 98, 81, 61, 73, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2042436012389808, "mean_inference_ms": 2.186937907405439, "mean_action_processing_ms": 0.4755955312343984, "mean_env_wait_ms": 0.11390060398409617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012714862823486328, "StateBufferConnector_ms": 0.007561445236206055, "ViewRequirementAgentConnector_ms": 0.3763909339904785}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.9182532804012, "num_env_steps_trained_throughput_per_sec": 512.9182532804012, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 6143.814, "sample_time_ms": 2176.4, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3949.881, "learn_throughput": 1012.689, "synch_weights_time_ms": 16.024}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3890, "training_iteration": 45, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-39", "timestamp": 1701995439, "time_this_iter_s": 7.810517311096191, "time_total_s": 273.4081656932831, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 273.4081656932831, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.91818181818182, "ram_util_percent": 93.60909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.911271476309986e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 5.2168145179748535, "policy_loss": -0.00484717171639204, "vf_loss": 5.2216620445251465, "vf_explained_var": 0.6482083797454834, "kl": 0.001437235507182777, "entropy": 0.12436933815479279, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 55.67300000000001, "episode_reward_min": 13.67966666666666, "episode_reward_mean": 26.71218666666666, "episode_len_mean": 51.57, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.37900000000001, 28.507, 30.39433333333333, 17.94833333333333, 39.286666666666655, 28.913999999999984, 17.830999999999992, 18.141666666666662, 13.812999999999992, 15.065999999999995, 27.104999999999997, 48.851000000000006, 18.952999999999992, 54.53633333333332, 39.93733333333335, 35.93600000000003, 32.748333333333335, 19.761, 23.795999999999996, 32.41166666666666, 29.81033333333333, 27.81999999999999, 54.29066666666667, 16.39933333333333, 18.645333333333326, 16.258333333333336, 16.54999999999999, 20.065666666666672, 25.72333333333333, 27.31800000000001, 17.683999999999994, 28.00166666666666, 26.72166666666667, 29.807666666666666, 14.671666666666667, 24.497999999999994, 17.971666666666668, 13.853333333333333, 21.01033333333333, 37.48899999999998, 30.606999999999974, 14.491333333333333, 17.266999999999992, 35.09899999999999, 55.67300000000001, 16.534333333333333, 18.42799999999999, 15.467999999999991, 29.107999999999986, 25.727666666666668, 26.69166666666666, 44.39, 25.121333333333325, 35.42900000000001, 44.34533333333333, 49.22866666666667, 26.578666666666656, 13.67966666666666, 19.368999999999996, 30.032999999999998, 17.351999999999993, 21.07466666666667, 35.766999999999996, 14.63233333333333, 26.060999999999993, 20.142999999999994, 26.431333333333335, 37.623333333333335, 24.09366666666666, 16.088999999999995, 20.66866666666667, 21.871333333333315, 23.243999999999996, 27.863666666666667, 29.73933333333332, 16.242, 22.199666666666662, 22.102999999999998, 20.564999999999998, 21.219666666666658, 28.65333333333332, 39.295, 18.68433333333333, 30.51666666666666, 33.325333333333326, 46.43033333333332, 38.096000000000004, 30.77133333333334, 22.922333333333324, 20.46399999999999, 20.521, 30.100333333333335, 31.079000000000008, 22.091666666666665, 16.350333333333328, 23.89633333333333, 30.35566666666668, 27.144666666666673, 16.802999999999997, 31.55800000000001], "episode_lengths": [88, 50, 55, 32, 65, 47, 36, 32, 28, 31, 52, 76, 39, 98, 81, 61, 73, 38, 41, 76, 60, 47, 81, 31, 35, 32, 33, 44, 55, 57, 33, 62, 60, 60, 32, 41, 32, 27, 40, 70, 56, 31, 34, 69, 93, 36, 35, 33, 73, 52, 51, 77, 63, 64, 91, 75, 63, 28, 38, 65, 35, 41, 60, 28, 50, 48, 49, 77, 46, 32, 39, 49, 43, 60, 61, 33, 44, 48, 40, 44, 60, 72, 40, 57, 63, 74, 65, 49, 44, 43, 42, 58, 63, 42, 33, 46, 71, 53, 36, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2043048359324298, "mean_inference_ms": 2.180142135672051, "mean_action_processing_ms": 0.4744181749844013, "mean_env_wait_ms": 0.11359729381046367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009720802307128906, "StateBufferConnector_ms": 0.014389276504516602, "ViewRequirementAgentConnector_ms": 0.4021434783935547}}, "episode_reward_max": 55.67300000000001, "episode_reward_min": 13.67966666666666, "episode_reward_mean": 26.71218666666666, "episode_len_mean": 51.57, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.37900000000001, 28.507, 30.39433333333333, 17.94833333333333, 39.286666666666655, 28.913999999999984, 17.830999999999992, 18.141666666666662, 13.812999999999992, 15.065999999999995, 27.104999999999997, 48.851000000000006, 18.952999999999992, 54.53633333333332, 39.93733333333335, 35.93600000000003, 32.748333333333335, 19.761, 23.795999999999996, 32.41166666666666, 29.81033333333333, 27.81999999999999, 54.29066666666667, 16.39933333333333, 18.645333333333326, 16.258333333333336, 16.54999999999999, 20.065666666666672, 25.72333333333333, 27.31800000000001, 17.683999999999994, 28.00166666666666, 26.72166666666667, 29.807666666666666, 14.671666666666667, 24.497999999999994, 17.971666666666668, 13.853333333333333, 21.01033333333333, 37.48899999999998, 30.606999999999974, 14.491333333333333, 17.266999999999992, 35.09899999999999, 55.67300000000001, 16.534333333333333, 18.42799999999999, 15.467999999999991, 29.107999999999986, 25.727666666666668, 26.69166666666666, 44.39, 25.121333333333325, 35.42900000000001, 44.34533333333333, 49.22866666666667, 26.578666666666656, 13.67966666666666, 19.368999999999996, 30.032999999999998, 17.351999999999993, 21.07466666666667, 35.766999999999996, 14.63233333333333, 26.060999999999993, 20.142999999999994, 26.431333333333335, 37.623333333333335, 24.09366666666666, 16.088999999999995, 20.66866666666667, 21.871333333333315, 23.243999999999996, 27.863666666666667, 29.73933333333332, 16.242, 22.199666666666662, 22.102999999999998, 20.564999999999998, 21.219666666666658, 28.65333333333332, 39.295, 18.68433333333333, 30.51666666666666, 33.325333333333326, 46.43033333333332, 38.096000000000004, 30.77133333333334, 22.922333333333324, 20.46399999999999, 20.521, 30.100333333333335, 31.079000000000008, 22.091666666666665, 16.350333333333328, 23.89633333333333, 30.35566666666668, 27.144666666666673, 16.802999999999997, 31.55800000000001], "episode_lengths": [88, 50, 55, 32, 65, 47, 36, 32, 28, 31, 52, 76, 39, 98, 81, 61, 73, 38, 41, 76, 60, 47, 81, 31, 35, 32, 33, 44, 55, 57, 33, 62, 60, 60, 32, 41, 32, 27, 40, 70, 56, 31, 34, 69, 93, 36, 35, 33, 73, 52, 51, 77, 63, 64, 91, 75, 63, 28, 38, 65, 35, 41, 60, 28, 50, 48, 49, 77, 46, 32, 39, 49, 43, 60, 61, 33, 44, 48, 40, 44, 60, 72, 40, 57, 63, 74, 65, 49, 44, 43, 42, 58, 63, 42, 33, 46, 71, 53, 36, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2043048359324298, "mean_inference_ms": 2.180142135672051, "mean_action_processing_ms": 0.4744181749844013, "mean_env_wait_ms": 0.11359729381046367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009720802307128906, "StateBufferConnector_ms": 0.014389276504516602, "ViewRequirementAgentConnector_ms": 0.4021434783935547}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 759.9078556212686, "num_env_steps_trained_throughput_per_sec": 759.9078556212686, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 6033.352, "sample_time_ms": 2172.378, "load_time_ms": 0.25, "load_throughput": 16004212.535, "learn_time_ms": 3843.308, "learn_throughput": 1040.77, "synch_weights_time_ms": 15.955}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3971, "training_iteration": 46, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-45", "timestamp": 1701995445, "time_this_iter_s": 5.273813486099243, "time_total_s": 278.6819791793823, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 278.6819791793823, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 77.8, "ram_util_percent": 93.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.455635738154993e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 5.615045547485352, "policy_loss": -0.0018367961747571826, "vf_loss": 5.616882801055908, "vf_explained_var": 0.5792418718338013, "kl": 0.0018553200643509626, "entropy": 0.10934615880250931, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 65.18766666666669, "episode_reward_min": 12.632999999999997, "episode_reward_mean": 27.546153333333333, "episode_len_mean": 53.43, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.863666666666667, 29.73933333333332, 16.242, 22.199666666666662, 22.102999999999998, 20.564999999999998, 21.219666666666658, 28.65333333333332, 39.295, 18.68433333333333, 30.51666666666666, 33.325333333333326, 46.43033333333332, 38.096000000000004, 30.77133333333334, 22.922333333333324, 20.46399999999999, 20.521, 30.100333333333335, 31.079000000000008, 22.091666666666665, 16.350333333333328, 23.89633333333333, 30.35566666666668, 27.144666666666673, 16.802999999999997, 31.55800000000001, 23.554000000000002, 15.82633333333333, 15.73166666666666, 23.38533333333333, 20.460666666666658, 29.856999999999996, 25.285999999999994, 50.85866666666667, 18.73133333333333, 18.661333333333335, 19.282999999999998, 22.30566666666667, 17.490999999999996, 22.95233333333333, 43.255666666666684, 18.000666666666664, 27.525666666666663, 35.342, 30.698333333333327, 23.898000000000003, 18.70666666666666, 55.541333333333334, 23.80899999999999, 49.51800000000001, 16.590333333333326, 15.241999999999997, 16.692333333333327, 41.27533333333333, 38.17466666666666, 30.177666666666667, 52.11033333333338, 12.632999999999997, 18.295666666666662, 13.712, 15.851999999999995, 36.57466666666665, 28.560333333333336, 16.564333333333323, 15.501666666666665, 28.679666666666666, 20.768666666666668, 17.605, 48.93533333333335, 40.19366666666667, 20.789333333333328, 33.827333333333335, 34.62266666666665, 52.16866666666671, 14.480666666666663, 28.600000000000012, 52.71800000000004, 32.51866666666667, 24.759666666666668, 30.71533333333333, 16.476333333333333, 57.72233333333334, 17.79733333333333, 18.52766666666666, 19.57433333333333, 51.8616666666667, 52.89566666666671, 14.64133333333333, 16.282666666666668, 21.300666666666658, 24.715666666666653, 31.413999999999998, 17.981999999999992, 22.77433333333333, 24.398333333333333, 19.749666666666666, 65.18766666666669, 17.43699999999999, 24.866999999999987], "episode_lengths": [60, 61, 33, 44, 48, 40, 44, 60, 72, 40, 57, 63, 74, 65, 49, 44, 43, 42, 58, 63, 42, 33, 46, 71, 53, 36, 61, 51, 32, 32, 45, 39, 56, 41, 88, 37, 43, 38, 49, 36, 43, 72, 33, 60, 60, 62, 51, 37, 97, 48, 81, 32, 33, 34, 67, 67, 55, 98, 24, 39, 27, 30, 71, 70, 34, 32, 68, 43, 32, 77, 76, 43, 81, 66, 95, 29, 60, 99, 71, 51, 59, 32, 108, 35, 38, 40, 117, 103, 29, 31, 41, 48, 59, 33, 42, 46, 39, 116, 36, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2028912337841033, "mean_inference_ms": 2.1765859644593104, "mean_action_processing_ms": 0.4749717437088292, "mean_env_wait_ms": 0.11356935915160196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017725229263305664, "StateBufferConnector_ms": 0.017446517944335938, "ViewRequirementAgentConnector_ms": 0.39624977111816406}}, "episode_reward_max": 65.18766666666669, "episode_reward_min": 12.632999999999997, "episode_reward_mean": 27.546153333333333, "episode_len_mean": 53.43, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.863666666666667, 29.73933333333332, 16.242, 22.199666666666662, 22.102999999999998, 20.564999999999998, 21.219666666666658, 28.65333333333332, 39.295, 18.68433333333333, 30.51666666666666, 33.325333333333326, 46.43033333333332, 38.096000000000004, 30.77133333333334, 22.922333333333324, 20.46399999999999, 20.521, 30.100333333333335, 31.079000000000008, 22.091666666666665, 16.350333333333328, 23.89633333333333, 30.35566666666668, 27.144666666666673, 16.802999999999997, 31.55800000000001, 23.554000000000002, 15.82633333333333, 15.73166666666666, 23.38533333333333, 20.460666666666658, 29.856999999999996, 25.285999999999994, 50.85866666666667, 18.73133333333333, 18.661333333333335, 19.282999999999998, 22.30566666666667, 17.490999999999996, 22.95233333333333, 43.255666666666684, 18.000666666666664, 27.525666666666663, 35.342, 30.698333333333327, 23.898000000000003, 18.70666666666666, 55.541333333333334, 23.80899999999999, 49.51800000000001, 16.590333333333326, 15.241999999999997, 16.692333333333327, 41.27533333333333, 38.17466666666666, 30.177666666666667, 52.11033333333338, 12.632999999999997, 18.295666666666662, 13.712, 15.851999999999995, 36.57466666666665, 28.560333333333336, 16.564333333333323, 15.501666666666665, 28.679666666666666, 20.768666666666668, 17.605, 48.93533333333335, 40.19366666666667, 20.789333333333328, 33.827333333333335, 34.62266666666665, 52.16866666666671, 14.480666666666663, 28.600000000000012, 52.71800000000004, 32.51866666666667, 24.759666666666668, 30.71533333333333, 16.476333333333333, 57.72233333333334, 17.79733333333333, 18.52766666666666, 19.57433333333333, 51.8616666666667, 52.89566666666671, 14.64133333333333, 16.282666666666668, 21.300666666666658, 24.715666666666653, 31.413999999999998, 17.981999999999992, 22.77433333333333, 24.398333333333333, 19.749666666666666, 65.18766666666669, 17.43699999999999, 24.866999999999987], "episode_lengths": [60, 61, 33, 44, 48, 40, 44, 60, 72, 40, 57, 63, 74, 65, 49, 44, 43, 42, 58, 63, 42, 33, 46, 71, 53, 36, 61, 51, 32, 32, 45, 39, 56, 41, 88, 37, 43, 38, 49, 36, 43, 72, 33, 60, 60, 62, 51, 37, 97, 48, 81, 32, 33, 34, 67, 67, 55, 98, 24, 39, 27, 30, 71, 70, 34, 32, 68, 43, 32, 77, 76, 43, 81, 66, 95, 29, 60, 99, 71, 51, 59, 32, 108, 35, 38, 40, 117, 103, 29, 31, 41, 48, 59, 33, 42, 46, 39, 116, 36, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2028912337841033, "mean_inference_ms": 2.1765859644593104, "mean_action_processing_ms": 0.4749717437088292, "mean_env_wait_ms": 0.11356935915160196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017725229263305664, "StateBufferConnector_ms": 0.017446517944335938, "ViewRequirementAgentConnector_ms": 0.39624977111816406}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 519.2623999963849, "num_env_steps_trained_throughput_per_sec": 519.2623999963849, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 6280.056, "sample_time_ms": 2172.142, "load_time_ms": 0.15, "load_throughput": 26664361.093, "learn_time_ms": 4090.937, "learn_throughput": 977.771, "synch_weights_time_ms": 15.366}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 4044, "training_iteration": 47, "trial_id": "432ea_00000", "date": "2023-12-07_16-30-53", "timestamp": 1701995453, "time_this_iter_s": 7.713346719741821, "time_total_s": 286.39532589912415, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 286.39532589912415, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 63.28181818181818, "ram_util_percent": 93.66363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2278178690774966e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 6.482101917266846, "policy_loss": 0.0050852177664637566, "vf_loss": 6.477017402648926, "vf_explained_var": 0.554394543170929, "kl": 0.0009337919764220715, "entropy": 0.11555226147174835, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 83.65366666666672, "episode_reward_min": 14.02233333333333, "episode_reward_mean": 29.64608, "episode_len_mean": 57.07, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.789333333333328, 33.827333333333335, 34.62266666666665, 52.16866666666671, 14.480666666666663, 28.600000000000012, 52.71800000000004, 32.51866666666667, 24.759666666666668, 30.71533333333333, 16.476333333333333, 57.72233333333334, 17.79733333333333, 18.52766666666666, 19.57433333333333, 51.8616666666667, 52.89566666666671, 14.64133333333333, 16.282666666666668, 21.300666666666658, 24.715666666666653, 31.413999999999998, 17.981999999999992, 22.77433333333333, 24.398333333333333, 19.749666666666666, 65.18766666666669, 17.43699999999999, 24.866999999999987, 18.67133333333333, 36.08166666666667, 20.63366666666666, 23.924333333333333, 42.18099999999998, 30.281999999999986, 36.02466666666666, 16.61766666666666, 18.099999999999994, 35.913999999999994, 27.56399999999999, 22.177000000000007, 76.4383333333333, 45.756333333333345, 36.53633333333334, 18.304666666666662, 47.141666666666666, 32.11633333333334, 21.614999999999988, 26.638666666666662, 53.171333333333344, 22.96966666666666, 24.084666666666664, 83.65366666666672, 14.781333333333334, 18.30699999999999, 30.127666666666663, 15.224666666666653, 24.075333333333326, 47.127666666666684, 40.270000000000024, 32.734333333333346, 18.35066666666666, 44.71033333333335, 18.957333333333327, 15.798333333333334, 17.347666666666665, 25.681333333333342, 30.43699999999999, 37.30899999999998, 28.48233333333334, 23.546999999999997, 39.15800000000002, 14.118666666666666, 41.498999999999974, 23.516666666666662, 52.489666666666714, 17.283333333333328, 17.637333333333334, 26.93466666666667, 16.854666666666656, 26.54566666666665, 14.02233333333333, 15.592999999999998, 41.51233333333335, 23.04366666666666, 15.970666666666665, 20.863666666666667, 61.37366666666666, 30.637, 22.878999999999994, 22.395, 33.46033333333334, 38.639, 36.47399999999999, 17.69966666666666, 19.81933333333333, 29.65000000000001, 14.54333333333333, 52.11233333333335, 17.208999999999996], "episode_lengths": [43, 81, 66, 95, 29, 60, 99, 71, 51, 59, 32, 108, 35, 38, 40, 117, 103, 29, 31, 41, 48, 59, 33, 42, 46, 39, 116, 36, 54, 39, 60, 46, 42, 81, 59, 71, 35, 37, 71, 60, 45, 137, 94, 54, 37, 87, 68, 42, 47, 99, 41, 53, 138, 29, 40, 62, 31, 53, 84, 65, 58, 41, 80, 39, 30, 36, 51, 53, 68, 54, 40, 69, 29, 88, 47, 106, 31, 33, 61, 39, 48, 28, 37, 68, 47, 33, 44, 94, 62, 44, 40, 67, 73, 61, 36, 46, 50, 33, 103, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2021254742855663, "mean_inference_ms": 2.1730734890212746, "mean_action_processing_ms": 0.4746375387226479, "mean_env_wait_ms": 0.11350240575883958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01820230484008789, "StateBufferConnector_ms": 0.018522024154663086, "ViewRequirementAgentConnector_ms": 0.38960957527160645}}, "episode_reward_max": 83.65366666666672, "episode_reward_min": 14.02233333333333, "episode_reward_mean": 29.64608, "episode_len_mean": 57.07, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.789333333333328, 33.827333333333335, 34.62266666666665, 52.16866666666671, 14.480666666666663, 28.600000000000012, 52.71800000000004, 32.51866666666667, 24.759666666666668, 30.71533333333333, 16.476333333333333, 57.72233333333334, 17.79733333333333, 18.52766666666666, 19.57433333333333, 51.8616666666667, 52.89566666666671, 14.64133333333333, 16.282666666666668, 21.300666666666658, 24.715666666666653, 31.413999999999998, 17.981999999999992, 22.77433333333333, 24.398333333333333, 19.749666666666666, 65.18766666666669, 17.43699999999999, 24.866999999999987, 18.67133333333333, 36.08166666666667, 20.63366666666666, 23.924333333333333, 42.18099999999998, 30.281999999999986, 36.02466666666666, 16.61766666666666, 18.099999999999994, 35.913999999999994, 27.56399999999999, 22.177000000000007, 76.4383333333333, 45.756333333333345, 36.53633333333334, 18.304666666666662, 47.141666666666666, 32.11633333333334, 21.614999999999988, 26.638666666666662, 53.171333333333344, 22.96966666666666, 24.084666666666664, 83.65366666666672, 14.781333333333334, 18.30699999999999, 30.127666666666663, 15.224666666666653, 24.075333333333326, 47.127666666666684, 40.270000000000024, 32.734333333333346, 18.35066666666666, 44.71033333333335, 18.957333333333327, 15.798333333333334, 17.347666666666665, 25.681333333333342, 30.43699999999999, 37.30899999999998, 28.48233333333334, 23.546999999999997, 39.15800000000002, 14.118666666666666, 41.498999999999974, 23.516666666666662, 52.489666666666714, 17.283333333333328, 17.637333333333334, 26.93466666666667, 16.854666666666656, 26.54566666666665, 14.02233333333333, 15.592999999999998, 41.51233333333335, 23.04366666666666, 15.970666666666665, 20.863666666666667, 61.37366666666666, 30.637, 22.878999999999994, 22.395, 33.46033333333334, 38.639, 36.47399999999999, 17.69966666666666, 19.81933333333333, 29.65000000000001, 14.54333333333333, 52.11233333333335, 17.208999999999996], "episode_lengths": [43, 81, 66, 95, 29, 60, 99, 71, 51, 59, 32, 108, 35, 38, 40, 117, 103, 29, 31, 41, 48, 59, 33, 42, 46, 39, 116, 36, 54, 39, 60, 46, 42, 81, 59, 71, 35, 37, 71, 60, 45, 137, 94, 54, 37, 87, 68, 42, 47, 99, 41, 53, 138, 29, 40, 62, 31, 53, 84, 65, 58, 41, 80, 39, 30, 36, 51, 53, 68, 54, 40, 69, 29, 88, 47, 106, 31, 33, 61, 39, 48, 28, 37, 68, 47, 33, 44, 94, 62, 44, 40, 67, 73, 61, 36, 46, 50, 33, 103, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2021254742855663, "mean_inference_ms": 2.1730734890212746, "mean_action_processing_ms": 0.4746375387226479, "mean_env_wait_ms": 0.11350240575883958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01820230484008789, "StateBufferConnector_ms": 0.018522024154663086, "ViewRequirementAgentConnector_ms": 0.38960957527160645}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.12593280530854, "num_env_steps_trained_throughput_per_sec": 475.12593280530854, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 6635.847, "sample_time_ms": 2174.352, "load_time_ms": 0.2, "load_throughput": 19989534.136, "learn_time_ms": 4443.94, "learn_throughput": 900.102, "synch_weights_time_ms": 16.095}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 4115, "training_iteration": 48, "trial_id": "432ea_00000", "date": "2023-12-07_16-31-01", "timestamp": 1701995461, "time_this_iter_s": 8.429751634597778, "time_total_s": 294.8250775337219, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 294.8250775337219, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 64.46666666666668, "ram_util_percent": 93.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.139089345387483e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 5.874883651733398, "policy_loss": -0.00549141364172101, "vf_loss": 5.880374431610107, "vf_explained_var": 0.5952433347702026, "kl": 0.0014818068593740463, "entropy": 0.1302538812160492, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 61.37366666666666, "episode_reward_min": 14.02233333333333, "episode_reward_mean": 27.804570000000002, "episode_len_mean": 53.64, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.516666666666662, 52.489666666666714, 17.283333333333328, 17.637333333333334, 26.93466666666667, 16.854666666666656, 26.54566666666665, 14.02233333333333, 15.592999999999998, 41.51233333333335, 23.04366666666666, 15.970666666666665, 20.863666666666667, 61.37366666666666, 30.637, 22.878999999999994, 22.395, 33.46033333333334, 38.639, 36.47399999999999, 17.69966666666666, 19.81933333333333, 29.65000000000001, 14.54333333333333, 52.11233333333335, 17.208999999999996, 27.94233333333332, 15.998666666666663, 40.242000000000026, 21.264333333333326, 26.50466666666664, 34.89233333333335, 29.898333333333323, 25.639666666666667, 24.57, 59.8426666666667, 22.053333333333324, 19.11433333333333, 41.901666666666664, 38.42933333333333, 21.82466666666667, 29.564999999999998, 28.63899999999998, 48.92066666666666, 20.246666666666655, 22.36999999999999, 29.610333333333347, 27.009333333333327, 32.35533333333334, 26.788333333333316, 20.085333333333335, 34.26299999999997, 20.185999999999993, 15.710333333333327, 15.43766666666666, 20.639999999999997, 27.141666666666676, 21.843, 17.446999999999992, 29.387666666666643, 26.144333333333314, 19.59933333333333, 21.50566666666666, 25.447333333333322, 36.31566666666666, 36.87266666666667, 19.647333333333332, 14.570333333333329, 30.450333333333337, 35.92366666666667, 20.922666666666668, 17.179, 23.769666666666666, 43.38366666666667, 29.150333333333332, 31.584666666666674, 19.43266666666666, 24.266999999999996, 40.005333333333326, 24.211666666666666, 21.738000000000007, 54.1343333333334, 23.678333333333327, 19.19133333333333, 17.673333333333325, 49.52366666666665, 15.46033333333333, 24.838666666666672, 17.525, 18.318333333333324, 48.38233333333331, 24.304, 44.99500000000001, 23.164666666666662, 16.665666666666663, 20.075999999999986, 38.05866666666666, 29.049999999999986, 42.08333333333335, 44.28866666666668], "episode_lengths": [47, 106, 31, 33, 61, 39, 48, 28, 37, 68, 47, 33, 44, 94, 62, 44, 40, 67, 73, 61, 36, 46, 50, 33, 103, 32, 62, 31, 65, 42, 53, 68, 62, 54, 50, 105, 41, 36, 84, 77, 41, 57, 56, 73, 43, 47, 52, 45, 61, 52, 44, 68, 39, 35, 32, 41, 60, 38, 36, 52, 48, 43, 48, 57, 66, 61, 45, 30, 56, 72, 41, 32, 62, 78, 60, 54, 41, 40, 75, 52, 41, 109, 55, 39, 37, 75, 32, 57, 32, 40, 78, 47, 87, 49, 34, 45, 75, 55, 77, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.200571361282022, "mean_inference_ms": 2.1684390772887205, "mean_action_processing_ms": 0.47367018062014155, "mean_env_wait_ms": 0.1133459912602797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508021354675293, "StateBufferConnector_ms": 0.018062591552734375, "ViewRequirementAgentConnector_ms": 0.3708016872406006}}, "episode_reward_max": 61.37366666666666, "episode_reward_min": 14.02233333333333, "episode_reward_mean": 27.804570000000002, "episode_len_mean": 53.64, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.516666666666662, 52.489666666666714, 17.283333333333328, 17.637333333333334, 26.93466666666667, 16.854666666666656, 26.54566666666665, 14.02233333333333, 15.592999999999998, 41.51233333333335, 23.04366666666666, 15.970666666666665, 20.863666666666667, 61.37366666666666, 30.637, 22.878999999999994, 22.395, 33.46033333333334, 38.639, 36.47399999999999, 17.69966666666666, 19.81933333333333, 29.65000000000001, 14.54333333333333, 52.11233333333335, 17.208999999999996, 27.94233333333332, 15.998666666666663, 40.242000000000026, 21.264333333333326, 26.50466666666664, 34.89233333333335, 29.898333333333323, 25.639666666666667, 24.57, 59.8426666666667, 22.053333333333324, 19.11433333333333, 41.901666666666664, 38.42933333333333, 21.82466666666667, 29.564999999999998, 28.63899999999998, 48.92066666666666, 20.246666666666655, 22.36999999999999, 29.610333333333347, 27.009333333333327, 32.35533333333334, 26.788333333333316, 20.085333333333335, 34.26299999999997, 20.185999999999993, 15.710333333333327, 15.43766666666666, 20.639999999999997, 27.141666666666676, 21.843, 17.446999999999992, 29.387666666666643, 26.144333333333314, 19.59933333333333, 21.50566666666666, 25.447333333333322, 36.31566666666666, 36.87266666666667, 19.647333333333332, 14.570333333333329, 30.450333333333337, 35.92366666666667, 20.922666666666668, 17.179, 23.769666666666666, 43.38366666666667, 29.150333333333332, 31.584666666666674, 19.43266666666666, 24.266999999999996, 40.005333333333326, 24.211666666666666, 21.738000000000007, 54.1343333333334, 23.678333333333327, 19.19133333333333, 17.673333333333325, 49.52366666666665, 15.46033333333333, 24.838666666666672, 17.525, 18.318333333333324, 48.38233333333331, 24.304, 44.99500000000001, 23.164666666666662, 16.665666666666663, 20.075999999999986, 38.05866666666666, 29.049999999999986, 42.08333333333335, 44.28866666666668], "episode_lengths": [47, 106, 31, 33, 61, 39, 48, 28, 37, 68, 47, 33, 44, 94, 62, 44, 40, 67, 73, 61, 36, 46, 50, 33, 103, 32, 62, 31, 65, 42, 53, 68, 62, 54, 50, 105, 41, 36, 84, 77, 41, 57, 56, 73, 43, 47, 52, 45, 61, 52, 44, 68, 39, 35, 32, 41, 60, 38, 36, 52, 48, 43, 48, 57, 66, 61, 45, 30, 56, 72, 41, 32, 62, 78, 60, 54, 41, 40, 75, 52, 41, 109, 55, 39, 37, 75, 32, 57, 32, 40, 78, 47, 87, 49, 34, 45, 75, 55, 77, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.200571361282022, "mean_inference_ms": 2.1684390772887205, "mean_action_processing_ms": 0.47367018062014155, "mean_env_wait_ms": 0.1133459912602797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508021354675293, "StateBufferConnector_ms": 0.018062591552734375, "ViewRequirementAgentConnector_ms": 0.3708016872406006}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 567.259656189015, "num_env_steps_trained_throughput_per_sec": 567.259656189015, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 6817.166, "sample_time_ms": 2171.581, "load_time_ms": 0.1, "load_throughput": 39983832.221, "learn_time_ms": 4628.033, "learn_throughput": 864.298, "synch_weights_time_ms": 16.193}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 4189, "training_iteration": 49, "trial_id": "432ea_00000", "date": "2023-12-07_16-31-08", "timestamp": 1701995468, "time_this_iter_s": 7.063457012176514, "time_total_s": 301.88853454589844, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 301.88853454589844, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 68.67, "ram_util_percent": 93.60999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0695446726937414e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 5.444573879241943, "policy_loss": -0.007795426994562149, "vf_loss": 5.45236873626709, "vf_explained_var": 0.6313781142234802, "kl": 0.002603430300951004, "entropy": 0.09561552852392197, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 74.579, "episode_reward_min": 13.901333333333335, "episode_reward_mean": 27.54044, "episode_len_mean": 52.57, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.266999999999996, 40.005333333333326, 24.211666666666666, 21.738000000000007, 54.1343333333334, 23.678333333333327, 19.19133333333333, 17.673333333333325, 49.52366666666665, 15.46033333333333, 24.838666666666672, 17.525, 18.318333333333324, 48.38233333333331, 24.304, 44.99500000000001, 23.164666666666662, 16.665666666666663, 20.075999999999986, 38.05866666666666, 29.049999999999986, 42.08333333333335, 44.28866666666668, 28.183666666666664, 31.812000000000012, 15.682999999999993, 44.05600000000002, 19.267666666666667, 20.189999999999984, 18.485666666666663, 44.15266666666667, 19.64199999999999, 44.47033333333333, 14.552666666666662, 19.23166666666667, 20.252333333333333, 15.607999999999995, 34.17566666666665, 20.995333333333328, 20.140333333333324, 29.64199999999999, 17.909666666666656, 25.97833333333332, 31.12666666666667, 30.45699999999999, 20.58833333333333, 25.033666666666665, 16.300333333333327, 36.27466666666667, 17.881666666666664, 18.92666666666666, 19.607, 16.18833333333333, 18.312666666666665, 23.949666666666666, 47.47433333333332, 39.51866666666667, 20.234999999999992, 30.28066666666667, 21.947333333333333, 14.264666666666663, 23.162999999999997, 52.12500000000003, 18.658999999999995, 18.865333333333325, 44.97033333333334, 37.03, 19.652, 17.870666666666658, 57.727, 74.579, 55.41366666666667, 14.00366666666666, 27.785000000000007, 14.124333333333325, 22.426000000000005, 27.22699999999999, 15.645000000000001, 36.09300000000001, 17.548999999999996, 18.182333333333325, 26.82833333333332, 17.514999999999997, 41.973666666666674, 56.800666666666665, 27.590999999999987, 17.025333333333336, 20.853333333333325, 22.493, 22.160999999999998, 33.83366666666668, 19.77833333333333, 23.33366666666666, 25.272999999999996, 27.168666666666674, 24.57199999999999, 18.76133333333333, 33.83066666666666, 13.901333333333335, 32.82966666666667], "episode_lengths": [40, 75, 52, 41, 109, 55, 39, 37, 75, 32, 57, 32, 40, 78, 47, 87, 49, 34, 45, 75, 55, 77, 74, 52, 59, 34, 81, 40, 43, 40, 81, 37, 69, 31, 43, 41, 29, 65, 49, 40, 63, 34, 52, 55, 60, 42, 50, 34, 59, 32, 37, 40, 33, 37, 48, 80, 71, 38, 63, 47, 29, 42, 82, 34, 41, 75, 66, 37, 35, 111, 118, 97, 26, 47, 25, 49, 54, 30, 74, 38, 30, 59, 32, 70, 99, 54, 33, 45, 44, 46, 69, 42, 43, 56, 65, 49, 37, 73, 29, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1978769463944021, "mean_inference_ms": 2.16658935421833, "mean_action_processing_ms": 0.4726071139384953, "mean_env_wait_ms": 0.1130562535621388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012489795684814453, "StateBufferConnector_ms": 0.011554479598999023, "ViewRequirementAgentConnector_ms": 0.32537388801574707}}, "episode_reward_max": 74.579, "episode_reward_min": 13.901333333333335, "episode_reward_mean": 27.54044, "episode_len_mean": 52.57, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.266999999999996, 40.005333333333326, 24.211666666666666, 21.738000000000007, 54.1343333333334, 23.678333333333327, 19.19133333333333, 17.673333333333325, 49.52366666666665, 15.46033333333333, 24.838666666666672, 17.525, 18.318333333333324, 48.38233333333331, 24.304, 44.99500000000001, 23.164666666666662, 16.665666666666663, 20.075999999999986, 38.05866666666666, 29.049999999999986, 42.08333333333335, 44.28866666666668, 28.183666666666664, 31.812000000000012, 15.682999999999993, 44.05600000000002, 19.267666666666667, 20.189999999999984, 18.485666666666663, 44.15266666666667, 19.64199999999999, 44.47033333333333, 14.552666666666662, 19.23166666666667, 20.252333333333333, 15.607999999999995, 34.17566666666665, 20.995333333333328, 20.140333333333324, 29.64199999999999, 17.909666666666656, 25.97833333333332, 31.12666666666667, 30.45699999999999, 20.58833333333333, 25.033666666666665, 16.300333333333327, 36.27466666666667, 17.881666666666664, 18.92666666666666, 19.607, 16.18833333333333, 18.312666666666665, 23.949666666666666, 47.47433333333332, 39.51866666666667, 20.234999999999992, 30.28066666666667, 21.947333333333333, 14.264666666666663, 23.162999999999997, 52.12500000000003, 18.658999999999995, 18.865333333333325, 44.97033333333334, 37.03, 19.652, 17.870666666666658, 57.727, 74.579, 55.41366666666667, 14.00366666666666, 27.785000000000007, 14.124333333333325, 22.426000000000005, 27.22699999999999, 15.645000000000001, 36.09300000000001, 17.548999999999996, 18.182333333333325, 26.82833333333332, 17.514999999999997, 41.973666666666674, 56.800666666666665, 27.590999999999987, 17.025333333333336, 20.853333333333325, 22.493, 22.160999999999998, 33.83366666666668, 19.77833333333333, 23.33366666666666, 25.272999999999996, 27.168666666666674, 24.57199999999999, 18.76133333333333, 33.83066666666666, 13.901333333333335, 32.82966666666667], "episode_lengths": [40, 75, 52, 41, 109, 55, 39, 37, 75, 32, 57, 32, 40, 78, 47, 87, 49, 34, 45, 75, 55, 77, 74, 52, 59, 34, 81, 40, 43, 40, 81, 37, 69, 31, 43, 41, 29, 65, 49, 40, 63, 34, 52, 55, 60, 42, 50, 34, 59, 32, 37, 40, 33, 37, 48, 80, 71, 38, 63, 47, 29, 42, 82, 34, 41, 75, 66, 37, 35, 111, 118, 97, 26, 47, 25, 49, 54, 30, 74, 38, 30, 59, 32, 70, 99, 54, 33, 45, 44, 46, 69, 42, 43, 56, 65, 49, 37, 73, 29, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1978769463944021, "mean_inference_ms": 2.16658935421833, "mean_action_processing_ms": 0.4726071139384953, "mean_env_wait_ms": 0.1130562535621388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012489795684814453, "StateBufferConnector_ms": 0.011554479598999023, "ViewRequirementAgentConnector_ms": 0.32537388801574707}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.8629517260251, "num_env_steps_trained_throughput_per_sec": 781.8629517260251, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 6829.156, "sample_time_ms": 2170.895, "load_time_ms": 0.1, "load_throughput": 39983832.221, "learn_time_ms": 4640.609, "learn_throughput": 861.956, "synch_weights_time_ms": 16.325}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 4266, "training_iteration": 50, "trial_id": "432ea_00000", "date": "2023-12-07_16-31-13", "timestamp": 1701995473, "time_this_iter_s": 5.126999616622925, "time_total_s": 307.01553416252136, "pid": 4160, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000249C2D120E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 307.01553416252136, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 75.8, "ram_util_percent": 87.38571428571429}}
