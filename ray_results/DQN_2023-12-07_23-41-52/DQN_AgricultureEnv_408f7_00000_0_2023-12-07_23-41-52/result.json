{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": -0.20714814960956573, "min_q": -0.7498898506164551, "max_q": 0.21229204535484314, "mean_td_error": -0.6907113790512085, "model": {}}, "td_error": [-0.9737639427185059, -1.3505330085754395, -0.890244722366333, -0.9722055792808533, -0.8103370666503906, -0.3237028419971466, -0.8417371511459351, -0.1152656227350235, -1.0318087339401245, -0.685346245765686, -0.8525964021682739, -1.225982904434204, -0.25952160358428955, -0.3072992265224457, -0.3039723336696625, -0.7560318112373352, -0.36292222142219543, -0.5230814814567566, -0.5010011196136475, -0.5974615812301636, -0.24496518075466156, -0.9183429479598999, -0.22100287675857544, -0.7965329885482788, -0.26162776350975037, -1.0998060703277588, -0.728746771812439, -0.6703542470932007, -0.5617846846580505, -1.5269914865493774, -1.2190172672271729, -0.16877570748329163], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1001, "num_env_steps_trained": 32, "num_agent_steps_sampled": 1001, "num_agent_steps_trained": 32, "last_target_update_ts": 1001, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": 12.056000000000001, "episode_reward_min": 6.174333333333332, "episode_reward_mean": 8.92460544217687, "episode_len_mean": 18.46938775510204, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.808666666666669, 7.759999999999999, 6.174333333333332, 8.107999999999999, 12.056000000000001, 9.735000000000001, 7.3359999999999985, 8.716999999999999, 9.150333333333334, 7.773666666666664, 9.855666666666668, 7.3393333333333315, 8.189333333333332, 11.205999999999998, 7.8343333333333325, 8.378333333333334, 9.049000000000001, 11.761666666666667, 9.257999999999997, 11.017999999999999, 9.521333333333336, 10.674333333333333, 8.82, 11.400666666666664, 7.542, 8.124666666666664, 7.305333333333333, 6.328999999999998, 8.076666666666668, 10.536666666666667, 9.427666666666665, 8.836999999999996, 10.201999999999998, 8.12433333333333, 6.844666666666666, 10.675666666666665, 6.517333333333334, 8.518999999999998, 8.680666666666667, 10.130999999999998, 11.372333333333334, 9.114333333333333, 6.830666666666666, 7.410333333333333, 9.16333333333333, 9.737333333333334, 10.285999999999998, 7.446, 10.146666666666667], "episode_lengths": [20, 17, 14, 18, 22, 22, 18, 17, 20, 17, 19, 15, 17, 19, 18, 17, 19, 23, 19, 20, 18, 23, 20, 21, 17, 18, 16, 13, 17, 19, 19, 19, 20, 19, 15, 21, 14, 17, 18, 21, 25, 18, 15, 18, 18, 19, 19, 15, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.994094339628068, "mean_inference_ms": 4.046385013867939, "mean_action_processing_ms": 0.48574474122789174, "mean_env_wait_ms": 0.12699904895964123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335966849813656, "StateBufferConnector_ms": 0.01514639173235212, "ViewRequirementAgentConnector_ms": 0.42038353122010524}}, "episode_reward_max": 12.056000000000001, "episode_reward_min": 6.174333333333332, "episode_reward_mean": 8.92460544217687, "episode_len_mean": 18.46938775510204, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.808666666666669, 7.759999999999999, 6.174333333333332, 8.107999999999999, 12.056000000000001, 9.735000000000001, 7.3359999999999985, 8.716999999999999, 9.150333333333334, 7.773666666666664, 9.855666666666668, 7.3393333333333315, 8.189333333333332, 11.205999999999998, 7.8343333333333325, 8.378333333333334, 9.049000000000001, 11.761666666666667, 9.257999999999997, 11.017999999999999, 9.521333333333336, 10.674333333333333, 8.82, 11.400666666666664, 7.542, 8.124666666666664, 7.305333333333333, 6.328999999999998, 8.076666666666668, 10.536666666666667, 9.427666666666665, 8.836999999999996, 10.201999999999998, 8.12433333333333, 6.844666666666666, 10.675666666666665, 6.517333333333334, 8.518999999999998, 8.680666666666667, 10.130999999999998, 11.372333333333334, 9.114333333333333, 6.830666666666666, 7.410333333333333, 9.16333333333333, 9.737333333333334, 10.285999999999998, 7.446, 10.146666666666667], "episode_lengths": [20, 17, 14, 18, 22, 22, 18, 17, 20, 17, 19, 15, 17, 19, 18, 17, 19, 23, 19, 20, 18, 23, 20, 21, 17, 18, 16, 13, 17, 19, 19, 19, 20, 19, 15, 21, 14, 17, 18, 21, 25, 18, 15, 18, 18, 19, 19, 15, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.994094339628068, "mean_inference_ms": 4.046385013867939, "mean_action_processing_ms": 0.48574474122789174, "mean_env_wait_ms": 0.12699904895964123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335966849813656, "StateBufferConnector_ms": 0.01514639173235212, "ViewRequirementAgentConnector_ms": 0.42038353122010524}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1001, "num_agent_steps_trained": 32, "num_env_steps_sampled": 1001, "num_env_steps_trained": 32, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 32, "num_env_steps_sampled_throughput_per_sec": 235.76897943858938, "num_env_steps_trained_throughput_per_sec": 7.537070271763097, "timesteps_total": 1001, "num_steps_trained_this_iter": 32, "agent_timesteps_total": 1001, "timers": {"training_iteration_time_ms": 69.544, "sample_time_ms": 18.78, "load_time_ms": 0.417, "load_throughput": 76652.043, "learn_time_ms": 444.261, "learn_throughput": 72.03, "synch_weights_time_ms": 20.787}, "counters": {"num_env_steps_sampled": 1001, "num_env_steps_trained": 32, "num_agent_steps_sampled": 1001, "num_agent_steps_trained": 32, "last_target_update_ts": 1001, "num_target_updates": 1}, "done": false, "episodes_total": 49, "training_iteration": 1, "trial_id": "408f7_00000", "date": "2023-12-07_23-43-19", "timestamp": 1702021399, "time_this_iter_s": 4.264691352844238, "time_total_s": 4.264691352844238, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.264691352844238, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.25714285714286, "ram_util_percent": 97.07142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 1.9250913858413696, "min_q": 0.8537694215774536, "max_q": 2.6635828018188477, "mean_td_error": 0.1414715051651001, "model": {}}, "td_error": [0.17184853553771973, 1.2243623733520508, -0.2490673065185547, 0.0006678104400634766, -0.38420844078063965, -0.20596182346343994, -0.22513198852539062, 1.7182494401931763, 1.4426825046539307, 1.4291391372680664, 0.26766538619995117, -0.6956274509429932, 0.06930947303771973, 0.0005189180374145508, 0.011641979217529297, -0.19813084602355957, 0.012482285499572754, -0.4239330291748047, -0.6262538433074951, -0.5744419097900391, -0.08131098747253418, 1.2833304405212402, -0.14653313159942627, -0.07014942169189453, -0.12532436847686768, -0.0030066967010498047, -0.08368420600891113, -0.2492314577102661, -0.20236754417419434, -0.10095179080963135, 0.13632237911224365, 1.4041842222213745], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 144.0, "diff_num_grad_updates_vs_sampler_policy": 143.0}}, "num_env_steps_sampled": 2002, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 2002, "num_agent_steps_trained": 4608, "last_target_update_ts": 1505, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": 14.677333333333333, "episode_reward_min": 6.328999999999998, "episode_reward_mean": 8.994419999999998, "episode_len_mean": 18.94, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.107999999999999, 12.056000000000001, 9.735000000000001, 7.3359999999999985, 8.716999999999999, 9.150333333333334, 7.773666666666664, 9.855666666666668, 7.3393333333333315, 8.189333333333332, 11.205999999999998, 7.8343333333333325, 8.378333333333334, 9.049000000000001, 11.761666666666667, 9.257999999999997, 11.017999999999999, 9.521333333333336, 10.674333333333333, 8.82, 11.400666666666664, 7.542, 8.124666666666664, 7.305333333333333, 6.328999999999998, 8.076666666666668, 10.536666666666667, 9.427666666666665, 8.836999999999996, 10.201999999999998, 8.12433333333333, 6.844666666666666, 10.675666666666665, 6.517333333333334, 8.518999999999998, 8.680666666666667, 10.130999999999998, 11.372333333333334, 9.114333333333333, 6.830666666666666, 7.410333333333333, 9.16333333333333, 9.737333333333334, 10.285999999999998, 7.446, 10.146666666666667, 12.19466666666666, 10.182999999999998, 7.714, 7.327666666666667, 8.942333333333334, 8.77, 8.841333333333331, 9.432333333333329, 11.445666666666662, 6.909333333333331, 7.033666666666666, 11.984666666666666, 8.550333333333333, 10.055333333333333, 7.637333333333334, 7.1356666666666655, 10.033999999999999, 12.60033333333333, 8.268333333333333, 6.658333333333333, 9.46733333333333, 8.715999999999998, 8.977666666666666, 10.127999999999997, 8.297999999999998, 7.7589999999999995, 7.032333333333333, 7.206999999999999, 9.93833333333333, 9.479666666666665, 7.420333333333332, 9.506, 7.0843333333333325, 12.274333333333333, 8.296333333333331, 7.512666666666666, 7.765000000000001, 8.180333333333333, 8.149999999999999, 14.677333333333333, 8.417333333333332, 7.689666666666666, 9.099333333333332, 6.823333333333333, 7.1403333333333325, 8.665666666666667, 8.478666666666665, 10.918, 11.058333333333328, 9.417333333333332, 11.235999999999997, 7.761666666666665, 7.311666666666666, 11.273666666666664], "episode_lengths": [18, 22, 22, 18, 17, 20, 17, 19, 15, 17, 19, 18, 17, 19, 23, 19, 20, 18, 23, 20, 21, 17, 18, 16, 13, 17, 19, 19, 19, 20, 19, 15, 21, 14, 17, 18, 21, 25, 18, 15, 18, 18, 19, 19, 15, 22, 25, 20, 16, 15, 21, 19, 19, 20, 27, 15, 16, 25, 18, 24, 16, 15, 22, 24, 20, 14, 21, 20, 18, 23, 17, 18, 15, 16, 18, 23, 19, 18, 15, 24, 18, 16, 17, 19, 19, 28, 17, 15, 22, 15, 16, 16, 17, 23, 24, 19, 27, 17, 16, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0014802066106636, "mean_inference_ms": 3.7686567471740875, "mean_action_processing_ms": 0.48123011946032035, "mean_env_wait_ms": 0.13364754210504226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030242204666137695, "StateBufferConnector_ms": 0.018021345138549805, "ViewRequirementAgentConnector_ms": 0.4291050434112549}}, "episode_reward_max": 14.677333333333333, "episode_reward_min": 6.328999999999998, "episode_reward_mean": 8.994419999999998, "episode_len_mean": 18.94, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.107999999999999, 12.056000000000001, 9.735000000000001, 7.3359999999999985, 8.716999999999999, 9.150333333333334, 7.773666666666664, 9.855666666666668, 7.3393333333333315, 8.189333333333332, 11.205999999999998, 7.8343333333333325, 8.378333333333334, 9.049000000000001, 11.761666666666667, 9.257999999999997, 11.017999999999999, 9.521333333333336, 10.674333333333333, 8.82, 11.400666666666664, 7.542, 8.124666666666664, 7.305333333333333, 6.328999999999998, 8.076666666666668, 10.536666666666667, 9.427666666666665, 8.836999999999996, 10.201999999999998, 8.12433333333333, 6.844666666666666, 10.675666666666665, 6.517333333333334, 8.518999999999998, 8.680666666666667, 10.130999999999998, 11.372333333333334, 9.114333333333333, 6.830666666666666, 7.410333333333333, 9.16333333333333, 9.737333333333334, 10.285999999999998, 7.446, 10.146666666666667, 12.19466666666666, 10.182999999999998, 7.714, 7.327666666666667, 8.942333333333334, 8.77, 8.841333333333331, 9.432333333333329, 11.445666666666662, 6.909333333333331, 7.033666666666666, 11.984666666666666, 8.550333333333333, 10.055333333333333, 7.637333333333334, 7.1356666666666655, 10.033999999999999, 12.60033333333333, 8.268333333333333, 6.658333333333333, 9.46733333333333, 8.715999999999998, 8.977666666666666, 10.127999999999997, 8.297999999999998, 7.7589999999999995, 7.032333333333333, 7.206999999999999, 9.93833333333333, 9.479666666666665, 7.420333333333332, 9.506, 7.0843333333333325, 12.274333333333333, 8.296333333333331, 7.512666666666666, 7.765000000000001, 8.180333333333333, 8.149999999999999, 14.677333333333333, 8.417333333333332, 7.689666666666666, 9.099333333333332, 6.823333333333333, 7.1403333333333325, 8.665666666666667, 8.478666666666665, 10.918, 11.058333333333328, 9.417333333333332, 11.235999999999997, 7.761666666666665, 7.311666666666666, 11.273666666666664], "episode_lengths": [18, 22, 22, 18, 17, 20, 17, 19, 15, 17, 19, 18, 17, 19, 23, 19, 20, 18, 23, 20, 21, 17, 18, 16, 13, 17, 19, 19, 19, 20, 19, 15, 21, 14, 17, 18, 21, 25, 18, 15, 18, 18, 19, 19, 15, 22, 25, 20, 16, 15, 21, 19, 19, 20, 27, 15, 16, 25, 18, 24, 16, 15, 22, 24, 20, 14, 21, 20, 18, 23, 17, 18, 15, 16, 18, 23, 19, 18, 15, 24, 18, 16, 17, 19, 19, 28, 17, 15, 22, 15, 16, 16, 17, 23, 24, 19, 27, 17, 16, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0014802066106636, "mean_inference_ms": 3.7686567471740875, "mean_action_processing_ms": 0.48123011946032035, "mean_env_wait_ms": 0.13364754210504226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030242204666137695, "StateBufferConnector_ms": 0.018021345138549805, "ViewRequirementAgentConnector_ms": 0.4291050434112549}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2002, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 2002, "num_env_steps_trained": 4608, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 83.55529285928039, "num_env_steps_trained_throughput_per_sec": 381.9670530709961, "timesteps_total": 2002, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 2002, "timers": {"training_iteration_time_ms": 94.916, "sample_time_ms": 32.579, "load_time_ms": 0.326, "load_throughput": 98012.07, "learn_time_ms": 5.478, "learn_throughput": 5841.217, "synch_weights_time_ms": 24.698}, "counters": {"num_env_steps_sampled": 2002, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 2002, "num_agent_steps_trained": 4608, "last_target_update_ts": 1505, "num_target_updates": 2}, "done": false, "episodes_total": 103, "training_iteration": 2, "trial_id": "408f7_00000", "date": "2023-12-07_23-43-31", "timestamp": 1702021411, "time_this_iter_s": 11.999818325042725, "time_total_s": 16.264509677886963, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.264509677886963, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 62.911764705882355, "ram_util_percent": 95.94117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 2.676340103149414, "min_q": 1.4351909160614014, "max_q": 3.557156801223755, "mean_td_error": 0.042091041803359985, "model": {}}, "td_error": [1.407968282699585, 0.060747623443603516, -0.6110861301422119, 0.07244205474853516, -0.1992814540863037, 0.15634489059448242, -0.28174352645874023, -0.8568427562713623, -0.3172001838684082, 0.042990684509277344, -0.32631397247314453, -0.6258952617645264, -0.4819784164428711, 0.45352423191070557, 2.0922975540161133, 0.24533069133758545, -0.025380373001098633, -0.09631681442260742, -0.8568427562713623, 1.4755865335464478, -0.0774695873260498, 1.4318503141403198, -0.025930404663085938, -0.2632877826690674, -0.9268317222595215, -0.30473804473876953, 0.053263306617736816, 0.8265747427940369, 0.023677587509155273, 0.032423973083496094, -0.7191967964172363, -0.03177309036254883], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 287.0, "diff_num_grad_updates_vs_sampler_policy": 286.0}}, "num_env_steps_sampled": 3003, "num_env_steps_trained": 9184, "num_agent_steps_sampled": 3003, "num_agent_steps_trained": 9184, "last_target_update_ts": 2513, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 14.677333333333333, "episode_reward_min": 5.726666666666666, "episode_reward_mean": 8.591646666666668, "episode_len_mean": 18.45, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.909333333333331, 7.033666666666666, 11.984666666666666, 8.550333333333333, 10.055333333333333, 7.637333333333334, 7.1356666666666655, 10.033999999999999, 12.60033333333333, 8.268333333333333, 6.658333333333333, 9.46733333333333, 8.715999999999998, 8.977666666666666, 10.127999999999997, 8.297999999999998, 7.7589999999999995, 7.032333333333333, 7.206999999999999, 9.93833333333333, 9.479666666666665, 7.420333333333332, 9.506, 7.0843333333333325, 12.274333333333333, 8.296333333333331, 7.512666666666666, 7.765000000000001, 8.180333333333333, 8.149999999999999, 14.677333333333333, 8.417333333333332, 7.689666666666666, 9.099333333333332, 6.823333333333333, 7.1403333333333325, 8.665666666666667, 8.478666666666665, 10.918, 11.058333333333328, 9.417333333333332, 11.235999999999997, 7.761666666666665, 7.311666666666666, 11.273666666666664, 8.446666666666664, 7.3536666666666655, 10.231666666666662, 8.219333333333333, 6.777333333333333, 10.068666666666667, 10.807333333333332, 10.408333333333333, 6.751333333333332, 5.864333333333333, 8.503666666666664, 7.593333333333334, 7.809333333333332, 14.354000000000001, 5.877999999999999, 8.635, 6.785999999999999, 7.077333333333334, 6.716999999999999, 7.376999999999999, 8.552333333333333, 10.530999999999997, 9.688999999999998, 6.652333333333332, 8.752333333333333, 6.679333333333332, 6.7286666666666655, 7.566666666666666, 7.480666666666667, 7.871999999999999, 7.614666666666666, 7.182333333333332, 7.3276666666666666, 8.644, 10.385333333333334, 9.071333333333333, 10.138999999999996, 9.572666666666667, 9.941666666666663, 8.360666666666667, 6.2716666666666665, 8.706666666666665, 6.353666666666667, 9.585666666666668, 10.094666666666665, 9.501666666666663, 7.929333333333331, 6.966666666666665, 10.100666666666669, 8.719666666666665, 5.726666666666666, 9.671999999999997, 11.343666666666664, 7.705, 6.055666666666665], "episode_lengths": [15, 16, 25, 18, 24, 16, 15, 22, 24, 20, 14, 21, 20, 18, 23, 17, 18, 15, 16, 18, 23, 19, 18, 15, 24, 18, 16, 17, 19, 19, 28, 17, 15, 22, 15, 16, 16, 17, 23, 24, 19, 27, 17, 16, 23, 18, 17, 25, 17, 15, 19, 21, 22, 15, 15, 18, 17, 16, 30, 13, 20, 15, 14, 14, 15, 18, 21, 21, 14, 20, 14, 17, 18, 15, 16, 17, 15, 17, 19, 22, 20, 22, 20, 22, 18, 13, 17, 15, 21, 19, 22, 17, 15, 21, 18, 14, 20, 21, 17, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.019142035272653, "mean_inference_ms": 3.4236564885834877, "mean_action_processing_ms": 0.47894460941846684, "mean_env_wait_ms": 0.13865452874915235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032579660415649414, "StateBufferConnector_ms": 0.01968240737915039, "ViewRequirementAgentConnector_ms": 0.4625720977783203}}, "episode_reward_max": 14.677333333333333, "episode_reward_min": 5.726666666666666, "episode_reward_mean": 8.591646666666668, "episode_len_mean": 18.45, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.909333333333331, 7.033666666666666, 11.984666666666666, 8.550333333333333, 10.055333333333333, 7.637333333333334, 7.1356666666666655, 10.033999999999999, 12.60033333333333, 8.268333333333333, 6.658333333333333, 9.46733333333333, 8.715999999999998, 8.977666666666666, 10.127999999999997, 8.297999999999998, 7.7589999999999995, 7.032333333333333, 7.206999999999999, 9.93833333333333, 9.479666666666665, 7.420333333333332, 9.506, 7.0843333333333325, 12.274333333333333, 8.296333333333331, 7.512666666666666, 7.765000000000001, 8.180333333333333, 8.149999999999999, 14.677333333333333, 8.417333333333332, 7.689666666666666, 9.099333333333332, 6.823333333333333, 7.1403333333333325, 8.665666666666667, 8.478666666666665, 10.918, 11.058333333333328, 9.417333333333332, 11.235999999999997, 7.761666666666665, 7.311666666666666, 11.273666666666664, 8.446666666666664, 7.3536666666666655, 10.231666666666662, 8.219333333333333, 6.777333333333333, 10.068666666666667, 10.807333333333332, 10.408333333333333, 6.751333333333332, 5.864333333333333, 8.503666666666664, 7.593333333333334, 7.809333333333332, 14.354000000000001, 5.877999999999999, 8.635, 6.785999999999999, 7.077333333333334, 6.716999999999999, 7.376999999999999, 8.552333333333333, 10.530999999999997, 9.688999999999998, 6.652333333333332, 8.752333333333333, 6.679333333333332, 6.7286666666666655, 7.566666666666666, 7.480666666666667, 7.871999999999999, 7.614666666666666, 7.182333333333332, 7.3276666666666666, 8.644, 10.385333333333334, 9.071333333333333, 10.138999999999996, 9.572666666666667, 9.941666666666663, 8.360666666666667, 6.2716666666666665, 8.706666666666665, 6.353666666666667, 9.585666666666668, 10.094666666666665, 9.501666666666663, 7.929333333333331, 6.966666666666665, 10.100666666666669, 8.719666666666665, 5.726666666666666, 9.671999999999997, 11.343666666666664, 7.705, 6.055666666666665], "episode_lengths": [15, 16, 25, 18, 24, 16, 15, 22, 24, 20, 14, 21, 20, 18, 23, 17, 18, 15, 16, 18, 23, 19, 18, 15, 24, 18, 16, 17, 19, 19, 28, 17, 15, 22, 15, 16, 16, 17, 23, 24, 19, 27, 17, 16, 23, 18, 17, 25, 17, 15, 19, 21, 22, 15, 15, 18, 17, 16, 30, 13, 20, 15, 14, 14, 15, 18, 21, 21, 14, 20, 14, 17, 18, 15, 16, 17, 15, 17, 19, 22, 20, 22, 20, 22, 18, 13, 17, 15, 21, 19, 22, 17, 15, 21, 18, 14, 20, 21, 17, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.019142035272653, "mean_inference_ms": 3.4236564885834877, "mean_action_processing_ms": 0.47894460941846684, "mean_env_wait_ms": 0.13865452874915235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032579660415649414, "StateBufferConnector_ms": 0.01968240737915039, "ViewRequirementAgentConnector_ms": 0.4625720977783203}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3003, "num_agent_steps_trained": 9184, "num_env_steps_sampled": 3003, "num_env_steps_trained": 9184, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 76.43189768618333, "num_env_steps_trained_throughput_per_sec": 349.4029608511238, "timesteps_total": 3003, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 3003, "timers": {"training_iteration_time_ms": 130.905, "sample_time_ms": 49.096, "load_time_ms": 0.63, "load_throughput": 50770.816, "learn_time_ms": 7.69, "learn_throughput": 4161.493, "synch_weights_time_ms": 27.85}, "counters": {"num_env_steps_sampled": 3003, "num_env_steps_trained": 9184, "num_agent_steps_sampled": 3003, "num_agent_steps_trained": 9184, "last_target_update_ts": 2513, "num_target_updates": 4}, "done": false, "episodes_total": 158, "training_iteration": 3, "trial_id": "408f7_00000", "date": "2023-12-07_23-43-44", "timestamp": 1702021424, "time_this_iter_s": 13.126637697219849, "time_total_s": 29.39114737510681, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.39114737510681, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 64.78333333333333, "ram_util_percent": 94.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 3.6341171264648438, "min_q": 2.4973630905151367, "max_q": 4.81077766418457, "mean_td_error": 0.03614233434200287, "model": {}}, "td_error": [0.04489326477050781, -0.32123851776123047, 0.13915157318115234, -0.23716044425964355, 0.14186477661132812, -0.822974681854248, 1.5246963500976562, 0.2518889904022217, -0.6341428756713867, 0.41614818572998047, 1.8636554479599, -0.313751220703125, 1.8287835121154785, -0.6046478748321533, -0.09636235237121582, -0.23288440704345703, -0.016450881958007812, 0.03760552406311035, 0.018606185913085938, 0.032132625579833984, -0.03617501258850098, -0.1596691608428955, 0.07974481582641602, -0.15015625953674316, -0.31741976737976074, -0.16176724433898926, 0.04165029525756836, -0.10988903045654297, -0.0567169189453125, -0.5837230682373047, -0.2821173667907715, -0.12701964378356934], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 430.0, "diff_num_grad_updates_vs_sampler_policy": 429.0}}, "num_env_steps_sampled": 4004, "num_env_steps_trained": 13760, "num_agent_steps_sampled": 4004, "num_agent_steps_trained": 13760, "last_target_update_ts": 3521, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 14.354000000000001, "episode_reward_min": 5.726666666666666, "episode_reward_mean": 8.570946666666666, "episode_len_mean": 18.16, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.751333333333332, 5.864333333333333, 8.503666666666664, 7.593333333333334, 7.809333333333332, 14.354000000000001, 5.877999999999999, 8.635, 6.785999999999999, 7.077333333333334, 6.716999999999999, 7.376999999999999, 8.552333333333333, 10.530999999999997, 9.688999999999998, 6.652333333333332, 8.752333333333333, 6.679333333333332, 6.7286666666666655, 7.566666666666666, 7.480666666666667, 7.871999999999999, 7.614666666666666, 7.182333333333332, 7.3276666666666666, 8.644, 10.385333333333334, 9.071333333333333, 10.138999999999996, 9.572666666666667, 9.941666666666663, 8.360666666666667, 6.2716666666666665, 8.706666666666665, 6.353666666666667, 9.585666666666668, 10.094666666666665, 9.501666666666663, 7.929333333333331, 6.966666666666665, 10.100666666666669, 8.719666666666665, 5.726666666666666, 9.671999999999997, 11.343666666666664, 7.705, 6.055666666666665, 10.463333333333331, 12.042666666666664, 10.551666666666666, 8.867333333333336, 9.467999999999998, 10.904666666666662, 7.298333333333333, 13.136666666666663, 9.892999999999997, 8.622, 9.16633333333333, 9.377, 9.067666666666666, 9.501333333333333, 8.813333333333333, 5.773000000000001, 8.908333333333335, 7.421666666666666, 7.283666666666666, 7.005333333333334, 8.990999999999998, 7.779999999999999, 8.167333333333334, 8.259, 8.754, 8.238666666666665, 10.41433333333333, 8.603999999999997, 10.775666666666666, 9.49933333333333, 10.482666666666663, 6.9706666666666655, 6.227999999999998, 10.576999999999998, 7.973666666666665, 9.329999999999998, 7.628999999999999, 11.552333333333333, 7.4449999999999985, 9.505666666666668, 7.139333333333335, 8.969666666666663, 6.842333333333333, 7.090666666666665, 7.339999999999999, 8.843333333333332, 8.283999999999999, 8.613333333333333, 6.893999999999998, 12.963666666666663, 8.382999999999997, 10.35233333333333, 7.813000000000001], "episode_lengths": [15, 15, 18, 17, 16, 30, 13, 20, 15, 14, 14, 15, 18, 21, 21, 14, 20, 14, 17, 18, 15, 16, 17, 15, 17, 19, 22, 20, 22, 20, 22, 18, 13, 17, 15, 21, 19, 22, 17, 15, 21, 18, 14, 20, 21, 17, 15, 23, 24, 21, 18, 19, 22, 14, 26, 19, 17, 17, 19, 20, 19, 19, 13, 17, 16, 16, 16, 20, 18, 18, 17, 18, 21, 20, 18, 22, 19, 23, 16, 13, 21, 17, 18, 16, 24, 16, 19, 15, 20, 15, 14, 16, 18, 18, 18, 15, 27, 21, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.045502332816809, "mean_inference_ms": 3.321132223745161, "mean_action_processing_ms": 0.4855039154846051, "mean_env_wait_ms": 0.14070129783525404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03261613845825195, "StateBufferConnector_ms": 0.020429134368896484, "ViewRequirementAgentConnector_ms": 0.45595717430114746}}, "episode_reward_max": 14.354000000000001, "episode_reward_min": 5.726666666666666, "episode_reward_mean": 8.570946666666666, "episode_len_mean": 18.16, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.751333333333332, 5.864333333333333, 8.503666666666664, 7.593333333333334, 7.809333333333332, 14.354000000000001, 5.877999999999999, 8.635, 6.785999999999999, 7.077333333333334, 6.716999999999999, 7.376999999999999, 8.552333333333333, 10.530999999999997, 9.688999999999998, 6.652333333333332, 8.752333333333333, 6.679333333333332, 6.7286666666666655, 7.566666666666666, 7.480666666666667, 7.871999999999999, 7.614666666666666, 7.182333333333332, 7.3276666666666666, 8.644, 10.385333333333334, 9.071333333333333, 10.138999999999996, 9.572666666666667, 9.941666666666663, 8.360666666666667, 6.2716666666666665, 8.706666666666665, 6.353666666666667, 9.585666666666668, 10.094666666666665, 9.501666666666663, 7.929333333333331, 6.966666666666665, 10.100666666666669, 8.719666666666665, 5.726666666666666, 9.671999999999997, 11.343666666666664, 7.705, 6.055666666666665, 10.463333333333331, 12.042666666666664, 10.551666666666666, 8.867333333333336, 9.467999999999998, 10.904666666666662, 7.298333333333333, 13.136666666666663, 9.892999999999997, 8.622, 9.16633333333333, 9.377, 9.067666666666666, 9.501333333333333, 8.813333333333333, 5.773000000000001, 8.908333333333335, 7.421666666666666, 7.283666666666666, 7.005333333333334, 8.990999999999998, 7.779999999999999, 8.167333333333334, 8.259, 8.754, 8.238666666666665, 10.41433333333333, 8.603999999999997, 10.775666666666666, 9.49933333333333, 10.482666666666663, 6.9706666666666655, 6.227999999999998, 10.576999999999998, 7.973666666666665, 9.329999999999998, 7.628999999999999, 11.552333333333333, 7.4449999999999985, 9.505666666666668, 7.139333333333335, 8.969666666666663, 6.842333333333333, 7.090666666666665, 7.339999999999999, 8.843333333333332, 8.283999999999999, 8.613333333333333, 6.893999999999998, 12.963666666666663, 8.382999999999997, 10.35233333333333, 7.813000000000001], "episode_lengths": [15, 15, 18, 17, 16, 30, 13, 20, 15, 14, 14, 15, 18, 21, 21, 14, 20, 14, 17, 18, 15, 16, 17, 15, 17, 19, 22, 20, 22, 20, 22, 18, 13, 17, 15, 21, 19, 22, 17, 15, 21, 18, 14, 20, 21, 17, 15, 23, 24, 21, 18, 19, 22, 14, 26, 19, 17, 17, 19, 20, 19, 19, 13, 17, 16, 16, 16, 20, 18, 18, 17, 18, 21, 20, 18, 22, 19, 23, 16, 13, 21, 17, 18, 16, 24, 16, 19, 15, 20, 15, 14, 16, 18, 18, 18, 15, 27, 21, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.045502332816809, "mean_inference_ms": 3.321132223745161, "mean_action_processing_ms": 0.4855039154846051, "mean_env_wait_ms": 0.14070129783525404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03261613845825195, "StateBufferConnector_ms": 0.020429134368896484, "ViewRequirementAgentConnector_ms": 0.45595717430114746}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4004, "num_agent_steps_trained": 13760, "num_env_steps_sampled": 4004, "num_env_steps_trained": 13760, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 58.94370705933061, "num_env_steps_trained_throughput_per_sec": 269.45694655693995, "timesteps_total": 4004, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 4004, "timers": {"training_iteration_time_ms": 94.353, "sample_time_ms": 32.272, "load_time_ms": 0.495, "load_throughput": 64670.776, "learn_time_ms": 4.857, "learn_throughput": 6587.955, "synch_weights_time_ms": 23.584}, "counters": {"num_env_steps_sampled": 4004, "num_env_steps_trained": 13760, "num_agent_steps_sampled": 4004, "num_agent_steps_trained": 13760, "last_target_update_ts": 3521, "num_target_updates": 6}, "done": false, "episodes_total": 211, "training_iteration": 4, "trial_id": "408f7_00000", "date": "2023-12-07_23-44-01", "timestamp": 1702021441, "time_this_iter_s": 17.013298988342285, "time_total_s": 46.4044463634491, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.4044463634491, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 78.13333333333333, "ram_util_percent": 96.54583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 3.81166410446167, "min_q": 1.1436954736709595, "max_q": 5.842597007751465, "mean_td_error": 0.2248896062374115, "model": {}}, "td_error": [-0.21078848838806152, 0.05188441276550293, 0.08976125717163086, -0.06802511215209961, 1.7456488609313965, -0.7734613418579102, -0.5656876564025879, 1.9955917596817017, 0.0906229019165039, -0.05472207069396973, 0.11453866958618164, 1.997641682624817, 0.18026137351989746, 0.24359893798828125, 0.12265253067016602, 0.2658810615539551, -0.2728085517883301, 0.24874305725097656, 0.060126304626464844, -0.16940784454345703, 0.09725427627563477, -0.1370849609375, 1.588975191116333, 0.24200820922851562, -0.5654251575469971, -0.12733745574951172, 0.1721363067626953, -0.2219761610031128, 0.1265547275543213, 0.18467187881469727, 0.36585140228271484, 0.378787100315094], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 573.0, "diff_num_grad_updates_vs_sampler_policy": 572.0}}, "num_env_steps_sampled": 5005, "num_env_steps_trained": 18336, "num_agent_steps_sampled": 5005, "num_agent_steps_trained": 18336, "last_target_update_ts": 4529, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 13.506666666666664, "episode_reward_min": 5.773000000000001, "episode_reward_mean": 8.87178, "episode_len_mean": 18.44, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.892999999999997, 8.622, 9.16633333333333, 9.377, 9.067666666666666, 9.501333333333333, 8.813333333333333, 5.773000000000001, 8.908333333333335, 7.421666666666666, 7.283666666666666, 7.005333333333334, 8.990999999999998, 7.779999999999999, 8.167333333333334, 8.259, 8.754, 8.238666666666665, 10.41433333333333, 8.603999999999997, 10.775666666666666, 9.49933333333333, 10.482666666666663, 6.9706666666666655, 6.227999999999998, 10.576999999999998, 7.973666666666665, 9.329999999999998, 7.628999999999999, 11.552333333333333, 7.4449999999999985, 9.505666666666668, 7.139333333333335, 8.969666666666663, 6.842333333333333, 7.090666666666665, 7.339999999999999, 8.843333333333332, 8.283999999999999, 8.613333333333333, 6.893999999999998, 12.963666666666663, 8.382999999999997, 10.35233333333333, 7.813000000000001, 13.506666666666664, 8.05133333333333, 10.438666666666665, 6.745999999999999, 7.519333333333333, 10.818666666666662, 8.971666666666664, 8.364666666666665, 6.707333333333333, 10.54866666666667, 6.220000000000001, 13.07433333333333, 9.306666666666665, 9.402999999999997, 8.768999999999997, 11.893999999999998, 7.712333333333332, 9.26633333333333, 7.5843333333333325, 10.867333333333333, 9.459, 8.458666666666666, 10.394333333333332, 10.215666666666664, 8.99433333333333, 7.9883333333333315, 9.659666666666663, 7.404999999999999, 6.769666666666668, 8.721, 9.250333333333332, 8.085333333333333, 7.587999999999997, 8.019333333333332, 8.763999999999998, 9.782, 8.432666666666666, 8.366999999999997, 7.908333333333333, 10.509333333333336, 8.793333333333331, 9.023666666666665, 11.772333333333329, 6.966666666666665, 7.263666666666666, 12.905999999999995, 9.397666666666664, 12.831, 11.020666666666664, 7.589, 8.154333333333332, 9.53133333333333, 7.507999999999999, 8.15133333333333, 8.187999999999999], "episode_lengths": [19, 17, 17, 19, 20, 19, 19, 13, 17, 16, 16, 16, 20, 18, 18, 17, 18, 21, 20, 18, 22, 19, 23, 16, 13, 21, 17, 18, 16, 24, 16, 19, 15, 20, 15, 14, 16, 18, 18, 18, 15, 27, 21, 21, 16, 28, 17, 21, 14, 18, 21, 19, 19, 14, 20, 13, 25, 18, 18, 21, 23, 16, 20, 17, 19, 19, 16, 21, 19, 18, 18, 18, 15, 14, 17, 20, 18, 17, 18, 17, 22, 16, 19, 16, 22, 17, 19, 21, 14, 18, 26, 19, 23, 23, 17, 16, 21, 16, 18, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.095892523836386, "mean_inference_ms": 3.337458095812557, "mean_action_processing_ms": 0.5002430395729154, "mean_env_wait_ms": 0.1436063753471504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027339458465576172, "StateBufferConnector_ms": 0.020452260971069336, "ViewRequirementAgentConnector_ms": 0.46296215057373047}}, "episode_reward_max": 13.506666666666664, "episode_reward_min": 5.773000000000001, "episode_reward_mean": 8.87178, "episode_len_mean": 18.44, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.892999999999997, 8.622, 9.16633333333333, 9.377, 9.067666666666666, 9.501333333333333, 8.813333333333333, 5.773000000000001, 8.908333333333335, 7.421666666666666, 7.283666666666666, 7.005333333333334, 8.990999999999998, 7.779999999999999, 8.167333333333334, 8.259, 8.754, 8.238666666666665, 10.41433333333333, 8.603999999999997, 10.775666666666666, 9.49933333333333, 10.482666666666663, 6.9706666666666655, 6.227999999999998, 10.576999999999998, 7.973666666666665, 9.329999999999998, 7.628999999999999, 11.552333333333333, 7.4449999999999985, 9.505666666666668, 7.139333333333335, 8.969666666666663, 6.842333333333333, 7.090666666666665, 7.339999999999999, 8.843333333333332, 8.283999999999999, 8.613333333333333, 6.893999999999998, 12.963666666666663, 8.382999999999997, 10.35233333333333, 7.813000000000001, 13.506666666666664, 8.05133333333333, 10.438666666666665, 6.745999999999999, 7.519333333333333, 10.818666666666662, 8.971666666666664, 8.364666666666665, 6.707333333333333, 10.54866666666667, 6.220000000000001, 13.07433333333333, 9.306666666666665, 9.402999999999997, 8.768999999999997, 11.893999999999998, 7.712333333333332, 9.26633333333333, 7.5843333333333325, 10.867333333333333, 9.459, 8.458666666666666, 10.394333333333332, 10.215666666666664, 8.99433333333333, 7.9883333333333315, 9.659666666666663, 7.404999999999999, 6.769666666666668, 8.721, 9.250333333333332, 8.085333333333333, 7.587999999999997, 8.019333333333332, 8.763999999999998, 9.782, 8.432666666666666, 8.366999999999997, 7.908333333333333, 10.509333333333336, 8.793333333333331, 9.023666666666665, 11.772333333333329, 6.966666666666665, 7.263666666666666, 12.905999999999995, 9.397666666666664, 12.831, 11.020666666666664, 7.589, 8.154333333333332, 9.53133333333333, 7.507999999999999, 8.15133333333333, 8.187999999999999], "episode_lengths": [19, 17, 17, 19, 20, 19, 19, 13, 17, 16, 16, 16, 20, 18, 18, 17, 18, 21, 20, 18, 22, 19, 23, 16, 13, 21, 17, 18, 16, 24, 16, 19, 15, 20, 15, 14, 16, 18, 18, 18, 15, 27, 21, 21, 16, 28, 17, 21, 14, 18, 21, 19, 19, 14, 20, 13, 25, 18, 18, 21, 23, 16, 20, 17, 19, 19, 16, 21, 19, 18, 18, 18, 15, 14, 17, 20, 18, 17, 18, 17, 22, 16, 19, 16, 22, 17, 19, 21, 14, 18, 26, 19, 23, 23, 17, 16, 21, 16, 18, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.095892523836386, "mean_inference_ms": 3.337458095812557, "mean_action_processing_ms": 0.5002430395729154, "mean_env_wait_ms": 0.1436063753471504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027339458465576172, "StateBufferConnector_ms": 0.020452260971069336, "ViewRequirementAgentConnector_ms": 0.46296215057373047}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5005, "num_agent_steps_trained": 18336, "num_env_steps_sampled": 5005, "num_env_steps_trained": 18336, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 43.22866748054864, "num_env_steps_trained_throughput_per_sec": 197.6167656253652, "timesteps_total": 5005, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 5005, "timers": {"training_iteration_time_ms": 120.982, "sample_time_ms": 46.697, "load_time_ms": 0.436, "load_throughput": 73367.076, "learn_time_ms": 6.605, "learn_throughput": 4844.723, "synch_weights_time_ms": 25.633}, "counters": {"num_env_steps_sampled": 5005, "num_env_steps_trained": 18336, "num_agent_steps_sampled": 5005, "num_agent_steps_trained": 18336, "last_target_update_ts": 4529, "num_target_updates": 8}, "done": false, "episodes_total": 266, "training_iteration": 5, "trial_id": "408f7_00000", "date": "2023-12-07_23-44-25", "timestamp": 1702021465, "time_this_iter_s": 23.256453037261963, "time_total_s": 69.66089940071106, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.66089940071106, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 91.46451612903228, "ram_util_percent": 96.70967741935483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 4.157449722290039, "min_q": 0.1182655319571495, "max_q": 6.72935676574707, "mean_td_error": 0.03118326887488365, "model": {}}, "td_error": [-0.08755016326904297, -0.07622480392456055, -0.09213733673095703, -0.059810638427734375, -0.9993429183959961, -0.47179603576660156, -0.8680678009986877, -0.37447142601013184, 1.3196742534637451, 0.1233663558959961, -0.6616643667221069, -0.24735307693481445, -0.3538050651550293, 0.1560802459716797, 0.45961958169937134, 0.10183954238891602, 0.8470706939697266, 0.6710968017578125, 1.8214821815490723, -0.33852434158325195, -0.19438782334327698, -0.028691768646240234, 0.34984683990478516, -0.44814419746398926, -0.09130716323852539, 0.20403385162353516, 0.4747295379638672, -0.3088998794555664, 0.26982808113098145, 0.0498809814453125, -0.21404695510864258, 0.06554126739501953], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 715.0}}, "num_env_steps_sampled": 6006, "num_env_steps_trained": 22912, "num_agent_steps_sampled": 6006, "num_agent_steps_trained": 22912, "last_target_update_ts": 5537, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 14.667666666666664, "episode_reward_min": 6.220000000000001, "episode_reward_mean": 9.274433333333333, "episode_len_mean": 19.2, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.818666666666662, 8.971666666666664, 8.364666666666665, 6.707333333333333, 10.54866666666667, 6.220000000000001, 13.07433333333333, 9.306666666666665, 9.402999999999997, 8.768999999999997, 11.893999999999998, 7.712333333333332, 9.26633333333333, 7.5843333333333325, 10.867333333333333, 9.459, 8.458666666666666, 10.394333333333332, 10.215666666666664, 8.99433333333333, 7.9883333333333315, 9.659666666666663, 7.404999999999999, 6.769666666666668, 8.721, 9.250333333333332, 8.085333333333333, 7.587999999999997, 8.019333333333332, 8.763999999999998, 9.782, 8.432666666666666, 8.366999999999997, 7.908333333333333, 10.509333333333336, 8.793333333333331, 9.023666666666665, 11.772333333333329, 6.966666666666665, 7.263666666666666, 12.905999999999995, 9.397666666666664, 12.831, 11.020666666666664, 7.589, 8.154333333333332, 9.53133333333333, 7.507999999999999, 8.15133333333333, 8.187999999999999, 10.95933333333333, 13.334333333333328, 10.537999999999997, 8.072, 10.379, 8.451333333333332, 10.192666666666666, 11.624333333333334, 11.520999999999999, 11.906666666666666, 8.846333333333334, 7.610666666666665, 8.862999999999998, 8.103666666666665, 12.679333333333327, 9.582333333333331, 12.354999999999993, 6.863666666666666, 6.686333333333334, 8.524333333333333, 8.501333333333333, 13.60233333333333, 10.067666666666666, 7.0413333333333314, 8.799, 10.70833333333333, 9.266333333333332, 14.667666666666664, 8.681333333333335, 7.22333333333333, 9.978999999999996, 7.909999999999999, 8.190999999999999, 10.06333333333333, 10.495333333333331, 8.627333333333333, 8.087999999999997, 8.517666666666665, 6.420999999999999, 7.711999999999998, 7.6836666666666655, 8.950666666666667, 8.452000000000002, 8.463666666666665, 8.213333333333331, 10.142999999999999, 10.593999999999998, 11.56033333333333, 8.074333333333332, 10.27433333333333], "episode_lengths": [21, 19, 19, 14, 20, 13, 25, 18, 18, 21, 23, 16, 20, 17, 19, 19, 16, 21, 19, 18, 18, 18, 15, 14, 17, 20, 18, 17, 18, 17, 22, 16, 19, 16, 22, 17, 19, 21, 14, 18, 26, 19, 23, 23, 17, 16, 21, 16, 18, 19, 23, 25, 20, 16, 21, 20, 19, 23, 25, 23, 19, 17, 20, 18, 27, 21, 25, 17, 15, 17, 17, 28, 23, 15, 18, 21, 18, 32, 19, 16, 24, 16, 17, 19, 22, 18, 18, 19, 14, 19, 16, 18, 16, 17, 19, 21, 21, 23, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.13565193659765, "mean_inference_ms": 3.3961901551595894, "mean_action_processing_ms": 0.5133933474758122, "mean_env_wait_ms": 0.14308926435623737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021718502044677734, "StateBufferConnector_ms": 0.014528751373291016, "ViewRequirementAgentConnector_ms": 0.4687833786010742}}, "episode_reward_max": 14.667666666666664, "episode_reward_min": 6.220000000000001, "episode_reward_mean": 9.274433333333333, "episode_len_mean": 19.2, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.818666666666662, 8.971666666666664, 8.364666666666665, 6.707333333333333, 10.54866666666667, 6.220000000000001, 13.07433333333333, 9.306666666666665, 9.402999999999997, 8.768999999999997, 11.893999999999998, 7.712333333333332, 9.26633333333333, 7.5843333333333325, 10.867333333333333, 9.459, 8.458666666666666, 10.394333333333332, 10.215666666666664, 8.99433333333333, 7.9883333333333315, 9.659666666666663, 7.404999999999999, 6.769666666666668, 8.721, 9.250333333333332, 8.085333333333333, 7.587999999999997, 8.019333333333332, 8.763999999999998, 9.782, 8.432666666666666, 8.366999999999997, 7.908333333333333, 10.509333333333336, 8.793333333333331, 9.023666666666665, 11.772333333333329, 6.966666666666665, 7.263666666666666, 12.905999999999995, 9.397666666666664, 12.831, 11.020666666666664, 7.589, 8.154333333333332, 9.53133333333333, 7.507999999999999, 8.15133333333333, 8.187999999999999, 10.95933333333333, 13.334333333333328, 10.537999999999997, 8.072, 10.379, 8.451333333333332, 10.192666666666666, 11.624333333333334, 11.520999999999999, 11.906666666666666, 8.846333333333334, 7.610666666666665, 8.862999999999998, 8.103666666666665, 12.679333333333327, 9.582333333333331, 12.354999999999993, 6.863666666666666, 6.686333333333334, 8.524333333333333, 8.501333333333333, 13.60233333333333, 10.067666666666666, 7.0413333333333314, 8.799, 10.70833333333333, 9.266333333333332, 14.667666666666664, 8.681333333333335, 7.22333333333333, 9.978999999999996, 7.909999999999999, 8.190999999999999, 10.06333333333333, 10.495333333333331, 8.627333333333333, 8.087999999999997, 8.517666666666665, 6.420999999999999, 7.711999999999998, 7.6836666666666655, 8.950666666666667, 8.452000000000002, 8.463666666666665, 8.213333333333331, 10.142999999999999, 10.593999999999998, 11.56033333333333, 8.074333333333332, 10.27433333333333], "episode_lengths": [21, 19, 19, 14, 20, 13, 25, 18, 18, 21, 23, 16, 20, 17, 19, 19, 16, 21, 19, 18, 18, 18, 15, 14, 17, 20, 18, 17, 18, 17, 22, 16, 19, 16, 22, 17, 19, 21, 14, 18, 26, 19, 23, 23, 17, 16, 21, 16, 18, 19, 23, 25, 20, 16, 21, 20, 19, 23, 25, 23, 19, 17, 20, 18, 27, 21, 25, 17, 15, 17, 17, 28, 23, 15, 18, 21, 18, 32, 19, 16, 24, 16, 17, 19, 22, 18, 18, 19, 14, 19, 16, 18, 16, 17, 19, 21, 21, 23, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.13565193659765, "mean_inference_ms": 3.3961901551595894, "mean_action_processing_ms": 0.5133933474758122, "mean_env_wait_ms": 0.14308926435623737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021718502044677734, "StateBufferConnector_ms": 0.014528751373291016, "ViewRequirementAgentConnector_ms": 0.4687833786010742}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6006, "num_agent_steps_trained": 22912, "num_env_steps_sampled": 6006, "num_env_steps_trained": 22912, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 44.22880030629076, "num_env_steps_trained_throughput_per_sec": 202.18880140018632, "timesteps_total": 6006, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 6006, "timers": {"training_iteration_time_ms": 134.303, "sample_time_ms": 53.425, "load_time_ms": 0.653, "load_throughput": 49027.516, "learn_time_ms": 6.866, "learn_throughput": 4660.791, "synch_weights_time_ms": 23.235}, "counters": {"num_env_steps_sampled": 6006, "num_env_steps_trained": 22912, "num_agent_steps_sampled": 6006, "num_agent_steps_trained": 22912, "last_target_update_ts": 5537, "num_target_updates": 10}, "done": false, "episodes_total": 316, "training_iteration": 6, "trial_id": "408f7_00000", "date": "2023-12-07_23-44-47", "timestamp": 1702021487, "time_this_iter_s": 22.671310424804688, "time_total_s": 92.33220982551575, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.33220982551575, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 92.47142857142855, "ram_util_percent": 96.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 4.594875335693359, "min_q": 0.16794973611831665, "max_q": 7.226588249206543, "mean_td_error": -0.004741787910461426, "model": {}}, "td_error": [-0.8470502495765686, 1.6588406562805176, 0.11336040496826172, -0.4635028839111328, -0.642762303352356, -0.23271942138671875, 0.19190335273742676, 0.07370209693908691, -0.251112699508667, -0.40607357025146484, -1.020204782485962, 0.1257948875427246, 0.2508821487426758, -0.017284870147705078, 0.03645181655883789, -0.044521331787109375, -0.23222875595092773, 0.12492084503173828, -0.4334399700164795, -0.08721160888671875, 0.1206507682800293, 0.7235634326934814, -0.8927755355834961, 0.7102856636047363, -0.7022666931152344, -0.1380290985107422, -0.6324927806854248, 0.22316932678222656, -0.023543357849121094, 0.15461254119873047, 0.7449202537536621, 1.6624248027801514], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 859.0, "diff_num_grad_updates_vs_sampler_policy": 858.0}}, "num_env_steps_sampled": 7007, "num_env_steps_trained": 27488, "num_agent_steps_sampled": 7007, "num_agent_steps_trained": 27488, "last_target_update_ts": 6545, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 28.84866666666666, "episode_reward_min": 6.420999999999999, "episode_reward_mean": 10.547283333333331, "episode_len_mean": 21.13, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.397666666666664, 12.831, 11.020666666666664, 7.589, 8.154333333333332, 9.53133333333333, 7.507999999999999, 8.15133333333333, 8.187999999999999, 10.95933333333333, 13.334333333333328, 10.537999999999997, 8.072, 10.379, 8.451333333333332, 10.192666666666666, 11.624333333333334, 11.520999999999999, 11.906666666666666, 8.846333333333334, 7.610666666666665, 8.862999999999998, 8.103666666666665, 12.679333333333327, 9.582333333333331, 12.354999999999993, 6.863666666666666, 6.686333333333334, 8.524333333333333, 8.501333333333333, 13.60233333333333, 10.067666666666666, 7.0413333333333314, 8.799, 10.70833333333333, 9.266333333333332, 14.667666666666664, 8.681333333333335, 7.22333333333333, 9.978999999999996, 7.909999999999999, 8.190999999999999, 10.06333333333333, 10.495333333333331, 8.627333333333333, 8.087999999999997, 8.517666666666665, 6.420999999999999, 7.711999999999998, 7.6836666666666655, 8.950666666666667, 8.452000000000002, 8.463666666666665, 8.213333333333331, 10.142999999999999, 10.593999999999998, 11.56033333333333, 8.074333333333332, 10.27433333333333, 12.348999999999998, 8.335666666666665, 8.942999999999998, 12.887666666666664, 11.823999999999998, 8.105999999999998, 12.62666666666666, 11.987333333333329, 12.441666666666663, 28.84866666666666, 9.197, 14.281999999999996, 17.128666666666664, 9.066666666666665, 17.504666666666665, 12.134999999999996, 14.318999999999996, 11.061333333333334, 9.339, 11.41033333333333, 8.645333333333333, 26.029666666666643, 10.794666666666663, 14.525, 9.474999999999998, 10.350666666666665, 12.671333333333331, 7.6343333333333305, 8.444999999999997, 13.69733333333333, 10.665666666666663, 9.829666666666665, 16.358666666666664, 9.798999999999996, 8.764999999999999, 13.15333333333333, 10.316333333333331, 9.927, 10.850666666666665, 11.130333333333327, 11.433666666666664], "episode_lengths": [19, 23, 23, 17, 16, 21, 16, 18, 19, 23, 25, 20, 16, 21, 20, 19, 23, 25, 23, 19, 17, 20, 18, 27, 21, 25, 17, 15, 17, 17, 28, 23, 15, 18, 21, 18, 32, 19, 16, 24, 16, 17, 19, 22, 18, 18, 19, 14, 19, 16, 18, 16, 17, 19, 21, 21, 23, 16, 19, 25, 19, 18, 24, 22, 15, 28, 21, 22, 46, 19, 27, 31, 17, 31, 25, 26, 22, 19, 23, 19, 43, 19, 27, 19, 21, 26, 16, 19, 27, 20, 22, 28, 18, 18, 24, 21, 19, 20, 22, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1342974307389664, "mean_inference_ms": 3.395572711462537, "mean_action_processing_ms": 0.5114850229988047, "mean_env_wait_ms": 0.1442725827958852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019203901290893555, "StateBufferConnector_ms": 0.015416622161865234, "ViewRequirementAgentConnector_ms": 0.4875493049621582}}, "episode_reward_max": 28.84866666666666, "episode_reward_min": 6.420999999999999, "episode_reward_mean": 10.547283333333331, "episode_len_mean": 21.13, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.397666666666664, 12.831, 11.020666666666664, 7.589, 8.154333333333332, 9.53133333333333, 7.507999999999999, 8.15133333333333, 8.187999999999999, 10.95933333333333, 13.334333333333328, 10.537999999999997, 8.072, 10.379, 8.451333333333332, 10.192666666666666, 11.624333333333334, 11.520999999999999, 11.906666666666666, 8.846333333333334, 7.610666666666665, 8.862999999999998, 8.103666666666665, 12.679333333333327, 9.582333333333331, 12.354999999999993, 6.863666666666666, 6.686333333333334, 8.524333333333333, 8.501333333333333, 13.60233333333333, 10.067666666666666, 7.0413333333333314, 8.799, 10.70833333333333, 9.266333333333332, 14.667666666666664, 8.681333333333335, 7.22333333333333, 9.978999999999996, 7.909999999999999, 8.190999999999999, 10.06333333333333, 10.495333333333331, 8.627333333333333, 8.087999999999997, 8.517666666666665, 6.420999999999999, 7.711999999999998, 7.6836666666666655, 8.950666666666667, 8.452000000000002, 8.463666666666665, 8.213333333333331, 10.142999999999999, 10.593999999999998, 11.56033333333333, 8.074333333333332, 10.27433333333333, 12.348999999999998, 8.335666666666665, 8.942999999999998, 12.887666666666664, 11.823999999999998, 8.105999999999998, 12.62666666666666, 11.987333333333329, 12.441666666666663, 28.84866666666666, 9.197, 14.281999999999996, 17.128666666666664, 9.066666666666665, 17.504666666666665, 12.134999999999996, 14.318999999999996, 11.061333333333334, 9.339, 11.41033333333333, 8.645333333333333, 26.029666666666643, 10.794666666666663, 14.525, 9.474999999999998, 10.350666666666665, 12.671333333333331, 7.6343333333333305, 8.444999999999997, 13.69733333333333, 10.665666666666663, 9.829666666666665, 16.358666666666664, 9.798999999999996, 8.764999999999999, 13.15333333333333, 10.316333333333331, 9.927, 10.850666666666665, 11.130333333333327, 11.433666666666664], "episode_lengths": [19, 23, 23, 17, 16, 21, 16, 18, 19, 23, 25, 20, 16, 21, 20, 19, 23, 25, 23, 19, 17, 20, 18, 27, 21, 25, 17, 15, 17, 17, 28, 23, 15, 18, 21, 18, 32, 19, 16, 24, 16, 17, 19, 22, 18, 18, 19, 14, 19, 16, 18, 16, 17, 19, 21, 21, 23, 16, 19, 25, 19, 18, 24, 22, 15, 28, 21, 22, 46, 19, 27, 31, 17, 31, 25, 26, 22, 19, 23, 19, 43, 19, 27, 19, 21, 26, 16, 19, 27, 20, 22, 28, 18, 18, 24, 21, 19, 20, 22, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1342974307389664, "mean_inference_ms": 3.395572711462537, "mean_action_processing_ms": 0.5114850229988047, "mean_env_wait_ms": 0.1442725827958852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019203901290893555, "StateBufferConnector_ms": 0.015416622161865234, "ViewRequirementAgentConnector_ms": 0.4875493049621582}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7007, "num_agent_steps_trained": 27488, "num_env_steps_sampled": 7007, "num_env_steps_trained": 27488, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 45.50109370649773, "num_env_steps_trained_throughput_per_sec": 208.00499980113244, "timesteps_total": 7007, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 7007, "timers": {"training_iteration_time_ms": 193.738, "sample_time_ms": 95.151, "load_time_ms": 0.701, "load_throughput": 45653.841, "learn_time_ms": 9.04, "learn_throughput": 3539.87, "synch_weights_time_ms": 25.894}, "counters": {"num_env_steps_sampled": 7007, "num_env_steps_trained": 27488, "num_agent_steps_sampled": 7007, "num_agent_steps_trained": 27488, "last_target_update_ts": 6545, "num_target_updates": 12}, "done": false, "episodes_total": 357, "training_iteration": 7, "trial_id": "408f7_00000", "date": "2023-12-07_23-45-10", "timestamp": 1702021510, "time_this_iter_s": 22.05599355697632, "time_total_s": 114.38820338249207, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 114.38820338249207, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 94.57666666666664, "ram_util_percent": 96.44666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 5.342433452606201, "min_q": 0.282230019569397, "max_q": 8.461694717407227, "mean_td_error": 0.11637621372938156, "model": {}}, "td_error": [0.028410911560058594, 0.5349407196044922, 0.13694477081298828, 0.13878536224365234, -0.3882019519805908, 0.06111431121826172, 0.1426076889038086, 0.4177548885345459, -0.18389320373535156, -0.024782657623291016, -0.4405944347381592, -0.7464995384216309, 0.3238945007324219, -0.6591033339500427, -0.19407528638839722, -0.012445449829101562, -0.5890836715698242, -0.10846424102783203, -0.31598806381225586, -0.1489400863647461, -0.0335078239440918, 2.205760955810547, 0.4356260299682617, 2.344583034515381, -0.15227508544921875, 0.07857322692871094, 0.5296955108642578, 0.18175458908081055, 0.3452639579772949, 0.14620733261108398, -0.037207603454589844, -0.2928164005279541], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1002.0, "diff_num_grad_updates_vs_sampler_policy": 1001.0}}, "num_env_steps_sampled": 8008, "num_env_steps_trained": 32064, "num_agent_steps_sampled": 8008, "num_agent_steps_trained": 32064, "last_target_update_ts": 7553, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 31.020333333333333, "episode_reward_min": 6.420999999999999, "episode_reward_mean": 12.184256666666668, "episode_len_mean": 23.1, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.06333333333333, 10.495333333333331, 8.627333333333333, 8.087999999999997, 8.517666666666665, 6.420999999999999, 7.711999999999998, 7.6836666666666655, 8.950666666666667, 8.452000000000002, 8.463666666666665, 8.213333333333331, 10.142999999999999, 10.593999999999998, 11.56033333333333, 8.074333333333332, 10.27433333333333, 12.348999999999998, 8.335666666666665, 8.942999999999998, 12.887666666666664, 11.823999999999998, 8.105999999999998, 12.62666666666666, 11.987333333333329, 12.441666666666663, 28.84866666666666, 9.197, 14.281999999999996, 17.128666666666664, 9.066666666666665, 17.504666666666665, 12.134999999999996, 14.318999999999996, 11.061333333333334, 9.339, 11.41033333333333, 8.645333333333333, 26.029666666666643, 10.794666666666663, 14.525, 9.474999999999998, 10.350666666666665, 12.671333333333331, 7.6343333333333305, 8.444999999999997, 13.69733333333333, 10.665666666666663, 9.829666666666665, 16.358666666666664, 9.798999999999996, 8.764999999999999, 13.15333333333333, 10.316333333333331, 9.927, 10.850666666666665, 11.130333333333327, 11.433666666666664, 9.777333333333333, 8.101999999999999, 10.272333333333332, 8.913333333333332, 14.622333333333328, 10.619666666666665, 11.838666666666663, 10.448999999999998, 10.89933333333333, 20.169666666666664, 15.396333333333322, 18.143666666666665, 10.868333333333332, 10.781666666666665, 9.256666666666664, 20.01266666666665, 10.86533333333333, 14.324333333333332, 9.318666666666664, 21.34066666666666, 13.040333333333331, 12.191999999999997, 14.358666666666661, 21.097666666666655, 10.67133333333333, 8.340666666666666, 10.761333333333331, 11.00333333333333, 12.097333333333328, 13.401999999999997, 22.789333333333314, 31.020333333333333, 12.222333333333331, 9.907999999999996, 9.35233333333333, 10.525999999999996, 14.646999999999995, 8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331], "episode_lengths": [19, 22, 18, 18, 19, 14, 19, 16, 18, 16, 17, 19, 21, 21, 23, 16, 19, 25, 19, 18, 24, 22, 15, 28, 21, 22, 46, 19, 27, 31, 17, 31, 25, 26, 22, 19, 23, 19, 43, 19, 27, 19, 21, 26, 16, 19, 27, 20, 22, 28, 18, 18, 24, 21, 19, 20, 22, 23, 22, 15, 22, 17, 28, 21, 23, 21, 19, 38, 25, 30, 21, 22, 18, 34, 20, 27, 20, 36, 25, 25, 23, 36, 20, 17, 21, 22, 22, 24, 40, 50, 25, 20, 20, 20, 28, 18, 46, 22, 23, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1429255987538296, "mean_inference_ms": 3.409216752942874, "mean_action_processing_ms": 0.5141879126284011, "mean_env_wait_ms": 0.14494814883111018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023946285247802734, "StateBufferConnector_ms": 0.018268823623657227, "ViewRequirementAgentConnector_ms": 0.47147345542907715}}, "episode_reward_max": 31.020333333333333, "episode_reward_min": 6.420999999999999, "episode_reward_mean": 12.184256666666668, "episode_len_mean": 23.1, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.06333333333333, 10.495333333333331, 8.627333333333333, 8.087999999999997, 8.517666666666665, 6.420999999999999, 7.711999999999998, 7.6836666666666655, 8.950666666666667, 8.452000000000002, 8.463666666666665, 8.213333333333331, 10.142999999999999, 10.593999999999998, 11.56033333333333, 8.074333333333332, 10.27433333333333, 12.348999999999998, 8.335666666666665, 8.942999999999998, 12.887666666666664, 11.823999999999998, 8.105999999999998, 12.62666666666666, 11.987333333333329, 12.441666666666663, 28.84866666666666, 9.197, 14.281999999999996, 17.128666666666664, 9.066666666666665, 17.504666666666665, 12.134999999999996, 14.318999999999996, 11.061333333333334, 9.339, 11.41033333333333, 8.645333333333333, 26.029666666666643, 10.794666666666663, 14.525, 9.474999999999998, 10.350666666666665, 12.671333333333331, 7.6343333333333305, 8.444999999999997, 13.69733333333333, 10.665666666666663, 9.829666666666665, 16.358666666666664, 9.798999999999996, 8.764999999999999, 13.15333333333333, 10.316333333333331, 9.927, 10.850666666666665, 11.130333333333327, 11.433666666666664, 9.777333333333333, 8.101999999999999, 10.272333333333332, 8.913333333333332, 14.622333333333328, 10.619666666666665, 11.838666666666663, 10.448999999999998, 10.89933333333333, 20.169666666666664, 15.396333333333322, 18.143666666666665, 10.868333333333332, 10.781666666666665, 9.256666666666664, 20.01266666666665, 10.86533333333333, 14.324333333333332, 9.318666666666664, 21.34066666666666, 13.040333333333331, 12.191999999999997, 14.358666666666661, 21.097666666666655, 10.67133333333333, 8.340666666666666, 10.761333333333331, 11.00333333333333, 12.097333333333328, 13.401999999999997, 22.789333333333314, 31.020333333333333, 12.222333333333331, 9.907999999999996, 9.35233333333333, 10.525999999999996, 14.646999999999995, 8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331], "episode_lengths": [19, 22, 18, 18, 19, 14, 19, 16, 18, 16, 17, 19, 21, 21, 23, 16, 19, 25, 19, 18, 24, 22, 15, 28, 21, 22, 46, 19, 27, 31, 17, 31, 25, 26, 22, 19, 23, 19, 43, 19, 27, 19, 21, 26, 16, 19, 27, 20, 22, 28, 18, 18, 24, 21, 19, 20, 22, 23, 22, 15, 22, 17, 28, 21, 23, 21, 19, 38, 25, 30, 21, 22, 18, 34, 20, 27, 20, 36, 25, 25, 23, 36, 20, 17, 21, 22, 22, 24, 40, 50, 25, 20, 20, 20, 28, 18, 46, 22, 23, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1429255987538296, "mean_inference_ms": 3.409216752942874, "mean_action_processing_ms": 0.5141879126284011, "mean_env_wait_ms": 0.14494814883111018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023946285247802734, "StateBufferConnector_ms": 0.018268823623657227, "ViewRequirementAgentConnector_ms": 0.47147345542907715}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8008, "num_agent_steps_trained": 32064, "num_env_steps_sampled": 8008, "num_env_steps_trained": 32064, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 45.932418282464255, "num_env_steps_trained_throughput_per_sec": 209.97676929126519, "timesteps_total": 8008, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 8008, "timers": {"training_iteration_time_ms": 134.316, "sample_time_ms": 55.957, "load_time_ms": 0.948, "load_throughput": 33746.789, "learn_time_ms": 7.32, "learn_throughput": 4371.785, "synch_weights_time_ms": 23.559}, "counters": {"num_env_steps_sampled": 8008, "num_env_steps_trained": 32064, "num_agent_steps_sampled": 8008, "num_agent_steps_trained": 32064, "last_target_update_ts": 7553, "num_target_updates": 14}, "done": false, "episodes_total": 399, "training_iteration": 8, "trial_id": "408f7_00000", "date": "2023-12-07_23-45-31", "timestamp": 1702021531, "time_this_iter_s": 21.823801040649414, "time_total_s": 136.21200442314148, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 136.21200442314148, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 94.93333333333334, "ram_util_percent": 97.74666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 6.146333694458008, "min_q": 2.117736577987671, "max_q": 8.557744026184082, "mean_td_error": 0.11780811101198196, "model": {}}, "td_error": [0.10135746002197266, 0.1434311866760254, 0.6460862159729004, 0.034758567810058594, 0.012749195098876953, 0.465212345123291, 0.029725074768066406, -0.02274942398071289, -0.0499265193939209, 0.3623518943786621, -0.13925409317016602, -0.6583943367004395, -0.08347511291503906, 0.08444452285766602, 0.5750331878662109, -0.17653942108154297, -0.40937232971191406, -0.24687671661376953, -0.017693519592285156, 0.03916120529174805, 1.1474032402038574, 0.23743247985839844, 0.03807258605957031, -0.49836301803588867, -0.05739116668701172, 0.10429859161376953, 0.08953380584716797, -0.02462291717529297, -0.053603172302246094, -0.22034645080566406, 0.45502138137817383, 1.8623948097229004], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1145.0, "diff_num_grad_updates_vs_sampler_policy": 1144.0}}, "num_env_steps_sampled": 9009, "num_env_steps_trained": 36640, "num_agent_steps_sampled": 9009, "num_agent_steps_trained": 36640, "last_target_update_ts": 8561, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 31.020333333333333, "episode_reward_min": 7.438, "episode_reward_mean": 13.807463333333331, "episode_len_mean": 25.31, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.339, 11.41033333333333, 8.645333333333333, 26.029666666666643, 10.794666666666663, 14.525, 9.474999999999998, 10.350666666666665, 12.671333333333331, 7.6343333333333305, 8.444999999999997, 13.69733333333333, 10.665666666666663, 9.829666666666665, 16.358666666666664, 9.798999999999996, 8.764999999999999, 13.15333333333333, 10.316333333333331, 9.927, 10.850666666666665, 11.130333333333327, 11.433666666666664, 9.777333333333333, 8.101999999999999, 10.272333333333332, 8.913333333333332, 14.622333333333328, 10.619666666666665, 11.838666666666663, 10.448999999999998, 10.89933333333333, 20.169666666666664, 15.396333333333322, 18.143666666666665, 10.868333333333332, 10.781666666666665, 9.256666666666664, 20.01266666666665, 10.86533333333333, 14.324333333333332, 9.318666666666664, 21.34066666666666, 13.040333333333331, 12.191999999999997, 14.358666666666661, 21.097666666666655, 10.67133333333333, 8.340666666666666, 10.761333333333331, 11.00333333333333, 12.097333333333328, 13.401999999999997, 22.789333333333314, 31.020333333333333, 12.222333333333331, 9.907999999999996, 9.35233333333333, 10.525999999999996, 14.646999999999995, 8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331, 27.085333333333338, 20.744666666666667, 28.655333333333324, 12.718999999999994, 9.600999999999997, 10.349999999999996, 7.438, 28.611666666666657, 28.48966666666667, 15.814666666666662, 14.29466666666666, 9.718, 16.718666666666657, 27.50399999999999, 9.406666666666665, 9.853333333333328, 23.116666666666653, 20.184333333333324, 10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663], "episode_lengths": [19, 23, 19, 43, 19, 27, 19, 21, 26, 16, 19, 27, 20, 22, 28, 18, 18, 24, 21, 19, 20, 22, 23, 22, 15, 22, 17, 28, 21, 23, 21, 19, 38, 25, 30, 21, 22, 18, 34, 20, 27, 20, 36, 25, 25, 23, 36, 20, 17, 21, 22, 22, 24, 40, 50, 25, 20, 20, 20, 28, 18, 46, 22, 23, 18, 44, 34, 50, 23, 22, 19, 18, 47, 54, 25, 25, 18, 31, 41, 18, 19, 41, 36, 20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1592535396791845, "mean_inference_ms": 3.423714731326819, "mean_action_processing_ms": 0.5147247361397741, "mean_env_wait_ms": 0.14556622111592865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024016618728637695, "StateBufferConnector_ms": 0.015519142150878906, "ViewRequirementAgentConnector_ms": 0.5036437511444092}}, "episode_reward_max": 31.020333333333333, "episode_reward_min": 7.438, "episode_reward_mean": 13.807463333333331, "episode_len_mean": 25.31, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.339, 11.41033333333333, 8.645333333333333, 26.029666666666643, 10.794666666666663, 14.525, 9.474999999999998, 10.350666666666665, 12.671333333333331, 7.6343333333333305, 8.444999999999997, 13.69733333333333, 10.665666666666663, 9.829666666666665, 16.358666666666664, 9.798999999999996, 8.764999999999999, 13.15333333333333, 10.316333333333331, 9.927, 10.850666666666665, 11.130333333333327, 11.433666666666664, 9.777333333333333, 8.101999999999999, 10.272333333333332, 8.913333333333332, 14.622333333333328, 10.619666666666665, 11.838666666666663, 10.448999999999998, 10.89933333333333, 20.169666666666664, 15.396333333333322, 18.143666666666665, 10.868333333333332, 10.781666666666665, 9.256666666666664, 20.01266666666665, 10.86533333333333, 14.324333333333332, 9.318666666666664, 21.34066666666666, 13.040333333333331, 12.191999999999997, 14.358666666666661, 21.097666666666655, 10.67133333333333, 8.340666666666666, 10.761333333333331, 11.00333333333333, 12.097333333333328, 13.401999999999997, 22.789333333333314, 31.020333333333333, 12.222333333333331, 9.907999999999996, 9.35233333333333, 10.525999999999996, 14.646999999999995, 8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331, 27.085333333333338, 20.744666666666667, 28.655333333333324, 12.718999999999994, 9.600999999999997, 10.349999999999996, 7.438, 28.611666666666657, 28.48966666666667, 15.814666666666662, 14.29466666666666, 9.718, 16.718666666666657, 27.50399999999999, 9.406666666666665, 9.853333333333328, 23.116666666666653, 20.184333333333324, 10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663], "episode_lengths": [19, 23, 19, 43, 19, 27, 19, 21, 26, 16, 19, 27, 20, 22, 28, 18, 18, 24, 21, 19, 20, 22, 23, 22, 15, 22, 17, 28, 21, 23, 21, 19, 38, 25, 30, 21, 22, 18, 34, 20, 27, 20, 36, 25, 25, 23, 36, 20, 17, 21, 22, 22, 24, 40, 50, 25, 20, 20, 20, 28, 18, 46, 22, 23, 18, 44, 34, 50, 23, 22, 19, 18, 47, 54, 25, 25, 18, 31, 41, 18, 19, 41, 36, 20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1592535396791845, "mean_inference_ms": 3.423714731326819, "mean_action_processing_ms": 0.5147247361397741, "mean_env_wait_ms": 0.14556622111592865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024016618728637695, "StateBufferConnector_ms": 0.015519142150878906, "ViewRequirementAgentConnector_ms": 0.5036437511444092}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9009, "num_agent_steps_trained": 36640, "num_env_steps_sampled": 9009, "num_env_steps_trained": 36640, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 34.49350807433088, "num_env_steps_trained_throughput_per_sec": 157.68460833979833, "timesteps_total": 9009, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 9009, "timers": {"training_iteration_time_ms": 226.625, "sample_time_ms": 118.359, "load_time_ms": 0.755, "load_throughput": 42373.395, "learn_time_ms": 8.793, "learn_throughput": 3639.29, "synch_weights_time_ms": 26.12}, "counters": {"num_env_steps_sampled": 9009, "num_env_steps_trained": 36640, "num_agent_steps_sampled": 9009, "num_agent_steps_trained": 36640, "last_target_update_ts": 8561, "num_target_updates": 16}, "done": false, "episodes_total": 434, "training_iteration": 9, "trial_id": "408f7_00000", "date": "2023-12-07_23-46-01", "timestamp": 1702021561, "time_this_iter_s": 29.05585503578186, "time_total_s": 165.26785945892334, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 165.26785945892334, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 96.81052631578949, "ram_util_percent": 96.64473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 7.55295467376709, "min_q": 2.1634597778320312, "max_q": 9.920742988586426, "mean_td_error": 0.3205326795578003, "model": {}}, "td_error": [1.0330071449279785, -0.1051025390625, 1.1847931146621704, -0.2532920837402344, -0.17822885513305664, 0.03513050079345703, -0.014863014221191406, 3.7353034019470215, -0.21618986129760742, -0.25388002395629883, 0.060591697692871094, -0.2814311981201172, 0.05094146728515625, 0.03513050079345703, -0.10997676849365234, 0.8233399391174316, 0.4773106575012207, -0.1173257827758789, 0.08547401428222656, -0.18216705322265625, 4.270876407623291, 1.0281949043273926, -0.20154953002929688, -0.3466782569885254, 0.10159778594970703, 0.4417989253997803, -0.617426872253418, -0.2382955551147461, -0.2721233367919922, -0.22043418884277344, -0.42980480194091797, 0.9323253631591797], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1288.0, "diff_num_grad_updates_vs_sampler_policy": 1287.0}}, "num_env_steps_sampled": 10010, "num_env_steps_trained": 41216, "num_agent_steps_sampled": 10010, "num_agent_steps_trained": 41216, "last_target_update_ts": 9569, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 51.087, "episode_reward_min": 7.438, "episode_reward_mean": 15.524546666666662, "episode_len_mean": 27.71, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.143666666666665, 10.868333333333332, 10.781666666666665, 9.256666666666664, 20.01266666666665, 10.86533333333333, 14.324333333333332, 9.318666666666664, 21.34066666666666, 13.040333333333331, 12.191999999999997, 14.358666666666661, 21.097666666666655, 10.67133333333333, 8.340666666666666, 10.761333333333331, 11.00333333333333, 12.097333333333328, 13.401999999999997, 22.789333333333314, 31.020333333333333, 12.222333333333331, 9.907999999999996, 9.35233333333333, 10.525999999999996, 14.646999999999995, 8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331, 27.085333333333338, 20.744666666666667, 28.655333333333324, 12.718999999999994, 9.600999999999997, 10.349999999999996, 7.438, 28.611666666666657, 28.48966666666667, 15.814666666666662, 14.29466666666666, 9.718, 16.718666666666657, 27.50399999999999, 9.406666666666665, 9.853333333333328, 23.116666666666653, 20.184333333333324, 10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663, 13.624666666666664, 13.193333333333326, 9.855666666666663, 15.363999999999997, 12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324], "episode_lengths": [30, 21, 22, 18, 34, 20, 27, 20, 36, 25, 25, 23, 36, 20, 17, 21, 22, 22, 24, 40, 50, 25, 20, 20, 20, 28, 18, 46, 22, 23, 18, 44, 34, 50, 23, 22, 19, 18, 47, 54, 25, 25, 18, 31, 41, 18, 19, 41, 36, 20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26, 27, 26, 18, 27, 22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.172388772307538, "mean_inference_ms": 3.46128987800656, "mean_action_processing_ms": 0.5160634434561132, "mean_env_wait_ms": 0.14512600668152748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020561933517456055, "StateBufferConnector_ms": 0.018146038055419922, "ViewRequirementAgentConnector_ms": 0.47139978408813477}}, "episode_reward_max": 51.087, "episode_reward_min": 7.438, "episode_reward_mean": 15.524546666666662, "episode_len_mean": 27.71, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.143666666666665, 10.868333333333332, 10.781666666666665, 9.256666666666664, 20.01266666666665, 10.86533333333333, 14.324333333333332, 9.318666666666664, 21.34066666666666, 13.040333333333331, 12.191999999999997, 14.358666666666661, 21.097666666666655, 10.67133333333333, 8.340666666666666, 10.761333333333331, 11.00333333333333, 12.097333333333328, 13.401999999999997, 22.789333333333314, 31.020333333333333, 12.222333333333331, 9.907999999999996, 9.35233333333333, 10.525999999999996, 14.646999999999995, 8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331, 27.085333333333338, 20.744666666666667, 28.655333333333324, 12.718999999999994, 9.600999999999997, 10.349999999999996, 7.438, 28.611666666666657, 28.48966666666667, 15.814666666666662, 14.29466666666666, 9.718, 16.718666666666657, 27.50399999999999, 9.406666666666665, 9.853333333333328, 23.116666666666653, 20.184333333333324, 10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663, 13.624666666666664, 13.193333333333326, 9.855666666666663, 15.363999999999997, 12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324], "episode_lengths": [30, 21, 22, 18, 34, 20, 27, 20, 36, 25, 25, 23, 36, 20, 17, 21, 22, 22, 24, 40, 50, 25, 20, 20, 20, 28, 18, 46, 22, 23, 18, 44, 34, 50, 23, 22, 19, 18, 47, 54, 25, 25, 18, 31, 41, 18, 19, 41, 36, 20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26, 27, 26, 18, 27, 22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.172388772307538, "mean_inference_ms": 3.46128987800656, "mean_action_processing_ms": 0.5160634434561132, "mean_env_wait_ms": 0.14512600668152748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020561933517456055, "StateBufferConnector_ms": 0.018146038055419922, "ViewRequirementAgentConnector_ms": 0.47139978408813477}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10010, "num_agent_steps_trained": 41216, "num_env_steps_sampled": 10010, "num_env_steps_trained": 41216, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 48.374862671388776, "num_env_steps_trained_throughput_per_sec": 221.14222935492012, "timesteps_total": 10010, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 10010, "timers": {"training_iteration_time_ms": 133.724, "sample_time_ms": 54.577, "load_time_ms": 0.698, "load_throughput": 45815.917, "learn_time_ms": 6.525, "learn_throughput": 4904.059, "synch_weights_time_ms": 23.07}, "counters": {"num_env_steps_sampled": 10010, "num_env_steps_trained": 41216, "num_agent_steps_sampled": 10010, "num_agent_steps_trained": 41216, "last_target_update_ts": 9569, "num_target_updates": 18}, "done": false, "episodes_total": 468, "training_iteration": 10, "trial_id": "408f7_00000", "date": "2023-12-07_23-46-21", "timestamp": 1702021581, "time_this_iter_s": 20.726688623428345, "time_total_s": 185.99454808235168, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 185.99454808235168, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 95.52413793103447, "ram_util_percent": 94.66896551724139}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 7.355774402618408, "min_q": 1.2828614711761475, "max_q": 10.38976001739502, "mean_td_error": 0.4202185273170471, "model": {}}, "td_error": [0.28552812337875366, -0.3404068946838379, -1.7688632011413574, -0.23959827423095703, -0.149444580078125, -0.16634702682495117, -1.0449333190917969, 0.06267547607421875, 4.835575103759766, 0.2941417694091797, 4.047863006591797, -0.7961077690124512, -0.2541360855102539, -0.03769111633300781, 2.2284929752349854, -0.6059989929199219, 5.703539848327637, -1.2231082916259766, -0.39882850646972656, -0.01633739471435547, 0.027058124542236328, 0.30828380584716797, -0.07761526107788086, -0.4813261032104492, -0.2960515022277832, -0.72214674949646, -0.16300582885742188, 0.16765880584716797, 5.104894638061523, -0.3872251510620117, -0.08091354370117188, -0.3686342239379883], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1431.0, "diff_num_grad_updates_vs_sampler_policy": 1430.0}}, "num_env_steps_sampled": 11011, "num_env_steps_trained": 45792, "num_agent_steps_sampled": 11011, "num_agent_steps_trained": 45792, "last_target_update_ts": 10577, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": 51.16933333333335, "episode_reward_min": 7.438, "episode_reward_mean": 17.13128666666666, "episode_len_mean": 30.39, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331, 27.085333333333338, 20.744666666666667, 28.655333333333324, 12.718999999999994, 9.600999999999997, 10.349999999999996, 7.438, 28.611666666666657, 28.48966666666667, 15.814666666666662, 14.29466666666666, 9.718, 16.718666666666657, 27.50399999999999, 9.406666666666665, 9.853333333333328, 23.116666666666653, 20.184333333333324, 10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663, 13.624666666666664, 13.193333333333326, 9.855666666666663, 15.363999999999997, 12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666], "episode_lengths": [18, 46, 22, 23, 18, 44, 34, 50, 23, 22, 19, 18, 47, 54, 25, 25, 18, 31, 41, 18, 19, 41, 36, 20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26, 27, 26, 18, 27, 22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.171454609856339, "mean_inference_ms": 3.48695556874627, "mean_action_processing_ms": 0.5168931074712597, "mean_env_wait_ms": 0.14360497684429177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01669597625732422, "StateBufferConnector_ms": 0.01893758773803711, "ViewRequirementAgentConnector_ms": 0.43877577781677246}}, "episode_reward_max": 51.16933333333335, "episode_reward_min": 7.438, "episode_reward_mean": 17.13128666666666, "episode_len_mean": 30.39, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.71133333333333, 30.225666666666655, 11.912333333333327, 13.941999999999995, 9.607333333333331, 27.085333333333338, 20.744666666666667, 28.655333333333324, 12.718999999999994, 9.600999999999997, 10.349999999999996, 7.438, 28.611666666666657, 28.48966666666667, 15.814666666666662, 14.29466666666666, 9.718, 16.718666666666657, 27.50399999999999, 9.406666666666665, 9.853333333333328, 23.116666666666653, 20.184333333333324, 10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663, 13.624666666666664, 13.193333333333326, 9.855666666666663, 15.363999999999997, 12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666], "episode_lengths": [18, 46, 22, 23, 18, 44, 34, 50, 23, 22, 19, 18, 47, 54, 25, 25, 18, 31, 41, 18, 19, 41, 36, 20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26, 27, 26, 18, 27, 22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.171454609856339, "mean_inference_ms": 3.48695556874627, "mean_action_processing_ms": 0.5168931074712597, "mean_env_wait_ms": 0.14360497684429177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01669597625732422, "StateBufferConnector_ms": 0.01893758773803711, "ViewRequirementAgentConnector_ms": 0.43877577781677246}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11011, "num_agent_steps_trained": 45792, "num_env_steps_sampled": 11011, "num_env_steps_trained": 45792, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 51.59679777006378, "num_env_steps_trained_throughput_per_sec": 235.87107552029158, "timesteps_total": 11011, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 11011, "timers": {"training_iteration_time_ms": 124.601, "sample_time_ms": 51.001, "load_time_ms": 0.932, "load_throughput": 34345.231, "learn_time_ms": 5.931, "learn_throughput": 5395.232, "synch_weights_time_ms": 22.314}, "counters": {"num_env_steps_sampled": 11011, "num_env_steps_trained": 45792, "num_agent_steps_sampled": 11011, "num_agent_steps_trained": 45792, "last_target_update_ts": 10577, "num_target_updates": 20}, "done": false, "episodes_total": 494, "training_iteration": 11, "trial_id": "408f7_00000", "date": "2023-12-07_23-46-41", "timestamp": 1702021601, "time_this_iter_s": 19.432886362075806, "time_total_s": 205.4274344444275, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 205.4274344444275, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 94.81538461538463, "ram_util_percent": 95.76538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 7.914210796356201, "min_q": 2.463031768798828, "max_q": 12.44703483581543, "mean_td_error": 0.6270697116851807, "model": {}}, "td_error": [0.4759025573730469, 8.341360092163086, 0.6952610015869141, -0.4608573913574219, 0.0915670394897461, 1.2224736213684082, 0.689579963684082, -0.12696194648742676, 0.146942138671875, -0.9529743194580078, 0.1393423080444336, 0.3768577575683594, -0.15154647827148438, -0.7485952377319336, -1.4580984115600586, 0.8847427368164062, -0.5973520278930664, 1.945906639099121, 2.1456146240234375, 0.09207820892333984, 1.3442268371582031, 1.5829997062683105, 0.2608776092529297, 0.030594825744628906, 5.197410583496094, 0.521665096282959, -0.3439629077911377, -0.07849502563476562, -0.7551696300506592, 0.2592802047729492, 0.1429290771484375, -0.8473682403564453], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1574.0, "diff_num_grad_updates_vs_sampler_policy": 1573.0}}, "num_env_steps_sampled": 12012, "num_env_steps_trained": 50368, "num_agent_steps_sampled": 12012, "num_agent_steps_trained": 50368, "last_target_update_ts": 11585, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 55.714333333333315, "episode_reward_min": 7.944333333333333, "episode_reward_mean": 18.645026666666663, "episode_len_mean": 33.12, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663, 13.624666666666664, 13.193333333333326, 9.855666666666663, 15.363999999999997, 12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333], "episode_lengths": [20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26, 27, 26, 18, 27, 22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1508913082839842, "mean_inference_ms": 3.455483082388667, "mean_action_processing_ms": 0.5140773260215252, "mean_env_wait_ms": 0.1426723616388864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015813589096069336, "StateBufferConnector_ms": 0.02122950553894043, "ViewRequirementAgentConnector_ms": 0.3984198570251465}}, "episode_reward_max": 55.714333333333315, "episode_reward_min": 7.944333333333333, "episode_reward_mean": 18.645026666666663, "episode_len_mean": 33.12, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.522999999999994, 8.66933333333333, 9.515333333333334, 17.097333333333324, 16.195666666666664, 13.948666666666663, 10.651666666666658, 23.88566666666667, 12.431999999999995, 14.591999999999993, 22.645333333333312, 9.665333333333333, 11.704666666666665, 17.194333333333333, 7.975666666666665, 7.944333333333333, 12.752666666666663, 13.624666666666664, 13.193333333333326, 9.855666666666663, 15.363999999999997, 12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333], "episode_lengths": [20, 16, 18, 34, 28, 23, 23, 37, 22, 24, 34, 17, 25, 29, 17, 16, 26, 27, 26, 18, 27, 22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1508913082839842, "mean_inference_ms": 3.455483082388667, "mean_action_processing_ms": 0.5140773260215252, "mean_env_wait_ms": 0.1426723616388864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015813589096069336, "StateBufferConnector_ms": 0.02122950553894043, "ViewRequirementAgentConnector_ms": 0.3984198570251465}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12012, "num_agent_steps_trained": 50368, "num_env_steps_sampled": 12012, "num_env_steps_trained": 50368, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 52.78405156362114, "num_env_steps_trained_throughput_per_sec": 241.29852143369664, "timesteps_total": 12012, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 12012, "timers": {"training_iteration_time_ms": 94.561, "sample_time_ms": 38.057, "load_time_ms": 0.401, "load_throughput": 79848.729, "learn_time_ms": 5.508, "learn_throughput": 5809.587, "synch_weights_time_ms": 21.945}, "counters": {"num_env_steps_sampled": 12012, "num_env_steps_trained": 50368, "num_agent_steps_sampled": 12012, "num_agent_steps_trained": 50368, "last_target_update_ts": 11585, "num_target_updates": 22}, "done": false, "episodes_total": 517, "training_iteration": 12, "trial_id": "408f7_00000", "date": "2023-12-07_23-47-00", "timestamp": 1702021620, "time_this_iter_s": 18.98928928375244, "time_total_s": 224.41672372817993, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 224.41672372817993, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 90.10000000000001, "ram_util_percent": 95.85384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 10.434060096740723, "min_q": 1.3322703838348389, "max_q": 14.474371910095215, "mean_td_error": 0.49291104078292847, "model": {}}, "td_error": [0.05637931823730469, -0.6485691070556641, 0.2660102844238281, 0.49874401092529297, 0.1410198211669922, -0.4001779556274414, -0.1998453140258789, 0.7938871383666992, 0.7825117111206055, -1.5322411060333252, -0.015615463256835938, 1.5703516006469727, 0.8402576446533203, 0.06455326080322266, -0.06246662139892578, 0.6159505844116211, 0.07471466064453125, 1.3012046813964844, -0.38115596771240234, 0.2757415771484375, 0.47072315216064453, 0.34963035583496094, 0.3962106704711914, -0.7985811233520508, -0.2684955596923828, -0.41257190704345703, 11.456015586853027, -0.011899948120117188, 1.288710594177246, -1.4944608211517334, 1.5039267539978027, -0.7473077774047852], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1717.0, "diff_num_grad_updates_vs_sampler_policy": 1716.0}}, "num_env_steps_sampled": 13013, "num_env_steps_trained": 54944, "num_agent_steps_sampled": 13013, "num_agent_steps_trained": 54944, "last_target_update_ts": 12593, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 55.714333333333315, "episode_reward_min": 8.738333333333332, "episode_reward_mean": 21.998479999999994, "episode_len_mean": 38.88, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974], "episode_lengths": [22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.16175154248907, "mean_inference_ms": 3.528826028023007, "mean_action_processing_ms": 0.5184080555064198, "mean_env_wait_ms": 0.1432398637445101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017351627349853516, "StateBufferConnector_ms": 0.019569873809814453, "ViewRequirementAgentConnector_ms": 0.39586901664733887}}, "episode_reward_max": 55.714333333333315, "episode_reward_min": 8.738333333333332, "episode_reward_mean": 21.998479999999994, "episode_len_mean": 38.88, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.183333333333326, 17.66633333333333, 21.367999999999984, 13.943999999999997, 16.55033333333333, 32.08099999999999, 12.893999999999997, 9.693999999999996, 8.738333333333332, 11.700666666666663, 29.491999999999987, 18.875333333333327, 16.96966666666667, 51.087, 9.429999999999998, 10.231999999999996, 21.30533333333332, 14.194333333333327, 16.099999999999987, 10.049666666666663, 10.863666666666667, 19.85633333333333, 12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974], "episode_lengths": [22, 33, 40, 27, 30, 52, 24, 18, 19, 21, 52, 34, 29, 75, 18, 20, 43, 24, 27, 19, 19, 31, 22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.16175154248907, "mean_inference_ms": 3.528826028023007, "mean_action_processing_ms": 0.5184080555064198, "mean_env_wait_ms": 0.1432398637445101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017351627349853516, "StateBufferConnector_ms": 0.019569873809814453, "ViewRequirementAgentConnector_ms": 0.39586901664733887}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13013, "num_agent_steps_trained": 54944, "num_env_steps_sampled": 13013, "num_env_steps_trained": 54944, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 45.432992817504626, "num_env_steps_trained_throughput_per_sec": 207.69368145144972, "timesteps_total": 13013, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 13013, "timers": {"training_iteration_time_ms": 188.873, "sample_time_ms": 90.261, "load_time_ms": 1.046, "load_throughput": 30586.752, "learn_time_ms": 8.417, "learn_throughput": 3801.997, "synch_weights_time_ms": 24.927}, "counters": {"num_env_steps_sampled": 13013, "num_env_steps_trained": 54944, "num_agent_steps_sampled": 13013, "num_agent_steps_trained": 54944, "last_target_update_ts": 12593, "num_target_updates": 24}, "done": false, "episodes_total": 538, "training_iteration": 13, "trial_id": "408f7_00000", "date": "2023-12-07_23-47-22", "timestamp": 1702021642, "time_this_iter_s": 22.08895969390869, "time_total_s": 246.50568342208862, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 246.50568342208862, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 88.20999999999998, "ram_util_percent": 94.13666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 10.340015411376953, "min_q": 1.3076530694961548, "max_q": 15.432380676269531, "mean_td_error": 0.0063540637493133545, "model": {}}, "td_error": [-0.4257335662841797, -0.7290010452270508, -0.23330116271972656, 2.6628596782684326, -0.17358875274658203, -3.431431770324707, -0.8426704406738281, 8.407785415649414, -0.6672086715698242, 0.14455366134643555, -0.4854259490966797, -0.3433399200439453, 0.9204277992248535, -0.3640022277832031, -2.355356216430664, -0.18813705444335938, -0.668548583984375, -0.8494396209716797, 0.36531972885131836, 10.280373573303223, -0.06807994842529297, -0.8044674396514893, -1.7710187435150146, -1.4540395736694336, -0.9788703918457031, -0.5646004676818848, -0.7677097320556641, -0.2162303924560547, -0.9807395935058594, -0.6642446517944336, 0.13407230377197266, -2.684877395629883], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1860.0, "diff_num_grad_updates_vs_sampler_policy": 1859.0}}, "num_env_steps_sampled": 14014, "num_env_steps_trained": 59520, "num_agent_steps_sampled": 14014, "num_agent_steps_trained": 59520, "last_target_update_ts": 13601, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": 55.714333333333315, "episode_reward_min": 9.572999999999999, "episode_reward_mean": 23.230113333333325, "episode_len_mean": 41.48, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974, 37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993], "episode_lengths": [22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69, 65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1400064808976755, "mean_inference_ms": 3.500678375939047, "mean_action_processing_ms": 0.5136695701060562, "mean_env_wait_ms": 0.14277382807146236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02486586570739746, "StateBufferConnector_ms": 0.023415327072143555, "ViewRequirementAgentConnector_ms": 0.4148387908935547}}, "episode_reward_max": 55.714333333333315, "episode_reward_min": 9.572999999999999, "episode_reward_mean": 23.230113333333325, "episode_len_mean": 41.48, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.778333333333325, 13.695999999999993, 12.517666666666663, 9.572999999999999, 15.759999999999998, 33.16699999999999, 13.255999999999991, 19.954333333333324, 29.990666666666662, 9.881333333333329, 19.359999999999992, 12.468666666666664, 23.307999999999986, 13.527666666666661, 17.94966666666667, 14.399666666666663, 11.006666666666662, 14.937999999999995, 51.16933333333335, 20.007666666666662, 23.181, 39.94366666666668, 16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974, 37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993], "episode_lengths": [22, 26, 23, 19, 26, 57, 23, 33, 49, 19, 33, 22, 37, 26, 36, 31, 20, 29, 88, 36, 52, 58, 29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69, 65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1400064808976755, "mean_inference_ms": 3.500678375939047, "mean_action_processing_ms": 0.5136695701060562, "mean_env_wait_ms": 0.14277382807146236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02486586570739746, "StateBufferConnector_ms": 0.023415327072143555, "ViewRequirementAgentConnector_ms": 0.4148387908935547}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14014, "num_agent_steps_trained": 59520, "num_env_steps_sampled": 14014, "num_env_steps_trained": 59520, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 57.600095266219626, "num_env_steps_trained_throughput_per_sec": 263.314721217004, "timesteps_total": 14014, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 14014, "timers": {"training_iteration_time_ms": 92.69, "sample_time_ms": 32.166, "load_time_ms": 0.398, "load_throughput": 80350.651, "learn_time_ms": 4.961, "learn_throughput": 6450.543, "synch_weights_time_ms": 22.451}, "counters": {"num_env_steps_sampled": 14014, "num_env_steps_trained": 59520, "num_agent_steps_sampled": 14014, "num_agent_steps_trained": 59520, "last_target_update_ts": 13601, "num_target_updates": 26}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "408f7_00000", "date": "2023-12-07_23-47-40", "timestamp": 1702021660, "time_this_iter_s": 17.410696506500244, "time_total_s": 263.91637992858887, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 263.91637992858887, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 89.37200000000001, "ram_util_percent": 85.49600000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.099414825439453, "min_q": -0.09170588105916977, "max_q": 17.90604591369629, "mean_td_error": 0.8365878462791443, "model": {}}, "td_error": [1.0965356826782227, 0.39644527435302734, -0.027319908142089844, 0.8510265350341797, 1.1663193702697754, 7.047972679138184, 0.879608154296875, 0.5564556121826172, 0.2504701614379883, 0.5314393043518066, 0.5447597503662109, 0.8389625549316406, -0.037560462951660156, 0.4211082458496094, -0.044007301330566406, 0.05172920227050781, 0.7244911193847656, -1.1143726110458374, 0.7889175415039062, -0.4436674118041992, -0.1008005142211914, 0.8784875869750977, 1.131058692932129, -0.2028179168701172, -1.8892803192138672, 5.721230983734131, 0.0735006332397461, -0.36423397064208984, 0.075042724609375, -0.08043479919433594, -2.512143135070801, 9.561887741088867], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2003.0, "diff_num_grad_updates_vs_sampler_policy": 2002.0}}, "num_env_steps_sampled": 15015, "num_env_steps_trained": 64096, "num_agent_steps_sampled": 15015, "num_agent_steps_trained": 64096, "last_target_update_ts": 14609, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": 55.714333333333315, "episode_reward_min": 10.405666666666662, "episode_reward_mean": 24.057349999999996, "episode_len_mean": 43.03, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974, 37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993, 29.90766666666666, 18.881333333333323, 13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333], "episode_lengths": [29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69, 65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34, 53, 38, 27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1237748384235084, "mean_inference_ms": 3.514440930995538, "mean_action_processing_ms": 0.5134882229495882, "mean_env_wait_ms": 0.142411593504414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024431467056274414, "StateBufferConnector_ms": 0.02359795570373535, "ViewRequirementAgentConnector_ms": 0.41666245460510254}}, "episode_reward_max": 55.714333333333315, "episode_reward_min": 10.405666666666662, "episode_reward_mean": 24.057349999999996, "episode_len_mean": 43.03, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.52633333333333, 12.655333333333326, 36.38199999999999, 20.707000000000004, 15.122666666666662, 11.868333333333332, 14.927333333333328, 10.545666666666664, 24.46166666666666, 26.752999999999986, 16.972999999999992, 14.96166666666666, 18.210333333333324, 22.28033333333332, 37.60499999999998, 26.098999999999997, 10.405666666666662, 25.72, 33.61566666666666, 44.085, 16.575999999999993, 16.949666666666662, 25.736333333333324, 23.781666666666652, 55.714333333333315, 17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974, 37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993, 29.90766666666666, 18.881333333333323, 13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333], "episode_lengths": [29, 23, 54, 37, 31, 23, 28, 21, 37, 52, 36, 27, 37, 40, 62, 44, 19, 40, 53, 70, 35, 34, 45, 45, 84, 31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69, 65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34, 53, 38, 27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1237748384235084, "mean_inference_ms": 3.514440930995538, "mean_action_processing_ms": 0.5134882229495882, "mean_env_wait_ms": 0.142411593504414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024431467056274414, "StateBufferConnector_ms": 0.02359795570373535, "ViewRequirementAgentConnector_ms": 0.41666245460510254}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15015, "num_agent_steps_trained": 64096, "num_env_steps_sampled": 15015, "num_env_steps_trained": 64096, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 71.47833018245173, "num_env_steps_trained_throughput_per_sec": 326.758080834065, "timesteps_total": 15015, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 15015, "timers": {"training_iteration_time_ms": 117.878, "sample_time_ms": 41.798, "load_time_ms": 0.6, "load_throughput": 53303.307, "learn_time_ms": 6.443, "learn_throughput": 4966.539, "synch_weights_time_ms": 22.922}, "counters": {"num_env_steps_sampled": 15015, "num_env_steps_trained": 64096, "num_agent_steps_sampled": 15015, "num_agent_steps_trained": 64096, "last_target_update_ts": 14609, "num_target_updates": 28}, "done": false, "episodes_total": 582, "training_iteration": 15, "trial_id": "408f7_00000", "date": "2023-12-07_23-47-54", "timestamp": 1702021674, "time_this_iter_s": 14.038471698760986, "time_total_s": 277.95485162734985, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 277.95485162734985, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 71.00526315789473, "ram_util_percent": 81.76315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 9.911293029785156, "min_q": -0.27689605951309204, "max_q": 17.116010665893555, "mean_td_error": 0.2208666056394577, "model": {}}, "td_error": [-1.299896001815796, 1.380782127380371, -2.9492897987365723, 0.9483890533447266, -3.9360532760620117, -2.535702705383301, 1.6171197891235352, -0.7225017547607422, -0.17011165618896484, 0.7558126449584961, -0.6556739807128906, 0.08753681182861328, -0.29871082305908203, 0.540043830871582, -0.509488582611084, -1.8054590225219727, 12.692702293395996, 0.035552024841308594, 0.3756685256958008, 5.412555694580078, -3.168379783630371, -0.2773780822753906, -1.3452558517456055, 2.141592502593994, 0.06497573852539062, 2.34663724899292, -0.1657543182373047, 0.45598697662353516, -1.4164562225341797, -0.9697904586791992, 0.7475442886352539, -0.30926513671875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2146.0, "diff_num_grad_updates_vs_sampler_policy": 2145.0}}, "num_env_steps_sampled": 16016, "num_env_steps_trained": 68672, "num_agent_steps_sampled": 16016, "num_agent_steps_trained": 68672, "last_target_update_ts": 15617, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": 68.98866666666667, "episode_reward_min": 10.618666666666664, "episode_reward_mean": 24.296086666666664, "episode_len_mean": 43.91, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974, 37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993, 29.90766666666666, 18.881333333333323, 13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333, 14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661], "episode_lengths": [31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69, 65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34, 53, 38, 27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42, 25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.104403270812079, "mean_inference_ms": 3.5231293128825087, "mean_action_processing_ms": 0.5130901683355431, "mean_env_wait_ms": 0.14200173954023607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024151325225830078, "StateBufferConnector_ms": 0.021275043487548828, "ViewRequirementAgentConnector_ms": 0.44843053817749023}}, "episode_reward_max": 68.98866666666667, "episode_reward_min": 10.618666666666664, "episode_reward_mean": 24.296086666666664, "episode_len_mean": 43.91, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.733999999999995, 26.05899999999998, 15.230333333333327, 15.574999999999992, 18.981999999999996, 29.176999999999992, 18.51066666666667, 16.411999999999995, 17.234, 14.38533333333333, 18.881666666666657, 34.53266666666667, 32.84733333333332, 42.188666666666656, 48.69666666666665, 43.66466666666667, 23.278666666666663, 29.921999999999997, 34.57366666666665, 18.853333333333328, 26.30666666666665, 31.04533333333332, 27.41399999999999, 13.429999999999994, 24.089000000000002, 31.45099999999999, 44.777, 17.109333333333336, 27.578333333333333, 12.258999999999997, 31.876999999999974, 37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993, 29.90766666666666, 18.881333333333323, 13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333, 14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661], "episode_lengths": [31, 43, 28, 30, 35, 56, 34, 32, 37, 31, 37, 59, 53, 72, 80, 64, 54, 49, 59, 32, 55, 54, 51, 25, 42, 55, 72, 31, 47, 23, 69, 65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34, 53, 38, 27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42, 25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.104403270812079, "mean_inference_ms": 3.5231293128825087, "mean_action_processing_ms": 0.5130901683355431, "mean_env_wait_ms": 0.14200173954023607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024151325225830078, "StateBufferConnector_ms": 0.021275043487548828, "ViewRequirementAgentConnector_ms": 0.44843053817749023}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16016, "num_agent_steps_trained": 68672, "num_env_steps_sampled": 16016, "num_env_steps_trained": 68672, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 60.191123330392756, "num_env_steps_trained_throughput_per_sec": 275.1594209389383, "timesteps_total": 16016, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 16016, "timers": {"training_iteration_time_ms": 102.805, "sample_time_ms": 36.129, "load_time_ms": 0.39, "load_throughput": 82025.135, "learn_time_ms": 6.337, "learn_throughput": 5049.804, "synch_weights_time_ms": 22.486}, "counters": {"num_env_steps_sampled": 16016, "num_env_steps_trained": 68672, "num_agent_steps_sampled": 16016, "num_agent_steps_trained": 68672, "last_target_update_ts": 15617, "num_target_updates": 30}, "done": false, "episodes_total": 607, "training_iteration": 16, "trial_id": "408f7_00000", "date": "2023-12-07_23-48-11", "timestamp": 1702021691, "time_this_iter_s": 16.653712272644043, "time_total_s": 294.6085638999939, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 294.6085638999939, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 78.62173913043478, "ram_util_percent": 81.69565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.839781761169434, "min_q": 0.9542405605316162, "max_q": 18.26486587524414, "mean_td_error": -0.5221408605575562, "model": {}}, "td_error": [0.5025558471679688, -0.1415386199951172, -0.1965799331665039, 0.3936920166015625, 0.0877695083618164, 1.3154306411743164, -2.165147304534912, -3.335470199584961, -2.145461082458496, 0.17499542236328125, -3.677387237548828, 0.2621917724609375, 0.14191150665283203, -0.3530712127685547, 0.014987945556640625, 0.18831825256347656, -0.028759419918060303, -0.7742185592651367, 0.015616416931152344, 0.1430492401123047, -0.095550537109375, 0.19739151000976562, -0.811793327331543, 0.5206699371337891, -1.8078460693359375, -2.7938976287841797, 1.0608010292053223, -0.020177841186523438, -0.582636833190918, -2.4740591049194336, -0.09188652038574219, -0.2324066162109375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2289.0, "diff_num_grad_updates_vs_sampler_policy": 2288.0}}, "num_env_steps_sampled": 17017, "num_env_steps_trained": 73248, "num_agent_steps_sampled": 17017, "num_agent_steps_trained": 73248, "last_target_update_ts": 16625, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": 68.98866666666667, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 21.987873333333333, "episode_len_mean": 39.77, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993, 29.90766666666666, 18.881333333333323, 13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333, 14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331], "episode_lengths": [65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34, 53, 38, 27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42, 25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.088612724338368, "mean_inference_ms": 3.569659096208152, "mean_action_processing_ms": 0.5156483841276406, "mean_env_wait_ms": 0.1411943669622111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02181553840637207, "StateBufferConnector_ms": 0.02151203155517578, "ViewRequirementAgentConnector_ms": 0.4433872699737549}}, "episode_reward_max": 68.98866666666667, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 21.987873333333333, "episode_len_mean": 39.77, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.7493333333333, 32.108333333333306, 18.288666666666657, 13.025999999999996, 17.514333333333322, 15.708999999999994, 10.618666666666664, 25.03399999999998, 26.665666666666656, 17.520999999999994, 21.497999999999987, 26.94, 18.50099999999999, 26.70866666666667, 28.55166666666664, 19.602999999999994, 27.50333333333332, 38.57033333333334, 18.35166666666666, 34.283333333333324, 16.32366666666666, 17.368999999999993, 29.90766666666666, 18.881333333333323, 13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333, 14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331], "episode_lengths": [65, 62, 33, 26, 36, 28, 20, 43, 44, 35, 48, 57, 36, 47, 50, 38, 55, 62, 32, 57, 29, 34, 53, 38, 27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42, 25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.088612724338368, "mean_inference_ms": 3.569659096208152, "mean_action_processing_ms": 0.5156483841276406, "mean_env_wait_ms": 0.1411943669622111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02181553840637207, "StateBufferConnector_ms": 0.02151203155517578, "ViewRequirementAgentConnector_ms": 0.4433872699737549}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17017, "num_agent_steps_trained": 73248, "num_env_steps_sampled": 17017, "num_env_steps_trained": 73248, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 65.76689658538636, "num_env_steps_trained_throughput_per_sec": 300.64867010462336, "timesteps_total": 17017, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 17017, "timers": {"training_iteration_time_ms": 92.2, "sample_time_ms": 30.665, "load_time_ms": 0.4, "load_throughput": 80067.845, "learn_time_ms": 5.493, "learn_throughput": 5825.599, "synch_weights_time_ms": 22.83}, "counters": {"num_env_steps_sampled": 17017, "num_env_steps_trained": 73248, "num_agent_steps_sampled": 17017, "num_agent_steps_trained": 73248, "last_target_update_ts": 16625, "num_target_updates": 32}, "done": false, "episodes_total": 638, "training_iteration": 17, "trial_id": "408f7_00000", "date": "2023-12-07_23-48-26", "timestamp": 1702021706, "time_this_iter_s": 15.243680477142334, "time_total_s": 309.85224437713623, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 309.85224437713623, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 76.2, "ram_util_percent": 82.98095238095239}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 11.617137908935547, "min_q": 2.7568843364715576, "max_q": 19.353099822998047, "mean_td_error": 0.7083545327186584, "model": {}}, "td_error": [-2.745086669921875, -1.8550701141357422, -0.40758228302001953, -1.8897767066955566, 7.249277591705322, 2.711270809173584, 0.49925994873046875, -0.08996105194091797, 0.1678333282470703, 2.3802490234375, -0.19415664672851562, -0.11253929138183594, -2.7200193405151367, -3.0648059844970703, -0.3888225555419922, -0.07349872589111328, 14.750040054321289, 6.585358619689941, -0.19870281219482422, -0.241485595703125, 1.8452177047729492, 0.22649192810058594, -0.7487697601318359, 0.042939186096191406, -0.7380123138427734, 0.6793699264526367, -0.06231212615966797, 0.03566932678222656, -0.2539858818054199, -0.6851654052734375, 2.0954251289367676, -0.13130569458007812], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2432.0, "diff_num_grad_updates_vs_sampler_policy": 2431.0}}, "num_env_steps_sampled": 18018, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 18018, "num_agent_steps_trained": 77824, "last_target_update_ts": 17633, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": 68.98866666666667, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 21.792976666666664, "episode_len_mean": 39.33, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333, 14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666], "episode_lengths": [27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42, 25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0510008868844394, "mean_inference_ms": 3.5157820235077875, "mean_action_processing_ms": 0.5116240660196083, "mean_env_wait_ms": 0.1397322398089392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02780747413635254, "StateBufferConnector_ms": 0.01109004020690918, "ViewRequirementAgentConnector_ms": 0.4173715114593506}}, "episode_reward_max": 68.98866666666667, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 21.792976666666664, "episode_len_mean": 39.33, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.45066666666666, 26.89100000000001, 33.495999999999995, 16.11466666666666, 17.657666666666664, 17.724333333333323, 11.169333333333327, 27.95800000000001, 18.825333333333322, 26.565333333333324, 22.539999999999996, 33.55666666666668, 23.393666666666665, 38.07533333333332, 31.407999999999976, 17.169, 15.056666666666665, 22.76633333333333, 28.649666666666647, 23.30133333333333, 14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666], "episode_lengths": [27, 54, 60, 32, 31, 36, 21, 49, 37, 45, 37, 57, 47, 64, 51, 33, 27, 38, 41, 42, 25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0510008868844394, "mean_inference_ms": 3.5157820235077875, "mean_action_processing_ms": 0.5116240660196083, "mean_env_wait_ms": 0.1397322398089392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02780747413635254, "StateBufferConnector_ms": 0.01109004020690918, "ViewRequirementAgentConnector_ms": 0.4173715114593506}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18018, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 18018, "num_env_steps_trained": 77824, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 81.66071537421863, "num_env_steps_trained_throughput_per_sec": 373.30612742499943, "timesteps_total": 18018, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 18018, "timers": {"training_iteration_time_ms": 79.548, "sample_time_ms": 25.722, "load_time_ms": 0.1, "load_throughput": 319642.124, "learn_time_ms": 5.114, "learn_throughput": 6256.828, "synch_weights_time_ms": 22.563}, "counters": {"num_env_steps_sampled": 18018, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 18018, "num_agent_steps_trained": 77824, "last_target_update_ts": 17633, "num_target_updates": 34}, "done": false, "episodes_total": 662, "training_iteration": 18, "trial_id": "408f7_00000", "date": "2023-12-07_23-48-38", "timestamp": 1702021718, "time_this_iter_s": 12.274420738220215, "time_total_s": 322.12666511535645, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 322.12666511535645, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 68.53888888888888, "ram_util_percent": 84.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.513973236083984, "min_q": 3.494389295578003, "max_q": 18.220659255981445, "mean_td_error": 0.6749246716499329, "model": {}}, "td_error": [-0.057342529296875, -0.6427721977233887, -0.046268463134765625, -1.825958251953125, 10.643729209899902, 0.24817943572998047, 3.8577218055725098, -0.18232154846191406, 1.1466560363769531, -0.29548168182373047, -0.37068939208984375, 1.1171188354492188, 0.6574115753173828, 0.2930412292480469, 0.10037803649902344, -0.020738601684570312, 0.8947038650512695, 2.5370559692382812, -0.6231908798217773, 1.9368677139282227, 0.025568008422851562, -0.6037807464599609, 0.8563060760498047, 0.3176755905151367, -0.7029294967651367, -0.8056597709655762, -1.459177017211914, 0.07447528839111328, -0.4063720703125, 2.6148481369018555, 2.3671321868896484, -0.04859638214111328], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2575.0, "diff_num_grad_updates_vs_sampler_policy": 2574.0}}, "num_env_steps_sampled": 19019, "num_env_steps_trained": 82400, "num_agent_steps_sampled": 19019, "num_agent_steps_trained": 82400, "last_target_update_ts": 18641, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": 68.98866666666667, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 22.594183333333323, "episode_len_mean": 40.31, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329], "episode_lengths": [25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0297836822023303, "mean_inference_ms": 3.5034047264427848, "mean_action_processing_ms": 0.5106986514417342, "mean_env_wait_ms": 0.13978114457943824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028209447860717773, "StateBufferConnector_ms": 0.010097503662109375, "ViewRequirementAgentConnector_ms": 0.4067063331604004}}, "episode_reward_max": 68.98866666666667, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 22.594183333333323, "episode_len_mean": 40.31, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.00466666666666, 19.925666666666654, 18.95733333333333, 13.174333333333324, 16.537666666666663, 41.84999999999998, 14.022333333333327, 47.963000000000044, 15.491666666666664, 18.042666666666666, 11.619666666666662, 39.641333333333314, 14.949333333333332, 14.198999999999998, 44.880333333333326, 17.79333333333333, 32.79366666666666, 21.713999999999988, 31.17000000000001, 15.765333333333327, 17.65933333333333, 68.98866666666667, 12.633999999999995, 24.94966666666667, 13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329], "episode_lengths": [25, 38, 39, 25, 34, 61, 28, 82, 31, 37, 22, 61, 31, 26, 82, 39, 64, 42, 60, 31, 31, 107, 23, 51, 24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0297836822023303, "mean_inference_ms": 3.5034047264427848, "mean_action_processing_ms": 0.5106986514417342, "mean_env_wait_ms": 0.13978114457943824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028209447860717773, "StateBufferConnector_ms": 0.010097503662109375, "ViewRequirementAgentConnector_ms": 0.4067063331604004}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19019, "num_agent_steps_trained": 82400, "num_env_steps_sampled": 19019, "num_env_steps_trained": 82400, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 74.0918939976365, "num_env_steps_trained_throughput_per_sec": 338.7058011320526, "timesteps_total": 19019, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 19019, "timers": {"training_iteration_time_ms": 89.32, "sample_time_ms": 30.416, "load_time_ms": 0.605, "load_throughput": 52929.146, "learn_time_ms": 4.871, "learn_throughput": 6570.154, "synch_weights_time_ms": 21.632}, "counters": {"num_env_steps_sampled": 19019, "num_env_steps_trained": 82400, "num_agent_steps_sampled": 19019, "num_agent_steps_trained": 82400, "last_target_update_ts": 18641, "num_target_updates": 36}, "done": false, "episodes_total": 682, "training_iteration": 19, "trial_id": "408f7_00000", "date": "2023-12-07_23-48-52", "timestamp": 1702021732, "time_this_iter_s": 13.539245843887329, "time_total_s": 335.6659109592438, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 335.6659109592438, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 72.58333333333333, "ram_util_percent": 84.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.7320556640625, "min_q": 2.092358112335205, "max_q": 18.73659324645996, "mean_td_error": 0.4863392114639282, "model": {}}, "td_error": [1.7337119579315186, 0.15524578094482422, 1.0225963592529297, -0.2597312927246094, 0.5749776363372803, 1.7068977355957031, -0.3022613525390625, -0.30193328857421875, -0.7686023712158203, 1.160639762878418, -0.2111501693725586, 1.0022153854370117, 0.13944244384765625, 0.42410850524902344, -0.6055736541748047, 1.5768623352050781, -0.30927467346191406, 1.3981895446777344, 0.15524578094482422, 0.38191986083984375, -2.5408782958984375, 1.707646369934082, -1.0212135314941406, 0.29269981384277344, -0.601287841796875, 1.9439544677734375, -0.5709390640258789, 0.03476524353027344, 5.183782577514648, 0.7511758804321289, 1.4611015319824219, 0.2485208511352539], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2718.0, "diff_num_grad_updates_vs_sampler_policy": 2717.0}}, "num_env_steps_sampled": 20020, "num_env_steps_trained": 86976, "num_agent_steps_sampled": 20020, "num_agent_steps_trained": 86976, "last_target_update_ts": 19649, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": 72.0613333333334, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 23.061346666666658, "episode_len_mean": 40.53, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976], "episode_lengths": [24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0025018539092336, "mean_inference_ms": 3.4658494942149662, "mean_action_processing_ms": 0.5076530261219958, "mean_env_wait_ms": 0.13964261993690394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027355194091796875, "StateBufferConnector_ms": 0.009674310684204102, "ViewRequirementAgentConnector_ms": 0.430588960647583}}, "episode_reward_max": 72.0613333333334, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 23.061346666666658, "episode_len_mean": 40.53, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.809666666666661, 27.752999999999986, 15.561666666666657, 14.091999999999997, 22.83366666666666, 12.892999999999995, 20.757, 21.775333333333332, 13.801666666666659, 15.152666666666661, 11.071999999999997, 17.302666666666656, 25.29166666666665, 24.970666666666652, 32.17366666666665, 27.288999999999987, 26.370333333333306, 25.877333333333322, 27.155333333333317, 24.422999999999995, 15.58166666666666, 14.29133333333333, 11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976], "episode_lengths": [24, 49, 30, 25, 38, 24, 37, 40, 26, 29, 24, 33, 43, 38, 54, 49, 48, 45, 47, 41, 30, 27, 20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0025018539092336, "mean_inference_ms": 3.4658494942149662, "mean_action_processing_ms": 0.5076530261219958, "mean_env_wait_ms": 0.13964261993690394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027355194091796875, "StateBufferConnector_ms": 0.009674310684204102, "ViewRequirementAgentConnector_ms": 0.430588960647583}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20020, "num_agent_steps_trained": 86976, "num_env_steps_sampled": 20020, "num_env_steps_trained": 86976, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 72.42133672644006, "num_env_steps_trained_throughput_per_sec": 331.06896789229745, "timesteps_total": 20020, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 20020, "timers": {"training_iteration_time_ms": 83.876, "sample_time_ms": 30.767, "load_time_ms": 0.3, "load_throughput": 106640.496, "learn_time_ms": 5.282, "learn_throughput": 6058.479, "synch_weights_time_ms": 20.482}, "counters": {"num_env_steps_sampled": 20020, "num_env_steps_trained": 86976, "num_agent_steps_sampled": 20020, "num_agent_steps_trained": 86976, "last_target_update_ts": 19649, "num_target_updates": 38}, "done": false, "episodes_total": 706, "training_iteration": 20, "trial_id": "408f7_00000", "date": "2023-12-07_23-49-06", "timestamp": 1702021746, "time_this_iter_s": 13.838478803634644, "time_total_s": 349.5043897628784, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 349.5043897628784, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 71.76, "ram_util_percent": 86.16999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.465841293334961, "min_q": 1.5195338726043701, "max_q": 21.590835571289062, "mean_td_error": -0.22247643768787384, "model": {}}, "td_error": [-2.700855255126953, 0.6443929672241211, -0.06590747833251953, 1.929243564605713, 1.9275531768798828, 2.654399871826172, -0.6797647476196289, 0.07466316223144531, -3.0097694396972656, 0.46996021270751953, 0.6924571990966797, 1.1484298706054688, -2.4849376678466797, 0.5628672242164612, 0.10576725006103516, 0.3848896026611328, 0.4235992431640625, 0.38858985900878906, -0.5376853942871094, -1.7020668983459473, -2.626397132873535, -1.9978961944580078, 0.07971477508544922, 0.8328390121459961, 0.1718597412109375, 0.08704757690429688, -2.8152542114257812, -1.0053672790527344, 0.5052967071533203, 0.4830355644226074, 1.1067523956298828, -2.166703224182129], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2861.0, "diff_num_grad_updates_vs_sampler_policy": 2860.0}}, "num_env_steps_sampled": 21021, "num_env_steps_trained": 91552, "num_agent_steps_sampled": 21021, "num_agent_steps_trained": 91552, "last_target_update_ts": 20657, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": 72.0613333333334, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 24.02702333333333, "episode_len_mean": 42.42, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657], "episode_lengths": [20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.970955813055569, "mean_inference_ms": 3.3820193533116503, "mean_action_processing_ms": 0.5032739666944205, "mean_env_wait_ms": 0.1390569636870164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030747175216674805, "StateBufferConnector_ms": 0.005456686019897461, "ViewRequirementAgentConnector_ms": 0.46292710304260254}}, "episode_reward_max": 72.0613333333334, "episode_reward_min": 8.353333333333332, "episode_reward_mean": 24.02702333333333, "episode_len_mean": 42.42, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.411666666666664, 12.604999999999995, 8.353333333333332, 13.00933333333333, 20.148666666666664, 13.357999999999997, 18.098, 14.62066666666666, 10.357333333333331, 14.873333333333331, 25.04366666666665, 22.600999999999996, 15.295333333333325, 16.47066666666666, 33.136999999999965, 22.153666666666666, 20.604, 13.885333333333332, 22.777999999999995, 48.328999999999986, 21.656333333333325, 16.79033333333333, 28.606333333333335, 24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657], "episode_lengths": [20, 22, 17, 23, 35, 24, 34, 28, 19, 27, 44, 46, 33, 28, 58, 45, 41, 23, 40, 81, 42, 35, 54, 45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.970955813055569, "mean_inference_ms": 3.3820193533116503, "mean_action_processing_ms": 0.5032739666944205, "mean_env_wait_ms": 0.1390569636870164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030747175216674805, "StateBufferConnector_ms": 0.005456686019897461, "ViewRequirementAgentConnector_ms": 0.46292710304260254}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21021, "num_agent_steps_trained": 91552, "num_env_steps_sampled": 21021, "num_env_steps_trained": 91552, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 77.876575714481, "num_env_steps_trained_throughput_per_sec": 356.00720326619887, "timesteps_total": 21021, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 21021, "timers": {"training_iteration_time_ms": 80.719, "sample_time_ms": 29.264, "load_time_ms": 0.1, "load_throughput": 319186.036, "learn_time_ms": 6.774, "learn_throughput": 4724.23, "synch_weights_time_ms": 20.044}, "counters": {"num_env_steps_sampled": 21021, "num_env_steps_trained": 91552, "num_agent_steps_sampled": 21021, "num_agent_steps_trained": 91552, "last_target_update_ts": 20657, "num_target_updates": 40}, "done": false, "episodes_total": 728, "training_iteration": 21, "trial_id": "408f7_00000", "date": "2023-12-07_23-49-19", "timestamp": 1702021759, "time_this_iter_s": 12.887420177459717, "time_total_s": 362.39180994033813, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 362.39180994033813, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 72.11666666666667, "ram_util_percent": 83.70555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 11.410173416137695, "min_q": 1.5896308422088623, "max_q": 18.88701629638672, "mean_td_error": 0.4033154249191284, "model": {}}, "td_error": [2.7080326080322266, -0.3071765899658203, 2.668532371520996, 0.2278575897216797, -0.29050540924072266, 2.7511377334594727, 4.555765151977539, 0.6029641628265381, 2.854649543762207, 2.834991931915283, 2.529684066772461, -0.060530662536621094, 1.6980209350585938, -0.11606550216674805, 2.7972793579101562, -0.35341644287109375, -2.1400022506713867, -0.7722873687744141, 2.413170337677002, -0.460693359375, -2.714898109436035, -0.28750038146972656, 0.7487201690673828, -3.188990592956543, -2.401487350463867, -0.6137828826904297, -1.0617761611938477, 1.1004552841186523, -2.7068519592285156, 0.241424560546875, -0.38146209716796875, 0.030834197998046875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3004.0, "diff_num_grad_updates_vs_sampler_policy": 3003.0}}, "num_env_steps_sampled": 22022, "num_env_steps_trained": 96128, "num_agent_steps_sampled": 22022, "num_agent_steps_trained": 96128, "last_target_update_ts": 21665, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": 72.0613333333334, "episode_reward_min": 9.056666666666665, "episode_reward_mean": 25.20011999999999, "episode_len_mean": 44.33, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667], "episode_lengths": [45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9611798335511255, "mean_inference_ms": 3.38819606406558, "mean_action_processing_ms": 0.5066285209777063, "mean_env_wait_ms": 0.1395251744121754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029207944869995117, "StateBufferConnector_ms": 0.007300138473510742, "ViewRequirementAgentConnector_ms": 0.5106260776519775}}, "episode_reward_max": 72.0613333333334, "episode_reward_min": 9.056666666666665, "episode_reward_mean": 25.20011999999999, "episode_len_mean": 44.33, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.168666666666656, 17.22133333333333, 9.056666666666665, 17.843, 21.255666666666656, 35.626999999999995, 15.440333333333328, 28.890666666666664, 15.272333333333323, 30.94699999999999, 14.66466666666666, 17.73699999999999, 27.435333333333325, 18.36299999999999, 12.59, 23.027999999999995, 18.622666666666664, 20.190999999999992, 35.96900000000001, 15.410999999999998, 33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667], "episode_lengths": [45, 33, 17, 36, 38, 57, 30, 48, 28, 53, 29, 35, 43, 31, 22, 39, 31, 37, 56, 29, 54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9611798335511255, "mean_inference_ms": 3.38819606406558, "mean_action_processing_ms": 0.5066285209777063, "mean_env_wait_ms": 0.1395251744121754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029207944869995117, "StateBufferConnector_ms": 0.007300138473510742, "ViewRequirementAgentConnector_ms": 0.5106260776519775}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22022, "num_agent_steps_trained": 96128, "num_env_steps_sampled": 22022, "num_env_steps_trained": 96128, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 79.97457696984215, "num_env_steps_trained_throughput_per_sec": 365.59806614784986, "timesteps_total": 22022, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 22022, "timers": {"training_iteration_time_ms": 86.803, "sample_time_ms": 31.56, "load_time_ms": 0.399, "load_throughput": 80153.913, "learn_time_ms": 7.311, "learn_throughput": 4377.174, "synch_weights_time_ms": 21.219}, "counters": {"num_env_steps_sampled": 22022, "num_env_steps_trained": 96128, "num_agent_steps_sampled": 22022, "num_agent_steps_trained": 96128, "last_target_update_ts": 21665, "num_target_updates": 42}, "done": false, "episodes_total": 751, "training_iteration": 22, "trial_id": "408f7_00000", "date": "2023-12-07_23-49-32", "timestamp": 1702021772, "time_this_iter_s": 12.53676962852478, "time_total_s": 374.9285795688629, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 374.9285795688629, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 72.34117647058824, "ram_util_percent": 84.05882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.052985191345215, "min_q": 0.9558446407318115, "max_q": 19.72529411315918, "mean_td_error": -0.7461922764778137, "model": {}}, "td_error": [-0.4820270538330078, -0.0417633056640625, -0.6700925827026367, 2.001178741455078, -0.4711952209472656, -0.21997833251953125, -0.07801532745361328, -0.48590660095214844, -0.25890207290649414, -1.7107000350952148, -2.638087272644043, 0.06009244918823242, 1.914860725402832, -0.4357795715332031, -3.3679561614990234, 2.384934902191162, -0.2595977783203125, -1.3992071151733398, -2.593799591064453, 2.579273223876953, -0.9117498397827148, -3.3103389739990234, -1.5062036514282227, -3.3275699615478516, -0.34337806701660156, -0.22812843322753906, -2.4284276962280273, -0.6518630981445312, -3.0713114738464355, -0.8313455581665039, -0.04748868942260742, -1.0476799011230469], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3147.0, "diff_num_grad_updates_vs_sampler_policy": 3146.0}}, "num_env_steps_sampled": 23023, "num_env_steps_trained": 100704, "num_agent_steps_sampled": 23023, "num_agent_steps_trained": 100704, "last_target_update_ts": 22673, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": 72.0613333333334, "episode_reward_min": 9.687999999999997, "episode_reward_mean": 26.662899999999993, "episode_len_mean": 46.84, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334], "episode_lengths": [54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9520163792173935, "mean_inference_ms": 3.370807083191626, "mean_action_processing_ms": 0.5071346589639102, "mean_env_wait_ms": 0.13954477572586094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236139297485352, "StateBufferConnector_ms": 0.019884824752807617, "ViewRequirementAgentConnector_ms": 0.498274564743042}}, "episode_reward_max": 72.0613333333334, "episode_reward_min": 9.687999999999997, "episode_reward_mean": 26.662899999999993, "episode_len_mean": 46.84, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.99433333333333, 19.26633333333332, 29.559000000000005, 20.312333333333317, 14.188666666666656, 21.081999999999997, 48.17066666666662, 58.58366666666663, 35.21766666666666, 18.62166666666666, 57.54633333333329, 72.0613333333334, 32.935333333333325, 30.49166666666665, 36.52300000000004, 18.42766666666666, 27.14066666666667, 9.687999999999997, 16.13266666666666, 14.812999999999997, 14.281666666666657, 32.321999999999996, 14.199999999999996, 33.23666666666666, 19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334], "episode_lengths": [54, 38, 52, 38, 25, 38, 76, 95, 61, 38, 89, 115, 58, 52, 59, 38, 51, 19, 36, 26, 28, 51, 27, 48, 31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9520163792173935, "mean_inference_ms": 3.370807083191626, "mean_action_processing_ms": 0.5071346589639102, "mean_env_wait_ms": 0.13954477572586094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236139297485352, "StateBufferConnector_ms": 0.019884824752807617, "ViewRequirementAgentConnector_ms": 0.498274564743042}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23023, "num_agent_steps_trained": 100704, "num_env_steps_sampled": 23023, "num_env_steps_trained": 100704, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 80.16147056501497, "num_env_steps_trained_throughput_per_sec": 366.45243686863984, "timesteps_total": 23023, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 23023, "timers": {"training_iteration_time_ms": 78.071, "sample_time_ms": 27.453, "load_time_ms": 0.691, "load_throughput": 46331.502, "learn_time_ms": 5.161, "learn_throughput": 6199.748, "synch_weights_time_ms": 20.523}, "counters": {"num_env_steps_sampled": 23023, "num_env_steps_trained": 100704, "num_agent_steps_sampled": 23023, "num_agent_steps_trained": 100704, "last_target_update_ts": 22673, "num_target_updates": 44}, "done": false, "episodes_total": 771, "training_iteration": 23, "trial_id": "408f7_00000", "date": "2023-12-07_23-49-44", "timestamp": 1702021784, "time_this_iter_s": 12.508103847503662, "time_total_s": 387.4366834163666, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 387.4366834163666, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 73.07222222222222, "ram_util_percent": 85.22777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.941134452819824, "min_q": 3.568814277648926, "max_q": 21.458234786987305, "mean_td_error": -0.7866429686546326, "model": {}}, "td_error": [-1.9687209129333496, -0.2771930694580078, -0.3991127014160156, -0.11761856079101562, -3.4514474868774414, -1.8910675048828125, -1.486130714416504, 1.0963473320007324, 0.49226951599121094, -0.1491537094116211, -1.3682856559753418, -0.8012228012084961, -1.9025440216064453, 1.106801986694336, -1.2168426513671875, -0.6719589233398438, 0.8777790069580078, 0.8105835914611816, 0.9261140823364258, -4.3335161209106445, 0.18552589416503906, -4.750679969787598, -0.34647560119628906, -0.7378759384155273, 1.8907365798950195, -0.10270309448242188, -0.7920742034912109, -1.1588225364685059, 1.6501035690307617, -0.3692169189453125, -4.31593132019043, -1.6002426147460938], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3290.0, "diff_num_grad_updates_vs_sampler_policy": 3289.0}}, "num_env_steps_sampled": 24024, "num_env_steps_trained": 105280, "num_agent_steps_sampled": 24024, "num_agent_steps_trained": 105280, "last_target_update_ts": 23681, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": 62.29333333333329, "episode_reward_min": 11.62633333333333, "episode_reward_mean": 25.35433, "episode_len_mean": 45.57, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662], "episode_lengths": [31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9407357512467662, "mean_inference_ms": 3.343007182527915, "mean_action_processing_ms": 0.509437792842024, "mean_env_wait_ms": 0.13859960231193078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014327764511108398, "StateBufferConnector_ms": 0.021178245544433594, "ViewRequirementAgentConnector_ms": 0.4758758544921875}}, "episode_reward_max": 62.29333333333329, "episode_reward_min": 11.62633333333333, "episode_reward_mean": 25.35433, "episode_len_mean": 45.57, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.69266666666666, 26.429000000000002, 11.62633333333333, 17.69633333333333, 14.298999999999996, 11.880666666666661, 41.64733333333333, 17.24466666666666, 23.95833333333332, 62.29333333333329, 36.421999999999976, 18.747666666666653, 21.33533333333333, 23.25433333333333, 49.74766666666663, 19.225999999999996, 13.360999999999997, 11.871333333333329, 25.42499999999998, 35.02299999999999, 18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662], "episode_lengths": [31, 48, 22, 38, 29, 23, 63, 29, 42, 96, 63, 39, 37, 41, 83, 38, 24, 23, 48, 58, 36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9407357512467662, "mean_inference_ms": 3.343007182527915, "mean_action_processing_ms": 0.509437792842024, "mean_env_wait_ms": 0.13859960231193078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014327764511108398, "StateBufferConnector_ms": 0.021178245544433594, "ViewRequirementAgentConnector_ms": 0.4758758544921875}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24024, "num_agent_steps_trained": 105280, "num_env_steps_sampled": 24024, "num_env_steps_trained": 105280, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 70.08763410076861, "num_env_steps_trained_throughput_per_sec": 320.4006130320851, "timesteps_total": 24024, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 24024, "timers": {"training_iteration_time_ms": 95.358, "sample_time_ms": 33.552, "load_time_ms": 0.261, "load_throughput": 122372.108, "learn_time_ms": 7.104, "learn_throughput": 4504.359, "synch_weights_time_ms": 22.216}, "counters": {"num_env_steps_sampled": 24024, "num_env_steps_trained": 105280, "num_agent_steps_sampled": 24024, "num_agent_steps_trained": 105280, "last_target_update_ts": 23681, "num_target_updates": 46}, "done": false, "episodes_total": 795, "training_iteration": 24, "trial_id": "408f7_00000", "date": "2023-12-07_23-49-58", "timestamp": 1702021798, "time_this_iter_s": 14.304116010665894, "time_total_s": 401.74079942703247, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 401.74079942703247, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 73.35555555555555, "ram_util_percent": 87.72777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.63424301147461, "min_q": -1.808228850364685, "max_q": 20.61235237121582, "mean_td_error": 0.20250365138053894, "model": {}}, "td_error": [1.5090808868408203, 0.30671656131744385, 0.177581787109375, 2.9539146423339844, -3.123171806335449, 0.39937782287597656, 0.26467323303222656, -0.8734931945800781, 1.2866706848144531, -0.24769699573516846, -2.7325620651245117, 1.6913485527038574, 0.2383575439453125, 1.6350526809692383, -3.0837783813476562, -2.858600616455078, -0.4729576110839844, 0.35115814208984375, -1.3822669982910156, 2.659306049346924, 1.8628950119018555, -1.0636119842529297, -0.8913569450378418, 0.02933502197265625, 3.374593734741211, 0.624394416809082, 0.3459157943725586, -0.11287498474121094, 0.3907041549682617, -0.040241241455078125, -1.7074470520019531, 4.969100475311279], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3433.0, "diff_num_grad_updates_vs_sampler_policy": 3432.0}}, "num_env_steps_sampled": 25025, "num_env_steps_trained": 109856, "num_agent_steps_sampled": 25025, "num_agent_steps_trained": 109856, "last_target_update_ts": 24689, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": 61.42366666666668, "episode_reward_min": 12.66833333333333, "episode_reward_mean": 25.28219333333333, "episode_len_mean": 46.18, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648], "episode_lengths": [36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.934823769984126, "mean_inference_ms": 3.341976070420644, "mean_action_processing_ms": 0.509416781056713, "mean_env_wait_ms": 0.1385258709214519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013151884078979492, "StateBufferConnector_ms": 0.02305126190185547, "ViewRequirementAgentConnector_ms": 0.43691539764404297}}, "episode_reward_max": 61.42366666666668, "episode_reward_min": 12.66833333333333, "episode_reward_mean": 25.28219333333333, "episode_len_mean": 46.18, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.866333333333323, 29.358333333333317, 25.835999999999984, 47.701666666666675, 22.671, 13.792666666666664, 28.57999999999999, 28.57099999999998, 41.289666666666655, 16.20666666666666, 20.493999999999993, 14.50366666666666, 20.933666666666657, 32.460999999999984, 15.238666666666662, 16.563999999999993, 23.04199999999999, 20.68066666666666, 15.373666666666665, 14.892999999999988, 35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648], "episode_lengths": [36, 48, 47, 84, 38, 27, 55, 52, 74, 32, 37, 30, 39, 58, 31, 31, 37, 41, 32, 28, 63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.934823769984126, "mean_inference_ms": 3.341976070420644, "mean_action_processing_ms": 0.509416781056713, "mean_env_wait_ms": 0.1385258709214519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013151884078979492, "StateBufferConnector_ms": 0.02305126190185547, "ViewRequirementAgentConnector_ms": 0.43691539764404297}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25025, "num_agent_steps_trained": 109856, "num_env_steps_sampled": 25025, "num_env_steps_trained": 109856, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 82.17575542762913, "num_env_steps_trained_throughput_per_sec": 375.6605962405903, "timesteps_total": 25025, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 25025, "timers": {"training_iteration_time_ms": 86.633, "sample_time_ms": 31.892, "load_time_ms": 0.418, "load_throughput": 76490.413, "learn_time_ms": 5.757, "learn_throughput": 5558.614, "synch_weights_time_ms": 22.178}, "counters": {"num_env_steps_sampled": 25025, "num_env_steps_trained": 109856, "num_agent_steps_sampled": 25025, "num_agent_steps_trained": 109856, "last_target_update_ts": 24689, "num_target_updates": 48}, "done": false, "episodes_total": 815, "training_iteration": 25, "trial_id": "408f7_00000", "date": "2023-12-07_23-50-11", "timestamp": 1702021811, "time_this_iter_s": 12.199351787567139, "time_total_s": 413.9401512145996, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 413.9401512145996, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 73.51176470588234, "ram_util_percent": 89.56470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.042826652526855, "min_q": 2.4417550563812256, "max_q": 20.41795539855957, "mean_td_error": 0.83567214012146, "model": {}}, "td_error": [1.3879623413085938, -0.07308149337768555, -1.113321304321289, -0.05089092254638672, -0.570526123046875, 0.3564181327819824, 1.0097284317016602, 0.5680198669433594, -0.0377655029296875, 0.6986618041992188, -1.6007452011108398, 1.0887339115142822, -0.5852212905883789, -0.10709953308105469, 2.9470863342285156, -0.8227050304412842, 1.8626174926757812, 0.3578147888183594, 0.6387176513671875, 3.6585187911987305, -1.3467607498168945, 0.555262565612793, -0.8548526763916016, 0.65380859375, 3.059830665588379, 7.764242172241211, 0.7185230255126953, 0.48196983337402344, 0.8901886940002441, 1.0484485626220703, 1.474088430404663, 2.6838369369506836], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3576.0, "diff_num_grad_updates_vs_sampler_policy": 3575.0}}, "num_env_steps_sampled": 26026, "num_env_steps_trained": 114432, "num_agent_steps_sampled": 26026, "num_agent_steps_trained": 114432, "last_target_update_ts": 25697, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 61.42366666666668, "episode_reward_min": 12.66833333333333, "episode_reward_mean": 26.166453333333326, "episode_len_mean": 47.53, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333], "episode_lengths": [63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.925169690246327, "mean_inference_ms": 3.3437626653651775, "mean_action_processing_ms": 0.5096115539429448, "mean_env_wait_ms": 0.13833490206533142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00980377197265625, "StateBufferConnector_ms": 0.021392345428466797, "ViewRequirementAgentConnector_ms": 0.43062329292297363}}, "episode_reward_max": 61.42366666666668, "episode_reward_min": 12.66833333333333, "episode_reward_mean": 26.166453333333326, "episode_len_mean": 47.53, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.117666666666665, 26.198666666666654, 54.52966666666671, 19.371666666666663, 30.501333333333324, 39.83699999999999, 21.65733333333332, 20.85433333333332, 25.380666666666666, 12.66833333333333, 35.71766666666668, 17.776333333333326, 17.827999999999992, 19.483999999999998, 13.944333333333331, 32.37566666666667, 45.220666666666666, 15.51533333333333, 47.41100000000003, 42.42266666666668, 30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333], "episode_lengths": [63, 43, 86, 40, 53, 68, 44, 41, 49, 27, 58, 34, 29, 35, 26, 56, 69, 32, 72, 75, 49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.925169690246327, "mean_inference_ms": 3.3437626653651775, "mean_action_processing_ms": 0.5096115539429448, "mean_env_wait_ms": 0.13833490206533142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00980377197265625, "StateBufferConnector_ms": 0.021392345428466797, "ViewRequirementAgentConnector_ms": 0.43062329292297363}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26026, "num_agent_steps_trained": 114432, "num_env_steps_sampled": 26026, "num_env_steps_trained": 114432, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 85.80087963052371, "num_env_steps_trained_throughput_per_sec": 392.2325925966798, "timesteps_total": 26026, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 26026, "timers": {"training_iteration_time_ms": 79.087, "sample_time_ms": 29.054, "load_time_ms": 0.1, "load_throughput": 319489.95, "learn_time_ms": 6.822, "learn_throughput": 4690.828, "synch_weights_time_ms": 19.251}, "counters": {"num_env_steps_sampled": 26026, "num_env_steps_trained": 114432, "num_agent_steps_sampled": 26026, "num_agent_steps_trained": 114432, "last_target_update_ts": 25697, "num_target_updates": 50}, "done": false, "episodes_total": 835, "training_iteration": 26, "trial_id": "408f7_00000", "date": "2023-12-07_23-50-22", "timestamp": 1702021822, "time_this_iter_s": 11.684639692306519, "time_total_s": 425.6247909069061, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 425.6247909069061, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 71.3125, "ram_util_percent": 90.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.356805801391602, "min_q": 0.8970182538032532, "max_q": 21.442710876464844, "mean_td_error": -0.3201026916503906, "model": {}}, "td_error": [-3.956568717956543, 0.0007915496826171875, -1.3549880981445312, -3.465146064758301, 0.2302093505859375, 2.18880558013916, 0.533092737197876, -1.3745017051696777, 0.9282684326171875, 2.3647193908691406, -1.137735366821289, -0.1608428955078125, -0.24662208557128906, 0.07700729370117188, -0.6386222839355469, -0.8918113708496094, -0.5418701171875, -1.6441822052001953, -1.3829221725463867, 0.2964968681335449, 1.070857048034668, -1.1671440601348877, -0.32021236419677734, -0.8370208740234375, -0.8959856033325195, -0.7685356140136719, -0.6319942474365234, 4.108953475952148, -1.5982437133789062, -0.569854736328125, 2.0370140075683594, -0.49469757080078125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3719.0, "diff_num_grad_updates_vs_sampler_policy": 3718.0}}, "num_env_steps_sampled": 27027, "num_env_steps_trained": 119008, "num_agent_steps_sampled": 27027, "num_agent_steps_trained": 119008, "last_target_update_ts": 26705, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": 61.42366666666668, "episode_reward_min": 13.266666666666659, "episode_reward_mean": 26.006946666666664, "episode_len_mean": 47.45, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999], "episode_lengths": [49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.918012976101096, "mean_inference_ms": 3.347793989322183, "mean_action_processing_ms": 0.5125125082144354, "mean_env_wait_ms": 0.13801457165720213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00897669792175293, "StateBufferConnector_ms": 0.02490997314453125, "ViewRequirementAgentConnector_ms": 0.431621789932251}}, "episode_reward_max": 61.42366666666668, "episode_reward_min": 13.266666666666659, "episode_reward_mean": 26.006946666666664, "episode_len_mean": 47.45, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.657999999999987, 28.207333333333324, 18.666666666666657, 47.95833333333333, 26.911666666666676, 18.820333333333327, 28.324666666666666, 16.881666666666653, 16.557333333333325, 18.824666666666662, 30.745666666666647, 61.42366666666668, 14.394333333333332, 18.975666666666662, 18.21733333333333, 19.875333333333334, 24.08933333333334, 34.63966666666666, 38.22399999999999, 27.34033333333332, 14.997999999999994, 13.266666666666659, 13.98433333333333, 19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999], "episode_lengths": [49, 53, 37, 78, 52, 34, 49, 32, 33, 35, 58, 94, 28, 40, 33, 35, 49, 58, 78, 53, 29, 27, 26, 41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.918012976101096, "mean_inference_ms": 3.347793989322183, "mean_action_processing_ms": 0.5125125082144354, "mean_env_wait_ms": 0.13801457165720213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00897669792175293, "StateBufferConnector_ms": 0.02490997314453125, "ViewRequirementAgentConnector_ms": 0.431621789932251}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27027, "num_agent_steps_trained": 119008, "num_env_steps_sampled": 27027, "num_env_steps_trained": 119008, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 86.57934636846048, "num_env_steps_trained_throughput_per_sec": 395.79129768439077, "timesteps_total": 27027, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 27027, "timers": {"training_iteration_time_ms": 90.524, "sample_time_ms": 32.549, "load_time_ms": 0.704, "load_throughput": 45435.927, "learn_time_ms": 7.243, "learn_throughput": 4417.833, "synch_weights_time_ms": 22.425}, "counters": {"num_env_steps_sampled": 27027, "num_env_steps_trained": 119008, "num_agent_steps_sampled": 27027, "num_agent_steps_trained": 119008, "last_target_update_ts": 26705, "num_target_updates": 52}, "done": false, "episodes_total": 855, "training_iteration": 27, "trial_id": "408f7_00000", "date": "2023-12-07_23-50-34", "timestamp": 1702021834, "time_this_iter_s": 11.577783584594727, "time_total_s": 437.20257449150085, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 437.20257449150085, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 71.675, "ram_util_percent": 90.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.69589900970459, "min_q": 1.4332143068313599, "max_q": 23.092533111572266, "mean_td_error": 1.1805145740509033, "model": {}}, "td_error": [1.2180137634277344, 3.0436973571777344, -0.044403076171875, 0.3826751708984375, 0.15944671630859375, 0.20493316650390625, 1.1763114929199219, 2.090686798095703, -0.8760566711425781, 0.9389686584472656, 2.4661502838134766, 0.48388099670410156, 0.7151861190795898, 0.5423679351806641, 1.2070121765136719, 0.17165470123291016, -0.2718181610107422, 1.657745361328125, 0.33321189880371094, 1.3188467025756836, 3.3047332763671875, 2.9482669830322266, 0.249725341796875, 0.11134910583496094, 3.3764476776123047, 1.007370948791504, 0.0874786376953125, 3.2773008346557617, 3.4949283599853516, 4.303495407104492, 0.33548545837402344, -1.6386289596557617], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3862.0, "diff_num_grad_updates_vs_sampler_policy": 3861.0}}, "num_env_steps_sampled": 28028, "num_env_steps_trained": 123584, "num_agent_steps_sampled": 28028, "num_agent_steps_trained": 123584, "last_target_update_ts": 27713, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 53.485000000000035, "episode_reward_min": 13.327666666666666, "episode_reward_mean": 25.972176666666655, "episode_len_mean": 47.45, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673], "episode_lengths": [41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.906673230646374, "mean_inference_ms": 3.3480700646831583, "mean_action_processing_ms": 0.5156581848072558, "mean_env_wait_ms": 0.13793041666727726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010960102081298828, "StateBufferConnector_ms": 0.01011347770690918, "ViewRequirementAgentConnector_ms": 0.39955973625183105}}, "episode_reward_max": 53.485000000000035, "episode_reward_min": 13.327666666666666, "episode_reward_mean": 25.972176666666655, "episode_len_mean": 47.45, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.052666666666664, 35.86199999999999, 26.061333333333323, 19.869999999999997, 14.483333333333329, 24.976999999999986, 17.872333333333327, 49.301, 18.706666666666667, 19.410666666666657, 25.554999999999996, 18.347666666666672, 25.905666666666658, 15.954666666666661, 28.888999999999985, 34.660333333333305, 16.487666666666662, 19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673], "episode_lengths": [41, 62, 49, 41, 27, 42, 36, 80, 35, 35, 48, 41, 44, 31, 57, 60, 36, 42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.906673230646374, "mean_inference_ms": 3.3480700646831583, "mean_action_processing_ms": 0.5156581848072558, "mean_env_wait_ms": 0.13793041666727726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010960102081298828, "StateBufferConnector_ms": 0.01011347770690918, "ViewRequirementAgentConnector_ms": 0.39955973625183105}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28028, "num_agent_steps_trained": 123584, "num_env_steps_sampled": 28028, "num_env_steps_trained": 123584, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 87.46398614491571, "num_env_steps_trained_throughput_per_sec": 399.83536523390035, "timesteps_total": 28028, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 28028, "timers": {"training_iteration_time_ms": 82.474, "sample_time_ms": 31.099, "load_time_ms": 0.363, "load_throughput": 88167.725, "learn_time_ms": 5.937, "learn_throughput": 5390.227, "synch_weights_time_ms": 19.179}, "counters": {"num_env_steps_sampled": 28028, "num_env_steps_trained": 123584, "num_agent_steps_sampled": 28028, "num_agent_steps_trained": 123584, "last_target_update_ts": 27713, "num_target_updates": 54}, "done": false, "episodes_total": 878, "training_iteration": 28, "trial_id": "408f7_00000", "date": "2023-12-07_23-50-46", "timestamp": 1702021846, "time_this_iter_s": 11.462823629379272, "time_total_s": 448.6653981208801, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 448.6653981208801, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 71.4625, "ram_util_percent": 91.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.644867897033691, "min_q": 2.726803779602051, "max_q": 21.85304069519043, "mean_td_error": 0.037490248680114746, "model": {}}, "td_error": [3.7662250995635986, -0.0178680419921875, -0.2613372802734375, -0.5233440399169922, -2.4922304153442383, -1.1903724670410156, -0.9969310760498047, -0.5122280120849609, -0.3732118606567383, -2.528855323791504, 1.2060613632202148, -0.25979042053222656, 0.004080295562744141, 3.154146194458008, -1.3677172660827637, 2.526002883911133, -1.3251409530639648, 0.6675682067871094, 0.04671287536621094, 2.3505287170410156, -0.6601486206054688, -0.5050692558288574, -0.7711734771728516, -0.25177001953125, -0.5135107040405273, -0.3188667297363281, 1.2655372619628906, -0.8440589904785156, 1.2463304996490479, -0.21904754638671875, -0.3744058609008789, 1.2735729217529297], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4005.0, "diff_num_grad_updates_vs_sampler_policy": 4004.0}}, "num_env_steps_sampled": 29029, "num_env_steps_trained": 128160, "num_agent_steps_sampled": 29029, "num_agent_steps_trained": 128160, "last_target_update_ts": 28721, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 66.58366666666673, "episode_reward_min": 13.327666666666666, "episode_reward_mean": 27.026366666666657, "episode_len_mean": 48.77, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667], "episode_lengths": [42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9002324965926, "mean_inference_ms": 3.384960904563808, "mean_action_processing_ms": 0.5191557183816817, "mean_env_wait_ms": 0.13747113528575997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009055137634277344, "StateBufferConnector_ms": 0.007634878158569336, "ViewRequirementAgentConnector_ms": 0.3799581527709961}}, "episode_reward_max": 66.58366666666673, "episode_reward_min": 13.327666666666666, "episode_reward_mean": 27.026366666666657, "episode_len_mean": 48.77, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.09433333333333, 26.24366666666666, 17.447333333333333, 17.335666666666672, 23.77333333333333, 17.88266666666667, 23.48199999999998, 17.814666666666664, 27.35366666666666, 25.678999999999988, 18.78299999999999, 30.175999999999984, 51.20933333333334, 27.903999999999986, 23.848333333333326, 20.395333333333326, 38.31233333333332, 14.234666666666659, 29.420333333333314, 23.577666666666648, 33.527666666666654, 53.485000000000035, 16.822666666666663, 29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667], "episode_lengths": [42, 51, 33, 36, 37, 38, 49, 37, 50, 48, 37, 53, 91, 56, 43, 37, 66, 26, 58, 48, 60, 85, 32, 52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9002324965926, "mean_inference_ms": 3.384960904563808, "mean_action_processing_ms": 0.5191557183816817, "mean_env_wait_ms": 0.13747113528575997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009055137634277344, "StateBufferConnector_ms": 0.007634878158569336, "ViewRequirementAgentConnector_ms": 0.3799581527709961}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29029, "num_agent_steps_trained": 128160, "num_env_steps_sampled": 29029, "num_env_steps_trained": 128160, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 85.26278176634418, "num_env_steps_trained_throughput_per_sec": 389.77271664614483, "timesteps_total": 29029, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 29029, "timers": {"training_iteration_time_ms": 80.485, "sample_time_ms": 28.52, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 6.662, "learn_throughput": 4803.681, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 29029, "num_env_steps_trained": 128160, "num_agent_steps_sampled": 29029, "num_agent_steps_trained": 128160, "last_target_update_ts": 28721, "num_target_updates": 56}, "done": false, "episodes_total": 895, "training_iteration": 29, "trial_id": "408f7_00000", "date": "2023-12-07_23-50-57", "timestamp": 1702021857, "time_this_iter_s": 11.763096809387207, "time_total_s": 460.42849493026733, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 460.42849493026733, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 70.54117647058824, "ram_util_percent": 91.48823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.822935104370117, "min_q": 1.7514617443084717, "max_q": 24.692962646484375, "mean_td_error": 0.19824667274951935, "model": {}}, "td_error": [0.5963058471679688, 3.6804637908935547, -0.3540611267089844, -1.297891616821289, 1.0434722900390625, 0.09880447387695312, 3.3132686614990234, -0.6969413757324219, -1.1678829193115234, 0.8007950782775879, -2.103708267211914, -0.8795900344848633, 0.7663283348083496, 0.15479278564453125, 3.947319984436035, -0.09165477752685547, -1.7062129974365234, -0.22055625915527344, 2.3066482543945312, -2.518749237060547, 2.9614734649658203, -1.176863670349121, -1.8846855163574219, 0.6302585601806641, -2.290468215942383, -0.046352386474609375, 2.1935863494873047, -0.14389991760253906, -1.45880126953125, 1.324343204498291, -0.27127647399902344, 0.8356285095214844], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4148.0, "diff_num_grad_updates_vs_sampler_policy": 4147.0}}, "num_env_steps_sampled": 30030, "num_env_steps_trained": 132736, "num_agent_steps_sampled": 30030, "num_agent_steps_trained": 132736, "last_target_update_ts": 29729, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": 66.58366666666673, "episode_reward_min": 13.327666666666666, "episode_reward_mean": 26.77179666666666, "episode_len_mean": 48.35, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326], "episode_lengths": [52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.888924390511583, "mean_inference_ms": 3.3569638686180756, "mean_action_processing_ms": 0.519520257105643, "mean_env_wait_ms": 0.13709969566477062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014814615249633789, "StateBufferConnector_ms": 0.009220361709594727, "ViewRequirementAgentConnector_ms": 0.430741548538208}}, "episode_reward_max": 66.58366666666673, "episode_reward_min": 13.327666666666666, "episode_reward_mean": 26.77179666666666, "episode_len_mean": 48.35, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.283333333333335, 18.121, 33.928333333333335, 13.327666666666666, 45.65366666666668, 26.424333333333326, 23.91399999999999, 19.58933333333333, 19.01733333333333, 35.33233333333332, 26.87499999999999, 39.48433333333335, 24.598666666666677, 19.79466666666666, 17.282666666666664, 26.100333333333328, 32.92133333333333, 30.40266666666665, 19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326], "episode_lengths": [52, 36, 60, 26, 77, 46, 49, 36, 39, 58, 50, 69, 45, 34, 31, 50, 57, 55, 39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.888924390511583, "mean_inference_ms": 3.3569638686180756, "mean_action_processing_ms": 0.519520257105643, "mean_env_wait_ms": 0.13709969566477062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014814615249633789, "StateBufferConnector_ms": 0.009220361709594727, "ViewRequirementAgentConnector_ms": 0.430741548538208}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30030, "num_agent_steps_trained": 132736, "num_env_steps_sampled": 30030, "num_env_steps_trained": 132736, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 83.8618329553507, "num_env_steps_trained_throughput_per_sec": 383.3683792244604, "timesteps_total": 30030, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 30030, "timers": {"training_iteration_time_ms": 77.903, "sample_time_ms": 27.721, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 7.886, "learn_throughput": 4057.92, "synch_weights_time_ms": 19.623}, "counters": {"num_env_steps_sampled": 30030, "num_env_steps_trained": 132736, "num_agent_steps_sampled": 30030, "num_agent_steps_trained": 132736, "last_target_update_ts": 29729, "num_target_updates": 58}, "done": false, "episodes_total": 918, "training_iteration": 30, "trial_id": "408f7_00000", "date": "2023-12-07_23-51-10", "timestamp": 1702021870, "time_this_iter_s": 11.955569505691528, "time_total_s": 472.38406443595886, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 472.38406443595886, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 70.38125, "ram_util_percent": 92.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.83021068572998, "min_q": 1.6669460535049438, "max_q": 23.598535537719727, "mean_td_error": 0.5383616089820862, "model": {}}, "td_error": [-2.9194021224975586, 2.134117603302002, 0.21721649169921875, 2.191248893737793, 0.08397102355957031, -1.9628639221191406, 0.6310405731201172, 2.7583961486816406, 2.1405086517333984, 0.8017616271972656, 0.8557777404785156, 2.4494380950927734, 2.892667770385742, 2.617229461669922, -0.4704122543334961, 3.1624183654785156, -0.8781414031982422, -0.503199577331543, 2.082456588745117, 0.6143896579742432, -1.4203453063964844, 5.5857086181640625, -0.13844966888427734, -1.0989627838134766, 0.04751396179199219, 1.583017110824585, -1.359602451324463, -2.1706666946411133, -1.727388858795166, 0.23618698120117188, 0.6636127233505249, -1.8716707229614258], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4291.0, "diff_num_grad_updates_vs_sampler_policy": 4290.0}}, "num_env_steps_sampled": 31031, "num_env_steps_trained": 137312, "num_agent_steps_sampled": 31031, "num_agent_steps_trained": 137312, "last_target_update_ts": 30737, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": 66.58366666666673, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 26.881279999999993, "episode_len_mean": 48.93, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316], "episode_lengths": [39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8844765178199427, "mean_inference_ms": 3.350464501448378, "mean_action_processing_ms": 0.5218007762781821, "mean_env_wait_ms": 0.13682606586974777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015638113021850586, "StateBufferConnector_ms": 0.01009368896484375, "ViewRequirementAgentConnector_ms": 0.4128272533416748}}, "episode_reward_max": 66.58366666666673, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 26.881279999999993, "episode_len_mean": 48.93, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.48399999999999, 29.94799999999998, 32.02400000000001, 33.79199999999998, 25.590333333333326, 16.960999999999995, 21.15833333333333, 34.40066666666666, 24.222999999999995, 20.690333333333324, 52.87966666666668, 36.29599999999999, 23.539666666666673, 20.28633333333333, 50.273666666666685, 16.307333333333325, 24.919333333333324, 17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316], "episode_lengths": [39, 53, 53, 59, 42, 30, 42, 61, 50, 38, 79, 61, 46, 39, 78, 33, 51, 32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8844765178199427, "mean_inference_ms": 3.350464501448378, "mean_action_processing_ms": 0.5218007762781821, "mean_env_wait_ms": 0.13682606586974777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015638113021850586, "StateBufferConnector_ms": 0.01009368896484375, "ViewRequirementAgentConnector_ms": 0.4128272533416748}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31031, "num_agent_steps_trained": 137312, "num_env_steps_sampled": 31031, "num_env_steps_trained": 137312, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 61.8159640317959, "num_env_steps_trained_throughput_per_sec": 282.58726414535266, "timesteps_total": 31031, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 31031, "timers": {"training_iteration_time_ms": 180.397, "sample_time_ms": 51.842, "load_time_ms": 0.788, "load_throughput": 40609.279, "learn_time_ms": 7.38, "learn_throughput": 4335.926, "synch_weights_time_ms": 70.605}, "counters": {"num_env_steps_sampled": 31031, "num_env_steps_trained": 137312, "num_agent_steps_sampled": 31031, "num_agent_steps_trained": 137312, "last_target_update_ts": 30737, "num_target_updates": 60}, "done": false, "episodes_total": 936, "training_iteration": 31, "trial_id": "408f7_00000", "date": "2023-12-07_23-51-26", "timestamp": 1702021886, "time_this_iter_s": 16.223487615585327, "time_total_s": 488.6075520515442, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 488.6075520515442, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 87.56956521739129, "ram_util_percent": 92.46956521739129}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.422096252441406, "min_q": 1.1447596549987793, "max_q": 23.606294631958008, "mean_td_error": -0.5733160972595215, "model": {}}, "td_error": [0.9266705513000488, -0.25655412673950195, -0.7190361022949219, -1.4801502227783203, 0.20911073684692383, -1.1424427032470703, 2.937511444091797, -0.3855915069580078, 2.4055004119873047, -1.8240923881530762, -3.0523667335510254, -0.7131919860839844, -0.22008895874023438, 0.04723930358886719, -1.4113833904266357, -0.09165000915527344, 0.38778018951416016, -0.41854000091552734, 1.2003254890441895, -2.8684120178222656, 0.24309301376342773, 1.6226930618286133, 0.6360969543457031, -0.27426624298095703, -1.2906675338745117, -3.748167037963867, -0.46595191955566406, -3.3779468536376953, 0.5395731925964355, -3.817037582397461, -0.671881914138794, -1.2722911834716797], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4434.0, "diff_num_grad_updates_vs_sampler_policy": 4433.0}}, "num_env_steps_sampled": 32032, "num_env_steps_trained": 141888, "num_agent_steps_sampled": 32032, "num_agent_steps_trained": 141888, "last_target_update_ts": 31745, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": 66.58366666666673, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 27.52823666666667, "episode_len_mean": 50.35, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003], "episode_lengths": [32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.879372069104934, "mean_inference_ms": 3.3481501075958, "mean_action_processing_ms": 0.5212060026290567, "mean_env_wait_ms": 0.13643882925401551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021237850189208984, "StateBufferConnector_ms": 0.007518291473388672, "ViewRequirementAgentConnector_ms": 0.39518046379089355}}, "episode_reward_max": 66.58366666666673, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 27.52823666666667, "episode_len_mean": 50.35, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.66233333333333, 27.02299999999999, 19.95499999999999, 19.269666666666662, 19.627333333333336, 17.543666666666656, 38.93366666666668, 28.82499999999998, 34.96133333333331, 33.278666666666645, 16.881333333333327, 15.753666666666657, 21.654666666666664, 19.143666666666665, 17.041666666666657, 40.57500000000001, 20.05799999999999, 19.116333333333326, 28.49833333333333, 33.885, 26.99399999999999, 17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003], "episode_lengths": [32, 51, 40, 34, 41, 37, 62, 54, 53, 53, 33, 32, 43, 36, 33, 77, 39, 34, 53, 54, 51, 35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.879372069104934, "mean_inference_ms": 3.3481501075958, "mean_action_processing_ms": 0.5212060026290567, "mean_env_wait_ms": 0.13643882925401551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021237850189208984, "StateBufferConnector_ms": 0.007518291473388672, "ViewRequirementAgentConnector_ms": 0.39518046379089355}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32032, "num_agent_steps_trained": 141888, "num_env_steps_sampled": 32032, "num_env_steps_trained": 141888, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 47.67385397760037, "num_env_steps_trained_throughput_per_sec": 217.937618183316, "timesteps_total": 32032, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 32032, "timers": {"training_iteration_time_ms": 214.848, "sample_time_ms": 49.791, "load_time_ms": 0.597, "load_throughput": 53584.21, "learn_time_ms": 6.973, "learn_throughput": 4589.268, "synch_weights_time_ms": 22.147}, "counters": {"num_env_steps_sampled": 32032, "num_env_steps_trained": 141888, "num_agent_steps_sampled": 32032, "num_agent_steps_trained": 141888, "last_target_update_ts": 31745, "num_target_updates": 62}, "done": false, "episodes_total": 953, "training_iteration": 32, "trial_id": "408f7_00000", "date": "2023-12-07_23-52-00", "timestamp": 1702021920, "time_this_iter_s": 34.44401240348816, "time_total_s": 523.0515644550323, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 523.0515644550323, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 91.49130434782607, "ram_util_percent": 95.17391304347824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.458939552307129, "min_q": 1.757553219795227, "max_q": 23.546749114990234, "mean_td_error": -0.2159707248210907, "model": {}}, "td_error": [-1.848325252532959, 0.9355125427246094, 3.9911327362060547, -3.104452133178711, -0.415771484375, -0.7119941711425781, -1.7357902526855469, 0.8436808586120605, -1.840263843536377, 3.2077512741088867, 2.4109392166137695, -0.3151130676269531, 3.0529232025146484, 0.39932823181152344, -1.6394119262695312, -0.37746238708496094, 0.15574073791503906, 2.5903778076171875, 1.6145601272583008, -0.45137977600097656, -2.4766411781311035, -1.1411056518554688, -3.0826759338378906, -1.08636474609375, -0.11475729942321777, 0.7945532202720642, -2.3036632537841797, -1.4802894592285156, -1.8889503479003906, -3.246792793273926, -1.0866661071777344, 3.4403076171875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4577.0, "diff_num_grad_updates_vs_sampler_policy": 4576.0}}, "num_env_steps_sampled": 33033, "num_env_steps_trained": 146464, "num_agent_steps_sampled": 33033, "num_agent_steps_trained": 146464, "last_target_update_ts": 32753, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": 66.58366666666673, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 27.724930000000004, "episode_len_mean": 51.06, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998], "episode_lengths": [35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.882157458736742, "mean_inference_ms": 3.3217508935192743, "mean_action_processing_ms": 0.5191774762112956, "mean_env_wait_ms": 0.1362962846064902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02192068099975586, "StateBufferConnector_ms": 0.007803678512573242, "ViewRequirementAgentConnector_ms": 0.4311838150024414}}, "episode_reward_max": 66.58366666666673, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 27.724930000000004, "episode_len_mean": 51.06, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.21466666666666, 45.21366666666667, 21.679999999999996, 22.403666666666673, 37.04133333333333, 23.944999999999993, 18.714333333333325, 23.886999999999986, 31.179666666666662, 18.588333333333335, 35.17166666666666, 14.97333333333333, 66.58366666666673, 22.592666666666666, 31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998], "episode_lengths": [35, 78, 42, 46, 64, 40, 40, 43, 58, 36, 54, 27, 99, 41, 60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.882157458736742, "mean_inference_ms": 3.3217508935192743, "mean_action_processing_ms": 0.5191774762112956, "mean_env_wait_ms": 0.1362962846064902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02192068099975586, "StateBufferConnector_ms": 0.007803678512573242, "ViewRequirementAgentConnector_ms": 0.4311838150024414}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33033, "num_agent_steps_trained": 146464, "num_env_steps_sampled": 33033, "num_env_steps_trained": 146464, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 68.70074467153798, "num_env_steps_trained_throughput_per_sec": 314.06054706988795, "timesteps_total": 33033, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 33033, "timers": {"training_iteration_time_ms": 114.791, "sample_time_ms": 33.295, "load_time_ms": 0.126, "load_throughput": 254248.396, "learn_time_ms": 6.65, "learn_throughput": 4811.706, "synch_weights_time_ms": 50.491}, "counters": {"num_env_steps_sampled": 33033, "num_env_steps_trained": 146464, "num_agent_steps_sampled": 33033, "num_agent_steps_trained": 146464, "last_target_update_ts": 32753, "num_target_updates": 64}, "done": false, "episodes_total": 974, "training_iteration": 33, "trial_id": "408f7_00000", "date": "2023-12-07_23-52-15", "timestamp": 1702021935, "time_this_iter_s": 14.589159727096558, "time_total_s": 537.6407241821289, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 537.6407241821289, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 76.68999999999998, "ram_util_percent": 96.015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.33470344543457, "min_q": 2.792588710784912, "max_q": 23.49703025817871, "mean_td_error": 0.054170526564121246, "model": {}}, "td_error": [3.7966060638427734, -0.7379465103149414, 0.7400045394897461, 1.696014404296875, 0.053943634033203125, -1.2681732177734375, 1.7759017944335938, 0.0792083740234375, -2.093128204345703, 0.9952373504638672, -0.3554878234863281, -1.373077392578125, 4.390420913696289, -2.953415870666504, -0.2885265350341797, -1.1232643127441406, -2.3098621368408203, -0.8017177581787109, 0.3076171875, 0.27986955642700195, -1.7538414001464844, 0.19707489013671875, -0.5630245208740234, -1.8331012725830078, -0.8795139789581299, -1.0113849639892578, -0.4233255386352539, 2.6053714752197266, -0.7193164825439453, 2.543275833129883, 0.041390419006347656, 2.71962833404541], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4720.0, "diff_num_grad_updates_vs_sampler_policy": 4719.0}}, "num_env_steps_sampled": 34034, "num_env_steps_trained": 151040, "num_agent_steps_sampled": 34034, "num_agent_steps_trained": 151040, "last_target_update_ts": 33761, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": 64.42300000000002, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 28.03936333333333, "episode_len_mean": 52.33, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333], "episode_lengths": [60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8815316010826124, "mean_inference_ms": 3.312170117735457, "mean_action_processing_ms": 0.5217126469157849, "mean_env_wait_ms": 0.1361917568263638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029032230377197266, "StateBufferConnector_ms": 0.00980377197265625, "ViewRequirementAgentConnector_ms": 0.43990635871887207}}, "episode_reward_max": 64.42300000000002, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 28.03936333333333, "episode_len_mean": 52.33, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.204999999999984, 41.478333333333296, 18.416, 33.59666666666664, 18.988666666666663, 34.85666666666667, 45.59766666666667, 29.53133333333334, 16.144333333333332, 20.18499999999999, 16.557, 31.52700000000001, 31.540666666666677, 16.086333333333332, 26.70033333333333, 32.07499999999998, 18.647000000000002, 42.549, 17.734666666666662, 32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333], "episode_lengths": [60, 67, 35, 63, 35, 59, 76, 59, 36, 37, 34, 54, 53, 34, 53, 53, 39, 67, 36, 54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8815316010826124, "mean_inference_ms": 3.312170117735457, "mean_action_processing_ms": 0.5217126469157849, "mean_env_wait_ms": 0.1361917568263638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029032230377197266, "StateBufferConnector_ms": 0.00980377197265625, "ViewRequirementAgentConnector_ms": 0.43990635871887207}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34034, "num_agent_steps_trained": 151040, "num_env_steps_sampled": 34034, "num_env_steps_trained": 151040, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 79.75290369260748, "num_env_steps_trained_throughput_per_sec": 364.584702594777, "timesteps_total": 34034, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 34034, "timers": {"training_iteration_time_ms": 79.393, "sample_time_ms": 30.71, "load_time_ms": 0.22, "load_throughput": 145588.164, "learn_time_ms": 5.691, "learn_throughput": 5622.486, "synch_weights_time_ms": 18.49}, "counters": {"num_env_steps_sampled": 34034, "num_env_steps_trained": 151040, "num_agent_steps_sampled": 34034, "num_agent_steps_trained": 151040, "last_target_update_ts": 33761, "num_target_updates": 66}, "done": false, "episodes_total": 988, "training_iteration": 34, "trial_id": "408f7_00000", "date": "2023-12-07_23-52-28", "timestamp": 1702021948, "time_this_iter_s": 12.570319890975952, "time_total_s": 550.2110440731049, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 550.2110440731049, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 73.22777777777777, "ram_util_percent": 95.3722222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.804597854614258, "min_q": 3.369443893432617, "max_q": 23.329532623291016, "mean_td_error": -0.31095871329307556, "model": {}}, "td_error": [-4.049771308898926, 0.5812821388244629, 0.7053318023681641, 0.4019927978515625, -0.5047755241394043, 0.14611482620239258, 2.1465988159179688, -1.2708892822265625, -0.45165061950683594, -1.6714553833007812, -2.182750701904297, 2.2796802520751953, -0.07368087768554688, 0.8792457580566406, -0.7431602478027344, -2.7469282150268555, 2.2291698455810547, -1.496861457824707, 0.7449026107788086, 2.7714624404907227, 0.4046149253845215, 1.3614444732666016, -0.91851806640625, 1.4105110168457031, -1.3597259521484375, 0.7746090888977051, -1.8352766036987305, -2.0122127532958984, 0.4095878601074219, -1.187678337097168, -1.5468268394470215, -3.1450653076171875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4863.0, "diff_num_grad_updates_vs_sampler_policy": 4862.0}}, "num_env_steps_sampled": 35035, "num_env_steps_trained": 155616, "num_agent_steps_sampled": 35035, "num_agent_steps_trained": 155616, "last_target_update_ts": 34769, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": 64.42300000000002, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 28.862043333333325, "episode_len_mean": 54.77, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995], "episode_lengths": [54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8827258963248323, "mean_inference_ms": 3.296389569568562, "mean_action_processing_ms": 0.5213442909815178, "mean_env_wait_ms": 0.13596838754961035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030892133712768555, "StateBufferConnector_ms": 0.017107725143432617, "ViewRequirementAgentConnector_ms": 0.43116188049316406}}, "episode_reward_max": 64.42300000000002, "episode_reward_min": 13.396333333333333, "episode_reward_mean": 28.862043333333325, "episode_len_mean": 54.77, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.50966666666666, 21.467000000000006, 23.384333333333338, 25.12833333333332, 30.150000000000002, 47.7096666666667, 16.76033333333333, 13.396333333333333, 17.491, 27.29500000000001, 17.776333333333326, 23.156333333333336, 25.376, 31.970666666666673, 24.152666666666672, 23.525333333333336, 21.063333333333325, 47.11966666666671, 27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995], "episode_lengths": [54, 38, 52, 50, 55, 82, 32, 26, 36, 55, 36, 44, 51, 62, 51, 47, 47, 76, 53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8827258963248323, "mean_inference_ms": 3.296389569568562, "mean_action_processing_ms": 0.5213442909815178, "mean_env_wait_ms": 0.13596838754961035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030892133712768555, "StateBufferConnector_ms": 0.017107725143432617, "ViewRequirementAgentConnector_ms": 0.43116188049316406}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35035, "num_agent_steps_trained": 155616, "num_env_steps_sampled": 35035, "num_env_steps_trained": 155616, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 71.33168250159301, "num_env_steps_trained_throughput_per_sec": 326.08769143585374, "timesteps_total": 35035, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 35035, "timers": {"training_iteration_time_ms": 96.895, "sample_time_ms": 35.591, "load_time_ms": 0.511, "load_throughput": 62610.313, "learn_time_ms": 5.518, "learn_throughput": 5799.145, "synch_weights_time_ms": 21.948}, "counters": {"num_env_steps_sampled": 35035, "num_env_steps_trained": 155616, "num_agent_steps_sampled": 35035, "num_agent_steps_trained": 155616, "last_target_update_ts": 34769, "num_target_updates": 68}, "done": false, "episodes_total": 1007, "training_iteration": 35, "trial_id": "408f7_00000", "date": "2023-12-07_23-52-42", "timestamp": 1702021962, "time_this_iter_s": 14.054107189178467, "time_total_s": 564.2651512622833, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 564.2651512622833, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 81.86315789473683, "ram_util_percent": 95.05263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.228959083557129, "min_q": 4.500826835632324, "max_q": 23.431621551513672, "mean_td_error": -0.391124963760376, "model": {}}, "td_error": [0.7226700782775879, -1.3346004486083984, 2.573984146118164, 1.4340810775756836, 1.585972785949707, -1.1497840881347656, -0.298187255859375, -0.5892906188964844, -0.7095565795898438, -3.395355224609375, 0.35334014892578125, -0.17203807830810547, -1.4728479385375977, -2.0952987670898438, -2.2534732818603516, -0.2696533203125, 3.57582688331604, -0.4530982971191406, -1.3709449768066406, 0.5570945739746094, -1.903097152709961, 0.07986259460449219, 0.20621109008789062, -1.8908882141113281, 1.0635223388671875, -0.26357078552246094, 0.7696633338928223, -0.7533054351806641, -2.172191619873047, -0.45235633850097656, 0.2445535659790039, -2.6832427978515625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5006.0, "diff_num_grad_updates_vs_sampler_policy": 5005.0}}, "num_env_steps_sampled": 36036, "num_env_steps_trained": 160192, "num_agent_steps_sampled": 36036, "num_agent_steps_trained": 160192, "last_target_update_ts": 35777, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": 64.42300000000002, "episode_reward_min": 14.532333333333332, "episode_reward_mean": 29.18540333333333, "episode_len_mean": 55.57, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666], "episode_lengths": [53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8770688680535854, "mean_inference_ms": 3.3163105839873657, "mean_action_processing_ms": 0.5215539979746313, "mean_env_wait_ms": 0.13581656076926243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025354862213134766, "StateBufferConnector_ms": 0.016721010208129883, "ViewRequirementAgentConnector_ms": 0.4269602298736572}}, "episode_reward_max": 64.42300000000002, "episode_reward_min": 14.532333333333332, "episode_reward_mean": 29.18540333333333, "episode_len_mean": 55.57, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.056666666666654, 34.019333333333314, 23.98366666666666, 28.578333333333337, 23.777, 50.112999999999985, 20.006666666666668, 20.06299999999999, 16.71766666666666, 34.96766666666665, 17.352333333333316, 48.072333333333354, 60.18833333333335, 41.59999999999994, 17.579333333333327, 24.042666666666666, 25.004333333333324, 19.28366666666666, 27.863666666666663, 23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666], "episode_lengths": [53, 55, 44, 60, 40, 84, 37, 44, 36, 60, 37, 78, 98, 75, 35, 44, 46, 38, 58, 51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8770688680535854, "mean_inference_ms": 3.3163105839873657, "mean_action_processing_ms": 0.5215539979746313, "mean_env_wait_ms": 0.13581656076926243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025354862213134766, "StateBufferConnector_ms": 0.016721010208129883, "ViewRequirementAgentConnector_ms": 0.4269602298736572}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36036, "num_agent_steps_trained": 160192, "num_env_steps_sampled": 36036, "num_env_steps_trained": 160192, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 76.18577723741532, "num_env_steps_trained_throughput_per_sec": 348.2778387996129, "timesteps_total": 36036, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 36036, "timers": {"training_iteration_time_ms": 87.095, "sample_time_ms": 30.975, "load_time_ms": 0.312, "load_throughput": 102628.634, "learn_time_ms": 5.407, "learn_throughput": 5918.542, "synch_weights_time_ms": 21.843}, "counters": {"num_env_steps_sampled": 36036, "num_env_steps_trained": 160192, "num_agent_steps_sampled": 36036, "num_agent_steps_trained": 160192, "last_target_update_ts": 35777, "num_target_updates": 70}, "done": false, "episodes_total": 1025, "training_iteration": 36, "trial_id": "408f7_00000", "date": "2023-12-07_23-52-55", "timestamp": 1702021975, "time_this_iter_s": 13.163064002990723, "time_total_s": 577.428215265274, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 577.428215265274, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 71.01578947368421, "ram_util_percent": 92.47894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.864971160888672, "min_q": 4.928769588470459, "max_q": 24.135513305664062, "mean_td_error": -0.1884990930557251, "model": {}}, "td_error": [-1.0305166244506836, -0.9234085083007812, -1.9594440460205078, -0.17182111740112305, 0.8456687927246094, 0.6444320678710938, -3.1429290771484375, 1.066549301147461, 0.2728557586669922, -0.6939535140991211, 0.015186309814453125, -1.1731433868408203, -1.3325228691101074, -0.42870330810546875, -1.3915185928344727, 1.2096624374389648, -0.18439292907714844, -0.10803985595703125, 0.6101322174072266, -0.6642742156982422, -1.516836166381836, -0.4351010322570801, 1.1213321685791016, -0.42540693283081055, 0.1546192169189453, 0.9986629486083984, 1.1981182098388672, -0.4536123275756836, 0.2820720672607422, 0.8624916076660156, 1.1354866027832031, -0.4136161804199219], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5149.0, "diff_num_grad_updates_vs_sampler_policy": 5148.0}}, "num_env_steps_sampled": 37037, "num_env_steps_trained": 164768, "num_agent_steps_sampled": 37037, "num_agent_steps_trained": 164768, "last_target_update_ts": 36785, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": 64.42300000000002, "episode_reward_min": 14.532333333333332, "episode_reward_mean": 28.684989999999992, "episode_len_mean": 55.45, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996], "episode_lengths": [51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8745065380031853, "mean_inference_ms": 3.3209929849226913, "mean_action_processing_ms": 0.5215280372672565, "mean_env_wait_ms": 0.13556074934049045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030924558639526367, "StateBufferConnector_ms": 0.017105817794799805, "ViewRequirementAgentConnector_ms": 0.4383120536804199}}, "episode_reward_max": 64.42300000000002, "episode_reward_min": 14.532333333333332, "episode_reward_mean": 28.684989999999992, "episode_len_mean": 55.45, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.874333333333347, 49.179333333333346, 29.162333333333333, 17.16666666666666, 20.48599999999999, 25.158666666666672, 48.972, 44.48466666666667, 25.351000000000003, 24.000999999999994, 48.21499999999998, 64.39866666666664, 14.650333333333325, 14.532333333333332, 21.526666666666667, 16.860666666666667, 41.41900000000002, 23.368333333333332, 20.409333333333333, 19.69666666666666, 27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996], "episode_lengths": [51, 84, 58, 35, 39, 49, 75, 75, 58, 50, 79, 101, 31, 30, 37, 33, 86, 52, 43, 37, 50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8745065380031853, "mean_inference_ms": 3.3209929849226913, "mean_action_processing_ms": 0.5215280372672565, "mean_env_wait_ms": 0.13556074934049045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030924558639526367, "StateBufferConnector_ms": 0.017105817794799805, "ViewRequirementAgentConnector_ms": 0.4383120536804199}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37037, "num_agent_steps_trained": 164768, "num_env_steps_sampled": 37037, "num_env_steps_trained": 164768, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 77.22840512840227, "num_env_steps_trained_throughput_per_sec": 353.044137729839, "timesteps_total": 37037, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 37037, "timers": {"training_iteration_time_ms": 88.805, "sample_time_ms": 32.149, "load_time_ms": 0.16, "load_throughput": 199609.946, "learn_time_ms": 5.896, "learn_throughput": 5427.061, "synch_weights_time_ms": 21.433}, "counters": {"num_env_steps_sampled": 37037, "num_env_steps_trained": 164768, "num_agent_steps_sampled": 37037, "num_agent_steps_trained": 164768, "last_target_update_ts": 36785, "num_target_updates": 72}, "done": false, "episodes_total": 1044, "training_iteration": 37, "trial_id": "408f7_00000", "date": "2023-12-07_23-53-08", "timestamp": 1702021988, "time_this_iter_s": 12.983814239501953, "time_total_s": 590.412029504776, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 590.412029504776, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 70.39444444444445, "ram_util_percent": 93.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.23452377319336, "min_q": 2.2451939582824707, "max_q": 22.875194549560547, "mean_td_error": -0.8570539951324463, "model": {}}, "td_error": [-1.1614189147949219, 0.8050289154052734, -0.26675891876220703, -0.4053993225097656, -1.3803749084472656, -3.162339210510254, -2.9774961471557617, 1.0313196182250977, -0.2781791687011719, 0.056229591369628906, -3.9662303924560547, -0.08740234375, -0.77099609375, 0.266082763671875, -1.2756671905517578, 1.0355949401855469, -0.6921901702880859, -1.1567516326904297, -0.5921945571899414, -0.8079986572265625, -1.856893539428711, -2.8648223876953125, -1.0822157859802246, -1.5804309844970703, 4.040990352630615, -1.3121671676635742, -3.1933507919311523, -0.5834174156188965, 0.5218830108642578, -0.8268241882324219, -0.9700927734375, -1.931243896484375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5292.0, "diff_num_grad_updates_vs_sampler_policy": 5291.0}}, "num_env_steps_sampled": 38038, "num_env_steps_trained": 169344, "num_agent_steps_sampled": 38038, "num_agent_steps_trained": 169344, "last_target_update_ts": 37793, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": 64.97333333333333, "episode_reward_min": 14.311333333333328, "episode_reward_mean": 27.944463333333328, "episode_len_mean": 54.56, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668], "episode_lengths": [50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.875137214749039, "mean_inference_ms": 3.30053851424824, "mean_action_processing_ms": 0.5216540536322511, "mean_env_wait_ms": 0.13493225169784756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02951192855834961, "StateBufferConnector_ms": 0.016018390655517578, "ViewRequirementAgentConnector_ms": 0.4357614517211914}}, "episode_reward_max": 64.97333333333333, "episode_reward_min": 14.311333333333328, "episode_reward_mean": 27.944463333333328, "episode_len_mean": 54.56, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.488333333333323, 39.088333333333324, 18.99133333333333, 17.99366666666667, 27.171999999999986, 17.738999999999994, 16.676999999999996, 21.29966666666666, 22.07233333333333, 18.750999999999998, 39.34833333333331, 31.971000000000004, 20.99333333333333, 64.42300000000002, 30.73, 23.660333333333334, 24.875333333333337, 18.582999999999995, 35.44633333333334, 21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668], "episode_lengths": [50, 70, 39, 30, 45, 35, 32, 42, 46, 45, 70, 66, 43, 100, 68, 48, 45, 45, 63, 45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.875137214749039, "mean_inference_ms": 3.30053851424824, "mean_action_processing_ms": 0.5216540536322511, "mean_env_wait_ms": 0.13493225169784756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02951192855834961, "StateBufferConnector_ms": 0.016018390655517578, "ViewRequirementAgentConnector_ms": 0.4357614517211914}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38038, "num_agent_steps_trained": 169344, "num_env_steps_sampled": 38038, "num_env_steps_trained": 169344, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 72.66716546864595, "num_env_steps_trained_throughput_per_sec": 332.1927564280957, "timesteps_total": 38038, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 38038, "timers": {"training_iteration_time_ms": 88.517, "sample_time_ms": 30.968, "load_time_ms": 0.2, "load_throughput": 160049.759, "learn_time_ms": 5.722, "learn_throughput": 5591.986, "synch_weights_time_ms": 22.596}, "counters": {"num_env_steps_sampled": 38038, "num_env_steps_trained": 169344, "num_agent_steps_sampled": 38038, "num_agent_steps_trained": 169344, "last_target_update_ts": 37793, "num_target_updates": 74}, "done": false, "episodes_total": 1064, "training_iteration": 38, "trial_id": "408f7_00000", "date": "2023-12-07_23-53-22", "timestamp": 1702022002, "time_this_iter_s": 14.029043674468994, "time_total_s": 604.441073179245, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 604.441073179245, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 76.48947368421054, "ram_util_percent": 93.79473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.49798583984375, "min_q": 1.359925389289856, "max_q": 22.942106246948242, "mean_td_error": 0.13690733909606934, "model": {}}, "td_error": [-1.2644773721694946, 5.803691864013672, -1.0597190856933594, -1.6694707870483398, 2.093721389770508, -1.9168891906738281, -0.573918342590332, 0.38187599182128906, 1.936697006225586, 0.9924430847167969, 1.5986995697021484, 0.7074747085571289, -0.10490226745605469, 0.24604415893554688, 1.658193588256836, -1.9902400970458984, 0.050258636474609375, 0.0651397705078125, 0.09477424621582031, -1.6255931854248047, 0.27269649505615234, 2.630281448364258, -1.5443000793457031, 0.0820002555847168, -2.0742292404174805, -1.2317142486572266, -0.32395267486572266, -1.4470014572143555, 1.451064109802246, 0.9393177032470703, 0.28557682037353516, -0.08250808715820312], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5435.0, "diff_num_grad_updates_vs_sampler_policy": 5434.0}}, "num_env_steps_sampled": 39039, "num_env_steps_trained": 173920, "num_agent_steps_sampled": 39039, "num_agent_steps_trained": 173920, "last_target_update_ts": 38801, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": 64.97333333333333, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 27.647959999999998, "episode_len_mean": 54.58, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005], "episode_lengths": [45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8701046450384653, "mean_inference_ms": 3.3105782910068062, "mean_action_processing_ms": 0.5214135816375103, "mean_env_wait_ms": 0.13461970177201676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02619457244873047, "StateBufferConnector_ms": 0.017152786254882812, "ViewRequirementAgentConnector_ms": 0.4333457946777344}}, "episode_reward_max": 64.97333333333333, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 27.647959999999998, "episode_len_mean": 54.58, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.845999999999993, 27.954000000000004, 28.51833333333332, 25.048999999999978, 37.23433333333333, 15.035666666666659, 24.28333333333332, 36.34566666666668, 51.24566666666665, 30.014333333333337, 36.44966666666667, 39.48333333333331, 20.70399999999999, 30.42566666666666, 46.69233333333334, 48.428, 18.41433333333333, 21.090999999999998, 24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005], "episode_lengths": [45, 54, 64, 52, 67, 34, 51, 70, 89, 66, 81, 74, 43, 53, 88, 104, 36, 36, 45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8701046450384653, "mean_inference_ms": 3.3105782910068062, "mean_action_processing_ms": 0.5214135816375103, "mean_env_wait_ms": 0.13461970177201676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02619457244873047, "StateBufferConnector_ms": 0.017152786254882812, "ViewRequirementAgentConnector_ms": 0.4333457946777344}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39039, "num_agent_steps_trained": 173920, "num_env_steps_sampled": 39039, "num_env_steps_trained": 173920, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 69.60676817128646, "num_env_steps_trained_throughput_per_sec": 318.20236878302387, "timesteps_total": 39039, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 39039, "timers": {"training_iteration_time_ms": 118.736, "sample_time_ms": 44.883, "load_time_ms": 0.735, "load_throughput": 43529.133, "learn_time_ms": 6.275, "learn_throughput": 5099.632, "synch_weights_time_ms": 22.841}, "counters": {"num_env_steps_sampled": 39039, "num_env_steps_trained": 173920, "num_agent_steps_sampled": 39039, "num_agent_steps_trained": 173920, "last_target_update_ts": 38801, "num_target_updates": 76}, "done": false, "episodes_total": 1083, "training_iteration": 39, "trial_id": "408f7_00000", "date": "2023-12-07_23-53-37", "timestamp": 1702022017, "time_this_iter_s": 14.405033111572266, "time_total_s": 618.8461062908173, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 618.8461062908173, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 79.58000000000001, "ram_util_percent": 94.73}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.270557403564453, "min_q": 2.843904733657837, "max_q": 21.528759002685547, "mean_td_error": 0.5523214340209961, "model": {}}, "td_error": [-0.07007884979248047, 2.31210994720459, -1.402444839477539, 1.126699447631836, 1.6984376907348633, -0.6351718902587891, -0.7784671783447266, -2.174579620361328, 0.4892463684082031, 0.13045692443847656, 1.8936758041381836, 1.5237712860107422, -1.2403078079223633, -0.8867511749267578, 2.063701629638672, -0.34738636016845703, -0.5948305130004883, 0.07432174682617188, 0.1734466552734375, 5.178238868713379, 1.2745819091796875, 0.36627960205078125, 2.189927101135254, -1.9187049865722656, 1.7384099960327148, -1.4235773086547852, 0.907012939453125, 2.332573890686035, -1.2565250396728516, 0.9745283126831055, 2.0157852172851562, 1.9399046897888184], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5578.0, "diff_num_grad_updates_vs_sampler_policy": 5577.0}}, "num_env_steps_sampled": 40040, "num_env_steps_trained": 178496, "num_agent_steps_sampled": 40040, "num_agent_steps_trained": 178496, "last_target_update_ts": 39809, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 27.295343333333335, "episode_len_mean": 53.54, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333], "episode_lengths": [45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8733016119012733, "mean_inference_ms": 3.299583111272909, "mean_action_processing_ms": 0.5189358704225585, "mean_env_wait_ms": 0.13456880898192883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025481700897216797, "StateBufferConnector_ms": 0.010560274124145508, "ViewRequirementAgentConnector_ms": 0.4294712543487549}}, "episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 27.295343333333335, "episode_len_mean": 53.54, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.215333333333334, 44.413333333333355, 31.656000000000006, 45.489666666666665, 21.33633333333333, 19.960999999999995, 49.24299999999999, 19.45433333333333, 36.174333333333315, 23.671999999999986, 22.231999999999985, 14.56033333333333, 35.97033333333331, 19.911666666666658, 15.989333333333331, 15.673666666666659, 24.63766666666667, 43.76299999999998, 22.781666666666666, 40.90233333333332, 42.891666666666694, 35.01366666666665, 16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333], "episode_lengths": [45, 75, 67, 94, 41, 47, 83, 35, 69, 40, 45, 30, 60, 45, 31, 33, 61, 75, 62, 80, 77, 70, 39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8733016119012733, "mean_inference_ms": 3.299583111272909, "mean_action_processing_ms": 0.5189358704225585, "mean_env_wait_ms": 0.13456880898192883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025481700897216797, "StateBufferConnector_ms": 0.010560274124145508, "ViewRequirementAgentConnector_ms": 0.4294712543487549}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40040, "num_agent_steps_trained": 178496, "num_env_steps_sampled": 40040, "num_env_steps_trained": 178496, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 67.22539267026605, "num_env_steps_trained_throughput_per_sec": 307.3160807783591, "timesteps_total": 40040, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 40040, "timers": {"training_iteration_time_ms": 91.867, "sample_time_ms": 34.509, "load_time_ms": 0.245, "load_throughput": 130485.833, "learn_time_ms": 6.056, "learn_throughput": 5284.142, "synch_weights_time_ms": 21.433}, "counters": {"num_env_steps_sampled": 40040, "num_env_steps_trained": 178496, "num_agent_steps_sampled": 40040, "num_agent_steps_trained": 178496, "last_target_update_ts": 39809, "num_target_updates": 78}, "done": false, "episodes_total": 1101, "training_iteration": 40, "trial_id": "408f7_00000", "date": "2023-12-07_23-53-52", "timestamp": 1702022032, "time_this_iter_s": 14.91116213798523, "time_total_s": 633.7572684288025, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 633.7572684288025, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 83.47142857142856, "ram_util_percent": 95.36190476190477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.570404052734375, "min_q": 5.061036586761475, "max_q": 22.190330505371094, "mean_td_error": 0.5106010437011719, "model": {}}, "td_error": [3.18881893157959, 0.8933305740356445, -1.5925283432006836, -0.33804893493652344, -0.8697166442871094, -0.6596031188964844, 2.1942005157470703, -0.030263900756835938, -1.4933853149414062, 0.4626646041870117, 1.243560791015625, -1.3650026321411133, -0.5947794914245605, 1.4880046844482422, -0.7183427810668945, 0.4087390899658203, 1.5282220840454102, 1.2410106658935547, 2.095783233642578, -1.9530582427978516, 1.4365849494934082, 1.2267265319824219, 0.27277374267578125, 2.963878631591797, 2.0059123039245605, 2.1460447311401367, -0.5053081512451172, -0.5123739242553711, 0.46259117126464844, 1.9735307693481445, -0.1269073486328125, -0.13382530212402344], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5721.0, "diff_num_grad_updates_vs_sampler_policy": 5720.0}}, "num_env_steps_sampled": 41041, "num_env_steps_trained": 183072, "num_agent_steps_sampled": 41041, "num_agent_steps_trained": 183072, "last_target_update_ts": 40817, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 26.00032333333334, "episode_len_mean": 51.17, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652], "episode_lengths": [39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.869139709712546, "mean_inference_ms": 3.3116204509761826, "mean_action_processing_ms": 0.5182314286855123, "mean_env_wait_ms": 0.13425225009020975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02212238311767578, "StateBufferConnector_ms": 0.01792287826538086, "ViewRequirementAgentConnector_ms": 0.4160487651824951}}, "episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 26.00032333333334, "episode_len_mean": 51.17, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.93133333333333, 21.96566666666666, 16.886666666666663, 18.568333333333328, 37.16166666666668, 29.63966666666665, 14.834666666666664, 37.05466666666667, 33.61200000000001, 16.32033333333333, 25.095333333333336, 62.18433333333336, 18.69566666666666, 39.47233333333334, 20.56966666666666, 20.05033333333334, 21.921666666666663, 38.24766666666668, 18.217999999999993, 26.602333333333316, 15.092999999999996, 55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652], "episode_lengths": [39, 39, 33, 42, 76, 69, 29, 72, 63, 32, 49, 95, 44, 75, 44, 44, 47, 79, 38, 48, 31, 101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.869139709712546, "mean_inference_ms": 3.3116204509761826, "mean_action_processing_ms": 0.5182314286855123, "mean_env_wait_ms": 0.13425225009020975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02212238311767578, "StateBufferConnector_ms": 0.01792287826538086, "ViewRequirementAgentConnector_ms": 0.4160487651824951}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41041, "num_agent_steps_trained": 183072, "num_env_steps_sampled": 41041, "num_env_steps_trained": 183072, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 78.3779677044933, "num_env_steps_trained_throughput_per_sec": 358.2992809348265, "timesteps_total": 41041, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 41041, "timers": {"training_iteration_time_ms": 96.4, "sample_time_ms": 34.179, "load_time_ms": 0.618, "load_throughput": 51819.516, "learn_time_ms": 6.303, "learn_throughput": 5076.717, "synch_weights_time_ms": 22.068}, "counters": {"num_env_steps_sampled": 41041, "num_env_steps_trained": 183072, "num_agent_steps_sampled": 41041, "num_agent_steps_trained": 183072, "last_target_update_ts": 40817, "num_target_updates": 80}, "done": false, "episodes_total": 1123, "training_iteration": 41, "trial_id": "408f7_00000", "date": "2023-12-07_23-54-05", "timestamp": 1702022045, "time_this_iter_s": 12.796837091445923, "time_total_s": 646.5541055202484, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 646.5541055202484, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 72.22222222222221, "ram_util_percent": 94.63888888888887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.513325691223145, "min_q": 0.8124730587005615, "max_q": 22.375612258911133, "mean_td_error": 0.15849201381206512, "model": {}}, "td_error": [-1.0171642303466797, 0.5968801975250244, 0.4224538803100586, -0.028459548950195312, 1.062098503112793, -2.126492500305176, -0.08317279815673828, 1.9750652313232422, -1.9860553741455078, -0.9995040893554688, -0.18319129943847656, 0.1258373260498047, -0.26456212997436523, 1.3091654777526855, 0.9188518524169922, 0.38605552911758423, 0.8113174438476562, -0.156402587890625, 0.9001636505126953, 1.6871957778930664, 2.686436176300049, -0.10397720336914062, -0.016191482543945312, 1.2424383163452148, -0.6304702758789062, -1.2587108612060547, 0.18813514709472656, 1.4571104049682617, 0.8602809906005859, -2.901240348815918, -0.09686028957366943, 0.29471397399902344], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5864.0, "diff_num_grad_updates_vs_sampler_policy": 5863.0}}, "num_env_steps_sampled": 42042, "num_env_steps_trained": 187648, "num_agent_steps_sampled": 42042, "num_agent_steps_trained": 187648, "last_target_update_ts": 41825, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 25.76197, "episode_len_mean": 50.69, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685], "episode_lengths": [101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8612027235448942, "mean_inference_ms": 3.3429715521090753, "mean_action_processing_ms": 0.5208170020023852, "mean_env_wait_ms": 0.13454167396803723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015390396118164062, "StateBufferConnector_ms": 0.019207239151000977, "ViewRequirementAgentConnector_ms": 0.4339561462402344}}, "episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 25.76197, "episode_len_mean": 50.69, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [55.221666666666664, 15.35366666666666, 20.285666666666657, 25.300666666666668, 22.49566666666666, 64.97333333333333, 14.311333333333328, 36.79799999999999, 16.538666666666664, 21.019666666666655, 25.495999999999995, 16.473666666666663, 14.670999999999994, 17.460333333333338, 22.077, 19.288333333333327, 27.822333333333326, 19.73866666666666, 22.762999999999998, 40.77166666666668, 38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685], "episode_lengths": [101, 30, 47, 43, 46, 101, 29, 77, 35, 42, 51, 36, 35, 32, 40, 37, 58, 46, 54, 74, 73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8612027235448942, "mean_inference_ms": 3.3429715521090753, "mean_action_processing_ms": 0.5208170020023852, "mean_env_wait_ms": 0.13454167396803723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015390396118164062, "StateBufferConnector_ms": 0.019207239151000977, "ViewRequirementAgentConnector_ms": 0.4339561462402344}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42042, "num_agent_steps_trained": 187648, "num_env_steps_sampled": 42042, "num_env_steps_trained": 187648, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 63.811333952271355, "num_env_steps_trained_throughput_per_sec": 291.70895521038335, "timesteps_total": 42042, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 42042, "timers": {"training_iteration_time_ms": 130.115, "sample_time_ms": 51.781, "load_time_ms": 0.7, "load_throughput": 45695.808, "learn_time_ms": 7.167, "learn_throughput": 4465.069, "synch_weights_time_ms": 23.236}, "counters": {"num_env_steps_sampled": 42042, "num_env_steps_trained": 187648, "num_agent_steps_sampled": 42042, "num_agent_steps_trained": 187648, "last_target_update_ts": 41825, "num_target_updates": 82}, "done": false, "episodes_total": 1144, "training_iteration": 42, "trial_id": "408f7_00000", "date": "2023-12-07_23-54-20", "timestamp": 1702022060, "time_this_iter_s": 15.74673318862915, "time_total_s": 662.3008387088776, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 662.3008387088776, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 81.9318181818182, "ram_util_percent": 95.31363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.965585708618164, "min_q": 1.0071933269500732, "max_q": 22.519357681274414, "mean_td_error": -0.23508425056934357, "model": {}}, "td_error": [-0.9564971923828125, 5.574507713317871, -0.34294891357421875, -0.9155855178833008, -3.759577989578247, -0.6000385284423828, -0.6894130706787109, 2.055269241333008, -0.6719017028808594, 0.09152668714523315, -1.3223285675048828, 0.5932941436767578, -3.5642480850219727, 0.7310283184051514, -2.0452020168304443, 1.239816665649414, 0.6288585662841797, -3.0039892196655273, -3.3924365043640137, 1.3435273170471191, 0.16245222091674805, 2.522547721862793, 1.718836784362793, -2.023524284362793, 0.08151626586914062, 2.458632469177246, -2.90948486328125, 0.00196075439453125, 2.114574909210205, -1.7563018798828125, -0.1748027801513672, -0.7127656936645508], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6007.0, "diff_num_grad_updates_vs_sampler_policy": 6006.0}}, "num_env_steps_sampled": 43043, "num_env_steps_trained": 192224, "num_agent_steps_sampled": 43043, "num_agent_steps_trained": 192224, "last_target_update_ts": 42833, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 25.327316666666665, "episode_len_mean": 50.14, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999], "episode_lengths": [73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.858481050411007, "mean_inference_ms": 3.3550167165485316, "mean_action_processing_ms": 0.5212323258722041, "mean_env_wait_ms": 0.13469754792437022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01593494415283203, "StateBufferConnector_ms": 0.021219491958618164, "ViewRequirementAgentConnector_ms": 0.42736077308654785}}, "episode_reward_max": 70.54200000000009, "episode_reward_min": 13.707999999999997, "episode_reward_mean": 25.327316666666665, "episode_len_mean": 50.14, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.23933333333335, 16.723999999999993, 28.59599999999998, 53.31266666666666, 29.318999999999996, 17.633333333333326, 19.556333333333324, 51.228333333333374, 18.71166666666667, 18.870333333333335, 16.876, 19.40633333333333, 39.29833333333334, 24.38433333333334, 19.546999999999993, 13.707999999999997, 18.927000000000003, 18.737999999999992, 24.577000000000005, 32.841333333333345, 23.246666666666663, 59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999], "episode_lengths": [73, 35, 63, 89, 54, 35, 40, 88, 42, 38, 31, 44, 92, 52, 40, 29, 40, 42, 57, 65, 53, 96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.858481050411007, "mean_inference_ms": 3.3550167165485316, "mean_action_processing_ms": 0.5212323258722041, "mean_env_wait_ms": 0.13469754792437022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01593494415283203, "StateBufferConnector_ms": 0.021219491958618164, "ViewRequirementAgentConnector_ms": 0.42736077308654785}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43043, "num_agent_steps_trained": 192224, "num_env_steps_sampled": 43043, "num_env_steps_trained": 192224, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 60.95059689726858, "num_env_steps_trained_throughput_per_sec": 278.63130010179924, "timesteps_total": 43043, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 43043, "timers": {"training_iteration_time_ms": 93.092, "sample_time_ms": 34.789, "load_time_ms": 0.034, "load_throughput": 949205.997, "learn_time_ms": 6.053, "learn_throughput": 5286.535, "synch_weights_time_ms": 22.031}, "counters": {"num_env_steps_sampled": 43043, "num_env_steps_trained": 192224, "num_agent_steps_sampled": 43043, "num_agent_steps_trained": 192224, "last_target_update_ts": 42833, "num_target_updates": 84}, "done": false, "episodes_total": 1164, "training_iteration": 43, "trial_id": "408f7_00000", "date": "2023-12-07_23-54-37", "timestamp": 1702022077, "time_this_iter_s": 16.460862636566162, "time_total_s": 678.7617013454437, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 678.7617013454437, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 89.76818181818182, "ram_util_percent": 94.94545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.80553150177002, "min_q": 1.287660002708435, "max_q": 20.696701049804688, "mean_td_error": -0.684636116027832, "model": {}}, "td_error": [1.379706859588623, -0.3017711639404297, 1.3134636878967285, 1.6831855773925781, 0.5966167449951172, -1.4924278259277344, 1.5933313369750977, -2.2142086029052734, -1.1294775009155273, -2.242460250854492, -1.515066146850586, 0.1344585418701172, -0.9847049713134766, -0.16816139221191406, -2.969083786010742, -1.9190187454223633, -1.6072044372558594, -1.2026405334472656, -2.117055892944336, 0.14580535888671875, -1.1477603912353516, 0.9123573303222656, -0.7586898803710938, -2.950638771057129, -2.3686861991882324, -0.9517498016357422, -0.4614400863647461, 0.33199334144592285, 1.1247291564941406, -1.2263927459716797, -0.9691486358642578, -0.42621707916259766], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6150.0, "diff_num_grad_updates_vs_sampler_policy": 6149.0}}, "num_env_steps_sampled": 44044, "num_env_steps_trained": 196800, "num_agent_steps_sampled": 44044, "num_agent_steps_trained": 196800, "last_target_update_ts": 43841, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": 70.54200000000009, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 24.78549, "episode_len_mean": 48.74, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999], "episode_lengths": [96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8596659976772445, "mean_inference_ms": 3.3525619482158517, "mean_action_processing_ms": 0.5194430358318326, "mean_env_wait_ms": 0.13429471649058625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017056703567504883, "StateBufferConnector_ms": 0.019600868225097656, "ViewRequirementAgentConnector_ms": 0.4327397346496582}}, "episode_reward_max": 70.54200000000009, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 24.78549, "episode_len_mean": 48.74, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.913000000000025, 16.818999999999996, 28.338666666666676, 70.54200000000009, 22.273666666666674, 19.956666666666663, 19.168, 30.750000000000007, 20.52299999999999, 22.943999999999992, 36.09000000000001, 32.86166666666664, 27.187666666666665, 19.53166666666666, 24.562666666666665, 16.40333333333333, 17.29366666666666, 16.41466666666666, 36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999], "episode_lengths": [96, 34, 62, 117, 52, 37, 35, 66, 39, 48, 65, 62, 49, 36, 53, 34, 37, 41, 56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8596659976772445, "mean_inference_ms": 3.3525619482158517, "mean_action_processing_ms": 0.5194430358318326, "mean_env_wait_ms": 0.13429471649058625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017056703567504883, "StateBufferConnector_ms": 0.019600868225097656, "ViewRequirementAgentConnector_ms": 0.4327397346496582}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44044, "num_agent_steps_trained": 196800, "num_env_steps_sampled": 44044, "num_env_steps_trained": 196800, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 55.64150860604255, "num_env_steps_trained_throughput_per_sec": 254.36118219905165, "timesteps_total": 44044, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 44044, "timers": {"training_iteration_time_ms": 126.837, "sample_time_ms": 47.818, "load_time_ms": 0.641, "load_throughput": 49939.622, "learn_time_ms": 7.282, "learn_throughput": 4394.559, "synch_weights_time_ms": 23.297}, "counters": {"num_env_steps_sampled": 44044, "num_env_steps_trained": 196800, "num_agent_steps_sampled": 44044, "num_agent_steps_trained": 196800, "last_target_update_ts": 43841, "num_target_updates": 86}, "done": false, "episodes_total": 1185, "training_iteration": 44, "trial_id": "408f7_00000", "date": "2023-12-07_23-54-55", "timestamp": 1702022095, "time_this_iter_s": 18.018390893936157, "time_total_s": 696.7800922393799, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 696.7800922393799, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 82.76799999999999, "ram_util_percent": 95.976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.462165832519531, "min_q": 1.997676968574524, "max_q": 20.953018188476562, "mean_td_error": -0.7947620153427124, "model": {}}, "td_error": [0.07502365112304688, 0.4069099426269531, -2.33498477935791, -0.6264915466308594, -0.3220844268798828, -2.284555435180664, 0.013402938842773438, -3.6495466232299805, -1.2104763984680176, -2.484243869781494, -1.2119770050048828, 0.8941078186035156, -2.1472320556640625, -0.9315155744552612, -2.854257583618164, 0.818328857421875, -0.6464967727661133, 0.4893016815185547, 0.2670097351074219, -2.218883514404297, -0.8194308280944824, -0.6256647109985352, 0.23294830322265625, -2.572530746459961, 0.5090246200561523, 1.6515388488769531, 1.3473024368286133, -1.1435680389404297, -0.04311418533325195, -1.6739234924316406, -1.2793426513671875, -1.0569629669189453], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6293.0, "diff_num_grad_updates_vs_sampler_policy": 6292.0}}, "num_env_steps_sampled": 45045, "num_env_steps_trained": 201376, "num_agent_steps_sampled": 45045, "num_agent_steps_trained": 201376, "last_target_update_ts": 44849, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 25.166016666666668, "episode_len_mean": 49.09, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676], "episode_lengths": [56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8567220083074187, "mean_inference_ms": 3.3690720702080768, "mean_action_processing_ms": 0.5202993373998462, "mean_env_wait_ms": 0.13446880805510755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01813960075378418, "StateBufferConnector_ms": 0.020846128463745117, "ViewRequirementAgentConnector_ms": 0.43639230728149414}}, "episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 25.166016666666668, "episode_len_mean": 49.09, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.27733333333332, 20.025000000000002, 17.093999999999998, 20.508, 26.467, 18.658666666666658, 33.675000000000004, 17.360333333333326, 19.18733333333333, 17.419666666666664, 42.50000000000003, 20.444, 43.994000000000014, 30.91833333333335, 21.808666666666667, 17.666999999999994, 20.232999999999997, 17.65066666666667, 18.06566666666666, 26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676], "episode_lengths": [56, 43, 42, 39, 52, 39, 61, 33, 46, 34, 71, 39, 80, 57, 40, 38, 44, 44, 39, 53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8567220083074187, "mean_inference_ms": 3.3690720702080768, "mean_action_processing_ms": 0.5202993373998462, "mean_env_wait_ms": 0.13446880805510755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01813960075378418, "StateBufferConnector_ms": 0.020846128463745117, "ViewRequirementAgentConnector_ms": 0.43639230728149414}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45045, "num_agent_steps_trained": 201376, "num_env_steps_sampled": 45045, "num_env_steps_trained": 201376, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 57.2032217586892, "num_env_steps_trained_throughput_per_sec": 261.5004423254364, "timesteps_total": 45045, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 45045, "timers": {"training_iteration_time_ms": 114.328, "sample_time_ms": 43.475, "load_time_ms": 0.934, "load_throughput": 34276.816, "learn_time_ms": 6.795, "learn_throughput": 4709.311, "synch_weights_time_ms": 22.451}, "counters": {"num_env_steps_sampled": 45045, "num_env_steps_trained": 201376, "num_agent_steps_sampled": 45045, "num_agent_steps_trained": 201376, "last_target_update_ts": 44849, "num_target_updates": 88}, "done": false, "episodes_total": 1203, "training_iteration": 45, "trial_id": "408f7_00000", "date": "2023-12-07_23-55-13", "timestamp": 1702022113, "time_this_iter_s": 17.530036211013794, "time_total_s": 714.3101284503937, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 714.3101284503937, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 91.096, "ram_util_percent": 96.47599999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.872817993164062, "min_q": 4.050754547119141, "max_q": 22.411664962768555, "mean_td_error": -0.09038892388343811, "model": {}}, "td_error": [-0.5452008247375488, 0.9649715423583984, 0.4095497131347656, 0.934657096862793, -1.5339975357055664, 2.2768545150756836, -1.9265837669372559, -0.23021411895751953, 0.1684722900390625, -2.113776206970215, 1.5453100204467773, 1.1546554565429688, -0.2221202850341797, 1.364645004272461, -2.713934898376465, 0.4201984405517578, -0.6897983551025391, -1.9409618377685547, -0.33555126190185547, 2.280306816101074, 0.054932594299316406, -0.18448162078857422, -0.1373310089111328, -2.708979606628418, -0.40003204345703125, -0.8476524353027344, -0.0058002471923828125, -0.39638328552246094, 0.5293116569519043, -0.9061279296875, 1.9790239334106445, 0.8635926246643066], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6436.0, "diff_num_grad_updates_vs_sampler_policy": 6435.0}}, "num_env_steps_sampled": 46046, "num_env_steps_trained": 205952, "num_agent_steps_sampled": 46046, "num_agent_steps_trained": 205952, "last_target_update_ts": 45857, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 25.929090000000002, "episode_len_mean": 50.64, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003], "episode_lengths": [53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.859254710416258, "mean_inference_ms": 3.36000515717698, "mean_action_processing_ms": 0.5197746182242979, "mean_env_wait_ms": 0.1346203082346028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020574569702148438, "StateBufferConnector_ms": 0.01247715950012207, "ViewRequirementAgentConnector_ms": 0.4484686851501465}}, "episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 25.929090000000002, "episode_len_mean": 50.64, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.778666666666652, 23.59366666666666, 21.24433333333333, 16.326333333333334, 16.389666666666663, 29.296666666666663, 29.987, 24.72466666666667, 24.403666666666666, 19.838999999999995, 20.208666666666666, 46.99566666666673, 14.042333333333326, 26.628333333333323, 15.449666666666664, 21.854666666666674, 26.05266666666666, 18.363999999999994, 17.219, 38.68066666666669, 37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003], "episode_lengths": [53, 58, 44, 37, 32, 60, 54, 55, 47, 36, 39, 88, 31, 56, 35, 46, 44, 37, 33, 73, 67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.859254710416258, "mean_inference_ms": 3.36000515717698, "mean_action_processing_ms": 0.5197746182242979, "mean_env_wait_ms": 0.1346203082346028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020574569702148438, "StateBufferConnector_ms": 0.01247715950012207, "ViewRequirementAgentConnector_ms": 0.4484686851501465}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46046, "num_agent_steps_trained": 205952, "num_env_steps_sampled": 46046, "num_env_steps_trained": 205952, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 63.39193196204684, "num_env_steps_trained_throughput_per_sec": 289.791688969357, "timesteps_total": 46046, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 46046, "timers": {"training_iteration_time_ms": 113.693, "sample_time_ms": 44.246, "load_time_ms": 0.5, "load_throughput": 63971.082, "learn_time_ms": 6.954, "learn_throughput": 4601.73, "synch_weights_time_ms": 22.545}, "counters": {"num_env_steps_sampled": 46046, "num_env_steps_trained": 205952, "num_agent_steps_sampled": 46046, "num_agent_steps_trained": 205952, "last_target_update_ts": 45857, "num_target_updates": 90}, "done": false, "episodes_total": 1222, "training_iteration": 46, "trial_id": "408f7_00000", "date": "2023-12-07_23-55-29", "timestamp": 1702022129, "time_this_iter_s": 15.831650495529175, "time_total_s": 730.1417789459229, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 730.1417789459229, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 87.9909090909091, "ram_util_percent": 94.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.142633438110352, "min_q": 1.9199610948562622, "max_q": 21.861223220825195, "mean_td_error": 0.2464010864496231, "model": {}}, "td_error": [-1.3508869409561157, -0.7244319915771484, -0.13948631286621094, 1.2045273780822754, -1.2478418350219727, 1.277094841003418, 1.4163169860839844, 1.373744010925293, -1.893594741821289, 0.6172170639038086, 0.6912975311279297, 3.5801782608032227, 1.1170730590820312, -1.3752422332763672, 0.8448829650878906, 2.254291534423828, 0.14447879791259766, -0.33322811126708984, 0.39381980895996094, -1.2902870178222656, -0.0051746368408203125, 0.8758172988891602, -0.7222228050231934, 0.3700218200683594, 0.8881115913391113, -0.92620849609375, 2.064119338989258, 0.7228050231933594, 0.9732556343078613, -0.6558094024658203, -1.55810546875, -0.7016983032226562], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6579.0, "diff_num_grad_updates_vs_sampler_policy": 6578.0}}, "num_env_steps_sampled": 47047, "num_env_steps_trained": 210528, "num_agent_steps_sampled": 47047, "num_agent_steps_trained": 210528, "last_target_update_ts": 46865, "num_target_updates": 92}, "sampler_results": {"episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 26.952969999999997, "episode_len_mean": 51.75, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666], "episode_lengths": [67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.863471719305413, "mean_inference_ms": 3.3487414184068736, "mean_action_processing_ms": 0.5176989044688146, "mean_env_wait_ms": 0.13470253652656658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0208432674407959, "StateBufferConnector_ms": 0.012168645858764648, "ViewRequirementAgentConnector_ms": 0.4281630516052246}}, "episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 26.952969999999997, "episode_len_mean": 51.75, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.093666666666664, 36.895666666666685, 50.485000000000035, 37.570333333333345, 20.316333333333336, 35.672000000000004, 14.876999999999992, 23.203999999999983, 28.694666666666677, 22.250333333333327, 17.74033333333333, 14.694666666666663, 16.026333333333334, 25.96699999999999, 17.59833333333333, 20.629666666666655, 19.64433333333333, 28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666], "episode_lengths": [67, 68, 87, 72, 46, 69, 32, 49, 61, 44, 34, 30, 31, 50, 34, 43, 45, 56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.863471719305413, "mean_inference_ms": 3.3487414184068736, "mean_action_processing_ms": 0.5176989044688146, "mean_env_wait_ms": 0.13470253652656658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0208432674407959, "StateBufferConnector_ms": 0.012168645858764648, "ViewRequirementAgentConnector_ms": 0.4281630516052246}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47047, "num_agent_steps_trained": 210528, "num_env_steps_sampled": 47047, "num_env_steps_trained": 210528, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 55.40050947904618, "num_env_steps_trained_throughput_per_sec": 253.2594719042111, "timesteps_total": 47047, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 47047, "timers": {"training_iteration_time_ms": 117.549, "sample_time_ms": 42.13, "load_time_ms": 0.633, "load_throughput": 50549.009, "learn_time_ms": 6.468, "learn_throughput": 4947.663, "synch_weights_time_ms": 23.125}, "counters": {"num_env_steps_sampled": 47047, "num_env_steps_trained": 210528, "num_agent_steps_sampled": 47047, "num_agent_steps_trained": 210528, "last_target_update_ts": 46865, "num_target_updates": 92}, "done": false, "episodes_total": 1242, "training_iteration": 47, "trial_id": "408f7_00000", "date": "2023-12-07_23-55-47", "timestamp": 1702022147, "time_this_iter_s": 18.095144033432007, "time_total_s": 748.2369229793549, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 748.2369229793549, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 92.86, "ram_util_percent": 94.816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.13081169128418, "min_q": 1.901220440864563, "max_q": 22.5316104888916, "mean_td_error": 0.5240429639816284, "model": {}}, "td_error": [-1.7880439758300781, -0.5128507614135742, -0.4125823974609375, -0.7600650787353516, -0.30648231506347656, 2.4771370887756348, 2.218522310256958, 2.3993663787841797, 1.0833730697631836, 2.502349853515625, 1.522186279296875, 0.12089920043945312, 1.1663093566894531, 1.7716503143310547, 0.9662204384803772, -0.5821590423583984, 0.9270248413085938, -0.4995441436767578, 0.05727577209472656, -0.5905685424804688, 2.8595123291015625, -0.39078474044799805, -0.2558708190917969, -2.1289710998535156, -0.6893196105957031, -0.6671500205993652, 3.14638614654541, -0.4279804229736328, 1.0224266052246094, -0.25328826904296875, 0.25582313537597656, 2.53857421875], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6722.0, "diff_num_grad_updates_vs_sampler_policy": 6721.0}}, "num_env_steps_sampled": 48048, "num_env_steps_trained": 215104, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 215104, "last_target_update_ts": 47873, "num_target_updates": 94}, "sampler_results": {"episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 27.090703333333337, "episode_len_mean": 51.78, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993], "episode_lengths": [56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8677599504642406, "mean_inference_ms": 3.3354041562117267, "mean_action_processing_ms": 0.5162033904232248, "mean_env_wait_ms": 0.1348983668430974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021131515502929688, "StateBufferConnector_ms": 0.017327070236206055, "ViewRequirementAgentConnector_ms": 0.41565895080566406}}, "episode_reward_max": 67.50666666666666, "episode_reward_min": 13.183666666666664, "episode_reward_mean": 27.090703333333337, "episode_len_mean": 51.78, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.128333333333334, 23.10633333333332, 18.06499999999999, 20.707999999999988, 20.01699999999999, 28.39633333333332, 19.77866666666666, 18.890000000000004, 17.87233333333333, 30.452000000000005, 13.183666666666664, 31.891666666666673, 29.638666666666662, 14.462333333333333, 19.370333333333324, 58.85866666666668, 17.09633333333333, 19.23633333333333, 18.412333333333322, 15.411999999999995, 19.195666666666668, 28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993], "episode_lengths": [56, 49, 36, 46, 45, 56, 36, 37, 38, 65, 28, 52, 52, 28, 38, 107, 33, 39, 41, 30, 42, 50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8677599504642406, "mean_inference_ms": 3.3354041562117267, "mean_action_processing_ms": 0.5162033904232248, "mean_env_wait_ms": 0.1348983668430974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021131515502929688, "StateBufferConnector_ms": 0.017327070236206055, "ViewRequirementAgentConnector_ms": 0.41565895080566406}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 215104, "num_env_steps_sampled": 48048, "num_env_steps_trained": 215104, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 59.240652404015854, "num_env_steps_trained_throughput_per_sec": 270.8144109897868, "timesteps_total": 48048, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 48048, "timers": {"training_iteration_time_ms": 124.936, "sample_time_ms": 47.556, "load_time_ms": 0.602, "load_throughput": 53185.025, "learn_time_ms": 6.865, "learn_throughput": 4661.341, "synch_weights_time_ms": 24.492}, "counters": {"num_env_steps_sampled": 48048, "num_env_steps_trained": 215104, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 215104, "last_target_update_ts": 47873, "num_target_updates": 94}, "done": false, "episodes_total": 1259, "training_iteration": 48, "trial_id": "408f7_00000", "date": "2023-12-07_23-56-04", "timestamp": 1702022164, "time_this_iter_s": 16.937483549118042, "time_total_s": 765.1744065284729, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 765.1744065284729, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 92.09565217391304, "ram_util_percent": 95.7608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.16500473022461, "min_q": 4.597038269042969, "max_q": 23.227205276489258, "mean_td_error": 0.31244587898254395, "model": {}}, "td_error": [-2.148993492126465, -0.641357421875, 1.4974908828735352, -1.412613868713379, -0.14109420776367188, -0.5408954620361328, 2.5902156829833984, -1.8649005889892578, 0.8105645179748535, 0.896723747253418, 0.6376256942749023, 0.786229133605957, 0.13878202438354492, 1.4853591918945312, -0.10586166381835938, -0.4729642868041992, 0.7797374725341797, 0.5054283142089844, 0.32335662841796875, 2.4941978454589844, -0.12443923950195312, 0.7937412261962891, -0.6388492584228516, 3.694705009460449, -1.1885881423950195, 1.516317367553711, 0.3808155059814453, 0.5154304504394531, -0.6495952606201172, 1.4813175201416016, -1.3691291809082031, -0.030487537384033203], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6865.0, "diff_num_grad_updates_vs_sampler_policy": 6864.0}}, "num_env_steps_sampled": 49049, "num_env_steps_trained": 219680, "num_agent_steps_sampled": 49049, "num_agent_steps_trained": 219680, "last_target_update_ts": 48881, "num_target_updates": 96}, "sampler_results": {"episode_reward_max": 67.50666666666666, "episode_reward_min": 13.450333333333335, "episode_reward_mean": 27.952003333333327, "episode_len_mean": 53.22, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591], "episode_lengths": [50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.868184927688674, "mean_inference_ms": 3.3241592511565154, "mean_action_processing_ms": 0.5146323430811198, "mean_env_wait_ms": 0.13499506208456263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018906116485595703, "StateBufferConnector_ms": 0.02083611488342285, "ViewRequirementAgentConnector_ms": 0.42437744140625}}, "episode_reward_max": 67.50666666666666, "episode_reward_min": 13.450333333333335, "episode_reward_mean": 27.952003333333327, "episode_len_mean": 53.22, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.352999999999998, 34.04400000000001, 13.450333333333335, 16.85366666666667, 24.70999999999999, 43.93300000000002, 14.248666666666665, 24.908666666666655, 38.91866666666666, 21.82133333333334, 15.405666666666658, 23.691333333333322, 15.874999999999996, 30.662000000000003, 67.50666666666666, 31.124999999999993, 34.04533333333333, 32.51933333333333, 31.602000000000004, 40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591], "episode_lengths": [50, 66, 33, 32, 59, 80, 31, 45, 70, 48, 34, 47, 32, 52, 103, 52, 61, 66, 57, 78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.868184927688674, "mean_inference_ms": 3.3241592511565154, "mean_action_processing_ms": 0.5146323430811198, "mean_env_wait_ms": 0.13499506208456263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018906116485595703, "StateBufferConnector_ms": 0.02083611488342285, "ViewRequirementAgentConnector_ms": 0.42437744140625}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49049, "num_agent_steps_trained": 219680, "num_env_steps_sampled": 49049, "num_env_steps_trained": 219680, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 57.25350995794876, "num_env_steps_trained_throughput_per_sec": 261.7303312363372, "timesteps_total": 49049, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 49049, "timers": {"training_iteration_time_ms": 118.548, "sample_time_ms": 47.845, "load_time_ms": 1.274, "load_throughput": 25121.704, "learn_time_ms": 7.047, "learn_throughput": 4540.918, "synch_weights_time_ms": 21.775}, "counters": {"num_env_steps_sampled": 49049, "num_env_steps_trained": 219680, "num_agent_steps_sampled": 49049, "num_agent_steps_trained": 219680, "last_target_update_ts": 48881, "num_target_updates": 96}, "done": false, "episodes_total": 1280, "training_iteration": 49, "trial_id": "408f7_00000", "date": "2023-12-07_23-56-22", "timestamp": 1702022182, "time_this_iter_s": 17.52424716949463, "time_total_s": 782.6986536979675, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 782.6986536979675, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 94.04583333333333, "ram_util_percent": 96.19583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.398845672607422, "min_q": -0.018912792205810547, "max_q": 23.540273666381836, "mean_td_error": -0.29283931851387024, "model": {}}, "td_error": [-1.7648630142211914, 1.1048564910888672, -1.8449559211730957, -2.4705581665039062, -1.0270195007324219, -1.626443862915039, 0.928004264831543, 1.1250381469726562, -1.6689691543579102, 0.7221946716308594, -1.9273481369018555, -0.3407135009765625, -1.422022819519043, -1.3492851257324219, -0.9583053588867188, 7.824365139007568, -1.2100296020507812, -0.9051218032836914, -0.39272117614746094, -0.17024803161621094, -0.5270566940307617, -0.3628101348876953, 1.505859375, 0.6412353515625, -1.5411911010742188, 1.149641990661621, -0.5881175994873047, 0.8082523345947266, -1.6209468841552734, 0.057857513427734375, 0.8867969512939453, -2.406233072280884], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7008.0, "diff_num_grad_updates_vs_sampler_policy": 7007.0}}, "num_env_steps_sampled": 50050, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 50050, "num_agent_steps_trained": 224256, "last_target_update_ts": 49889, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": 62.2756666666667, "episode_reward_min": 13.537666666666667, "episode_reward_mean": 27.721269999999993, "episode_len_mean": 53.02, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332], "episode_lengths": [78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8657216322689685, "mean_inference_ms": 3.3357242552674644, "mean_action_processing_ms": 0.5168070732728153, "mean_env_wait_ms": 0.13518279728127497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01998615264892578, "StateBufferConnector_ms": 0.025860309600830078, "ViewRequirementAgentConnector_ms": 0.42458510398864746}}, "episode_reward_max": 62.2756666666667, "episode_reward_min": 13.537666666666667, "episode_reward_mean": 27.721269999999993, "episode_len_mean": 53.02, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.71466666666667, 16.87966666666666, 24.014333333333333, 31.754666666666676, 28.941999999999993, 16.934333333333324, 23.321666666666662, 34.76233333333334, 15.609666666666657, 62.2756666666667, 19.32966666666667, 45.43366666666667, 49.295000000000016, 29.507666666666672, 27.497666666666664, 26.320999999999998, 35.232333333333344, 17.25833333333333, 21.14966666666666, 27.500333333333327, 17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332], "episode_lengths": [78, 35, 46, 61, 57, 36, 50, 68, 34, 104, 39, 83, 92, 63, 54, 56, 70, 38, 40, 55, 34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8657216322689685, "mean_inference_ms": 3.3357242552674644, "mean_action_processing_ms": 0.5168070732728153, "mean_env_wait_ms": 0.13518279728127497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01998615264892578, "StateBufferConnector_ms": 0.025860309600830078, "ViewRequirementAgentConnector_ms": 0.42458510398864746}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50050, "num_agent_steps_trained": 224256, "num_env_steps_sampled": 50050, "num_env_steps_trained": 224256, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 61.23337029116687, "num_env_steps_trained_throughput_per_sec": 279.9239784739057, "timesteps_total": 50050, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 50050, "timers": {"training_iteration_time_ms": 108.208, "sample_time_ms": 39.881, "load_time_ms": 0.719, "load_throughput": 44495.998, "learn_time_ms": 6.431, "learn_throughput": 4975.8, "synch_weights_time_ms": 23.293}, "counters": {"num_env_steps_sampled": 50050, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 50050, "num_agent_steps_trained": 224256, "last_target_update_ts": 49889, "num_target_updates": 98}, "done": false, "episodes_total": 1299, "training_iteration": 50, "trial_id": "408f7_00000", "date": "2023-12-07_23-56-38", "timestamp": 1702022198, "time_this_iter_s": 16.37364673614502, "time_total_s": 799.0723004341125, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 799.0723004341125, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 92.87391304347828, "ram_util_percent": 95.69565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.463340759277344, "min_q": 7.446835041046143, "max_q": 22.202415466308594, "mean_td_error": 0.5337542295455933, "model": {}}, "td_error": [-0.4397602081298828, -0.14449119567871094, 1.1402063369750977, 1.8498239517211914, -0.22407913208007812, -0.16040611267089844, 0.1272563934326172, 1.168802261352539, 0.06504058837890625, -0.40634918212890625, 0.5975189208984375, 1.4515180587768555, 2.52908992767334, -0.19581985473632812, 1.0223073959350586, 0.9081954956054688, -3.0664124488830566, -0.5735340118408203, -1.4545841217041016, 2.520975112915039, -0.4365406036376953, 2.1762752532958984, 1.2447738647460938, 2.3493618965148926, 2.752208709716797, 2.5215725898742676, 2.4207725524902344, 0.16122817993164062, -0.1507854461669922, -0.7939281463623047, -0.8269748687744141, -1.0531253814697266], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7151.0, "diff_num_grad_updates_vs_sampler_policy": 7150.0}}, "num_env_steps_sampled": 51051, "num_env_steps_trained": 228832, "num_agent_steps_sampled": 51051, "num_agent_steps_trained": 228832, "last_target_update_ts": 50897, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": 58.24766666666668, "episode_reward_min": 13.537666666666667, "episode_reward_mean": 26.74975, "episode_len_mean": 51.03, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995], "episode_lengths": [34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8589053489867706, "mean_inference_ms": 3.36728405469264, "mean_action_processing_ms": 0.5181193585673732, "mean_env_wait_ms": 0.13507475009757727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017628192901611328, "StateBufferConnector_ms": 0.021869182586669922, "ViewRequirementAgentConnector_ms": 0.43805575370788574}}, "episode_reward_max": 58.24766666666668, "episode_reward_min": 13.537666666666667, "episode_reward_mean": 26.74975, "episode_len_mean": 51.03, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.58266666666666, 14.26133333333333, 24.046000000000003, 31.024666666666686, 17.65299999999999, 31.41466666666667, 40.76499999999999, 22.388333333333332, 47.08733333333334, 17.556999999999995, 40.505333333333326, 15.283666666666665, 28.397666666666666, 34.58633333333334, 18.229333333333322, 19.48, 37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995], "episode_lengths": [34, 29, 50, 67, 36, 62, 67, 42, 81, 34, 67, 30, 45, 54, 41, 37, 58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8589053489867706, "mean_inference_ms": 3.36728405469264, "mean_action_processing_ms": 0.5181193585673732, "mean_env_wait_ms": 0.13507475009757727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017628192901611328, "StateBufferConnector_ms": 0.021869182586669922, "ViewRequirementAgentConnector_ms": 0.43805575370788574}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51051, "num_agent_steps_trained": 228832, "num_env_steps_sampled": 51051, "num_env_steps_trained": 228832, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 74.62517615396813, "num_env_steps_trained_throughput_per_sec": 341.14366241814, "timesteps_total": 51051, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 51051, "timers": {"training_iteration_time_ms": 75.438, "sample_time_ms": 27.172, "load_time_ms": 1.268, "load_throughput": 25234.114, "learn_time_ms": 5.491, "learn_throughput": 5828.002, "synch_weights_time_ms": 17.474}, "counters": {"num_env_steps_sampled": 51051, "num_env_steps_trained": 228832, "num_agent_steps_sampled": 51051, "num_agent_steps_trained": 228832, "last_target_update_ts": 50897, "num_target_updates": 100}, "done": false, "episodes_total": 1319, "training_iteration": 51, "trial_id": "408f7_00000", "date": "2023-12-07_23-56-52", "timestamp": 1702022212, "time_this_iter_s": 13.434007406234741, "time_total_s": 812.5063078403473, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 812.5063078403473, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 83.22222222222223, "ram_util_percent": 95.77777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.203124046325684, "min_q": 1.838739037513733, "max_q": 22.190919876098633, "mean_td_error": 0.5211864709854126, "model": {}}, "td_error": [0.7153663635253906, -0.29086875915527344, 1.3296136856079102, -0.8701057434082031, 1.7676527500152588, 0.9084057211875916, 1.0719337463378906, -0.3645896911621094, 2.837717056274414, -0.261871337890625, 1.1416349411010742, 2.459599494934082, 1.8802852630615234, 1.5025835037231445, 0.575286865234375, -1.1788816452026367, 2.529726982116699, 1.4429521560668945, -2.1969432830810547, -1.0387239456176758, 0.201934814453125, 1.819303274154663, 0.5919427871704102, 0.46241283416748047, 0.4675673246383667, -0.4662132263183594, 0.19538307189941406, -2.5472488403320312, 1.227461814880371, 0.28218841552734375, 0.9842815399169922, -0.5018215179443359], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7294.0, "diff_num_grad_updates_vs_sampler_policy": 7293.0}}, "num_env_steps_sampled": 52052, "num_env_steps_trained": 233408, "num_agent_steps_sampled": 52052, "num_agent_steps_trained": 233408, "last_target_update_ts": 51905, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": 58.24766666666668, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 26.992313333333335, "episode_len_mean": 51.73, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331], "episode_lengths": [58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8579718846134505, "mean_inference_ms": 3.3423290123858975, "mean_action_processing_ms": 0.5192504459358088, "mean_env_wait_ms": 0.1345845242161794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01763749122619629, "StateBufferConnector_ms": 0.020537137985229492, "ViewRequirementAgentConnector_ms": 0.42812538146972656}}, "episode_reward_max": 58.24766666666668, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 26.992313333333335, "episode_len_mean": 51.73, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.26899999999999, 40.8536666666667, 40.91533333333332, 18.20433333333333, 44.54566666666668, 16.466333333333328, 17.84066666666666, 27.653666666666677, 20.270666666666656, 14.300333333333331, 21.159333333333333, 30.652999999999988, 56.68500000000002, 18.368666666666662, 22.540666666666656, 22.324333333333342, 17.585666666666665, 32.00533333333331, 58.24766666666668, 40.027666666666676, 15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331], "episode_lengths": [58, 84, 67, 36, 89, 34, 38, 62, 43, 28, 47, 56, 92, 38, 37, 46, 42, 53, 90, 76, 36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8579718846134505, "mean_inference_ms": 3.3423290123858975, "mean_action_processing_ms": 0.5192504459358088, "mean_env_wait_ms": 0.1345845242161794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01763749122619629, "StateBufferConnector_ms": 0.020537137985229492, "ViewRequirementAgentConnector_ms": 0.42812538146972656}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52052, "num_agent_steps_trained": 233408, "num_env_steps_sampled": 52052, "num_env_steps_trained": 233408, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 77.99738351508239, "num_env_steps_trained_throughput_per_sec": 356.5594674975195, "timesteps_total": 52052, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 52052, "timers": {"training_iteration_time_ms": 104.965, "sample_time_ms": 37.523, "load_time_ms": 0.509, "load_throughput": 62838.957, "learn_time_ms": 6.467, "learn_throughput": 4948.028, "synch_weights_time_ms": 22.373}, "counters": {"num_env_steps_sampled": 52052, "num_env_steps_trained": 233408, "num_agent_steps_sampled": 52052, "num_agent_steps_trained": 233408, "last_target_update_ts": 51905, "num_target_updates": 102}, "done": false, "episodes_total": 1335, "training_iteration": 52, "trial_id": "408f7_00000", "date": "2023-12-07_23-57-04", "timestamp": 1702022224, "time_this_iter_s": 12.861837387084961, "time_total_s": 825.3681452274323, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 825.3681452274323, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 71.83333333333334, "ram_util_percent": 96.15000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.666640281677246, "min_q": 1.3910924196243286, "max_q": 22.37302589416504, "mean_td_error": -0.3444998264312744, "model": {}}, "td_error": [0.3392219543457031, 0.3125513792037964, -1.8242683410644531, 0.6246156692504883, -1.9976282119750977, -1.9275283813476562, -1.957240104675293, -0.5816707611083984, -0.05641937255859375, -0.9018173217773438, 0.5368022918701172, -0.6778144836425781, -1.4093704223632812, 0.4195690155029297, -0.7745723724365234, 1.502427101135254, -0.459136962890625, -0.04410743713378906, -0.8352489471435547, -1.5667829513549805, 2.157621383666992, -0.560147762298584, -0.5157794952392578, -3.3138294219970703, 0.6768207550048828, -1.509572982788086, 0.386136531829834, -1.0769939422607422, 0.5828590393066406, 0.9984035491943359, 2.1462345123291016, 0.2826709747314453], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7437.0, "diff_num_grad_updates_vs_sampler_policy": 7436.0}}, "num_env_steps_sampled": 53053, "num_env_steps_trained": 237984, "num_agent_steps_sampled": 53053, "num_agent_steps_trained": 237984, "last_target_update_ts": 52913, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": 55.91466666666665, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 26.564653333333336, "episode_len_mean": 51.31, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995], "episode_lengths": [36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8542591129690504, "mean_inference_ms": 3.3466894435278145, "mean_action_processing_ms": 0.5193685240518126, "mean_env_wait_ms": 0.13455403228293444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021794795989990234, "StateBufferConnector_ms": 0.016192913055419922, "ViewRequirementAgentConnector_ms": 0.4405345916748047}}, "episode_reward_max": 55.91466666666665, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 26.564653333333336, "episode_len_mean": 51.31, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.80966666666666, 21.678333333333335, 14.906999999999998, 18.915999999999993, 40.31366666666666, 55.47700000000001, 23.206333333333337, 41.18833333333334, 26.21900000000001, 13.537666666666667, 20.575, 23.237, 19.668333333333322, 16.061666666666653, 17.970333333333333, 16.637666666666664, 28.500666666666653, 27.139333333333333, 46.04433333333334, 22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995], "episode_lengths": [36, 42, 34, 43, 74, 100, 51, 72, 55, 25, 40, 46, 37, 32, 44, 38, 63, 49, 78, 45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8542591129690504, "mean_inference_ms": 3.3466894435278145, "mean_action_processing_ms": 0.5193685240518126, "mean_env_wait_ms": 0.13455403228293444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021794795989990234, "StateBufferConnector_ms": 0.016192913055419922, "ViewRequirementAgentConnector_ms": 0.4405345916748047}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53053, "num_agent_steps_trained": 237984, "num_env_steps_sampled": 53053, "num_env_steps_trained": 237984, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 55.046712487331774, "num_env_steps_trained_throughput_per_sec": 251.6421142278024, "timesteps_total": 53053, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 53053, "timers": {"training_iteration_time_ms": 111.437, "sample_time_ms": 41.781, "load_time_ms": 0.776, "load_throughput": 41217.863, "learn_time_ms": 6.285, "learn_throughput": 5091.449, "synch_weights_time_ms": 21.863}, "counters": {"num_env_steps_sampled": 53053, "num_env_steps_trained": 237984, "num_agent_steps_sampled": 53053, "num_agent_steps_trained": 237984, "last_target_update_ts": 52913, "num_target_updates": 104}, "done": false, "episodes_total": 1355, "training_iteration": 53, "trial_id": "408f7_00000", "date": "2023-12-07_23-57-23", "timestamp": 1702022243, "time_this_iter_s": 18.20842695236206, "time_total_s": 843.5765721797943, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 843.5765721797943, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 91.168, "ram_util_percent": 96.24799999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.81712532043457, "min_q": 3.1787209510803223, "max_q": 21.71703338623047, "mean_td_error": -0.05787251889705658, "model": {}}, "td_error": [-0.4506387710571289, 1.174163818359375, -0.23939132690429688, -3.703712224960327, -0.8530139923095703, 1.661466121673584, 0.2599372863769531, 1.0498714447021484, -0.9351139068603516, -0.44391345977783203, 0.5501174926757812, 2.4384942054748535, -0.7991733551025391, -1.2134943008422852, 1.1309528350830078, -2.366821765899658, 0.9677906036376953, 0.38085174560546875, 1.4056119918823242, -1.2788887023925781, 2.7077560424804688, -0.5222196578979492, -0.16798973083496094, 0.3281583786010742, 0.7829685211181641, 0.5142674446105957, -0.7070159912109375, 3.298567295074463, -1.0650501251220703, -1.708871841430664, -0.8189697265625, -3.228616714477539], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7580.0, "diff_num_grad_updates_vs_sampler_policy": 7579.0}}, "num_env_steps_sampled": 54054, "num_env_steps_trained": 242560, "num_agent_steps_sampled": 54054, "num_agent_steps_trained": 242560, "last_target_update_ts": 53921, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": 59.54100000000006, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 27.219796666666667, "episode_len_mean": 52.76, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999], "episode_lengths": [45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8531054542562218, "mean_inference_ms": 3.3391099813735146, "mean_action_processing_ms": 0.518119927172553, "mean_env_wait_ms": 0.13437424220665906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02097606658935547, "StateBufferConnector_ms": 0.015497446060180664, "ViewRequirementAgentConnector_ms": 0.43933749198913574}}, "episode_reward_max": 59.54100000000006, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 27.219796666666667, "episode_len_mean": 52.76, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.925, 18.274333333333328, 30.397, 18.249666666666656, 38.088666666666676, 24.591, 16.33533333333333, 30.18499999999998, 17.384999999999998, 51.939000000000036, 30.603666666666655, 14.014666666666661, 31.242333333333338, 14.862333333333325, 43.62133333333333, 37.987333333333325, 15.803333333333333, 18.943666666666665, 28.285000000000007, 26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999], "episode_lengths": [45, 41, 52, 36, 69, 51, 33, 50, 38, 88, 50, 29, 63, 32, 81, 73, 27, 42, 59, 53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8531054542562218, "mean_inference_ms": 3.3391099813735146, "mean_action_processing_ms": 0.518119927172553, "mean_env_wait_ms": 0.13437424220665906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02097606658935547, "StateBufferConnector_ms": 0.015497446060180664, "ViewRequirementAgentConnector_ms": 0.43933749198913574}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54054, "num_agent_steps_trained": 242560, "num_env_steps_sampled": 54054, "num_env_steps_trained": 242560, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 52.45580805971666, "num_env_steps_trained_throughput_per_sec": 239.79797970156187, "timesteps_total": 54054, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 54054, "timers": {"training_iteration_time_ms": 146.871, "sample_time_ms": 66.309, "load_time_ms": 0.534, "load_throughput": 59905.257, "learn_time_ms": 16.547, "learn_throughput": 1933.926, "synch_weights_time_ms": 23.988}, "counters": {"num_env_steps_sampled": 54054, "num_env_steps_trained": 242560, "num_agent_steps_sampled": 54054, "num_agent_steps_trained": 242560, "last_target_update_ts": 53921, "num_target_updates": 106}, "done": false, "episodes_total": 1374, "training_iteration": 54, "trial_id": "408f7_00000", "date": "2023-12-07_23-57-42", "timestamp": 1702022262, "time_this_iter_s": 19.145292282104492, "time_total_s": 862.7218644618988, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 862.7218644618988, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 93.65185185185186, "ram_util_percent": 94.73333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.973932266235352, "min_q": 3.885870933532715, "max_q": 22.540977478027344, "mean_td_error": -0.05908428132534027, "model": {}}, "td_error": [2.178129196166992, -1.7543830871582031, 0.43932151794433594, 2.243863105773926, 2.0803232192993164, -0.1652679443359375, 2.111527442932129, -0.20075607299804688, -0.7662277221679688, -1.0618047714233398, -0.4004802703857422, 3.625303268432617, -1.3644542694091797, 0.5154037475585938, 0.1873006820678711, -1.169271469116211, -3.123544692993164, 1.6805038452148438, -2.9391651153564453, -0.1252727508544922, 0.2536334991455078, -2.111560821533203, 0.9003391265869141, -1.6905736923217773, -0.6040210723876953, 0.1567554473876953, 3.5406131744384766, -3.1366019248962402, 0.6532516479492188, 0.7518863677978516, -0.2778139114379883, -2.317652702331543], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7723.0, "diff_num_grad_updates_vs_sampler_policy": 7722.0}}, "num_env_steps_sampled": 55055, "num_env_steps_trained": 247136, "num_agent_steps_sampled": 55055, "num_agent_steps_trained": 247136, "last_target_update_ts": 54929, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": 59.54100000000006, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 27.239199999999997, "episode_len_mean": 52.92, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371], "episode_lengths": [53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8517099401388766, "mean_inference_ms": 3.3380060006585683, "mean_action_processing_ms": 0.5183347605594544, "mean_env_wait_ms": 0.13389907438414272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021148681640625, "StateBufferConnector_ms": 0.012940645217895508, "ViewRequirementAgentConnector_ms": 0.4475827217102051}}, "episode_reward_max": 59.54100000000006, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 27.239199999999997, "episode_len_mean": 52.92, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.557333333333325, 25.045666666666683, 17.618666666666666, 24.179000000000006, 33.37433333333335, 42.61733333333332, 20.749999999999993, 20.853666666666662, 14.422999999999998, 20.986999999999995, 55.91466666666665, 29.25566666666667, 18.864999999999995, 42.06566666666667, 20.409999999999993, 15.62233333333333, 16.952333333333335, 33.962999999999994, 18.934, 14.562333333333333, 14.361999999999998, 15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371], "episode_lengths": [53, 53, 37, 49, 56, 85, 43, 46, 29, 40, 94, 61, 43, 76, 40, 33, 35, 62, 36, 28, 31, 26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8517099401388766, "mean_inference_ms": 3.3380060006585683, "mean_action_processing_ms": 0.5183347605594544, "mean_env_wait_ms": 0.13389907438414272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021148681640625, "StateBufferConnector_ms": 0.012940645217895508, "ViewRequirementAgentConnector_ms": 0.4475827217102051}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55055, "num_agent_steps_trained": 247136, "num_env_steps_sampled": 55055, "num_env_steps_trained": 247136, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 49.916487239897364, "num_env_steps_trained_throughput_per_sec": 228.18965595381653, "timesteps_total": 55055, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 55055, "timers": {"training_iteration_time_ms": 105.435, "sample_time_ms": 40.745, "load_time_ms": 0.3, "load_throughput": 106818.725, "learn_time_ms": 7.653, "learn_throughput": 4181.485, "synch_weights_time_ms": 23.045}, "counters": {"num_env_steps_sampled": 55055, "num_env_steps_trained": 247136, "num_agent_steps_sampled": 55055, "num_agent_steps_trained": 247136, "last_target_update_ts": 54929, "num_target_updates": 108}, "done": false, "episodes_total": 1393, "training_iteration": 55, "trial_id": "408f7_00000", "date": "2023-12-07_23-58-02", "timestamp": 1702022282, "time_this_iter_s": 20.077645540237427, "time_total_s": 882.7995100021362, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 882.7995100021362, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 92.94074074074075, "ram_util_percent": 90.86296296296297}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 12.978188514709473, "min_q": 1.5790635347366333, "max_q": 22.3901309967041, "mean_td_error": -1.3801451921463013, "model": {}}, "td_error": [2.5782039165496826, -0.8907089233398438, -2.9622631072998047, 0.6300506591796875, -4.883734226226807, -2.9789915084838867, -0.9876651763916016, 0.6389427185058594, -2.3425979614257812, -2.587106704711914, -2.7879161834716797, 1.3798742294311523, -2.684518814086914, -1.9850842952728271, -0.6825675964355469, -4.577959060668945, 0.6316277980804443, -3.9112727642059326, -0.2270526885986328, -1.9351024627685547, -3.718303680419922, -4.878596782684326, -4.476499557495117, -0.22249794006347656, -1.1475595235824585, 0.6701507568359375, 0.4251422882080078, -0.422760009765625, -2.2946958541870117, -0.6769638061523438, 1.7688846588134766, 1.3748960494995117], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7866.0, "diff_num_grad_updates_vs_sampler_policy": 7865.0}}, "num_env_steps_sampled": 56056, "num_env_steps_trained": 251712, "num_agent_steps_sampled": 56056, "num_agent_steps_trained": 251712, "last_target_update_ts": 55937, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": 59.54100000000006, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 27.170790000000007, "episode_len_mean": 52.73, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666], "episode_lengths": [26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8524653347946405, "mean_inference_ms": 3.3292455344391403, "mean_action_processing_ms": 0.5168143514442568, "mean_env_wait_ms": 0.1338833242787888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022454023361206055, "StateBufferConnector_ms": 0.01287698745727539, "ViewRequirementAgentConnector_ms": 0.4353365898132324}}, "episode_reward_max": 59.54100000000006, "episode_reward_min": 12.56733333333333, "episode_reward_mean": 27.170790000000007, "episode_len_mean": 52.73, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.093999999999994, 20.807666666666673, 44.004666666666694, 40.32033333333334, 18.434999999999995, 20.826999999999998, 29.309999999999995, 34.69699999999998, 44.31266666666666, 51.82200000000001, 24.522999999999993, 18.365333333333332, 36.77033333333333, 12.56733333333333, 25.583999999999996, 20.036666666666665, 21.741999999999997, 16.044666666666664, 30.88466666666668, 21.97366666666666, 35.05833333333331, 40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666], "episode_lengths": [26, 36, 82, 81, 38, 42, 47, 59, 87, 78, 48, 39, 70, 26, 47, 47, 42, 33, 67, 50, 64, 82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8524653347946405, "mean_inference_ms": 3.3292455344391403, "mean_action_processing_ms": 0.5168143514442568, "mean_env_wait_ms": 0.1338833242787888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022454023361206055, "StateBufferConnector_ms": 0.01287698745727539, "ViewRequirementAgentConnector_ms": 0.4353365898132324}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56056, "num_agent_steps_trained": 251712, "num_env_steps_sampled": 56056, "num_env_steps_trained": 251712, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 58.225892924280124, "num_env_steps_trained_throughput_per_sec": 266.17551051099485, "timesteps_total": 56056, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 56056, "timers": {"training_iteration_time_ms": 118.309, "sample_time_ms": 45.028, "load_time_ms": 0.287, "load_throughput": 111671.294, "learn_time_ms": 6.661, "learn_throughput": 4804.18, "synch_weights_time_ms": 22.698}, "counters": {"num_env_steps_sampled": 56056, "num_env_steps_trained": 251712, "num_agent_steps_sampled": 56056, "num_agent_steps_trained": 251712, "last_target_update_ts": 55937, "num_target_updates": 110}, "done": false, "episodes_total": 1414, "training_iteration": 56, "trial_id": "408f7_00000", "date": "2023-12-07_23-58-19", "timestamp": 1702022299, "time_this_iter_s": 17.223515272140503, "time_total_s": 900.0230252742767, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 900.0230252742767, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 92.0625, "ram_util_percent": 86.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.6298828125, "min_q": 3.9608166217803955, "max_q": 22.345584869384766, "mean_td_error": -0.08969467133283615, "model": {}}, "td_error": [-1.0831642150878906, 3.178213119506836, 2.045816421508789, -0.4711017608642578, 0.8671979904174805, 1.3864667415618896, -3.4302711486816406, 0.33129119873046875, -2.3524608612060547, -0.43108177185058594, 0.255401611328125, -0.5021228790283203, -0.6368618011474609, 0.03599262237548828, -2.1673526763916016, 3.1395578384399414, 2.773505210876465, -2.8267030715942383, -3.155374526977539, -0.3711814880371094, -1.1837348937988281, 1.8620271682739258, -0.4725489616394043, -2.3582630157470703, 2.280919075012207, 0.6169605255126953, -2.3937511444091797, -0.5214347839355469, 3.999842882156372, -2.5923233032226562, 1.9099512100219727, -0.6036405563354492], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8009.0, "diff_num_grad_updates_vs_sampler_policy": 8008.0}}, "num_env_steps_sampled": 57057, "num_env_steps_trained": 256288, "num_agent_steps_sampled": 57057, "num_agent_steps_trained": 256288, "last_target_update_ts": 56945, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": 59.54100000000006, "episode_reward_min": 13.496666666666664, "episode_reward_mean": 26.67824333333333, "episode_len_mean": 52.24, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333], "episode_lengths": [82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.849048273163765, "mean_inference_ms": 3.367506932031812, "mean_action_processing_ms": 0.5182361438503184, "mean_env_wait_ms": 0.13408149409545553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03452444076538086, "StateBufferConnector_ms": 0.01485300064086914, "ViewRequirementAgentConnector_ms": 0.465512752532959}}, "episode_reward_max": 59.54100000000006, "episode_reward_min": 13.496666666666664, "episode_reward_mean": 26.67824333333333, "episode_len_mean": 52.24, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.89366666666666, 32.053, 21.84466666666666, 50.823333333333345, 19.18099999999999, 15.701666666666657, 30.73633333333331, 27.883333333333322, 32.69533333333333, 20.188000000000002, 29.73, 35.55733333333332, 23.78866666666666, 17.71533333333333, 23.655, 25.095333333333333, 18.44633333333333, 47.800333333333356, 23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333], "episode_lengths": [82, 58, 46, 89, 44, 32, 62, 47, 69, 39, 60, 61, 49, 37, 50, 49, 43, 75, 46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.849048273163765, "mean_inference_ms": 3.367506932031812, "mean_action_processing_ms": 0.5182361438503184, "mean_env_wait_ms": 0.13408149409545553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03452444076538086, "StateBufferConnector_ms": 0.01485300064086914, "ViewRequirementAgentConnector_ms": 0.465512752532959}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57057, "num_agent_steps_trained": 256288, "num_env_steps_sampled": 57057, "num_env_steps_trained": 256288, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 57.14571569950719, "num_env_steps_trained_throughput_per_sec": 261.23755748346144, "timesteps_total": 57057, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 57057, "timers": {"training_iteration_time_ms": 117.082, "sample_time_ms": 44.728, "load_time_ms": 0.276, "load_throughput": 116045.07, "learn_time_ms": 6.947, "learn_throughput": 4606.262, "synch_weights_time_ms": 22.914}, "counters": {"num_env_steps_sampled": 57057, "num_env_steps_trained": 256288, "num_agent_steps_sampled": 57057, "num_agent_steps_trained": 256288, "last_target_update_ts": 56945, "num_target_updates": 112}, "done": false, "episodes_total": 1435, "training_iteration": 57, "trial_id": "408f7_00000", "date": "2023-12-07_23-58-37", "timestamp": 1702022317, "time_this_iter_s": 17.54338550567627, "time_total_s": 917.566410779953, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 917.566410779953, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 92.72399999999999, "ram_util_percent": 86.96800000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.137462615966797, "min_q": 6.585574150085449, "max_q": 22.8365421295166, "mean_td_error": -0.553758978843689, "model": {}}, "td_error": [-2.513204574584961, -0.5773868560791016, -2.1355671882629395, 1.6138839721679688, 0.7974586486816406, -1.7191963195800781, -1.8370342254638672, -0.08501911163330078, -2.091020107269287, -0.8418607711791992, 1.2366886138916016, -1.231719970703125, -0.9083309173583984, -2.4446887969970703, 0.11166954040527344, -1.8792304992675781, -0.570037841796875, 1.6739845275878906, 1.1865825653076172, 1.34564208984375, -0.8393974304199219, -2.655885696411133, -1.0675163269042969, -1.3216257095336914, 0.07590293884277344, -2.7031688690185547, 5.938785552978516, 1.9028997421264648, -2.220735549926758, -0.2605743408203125, -0.6399102210998535, -3.0606746673583984], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8152.0, "diff_num_grad_updates_vs_sampler_policy": 8151.0}}, "num_env_steps_sampled": 58058, "num_env_steps_trained": 260864, "num_agent_steps_sampled": 58058, "num_agent_steps_trained": 260864, "last_target_update_ts": 57953, "num_target_updates": 114}, "sampler_results": {"episode_reward_max": 59.54100000000006, "episode_reward_min": 13.496666666666664, "episode_reward_mean": 25.651123333333334, "episode_len_mean": 50.61, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666], "episode_lengths": [46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8533442007474132, "mean_inference_ms": 3.3512604165566313, "mean_action_processing_ms": 0.516905708566798, "mean_env_wait_ms": 0.1338369916988212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03453540802001953, "StateBufferConnector_ms": 0.018047332763671875, "ViewRequirementAgentConnector_ms": 0.4736368656158447}}, "episode_reward_max": 59.54100000000006, "episode_reward_min": 13.496666666666664, "episode_reward_mean": 25.651123333333334, "episode_len_mean": 50.61, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.657333333333337, 17.704999999999995, 44.690666666666694, 22.84899999999999, 36.278333333333336, 21.56533333333334, 13.864999999999997, 21.544333333333327, 31.71900000000001, 14.011000000000005, 20.55799999999999, 20.89533333333333, 45.672000000000004, 30.878000000000004, 39.97233333333334, 59.54100000000006, 25.206666666666667, 33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666], "episode_lengths": [46, 36, 87, 53, 67, 51, 29, 56, 66, 29, 43, 42, 86, 64, 72, 103, 55, 73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8533442007474132, "mean_inference_ms": 3.3512604165566313, "mean_action_processing_ms": 0.516905708566798, "mean_env_wait_ms": 0.1338369916988212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03453540802001953, "StateBufferConnector_ms": 0.018047332763671875, "ViewRequirementAgentConnector_ms": 0.4736368656158447}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58058, "num_agent_steps_trained": 260864, "num_env_steps_sampled": 58058, "num_env_steps_trained": 260864, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 40.43934750390543, "num_env_steps_trained_throughput_per_sec": 184.86558858928197, "timesteps_total": 58058, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 58058, "timers": {"training_iteration_time_ms": 184.036, "sample_time_ms": 80.273, "load_time_ms": 0.648, "load_throughput": 49375.613, "learn_time_ms": 8.94, "learn_throughput": 3579.321, "synch_weights_time_ms": 27.24}, "counters": {"num_env_steps_sampled": 58058, "num_env_steps_trained": 260864, "num_agent_steps_sampled": 58058, "num_agent_steps_trained": 260864, "last_target_update_ts": 57953, "num_target_updates": 114}, "done": false, "episodes_total": 1453, "training_iteration": 58, "trial_id": "408f7_00000", "date": "2023-12-07_23-59-02", "timestamp": 1702022342, "time_this_iter_s": 24.801061868667603, "time_total_s": 942.3674726486206, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 942.3674726486206, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 95.71470588235294, "ram_util_percent": 91.26764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.911858558654785, "min_q": 3.956770658493042, "max_q": 22.9219913482666, "mean_td_error": 0.7469820976257324, "model": {}}, "td_error": [1.9689321517944336, 0.5529918670654297, 3.5828399658203125, 9.388923645019531, 3.216069221496582, 0.3035163879394531, -0.5432891845703125, -2.239255905151367, 0.42606544494628906, 3.0361039638519287, 3.3487801551818848, -0.9110536575317383, -2.0354127883911133, -0.8769416809082031, 1.738790512084961, -1.605978012084961, -0.5976371765136719, -0.6221923828125, 0.5963077545166016, 5.090804576873779, 0.6077327728271484, -0.4756793975830078, 1.7769436836242676, -0.4665031433105469, -1.1814332008361816, -2.0230712890625, 2.6344356536865234, -1.6301822662353516, -0.10376930236816406, -1.825617790222168, 1.0437841415405273, 1.7284212112426758], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8295.0, "diff_num_grad_updates_vs_sampler_policy": 8294.0}}, "num_env_steps_sampled": 59059, "num_env_steps_trained": 265440, "num_agent_steps_sampled": 59059, "num_agent_steps_trained": 265440, "last_target_update_ts": 58961, "num_target_updates": 116}, "sampler_results": {"episode_reward_max": 60.56333333333333, "episode_reward_min": 13.496666666666664, "episode_reward_mean": 25.65696333333333, "episode_len_mean": 50.5, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663], "episode_lengths": [73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8544694302016183, "mean_inference_ms": 3.3509631935665123, "mean_action_processing_ms": 0.517242860334092, "mean_env_wait_ms": 0.13369839887139526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029880285263061523, "StateBufferConnector_ms": 0.0193636417388916, "ViewRequirementAgentConnector_ms": 0.45854759216308594}}, "episode_reward_max": 60.56333333333333, "episode_reward_min": 13.496666666666664, "episode_reward_mean": 25.65696333333333, "episode_len_mean": 50.5, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.015666666666675, 27.72233333333334, 26.38266666666665, 16.23499999999999, 31.001333333333328, 16.339999999999996, 33.05, 20.15399999999999, 25.671333333333305, 20.25033333333333, 23.32233333333332, 55.53533333333332, 52.37233333333336, 28.973333333333326, 34.94533333333332, 19.12600000000001, 17.546333333333333, 26.80433333333332, 17.88399999999999, 13.496666666666664, 19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663], "episode_lengths": [73, 49, 47, 32, 54, 32, 58, 47, 48, 38, 54, 95, 93, 51, 60, 48, 46, 52, 33, 27, 35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8544694302016183, "mean_inference_ms": 3.3509631935665123, "mean_action_processing_ms": 0.517242860334092, "mean_env_wait_ms": 0.13369839887139526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029880285263061523, "StateBufferConnector_ms": 0.0193636417388916, "ViewRequirementAgentConnector_ms": 0.45854759216308594}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59059, "num_agent_steps_trained": 265440, "num_env_steps_sampled": 59059, "num_env_steps_trained": 265440, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 51.93122326695877, "num_env_steps_trained_throughput_per_sec": 237.39987779181152, "timesteps_total": 59059, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 59059, "timers": {"training_iteration_time_ms": 143.988, "sample_time_ms": 61.963, "load_time_ms": 0.669, "load_throughput": 47815.364, "learn_time_ms": 7.012, "learn_throughput": 4563.568, "synch_weights_time_ms": 23.628}, "counters": {"num_env_steps_sampled": 59059, "num_env_steps_trained": 265440, "num_agent_steps_sampled": 59059, "num_agent_steps_trained": 265440, "last_target_update_ts": 58961, "num_target_updates": 116}, "done": false, "episodes_total": 1470, "training_iteration": 59, "trial_id": "408f7_00000", "date": "2023-12-07_23-59-21", "timestamp": 1702022361, "time_this_iter_s": 19.30666947364807, "time_total_s": 961.6741421222687, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 961.6741421222687, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 93.4, "ram_util_percent": 94.58461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 13.074036598205566, "min_q": 3.376105308532715, "max_q": 22.334922790527344, "mean_td_error": -0.08204837888479233, "model": {}}, "td_error": [2.4577720165252686, 1.952505111694336, -0.4461078643798828, -2.17685604095459, -0.9692611694335938, -0.19239044189453125, -2.538311004638672, -0.290771484375, -1.7289714813232422, -1.7679004669189453, -2.946552276611328, 0.9226560592651367, -0.6737856864929199, 2.9660263061523438, 1.2129440307617188, 1.6530942916870117, -3.040884017944336, -2.556699752807617, 1.6363592147827148, 1.3599109649658203, -0.050022125244140625, -2.9358973503112793, 3.7086191177368164, 1.525411605834961, 1.1921768188476562, -1.8237628936767578, 2.2327451705932617, -1.4261627197265625, -0.6785259246826172, 0.8015446662902832, -2.286235809326172, 2.281785011291504], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8438.0, "diff_num_grad_updates_vs_sampler_policy": 8437.0}}, "num_env_steps_sampled": 60060, "num_env_steps_trained": 270016, "num_agent_steps_sampled": 60060, "num_agent_steps_trained": 270016, "last_target_update_ts": 59969, "num_target_updates": 118}, "sampler_results": {"episode_reward_max": 60.56333333333333, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 26.084600000000002, "episode_len_mean": 51.33, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667], "episode_lengths": [35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8523321506214017, "mean_inference_ms": 3.354163539369937, "mean_action_processing_ms": 0.5176883154302692, "mean_env_wait_ms": 0.13395194401154492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026270151138305664, "StateBufferConnector_ms": 0.01844310760498047, "ViewRequirementAgentConnector_ms": 0.4415614604949951}}, "episode_reward_max": 60.56333333333333, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 26.084600000000002, "episode_len_mean": 51.33, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.121000000000006, 20.708999999999996, 29.371, 26.60433333333333, 28.34866666666666, 36.66299999999999, 29.90699999999999, 28.77566666666667, 16.62333333333333, 16.864666666666665, 17.252333333333326, 30.578000000000014, 20.629000000000005, 19.261333333333333, 14.951999999999998, 39.60666666666666, 37.15933333333333, 16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667], "episode_lengths": [35, 48, 56, 56, 61, 54, 56, 55, 37, 39, 36, 48, 51, 35, 33, 65, 75, 36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8523321506214017, "mean_inference_ms": 3.354163539369937, "mean_action_processing_ms": 0.5176883154302692, "mean_env_wait_ms": 0.13395194401154492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026270151138305664, "StateBufferConnector_ms": 0.01844310760498047, "ViewRequirementAgentConnector_ms": 0.4415614604949951}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60060, "num_agent_steps_trained": 270016, "num_env_steps_sampled": 60060, "num_env_steps_trained": 270016, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 50.20583688739422, "num_env_steps_trained_throughput_per_sec": 229.51239719951644, "timesteps_total": 60060, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 60060, "timers": {"training_iteration_time_ms": 140.92, "sample_time_ms": 54.817, "load_time_ms": 1.024, "load_throughput": 31249.034, "learn_time_ms": 5.847, "learn_throughput": 5473.047, "synch_weights_time_ms": 27.673}, "counters": {"num_env_steps_sampled": 60060, "num_env_steps_trained": 270016, "num_agent_steps_sampled": 60060, "num_agent_steps_trained": 270016, "last_target_update_ts": 59969, "num_target_updates": 118}, "done": false, "episodes_total": 1490, "training_iteration": 60, "trial_id": "408f7_00000", "date": "2023-12-07_23-59-42", "timestamp": 1702022382, "time_this_iter_s": 19.97477626800537, "time_total_s": 981.648918390274, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 981.648918390274, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 95.28928571428571, "ram_util_percent": 94.01785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.344423294067383, "min_q": 8.607983589172363, "max_q": 22.36266326904297, "mean_td_error": 0.26142430305480957, "model": {}}, "td_error": [-0.2214508056640625, 3.0103464126586914, 2.734180450439453, -2.8324756622314453, 2.471792221069336, -0.34853553771972656, -0.6523208618164062, 1.1544227600097656, -0.6030025482177734, -2.769533157348633, -2.101138114929199, -2.646007537841797, -1.1894721984863281, 1.6405253410339355, 1.0770492553710938, -1.8363990783691406, 2.0859527587890625, 2.116952896118164, -1.8736553192138672, -0.9520549774169922, 2.2187767028808594, 0.19235801696777344, 0.2268047332763672, -0.025691986083984375, -1.2752552032470703, 1.3659868240356445, -0.43923091888427734, -0.3381538391113281, 2.452533721923828, 2.6561851501464844, 1.8894681930541992, 1.176619529724121], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8581.0, "diff_num_grad_updates_vs_sampler_policy": 8580.0}}, "num_env_steps_sampled": 61061, "num_env_steps_trained": 274592, "num_agent_steps_sampled": 61061, "num_agent_steps_trained": 274592, "last_target_update_ts": 60977, "num_target_updates": 120}, "sampler_results": {"episode_reward_max": 60.56333333333333, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 26.999193333333324, "episode_len_mean": 52.8, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335], "episode_lengths": [36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8546758819108398, "mean_inference_ms": 3.351707379733783, "mean_action_processing_ms": 0.5187803629846437, "mean_env_wait_ms": 0.133972920078415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027073144912719727, "StateBufferConnector_ms": 0.01775527000427246, "ViewRequirementAgentConnector_ms": 0.44779324531555176}}, "episode_reward_max": 60.56333333333333, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 26.999193333333324, "episode_len_mean": 52.8, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.830999999999992, 36.13900000000002, 20.852333333333323, 27.08366666666667, 14.598666666666665, 18.290333333333333, 23.45166666666666, 35.19366666666666, 15.341999999999997, 22.56999999999999, 24.823000000000004, 31.267333333333337, 14.801666666666659, 15.945333333333334, 46.37533333333334, 21.70599999999999, 29.82766666666667, 18.05066666666666, 38.44833333333332, 17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335], "episode_lengths": [36, 67, 41, 52, 33, 38, 43, 72, 33, 41, 59, 65, 30, 31, 75, 44, 60, 33, 74, 37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8546758819108398, "mean_inference_ms": 3.351707379733783, "mean_action_processing_ms": 0.5187803629846437, "mean_env_wait_ms": 0.133972920078415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027073144912719727, "StateBufferConnector_ms": 0.01775527000427246, "ViewRequirementAgentConnector_ms": 0.44779324531555176}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61061, "num_agent_steps_trained": 274592, "num_env_steps_sampled": 61061, "num_env_steps_trained": 274592, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 49.54376532910207, "num_env_steps_trained_throughput_per_sec": 226.48578436160946, "timesteps_total": 61061, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 61061, "timers": {"training_iteration_time_ms": 127.164, "sample_time_ms": 48.053, "load_time_ms": 0.49, "load_throughput": 65335.018, "learn_time_ms": 5.494, "learn_throughput": 5824.942, "synch_weights_time_ms": 24.357}, "counters": {"num_env_steps_sampled": 61061, "num_env_steps_trained": 274592, "num_agent_steps_sampled": 61061, "num_agent_steps_trained": 274592, "last_target_update_ts": 60977, "num_target_updates": 120}, "done": false, "episodes_total": 1507, "training_iteration": 61, "trial_id": "408f7_00000", "date": "2023-12-08_00-00-02", "timestamp": 1702022402, "time_this_iter_s": 20.239142656326294, "time_total_s": 1001.8880610466003, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1001.8880610466003, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 96.77857142857142, "ram_util_percent": 93.55357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.725913047790527, "min_q": 3.789268732070923, "max_q": 23.33568000793457, "mean_td_error": -0.33257216215133667, "model": {}}, "td_error": [-2.3325395584106445, 1.782632827758789, -2.646402359008789, -0.6761207580566406, -1.2107975482940674, 3.5365872383117676, -0.5128278732299805, 0.2722911834716797, -0.7098026275634766, -1.874063491821289, -1.4484443664550781, 1.3575382232666016, -1.8732452392578125, 0.9367332458496094, -1.2573471069335938, -0.24938583374023438, -1.536454200744629, -2.246016502380371, -2.9546737670898438, -0.20158672332763672, 0.09511184692382812, -0.0915689468383789, 0.7274932861328125, -2.3310298919677734, 0.6826305389404297, 0.7456073760986328, -0.5733642578125, -0.8405990600585938, -0.15686607360839844, 4.863541603088379, -1.570535659790039, 1.6511945724487305], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8724.0, "diff_num_grad_updates_vs_sampler_policy": 8723.0}}, "num_env_steps_sampled": 62062, "num_env_steps_trained": 279168, "num_agent_steps_sampled": 62062, "num_agent_steps_trained": 279168, "last_target_update_ts": 61985, "num_target_updates": 122}, "sampler_results": {"episode_reward_max": 65.51866666666666, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 27.949779999999997, "episode_len_mean": 54.09, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364], "episode_lengths": [37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8542477244497877, "mean_inference_ms": 3.3443676518753898, "mean_action_processing_ms": 0.5189935041533859, "mean_env_wait_ms": 0.1336624481926458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019353628158569336, "StateBufferConnector_ms": 0.018310546875, "ViewRequirementAgentConnector_ms": 0.43711185455322266}}, "episode_reward_max": 65.51866666666666, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 27.949779999999997, "episode_len_mean": 54.09, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.94933333333332, 19.662000000000003, 35.87300000000001, 15.847999999999997, 29.54733333333334, 17.521999999999995, 28.689000000000014, 26.25866666666667, 28.22533333333333, 17.452999999999996, 26.27900000000001, 22.742, 18.27333333333333, 21.95833333333333, 39.120333333333356, 17.029999999999998, 25.868666666666662, 21.016333333333346, 16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364], "episode_lengths": [37, 42, 65, 35, 63, 35, 58, 55, 53, 34, 58, 49, 42, 52, 69, 34, 57, 46, 33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8542477244497877, "mean_inference_ms": 3.3443676518753898, "mean_action_processing_ms": 0.5189935041533859, "mean_env_wait_ms": 0.1336624481926458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019353628158569336, "StateBufferConnector_ms": 0.018310546875, "ViewRequirementAgentConnector_ms": 0.43711185455322266}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62062, "num_agent_steps_trained": 279168, "num_env_steps_sampled": 62062, "num_env_steps_trained": 279168, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 60.96649797737372, "num_env_steps_trained_throughput_per_sec": 278.7039907537084, "timesteps_total": 62062, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 62062, "timers": {"training_iteration_time_ms": 109.395, "sample_time_ms": 40.975, "load_time_ms": 0.366, "load_throughput": 87313.12, "learn_time_ms": 6.762, "learn_throughput": 4732.242, "synch_weights_time_ms": 21.943}, "counters": {"num_env_steps_sampled": 62062, "num_env_steps_trained": 279168, "num_agent_steps_sampled": 62062, "num_agent_steps_trained": 279168, "last_target_update_ts": 61985, "num_target_updates": 122}, "done": false, "episodes_total": 1526, "training_iteration": 62, "trial_id": "408f7_00000", "date": "2023-12-08_00-00-18", "timestamp": 1702022418, "time_this_iter_s": 16.452847242355347, "time_total_s": 1018.3409082889557, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1018.3409082889557, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 93.35454545454546, "ram_util_percent": 95.2590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.119075775146484, "min_q": 2.0747644901275635, "max_q": 22.572933197021484, "mean_td_error": 0.016978606581687927, "model": {}}, "td_error": [1.2780895233154297, 2.6885623931884766, -0.0237884521484375, 2.0869312286376953, 1.5122928619384766, 0.6023178100585938, -0.9128551483154297, -0.5984096527099609, 1.7436552047729492, -1.5699710845947266, -0.6428146362304688, 1.0827645063400269, 0.5214347839355469, -0.3884773254394531, -3.0879650115966797, 2.09780216217041, -1.6908035278320312, -0.6573896408081055, -0.18320465087890625, -2.2052836418151855, 2.2816648483276367, 0.18520641326904297, -0.776031494140625, 0.5177383422851562, 0.6371212005615234, -0.3162040710449219, -1.2513132095336914, 0.3323020935058594, -0.6590862274169922, -0.3546161651611328, -0.6606693267822266, -1.045684814453125], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8867.0, "diff_num_grad_updates_vs_sampler_policy": 8866.0}}, "num_env_steps_sampled": 63063, "num_env_steps_trained": 283744, "num_agent_steps_sampled": 63063, "num_agent_steps_trained": 283744, "last_target_update_ts": 62993, "num_target_updates": 124}, "sampler_results": {"episode_reward_max": 65.51866666666666, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 28.956709999999998, "episode_len_mean": 55.27, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667], "episode_lengths": [33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.855385938608777, "mean_inference_ms": 3.329065676574188, "mean_action_processing_ms": 0.517769180952978, "mean_env_wait_ms": 0.13357308878606275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021174907684326172, "StateBufferConnector_ms": 0.015520811080932617, "ViewRequirementAgentConnector_ms": 0.4167962074279785}}, "episode_reward_max": 65.51866666666666, "episode_reward_min": 13.684666666666661, "episode_reward_mean": 28.956709999999998, "episode_len_mean": 55.27, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.623999999999995, 20.295666666666662, 20.462999999999994, 25.085333333333338, 21.293999999999993, 24.775333333333332, 22.311666666666657, 22.547, 27.93966666666666, 58.01466666666671, 16.787333333333326, 21.611999999999995, 60.56333333333333, 17.39866666666666, 37.84000000000002, 13.684666666666661, 19.280333333333328, 56.303999999999995, 21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667], "episode_lengths": [33, 42, 46, 45, 39, 46, 42, 50, 45, 115, 33, 42, 105, 41, 80, 30, 42, 109, 37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.855385938608777, "mean_inference_ms": 3.329065676574188, "mean_action_processing_ms": 0.517769180952978, "mean_env_wait_ms": 0.13357308878606275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021174907684326172, "StateBufferConnector_ms": 0.015520811080932617, "ViewRequirementAgentConnector_ms": 0.4167962074279785}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63063, "num_agent_steps_trained": 283744, "num_env_steps_sampled": 63063, "num_env_steps_trained": 283744, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 63.02575985514022, "num_env_steps_trained_throughput_per_sec": 288.11775933778387, "timesteps_total": 63063, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 63063, "timers": {"training_iteration_time_ms": 135.39, "sample_time_ms": 62.116, "load_time_ms": 0.739, "load_throughput": 43305.82, "learn_time_ms": 7.094, "learn_throughput": 4511.172, "synch_weights_time_ms": 21.564}, "counters": {"num_env_steps_sampled": 63063, "num_env_steps_trained": 283744, "num_agent_steps_sampled": 63063, "num_agent_steps_trained": 283744, "last_target_update_ts": 62993, "num_target_updates": 124}, "done": false, "episodes_total": 1544, "training_iteration": 63, "trial_id": "408f7_00000", "date": "2023-12-08_00-00-34", "timestamp": 1702022434, "time_this_iter_s": 15.931421041488647, "time_total_s": 1034.2723293304443, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1034.2723293304443, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 91.84545454545456, "ram_util_percent": 96.50454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.772892951965332, "min_q": 2.5878243446350098, "max_q": 22.958581924438477, "mean_td_error": -0.11592452228069305, "model": {}}, "td_error": [0.3182868957519531, -2.8451480865478516, -1.6559619903564453, 0.036167144775390625, -2.8924474716186523, -2.7042465209960938, -0.28442955017089844, -1.3997745513916016, -0.3022899627685547, 0.49214744567871094, 6.520668029785156, 0.0689239501953125, 1.2122249603271484, -1.3940553665161133, -1.5734186172485352, 0.8268222808837891, 2.9177541732788086, 0.2804679870605469, -0.1339702606201172, 1.6071577072143555, -1.35833740234375, -0.9153366088867188, -0.8342018127441406, -1.1142005920410156, -0.11821556091308594, 0.30975866317749023, -0.10794639587402344, 0.27481651306152344, 1.3592987060546875, -0.09438514709472656, 0.4414653778076172, -0.6471786499023438], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9010.0, "diff_num_grad_updates_vs_sampler_policy": 9009.0}}, "num_env_steps_sampled": 64064, "num_env_steps_trained": 288320, "num_agent_steps_sampled": 64064, "num_agent_steps_trained": 288320, "last_target_update_ts": 64001, "num_target_updates": 126}, "sampler_results": {"episode_reward_max": 65.51866666666666, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 29.006760000000003, "episode_len_mean": 54.9, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664], "episode_lengths": [37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8550539752446356, "mean_inference_ms": 3.3397011199495465, "mean_action_processing_ms": 0.5174007530236703, "mean_env_wait_ms": 0.13360487038643837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026383161544799805, "StateBufferConnector_ms": 0.013434171676635742, "ViewRequirementAgentConnector_ms": 0.4095609188079834}}, "episode_reward_max": 65.51866666666666, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 29.006760000000003, "episode_len_mean": 54.9, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.90566666666666, 20.581333333333333, 31.97566666666667, 15.943333333333326, 19.337333333333333, 20.089666666666663, 42.18266666666666, 17.691666666666663, 34.23100000000002, 58.863333333333344, 28.99033333333333, 39.49066666666668, 26.898999999999994, 14.459666666666665, 17.936333333333327, 20.34766666666667, 20.150666666666666, 16.427999999999997, 17.369, 37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664], "episode_lengths": [37, 43, 67, 34, 39, 46, 71, 40, 78, 104, 50, 68, 57, 30, 34, 50, 40, 30, 35, 61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8550539752446356, "mean_inference_ms": 3.3397011199495465, "mean_action_processing_ms": 0.5174007530236703, "mean_env_wait_ms": 0.13360487038643837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026383161544799805, "StateBufferConnector_ms": 0.013434171676635742, "ViewRequirementAgentConnector_ms": 0.4095609188079834}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64064, "num_agent_steps_trained": 288320, "num_env_steps_sampled": 64064, "num_env_steps_trained": 288320, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 52.87575929513971, "num_env_steps_trained_throughput_per_sec": 241.71775677778155, "timesteps_total": 64064, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 64064, "timers": {"training_iteration_time_ms": 134.638, "sample_time_ms": 53.449, "load_time_ms": 0.542, "load_throughput": 59069.504, "learn_time_ms": 6.784, "learn_throughput": 4716.775, "synch_weights_time_ms": 24.661}, "counters": {"num_env_steps_sampled": 64064, "num_env_steps_trained": 288320, "num_agent_steps_sampled": 64064, "num_agent_steps_trained": 288320, "last_target_update_ts": 64001, "num_target_updates": 126}, "done": false, "episodes_total": 1562, "training_iteration": 64, "trial_id": "408f7_00000", "date": "2023-12-08_00-00-54", "timestamp": 1702022454, "time_this_iter_s": 18.95440936088562, "time_total_s": 1053.22673869133, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1053.22673869133, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 96.47692307692309, "ram_util_percent": 97.00384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.46548843383789, "min_q": 2.975079298019409, "max_q": 22.569921493530273, "mean_td_error": 0.5559899806976318, "model": {}}, "td_error": [8.184260368347168, -0.7333164215087891, 4.153042793273926, -2.203436851501465, -0.21407318115234375, -1.0261898040771484, -0.6145420074462891, 0.116973876953125, 2.122529983520508, 1.7797794342041016, -0.5640163421630859, 1.014230728149414, 0.7679462432861328, 2.9413909912109375, -0.9151973724365234, 0.666900634765625, -0.5339221954345703, 2.3622512817382812, -0.0688934326171875, -0.13991546630859375, -0.27628517150878906, 3.044062614440918, -0.0979928970336914, -1.1864395141601562, -0.8731937408447266, 2.734158515930176, -1.0710456371307373, -1.0820426940917969, 0.6959991455078125, 0.7430801391601562, -0.5826187133789062, -1.3518047332763672], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9153.0, "diff_num_grad_updates_vs_sampler_policy": 9152.0}}, "num_env_steps_sampled": 65065, "num_env_steps_trained": 292896, "num_agent_steps_sampled": 65065, "num_agent_steps_trained": 292896, "last_target_update_ts": 65009, "num_target_updates": 128}, "sampler_results": {"episode_reward_max": 65.51866666666666, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 29.455663333333334, "episode_len_mean": 55.57, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325], "episode_lengths": [61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8588253723181554, "mean_inference_ms": 3.3343344539383097, "mean_action_processing_ms": 0.516410536428051, "mean_env_wait_ms": 0.1330734166435711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03201580047607422, "StateBufferConnector_ms": 0.014162540435791016, "ViewRequirementAgentConnector_ms": 0.42900705337524414}}, "episode_reward_max": 65.51866666666666, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 29.455663333333334, "episode_len_mean": 55.57, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.32933333333333, 15.988, 17.019666666666666, 34.00233333333333, 17.02033333333333, 48.12566666666668, 51.64666666666665, 24.336999999999996, 41.95766666666667, 40.431666666666665, 30.91066666666666, 39.92466666666663, 58.33566666666664, 20.855333333333327, 19.078999999999997, 31.672666666666657, 20.568666666666665, 31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325], "episode_lengths": [61, 30, 38, 74, 33, 83, 92, 56, 77, 72, 55, 72, 91, 37, 38, 69, 39, 53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8588253723181554, "mean_inference_ms": 3.3343344539383097, "mean_action_processing_ms": 0.516410536428051, "mean_env_wait_ms": 0.1330734166435711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03201580047607422, "StateBufferConnector_ms": 0.014162540435791016, "ViewRequirementAgentConnector_ms": 0.42900705337524414}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65065, "num_agent_steps_trained": 292896, "num_env_steps_sampled": 65065, "num_env_steps_trained": 292896, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 59.20951707522214, "num_env_steps_trained_throughput_per_sec": 270.6720780581583, "timesteps_total": 65065, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 65065, "timers": {"training_iteration_time_ms": 101.732, "sample_time_ms": 38.799, "load_time_ms": 0.162, "load_throughput": 197233.987, "learn_time_ms": 6.344, "learn_throughput": 5044.49, "synch_weights_time_ms": 24.958}, "counters": {"num_env_steps_sampled": 65065, "num_env_steps_trained": 292896, "num_agent_steps_sampled": 65065, "num_agent_steps_trained": 292896, "last_target_update_ts": 65009, "num_target_updates": 128}, "done": false, "episodes_total": 1581, "training_iteration": 65, "trial_id": "408f7_00000", "date": "2023-12-08_00-01-11", "timestamp": 1702022471, "time_this_iter_s": 16.935037851333618, "time_total_s": 1070.1617765426636, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1070.1617765426636, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 83.24347826086957, "ram_util_percent": 96.76521739130435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.882549285888672, "min_q": 2.6828737258911133, "max_q": 23.4255428314209, "mean_td_error": 0.28045493364334106, "model": {}}, "td_error": [-1.6066551208496094, 0.6738338470458984, 1.0684318542480469, 0.6869468688964844, 0.7674350738525391, -1.3203411102294922, 1.7355403900146484, 0.028163909912109375, -3.9241180419921875, 0.41808366775512695, 0.39646148681640625, 2.030856132507324, -1.3310966491699219, 1.7889289855957031, 1.3018074035644531, -3.4622745513916016, 4.2584614753723145, -0.09058952331542969, 0.8118114471435547, -0.8616790771484375, 0.26840686798095703, -0.3046150207519531, 0.4513988494873047, 1.6262702941894531, 1.335205078125, -0.07909965515136719, -0.4101524353027344, 0.8076648712158203, 0.5526180267333984, -0.8826789855957031, 2.627094268798828, -0.38756370544433594], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9296.0, "diff_num_grad_updates_vs_sampler_policy": 9295.0}}, "num_env_steps_sampled": 66066, "num_env_steps_trained": 297472, "num_agent_steps_sampled": 66066, "num_agent_steps_trained": 297472, "last_target_update_ts": 66017, "num_target_updates": 130}, "sampler_results": {"episode_reward_max": 65.51866666666666, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 29.100160000000002, "episode_len_mean": 55.64, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325], "episode_lengths": [53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8594847432285335, "mean_inference_ms": 3.3551404763460795, "mean_action_processing_ms": 0.5177315371799741, "mean_env_wait_ms": 0.13346359809282335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034050703048706055, "StateBufferConnector_ms": 0.014946699142456055, "ViewRequirementAgentConnector_ms": 0.4472317695617676}}, "episode_reward_max": 65.51866666666666, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 29.100160000000002, "episode_len_mean": 55.64, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.34266666666666, 17.843, 32.92833333333333, 49.298333333333304, 17.148999999999997, 20.31366666666666, 16.552666666666664, 20.642333333333333, 56.03733333333335, 31.019000000000023, 29.957666666666675, 24.720999999999993, 35.80499999999999, 23.261999999999997, 18.04499999999999, 25.424000000000007, 32.786999999999985, 24.438000000000006, 65.51866666666666, 23.602999999999987, 30.125666666666646, 14.318333333333332, 51.47333333333334, 30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325], "episode_lengths": [53, 37, 62, 110, 38, 41, 36, 48, 89, 68, 56, 47, 72, 47, 36, 47, 54, 50, 99, 54, 50, 28, 94, 59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8594847432285335, "mean_inference_ms": 3.3551404763460795, "mean_action_processing_ms": 0.5177315371799741, "mean_env_wait_ms": 0.13346359809282335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034050703048706055, "StateBufferConnector_ms": 0.014946699142456055, "ViewRequirementAgentConnector_ms": 0.4472317695617676}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66066, "num_agent_steps_trained": 297472, "num_env_steps_sampled": 66066, "num_env_steps_trained": 297472, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 76.84522422982421, "num_env_steps_trained_throughput_per_sec": 351.2924536220536, "timesteps_total": 66066, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 66066, "timers": {"training_iteration_time_ms": 96.064, "sample_time_ms": 33.79, "load_time_ms": 0.51, "load_throughput": 62721.495, "learn_time_ms": 6.405, "learn_throughput": 4995.933, "synch_weights_time_ms": 22.606}, "counters": {"num_env_steps_sampled": 66066, "num_env_steps_trained": 297472, "num_agent_steps_sampled": 66066, "num_agent_steps_trained": 297472, "last_target_update_ts": 66017, "num_target_updates": 130}, "done": false, "episodes_total": 1598, "training_iteration": 66, "trial_id": "408f7_00000", "date": "2023-12-08_00-01-24", "timestamp": 1702022484, "time_this_iter_s": 13.044175624847412, "time_total_s": 1083.205952167511, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1083.205952167511, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 69.6222222222222, "ram_util_percent": 90.20555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.410076141357422, "min_q": 4.048405647277832, "max_q": 22.550495147705078, "mean_td_error": 0.38594678044319153, "model": {}}, "td_error": [-1.7130680084228516, 1.6742973327636719, 7.95823335647583, -0.04217338562011719, 1.8030872344970703, -0.30332183837890625, 2.9575653076171875, 0.24932384490966797, -0.17169189453125, -0.105224609375, 1.3936767578125, 0.9256801605224609, -0.06845474243164062, -0.2532787322998047, 0.23813438415527344, -1.4150314331054688, 0.8407688140869141, 0.6093158721923828, 0.5239830017089844, 1.1871299743652344, 2.3383426666259766, 0.6351470947265625, 0.0021495819091796875, -1.1375579833984375, -0.34982872009277344, -0.16080284118652344, 0.47182655334472656, -0.09259223937988281, -3.313680648803711, -1.1427059173583984, -0.0907745361328125, -1.0981769561767578], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9439.0, "diff_num_grad_updates_vs_sampler_policy": 9438.0}}, "num_env_steps_sampled": 67067, "num_env_steps_trained": 302048, "num_agent_steps_sampled": 67067, "num_agent_steps_trained": 302048, "last_target_update_ts": 67025, "num_target_updates": 132}, "sampler_results": {"episode_reward_max": 63.3386666666667, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 27.747363333333332, "episode_len_mean": 52.9, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323], "episode_lengths": [59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.864272500812949, "mean_inference_ms": 3.3411071002601718, "mean_action_processing_ms": 0.5159367977856639, "mean_env_wait_ms": 0.1332815373335281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301668167114258, "StateBufferConnector_ms": 0.016458749771118164, "ViewRequirementAgentConnector_ms": 0.4707622528076172}}, "episode_reward_max": 63.3386666666667, "episode_reward_min": 13.72633333333333, "episode_reward_mean": 27.747363333333332, "episode_len_mean": 52.9, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.794, 13.72633333333333, 18.543333333333333, 16.383666666666667, 56.711333333333364, 38.827666666666666, 21.48066666666666, 42.62199999999999, 23.632333333333328, 40.28166666666669, 17.77366666666666, 20.163, 63.3386666666667, 29.46399999999999, 17.54566666666666, 44.25500000000003, 18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323], "episode_lengths": [59, 28, 37, 36, 94, 76, 43, 87, 44, 83, 37, 42, 107, 53, 34, 72, 41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.864272500812949, "mean_inference_ms": 3.3411071002601718, "mean_action_processing_ms": 0.5159367977856639, "mean_env_wait_ms": 0.1332815373335281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301668167114258, "StateBufferConnector_ms": 0.016458749771118164, "ViewRequirementAgentConnector_ms": 0.4707622528076172}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67067, "num_agent_steps_trained": 302048, "num_env_steps_sampled": 67067, "num_env_steps_trained": 302048, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 80.00734623424125, "num_env_steps_trained_throughput_per_sec": 365.7478684993886, "timesteps_total": 67067, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 67067, "timers": {"training_iteration_time_ms": 85.589, "sample_time_ms": 28.283, "load_time_ms": 0.2, "load_throughput": 160087.939, "learn_time_ms": 5.45, "learn_throughput": 5871.343, "synch_weights_time_ms": 22.89}, "counters": {"num_env_steps_sampled": 67067, "num_env_steps_trained": 302048, "num_agent_steps_sampled": 67067, "num_agent_steps_trained": 302048, "last_target_update_ts": 67025, "num_target_updates": 132}, "done": false, "episodes_total": 1621, "training_iteration": 67, "trial_id": "408f7_00000", "date": "2023-12-08_00-01-36", "timestamp": 1702022496, "time_this_iter_s": 12.530343770980835, "time_total_s": 1095.7362959384918, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1095.7362959384918, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 68.03333333333333, "ram_util_percent": 92.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.427873611450195, "min_q": 4.515981674194336, "max_q": 22.852886199951172, "mean_td_error": 0.7116011381149292, "model": {}}, "td_error": [-0.15473175048828125, 1.7344732284545898, 2.905533790588379, -0.7724971771240234, 0.46229076385498047, 0.4290132522583008, -0.4713859558105469, 3.113567352294922, 1.5079689025878906, 1.1356678009033203, -0.058300018310546875, 0.30293941497802734, -0.9161720275878906, -0.5259685516357422, 4.11760139465332, -0.2905597686767578, -0.18495559692382812, 0.018865585327148438, -1.32037353515625, 1.115407943725586, -1.3287773132324219, 0.5397510528564453, 9.395254135131836, 1.2963998317718506, 0.7133693695068359, -1.034027099609375, 2.0827531814575195, -1.3281002044677734, -1.2355923652648926, 2.0920846462249756, -0.16153717041015625, -0.4087257385253906], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9582.0, "diff_num_grad_updates_vs_sampler_policy": 9581.0}}, "num_env_steps_sampled": 68068, "num_env_steps_trained": 306624, "num_agent_steps_sampled": 68068, "num_agent_steps_trained": 306624, "last_target_update_ts": 68033, "num_target_updates": 134}, "sampler_results": {"episode_reward_max": 55.195666666666696, "episode_reward_min": 13.922, "episode_reward_mean": 26.860629999999997, "episode_len_mean": 51.43, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333], "episode_lengths": [41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.865586405598256, "mean_inference_ms": 3.3350170383568076, "mean_action_processing_ms": 0.5158471990037579, "mean_env_wait_ms": 0.1332715546401438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029725313186645508, "StateBufferConnector_ms": 0.012972354888916016, "ViewRequirementAgentConnector_ms": 0.4518575668334961}}, "episode_reward_max": 55.195666666666696, "episode_reward_min": 13.922, "episode_reward_mean": 26.860629999999997, "episode_len_mean": 51.43, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.387999999999998, 23.31699999999999, 37.87433333333333, 29.003666666666664, 16.534666666666663, 15.216999999999997, 30.28966666666667, 37.70099999999999, 47.66133333333333, 21.55266666666666, 31.626999999999995, 31.929666666666655, 15.917000000000002, 18.031666666666666, 30.812999999999985, 16.494999999999997, 24.044333333333316, 47.882666666666665, 34.06666666666667, 23.343, 24.837666666666653, 13.922, 16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333], "episode_lengths": [41, 50, 64, 50, 35, 30, 54, 69, 69, 50, 60, 59, 37, 40, 64, 36, 49, 81, 57, 47, 46, 29, 31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.865586405598256, "mean_inference_ms": 3.3350170383568076, "mean_action_processing_ms": 0.5158471990037579, "mean_env_wait_ms": 0.1332715546401438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029725313186645508, "StateBufferConnector_ms": 0.012972354888916016, "ViewRequirementAgentConnector_ms": 0.4518575668334961}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68068, "num_agent_steps_trained": 306624, "num_env_steps_sampled": 68068, "num_env_steps_trained": 306624, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 42.32011006680361, "num_env_steps_trained_throughput_per_sec": 193.46336030538794, "timesteps_total": 68068, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 68068, "timers": {"training_iteration_time_ms": 68.956, "sample_time_ms": 21.476, "load_time_ms": 0.101, "load_throughput": 316178.393, "learn_time_ms": 5.73, "learn_throughput": 5584.843, "synch_weights_time_ms": 19.944}, "counters": {"num_env_steps_sampled": 68068, "num_env_steps_trained": 306624, "num_agent_steps_sampled": 68068, "num_agent_steps_trained": 306624, "last_target_update_ts": 68033, "num_target_updates": 134}, "done": false, "episodes_total": 1637, "training_iteration": 68, "trial_id": "408f7_00000", "date": "2023-12-08_00-02-00", "timestamp": 1702022520, "time_this_iter_s": 23.66782259941101, "time_total_s": 1119.4041185379028, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1119.4041185379028, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 67.63125, "ram_util_percent": 94.51875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 18.239124298095703, "min_q": 5.948873519897461, "max_q": 22.193973541259766, "mean_td_error": -0.3654986023902893, "model": {}}, "td_error": [-0.9189910888671875, -0.054347991943359375, 0.9824295043945312, -0.18657302856445312, 0.5027446746826172, 1.0189666748046875, -0.8296375274658203, -2.918264389038086, 1.0153579711914062, 1.0875091552734375, 0.2689990997314453, 0.8825187683105469, -1.3887310028076172, -0.8428668975830078, -1.0849952697753906, -2.016582489013672, -0.3474845886230469, -1.011251449584961, -0.47480201721191406, 1.8734493255615234, -1.764404296875, -1.7940044403076172, -1.936685562133789, 1.802713394165039, -1.4608631134033203, -1.8049659729003906, -2.893918991088867, 0.24556922912597656, -1.2799263000488281, -0.0064411163330078125, 5.928948879241943, -2.2894248962402344], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9725.0, "diff_num_grad_updates_vs_sampler_policy": 9724.0}}, "num_env_steps_sampled": 69069, "num_env_steps_trained": 311200, "num_agent_steps_sampled": 69069, "num_agent_steps_trained": 311200, "last_target_update_ts": 69041, "num_target_updates": 136}, "sampler_results": {"episode_reward_max": 57.09666666666665, "episode_reward_min": 14.05299999999999, "episode_reward_mean": 27.15354666666666, "episode_len_mean": 52.05, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001], "episode_lengths": [31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8597696710886997, "mean_inference_ms": 3.3507961136279243, "mean_action_processing_ms": 0.5190969200539868, "mean_env_wait_ms": 0.13373270223914993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0243377685546875, "StateBufferConnector_ms": 0.010407447814941406, "ViewRequirementAgentConnector_ms": 0.45029211044311523}}, "episode_reward_max": 57.09666666666665, "episode_reward_min": 14.05299999999999, "episode_reward_mean": 27.15354666666666, "episode_len_mean": 52.05, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.45633333333333, 39.60699999999999, 31.93766666666664, 18.68199999999999, 36.780666666666676, 17.365666666666662, 21.747, 17.217999999999996, 24.93866666666666, 29.427666666666685, 27.556999999999984, 22.162666666666663, 55.195666666666696, 37.94300000000001, 50.99866666666671, 24.97066666666667, 22.17833333333333, 40.071000000000026, 16.103666666666665, 15.352999999999998, 33.08866666666666, 17.981333333333325, 26.702333333333332, 17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001], "episode_lengths": [31, 58, 66, 39, 58, 39, 48, 35, 44, 66, 48, 49, 92, 75, 77, 57, 48, 69, 36, 32, 67, 41, 54, 46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8597696710886997, "mean_inference_ms": 3.3507961136279243, "mean_action_processing_ms": 0.5190969200539868, "mean_env_wait_ms": 0.13373270223914993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0243377685546875, "StateBufferConnector_ms": 0.010407447814941406, "ViewRequirementAgentConnector_ms": 0.45029211044311523}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69069, "num_agent_steps_trained": 311200, "num_env_steps_sampled": 69069, "num_env_steps_trained": 311200, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 101.96194196426403, "num_env_steps_trained_throughput_per_sec": 466.11173469377843, "timesteps_total": 69069, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 69069, "timers": {"training_iteration_time_ms": 63.021, "sample_time_ms": 20.294, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 6.795, "learn_throughput": 4709.526, "synch_weights_time_ms": 17.23}, "counters": {"num_env_steps_sampled": 69069, "num_env_steps_trained": 311200, "num_agent_steps_sampled": 69069, "num_agent_steps_trained": 311200, "last_target_update_ts": 69041, "num_target_updates": 136}, "done": false, "episodes_total": 1659, "training_iteration": 69, "trial_id": "408f7_00000", "date": "2023-12-08_00-02-10", "timestamp": 1702022530, "time_this_iter_s": 9.833090782165527, "time_total_s": 1129.2372093200684, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1129.2372093200684, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 57.357142857142854, "ram_util_percent": 93.17142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.557296752929688, "min_q": 2.9600749015808105, "max_q": 22.196443557739258, "mean_td_error": -0.5599658489227295, "model": {}}, "td_error": [1.230234146118164, -0.1594676971435547, -0.18260955810546875, -0.654510498046875, 1.2221107482910156, -0.9200477600097656, -0.8443412780761719, -1.085205078125, -2.6802978515625, 0.9967765808105469, 0.09623527526855469, -1.2744617462158203, -2.9320926666259766, -0.20743751525878906, 0.07938385009765625, -1.7716598510742188, 2.9363632202148438, 0.23181533813476562, -0.4660377502441406, -0.5530176162719727, -2.592082977294922, -0.13613319396972656, -0.7306098937988281, 0.28175926208496094, -0.2275257110595703, -0.47380638122558594, -1.1576166152954102, -0.12699222564697266, -1.5251712799072266, -0.42514801025390625, -2.758024215698242, -1.1092872619628906], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9868.0, "diff_num_grad_updates_vs_sampler_policy": 9867.0}}, "num_env_steps_sampled": 70070, "num_env_steps_trained": 315776, "num_agent_steps_sampled": 70070, "num_agent_steps_trained": 315776, "last_target_update_ts": 70049, "num_target_updates": 138}, "sampler_results": {"episode_reward_max": 57.09666666666665, "episode_reward_min": 14.05299999999999, "episode_reward_mean": 26.14146666666666, "episode_len_mean": 50.13, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999], "episode_lengths": [46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8517845565798843, "mean_inference_ms": 3.352218197019669, "mean_action_processing_ms": 0.5222683039189736, "mean_env_wait_ms": 0.13419355727879784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01623845100402832, "StateBufferConnector_ms": 0.007323741912841797, "ViewRequirementAgentConnector_ms": 0.401334285736084}}, "episode_reward_max": 57.09666666666665, "episode_reward_min": 14.05299999999999, "episode_reward_mean": 26.14146666666666, "episode_len_mean": 50.13, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.270333333333323, 28.410333333333334, 27.815666666666665, 19.375333333333334, 36.338333333333345, 27.89700000000001, 37.14266666666668, 33.052333333333316, 42.882666666666644, 28.71899999999999, 18.586999999999996, 32.464, 46.89033333333334, 26.156000000000006, 35.33299999999999, 28.618333333333325, 27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999], "episode_lengths": [46, 58, 64, 34, 66, 58, 76, 90, 71, 46, 40, 61, 82, 51, 69, 58, 51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8517845565798843, "mean_inference_ms": 3.352218197019669, "mean_action_processing_ms": 0.5222683039189736, "mean_env_wait_ms": 0.13419355727879784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01623845100402832, "StateBufferConnector_ms": 0.007323741912841797, "ViewRequirementAgentConnector_ms": 0.401334285736084}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70070, "num_agent_steps_trained": 315776, "num_env_steps_sampled": 70070, "num_env_steps_trained": 315776, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 101.8344693069791, "num_env_steps_trained_throughput_per_sec": 465.5290025461902, "timesteps_total": 70070, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 70070, "timers": {"training_iteration_time_ms": 64.983, "sample_time_ms": 21.289, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 7.773, "learn_throughput": 4117.02, "synch_weights_time_ms": 17.805}, "counters": {"num_env_steps_sampled": 70070, "num_env_steps_trained": 315776, "num_agent_steps_sampled": 70070, "num_agent_steps_trained": 315776, "last_target_update_ts": 70049, "num_target_updates": 138}, "done": false, "episodes_total": 1682, "training_iteration": 70, "trial_id": "408f7_00000", "date": "2023-12-08_00-02-20", "timestamp": 1702022540, "time_this_iter_s": 9.850566864013672, "time_total_s": 1139.087776184082, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1139.087776184082, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 59.146153846153844, "ram_util_percent": 93.43076923076926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 18.024457931518555, "min_q": 3.2820351123809814, "max_q": 22.618858337402344, "mean_td_error": 0.5321451425552368, "model": {}}, "td_error": [0.9891300201416016, 3.8769235610961914, 1.3388729095458984, 0.6034336090087891, -0.4099693298339844, 2.4790289402008057, 2.1200170516967773, 0.5039424896240234, 2.110478401184082, -0.15846633911132812, -2.7042160034179688, 1.0082416534423828, -2.436004638671875, -0.2330493927001953, 0.24950218200683594, -0.13057899475097656, -0.10478591918945312, 1.4661955833435059, -0.45761680603027344, -0.6555938720703125, -1.1385307312011719, -0.8601226806640625, 0.4949026107788086, -0.0771636962890625, 1.4373807907104492, -0.4776287078857422, -1.725698471069336, -0.3169746398925781, -1.3110218048095703, -1.0221471786499023, 0.5450506210327148, 12.025114059448242], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10011.0, "diff_num_grad_updates_vs_sampler_policy": 10010.0}}, "num_env_steps_sampled": 71071, "num_env_steps_trained": 320352, "num_agent_steps_sampled": 71071, "num_agent_steps_trained": 320352, "last_target_update_ts": 71057, "num_target_updates": 140}, "sampler_results": {"episode_reward_max": 57.09666666666665, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 25.976813333333336, "episode_len_mean": 49.17, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669], "episode_lengths": [51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.844215651896968, "mean_inference_ms": 3.3403831647225544, "mean_action_processing_ms": 0.5234312969063543, "mean_env_wait_ms": 0.1342394575486283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013224601745605469, "StateBufferConnector_ms": 0.005168437957763672, "ViewRequirementAgentConnector_ms": 0.3456299304962158}}, "episode_reward_max": 57.09666666666665, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 25.976813333333336, "episode_len_mean": 49.17, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.570333333333316, 21.770999999999994, 16.017999999999997, 23.16966666666666, 25.211000000000006, 31.72333333333334, 19.049666666666656, 16.90033333333333, 46.41100000000004, 22.101666666666656, 40.29533333333336, 14.05299999999999, 22.341999999999995, 18.028999999999996, 19.649333333333328, 21.44833333333333, 38.82433333333334, 28.244666666666667, 16.652666666666658, 27.47133333333333, 18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669], "episode_lengths": [51, 36, 29, 44, 44, 55, 44, 34, 72, 47, 67, 28, 47, 40, 41, 40, 70, 50, 31, 49, 38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.844215651896968, "mean_inference_ms": 3.3403831647225544, "mean_action_processing_ms": 0.5234312969063543, "mean_env_wait_ms": 0.1342394575486283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013224601745605469, "StateBufferConnector_ms": 0.005168437957763672, "ViewRequirementAgentConnector_ms": 0.3456299304962158}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71071, "num_agent_steps_trained": 320352, "num_env_steps_sampled": 71071, "num_env_steps_trained": 320352, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 104.20839781776084, "num_env_steps_trained_throughput_per_sec": 476.38124716690675, "timesteps_total": 71071, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 71071, "timers": {"training_iteration_time_ms": 65.58, "sample_time_ms": 21.541, "load_time_ms": 0.1, "load_throughput": 320099.518, "learn_time_ms": 6.427, "learn_throughput": 4978.993, "synch_weights_time_ms": 17.936}, "counters": {"num_env_steps_sampled": 71071, "num_env_steps_trained": 320352, "num_agent_steps_sampled": 71071, "num_agent_steps_trained": 320352, "last_target_update_ts": 71057, "num_target_updates": 140}, "done": false, "episodes_total": 1698, "training_iteration": 71, "trial_id": "408f7_00000", "date": "2023-12-08_00-02-30", "timestamp": 1702022550, "time_this_iter_s": 9.620869874954224, "time_total_s": 1148.7086460590363, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1148.7086460590363, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 57.60714285714285, "ram_util_percent": 94.09285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.070716857910156, "min_q": 3.7388017177581787, "max_q": 22.45481300354004, "mean_td_error": -0.17571406066417694, "model": {}}, "td_error": [4.294355392456055, -3.757110595703125, 1.233011245727539, 0.7384777069091797, 1.1246833801269531, -1.8272433280944824, 0.5257987976074219, -1.0981292724609375, 0.07157135009765625, 0.4161796569824219, -0.06555938720703125, 1.187631607055664, -0.2103137969970703, -1.205765724182129, -1.1423664093017578, -1.1423149108886719, -0.34293365478515625, 0.293426513671875, 0.5715007781982422, 0.44982147216796875, 0.09473609924316406, -0.360198974609375, -0.3421134948730469, -3.9931745529174805, -2.013446807861328, 0.3038311004638672, -3.4335460662841797, 0.3115661144256592, -3.807842254638672, 8.545750617980957, 0.2033863067626953, -1.2465190887451172], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10154.0, "diff_num_grad_updates_vs_sampler_policy": 10153.0}}, "num_env_steps_sampled": 72072, "num_env_steps_trained": 324928, "num_agent_steps_sampled": 72072, "num_agent_steps_trained": 324928, "last_target_update_ts": 72065, "num_target_updates": 142}, "sampler_results": {"episode_reward_max": 57.09666666666665, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 26.204393333333332, "episode_len_mean": 49.92, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666], "episode_lengths": [38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.83403329560564, "mean_inference_ms": 3.3148479230393497, "mean_action_processing_ms": 0.523478767498905, "mean_env_wait_ms": 0.134317021696185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009649991989135742, "StateBufferConnector_ms": 0.004193782806396484, "ViewRequirementAgentConnector_ms": 0.3067491054534912}}, "episode_reward_max": 57.09666666666665, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 26.204393333333332, "episode_len_mean": 49.92, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.008999999999997, 19.72299999999999, 22.657333333333323, 26.278999999999986, 17.375333333333323, 23.427000000000007, 46.811666666666675, 35.51933333333334, 30.507999999999992, 24.201333333333334, 17.94866666666666, 27.691999999999993, 25.478333333333328, 16.605999999999995, 22.659666666666666, 25.955333333333336, 19.27833333333332, 30.621333333333325, 16.50833333333333, 43.39466666666667, 29.28333333333333, 31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666], "episode_lengths": [38, 42, 43, 56, 35, 46, 92, 61, 56, 41, 37, 45, 55, 31, 44, 59, 36, 60, 31, 88, 62, 72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.83403329560564, "mean_inference_ms": 3.3148479230393497, "mean_action_processing_ms": 0.523478767498905, "mean_env_wait_ms": 0.134317021696185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009649991989135742, "StateBufferConnector_ms": 0.004193782806396484, "ViewRequirementAgentConnector_ms": 0.3067491054534912}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72072, "num_agent_steps_trained": 324928, "num_env_steps_sampled": 72072, "num_env_steps_trained": 324928, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 101.8103506043381, "num_env_steps_trained_throughput_per_sec": 465.41874561983127, "timesteps_total": 72072, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 72072, "timers": {"training_iteration_time_ms": 72.58, "sample_time_ms": 30.569, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 6.689, "learn_throughput": 4783.65, "synch_weights_time_ms": 16.607}, "counters": {"num_env_steps_sampled": 72072, "num_env_steps_trained": 324928, "num_agent_steps_sampled": 72072, "num_agent_steps_trained": 324928, "last_target_update_ts": 72065, "num_target_updates": 142}, "done": false, "episodes_total": 1718, "training_iteration": 72, "trial_id": "408f7_00000", "date": "2023-12-08_00-02-39", "timestamp": 1702022559, "time_this_iter_s": 9.84522032737732, "time_total_s": 1158.5538663864136, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1158.5538663864136, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 57.728571428571435, "ram_util_percent": 93.16428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.092241287231445, "min_q": 3.347747802734375, "max_q": 23.22427749633789, "mean_td_error": -0.21459168195724487, "model": {}}, "td_error": [-1.292154312133789, -0.06391525268554688, -0.024471282958984375, 0.34876251220703125, -3.9740829467773438, -1.6954641342163086, -0.08904266357421875, 1.0778436660766602, -3.5787811279296875, 2.41408109664917, 1.2051162719726562, 0.8057422637939453, 0.00751495361328125, -0.07851600646972656, -3.0151824951171875, 0.7841520309448242, 1.380105972290039, 1.2651476860046387, 0.9109020233154297, 0.2997779846191406, -3.660310745239258, 2.8322181701660156, 0.1036834716796875, 0.45511436462402344, -3.4815635681152344, 3.6336779594421387, -1.1920795440673828, -0.19102096557617188, -0.7267041206359863, -1.9409046173095703, 0.46779441833496094, 0.14562416076660156], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10297.0, "diff_num_grad_updates_vs_sampler_policy": 10296.0}}, "num_env_steps_sampled": 73073, "num_env_steps_trained": 329504, "num_agent_steps_sampled": 73073, "num_agent_steps_trained": 329504, "last_target_update_ts": 73073, "num_target_updates": 144}, "sampler_results": {"episode_reward_max": 66.9226666666667, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 26.433069999999997, "episode_len_mean": 50.11, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668], "episode_lengths": [72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.819962857784412, "mean_inference_ms": 3.322165553547637, "mean_action_processing_ms": 0.5286561270434433, "mean_env_wait_ms": 0.13488608344933148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008379936218261719, "StateBufferConnector_ms": 0.002651691436767578, "ViewRequirementAgentConnector_ms": 0.3268561363220215}}, "episode_reward_max": 66.9226666666667, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 26.433069999999997, "episode_len_mean": 50.11, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.80766666666665, 18.356999999999996, 34.89333333333331, 28.173333333333336, 26.967666666666673, 15.902333333333331, 26.688, 41.021, 19.49733333333333, 20.139666666666667, 15.395999999999997, 27.99466666666667, 24.09133333333334, 19.328333333333333, 57.09666666666665, 28.239666666666658, 29.639333333333326, 16.532666666666668, 29.491666666666653, 35.80500000000001, 29.034999999999993, 15.308999999999992, 40.23866666666669, 38.67233333333336, 24.06566666666665, 16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668], "episode_lengths": [72, 36, 57, 57, 46, 34, 47, 77, 35, 49, 31, 53, 49, 42, 80, 48, 52, 31, 69, 64, 52, 28, 69, 74, 63, 34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.819962857784412, "mean_inference_ms": 3.322165553547637, "mean_action_processing_ms": 0.5286561270434433, "mean_env_wait_ms": 0.13488608344933148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008379936218261719, "StateBufferConnector_ms": 0.002651691436767578, "ViewRequirementAgentConnector_ms": 0.3268561363220215}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73073, "num_agent_steps_trained": 329504, "num_env_steps_sampled": 73073, "num_env_steps_trained": 329504, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 104.28902426195646, "num_env_steps_trained_throughput_per_sec": 476.7498251975152, "timesteps_total": 73073, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 73073, "timers": {"training_iteration_time_ms": 65.023, "sample_time_ms": 21.059, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 8.239, "learn_throughput": 3884.199, "synch_weights_time_ms": 18.166}, "counters": {"num_env_steps_sampled": 73073, "num_env_steps_trained": 329504, "num_agent_steps_sampled": 73073, "num_agent_steps_trained": 329504, "last_target_update_ts": 73073, "num_target_updates": 144}, "done": false, "episodes_total": 1739, "training_iteration": 73, "trial_id": "408f7_00000", "date": "2023-12-08_00-02-49", "timestamp": 1702022569, "time_this_iter_s": 9.611139297485352, "time_total_s": 1168.165005683899, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1168.165005683899, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 57.78461538461538, "ram_util_percent": 92.73076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.860973358154297, "min_q": 3.894887924194336, "max_q": 22.992563247680664, "mean_td_error": -0.03769087791442871, "model": {}}, "td_error": [-0.4820842742919922, 0.2643451690673828, -3.1957364082336426, 0.12136077880859375, -3.1136646270751953, -0.4858427047729492, 0.15448570251464844, 3.5095653533935547, 0.07508277893066406, 3.35213565826416, -0.9568996429443359, -0.7320995330810547, -0.09415626525878906, 0.3809623718261719, -0.2675209045410156, -0.22816848754882812, 0.9093341827392578, 2.9398040771484375, -1.9704341888427734, 0.06581306457519531, 0.092254638671875, 0.277252197265625, -4.755911827087402, 1.9008064270019531, -0.9668483734130859, -0.13617706298828125, -2.076740264892578, -2.0113372802734375, 3.5558619499206543, -1.8351802825927734, 1.8523998260498047, 2.6512298583984375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10440.0, "diff_num_grad_updates_vs_sampler_policy": 10439.0}}, "num_env_steps_sampled": 74074, "num_env_steps_trained": 334080, "num_agent_steps_sampled": 74074, "num_agent_steps_trained": 334080, "last_target_update_ts": 73577, "num_target_updates": 145}, "sampler_results": {"episode_reward_max": 66.9226666666667, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 25.34167666666666, "episode_len_mean": 48.3, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333], "episode_lengths": [34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8142199536458645, "mean_inference_ms": 3.2804806172417726, "mean_action_processing_ms": 0.5302659857738894, "mean_env_wait_ms": 0.1344075960107772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007826805114746094, "StateBufferConnector_ms": 0.01235651969909668, "ViewRequirementAgentConnector_ms": 0.2772948741912842}}, "episode_reward_max": 66.9226666666667, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 25.34167666666666, "episode_len_mean": 48.3, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.650333333333325, 14.294999999999991, 19.905999999999995, 25.246333333333336, 18.05733333333333, 22.385666666666662, 16.389, 35.30666666666666, 18.213333333333328, 23.398666666666667, 14.214333333333332, 20.896999999999995, 37.36066666666668, 23.20533333333332, 22.608999999999984, 18.473666666666656, 25.459666666666653, 23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333], "episode_lengths": [34, 28, 39, 46, 35, 46, 28, 56, 43, 41, 26, 40, 75, 38, 48, 37, 46, 45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8142199536458645, "mean_inference_ms": 3.2804806172417726, "mean_action_processing_ms": 0.5302659857738894, "mean_env_wait_ms": 0.1344075960107772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007826805114746094, "StateBufferConnector_ms": 0.01235651969909668, "ViewRequirementAgentConnector_ms": 0.2772948741912842}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74074, "num_agent_steps_trained": 334080, "num_env_steps_sampled": 74074, "num_env_steps_trained": 334080, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 106.86925355442547, "num_env_steps_trained_throughput_per_sec": 488.545159105945, "timesteps_total": 74074, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 74074, "timers": {"training_iteration_time_ms": 66.466, "sample_time_ms": 21.234, "load_time_ms": 0.202, "load_throughput": 158649.797, "learn_time_ms": 8.23, "learn_throughput": 3888.284, "synch_weights_time_ms": 19.051}, "counters": {"num_env_steps_sampled": 74074, "num_env_steps_trained": 334080, "num_agent_steps_sampled": 74074, "num_agent_steps_trained": 334080, "last_target_update_ts": 73577, "num_target_updates": 145}, "done": false, "episodes_total": 1764, "training_iteration": 74, "trial_id": "408f7_00000", "date": "2023-12-08_00-02-59", "timestamp": 1702022579, "time_this_iter_s": 9.381479501724243, "time_total_s": 1177.5464851856232, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1177.5464851856232, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 53.79999999999999, "ram_util_percent": 92.92307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 19.496654510498047, "min_q": 3.592461347579956, "max_q": 23.326282501220703, "mean_td_error": 0.09673898667097092, "model": {}}, "td_error": [-0.99090576171875, -0.4298744201660156, -0.2812519073486328, 4.853533744812012, 0.6403083801269531, 0.487030029296875, -0.7031135559082031, 2.613615036010742, -0.20879173278808594, 0.7782363891601562, -0.05268096923828125, -0.20093727111816406, -0.07066917419433594, -0.008394241333007812, 1.1102359294891357, -0.11453437805175781, 0.4446144104003906, 0.5722560882568359, -0.11688804626464844, 1.19696044921875, 0.6560535430908203, -0.3712959289550781, 1.8072376251220703, -1.0790653228759766, -0.13264083862304688, -1.8798933029174805, -1.7625236511230469, -1.0117063522338867, -0.5831928253173828, 0.39577388763427734, -0.11507225036621094, -2.346776008605957], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10583.0, "diff_num_grad_updates_vs_sampler_policy": 10582.0}}, "num_env_steps_sampled": 75075, "num_env_steps_trained": 338656, "num_agent_steps_sampled": 75075, "num_agent_steps_trained": 338656, "last_target_update_ts": 74585, "num_target_updates": 147}, "sampler_results": {"episode_reward_max": 66.9226666666667, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 25.63228333333333, "episode_len_mean": 49.22, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591], "episode_lengths": [45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8041187454354493, "mean_inference_ms": 3.294295991866848, "mean_action_processing_ms": 0.5308088403626013, "mean_env_wait_ms": 0.13401414604769227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007308483123779297, "StateBufferConnector_ms": 0.01170039176940918, "ViewRequirementAgentConnector_ms": 0.289226770401001}}, "episode_reward_max": 66.9226666666667, "episode_reward_min": 12.740333333333336, "episode_reward_mean": 25.63228333333333, "episode_len_mean": 49.22, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.86999999999999, 24.680999999999994, 46.62966666666665, 56.08966666666666, 25.787666666666656, 12.740333333333336, 17.956999999999997, 29.983000000000004, 29.900999999999986, 15.886999999999997, 20.244999999999994, 29.58399999999999, 35.90233333333334, 41.80766666666668, 19.623333333333328, 27.41266666666666, 36.25566666666669, 43.35200000000001, 40.426333333333325, 15.57633333333333, 27.233333333333338, 15.758999999999997, 17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591], "episode_lengths": [45, 51, 67, 102, 46, 28, 35, 58, 46, 30, 40, 59, 68, 78, 35, 56, 75, 75, 72, 32, 53, 34, 32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8041187454354493, "mean_inference_ms": 3.294295991866848, "mean_action_processing_ms": 0.5308088403626013, "mean_env_wait_ms": 0.13401414604769227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007308483123779297, "StateBufferConnector_ms": 0.01170039176940918, "ViewRequirementAgentConnector_ms": 0.289226770401001}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75075, "num_agent_steps_trained": 338656, "num_env_steps_sampled": 75075, "num_env_steps_trained": 338656, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 106.31665805826783, "num_env_steps_trained_throughput_per_sec": 486.0190082663672, "timesteps_total": 75075, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 75075, "timers": {"training_iteration_time_ms": 65.405, "sample_time_ms": 20.877, "load_time_ms": 0.374, "load_throughput": 85565.299, "learn_time_ms": 6.782, "learn_throughput": 4718.5, "synch_weights_time_ms": 18.209}, "counters": {"num_env_steps_sampled": 75075, "num_env_steps_trained": 338656, "num_agent_steps_sampled": 75075, "num_agent_steps_trained": 338656, "last_target_update_ts": 74585, "num_target_updates": 147}, "done": false, "episodes_total": 1781, "training_iteration": 75, "trial_id": "408f7_00000", "date": "2023-12-08_00-03-08", "timestamp": 1702022588, "time_this_iter_s": 9.430297374725342, "time_total_s": 1186.9767825603485, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1186.9767825603485, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 55.54615384615385, "ram_util_percent": 93.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 17.087526321411133, "min_q": 4.087740421295166, "max_q": 23.94655418395996, "mean_td_error": 0.8580724596977234, "model": {}}, "td_error": [-0.34390830993652344, 4.726046562194824, 0.9340572357177734, 2.393606185913086, -1.29229736328125, 1.4426288604736328, 3.470284938812256, -2.4360809326171875, 0.05182456970214844, -0.101409912109375, -2.981661796569824, -1.2120361328125, -2.19240665435791, 0.04726600646972656, -0.02207183837890625, 0.1243438720703125, 4.814791679382324, 3.4431841373443604, 3.1677403450012207, -0.09336471557617188, -0.2691650390625, 0.6234817504882812, 4.7126970291137695, 2.8540964126586914, 3.988126754760742, -2.492556571960449, 2.980548858642578, 4.500160217285156, -0.3051948547363281, -1.2257251739501953, -0.36995697021484375, -1.4787278175354004], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10726.0, "diff_num_grad_updates_vs_sampler_policy": 10725.0}}, "num_env_steps_sampled": 76076, "num_env_steps_trained": 343232, "num_agent_steps_sampled": 76076, "num_agent_steps_trained": 343232, "last_target_update_ts": 75593, "num_target_updates": 149}, "sampler_results": {"episode_reward_max": 66.9226666666667, "episode_reward_min": 13.551999999999996, "episode_reward_mean": 24.476439999999997, "episode_len_mean": 47.77, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997], "episode_lengths": [32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.794443648612738, "mean_inference_ms": 3.2661163570349117, "mean_action_processing_ms": 0.5338458697026889, "mean_env_wait_ms": 0.13385125236356568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005297422409057617, "StateBufferConnector_ms": 0.013293981552124023, "ViewRequirementAgentConnector_ms": 0.29392385482788086}}, "episode_reward_max": 66.9226666666667, "episode_reward_min": 13.551999999999996, "episode_reward_mean": 24.476439999999997, "episode_len_mean": 47.77, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.505, 31.791000000000004, 32.69266666666667, 16.273666666666667, 17.85, 28.54466666666666, 22.607000000000003, 27.38233333333333, 41.608000000000025, 34.745333333333335, 14.103333333333335, 14.530999999999995, 15.399999999999997, 41.34033333333334, 20.97266666666666, 22.276999999999997, 17.149, 18.961666666666655, 29.30266666666666, 36.885000000000005, 35.520999999999994, 17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997], "episode_lengths": [32, 68, 65, 32, 32, 61, 37, 49, 75, 73, 27, 26, 29, 80, 42, 52, 33, 42, 51, 84, 62, 35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.794443648612738, "mean_inference_ms": 3.2661163570349117, "mean_action_processing_ms": 0.5338458697026889, "mean_env_wait_ms": 0.13385125236356568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005297422409057617, "StateBufferConnector_ms": 0.013293981552124023, "ViewRequirementAgentConnector_ms": 0.29392385482788086}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76076, "num_agent_steps_trained": 343232, "num_env_steps_sampled": 76076, "num_env_steps_trained": 343232, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 104.48537216641952, "num_env_steps_trained_throughput_per_sec": 477.64741561791783, "timesteps_total": 76076, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 76076, "timers": {"training_iteration_time_ms": 68.125, "sample_time_ms": 23.247, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 9.025, "learn_throughput": 3545.706, "synch_weights_time_ms": 17.878}, "counters": {"num_env_steps_sampled": 76076, "num_env_steps_trained": 343232, "num_agent_steps_sampled": 76076, "num_agent_steps_trained": 343232, "last_target_update_ts": 75593, "num_target_updates": 149}, "done": false, "episodes_total": 1803, "training_iteration": 76, "trial_id": "408f7_00000", "date": "2023-12-08_00-03-18", "timestamp": 1702022598, "time_this_iter_s": 9.597718954086304, "time_total_s": 1196.5745015144348, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1196.5745015144348, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 55.885714285714286, "ram_util_percent": 93.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 14.017477035522461, "min_q": 2.7622458934783936, "max_q": 24.22776222229004, "mean_td_error": 0.2049606293439865, "model": {}}, "td_error": [-0.9275836944580078, -0.6085948944091797, -0.053615570068359375, 0.09105110168457031, 2.0111989974975586, 0.18192100524902344, 2.929872512817383, 2.625910758972168, 1.952188491821289, -1.0208344459533691, -3.872134208679199, -0.030495166778564453, 2.3191967010498047, -0.5238780975341797, 0.0189208984375, -1.7226886749267578, 3.548558235168457, -0.11198782920837402, -1.0061132907867432, 2.760106086730957, -5.297801971435547, -1.9597053527832031, 3.027322769165039, -1.2658824920654297, 0.26832008361816406, -2.249004364013672, -2.4540176391601562, 0.18082427978515625, -1.4381656646728516, 6.75947380065918, 4.963746070861816, -2.5373687744140625], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 10869.0, "diff_num_grad_updates_vs_sampler_policy": 10868.0}}, "num_env_steps_sampled": 77077, "num_env_steps_trained": 347808, "num_agent_steps_sampled": 77077, "num_agent_steps_trained": 347808, "last_target_update_ts": 76601, "num_target_updates": 151}, "sampler_results": {"episode_reward_max": 66.9226666666667, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 24.715679999999992, "episode_len_mean": 47.79, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666], "episode_lengths": [35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.783009771359315, "mean_inference_ms": 3.248089795895889, "mean_action_processing_ms": 0.5352770576486623, "mean_env_wait_ms": 0.13355728132502884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006389141082763672, "StateBufferConnector_ms": 0.012404441833496094, "ViewRequirementAgentConnector_ms": 0.2718982696533203}}, "episode_reward_max": 66.9226666666667, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 24.715679999999992, "episode_len_mean": 47.79, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.56333333333333, 28.179999999999986, 25.737666666666662, 14.413666666666662, 22.917666666666662, 22.133333333333333, 66.9226666666667, 15.520333333333328, 13.963666666666663, 49.81799999999997, 27.528666666666677, 17.022666666666655, 20.205999999999996, 16.393999999999995, 44.38666666666668, 33.80833333333333, 30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666], "episode_lengths": [35, 47, 54, 28, 42, 45, 111, 34, 26, 89, 55, 33, 40, 35, 79, 57, 71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.783009771359315, "mean_inference_ms": 3.248089795895889, "mean_action_processing_ms": 0.5352770576486623, "mean_env_wait_ms": 0.13355728132502884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006389141082763672, "StateBufferConnector_ms": 0.012404441833496094, "ViewRequirementAgentConnector_ms": 0.2718982696533203}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77077, "num_agent_steps_trained": 347808, "num_env_steps_sampled": 77077, "num_env_steps_trained": 347808, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 98.6279400698949, "num_env_steps_trained_throughput_per_sec": 450.8705831766624, "timesteps_total": 77077, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 77077, "timers": {"training_iteration_time_ms": 70.605, "sample_time_ms": 23.613, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 6.386, "learn_throughput": 5010.723, "synch_weights_time_ms": 18.745}, "counters": {"num_env_steps_sampled": 77077, "num_env_steps_trained": 347808, "num_agent_steps_sampled": 77077, "num_agent_steps_trained": 347808, "last_target_update_ts": 76601, "num_target_updates": 151}, "done": false, "episodes_total": 1824, "training_iteration": 77, "trial_id": "408f7_00000", "date": "2023-12-08_00-03-28", "timestamp": 1702022608, "time_this_iter_s": 10.166141748428345, "time_total_s": 1206.7406432628632, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1206.7406432628632, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 56.47857142857142, "ram_util_percent": 94.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 18.304866790771484, "min_q": 4.534729480743408, "max_q": 24.215717315673828, "mean_td_error": -0.5390686988830566, "model": {}}, "td_error": [0.4172649383544922, -3.816020965576172, 3.24477481842041, 3.052502155303955, 3.3335342407226562, 0.06204986572265625, 0.03891563415527344, 1.851771354675293, 0.21279335021972656, -0.6162433624267578, -1.2894668579101562, -4.247926712036133, -0.27860450744628906, 0.3820018768310547, -1.9543190002441406, -1.6976661682128906, 1.133070945739746, 0.48516082763671875, 0.2695446014404297, -4.5568742752075195, -2.4355287551879883, -0.34908294677734375, 0.25126075744628906, 1.2979412078857422, -1.292715072631836, -0.8836245536804199, -4.73790168762207, 0.163665771484375, 0.946868896484375, -2.779376983642578, -3.794011116027832, 0.3360443115234375], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11012.0, "diff_num_grad_updates_vs_sampler_policy": 11011.0}}, "num_env_steps_sampled": 78078, "num_env_steps_trained": 352384, "num_agent_steps_sampled": 78078, "num_agent_steps_trained": 352384, "last_target_update_ts": 77609, "num_target_updates": 153}, "sampler_results": {"episode_reward_max": 61.678666666666686, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 25.377249999999993, "episode_len_mean": 49.84, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666, 61.678666666666686, 16.97733333333333, 22.755333333333333, 39.08633333333336, 14.903999999999991, 44.32733333333333, 27.99799999999998, 30.817666666666668, 23.125999999999994, 26.233333333333324, 33.31866666666667, 38.02366666666663, 33.78933333333333, 18.65033333333333, 36.460999999999984, 34.52666666666667], "episode_lengths": [71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58, 116, 33, 45, 88, 29, 76, 67, 60, 56, 55, 63, 80, 60, 43, 86, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.769676611968155, "mean_inference_ms": 3.261044503292593, "mean_action_processing_ms": 0.5368194813990119, "mean_env_wait_ms": 0.132921288076259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005383968353271484, "StateBufferConnector_ms": 0.015554428100585938, "ViewRequirementAgentConnector_ms": 0.23192119598388672}}, "episode_reward_max": 61.678666666666686, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 25.377249999999993, "episode_len_mean": 49.84, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.62833333333332, 18.206999999999994, 20.786666666666658, 32.54766666666665, 20.994333333333326, 14.587999999999996, 21.486999999999988, 20.322, 31.385666666666665, 25.345333333333336, 23.204000000000004, 40.47233333333332, 23.098333333333326, 21.33933333333333, 19.343666666666667, 18.976666666666663, 15.560333333333327, 24.542, 29.038999999999994, 13.630999999999998, 17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666, 61.678666666666686, 16.97733333333333, 22.755333333333333, 39.08633333333336, 14.903999999999991, 44.32733333333333, 27.99799999999998, 30.817666666666668, 23.125999999999994, 26.233333333333324, 33.31866666666667, 38.02366666666663, 33.78933333333333, 18.65033333333333, 36.460999999999984, 34.52666666666667], "episode_lengths": [71, 32, 42, 66, 40, 29, 44, 45, 52, 45, 49, 66, 51, 45, 43, 35, 28, 53, 53, 26, 31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58, 116, 33, 45, 88, 29, 76, 67, 60, 56, 55, 63, 80, 60, 43, 86, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.769676611968155, "mean_inference_ms": 3.261044503292593, "mean_action_processing_ms": 0.5368194813990119, "mean_env_wait_ms": 0.132921288076259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005383968353271484, "StateBufferConnector_ms": 0.015554428100585938, "ViewRequirementAgentConnector_ms": 0.23192119598388672}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78078, "num_agent_steps_trained": 352384, "num_env_steps_sampled": 78078, "num_env_steps_trained": 352384, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 95.47351663406975, "num_env_steps_trained_throughput_per_sec": 436.45036175574745, "timesteps_total": 78078, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 78078, "timers": {"training_iteration_time_ms": 65.593, "sample_time_ms": 20.724, "load_time_ms": 0.101, "load_throughput": 315806.419, "learn_time_ms": 7.134, "learn_throughput": 4485.617, "synch_weights_time_ms": 18.483}, "counters": {"num_env_steps_sampled": 78078, "num_env_steps_trained": 352384, "num_agent_steps_sampled": 78078, "num_agent_steps_trained": 352384, "last_target_update_ts": 77609, "num_target_updates": 153}, "done": false, "episodes_total": 1840, "training_iteration": 78, "trial_id": "408f7_00000", "date": "2023-12-08_00-03-38", "timestamp": 1702022618, "time_this_iter_s": 10.500303745269775, "time_total_s": 1217.240947008133, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1217.240947008133, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 60.400000000000006, "ram_util_percent": 95.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 15.884937286376953, "min_q": 1.0917701721191406, "max_q": 24.349491119384766, "mean_td_error": -0.33170902729034424, "model": {}}, "td_error": [-1.3017988204956055, -0.06501007080078125, -0.38603973388671875, -0.1847515106201172, 1.70306396484375, 1.528294324874878, 0.13431453704833984, 3.0219383239746094, 0.3325314521789551, 2.8668365478515625, -3.9282264709472656, -0.5228347778320312, 1.507878303527832, 0.11443686485290527, -0.04636383056640625, 0.14207077026367188, 0.3265342712402344, -2.000232696533203, 0.050273895263671875, -0.31345272064208984, -3.453375816345215, -0.41301536560058594, -3.9793996810913086, -0.8860034942626953, -1.1012382507324219, -3.241466522216797, 0.1974353790283203, 0.8998336791992188, -1.2869033813476562, -2.820817470550537, 1.5162849426269531, 0.9745140075683594], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11155.0, "diff_num_grad_updates_vs_sampler_policy": 11154.0}}, "num_env_steps_sampled": 79079, "num_env_steps_trained": 356960, "num_agent_steps_sampled": 79079, "num_agent_steps_trained": 356960, "last_target_update_ts": 78617, "num_target_updates": 155}, "sampler_results": {"episode_reward_max": 61.678666666666686, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 25.823743333333333, "episode_len_mean": 50.41, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666, 61.678666666666686, 16.97733333333333, 22.755333333333333, 39.08633333333336, 14.903999999999991, 44.32733333333333, 27.99799999999998, 30.817666666666668, 23.125999999999994, 26.233333333333324, 33.31866666666667, 38.02366666666663, 33.78933333333333, 18.65033333333333, 36.460999999999984, 34.52666666666667, 36.84299999999999, 18.552, 35.728000000000016, 17.292333333333325, 30.19166666666667, 26.056666666666665, 17.111999999999995, 17.170333333333335, 15.965999999999996, 34.272666666666666, 14.553999999999998, 30.658333333333324, 28.018333333333313, 22.23533333333333, 19.14366666666666, 22.413999999999994, 34.33700000000001, 40.52300000000002, 31.12800000000001, 17.951666666666657], "episode_lengths": [31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58, 116, 33, 45, 88, 29, 76, 67, 60, 56, 55, 63, 80, 60, 43, 86, 58, 82, 37, 69, 36, 68, 55, 35, 32, 31, 63, 29, 55, 42, 42, 39, 42, 62, 64, 53, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7744104977639226, "mean_inference_ms": 3.22142954126107, "mean_action_processing_ms": 0.5354168125484501, "mean_env_wait_ms": 0.1330795220270906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007477760314941406, "StateBufferConnector_ms": 0.016551971435546875, "ViewRequirementAgentConnector_ms": 0.23659062385559082}}, "episode_reward_max": 61.678666666666686, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 25.823743333333333, "episode_len_mean": 50.41, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.162999999999997, 13.964333333333329, 32.357333333333315, 22.45233333333333, 20.48866666666667, 16.080666666666662, 34.21966666666666, 23.900333333333315, 20.39099999999999, 18.02633333333333, 24.920666666666662, 20.111333333333324, 22.702333333333332, 35.819666666666656, 17.94733333333333, 26.209999999999994, 15.663999999999996, 18.925333333333334, 26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666, 61.678666666666686, 16.97733333333333, 22.755333333333333, 39.08633333333336, 14.903999999999991, 44.32733333333333, 27.99799999999998, 30.817666666666668, 23.125999999999994, 26.233333333333324, 33.31866666666667, 38.02366666666663, 33.78933333333333, 18.65033333333333, 36.460999999999984, 34.52666666666667, 36.84299999999999, 18.552, 35.728000000000016, 17.292333333333325, 30.19166666666667, 26.056666666666665, 17.111999999999995, 17.170333333333335, 15.965999999999996, 34.272666666666666, 14.553999999999998, 30.658333333333324, 28.018333333333313, 22.23533333333333, 19.14366666666666, 22.413999999999994, 34.33700000000001, 40.52300000000002, 31.12800000000001, 17.951666666666657], "episode_lengths": [31, 26, 57, 48, 39, 31, 58, 58, 42, 38, 43, 49, 48, 71, 33, 59, 30, 39, 53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58, 116, 33, 45, 88, 29, 76, 67, 60, 56, 55, 63, 80, 60, 43, 86, 58, 82, 37, 69, 36, 68, 55, 35, 32, 31, 63, 29, 55, 42, 42, 39, 42, 62, 64, 53, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7744104977639226, "mean_inference_ms": 3.22142954126107, "mean_action_processing_ms": 0.5354168125484501, "mean_env_wait_ms": 0.1330795220270906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007477760314941406, "StateBufferConnector_ms": 0.016551971435546875, "ViewRequirementAgentConnector_ms": 0.23659062385559082}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79079, "num_agent_steps_trained": 356960, "num_env_steps_sampled": 79079, "num_env_steps_trained": 356960, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 98.8107893470794, "num_env_steps_trained_throughput_per_sec": 451.70646558664873, "timesteps_total": 79079, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 79079, "timers": {"training_iteration_time_ms": 65.729, "sample_time_ms": 22.094, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 7.283, "learn_throughput": 4394.069, "synch_weights_time_ms": 17.969}, "counters": {"num_env_steps_sampled": 79079, "num_env_steps_trained": 356960, "num_agent_steps_sampled": 79079, "num_agent_steps_trained": 356960, "last_target_update_ts": 78617, "num_target_updates": 155}, "done": false, "episodes_total": 1860, "training_iteration": 79, "trial_id": "408f7_00000", "date": "2023-12-08_00-03-49", "timestamp": 1702022629, "time_this_iter_s": 10.14464282989502, "time_total_s": 1227.385589838028, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1227.385589838028, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 59.15714285714286, "ram_util_percent": 93.37142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0005000000237487257, "mean_q": 16.82944107055664, "min_q": 5.314507484436035, "max_q": 25.25609016418457, "mean_td_error": 1.597054123878479, "model": {}}, "td_error": [-0.06532859802246094, -0.2505168914794922, 1.903223991394043, -0.5654983520507812, 10.855198860168457, 1.160048007965088, 0.12294387817382812, -0.4268198013305664, -0.16257476806640625, 4.397507667541504, -0.30531883239746094, 3.2614097595214844, -0.2747840881347656, 4.34246826171875, -0.7586202621459961, 2.4622459411621094, 2.518098831176758, 3.1489219665527344, 0.33557891845703125, 1.3725404739379883, 3.049509048461914, 1.0063552856445312, -1.6261720657348633, 0.7023086547851562, -2.7143144607543945, 0.499603271484375, 2.3837509155273438, 2.1294069290161133, 0.33557891845703125, 3.9153900146484375, 1.9147567749023438, 6.438831806182861], "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 11298.0, "diff_num_grad_updates_vs_sampler_policy": 11297.0}}, "num_env_steps_sampled": 80080, "num_env_steps_trained": 361536, "num_agent_steps_sampled": 80080, "num_agent_steps_trained": 361536, "last_target_update_ts": 79625, "num_target_updates": 157}, "sampler_results": {"episode_reward_max": 61.678666666666686, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 26.88128333333332, "episode_len_mean": 52.12, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666, 61.678666666666686, 16.97733333333333, 22.755333333333333, 39.08633333333336, 14.903999999999991, 44.32733333333333, 27.99799999999998, 30.817666666666668, 23.125999999999994, 26.233333333333324, 33.31866666666667, 38.02366666666663, 33.78933333333333, 18.65033333333333, 36.460999999999984, 34.52666666666667, 36.84299999999999, 18.552, 35.728000000000016, 17.292333333333325, 30.19166666666667, 26.056666666666665, 17.111999999999995, 17.170333333333335, 15.965999999999996, 34.272666666666666, 14.553999999999998, 30.658333333333324, 28.018333333333313, 22.23533333333333, 19.14366666666666, 22.413999999999994, 34.33700000000001, 40.52300000000002, 31.12800000000001, 17.951666666666657, 49.16599999999998, 37.873000000000005, 30.499000000000024, 20.361999999999995, 42.111333333333356, 42.471999999999994, 12.827333333333332, 18.830999999999996, 27.538666666666664, 25.751999999999985, 31.515333333333327, 28.389999999999993, 23.16366666666666, 18.528333333333332, 32.845, 27.996666666666663, 17.265666666666664, 19.96133333333333], "episode_lengths": [53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58, 116, 33, 45, 88, 29, 76, 67, 60, 56, 55, 63, 80, 60, 43, 86, 58, 82, 37, 69, 36, 68, 55, 35, 32, 31, 63, 29, 55, 42, 42, 39, 42, 62, 64, 53, 36, 83, 72, 64, 41, 79, 81, 27, 36, 51, 49, 51, 57, 40, 42, 62, 57, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7570066693589506, "mean_inference_ms": 3.2260576996146257, "mean_action_processing_ms": 0.5408559388778836, "mean_env_wait_ms": 0.13302955600280206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005274534225463867, "StateBufferConnector_ms": 0.008161306381225586, "ViewRequirementAgentConnector_ms": 0.25239992141723633}}, "episode_reward_max": 61.678666666666686, "episode_reward_min": 12.301666666666662, "episode_reward_mean": 26.88128333333332, "episode_len_mean": 52.12, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.331999999999994, 34.79833333333333, 24.591, 13.551999999999996, 16.556999999999995, 27.973999999999986, 18.109666666666662, 33.34600000000001, 15.276999999999992, 25.886, 17.477666666666668, 45.27466666666667, 22.85699999999999, 17.49633333333333, 40.177, 21.075, 30.837, 18.965000000000003, 25.882000000000005, 16.023999999999997, 28.29066666666667, 16.17733333333333, 38.44099999999999, 16.88633333333333, 14.556999999999997, 17.23566666666666, 37.653, 17.970666666666663, 31.31766666666669, 15.796999999999993, 17.911999999999995, 52.583666666666694, 16.183999999999994, 23.074666666666662, 14.569333333333331, 21.98199999999999, 43.95266666666664, 12.301666666666662, 22.97366666666666, 24.872, 33.01966666666665, 23.17066666666667, 40.66433333333332, 44.75866666666667, 18.260666666666665, 31.11366666666666, 61.678666666666686, 16.97733333333333, 22.755333333333333, 39.08633333333336, 14.903999999999991, 44.32733333333333, 27.99799999999998, 30.817666666666668, 23.125999999999994, 26.233333333333324, 33.31866666666667, 38.02366666666663, 33.78933333333333, 18.65033333333333, 36.460999999999984, 34.52666666666667, 36.84299999999999, 18.552, 35.728000000000016, 17.292333333333325, 30.19166666666667, 26.056666666666665, 17.111999999999995, 17.170333333333335, 15.965999999999996, 34.272666666666666, 14.553999999999998, 30.658333333333324, 28.018333333333313, 22.23533333333333, 19.14366666666666, 22.413999999999994, 34.33700000000001, 40.52300000000002, 31.12800000000001, 17.951666666666657, 49.16599999999998, 37.873000000000005, 30.499000000000024, 20.361999999999995, 42.111333333333356, 42.471999999999994, 12.827333333333332, 18.830999999999996, 27.538666666666664, 25.751999999999985, 31.515333333333327, 28.389999999999993, 23.16366666666666, 18.528333333333332, 32.845, 27.996666666666663, 17.265666666666664, 19.96133333333333], "episode_lengths": [53, 56, 51, 29, 34, 51, 37, 71, 34, 45, 36, 86, 46, 36, 80, 35, 54, 40, 57, 31, 64, 29, 83, 34, 28, 34, 66, 37, 56, 30, 39, 93, 33, 41, 31, 39, 92, 24, 54, 42, 59, 46, 66, 81, 33, 58, 116, 33, 45, 88, 29, 76, 67, 60, 56, 55, 63, 80, 60, 43, 86, 58, 82, 37, 69, 36, 68, 55, 35, 32, 31, 63, 29, 55, 42, 42, 39, 42, 62, 64, 53, 36, 83, 72, 64, 41, 79, 81, 27, 36, 51, 49, 51, 57, 40, 42, 62, 57, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7570066693589506, "mean_inference_ms": 3.2260576996146257, "mean_action_processing_ms": 0.5408559388778836, "mean_env_wait_ms": 0.13302955600280206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005274534225463867, "StateBufferConnector_ms": 0.008161306381225586, "ViewRequirementAgentConnector_ms": 0.25239992141723633}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80080, "num_agent_steps_trained": 361536, "num_env_steps_sampled": 80080, "num_env_steps_trained": 361536, "num_env_steps_sampled_this_iter": 1001, "num_env_steps_trained_this_iter": 4576, "num_env_steps_sampled_throughput_per_sec": 106.94032152002082, "num_env_steps_trained_throughput_per_sec": 488.8700412343809, "timesteps_total": 80080, "num_steps_trained_this_iter": 4576, "agent_timesteps_total": 80080, "timers": {"training_iteration_time_ms": 66.284, "sample_time_ms": 21.706, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 8.398, "learn_throughput": 3810.503, "synch_weights_time_ms": 18.394}, "counters": {"num_env_steps_sampled": 80080, "num_env_steps_trained": 361536, "num_agent_steps_sampled": 80080, "num_agent_steps_trained": 361536, "last_target_update_ts": 79625, "num_target_updates": 157}, "done": true, "episodes_total": 1878, "training_iteration": 80, "trial_id": "408f7_00000", "date": "2023-12-08_00-03-58", "timestamp": 1702022638, "time_this_iter_s": 9.375741243362427, "time_total_s": 1236.7613310813904, "pid": 20248, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001FDFB732170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1236.7613310813904, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 56.0076923076923, "ram_util_percent": 91.73846153846154}}
