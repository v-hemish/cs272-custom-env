{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0986233949661255, "total_loss": 1.0986233949661255, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1400, "num_env_steps_trained": 1400, "num_agent_steps_sampled": 1400, "num_agent_steps_trained": 1400}, "sampler_results": {"episode_reward_max": 12.081333333333337, "episode_reward_min": 6.563000000000001, "episode_reward_mean": 8.905417840375584, "episode_len_mean": 18.676056338028168, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.714333333333332, 8.254999999999999, 8.668333333333331, 9.376999999999999, 9.429666666666668, 7.455666666666666, 10.297333333333333, 7.983999999999995, 10.063666666666665, 9.01, 7.401999999999998, 8.672999999999998, 7.329333333333331, 10.676999999999996, 7.391999999999999, 9.807333333333332, 10.78, 9.167666666666664, 9.61133333333333, 7.383333333333333, 8.881333333333332, 9.830666666666666, 7.383333333333331, 9.320333333333329, 8.217999999999998, 9.441999999999997, 11.537, 10.296333333333333, 8.904333333333332, 8.643999999999998, 9.685666666666666, 6.7506666666666675, 9.537666666666667, 9.685333333333334, 9.144999999999998, 9.675666666666666, 10.233333333333333, 8.935, 7.834666666666666, 7.65, 8.820333333333332, 12.081333333333337, 9.138999999999998, 7.356, 11.013333333333334, 8.919333333333332, 10.531999999999998, 8.265999999999998, 8.319333333333331, 6.779999999999999, 6.563000000000001, 7.168999999999998, 6.763333333333332, 8.369333333333334, 11.040999999999999, 6.602333333333331, 8.606666666666666, 10.059666666666663, 9.607666666666665, 7.388333333333331, 8.064333333333332, 11.287666666666668, 6.637666666666664, 11.893666666666665, 6.864666666666665, 9.700666666666663, 7.8153333333333315, 9.269333333333334, 8.448666666666666, 9.340999999999998, 8.496333333333332], "episode_lengths": [21, 19, 17, 20, 20, 15, 21, 18, 21, 18, 16, 18, 16, 21, 16, 22, 23, 18, 22, 16, 18, 20, 17, 18, 17, 20, 24, 23, 19, 19, 20, 14, 20, 20, 19, 20, 20, 19, 16, 17, 19, 24, 18, 16, 22, 18, 21, 18, 18, 15, 15, 15, 16, 18, 23, 14, 17, 20, 19, 15, 17, 23, 15, 21, 16, 21, 16, 18, 18, 22, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5120758554895521, "mean_inference_ms": 3.1179011841226596, "mean_action_processing_ms": 0.5185603260133571, "mean_env_wait_ms": 0.11781559922033415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012917249975070147, "StateBufferConnector_ms": 0.013736939766037633, "ViewRequirementAgentConnector_ms": 0.4301215561342911}}, "episode_reward_max": 12.081333333333337, "episode_reward_min": 6.563000000000001, "episode_reward_mean": 8.905417840375584, "episode_len_mean": 18.676056338028168, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.714333333333332, 8.254999999999999, 8.668333333333331, 9.376999999999999, 9.429666666666668, 7.455666666666666, 10.297333333333333, 7.983999999999995, 10.063666666666665, 9.01, 7.401999999999998, 8.672999999999998, 7.329333333333331, 10.676999999999996, 7.391999999999999, 9.807333333333332, 10.78, 9.167666666666664, 9.61133333333333, 7.383333333333333, 8.881333333333332, 9.830666666666666, 7.383333333333331, 9.320333333333329, 8.217999999999998, 9.441999999999997, 11.537, 10.296333333333333, 8.904333333333332, 8.643999999999998, 9.685666666666666, 6.7506666666666675, 9.537666666666667, 9.685333333333334, 9.144999999999998, 9.675666666666666, 10.233333333333333, 8.935, 7.834666666666666, 7.65, 8.820333333333332, 12.081333333333337, 9.138999999999998, 7.356, 11.013333333333334, 8.919333333333332, 10.531999999999998, 8.265999999999998, 8.319333333333331, 6.779999999999999, 6.563000000000001, 7.168999999999998, 6.763333333333332, 8.369333333333334, 11.040999999999999, 6.602333333333331, 8.606666666666666, 10.059666666666663, 9.607666666666665, 7.388333333333331, 8.064333333333332, 11.287666666666668, 6.637666666666664, 11.893666666666665, 6.864666666666665, 9.700666666666663, 7.8153333333333315, 9.269333333333334, 8.448666666666666, 9.340999999999998, 8.496333333333332], "episode_lengths": [21, 19, 17, 20, 20, 15, 21, 18, 21, 18, 16, 18, 16, 21, 16, 22, 23, 18, 22, 16, 18, 20, 17, 18, 17, 20, 24, 23, 19, 19, 20, 14, 20, 20, 19, 20, 20, 19, 16, 17, 19, 24, 18, 16, 22, 18, 21, 18, 18, 15, 15, 15, 16, 18, 23, 14, 17, 20, 19, 15, 17, 23, 15, 21, 16, 21, 16, 18, 18, 22, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5120758554895521, "mean_inference_ms": 3.1179011841226596, "mean_action_processing_ms": 0.5185603260133571, "mean_env_wait_ms": 0.11781559922033415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012917249975070147, "StateBufferConnector_ms": 0.013736939766037633, "ViewRequirementAgentConnector_ms": 0.4301215561342911}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400, "num_agent_steps_trained": 1400, "num_env_steps_sampled": 1400, "num_env_steps_trained": 1400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 987.0138322527552, "num_env_steps_trained_throughput_per_sec": 987.0138322527552, "timesteps_total": 1400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 1400, "timers": {"training_iteration_time_ms": 1415.524, "sample_time_ms": 1124.808, "load_time_ms": 0.968, "load_throughput": 1445599.606, "learn_time_ms": 266.531, "learn_throughput": 5252.682, "synch_weights_time_ms": 21.188}, "counters": {"num_env_steps_sampled": 1400, "num_env_steps_trained": 1400, "num_agent_steps_sampled": 1400, "num_agent_steps_trained": 1400}, "done": false, "episodes_total": 71, "training_iteration": 1, "trial_id": "b37b2_00000", "date": "2023-12-07_23-38-55", "timestamp": 1702021135, "time_this_iter_s": 1.4388236999511719, "time_total_s": 1.4388236999511719, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.4388236999511719, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.166666666666664, "ram_util_percent": 97.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0989313125610352, "total_loss": 1.0989313125610352, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2800, "num_env_steps_trained": 2800, "num_agent_steps_sampled": 2800, "num_agent_steps_trained": 2800}, "sampler_results": {"episode_reward_max": 13.507333333333326, "episode_reward_min": 6.120333333333333, "episode_reward_mean": 8.777549999999998, "episode_len_mean": 18.54, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.265999999999998, 8.319333333333331, 6.779999999999999, 6.563000000000001, 7.168999999999998, 6.763333333333332, 8.369333333333334, 11.040999999999999, 6.602333333333331, 8.606666666666666, 10.059666666666663, 9.607666666666665, 7.388333333333331, 8.064333333333332, 11.287666666666668, 6.637666666666664, 11.893666666666665, 6.864666666666665, 9.700666666666663, 7.8153333333333315, 9.269333333333334, 8.448666666666666, 9.340999999999998, 8.496333333333332, 7.620666666666666, 8.315666666666665, 7.814666666666667, 7.7366666666666655, 11.094333333333333, 10.022000000000002, 13.507333333333326, 9.334333333333333, 7.016666666666666, 8.522333333333334, 9.034333333333333, 6.120333333333333, 12.032, 7.984666666666664, 8.058666666666664, 10.246333333333332, 8.690999999999997, 7.837999999999999, 9.450999999999999, 8.431333333333333, 9.407333333333332, 7.345, 8.88133333333333, 7.039666666666665, 9.255999999999998, 9.994666666666664, 7.177999999999999, 9.054666666666668, 7.858999999999999, 9.447333333333333, 8.967333333333329, 9.692333333333332, 7.706666666666666, 8.849666666666664, 11.587666666666667, 10.408999999999995, 6.918999999999999, 10.014666666666663, 9.751666666666663, 7.737999999999999, 13.065999999999995, 8.004999999999999, 10.399999999999997, 11.313333333333333, 7.162666666666665, 7.613333333333333, 7.573666666666666, 8.433999999999997, 8.706333333333333, 8.047333333333333, 8.678666666666665, 9.783999999999999, 8.727333333333332, 8.44833333333333, 8.080666666666666, 6.553666666666666, 8.982666666666667, 11.807666666666664, 6.697, 11.06833333333333, 8.496999999999998, 8.226666666666665, 8.702, 9.321333333333333, 8.657666666666666, 8.376666666666665, 12.471333333333332, 8.349666666666664, 8.25333333333333, 6.743999999999998, 6.942666666666665, 8.064333333333334, 9.550666666666666, 10.468999999999996, 7.436333333333334, 9.216], "episode_lengths": [18, 18, 15, 15, 15, 16, 18, 23, 14, 17, 20, 19, 15, 17, 23, 15, 21, 16, 21, 16, 18, 18, 22, 20, 17, 17, 17, 17, 24, 20, 26, 18, 16, 18, 19, 14, 24, 17, 18, 23, 20, 17, 21, 19, 23, 16, 18, 14, 20, 23, 15, 19, 17, 22, 18, 20, 17, 19, 22, 20, 15, 19, 18, 17, 24, 17, 23, 24, 16, 16, 16, 17, 19, 17, 18, 22, 19, 18, 16, 15, 20, 24, 14, 22, 19, 17, 18, 20, 20, 18, 26, 16, 18, 14, 14, 17, 20, 21, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5189829253494895, "mean_inference_ms": 2.9318520402827266, "mean_action_processing_ms": 0.5133580867472811, "mean_env_wait_ms": 0.11912073033454779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02063465118408203, "StateBufferConnector_ms": 0.027975797653198242, "ViewRequirementAgentConnector_ms": 0.4598836898803711}}, "episode_reward_max": 13.507333333333326, "episode_reward_min": 6.120333333333333, "episode_reward_mean": 8.777549999999998, "episode_len_mean": 18.54, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.265999999999998, 8.319333333333331, 6.779999999999999, 6.563000000000001, 7.168999999999998, 6.763333333333332, 8.369333333333334, 11.040999999999999, 6.602333333333331, 8.606666666666666, 10.059666666666663, 9.607666666666665, 7.388333333333331, 8.064333333333332, 11.287666666666668, 6.637666666666664, 11.893666666666665, 6.864666666666665, 9.700666666666663, 7.8153333333333315, 9.269333333333334, 8.448666666666666, 9.340999999999998, 8.496333333333332, 7.620666666666666, 8.315666666666665, 7.814666666666667, 7.7366666666666655, 11.094333333333333, 10.022000000000002, 13.507333333333326, 9.334333333333333, 7.016666666666666, 8.522333333333334, 9.034333333333333, 6.120333333333333, 12.032, 7.984666666666664, 8.058666666666664, 10.246333333333332, 8.690999999999997, 7.837999999999999, 9.450999999999999, 8.431333333333333, 9.407333333333332, 7.345, 8.88133333333333, 7.039666666666665, 9.255999999999998, 9.994666666666664, 7.177999999999999, 9.054666666666668, 7.858999999999999, 9.447333333333333, 8.967333333333329, 9.692333333333332, 7.706666666666666, 8.849666666666664, 11.587666666666667, 10.408999999999995, 6.918999999999999, 10.014666666666663, 9.751666666666663, 7.737999999999999, 13.065999999999995, 8.004999999999999, 10.399999999999997, 11.313333333333333, 7.162666666666665, 7.613333333333333, 7.573666666666666, 8.433999999999997, 8.706333333333333, 8.047333333333333, 8.678666666666665, 9.783999999999999, 8.727333333333332, 8.44833333333333, 8.080666666666666, 6.553666666666666, 8.982666666666667, 11.807666666666664, 6.697, 11.06833333333333, 8.496999999999998, 8.226666666666665, 8.702, 9.321333333333333, 8.657666666666666, 8.376666666666665, 12.471333333333332, 8.349666666666664, 8.25333333333333, 6.743999999999998, 6.942666666666665, 8.064333333333334, 9.550666666666666, 10.468999999999996, 7.436333333333334, 9.216], "episode_lengths": [18, 18, 15, 15, 15, 16, 18, 23, 14, 17, 20, 19, 15, 17, 23, 15, 21, 16, 21, 16, 18, 18, 22, 20, 17, 17, 17, 17, 24, 20, 26, 18, 16, 18, 19, 14, 24, 17, 18, 23, 20, 17, 21, 19, 23, 16, 18, 14, 20, 23, 15, 19, 17, 22, 18, 20, 17, 19, 22, 20, 15, 19, 18, 17, 24, 17, 23, 24, 16, 16, 16, 17, 19, 17, 18, 22, 19, 18, 16, 15, 20, 24, 14, 22, 19, 17, 18, 20, 20, 18, 26, 16, 18, 14, 14, 17, 20, 21, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5189829253494895, "mean_inference_ms": 2.9318520402827266, "mean_action_processing_ms": 0.5133580867472811, "mean_env_wait_ms": 0.11912073033454779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02063465118408203, "StateBufferConnector_ms": 0.027975797653198242, "ViewRequirementAgentConnector_ms": 0.4598836898803711}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800, "num_agent_steps_trained": 2800, "num_env_steps_sampled": 2800, "num_env_steps_trained": 2800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1370.650467914501, "num_env_steps_trained_throughput_per_sec": 1370.650467914501, "timesteps_total": 2800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 2800, "timers": {"training_iteration_time_ms": 1218.469, "sample_time_ms": 1057.106, "load_time_ms": 0.484, "load_throughput": 2891199.212, "learn_time_ms": 139.268, "learn_throughput": 10052.592, "synch_weights_time_ms": 20.596}, "counters": {"num_env_steps_sampled": 2800, "num_env_steps_trained": 2800, "num_agent_steps_sampled": 2800, "num_agent_steps_trained": 2800}, "done": false, "episodes_total": 147, "training_iteration": 2, "trial_id": "b37b2_00000", "date": "2023-12-07_23-38-56", "timestamp": 1702021136, "time_this_iter_s": 1.040405511856079, "time_total_s": 2.479229211807251, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.479229211807251, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 85.6, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0987248420715332, "total_loss": 1.0987248420715332, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "sampler_results": {"episode_reward_max": 12.471333333333332, "episode_reward_min": 6.032333333333332, "episode_reward_mean": 8.64466, "episode_len_mean": 18.56, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.678666666666665, 9.783999999999999, 8.727333333333332, 8.44833333333333, 8.080666666666666, 6.553666666666666, 8.982666666666667, 11.807666666666664, 6.697, 11.06833333333333, 8.496999999999998, 8.226666666666665, 8.702, 9.321333333333333, 8.657666666666666, 8.376666666666665, 12.471333333333332, 8.349666666666664, 8.25333333333333, 6.743999999999998, 6.942666666666665, 8.064333333333334, 9.550666666666666, 10.468999999999996, 7.436333333333334, 9.216, 6.410333333333332, 7.092333333333333, 8.503333333333332, 8.528666666666666, 11.629666666666663, 7.705666666666666, 9.591666666666667, 8.845333333333333, 8.308999999999997, 8.245666666666667, 6.722666666666666, 8.524666666666667, 11.512666666666664, 7.387333333333332, 9.185999999999998, 8.257333333333333, 11.82466666666666, 9.170999999999996, 8.716333333333333, 8.068666666666665, 11.251666666666663, 9.075333333333333, 7.079333333333332, 10.30933333333333, 6.890666666666666, 10.275333333333332, 6.032333333333332, 7.595999999999998, 8.927333333333335, 6.587333333333334, 8.921666666666663, 7.835000000000001, 10.838999999999995, 10.435333333333332, 7.151333333333333, 8.796666666666665, 10.703666666666665, 10.068, 6.351999999999998, 6.926999999999999, 7.698999999999998, 8.215, 9.069333333333331, 8.701333333333332, 10.851999999999999, 8.125, 8.848666666666665, 8.492999999999999, 10.982333333333331, 7.237666666666666, 6.423333333333333, 11.041999999999998, 8.707333333333333, 6.308333333333333, 10.197666666666665, 7.054999999999999, 8.208333333333336, 9.489333333333335, 7.771999999999998, 6.549999999999999, 8.557666666666664, 9.099333333333334, 6.7989999999999995, 10.059333333333331, 7.267333333333332, 6.585666666666667, 9.416666666666666, 11.441999999999998, 7.189, 6.917000000000001, 9.054333333333334, 9.254333333333333, 8.011333333333331, 10.442], "episode_lengths": [18, 22, 19, 18, 16, 15, 20, 24, 14, 22, 19, 17, 18, 20, 20, 18, 26, 16, 18, 14, 14, 17, 20, 21, 16, 19, 15, 16, 18, 18, 26, 17, 22, 20, 19, 18, 16, 19, 25, 16, 20, 21, 21, 21, 17, 18, 22, 19, 17, 21, 15, 23, 14, 16, 18, 14, 19, 16, 22, 23, 17, 20, 21, 24, 17, 16, 16, 17, 20, 19, 22, 17, 20, 19, 22, 17, 14, 22, 18, 15, 21, 15, 18, 22, 16, 15, 19, 21, 16, 21, 16, 14, 20, 22, 15, 15, 18, 19, 17, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4907111042905665, "mean_inference_ms": 2.775812746585647, "mean_action_processing_ms": 0.5504959191056847, "mean_env_wait_ms": 0.12900803140693468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02496814727783203, "StateBufferConnector_ms": 0.022434473037719727, "ViewRequirementAgentConnector_ms": 0.4625208377838135}}, "episode_reward_max": 12.471333333333332, "episode_reward_min": 6.032333333333332, "episode_reward_mean": 8.64466, "episode_len_mean": 18.56, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.678666666666665, 9.783999999999999, 8.727333333333332, 8.44833333333333, 8.080666666666666, 6.553666666666666, 8.982666666666667, 11.807666666666664, 6.697, 11.06833333333333, 8.496999999999998, 8.226666666666665, 8.702, 9.321333333333333, 8.657666666666666, 8.376666666666665, 12.471333333333332, 8.349666666666664, 8.25333333333333, 6.743999999999998, 6.942666666666665, 8.064333333333334, 9.550666666666666, 10.468999999999996, 7.436333333333334, 9.216, 6.410333333333332, 7.092333333333333, 8.503333333333332, 8.528666666666666, 11.629666666666663, 7.705666666666666, 9.591666666666667, 8.845333333333333, 8.308999999999997, 8.245666666666667, 6.722666666666666, 8.524666666666667, 11.512666666666664, 7.387333333333332, 9.185999999999998, 8.257333333333333, 11.82466666666666, 9.170999999999996, 8.716333333333333, 8.068666666666665, 11.251666666666663, 9.075333333333333, 7.079333333333332, 10.30933333333333, 6.890666666666666, 10.275333333333332, 6.032333333333332, 7.595999999999998, 8.927333333333335, 6.587333333333334, 8.921666666666663, 7.835000000000001, 10.838999999999995, 10.435333333333332, 7.151333333333333, 8.796666666666665, 10.703666666666665, 10.068, 6.351999999999998, 6.926999999999999, 7.698999999999998, 8.215, 9.069333333333331, 8.701333333333332, 10.851999999999999, 8.125, 8.848666666666665, 8.492999999999999, 10.982333333333331, 7.237666666666666, 6.423333333333333, 11.041999999999998, 8.707333333333333, 6.308333333333333, 10.197666666666665, 7.054999999999999, 8.208333333333336, 9.489333333333335, 7.771999999999998, 6.549999999999999, 8.557666666666664, 9.099333333333334, 6.7989999999999995, 10.059333333333331, 7.267333333333332, 6.585666666666667, 9.416666666666666, 11.441999999999998, 7.189, 6.917000000000001, 9.054333333333334, 9.254333333333333, 8.011333333333331, 10.442], "episode_lengths": [18, 22, 19, 18, 16, 15, 20, 24, 14, 22, 19, 17, 18, 20, 20, 18, 26, 16, 18, 14, 14, 17, 20, 21, 16, 19, 15, 16, 18, 18, 26, 17, 22, 20, 19, 18, 16, 19, 25, 16, 20, 21, 21, 21, 17, 18, 22, 19, 17, 21, 15, 23, 14, 16, 18, 14, 19, 16, 22, 23, 17, 20, 21, 24, 17, 16, 16, 17, 20, 19, 22, 17, 20, 19, 22, 17, 14, 22, 18, 15, 21, 15, 18, 22, 16, 15, 19, 21, 16, 21, 16, 14, 20, 22, 15, 15, 18, 19, 17, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4907111042905665, "mean_inference_ms": 2.775812746585647, "mean_action_processing_ms": 0.5504959191056847, "mean_env_wait_ms": 0.12900803140693468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02496814727783203, "StateBufferConnector_ms": 0.022434473037719727, "ViewRequirementAgentConnector_ms": 0.4625208377838135}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1359.305146239253, "num_env_steps_trained_throughput_per_sec": 1359.305146239253, "timesteps_total": 4200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 4200, "timers": {"training_iteration_time_ms": 1155.625, "sample_time_ms": 1038.049, "load_time_ms": 0.323, "load_throughput": 4336798.818, "learn_time_ms": 96.512, "learn_throughput": 14505.92, "synch_weights_time_ms": 20.064}, "counters": {"num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "done": false, "episodes_total": 221, "training_iteration": 3, "trial_id": "b37b2_00000", "date": "2023-12-07_23-38-57", "timestamp": 1702021137, "time_this_iter_s": 1.0460102558135986, "time_total_s": 3.5252394676208496, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.5252394676208496, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 97.15, "ram_util_percent": 97.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0985848903656006, "total_loss": 1.0985848903656006, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 5600}, "sampler_results": {"episode_reward_max": 12.322000000000006, "episode_reward_min": 5.942, "episode_reward_mean": 8.805043333333334, "episode_len_mean": 18.71, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.423333333333333, 11.041999999999998, 8.707333333333333, 6.308333333333333, 10.197666666666665, 7.054999999999999, 8.208333333333336, 9.489333333333335, 7.771999999999998, 6.549999999999999, 8.557666666666664, 9.099333333333334, 6.7989999999999995, 10.059333333333331, 7.267333333333332, 6.585666666666667, 9.416666666666666, 11.441999999999998, 7.189, 6.917000000000001, 9.054333333333334, 9.254333333333333, 8.011333333333331, 10.442, 9.64433333333333, 7.009999999999998, 12.322000000000006, 8.437999999999999, 9.914, 8.097, 7.476666666666667, 7.485, 8.402333333333333, 7.799999999999998, 8.022666666666666, 8.92233333333333, 10.036999999999997, 7.067333333333332, 8.006666666666666, 12.072, 9.594333333333335, 7.390333333333333, 8.022, 10.729999999999997, 8.667000000000002, 9.712, 10.434666666666663, 9.235, 9.864666666666663, 7.4043333333333345, 6.834333333333334, 10.025999999999996, 8.982999999999997, 8.481999999999998, 7.608666666666666, 8.592999999999998, 9.517333333333333, 8.787333333333333, 9.752666666666666, 9.12633333333333, 10.001999999999999, 8.413666666666668, 6.631666666666668, 11.153666666666664, 7.552333333333332, 8.689000000000002, 9.371999999999998, 9.252333333333334, 7.459666666666667, 9.864999999999995, 8.722, 8.991666666666667, 10.101666666666667, 7.172666666666664, 8.679999999999996, 8.213666666666665, 8.535999999999998, 6.427999999999999, 6.420333333333333, 6.8069999999999995, 11.392333333333333, 11.806666666666668, 10.601999999999999, 8.337666666666667, 9.508333333333333, 8.541666666666666, 11.124999999999995, 10.350666666666665, 8.062333333333333, 11.602666666666662, 9.119666666666664, 5.942, 7.439666666666666, 10.959999999999996, 11.898666666666669, 9.63133333333333, 10.905666666666667, 8.128333333333334, 7.703333333333331, 7.651333333333332], "episode_lengths": [14, 22, 18, 15, 21, 15, 18, 22, 16, 15, 19, 21, 16, 21, 16, 14, 20, 22, 15, 15, 18, 19, 17, 20, 21, 15, 24, 19, 21, 17, 16, 17, 17, 16, 18, 19, 19, 15, 19, 23, 24, 15, 17, 27, 23, 19, 21, 18, 20, 15, 15, 20, 20, 17, 15, 18, 20, 18, 19, 18, 21, 19, 14, 25, 16, 20, 21, 23, 17, 20, 19, 19, 20, 16, 18, 16, 17, 14, 16, 15, 24, 23, 23, 18, 20, 17, 21, 23, 18, 24, 20, 16, 17, 24, 21, 20, 21, 18, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4953568776458468, "mean_inference_ms": 2.7334899042483527, "mean_action_processing_ms": 0.56374006637498, "mean_env_wait_ms": 0.13739947692498272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02237725257873535, "StateBufferConnector_ms": 0.014245748519897461, "ViewRequirementAgentConnector_ms": 0.47411012649536133}}, "episode_reward_max": 12.322000000000006, "episode_reward_min": 5.942, "episode_reward_mean": 8.805043333333334, "episode_len_mean": 18.71, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.423333333333333, 11.041999999999998, 8.707333333333333, 6.308333333333333, 10.197666666666665, 7.054999999999999, 8.208333333333336, 9.489333333333335, 7.771999999999998, 6.549999999999999, 8.557666666666664, 9.099333333333334, 6.7989999999999995, 10.059333333333331, 7.267333333333332, 6.585666666666667, 9.416666666666666, 11.441999999999998, 7.189, 6.917000000000001, 9.054333333333334, 9.254333333333333, 8.011333333333331, 10.442, 9.64433333333333, 7.009999999999998, 12.322000000000006, 8.437999999999999, 9.914, 8.097, 7.476666666666667, 7.485, 8.402333333333333, 7.799999999999998, 8.022666666666666, 8.92233333333333, 10.036999999999997, 7.067333333333332, 8.006666666666666, 12.072, 9.594333333333335, 7.390333333333333, 8.022, 10.729999999999997, 8.667000000000002, 9.712, 10.434666666666663, 9.235, 9.864666666666663, 7.4043333333333345, 6.834333333333334, 10.025999999999996, 8.982999999999997, 8.481999999999998, 7.608666666666666, 8.592999999999998, 9.517333333333333, 8.787333333333333, 9.752666666666666, 9.12633333333333, 10.001999999999999, 8.413666666666668, 6.631666666666668, 11.153666666666664, 7.552333333333332, 8.689000000000002, 9.371999999999998, 9.252333333333334, 7.459666666666667, 9.864999999999995, 8.722, 8.991666666666667, 10.101666666666667, 7.172666666666664, 8.679999999999996, 8.213666666666665, 8.535999999999998, 6.427999999999999, 6.420333333333333, 6.8069999999999995, 11.392333333333333, 11.806666666666668, 10.601999999999999, 8.337666666666667, 9.508333333333333, 8.541666666666666, 11.124999999999995, 10.350666666666665, 8.062333333333333, 11.602666666666662, 9.119666666666664, 5.942, 7.439666666666666, 10.959999999999996, 11.898666666666669, 9.63133333333333, 10.905666666666667, 8.128333333333334, 7.703333333333331, 7.651333333333332], "episode_lengths": [14, 22, 18, 15, 21, 15, 18, 22, 16, 15, 19, 21, 16, 21, 16, 14, 20, 22, 15, 15, 18, 19, 17, 20, 21, 15, 24, 19, 21, 17, 16, 17, 17, 16, 18, 19, 19, 15, 19, 23, 24, 15, 17, 27, 23, 19, 21, 18, 20, 15, 15, 20, 20, 17, 15, 18, 20, 18, 19, 18, 21, 19, 14, 25, 16, 20, 21, 23, 17, 20, 19, 19, 20, 16, 18, 16, 17, 14, 16, 15, 24, 23, 23, 18, 20, 17, 21, 23, 18, 24, 20, 16, 17, 24, 21, 20, 21, 18, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4953568776458468, "mean_inference_ms": 2.7334899042483527, "mean_action_processing_ms": 0.56374006637498, "mean_env_wait_ms": 0.13739947692498272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02237725257873535, "StateBufferConnector_ms": 0.014245748519897461, "ViewRequirementAgentConnector_ms": 0.47411012649536133}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 5600, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1302.6051768125753, "num_env_steps_trained_throughput_per_sec": 1302.6051768125753, "timesteps_total": 5600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 5600, "timers": {"training_iteration_time_ms": 1135.411, "sample_time_ms": 1039.229, "load_time_ms": 0.242, "load_throughput": 5782398.424, "learn_time_ms": 75.134, "learn_throughput": 18633.395, "synch_weights_time_ms": 20.299}, "counters": {"num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 5600}, "done": false, "episodes_total": 297, "training_iteration": 4, "trial_id": "b37b2_00000", "date": "2023-12-07_23-38-58", "timestamp": 1702021138, "time_this_iter_s": 1.0907678604125977, "time_total_s": 4.616007328033447, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.616007328033447, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 92.3, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0985122919082642, "total_loss": 1.0985122919082642, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 7000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 7000}, "sampler_results": {"episode_reward_max": 14.196999999999994, "episode_reward_min": 5.732333333333333, "episode_reward_mean": 8.933256666666667, "episode_len_mean": 18.88, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.101666666666667, 7.172666666666664, 8.679999999999996, 8.213666666666665, 8.535999999999998, 6.427999999999999, 6.420333333333333, 6.8069999999999995, 11.392333333333333, 11.806666666666668, 10.601999999999999, 8.337666666666667, 9.508333333333333, 8.541666666666666, 11.124999999999995, 10.350666666666665, 8.062333333333333, 11.602666666666662, 9.119666666666664, 5.942, 7.439666666666666, 10.959999999999996, 11.898666666666669, 9.63133333333333, 10.905666666666667, 8.128333333333334, 7.703333333333331, 7.651333333333332, 7.648000000000001, 10.840666666666664, 7.700333333333331, 8.158333333333331, 7.118666666666666, 9.216666666666665, 7.136666666666667, 9.971333333333334, 14.196999999999994, 10.875999999999996, 10.13733333333333, 8.881333333333334, 11.77033333333333, 8.463333333333333, 6.7173333333333325, 11.007999999999996, 8.528666666666664, 9.603999999999996, 6.9239999999999995, 10.113333333333335, 10.668666666666663, 11.381666666666666, 7.6726666666666645, 6.962999999999998, 10.762666666666663, 10.827999999999996, 10.487000000000002, 9.989333333333333, 10.330999999999998, 11.405999999999997, 11.043000000000001, 10.978666666666665, 7.640666666666668, 7.217999999999998, 11.986333333333338, 7.301333333333332, 7.0246666666666675, 7.281666666666666, 7.517666666666667, 5.977333333333332, 10.159999999999998, 7.501999999999999, 9.872666666666667, 8.437666666666663, 10.030333333333331, 7.188333333333333, 9.697333333333333, 7.709333333333331, 7.282333333333332, 8.978, 7.2666666666666675, 9.212, 10.453000000000001, 6.272333333333332, 9.024, 7.7473333333333345, 7.464333333333332, 11.458, 9.634333333333332, 10.24933333333333, 7.097999999999998, 8.423333333333332, 8.11533333333333, 7.347333333333334, 9.055999999999997, 6.906000000000001, 7.6386666666666665, 9.021333333333333, 7.435999999999997, 10.322666666666665, 5.732333333333333, 8.05], "episode_lengths": [20, 16, 18, 16, 17, 14, 16, 15, 24, 23, 23, 18, 20, 17, 21, 23, 18, 24, 20, 16, 17, 24, 21, 20, 21, 18, 16, 17, 16, 23, 19, 17, 16, 20, 16, 25, 28, 20, 23, 19, 26, 18, 16, 21, 16, 21, 15, 20, 21, 24, 17, 15, 24, 21, 22, 19, 23, 22, 22, 22, 16, 15, 28, 15, 15, 16, 15, 16, 20, 15, 20, 18, 19, 16, 20, 16, 16, 21, 15, 18, 24, 14, 19, 15, 17, 25, 21, 19, 14, 20, 16, 15, 18, 16, 16, 17, 18, 25, 13, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4918114324433578, "mean_inference_ms": 2.702803313444085, "mean_action_processing_ms": 0.5640464993799175, "mean_env_wait_ms": 0.1364274128180832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012276649475097656, "StateBufferConnector_ms": 0.0196073055267334, "ViewRequirementAgentConnector_ms": 0.5161409378051758}}, "episode_reward_max": 14.196999999999994, "episode_reward_min": 5.732333333333333, "episode_reward_mean": 8.933256666666667, "episode_len_mean": 18.88, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.101666666666667, 7.172666666666664, 8.679999999999996, 8.213666666666665, 8.535999999999998, 6.427999999999999, 6.420333333333333, 6.8069999999999995, 11.392333333333333, 11.806666666666668, 10.601999999999999, 8.337666666666667, 9.508333333333333, 8.541666666666666, 11.124999999999995, 10.350666666666665, 8.062333333333333, 11.602666666666662, 9.119666666666664, 5.942, 7.439666666666666, 10.959999999999996, 11.898666666666669, 9.63133333333333, 10.905666666666667, 8.128333333333334, 7.703333333333331, 7.651333333333332, 7.648000000000001, 10.840666666666664, 7.700333333333331, 8.158333333333331, 7.118666666666666, 9.216666666666665, 7.136666666666667, 9.971333333333334, 14.196999999999994, 10.875999999999996, 10.13733333333333, 8.881333333333334, 11.77033333333333, 8.463333333333333, 6.7173333333333325, 11.007999999999996, 8.528666666666664, 9.603999999999996, 6.9239999999999995, 10.113333333333335, 10.668666666666663, 11.381666666666666, 7.6726666666666645, 6.962999999999998, 10.762666666666663, 10.827999999999996, 10.487000000000002, 9.989333333333333, 10.330999999999998, 11.405999999999997, 11.043000000000001, 10.978666666666665, 7.640666666666668, 7.217999999999998, 11.986333333333338, 7.301333333333332, 7.0246666666666675, 7.281666666666666, 7.517666666666667, 5.977333333333332, 10.159999999999998, 7.501999999999999, 9.872666666666667, 8.437666666666663, 10.030333333333331, 7.188333333333333, 9.697333333333333, 7.709333333333331, 7.282333333333332, 8.978, 7.2666666666666675, 9.212, 10.453000000000001, 6.272333333333332, 9.024, 7.7473333333333345, 7.464333333333332, 11.458, 9.634333333333332, 10.24933333333333, 7.097999999999998, 8.423333333333332, 8.11533333333333, 7.347333333333334, 9.055999999999997, 6.906000000000001, 7.6386666666666665, 9.021333333333333, 7.435999999999997, 10.322666666666665, 5.732333333333333, 8.05], "episode_lengths": [20, 16, 18, 16, 17, 14, 16, 15, 24, 23, 23, 18, 20, 17, 21, 23, 18, 24, 20, 16, 17, 24, 21, 20, 21, 18, 16, 17, 16, 23, 19, 17, 16, 20, 16, 25, 28, 20, 23, 19, 26, 18, 16, 21, 16, 21, 15, 20, 21, 24, 17, 15, 24, 21, 22, 19, 23, 22, 22, 22, 16, 15, 28, 15, 15, 16, 15, 16, 20, 15, 20, 18, 19, 16, 20, 16, 16, 21, 15, 18, 24, 14, 19, 15, 17, 25, 21, 19, 14, 20, 16, 15, 18, 16, 16, 17, 18, 25, 13, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4918114324433578, "mean_inference_ms": 2.702803313444085, "mean_action_processing_ms": 0.5640464993799175, "mean_env_wait_ms": 0.1364274128180832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012276649475097656, "StateBufferConnector_ms": 0.0196073055267334, "ViewRequirementAgentConnector_ms": 0.5161409378051758}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 7000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 7000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1379.2175464268391, "num_env_steps_trained_throughput_per_sec": 1379.2175464268391, "timesteps_total": 7000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 1111.142, "sample_time_ms": 1027.996, "load_time_ms": 0.194, "load_throughput": 7227998.031, "learn_time_ms": 62.507, "learn_throughput": 22397.351, "synch_weights_time_ms": 20.039}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 7000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 7000}, "done": false, "episodes_total": 369, "training_iteration": 5, "trial_id": "b37b2_00000", "date": "2023-12-07_23-38-59", "timestamp": 1702021139, "time_this_iter_s": 1.0300624370574951, "time_total_s": 5.646069765090942, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 5.646069765090942, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 90.9, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0986952781677246, "total_loss": 1.0986952781677246, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": 13.384666666666668, "episode_reward_min": 5.732333333333333, "episode_reward_mean": 8.565053333333333, "episode_len_mean": 18.45, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.282333333333332, 8.978, 7.2666666666666675, 9.212, 10.453000000000001, 6.272333333333332, 9.024, 7.7473333333333345, 7.464333333333332, 11.458, 9.634333333333332, 10.24933333333333, 7.097999999999998, 8.423333333333332, 8.11533333333333, 7.347333333333334, 9.055999999999997, 6.906000000000001, 7.6386666666666665, 9.021333333333333, 7.435999999999997, 10.322666666666665, 5.732333333333333, 8.05, 7.639333333333333, 10.191333333333333, 7.7236666666666665, 13.384666666666668, 9.48766666666667, 8.254999999999997, 9.995666666666667, 7.346333333333333, 8.129333333333332, 7.704999999999998, 7.515999999999998, 7.1306666666666665, 9.081999999999999, 9.988666666666667, 7.427333333333333, 8.282333333333332, 6.484333333333333, 7.335666666666665, 7.307666666666666, 10.353333333333335, 10.435333333333334, 9.157, 6.758333333333335, 8.463666666666665, 8.916, 8.854, 6.827666666666665, 11.376333333333331, 10.289, 7.7639999999999985, 7.9979999999999976, 9.173333333333332, 11.868333333333332, 7.379666666666668, 11.041666666666664, 6.641666666666666, 7.239333333333332, 9.702666666666664, 10.232666666666663, 7.325333333333333, 8.643999999999997, 9.414333333333332, 7.435666666666665, 7.433333333333334, 10.486999999999997, 8.076666666666664, 8.383333333333335, 6.970666666666666, 10.687333333333333, 8.799333333333331, 8.980666666666666, 8.440666666666667, 8.993666666666666, 10.050333333333334, 9.90433333333333, 9.471666666666666, 7.942, 8.681666666666667, 8.403333333333332, 8.208666666666664, 8.362666666666666, 7.154333333333332, 7.137999999999998, 9.822999999999999, 6.052333333333332, 11.774999999999999, 7.686999999999997, 8.259999999999998, 7.596666666666666, 7.443999999999999, 7.519, 8.073666666666664, 6.405333333333331, 10.067, 11.11933333333333, 8.220666666666666], "episode_lengths": [16, 21, 15, 18, 24, 14, 19, 15, 17, 25, 21, 19, 14, 20, 16, 15, 18, 16, 16, 17, 18, 25, 13, 16, 16, 20, 16, 31, 19, 20, 22, 15, 17, 20, 16, 15, 20, 21, 16, 19, 15, 16, 16, 22, 25, 22, 14, 19, 18, 21, 14, 24, 20, 16, 17, 19, 24, 15, 21, 17, 16, 20, 21, 19, 18, 20, 16, 16, 21, 18, 17, 14, 20, 20, 17, 19, 21, 22, 21, 19, 18, 18, 19, 18, 18, 18, 15, 23, 13, 27, 18, 19, 17, 17, 16, 16, 13, 20, 23, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4566458487198304, "mean_inference_ms": 2.676500647523884, "mean_action_processing_ms": 0.5609674686822934, "mean_env_wait_ms": 0.13695640367098136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013345003128051758, "StateBufferConnector_ms": 0.013628959655761719, "ViewRequirementAgentConnector_ms": 0.4343891143798828}}, "episode_reward_max": 13.384666666666668, "episode_reward_min": 5.732333333333333, "episode_reward_mean": 8.565053333333333, "episode_len_mean": 18.45, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.282333333333332, 8.978, 7.2666666666666675, 9.212, 10.453000000000001, 6.272333333333332, 9.024, 7.7473333333333345, 7.464333333333332, 11.458, 9.634333333333332, 10.24933333333333, 7.097999999999998, 8.423333333333332, 8.11533333333333, 7.347333333333334, 9.055999999999997, 6.906000000000001, 7.6386666666666665, 9.021333333333333, 7.435999999999997, 10.322666666666665, 5.732333333333333, 8.05, 7.639333333333333, 10.191333333333333, 7.7236666666666665, 13.384666666666668, 9.48766666666667, 8.254999999999997, 9.995666666666667, 7.346333333333333, 8.129333333333332, 7.704999999999998, 7.515999999999998, 7.1306666666666665, 9.081999999999999, 9.988666666666667, 7.427333333333333, 8.282333333333332, 6.484333333333333, 7.335666666666665, 7.307666666666666, 10.353333333333335, 10.435333333333334, 9.157, 6.758333333333335, 8.463666666666665, 8.916, 8.854, 6.827666666666665, 11.376333333333331, 10.289, 7.7639999999999985, 7.9979999999999976, 9.173333333333332, 11.868333333333332, 7.379666666666668, 11.041666666666664, 6.641666666666666, 7.239333333333332, 9.702666666666664, 10.232666666666663, 7.325333333333333, 8.643999999999997, 9.414333333333332, 7.435666666666665, 7.433333333333334, 10.486999999999997, 8.076666666666664, 8.383333333333335, 6.970666666666666, 10.687333333333333, 8.799333333333331, 8.980666666666666, 8.440666666666667, 8.993666666666666, 10.050333333333334, 9.90433333333333, 9.471666666666666, 7.942, 8.681666666666667, 8.403333333333332, 8.208666666666664, 8.362666666666666, 7.154333333333332, 7.137999999999998, 9.822999999999999, 6.052333333333332, 11.774999999999999, 7.686999999999997, 8.259999999999998, 7.596666666666666, 7.443999999999999, 7.519, 8.073666666666664, 6.405333333333331, 10.067, 11.11933333333333, 8.220666666666666], "episode_lengths": [16, 21, 15, 18, 24, 14, 19, 15, 17, 25, 21, 19, 14, 20, 16, 15, 18, 16, 16, 17, 18, 25, 13, 16, 16, 20, 16, 31, 19, 20, 22, 15, 17, 20, 16, 15, 20, 21, 16, 19, 15, 16, 16, 22, 25, 22, 14, 19, 18, 21, 14, 24, 20, 16, 17, 19, 24, 15, 21, 17, 16, 20, 21, 19, 18, 20, 16, 16, 21, 18, 17, 14, 20, 20, 17, 19, 21, 22, 21, 19, 18, 18, 19, 18, 18, 18, 15, 23, 13, 27, 18, 19, 17, 17, 16, 16, 13, 20, 23, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4566458487198304, "mean_inference_ms": 2.676500647523884, "mean_action_processing_ms": 0.5609674686822934, "mean_env_wait_ms": 0.13695640367098136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013345003128051758, "StateBufferConnector_ms": 0.013628959655761719, "ViewRequirementAgentConnector_ms": 0.4343891143798828}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1427.2585259001812, "num_env_steps_trained_throughput_per_sec": 1427.2585259001812, "timesteps_total": 8400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 1089.435, "sample_time_ms": 1014.472, "load_time_ms": 0.328, "load_throughput": 4262813.503, "learn_time_ms": 54.089, "learn_throughput": 25883.176, "synch_weights_time_ms": 20.208}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 445, "training_iteration": 6, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-00", "timestamp": 1702021140, "time_this_iter_s": 1.001847267150879, "time_total_s": 6.647917032241821, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.647917032241821, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 96.5, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.098358154296875, "total_loss": 1.098358154296875, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 9800, "num_env_steps_trained": 9800, "num_agent_steps_sampled": 9800, "num_agent_steps_trained": 9800}, "sampler_results": {"episode_reward_max": 12.648999999999997, "episode_reward_min": 5.875333333333333, "episode_reward_mean": 8.841593333333332, "episode_len_mean": 18.9, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.799333333333331, 8.980666666666666, 8.440666666666667, 8.993666666666666, 10.050333333333334, 9.90433333333333, 9.471666666666666, 7.942, 8.681666666666667, 8.403333333333332, 8.208666666666664, 8.362666666666666, 7.154333333333332, 7.137999999999998, 9.822999999999999, 6.052333333333332, 11.774999999999999, 7.686999999999997, 8.259999999999998, 7.596666666666666, 7.443999999999999, 7.519, 8.073666666666664, 6.405333333333331, 10.067, 11.11933333333333, 8.220666666666666, 9.592, 8.730666666666664, 8.388999999999998, 8.364999999999998, 7.931666666666667, 9.774000000000001, 6.287, 8.296, 10.867999999999999, 7.802666666666668, 9.359999999999998, 7.21, 7.5873333333333335, 8.721333333333332, 8.930666666666664, 11.123, 8.308666666666666, 9.456, 10.322666666666665, 6.851333333333332, 8.125666666666664, 8.800333333333333, 9.55433333333333, 9.324666666666664, 10.179, 7.711333333333332, 8.127666666666665, 9.988, 9.027999999999999, 12.330333333333334, 8.857333333333335, 11.035666666666666, 8.690666666666667, 9.332, 6.8853333333333335, 9.81133333333333, 10.91, 8.378666666666668, 9.790666666666665, 9.204666666666666, 12.520333333333332, 8.841999999999999, 7.267333333333331, 7.275666666666665, 8.235666666666667, 8.467333333333332, 7.3036666666666665, 10.206999999999999, 9.382666666666667, 9.256666666666666, 10.869999999999997, 8.811333333333334, 9.568999999999999, 8.197999999999999, 9.050666666666666, 7.348999999999998, 8.085999999999999, 7.184333333333332, 5.875333333333333, 9.885666666666667, 8.390000000000002, 10.056, 10.91366666666667, 12.648999999999997, 9.289666666666665, 7.794666666666665, 8.378, 11.335333333333333, 9.465333333333328, 8.451666666666666, 6.586333333333333, 6.706666666666664, 9.95833333333333], "episode_lengths": [20, 17, 19, 21, 22, 21, 19, 18, 18, 19, 18, 18, 18, 15, 23, 13, 27, 18, 19, 17, 17, 16, 16, 13, 20, 23, 18, 19, 19, 20, 17, 19, 21, 15, 18, 23, 18, 18, 15, 16, 19, 20, 21, 19, 20, 19, 15, 19, 19, 19, 18, 20, 17, 18, 20, 21, 26, 19, 23, 18, 19, 14, 20, 22, 19, 21, 20, 23, 19, 16, 17, 18, 19, 17, 21, 21, 20, 21, 18, 22, 17, 19, 16, 16, 16, 13, 23, 18, 22, 23, 25, 19, 16, 17, 25, 21, 18, 14, 14, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4331144013448682, "mean_inference_ms": 2.6312144933560404, "mean_action_processing_ms": 0.5526008457110584, "mean_env_wait_ms": 0.13353598319738721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02270793914794922, "StateBufferConnector_ms": 0.013169050216674805, "ViewRequirementAgentConnector_ms": 0.4593331813812256}}, "episode_reward_max": 12.648999999999997, "episode_reward_min": 5.875333333333333, "episode_reward_mean": 8.841593333333332, "episode_len_mean": 18.9, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.799333333333331, 8.980666666666666, 8.440666666666667, 8.993666666666666, 10.050333333333334, 9.90433333333333, 9.471666666666666, 7.942, 8.681666666666667, 8.403333333333332, 8.208666666666664, 8.362666666666666, 7.154333333333332, 7.137999999999998, 9.822999999999999, 6.052333333333332, 11.774999999999999, 7.686999999999997, 8.259999999999998, 7.596666666666666, 7.443999999999999, 7.519, 8.073666666666664, 6.405333333333331, 10.067, 11.11933333333333, 8.220666666666666, 9.592, 8.730666666666664, 8.388999999999998, 8.364999999999998, 7.931666666666667, 9.774000000000001, 6.287, 8.296, 10.867999999999999, 7.802666666666668, 9.359999999999998, 7.21, 7.5873333333333335, 8.721333333333332, 8.930666666666664, 11.123, 8.308666666666666, 9.456, 10.322666666666665, 6.851333333333332, 8.125666666666664, 8.800333333333333, 9.55433333333333, 9.324666666666664, 10.179, 7.711333333333332, 8.127666666666665, 9.988, 9.027999999999999, 12.330333333333334, 8.857333333333335, 11.035666666666666, 8.690666666666667, 9.332, 6.8853333333333335, 9.81133333333333, 10.91, 8.378666666666668, 9.790666666666665, 9.204666666666666, 12.520333333333332, 8.841999999999999, 7.267333333333331, 7.275666666666665, 8.235666666666667, 8.467333333333332, 7.3036666666666665, 10.206999999999999, 9.382666666666667, 9.256666666666666, 10.869999999999997, 8.811333333333334, 9.568999999999999, 8.197999999999999, 9.050666666666666, 7.348999999999998, 8.085999999999999, 7.184333333333332, 5.875333333333333, 9.885666666666667, 8.390000000000002, 10.056, 10.91366666666667, 12.648999999999997, 9.289666666666665, 7.794666666666665, 8.378, 11.335333333333333, 9.465333333333328, 8.451666666666666, 6.586333333333333, 6.706666666666664, 9.95833333333333], "episode_lengths": [20, 17, 19, 21, 22, 21, 19, 18, 18, 19, 18, 18, 18, 15, 23, 13, 27, 18, 19, 17, 17, 16, 16, 13, 20, 23, 18, 19, 19, 20, 17, 19, 21, 15, 18, 23, 18, 18, 15, 16, 19, 20, 21, 19, 20, 19, 15, 19, 19, 19, 18, 20, 17, 18, 20, 21, 26, 19, 23, 18, 19, 14, 20, 22, 19, 21, 20, 23, 19, 16, 17, 18, 19, 17, 21, 21, 20, 21, 18, 22, 17, 19, 16, 16, 16, 13, 23, 18, 22, 23, 25, 19, 16, 17, 25, 21, 18, 14, 14, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4331144013448682, "mean_inference_ms": 2.6312144933560404, "mean_action_processing_ms": 0.5526008457110584, "mean_env_wait_ms": 0.13353598319738721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02270793914794922, "StateBufferConnector_ms": 0.013169050216674805, "ViewRequirementAgentConnector_ms": 0.4593331813812256}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9800, "num_agent_steps_trained": 9800, "num_env_steps_sampled": 9800, "num_env_steps_trained": 9800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1543.408462898562, "num_env_steps_trained_throughput_per_sec": 1543.408462898562, "timesteps_total": 9800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 9800, "timers": {"training_iteration_time_ms": 1063.385, "sample_time_ms": 994.702, "load_time_ms": 0.282, "load_throughput": 4973282.42, "learn_time_ms": 47.934, "learn_throughput": 29206.938, "synch_weights_time_ms": 20.178}, "counters": {"num_env_steps_sampled": 9800, "num_env_steps_trained": 9800, "num_agent_steps_sampled": 9800, "num_agent_steps_trained": 9800}, "done": false, "episodes_total": 518, "training_iteration": 7, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-01", "timestamp": 1702021141, "time_this_iter_s": 0.9220812320709229, "time_total_s": 7.569998264312744, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.569998264312744, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 93.7, "ram_util_percent": 97.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0984735488891602, "total_loss": 1.0984735488891602, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "sampler_results": {"episode_reward_max": 14.577999999999994, "episode_reward_min": 5.875333333333333, "episode_reward_mean": 8.96312333333333, "episode_len_mean": 19.03, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.3036666666666665, 10.206999999999999, 9.382666666666667, 9.256666666666666, 10.869999999999997, 8.811333333333334, 9.568999999999999, 8.197999999999999, 9.050666666666666, 7.348999999999998, 8.085999999999999, 7.184333333333332, 5.875333333333333, 9.885666666666667, 8.390000000000002, 10.056, 10.91366666666667, 12.648999999999997, 9.289666666666665, 7.794666666666665, 8.378, 11.335333333333333, 9.465333333333328, 8.451666666666666, 6.586333333333333, 6.706666666666664, 9.95833333333333, 7.457333333333333, 8.882666666666665, 9.373666666666665, 10.093999999999998, 7.493999999999997, 9.183999999999997, 11.596666666666664, 10.22333333333333, 7.095999999999999, 9.734, 10.363333333333332, 6.298, 7.6080000000000005, 12.627333333333334, 12.275666666666668, 7.183666666666666, 10.840666666666664, 8.118666666666664, 6.764999999999999, 7.999666666666665, 7.484666666666666, 9.911999999999999, 8.668333333333335, 10.461666666666664, 9.629666666666665, 7.355666666666664, 10.833333333333334, 13.537666666666663, 6.1499999999999995, 6.761999999999999, 8.624666666666663, 6.9543333333333335, 10.74433333333333, 8.67933333333333, 7.152333333333331, 9.458666666666662, 10.155000000000001, 8.911333333333332, 10.539333333333332, 14.577999999999994, 7.4226666666666645, 7.227333333333333, 9.359666666666664, 6.442333333333332, 8.664, 9.854333333333331, 7.6049999999999995, 9.770999999999999, 7.827666666666665, 10.540333333333333, 8.120666666666667, 9.004333333333332, 6.286666666666665, 7.196999999999999, 10.849333333333332, 9.283, 7.710333333333331, 7.453666666666666, 11.444666666666667, 9.835999999999999, 6.425666666666666, 6.871666666666667, 8.674999999999999, 9.0, 8.967333333333334, 9.602333333333332, 8.194666666666667, 9.684999999999999, 8.948666666666666, 8.621999999999998, 9.083000000000002, 9.149999999999999, 12.375000000000002], "episode_lengths": [17, 21, 21, 20, 21, 18, 22, 17, 19, 16, 16, 16, 13, 23, 18, 22, 23, 25, 19, 16, 17, 25, 21, 18, 14, 14, 20, 15, 21, 19, 24, 17, 20, 26, 22, 16, 19, 22, 14, 16, 23, 25, 16, 22, 17, 14, 18, 16, 21, 17, 19, 22, 15, 24, 24, 13, 15, 21, 14, 22, 19, 16, 21, 21, 19, 25, 28, 15, 16, 21, 15, 19, 20, 16, 23, 16, 21, 18, 19, 13, 17, 21, 18, 17, 16, 28, 20, 15, 15, 19, 19, 19, 20, 16, 21, 20, 17, 19, 19, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.414949358475006, "mean_inference_ms": 2.5890082018185705, "mean_action_processing_ms": 0.5452786883875683, "mean_env_wait_ms": 0.1326882822360524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059006690979003906, "StateBufferConnector_ms": 0.016225814819335938, "ViewRequirementAgentConnector_ms": 0.40368032455444336}}, "episode_reward_max": 14.577999999999994, "episode_reward_min": 5.875333333333333, "episode_reward_mean": 8.96312333333333, "episode_len_mean": 19.03, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.3036666666666665, 10.206999999999999, 9.382666666666667, 9.256666666666666, 10.869999999999997, 8.811333333333334, 9.568999999999999, 8.197999999999999, 9.050666666666666, 7.348999999999998, 8.085999999999999, 7.184333333333332, 5.875333333333333, 9.885666666666667, 8.390000000000002, 10.056, 10.91366666666667, 12.648999999999997, 9.289666666666665, 7.794666666666665, 8.378, 11.335333333333333, 9.465333333333328, 8.451666666666666, 6.586333333333333, 6.706666666666664, 9.95833333333333, 7.457333333333333, 8.882666666666665, 9.373666666666665, 10.093999999999998, 7.493999999999997, 9.183999999999997, 11.596666666666664, 10.22333333333333, 7.095999999999999, 9.734, 10.363333333333332, 6.298, 7.6080000000000005, 12.627333333333334, 12.275666666666668, 7.183666666666666, 10.840666666666664, 8.118666666666664, 6.764999999999999, 7.999666666666665, 7.484666666666666, 9.911999999999999, 8.668333333333335, 10.461666666666664, 9.629666666666665, 7.355666666666664, 10.833333333333334, 13.537666666666663, 6.1499999999999995, 6.761999999999999, 8.624666666666663, 6.9543333333333335, 10.74433333333333, 8.67933333333333, 7.152333333333331, 9.458666666666662, 10.155000000000001, 8.911333333333332, 10.539333333333332, 14.577999999999994, 7.4226666666666645, 7.227333333333333, 9.359666666666664, 6.442333333333332, 8.664, 9.854333333333331, 7.6049999999999995, 9.770999999999999, 7.827666666666665, 10.540333333333333, 8.120666666666667, 9.004333333333332, 6.286666666666665, 7.196999999999999, 10.849333333333332, 9.283, 7.710333333333331, 7.453666666666666, 11.444666666666667, 9.835999999999999, 6.425666666666666, 6.871666666666667, 8.674999999999999, 9.0, 8.967333333333334, 9.602333333333332, 8.194666666666667, 9.684999999999999, 8.948666666666666, 8.621999999999998, 9.083000000000002, 9.149999999999999, 12.375000000000002], "episode_lengths": [17, 21, 21, 20, 21, 18, 22, 17, 19, 16, 16, 16, 13, 23, 18, 22, 23, 25, 19, 16, 17, 25, 21, 18, 14, 14, 20, 15, 21, 19, 24, 17, 20, 26, 22, 16, 19, 22, 14, 16, 23, 25, 16, 22, 17, 14, 18, 16, 21, 17, 19, 22, 15, 24, 24, 13, 15, 21, 14, 22, 19, 16, 21, 21, 19, 25, 28, 15, 16, 21, 15, 19, 20, 16, 23, 16, 21, 18, 19, 13, 17, 21, 18, 17, 16, 28, 20, 15, 15, 19, 19, 19, 20, 16, 21, 20, 17, 19, 19, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.414949358475006, "mean_inference_ms": 2.5890082018185705, "mean_action_processing_ms": 0.5452786883875683, "mean_env_wait_ms": 0.1326882822360524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059006690979003906, "StateBufferConnector_ms": 0.016225814819335938, "ViewRequirementAgentConnector_ms": 0.40368032455444336}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1501.6240074671714, "num_env_steps_trained_throughput_per_sec": 1501.6240074671714, "timesteps_total": 11200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 11200, "timers": {"training_iteration_time_ms": 1047.002, "sample_time_ms": 983.409, "load_time_ms": 0.246, "load_throughput": 5683751.337, "learn_time_ms": 43.313, "learn_throughput": 32322.884, "synch_weights_time_ms": 19.781}, "counters": {"num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "done": false, "episodes_total": 591, "training_iteration": 8, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-02", "timestamp": 1702021142, "time_this_iter_s": 0.9473259449005127, "time_total_s": 8.517324209213257, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 8.517324209213257, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 94.0, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0987868309020996, "total_loss": 1.0987868309020996, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 12600, "num_env_steps_trained": 12600, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12600}, "sampler_results": {"episode_reward_max": 17.51533333333333, "episode_reward_min": 5.849333333333332, "episode_reward_mean": 8.981593333333333, "episode_len_mean": 19.07, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.6049999999999995, 9.770999999999999, 7.827666666666665, 10.540333333333333, 8.120666666666667, 9.004333333333332, 6.286666666666665, 7.196999999999999, 10.849333333333332, 9.283, 7.710333333333331, 7.453666666666666, 11.444666666666667, 9.835999999999999, 6.425666666666666, 6.871666666666667, 8.674999999999999, 9.0, 8.967333333333334, 9.602333333333332, 8.194666666666667, 9.684999999999999, 8.948666666666666, 8.621999999999998, 9.083000000000002, 9.149999999999999, 12.375000000000002, 8.795333333333332, 9.271999999999998, 11.681666666666661, 9.270333333333333, 8.803333333333333, 8.608999999999998, 8.83633333333333, 11.771666666666663, 10.52133333333333, 7.140999999999997, 8.901999999999997, 11.885666666666662, 6.944, 7.028, 10.074333333333334, 8.386333333333333, 9.251999999999999, 5.849333333333332, 9.806999999999997, 8.292, 11.207666666666666, 10.569333333333331, 6.701999999999999, 7.843333333333333, 8.904999999999998, 6.626333333333333, 12.007, 9.703333333333328, 7.742666666666665, 7.326, 10.471666666666668, 8.053333333333333, 7.4656666666666665, 8.729333333333333, 6.732333333333333, 8.440333333333333, 12.2, 9.135666666666665, 12.88666666666666, 7.884333333333332, 7.288333333333333, 8.555666666666667, 9.517666666666665, 7.831999999999999, 10.616333333333332, 7.882000000000001, 7.6836666666666655, 8.601333333333333, 10.824333333333334, 7.951333333333332, 10.714333333333332, 9.486333333333333, 9.826000000000002, 7.875333333333333, 17.51533333333333, 11.700999999999997, 9.172333333333334, 7.540999999999999, 8.721666666666666, 8.630999999999998, 8.336666666666664, 7.897333333333333, 10.465333333333334, 6.9706666666666655, 8.830666666666666, 8.011333333333335, 6.595666666666666, 7.751666666666665, 10.598666666666665, 6.798, 10.780333333333331, 9.289, 7.612333333333333], "episode_lengths": [16, 23, 16, 21, 18, 19, 13, 17, 21, 18, 17, 16, 28, 20, 15, 15, 19, 19, 19, 20, 16, 21, 20, 17, 19, 19, 25, 19, 18, 24, 19, 18, 19, 19, 23, 21, 16, 17, 25, 14, 18, 19, 17, 21, 13, 24, 17, 23, 21, 15, 15, 18, 15, 26, 20, 17, 17, 21, 17, 17, 19, 14, 18, 26, 19, 26, 17, 15, 21, 18, 20, 22, 16, 16, 18, 25, 16, 21, 21, 22, 17, 32, 26, 20, 16, 21, 17, 20, 18, 24, 16, 18, 18, 15, 16, 19, 16, 23, 18, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3961431738416195, "mean_inference_ms": 2.55065588528035, "mean_action_processing_ms": 0.5394612628920187, "mean_env_wait_ms": 0.12990947412438825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01989006996154785, "StateBufferConnector_ms": 0.009090662002563477, "ViewRequirementAgentConnector_ms": 0.3800632953643799}}, "episode_reward_max": 17.51533333333333, "episode_reward_min": 5.849333333333332, "episode_reward_mean": 8.981593333333333, "episode_len_mean": 19.07, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.6049999999999995, 9.770999999999999, 7.827666666666665, 10.540333333333333, 8.120666666666667, 9.004333333333332, 6.286666666666665, 7.196999999999999, 10.849333333333332, 9.283, 7.710333333333331, 7.453666666666666, 11.444666666666667, 9.835999999999999, 6.425666666666666, 6.871666666666667, 8.674999999999999, 9.0, 8.967333333333334, 9.602333333333332, 8.194666666666667, 9.684999999999999, 8.948666666666666, 8.621999999999998, 9.083000000000002, 9.149999999999999, 12.375000000000002, 8.795333333333332, 9.271999999999998, 11.681666666666661, 9.270333333333333, 8.803333333333333, 8.608999999999998, 8.83633333333333, 11.771666666666663, 10.52133333333333, 7.140999999999997, 8.901999999999997, 11.885666666666662, 6.944, 7.028, 10.074333333333334, 8.386333333333333, 9.251999999999999, 5.849333333333332, 9.806999999999997, 8.292, 11.207666666666666, 10.569333333333331, 6.701999999999999, 7.843333333333333, 8.904999999999998, 6.626333333333333, 12.007, 9.703333333333328, 7.742666666666665, 7.326, 10.471666666666668, 8.053333333333333, 7.4656666666666665, 8.729333333333333, 6.732333333333333, 8.440333333333333, 12.2, 9.135666666666665, 12.88666666666666, 7.884333333333332, 7.288333333333333, 8.555666666666667, 9.517666666666665, 7.831999999999999, 10.616333333333332, 7.882000000000001, 7.6836666666666655, 8.601333333333333, 10.824333333333334, 7.951333333333332, 10.714333333333332, 9.486333333333333, 9.826000000000002, 7.875333333333333, 17.51533333333333, 11.700999999999997, 9.172333333333334, 7.540999999999999, 8.721666666666666, 8.630999999999998, 8.336666666666664, 7.897333333333333, 10.465333333333334, 6.9706666666666655, 8.830666666666666, 8.011333333333335, 6.595666666666666, 7.751666666666665, 10.598666666666665, 6.798, 10.780333333333331, 9.289, 7.612333333333333], "episode_lengths": [16, 23, 16, 21, 18, 19, 13, 17, 21, 18, 17, 16, 28, 20, 15, 15, 19, 19, 19, 20, 16, 21, 20, 17, 19, 19, 25, 19, 18, 24, 19, 18, 19, 19, 23, 21, 16, 17, 25, 14, 18, 19, 17, 21, 13, 24, 17, 23, 21, 15, 15, 18, 15, 26, 20, 17, 17, 21, 17, 17, 19, 14, 18, 26, 19, 26, 17, 15, 21, 18, 20, 22, 16, 16, 18, 25, 16, 21, 21, 22, 17, 32, 26, 20, 16, 21, 17, 20, 18, 24, 16, 18, 18, 15, 16, 19, 16, 23, 18, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3961431738416195, "mean_inference_ms": 2.55065588528035, "mean_action_processing_ms": 0.5394612628920187, "mean_env_wait_ms": 0.12990947412438825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01989006996154785, "StateBufferConnector_ms": 0.009090662002563477, "ViewRequirementAgentConnector_ms": 0.3800632953643799}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12600, "num_env_steps_sampled": 12600, "num_env_steps_trained": 12600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1597.5675290374045, "num_env_steps_trained_throughput_per_sec": 1597.5675290374045, "timesteps_total": 12600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 12600, "timers": {"training_iteration_time_ms": 1028.039, "sample_time_ms": 968.007, "load_time_ms": 0.219, "load_throughput": 6394220.254, "learn_time_ms": 40.004, "learn_throughput": 34996.325, "synch_weights_time_ms": 19.472}, "counters": {"num_env_steps_sampled": 12600, "num_env_steps_trained": 12600, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12600}, "done": false, "episodes_total": 664, "training_iteration": 9, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-03", "timestamp": 1702021143, "time_this_iter_s": 0.8903241157531738, "time_total_s": 9.40764832496643, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.40764832496643, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 95.75, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0988459587097168, "total_loss": 1.0988459587097168, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "sampler_results": {"episode_reward_max": 17.51533333333333, "episode_reward_min": 5.91, "episode_reward_mean": 8.796613333333331, "episode_len_mean": 18.59, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.486333333333333, 9.826000000000002, 7.875333333333333, 17.51533333333333, 11.700999999999997, 9.172333333333334, 7.540999999999999, 8.721666666666666, 8.630999999999998, 8.336666666666664, 7.897333333333333, 10.465333333333334, 6.9706666666666655, 8.830666666666666, 8.011333333333335, 6.595666666666666, 7.751666666666665, 10.598666666666665, 6.798, 10.780333333333331, 9.289, 7.612333333333333, 6.728, 12.126666666666663, 7.790666666666666, 7.7926666666666655, 8.988333333333332, 10.548333333333332, 9.032666666666666, 6.3453333333333335, 7.221, 8.551999999999998, 7.869999999999998, 14.052000000000001, 9.395333333333335, 8.820333333333334, 8.086999999999998, 9.315333333333331, 8.000999999999998, 7.856666666666666, 7.959999999999999, 8.034666666666666, 11.099666666666662, 9.547666666666666, 9.434666666666667, 8.293999999999999, 7.376999999999999, 6.513999999999999, 8.516000000000002, 6.310666666666666, 5.980666666666666, 7.1579999999999995, 7.769999999999999, 7.182666666666666, 8.564333333333332, 8.964666666666664, 6.298999999999999, 6.588666666666666, 6.712666666666666, 6.823999999999999, 7.283333333333333, 7.431999999999999, 7.705999999999999, 9.295999999999998, 7.728666666666667, 11.693333333333333, 11.106333333333332, 11.356000000000002, 10.212999999999997, 8.933999999999997, 8.574, 12.260333333333334, 9.270999999999999, 8.502666666666666, 11.105333333333332, 9.90533333333333, 8.571666666666665, 5.91, 9.850999999999999, 8.083333333333332, 10.175, 7.158333333333333, 9.103666666666664, 6.9706666666666655, 5.982333333333333, 7.342, 6.344666666666665, 8.249333333333333, 7.342999999999999, 7.484666666666666, 10.912666666666665, 9.135666666666664, 10.034, 13.667666666666666, 13.521999999999998, 8.758666666666665, 8.305666666666667, 12.259999999999998, 9.933666666666666, 8.130333333333333], "episode_lengths": [21, 22, 17, 32, 26, 20, 16, 21, 17, 20, 18, 24, 16, 18, 18, 15, 16, 19, 16, 23, 18, 17, 17, 26, 17, 18, 21, 22, 19, 14, 17, 18, 18, 30, 21, 18, 17, 19, 18, 17, 17, 17, 22, 20, 19, 17, 15, 14, 18, 14, 14, 17, 17, 15, 17, 19, 14, 15, 14, 15, 15, 16, 16, 19, 16, 22, 23, 22, 20, 18, 18, 26, 19, 19, 25, 19, 17, 13, 20, 15, 21, 15, 20, 15, 13, 18, 14, 19, 15, 15, 24, 18, 22, 26, 24, 17, 17, 25, 20, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3911541899468554, "mean_inference_ms": 2.5463618096414335, "mean_action_processing_ms": 0.5341621895339879, "mean_env_wait_ms": 0.12611426501121112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0367128849029541, "StateBufferConnector_ms": 0.017965316772460938, "ViewRequirementAgentConnector_ms": 0.4299814701080322}}, "episode_reward_max": 17.51533333333333, "episode_reward_min": 5.91, "episode_reward_mean": 8.796613333333331, "episode_len_mean": 18.59, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.486333333333333, 9.826000000000002, 7.875333333333333, 17.51533333333333, 11.700999999999997, 9.172333333333334, 7.540999999999999, 8.721666666666666, 8.630999999999998, 8.336666666666664, 7.897333333333333, 10.465333333333334, 6.9706666666666655, 8.830666666666666, 8.011333333333335, 6.595666666666666, 7.751666666666665, 10.598666666666665, 6.798, 10.780333333333331, 9.289, 7.612333333333333, 6.728, 12.126666666666663, 7.790666666666666, 7.7926666666666655, 8.988333333333332, 10.548333333333332, 9.032666666666666, 6.3453333333333335, 7.221, 8.551999999999998, 7.869999999999998, 14.052000000000001, 9.395333333333335, 8.820333333333334, 8.086999999999998, 9.315333333333331, 8.000999999999998, 7.856666666666666, 7.959999999999999, 8.034666666666666, 11.099666666666662, 9.547666666666666, 9.434666666666667, 8.293999999999999, 7.376999999999999, 6.513999999999999, 8.516000000000002, 6.310666666666666, 5.980666666666666, 7.1579999999999995, 7.769999999999999, 7.182666666666666, 8.564333333333332, 8.964666666666664, 6.298999999999999, 6.588666666666666, 6.712666666666666, 6.823999999999999, 7.283333333333333, 7.431999999999999, 7.705999999999999, 9.295999999999998, 7.728666666666667, 11.693333333333333, 11.106333333333332, 11.356000000000002, 10.212999999999997, 8.933999999999997, 8.574, 12.260333333333334, 9.270999999999999, 8.502666666666666, 11.105333333333332, 9.90533333333333, 8.571666666666665, 5.91, 9.850999999999999, 8.083333333333332, 10.175, 7.158333333333333, 9.103666666666664, 6.9706666666666655, 5.982333333333333, 7.342, 6.344666666666665, 8.249333333333333, 7.342999999999999, 7.484666666666666, 10.912666666666665, 9.135666666666664, 10.034, 13.667666666666666, 13.521999999999998, 8.758666666666665, 8.305666666666667, 12.259999999999998, 9.933666666666666, 8.130333333333333], "episode_lengths": [21, 22, 17, 32, 26, 20, 16, 21, 17, 20, 18, 24, 16, 18, 18, 15, 16, 19, 16, 23, 18, 17, 17, 26, 17, 18, 21, 22, 19, 14, 17, 18, 18, 30, 21, 18, 17, 19, 18, 17, 17, 17, 22, 20, 19, 17, 15, 14, 18, 14, 14, 17, 17, 15, 17, 19, 14, 15, 14, 15, 15, 16, 16, 19, 16, 22, 23, 22, 20, 18, 18, 26, 19, 19, 25, 19, 17, 13, 20, 15, 21, 15, 20, 15, 13, 18, 14, 19, 15, 15, 24, 18, 22, 26, 24, 17, 17, 25, 20, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3911541899468554, "mean_inference_ms": 2.5463618096414335, "mean_action_processing_ms": 0.5341621895339879, "mean_env_wait_ms": 0.12611426501121112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0367128849029541, "StateBufferConnector_ms": 0.017965316772460938, "ViewRequirementAgentConnector_ms": 0.4299814701080322}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1409.09326731357, "num_env_steps_trained_throughput_per_sec": 1409.09326731357, "timesteps_total": 14000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 1024.59, "sample_time_ms": 967.432, "load_time_ms": 0.197, "load_throughput": 7104689.171, "learn_time_ms": 37.204, "learn_throughput": 37630.287, "synch_weights_time_ms": 19.454}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "done": false, "episodes_total": 742, "training_iteration": 10, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-04", "timestamp": 1702021144, "time_this_iter_s": 1.0155730247497559, "time_total_s": 10.423221349716187, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 10.423221349716187, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 92.6, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0985268354415894, "total_loss": 1.0985268354415894, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 15400, "num_env_steps_trained": 15400, "num_agent_steps_sampled": 15400, "num_agent_steps_trained": 15400}, "sampler_results": {"episode_reward_max": 13.667666666666666, "episode_reward_min": 5.91, "episode_reward_mean": 8.866719999999999, "episode_len_mean": 18.81, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.502666666666666, 11.105333333333332, 9.90533333333333, 8.571666666666665, 5.91, 9.850999999999999, 8.083333333333332, 10.175, 7.158333333333333, 9.103666666666664, 6.9706666666666655, 5.982333333333333, 7.342, 6.344666666666665, 8.249333333333333, 7.342999999999999, 7.484666666666666, 10.912666666666665, 9.135666666666664, 10.034, 13.667666666666666, 13.521999999999998, 8.758666666666665, 8.305666666666667, 12.259999999999998, 9.933666666666666, 8.130333333333333, 6.522333333333332, 8.489999999999998, 11.895999999999995, 7.593333333333333, 8.803, 11.847000000000001, 8.020333333333332, 8.029666666666666, 9.583999999999998, 8.61, 9.251666666666663, 10.610666666666663, 10.772333333333329, 8.283999999999999, 6.990666666666665, 8.771333333333331, 8.062333333333331, 7.450333333333332, 8.009666666666666, 9.704, 9.973333333333331, 11.792999999999994, 7.155333333333333, 7.631, 10.629666666666665, 8.04733333333333, 10.306666666666668, 11.343333333333334, 8.929999999999998, 10.457666666666665, 9.634999999999996, 7.350666666666667, 8.335666666666665, 7.459333333333332, 9.002666666666665, 7.9689999999999985, 13.213666666666668, 9.357666666666667, 8.98033333333333, 6.562666666666665, 6.161333333333333, 7.729999999999998, 8.317666666666666, 7.932666666666664, 6.956999999999999, 8.863999999999999, 8.201666666666666, 6.528333333333333, 8.929666666666666, 9.271333333333333, 9.462666666666664, 7.244999999999999, 6.594, 9.289999999999997, 9.627, 7.192666666666665, 8.648999999999996, 11.381666666666662, 8.508, 10.419666666666664, 9.433999999999996, 8.799333333333331, 7.986333333333333, 6.395333333333332, 8.49, 7.644333333333332, 9.60033333333333, 9.496666666666666, 10.645999999999997, 9.138333333333334, 8.811999999999998, 10.678666666666667, 8.107333333333333], "episode_lengths": [19, 25, 19, 17, 13, 20, 15, 21, 15, 20, 15, 13, 18, 14, 19, 15, 15, 24, 18, 22, 26, 24, 17, 17, 25, 20, 16, 15, 17, 25, 20, 20, 26, 17, 18, 20, 19, 18, 21, 21, 17, 15, 19, 17, 17, 16, 18, 20, 28, 16, 16, 23, 18, 22, 23, 19, 20, 21, 16, 18, 17, 20, 18, 27, 20, 18, 16, 14, 15, 19, 16, 17, 20, 19, 15, 19, 21, 20, 16, 15, 21, 21, 16, 19, 22, 19, 20, 19, 18, 16, 14, 18, 18, 20, 21, 21, 21, 18, 23, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3881242746713083, "mean_inference_ms": 2.5293129643549275, "mean_action_processing_ms": 0.5288593208286503, "mean_env_wait_ms": 0.12570084664464642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027191638946533203, "StateBufferConnector_ms": 0.010675668716430664, "ViewRequirementAgentConnector_ms": 0.41815829277038574}}, "episode_reward_max": 13.667666666666666, "episode_reward_min": 5.91, "episode_reward_mean": 8.866719999999999, "episode_len_mean": 18.81, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.502666666666666, 11.105333333333332, 9.90533333333333, 8.571666666666665, 5.91, 9.850999999999999, 8.083333333333332, 10.175, 7.158333333333333, 9.103666666666664, 6.9706666666666655, 5.982333333333333, 7.342, 6.344666666666665, 8.249333333333333, 7.342999999999999, 7.484666666666666, 10.912666666666665, 9.135666666666664, 10.034, 13.667666666666666, 13.521999999999998, 8.758666666666665, 8.305666666666667, 12.259999999999998, 9.933666666666666, 8.130333333333333, 6.522333333333332, 8.489999999999998, 11.895999999999995, 7.593333333333333, 8.803, 11.847000000000001, 8.020333333333332, 8.029666666666666, 9.583999999999998, 8.61, 9.251666666666663, 10.610666666666663, 10.772333333333329, 8.283999999999999, 6.990666666666665, 8.771333333333331, 8.062333333333331, 7.450333333333332, 8.009666666666666, 9.704, 9.973333333333331, 11.792999999999994, 7.155333333333333, 7.631, 10.629666666666665, 8.04733333333333, 10.306666666666668, 11.343333333333334, 8.929999999999998, 10.457666666666665, 9.634999999999996, 7.350666666666667, 8.335666666666665, 7.459333333333332, 9.002666666666665, 7.9689999999999985, 13.213666666666668, 9.357666666666667, 8.98033333333333, 6.562666666666665, 6.161333333333333, 7.729999999999998, 8.317666666666666, 7.932666666666664, 6.956999999999999, 8.863999999999999, 8.201666666666666, 6.528333333333333, 8.929666666666666, 9.271333333333333, 9.462666666666664, 7.244999999999999, 6.594, 9.289999999999997, 9.627, 7.192666666666665, 8.648999999999996, 11.381666666666662, 8.508, 10.419666666666664, 9.433999999999996, 8.799333333333331, 7.986333333333333, 6.395333333333332, 8.49, 7.644333333333332, 9.60033333333333, 9.496666666666666, 10.645999999999997, 9.138333333333334, 8.811999999999998, 10.678666666666667, 8.107333333333333], "episode_lengths": [19, 25, 19, 17, 13, 20, 15, 21, 15, 20, 15, 13, 18, 14, 19, 15, 15, 24, 18, 22, 26, 24, 17, 17, 25, 20, 16, 15, 17, 25, 20, 20, 26, 17, 18, 20, 19, 18, 21, 21, 17, 15, 19, 17, 17, 16, 18, 20, 28, 16, 16, 23, 18, 22, 23, 19, 20, 21, 16, 18, 17, 20, 18, 27, 20, 18, 16, 14, 15, 19, 16, 17, 20, 19, 15, 19, 21, 20, 16, 15, 21, 21, 16, 19, 22, 19, 20, 19, 18, 16, 14, 18, 18, 20, 21, 21, 21, 18, 23, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3881242746713083, "mean_inference_ms": 2.5293129643549275, "mean_action_processing_ms": 0.5288593208286503, "mean_env_wait_ms": 0.12570084664464642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027191638946533203, "StateBufferConnector_ms": 0.010675668716430664, "ViewRequirementAgentConnector_ms": 0.41815829277038574}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15400, "num_agent_steps_trained": 15400, "num_env_steps_sampled": 15400, "num_env_steps_trained": 15400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1543.2794703462719, "num_env_steps_trained_throughput_per_sec": 1543.2794703462719, "timesteps_total": 15400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 15400, "timers": {"training_iteration_time_ms": 973.753, "sample_time_ms": 942.768, "load_time_ms": 0.1, "load_throughput": 13971034.023, "learn_time_ms": 11.651, "learn_throughput": 120163.169, "synch_weights_time_ms": 19.135}, "counters": {"num_env_steps_sampled": 15400, "num_env_steps_trained": 15400, "num_agent_steps_sampled": 15400, "num_agent_steps_trained": 15400}, "done": false, "episodes_total": 815, "training_iteration": 11, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-05", "timestamp": 1702021145, "time_this_iter_s": 0.9231553077697754, "time_total_s": 11.346376657485962, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.346376657485962, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 93.9, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0986534357070923, "total_loss": 1.0986534357070923, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "sampler_results": {"episode_reward_max": 14.264999999999999, "episode_reward_min": 6.185999999999998, "episode_reward_mean": 9.055126666666665, "episode_len_mean": 19.3, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.863999999999999, 8.201666666666666, 6.528333333333333, 8.929666666666666, 9.271333333333333, 9.462666666666664, 7.244999999999999, 6.594, 9.289999999999997, 9.627, 7.192666666666665, 8.648999999999996, 11.381666666666662, 8.508, 10.419666666666664, 9.433999999999996, 8.799333333333331, 7.986333333333333, 6.395333333333332, 8.49, 7.644333333333332, 9.60033333333333, 9.496666666666666, 10.645999999999997, 9.138333333333334, 8.811999999999998, 10.678666666666667, 8.107333333333333, 7.076666666666666, 10.02733333333333, 7.992666666666665, 10.370999999999995, 7.485999999999999, 9.380000000000003, 8.209999999999997, 8.918000000000001, 9.803999999999998, 9.226999999999999, 12.78233333333333, 9.080333333333332, 10.211666666666668, 9.91466666666666, 14.264999999999999, 10.119, 10.965999999999994, 8.421999999999999, 6.240333333333334, 7.503999999999998, 11.178999999999997, 10.278666666666666, 10.881666666666664, 7.474666666666664, 7.126333333333333, 6.248666666666667, 10.158666666666663, 11.705666666666662, 7.676666666666667, 6.610666666666667, 11.218666666666667, 9.982666666666665, 8.78933333333333, 10.507666666666665, 7.075666666666667, 8.465000000000002, 9.317333333333334, 8.363666666666663, 9.803999999999998, 7.513333333333332, 11.774000000000001, 8.207333333333331, 7.248666666666666, 9.40033333333333, 7.139999999999999, 7.422666666666666, 11.999666666666663, 8.812666666666665, 7.017333333333331, 8.209333333333333, 9.453, 11.66366666666666, 9.336666666666664, 7.484666666666664, 8.124333333333334, 9.303333333333333, 11.065999999999995, 10.961666666666668, 12.979999999999995, 11.915333333333331, 7.745333333333331, 6.420666666666666, 12.01666666666666, 6.185999999999998, 8.032666666666668, 8.910666666666664, 9.104666666666667, 7.934333333333332, 9.297, 7.676333333333332, 8.483666666666664, 10.414666666666665], "episode_lengths": [20, 19, 15, 19, 21, 20, 16, 15, 21, 21, 16, 19, 22, 19, 20, 19, 18, 16, 14, 18, 18, 20, 21, 21, 21, 18, 23, 16, 17, 22, 17, 22, 18, 21, 19, 22, 20, 19, 28, 21, 22, 24, 27, 22, 23, 17, 13, 16, 24, 21, 24, 15, 16, 15, 22, 26, 15, 14, 23, 20, 18, 22, 15, 17, 19, 19, 20, 17, 22, 19, 16, 19, 18, 18, 23, 18, 15, 17, 19, 23, 20, 17, 19, 21, 24, 25, 27, 23, 16, 14, 22, 15, 17, 18, 18, 16, 18, 16, 18, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3849638262754695, "mean_inference_ms": 2.5044082543962305, "mean_action_processing_ms": 0.5252696380063496, "mean_env_wait_ms": 0.12537374671573923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0207521915435791, "StateBufferConnector_ms": 0.011206865310668945, "ViewRequirementAgentConnector_ms": 0.46554112434387207}}, "episode_reward_max": 14.264999999999999, "episode_reward_min": 6.185999999999998, "episode_reward_mean": 9.055126666666665, "episode_len_mean": 19.3, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.863999999999999, 8.201666666666666, 6.528333333333333, 8.929666666666666, 9.271333333333333, 9.462666666666664, 7.244999999999999, 6.594, 9.289999999999997, 9.627, 7.192666666666665, 8.648999999999996, 11.381666666666662, 8.508, 10.419666666666664, 9.433999999999996, 8.799333333333331, 7.986333333333333, 6.395333333333332, 8.49, 7.644333333333332, 9.60033333333333, 9.496666666666666, 10.645999999999997, 9.138333333333334, 8.811999999999998, 10.678666666666667, 8.107333333333333, 7.076666666666666, 10.02733333333333, 7.992666666666665, 10.370999999999995, 7.485999999999999, 9.380000000000003, 8.209999999999997, 8.918000000000001, 9.803999999999998, 9.226999999999999, 12.78233333333333, 9.080333333333332, 10.211666666666668, 9.91466666666666, 14.264999999999999, 10.119, 10.965999999999994, 8.421999999999999, 6.240333333333334, 7.503999999999998, 11.178999999999997, 10.278666666666666, 10.881666666666664, 7.474666666666664, 7.126333333333333, 6.248666666666667, 10.158666666666663, 11.705666666666662, 7.676666666666667, 6.610666666666667, 11.218666666666667, 9.982666666666665, 8.78933333333333, 10.507666666666665, 7.075666666666667, 8.465000000000002, 9.317333333333334, 8.363666666666663, 9.803999999999998, 7.513333333333332, 11.774000000000001, 8.207333333333331, 7.248666666666666, 9.40033333333333, 7.139999999999999, 7.422666666666666, 11.999666666666663, 8.812666666666665, 7.017333333333331, 8.209333333333333, 9.453, 11.66366666666666, 9.336666666666664, 7.484666666666664, 8.124333333333334, 9.303333333333333, 11.065999999999995, 10.961666666666668, 12.979999999999995, 11.915333333333331, 7.745333333333331, 6.420666666666666, 12.01666666666666, 6.185999999999998, 8.032666666666668, 8.910666666666664, 9.104666666666667, 7.934333333333332, 9.297, 7.676333333333332, 8.483666666666664, 10.414666666666665], "episode_lengths": [20, 19, 15, 19, 21, 20, 16, 15, 21, 21, 16, 19, 22, 19, 20, 19, 18, 16, 14, 18, 18, 20, 21, 21, 21, 18, 23, 16, 17, 22, 17, 22, 18, 21, 19, 22, 20, 19, 28, 21, 22, 24, 27, 22, 23, 17, 13, 16, 24, 21, 24, 15, 16, 15, 22, 26, 15, 14, 23, 20, 18, 22, 15, 17, 19, 19, 20, 17, 22, 19, 16, 19, 18, 18, 23, 18, 15, 17, 19, 23, 20, 17, 19, 21, 24, 25, 27, 23, 16, 14, 22, 15, 17, 18, 18, 16, 18, 16, 18, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3849638262754695, "mean_inference_ms": 2.5044082543962305, "mean_action_processing_ms": 0.5252696380063496, "mean_env_wait_ms": 0.12537374671573923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0207521915435791, "StateBufferConnector_ms": 0.011206865310668945, "ViewRequirementAgentConnector_ms": 0.46554112434387207}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1523.1118242452822, "num_env_steps_trained_throughput_per_sec": 1523.1118242452822, "timesteps_total": 16800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 963.529, "sample_time_ms": 932.141, "load_time_ms": 0.1, "load_throughput": 13971034.023, "learn_time_ms": 12.104, "learn_throughput": 115665.053, "synch_weights_time_ms": 19.084}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "done": false, "episodes_total": 887, "training_iteration": 12, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-06", "timestamp": 1702021146, "time_this_iter_s": 0.9356756210327148, "time_total_s": 12.282052278518677, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 12.282052278518677, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 94.75, "ram_util_percent": 96.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0980011224746704, "total_loss": 1.0980011224746704, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 18200, "num_env_steps_trained": 18200, "num_agent_steps_sampled": 18200, "num_agent_steps_trained": 18200}, "sampler_results": {"episode_reward_max": 14.943999999999994, "episode_reward_min": 5.949999999999999, "episode_reward_mean": 8.857476666666667, "episode_len_mean": 18.77, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.812666666666665, 7.017333333333331, 8.209333333333333, 9.453, 11.66366666666666, 9.336666666666664, 7.484666666666664, 8.124333333333334, 9.303333333333333, 11.065999999999995, 10.961666666666668, 12.979999999999995, 11.915333333333331, 7.745333333333331, 6.420666666666666, 12.01666666666666, 6.185999999999998, 8.032666666666668, 8.910666666666664, 9.104666666666667, 7.934333333333332, 9.297, 7.676333333333332, 8.483666666666664, 10.414666666666665, 8.365999999999998, 7.290666666666666, 8.383333333333333, 9.700000000000003, 13.691000000000003, 9.321999999999997, 8.005999999999998, 7.756000000000001, 12.308333333333328, 7.239333333333333, 8.201, 9.928666666666665, 7.141, 7.167333333333332, 8.71833333333333, 9.694333333333331, 8.767999999999999, 6.994666666666666, 8.355333333333334, 10.065999999999997, 7.545999999999999, 7.4996666666666645, 9.221666666666666, 9.78866666666667, 8.416000000000002, 8.321, 8.356666666666666, 7.254333333333334, 7.201666666666665, 9.355333333333332, 10.590666666666666, 10.027666666666669, 9.676666666666664, 6.651000000000001, 6.6273333333333335, 11.814999999999998, 7.676666666666665, 10.936666666666667, 8.173333333333332, 5.949999999999999, 14.943999999999994, 8.368666666666666, 7.131333333333335, 8.422999999999996, 11.501999999999995, 8.866333333333333, 11.884333333333329, 11.193333333333332, 9.949666666666664, 8.300999999999998, 8.181999999999999, 9.345666666666666, 7.166999999999998, 11.431666666666665, 7.987333333333332, 8.048333333333332, 6.736999999999998, 8.767, 10.698666666666668, 9.370333333333333, 7.271333333333333, 6.776999999999999, 7.455666666666664, 6.795999999999999, 9.225333333333328, 6.704666666666666, 6.419999999999999, 7.568666666666665, 8.877333333333333, 6.542999999999998, 6.678333333333333, 14.186666666666664, 10.443333333333333, 7.645333333333333, 8.122333333333334], "episode_lengths": [18, 15, 17, 19, 23, 20, 17, 19, 21, 24, 25, 27, 23, 16, 14, 22, 15, 17, 18, 18, 16, 18, 16, 18, 21, 17, 15, 19, 23, 25, 22, 17, 16, 25, 15, 19, 21, 15, 16, 19, 20, 20, 16, 18, 20, 15, 16, 21, 20, 18, 18, 18, 15, 15, 20, 21, 21, 22, 15, 16, 26, 16, 21, 16, 13, 27, 19, 19, 21, 22, 19, 26, 22, 22, 17, 18, 19, 17, 21, 19, 17, 15, 18, 20, 22, 15, 14, 15, 14, 20, 15, 14, 17, 18, 15, 16, 30, 22, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3718788619485442, "mean_inference_ms": 2.4942384540069065, "mean_action_processing_ms": 0.5215828972554865, "mean_env_wait_ms": 0.12403994956557679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021661996841430664, "StateBufferConnector_ms": 0.013149499893188477, "ViewRequirementAgentConnector_ms": 0.44417405128479004}}, "episode_reward_max": 14.943999999999994, "episode_reward_min": 5.949999999999999, "episode_reward_mean": 8.857476666666667, "episode_len_mean": 18.77, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.812666666666665, 7.017333333333331, 8.209333333333333, 9.453, 11.66366666666666, 9.336666666666664, 7.484666666666664, 8.124333333333334, 9.303333333333333, 11.065999999999995, 10.961666666666668, 12.979999999999995, 11.915333333333331, 7.745333333333331, 6.420666666666666, 12.01666666666666, 6.185999999999998, 8.032666666666668, 8.910666666666664, 9.104666666666667, 7.934333333333332, 9.297, 7.676333333333332, 8.483666666666664, 10.414666666666665, 8.365999999999998, 7.290666666666666, 8.383333333333333, 9.700000000000003, 13.691000000000003, 9.321999999999997, 8.005999999999998, 7.756000000000001, 12.308333333333328, 7.239333333333333, 8.201, 9.928666666666665, 7.141, 7.167333333333332, 8.71833333333333, 9.694333333333331, 8.767999999999999, 6.994666666666666, 8.355333333333334, 10.065999999999997, 7.545999999999999, 7.4996666666666645, 9.221666666666666, 9.78866666666667, 8.416000000000002, 8.321, 8.356666666666666, 7.254333333333334, 7.201666666666665, 9.355333333333332, 10.590666666666666, 10.027666666666669, 9.676666666666664, 6.651000000000001, 6.6273333333333335, 11.814999999999998, 7.676666666666665, 10.936666666666667, 8.173333333333332, 5.949999999999999, 14.943999999999994, 8.368666666666666, 7.131333333333335, 8.422999999999996, 11.501999999999995, 8.866333333333333, 11.884333333333329, 11.193333333333332, 9.949666666666664, 8.300999999999998, 8.181999999999999, 9.345666666666666, 7.166999999999998, 11.431666666666665, 7.987333333333332, 8.048333333333332, 6.736999999999998, 8.767, 10.698666666666668, 9.370333333333333, 7.271333333333333, 6.776999999999999, 7.455666666666664, 6.795999999999999, 9.225333333333328, 6.704666666666666, 6.419999999999999, 7.568666666666665, 8.877333333333333, 6.542999999999998, 6.678333333333333, 14.186666666666664, 10.443333333333333, 7.645333333333333, 8.122333333333334], "episode_lengths": [18, 15, 17, 19, 23, 20, 17, 19, 21, 24, 25, 27, 23, 16, 14, 22, 15, 17, 18, 18, 16, 18, 16, 18, 21, 17, 15, 19, 23, 25, 22, 17, 16, 25, 15, 19, 21, 15, 16, 19, 20, 20, 16, 18, 20, 15, 16, 21, 20, 18, 18, 18, 15, 15, 20, 21, 21, 22, 15, 16, 26, 16, 21, 16, 13, 27, 19, 19, 21, 22, 19, 26, 22, 22, 17, 18, 19, 17, 21, 19, 17, 15, 18, 20, 22, 15, 14, 15, 14, 20, 15, 14, 17, 18, 15, 16, 30, 22, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3718788619485442, "mean_inference_ms": 2.4942384540069065, "mean_action_processing_ms": 0.5215828972554865, "mean_env_wait_ms": 0.12403994956557679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021661996841430664, "StateBufferConnector_ms": 0.013149499893188477, "ViewRequirementAgentConnector_ms": 0.44417405128479004}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18200, "num_agent_steps_trained": 18200, "num_env_steps_sampled": 18200, "num_env_steps_trained": 18200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1549.8362016087399, "num_env_steps_trained_throughput_per_sec": 1549.8362016087399, "timesteps_total": 18200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 18200, "timers": {"training_iteration_time_ms": 950.867, "sample_time_ms": 919.119, "load_time_ms": 0.2, "load_throughput": 6996336.947, "learn_time_ms": 12.221, "learn_throughput": 114557.11, "synch_weights_time_ms": 19.228}, "counters": {"num_env_steps_sampled": 18200, "num_env_steps_trained": 18200, "num_agent_steps_sampled": 18200, "num_agent_steps_trained": 18200}, "done": false, "episodes_total": 962, "training_iteration": 13, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-07", "timestamp": 1702021147, "time_this_iter_s": 0.9198851585388184, "time_total_s": 13.201937437057495, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.201937437057495, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 93.7, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0981913805007935, "total_loss": 1.0981913805007935, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 19600, "num_env_steps_trained": 19600, "num_agent_steps_sampled": 19600, "num_agent_steps_trained": 19600}, "sampler_results": {"episode_reward_max": 14.186666666666664, "episode_reward_min": 5.819333333333333, "episode_reward_mean": 8.741233333333332, "episode_len_mean": 18.52, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.345666666666666, 7.166999999999998, 11.431666666666665, 7.987333333333332, 8.048333333333332, 6.736999999999998, 8.767, 10.698666666666668, 9.370333333333333, 7.271333333333333, 6.776999999999999, 7.455666666666664, 6.795999999999999, 9.225333333333328, 6.704666666666666, 6.419999999999999, 7.568666666666665, 8.877333333333333, 6.542999999999998, 6.678333333333333, 14.186666666666664, 10.443333333333333, 7.645333333333333, 8.122333333333334, 12.64466666666667, 8.434000000000001, 6.118333333333333, 8.875333333333332, 9.339666666666668, 7.825999999999998, 9.035999999999998, 10.939000000000002, 9.419666666666663, 9.855999999999996, 8.526666666666666, 7.872333333333333, 8.17333333333333, 10.98433333333333, 9.916666666666666, 9.045999999999998, 8.924999999999999, 11.707333333333333, 8.122999999999998, 10.234666666666667, 7.694333333333333, 5.819333333333333, 8.912666666666665, 12.695999999999996, 6.331999999999998, 8.606333333333332, 8.619333333333334, 7.615666666666666, 7.474666666666666, 9.156666666666666, 6.199999999999998, 10.625333333333328, 6.741333333333334, 7.313333333333333, 7.506333333333333, 10.760666666666662, 9.968999999999998, 6.822666666666665, 8.780333333333333, 7.876666666666666, 7.354333333333334, 11.810333333333332, 10.506666666666664, 7.503666666666667, 9.446999999999996, 8.605999999999996, 9.06, 8.547999999999998, 6.809333333333332, 8.025999999999998, 8.380666666666666, 9.797, 10.796, 7.105666666666665, 10.347, 6.842333333333333, 8.126, 10.718333333333328, 9.769000000000004, 7.030333333333331, 8.502999999999998, 12.20133333333333, 8.930666666666667, 12.480666666666663, 10.41533333333333, 8.209, 7.880333333333334, 10.621333333333332, 7.912333333333334, 10.455333333333334, 8.899666666666665, 10.552666666666665, 8.581333333333333, 6.688333333333333, 6.480666666666665, 6.938999999999999], "episode_lengths": [19, 17, 21, 19, 17, 15, 18, 20, 22, 15, 14, 15, 14, 20, 15, 14, 17, 18, 15, 16, 30, 22, 17, 17, 25, 19, 14, 19, 20, 18, 19, 23, 21, 21, 18, 16, 17, 22, 19, 20, 20, 24, 17, 20, 15, 13, 18, 23, 16, 18, 16, 15, 16, 20, 16, 21, 15, 15, 17, 21, 18, 17, 19, 17, 16, 26, 20, 15, 19, 19, 20, 17, 15, 20, 19, 20, 22, 16, 22, 14, 17, 23, 22, 14, 18, 24, 19, 26, 21, 17, 19, 22, 19, 22, 21, 22, 19, 14, 14, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3655751636921445, "mean_inference_ms": 2.4861009869772217, "mean_action_processing_ms": 0.5165613458072181, "mean_env_wait_ms": 0.12233831178111894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02072739601135254, "StateBufferConnector_ms": 0.013005971908569336, "ViewRequirementAgentConnector_ms": 0.4242398738861084}}, "episode_reward_max": 14.186666666666664, "episode_reward_min": 5.819333333333333, "episode_reward_mean": 8.741233333333332, "episode_len_mean": 18.52, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.345666666666666, 7.166999999999998, 11.431666666666665, 7.987333333333332, 8.048333333333332, 6.736999999999998, 8.767, 10.698666666666668, 9.370333333333333, 7.271333333333333, 6.776999999999999, 7.455666666666664, 6.795999999999999, 9.225333333333328, 6.704666666666666, 6.419999999999999, 7.568666666666665, 8.877333333333333, 6.542999999999998, 6.678333333333333, 14.186666666666664, 10.443333333333333, 7.645333333333333, 8.122333333333334, 12.64466666666667, 8.434000000000001, 6.118333333333333, 8.875333333333332, 9.339666666666668, 7.825999999999998, 9.035999999999998, 10.939000000000002, 9.419666666666663, 9.855999999999996, 8.526666666666666, 7.872333333333333, 8.17333333333333, 10.98433333333333, 9.916666666666666, 9.045999999999998, 8.924999999999999, 11.707333333333333, 8.122999999999998, 10.234666666666667, 7.694333333333333, 5.819333333333333, 8.912666666666665, 12.695999999999996, 6.331999999999998, 8.606333333333332, 8.619333333333334, 7.615666666666666, 7.474666666666666, 9.156666666666666, 6.199999999999998, 10.625333333333328, 6.741333333333334, 7.313333333333333, 7.506333333333333, 10.760666666666662, 9.968999999999998, 6.822666666666665, 8.780333333333333, 7.876666666666666, 7.354333333333334, 11.810333333333332, 10.506666666666664, 7.503666666666667, 9.446999999999996, 8.605999999999996, 9.06, 8.547999999999998, 6.809333333333332, 8.025999999999998, 8.380666666666666, 9.797, 10.796, 7.105666666666665, 10.347, 6.842333333333333, 8.126, 10.718333333333328, 9.769000000000004, 7.030333333333331, 8.502999999999998, 12.20133333333333, 8.930666666666667, 12.480666666666663, 10.41533333333333, 8.209, 7.880333333333334, 10.621333333333332, 7.912333333333334, 10.455333333333334, 8.899666666666665, 10.552666666666665, 8.581333333333333, 6.688333333333333, 6.480666666666665, 6.938999999999999], "episode_lengths": [19, 17, 21, 19, 17, 15, 18, 20, 22, 15, 14, 15, 14, 20, 15, 14, 17, 18, 15, 16, 30, 22, 17, 17, 25, 19, 14, 19, 20, 18, 19, 23, 21, 21, 18, 16, 17, 22, 19, 20, 20, 24, 17, 20, 15, 13, 18, 23, 16, 18, 16, 15, 16, 20, 16, 21, 15, 15, 17, 21, 18, 17, 19, 17, 16, 26, 20, 15, 19, 19, 20, 17, 15, 20, 19, 20, 22, 16, 22, 14, 17, 23, 22, 14, 18, 24, 19, 26, 21, 17, 19, 22, 19, 22, 21, 22, 19, 14, 14, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3655751636921445, "mean_inference_ms": 2.4861009869772217, "mean_action_processing_ms": 0.5165613458072181, "mean_env_wait_ms": 0.12233831178111894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02072739601135254, "StateBufferConnector_ms": 0.013005971908569336, "ViewRequirementAgentConnector_ms": 0.4242398738861084}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19600, "num_agent_steps_trained": 19600, "num_env_steps_sampled": 19600, "num_env_steps_trained": 19600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1504.4243770001365, "num_env_steps_trained_throughput_per_sec": 1504.4243770001365, "timesteps_total": 19600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 19600, "timers": {"training_iteration_time_ms": 936.449, "sample_time_ms": 904.901, "load_time_ms": 0.228, "load_throughput": 6151938.816, "learn_time_ms": 12.093, "learn_throughput": 115766.3, "synch_weights_time_ms": 19.028}, "counters": {"num_env_steps_sampled": 19600, "num_env_steps_trained": 19600, "num_agent_steps_sampled": 19600, "num_agent_steps_trained": 19600}, "done": false, "episodes_total": 1038, "training_iteration": 14, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-08", "timestamp": 1702021148, "time_this_iter_s": 0.9445884227752686, "time_total_s": 14.146525859832764, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 14.146525859832764, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 93.7, "ram_util_percent": 97.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0988261699676514, "total_loss": 1.0988261699676514, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 21000}, "sampler_results": {"episode_reward_max": 14.834333333333332, "episode_reward_min": 5.860666666666667, "episode_reward_mean": 8.97552, "episode_len_mean": 19.25, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.809333333333332, 8.025999999999998, 8.380666666666666, 9.797, 10.796, 7.105666666666665, 10.347, 6.842333333333333, 8.126, 10.718333333333328, 9.769000000000004, 7.030333333333331, 8.502999999999998, 12.20133333333333, 8.930666666666667, 12.480666666666663, 10.41533333333333, 8.209, 7.880333333333334, 10.621333333333332, 7.912333333333334, 10.455333333333334, 8.899666666666665, 10.552666666666665, 8.581333333333333, 6.688333333333333, 6.480666666666665, 6.938999999999999, 7.539666666666665, 11.785, 6.101, 14.834333333333332, 9.085999999999999, 8.685999999999998, 10.903666666666668, 8.101333333333333, 6.890999999999999, 8.606333333333332, 9.706333333333335, 7.531, 6.691999999999998, 7.998666666666665, 8.275333333333332, 10.86933333333333, 8.311999999999998, 7.321333333333333, 8.371666666666663, 11.27733333333333, 9.480666666666663, 7.227333333333333, 8.46133333333333, 8.690666666666669, 9.124999999999998, 11.998666666666665, 10.797666666666666, 7.477333333333332, 8.259333333333332, 9.846666666666666, 8.546, 11.26933333333333, 8.559, 10.616333333333332, 7.275333333333333, 9.459999999999997, 7.649333333333331, 10.68533333333333, 6.518333333333333, 7.714333333333332, 7.611999999999999, 8.323666666666664, 8.072, 11.621, 7.945333333333332, 10.296666666666663, 6.838333333333333, 8.938666666666666, 8.364, 8.904333333333332, 10.315999999999995, 6.865333333333332, 8.260333333333334, 10.406666666666668, 7.906999999999998, 11.009, 11.351999999999999, 10.425333333333333, 8.185666666666664, 9.531999999999996, 7.784999999999998, 10.589666666666664, 9.331999999999999, 9.343333333333332, 6.570333333333334, 9.153666666666666, 12.006666666666666, 11.029333333333328, 5.860666666666667, 7.769333333333332, 10.361, 8.529666666666666], "episode_lengths": [15, 20, 19, 20, 22, 16, 22, 14, 17, 23, 22, 14, 18, 24, 19, 26, 21, 17, 19, 22, 19, 22, 21, 22, 19, 14, 14, 14, 16, 26, 14, 33, 22, 19, 23, 17, 17, 18, 20, 16, 16, 16, 19, 23, 19, 15, 19, 23, 22, 17, 17, 19, 20, 23, 21, 16, 20, 22, 18, 23, 20, 25, 16, 20, 15, 22, 15, 18, 17, 19, 17, 22, 16, 21, 16, 19, 18, 18, 23, 16, 19, 21, 18, 23, 22, 21, 18, 22, 16, 22, 17, 18, 15, 17, 26, 22, 14, 16, 23, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3952019168811325, "mean_inference_ms": 2.533707789260444, "mean_action_processing_ms": 0.5232141830110786, "mean_env_wait_ms": 0.1258247929259541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03708052635192871, "StateBufferConnector_ms": 0.02966904640197754, "ViewRequirementAgentConnector_ms": 0.7638468742370605}}, "episode_reward_max": 14.834333333333332, "episode_reward_min": 5.860666666666667, "episode_reward_mean": 8.97552, "episode_len_mean": 19.25, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.809333333333332, 8.025999999999998, 8.380666666666666, 9.797, 10.796, 7.105666666666665, 10.347, 6.842333333333333, 8.126, 10.718333333333328, 9.769000000000004, 7.030333333333331, 8.502999999999998, 12.20133333333333, 8.930666666666667, 12.480666666666663, 10.41533333333333, 8.209, 7.880333333333334, 10.621333333333332, 7.912333333333334, 10.455333333333334, 8.899666666666665, 10.552666666666665, 8.581333333333333, 6.688333333333333, 6.480666666666665, 6.938999999999999, 7.539666666666665, 11.785, 6.101, 14.834333333333332, 9.085999999999999, 8.685999999999998, 10.903666666666668, 8.101333333333333, 6.890999999999999, 8.606333333333332, 9.706333333333335, 7.531, 6.691999999999998, 7.998666666666665, 8.275333333333332, 10.86933333333333, 8.311999999999998, 7.321333333333333, 8.371666666666663, 11.27733333333333, 9.480666666666663, 7.227333333333333, 8.46133333333333, 8.690666666666669, 9.124999999999998, 11.998666666666665, 10.797666666666666, 7.477333333333332, 8.259333333333332, 9.846666666666666, 8.546, 11.26933333333333, 8.559, 10.616333333333332, 7.275333333333333, 9.459999999999997, 7.649333333333331, 10.68533333333333, 6.518333333333333, 7.714333333333332, 7.611999999999999, 8.323666666666664, 8.072, 11.621, 7.945333333333332, 10.296666666666663, 6.838333333333333, 8.938666666666666, 8.364, 8.904333333333332, 10.315999999999995, 6.865333333333332, 8.260333333333334, 10.406666666666668, 7.906999999999998, 11.009, 11.351999999999999, 10.425333333333333, 8.185666666666664, 9.531999999999996, 7.784999999999998, 10.589666666666664, 9.331999999999999, 9.343333333333332, 6.570333333333334, 9.153666666666666, 12.006666666666666, 11.029333333333328, 5.860666666666667, 7.769333333333332, 10.361, 8.529666666666666], "episode_lengths": [15, 20, 19, 20, 22, 16, 22, 14, 17, 23, 22, 14, 18, 24, 19, 26, 21, 17, 19, 22, 19, 22, 21, 22, 19, 14, 14, 14, 16, 26, 14, 33, 22, 19, 23, 17, 17, 18, 20, 16, 16, 16, 19, 23, 19, 15, 19, 23, 22, 17, 17, 19, 20, 23, 21, 16, 20, 22, 18, 23, 20, 25, 16, 20, 15, 22, 15, 18, 17, 19, 17, 22, 16, 21, 16, 19, 18, 18, 23, 16, 19, 21, 18, 23, 22, 21, 18, 22, 16, 22, 17, 18, 15, 17, 26, 22, 14, 16, 23, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3952019168811325, "mean_inference_ms": 2.533707789260444, "mean_action_processing_ms": 0.5232141830110786, "mean_env_wait_ms": 0.1258247929259541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03708052635192871, "StateBufferConnector_ms": 0.02966904640197754, "ViewRequirementAgentConnector_ms": 0.7638468742370605}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 21000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 21000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1009.3650516437865, "num_env_steps_trained_throughput_per_sec": 1009.3650516437865, "timesteps_total": 21000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 973.744, "sample_time_ms": 942.051, "load_time_ms": 0.228, "load_throughput": 6151938.816, "learn_time_ms": 12.145, "learn_throughput": 115275.409, "synch_weights_time_ms": 19.028}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 21000}, "done": false, "episodes_total": 1110, "training_iteration": 15, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-10", "timestamp": 1702021150, "time_this_iter_s": 1.4020051956176758, "time_total_s": 15.54853105545044, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.54853105545044, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 95.4, "ram_util_percent": 97.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0980749130249023, "total_loss": 1.0980749130249023, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "sampler_results": {"episode_reward_max": 14.062333333333331, "episode_reward_min": 5.860666666666667, "episode_reward_mean": 8.865723333333332, "episode_len_mean": 18.85, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.838333333333333, 8.938666666666666, 8.364, 8.904333333333332, 10.315999999999995, 6.865333333333332, 8.260333333333334, 10.406666666666668, 7.906999999999998, 11.009, 11.351999999999999, 10.425333333333333, 8.185666666666664, 9.531999999999996, 7.784999999999998, 10.589666666666664, 9.331999999999999, 9.343333333333332, 6.570333333333334, 9.153666666666666, 12.006666666666666, 11.029333333333328, 5.860666666666667, 7.769333333333332, 10.361, 8.529666666666666, 9.337333333333332, 11.495333333333331, 7.6596666666666655, 12.611999999999997, 9.265666666666668, 7.030666666666665, 6.273333333333333, 10.844, 10.555333333333333, 10.549333333333333, 9.219000000000001, 6.960666666666665, 10.651666666666667, 8.132333333333335, 9.361999999999998, 9.663666666666662, 10.706333333333333, 9.116999999999999, 10.235666666666665, 6.256666666666666, 7.109333333333332, 7.731999999999999, 7.964666666666664, 9.025333333333334, 8.522999999999998, 14.062333333333331, 6.5506666666666655, 10.468666666666666, 8.832666666666665, 9.263333333333332, 7.505999999999999, 7.868333333333332, 9.546666666666667, 7.337999999999999, 8.388, 10.352333333333332, 7.016666666666665, 7.899333333333332, 7.878999999999998, 8.998333333333331, 9.179666666666664, 8.223333333333331, 7.630333333333334, 9.259000000000002, 10.583666666666666, 8.398666666666665, 9.001333333333331, 7.143999999999999, 10.115666666666664, 6.875999999999998, 10.09633333333333, 6.107333333333333, 6.229666666666667, 6.512666666666667, 10.08133333333333, 7.018999999999998, 8.081999999999999, 9.515999999999998, 8.109, 9.516999999999998, 8.040666666666665, 6.495333333333331, 9.148999999999997, 10.030666666666667, 8.556, 10.268999999999998, 9.800999999999998, 7.483999999999998, 11.333666666666666, 8.065999999999999, 6.941333333333333, 7.876666666666666, 7.508, 13.451333333333336], "episode_lengths": [16, 19, 18, 18, 23, 16, 19, 21, 18, 23, 22, 21, 18, 22, 16, 22, 17, 18, 15, 17, 26, 22, 14, 16, 23, 18, 21, 23, 18, 25, 20, 16, 14, 24, 24, 23, 19, 15, 22, 20, 18, 20, 20, 20, 21, 14, 19, 16, 17, 19, 20, 27, 14, 22, 20, 19, 15, 17, 21, 17, 19, 21, 14, 16, 17, 17, 20, 19, 16, 19, 22, 17, 20, 17, 24, 14, 21, 13, 15, 15, 19, 15, 16, 21, 18, 21, 17, 14, 19, 20, 18, 19, 20, 17, 23, 18, 16, 17, 16, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4038717645649592, "mean_inference_ms": 2.5599291097199046, "mean_action_processing_ms": 0.5267469147234297, "mean_env_wait_ms": 0.12692232065936848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03126811981201172, "StateBufferConnector_ms": 0.03180694580078125, "ViewRequirementAgentConnector_ms": 0.5483791828155518}}, "episode_reward_max": 14.062333333333331, "episode_reward_min": 5.860666666666667, "episode_reward_mean": 8.865723333333332, "episode_len_mean": 18.85, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.838333333333333, 8.938666666666666, 8.364, 8.904333333333332, 10.315999999999995, 6.865333333333332, 8.260333333333334, 10.406666666666668, 7.906999999999998, 11.009, 11.351999999999999, 10.425333333333333, 8.185666666666664, 9.531999999999996, 7.784999999999998, 10.589666666666664, 9.331999999999999, 9.343333333333332, 6.570333333333334, 9.153666666666666, 12.006666666666666, 11.029333333333328, 5.860666666666667, 7.769333333333332, 10.361, 8.529666666666666, 9.337333333333332, 11.495333333333331, 7.6596666666666655, 12.611999999999997, 9.265666666666668, 7.030666666666665, 6.273333333333333, 10.844, 10.555333333333333, 10.549333333333333, 9.219000000000001, 6.960666666666665, 10.651666666666667, 8.132333333333335, 9.361999999999998, 9.663666666666662, 10.706333333333333, 9.116999999999999, 10.235666666666665, 6.256666666666666, 7.109333333333332, 7.731999999999999, 7.964666666666664, 9.025333333333334, 8.522999999999998, 14.062333333333331, 6.5506666666666655, 10.468666666666666, 8.832666666666665, 9.263333333333332, 7.505999999999999, 7.868333333333332, 9.546666666666667, 7.337999999999999, 8.388, 10.352333333333332, 7.016666666666665, 7.899333333333332, 7.878999999999998, 8.998333333333331, 9.179666666666664, 8.223333333333331, 7.630333333333334, 9.259000000000002, 10.583666666666666, 8.398666666666665, 9.001333333333331, 7.143999999999999, 10.115666666666664, 6.875999999999998, 10.09633333333333, 6.107333333333333, 6.229666666666667, 6.512666666666667, 10.08133333333333, 7.018999999999998, 8.081999999999999, 9.515999999999998, 8.109, 9.516999999999998, 8.040666666666665, 6.495333333333331, 9.148999999999997, 10.030666666666667, 8.556, 10.268999999999998, 9.800999999999998, 7.483999999999998, 11.333666666666666, 8.065999999999999, 6.941333333333333, 7.876666666666666, 7.508, 13.451333333333336], "episode_lengths": [16, 19, 18, 18, 23, 16, 19, 21, 18, 23, 22, 21, 18, 22, 16, 22, 17, 18, 15, 17, 26, 22, 14, 16, 23, 18, 21, 23, 18, 25, 20, 16, 14, 24, 24, 23, 19, 15, 22, 20, 18, 20, 20, 20, 21, 14, 19, 16, 17, 19, 20, 27, 14, 22, 20, 19, 15, 17, 21, 17, 19, 21, 14, 16, 17, 17, 20, 19, 16, 19, 22, 17, 20, 17, 24, 14, 21, 13, 15, 15, 19, 15, 16, 21, 18, 21, 17, 14, 19, 20, 18, 19, 20, 17, 23, 18, 16, 17, 16, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4038717645649592, "mean_inference_ms": 2.5599291097199046, "mean_action_processing_ms": 0.5267469147234297, "mean_env_wait_ms": 0.12692232065936848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03126811981201172, "StateBufferConnector_ms": 0.03180694580078125, "ViewRequirementAgentConnector_ms": 0.5483791828155518}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1355.7668672986624, "num_env_steps_trained_throughput_per_sec": 1355.7668672986624, "timesteps_total": 22400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 22400, "timers": {"training_iteration_time_ms": 978.916, "sample_time_ms": 947.531, "load_time_ms": 0.195, "load_throughput": 7169750.427, "learn_time_ms": 12.171, "learn_throughput": 115031.297, "synch_weights_time_ms": 18.727}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "done": false, "episodes_total": 1184, "training_iteration": 16, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-11", "timestamp": 1702021151, "time_this_iter_s": 1.0498855113983154, "time_total_s": 16.598416566848755, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.598416566848755, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 95.7, "ram_util_percent": 97.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0983736515045166, "total_loss": 1.0983736515045166, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 23800, "num_env_steps_trained": 23800, "num_agent_steps_sampled": 23800, "num_agent_steps_trained": 23800}, "sampler_results": {"episode_reward_max": 13.451333333333336, "episode_reward_min": 6.055333333333332, "episode_reward_mean": 8.552926666666664, "episode_len_mean": 18.23, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.107333333333333, 6.229666666666667, 6.512666666666667, 10.08133333333333, 7.018999999999998, 8.081999999999999, 9.515999999999998, 8.109, 9.516999999999998, 8.040666666666665, 6.495333333333331, 9.148999999999997, 10.030666666666667, 8.556, 10.268999999999998, 9.800999999999998, 7.483999999999998, 11.333666666666666, 8.065999999999999, 6.941333333333333, 7.876666666666666, 7.508, 13.451333333333336, 6.403999999999998, 6.202999999999999, 7.9546666666666646, 9.274333333333331, 9.843666666666664, 9.881333333333334, 11.35733333333333, 11.59433333333333, 8.691999999999998, 6.7669999999999995, 8.66133333333333, 8.023666666666664, 8.24333333333333, 7.0040000000000004, 6.110666666666666, 9.003666666666666, 7.275333333333332, 8.213, 9.483999999999998, 7.679, 9.944333333333335, 7.3340000000000005, 6.913333333333333, 11.825999999999995, 9.43133333333333, 11.883000000000001, 6.492999999999999, 6.952999999999998, 10.779999999999998, 9.501999999999997, 7.597999999999999, 8.526, 8.17133333333333, 12.487333333333334, 7.456333333333332, 8.548333333333332, 11.639, 7.512333333333332, 9.683666666666667, 8.700999999999997, 6.842333333333332, 11.425666666666666, 9.078999999999997, 7.435666666666665, 11.091000000000001, 9.725333333333332, 8.251999999999999, 7.741999999999997, 8.169666666666664, 9.231333333333332, 9.085666666666663, 7.0266666666666655, 9.166666666666666, 6.888666666666666, 8.238, 10.203666666666665, 8.643, 7.461333333333334, 8.681333333333333, 9.366666666666665, 6.774, 7.198999999999999, 7.3420000000000005, 7.481666666666665, 9.06433333333333, 6.754666666666665, 9.274666666666667, 10.744666666666665, 6.177333333333333, 8.210666666666663, 9.816999999999997, 7.694333333333333, 6.055333333333332, 7.485333333333331, 8.999999999999998, 8.309333333333335, 8.922999999999996], "episode_lengths": [13, 15, 15, 19, 15, 16, 21, 18, 21, 17, 14, 19, 20, 18, 19, 20, 17, 23, 18, 16, 17, 16, 27, 14, 14, 16, 23, 23, 23, 23, 23, 21, 15, 18, 19, 18, 16, 14, 23, 15, 16, 18, 17, 21, 15, 15, 23, 21, 25, 14, 16, 22, 19, 18, 16, 18, 25, 15, 17, 24, 17, 21, 20, 16, 25, 19, 15, 20, 18, 17, 16, 17, 18, 17, 17, 19, 15, 17, 22, 20, 16, 18, 20, 15, 16, 18, 17, 19, 14, 19, 21, 13, 18, 21, 19, 13, 16, 19, 18, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4575728027262653, "mean_inference_ms": 2.666674950553798, "mean_action_processing_ms": 0.5368100751571628, "mean_env_wait_ms": 0.1320184670889674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07006287574768066, "StateBufferConnector_ms": 0.04409623146057129, "ViewRequirementAgentConnector_ms": 0.6478235721588135}}, "episode_reward_max": 13.451333333333336, "episode_reward_min": 6.055333333333332, "episode_reward_mean": 8.552926666666664, "episode_len_mean": 18.23, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.107333333333333, 6.229666666666667, 6.512666666666667, 10.08133333333333, 7.018999999999998, 8.081999999999999, 9.515999999999998, 8.109, 9.516999999999998, 8.040666666666665, 6.495333333333331, 9.148999999999997, 10.030666666666667, 8.556, 10.268999999999998, 9.800999999999998, 7.483999999999998, 11.333666666666666, 8.065999999999999, 6.941333333333333, 7.876666666666666, 7.508, 13.451333333333336, 6.403999999999998, 6.202999999999999, 7.9546666666666646, 9.274333333333331, 9.843666666666664, 9.881333333333334, 11.35733333333333, 11.59433333333333, 8.691999999999998, 6.7669999999999995, 8.66133333333333, 8.023666666666664, 8.24333333333333, 7.0040000000000004, 6.110666666666666, 9.003666666666666, 7.275333333333332, 8.213, 9.483999999999998, 7.679, 9.944333333333335, 7.3340000000000005, 6.913333333333333, 11.825999999999995, 9.43133333333333, 11.883000000000001, 6.492999999999999, 6.952999999999998, 10.779999999999998, 9.501999999999997, 7.597999999999999, 8.526, 8.17133333333333, 12.487333333333334, 7.456333333333332, 8.548333333333332, 11.639, 7.512333333333332, 9.683666666666667, 8.700999999999997, 6.842333333333332, 11.425666666666666, 9.078999999999997, 7.435666666666665, 11.091000000000001, 9.725333333333332, 8.251999999999999, 7.741999999999997, 8.169666666666664, 9.231333333333332, 9.085666666666663, 7.0266666666666655, 9.166666666666666, 6.888666666666666, 8.238, 10.203666666666665, 8.643, 7.461333333333334, 8.681333333333333, 9.366666666666665, 6.774, 7.198999999999999, 7.3420000000000005, 7.481666666666665, 9.06433333333333, 6.754666666666665, 9.274666666666667, 10.744666666666665, 6.177333333333333, 8.210666666666663, 9.816999999999997, 7.694333333333333, 6.055333333333332, 7.485333333333331, 8.999999999999998, 8.309333333333335, 8.922999999999996], "episode_lengths": [13, 15, 15, 19, 15, 16, 21, 18, 21, 17, 14, 19, 20, 18, 19, 20, 17, 23, 18, 16, 17, 16, 27, 14, 14, 16, 23, 23, 23, 23, 23, 21, 15, 18, 19, 18, 16, 14, 23, 15, 16, 18, 17, 21, 15, 15, 23, 21, 25, 14, 16, 22, 19, 18, 16, 18, 25, 15, 17, 24, 17, 21, 20, 16, 25, 19, 15, 20, 18, 17, 16, 17, 18, 17, 17, 19, 15, 17, 22, 20, 16, 18, 20, 15, 16, 18, 17, 19, 14, 19, 21, 13, 18, 21, 19, 13, 16, 19, 18, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4575728027262653, "mean_inference_ms": 2.666674950553798, "mean_action_processing_ms": 0.5368100751571628, "mean_env_wait_ms": 0.1320184670889674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07006287574768066, "StateBufferConnector_ms": 0.04409623146057129, "ViewRequirementAgentConnector_ms": 0.6478235721588135}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23800, "num_agent_steps_trained": 23800, "num_env_steps_sampled": 23800, "num_env_steps_trained": 23800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 770.7342760786493, "num_env_steps_trained_throughput_per_sec": 770.7342760786493, "timesteps_total": 23800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 23800, "timers": {"training_iteration_time_ms": 1069.853, "sample_time_ms": 1037.322, "load_time_ms": 0.295, "load_throughput": 4748908.694, "learn_time_ms": 12.778, "learn_throughput": 109562.119, "synch_weights_time_ms": 19.138}, "counters": {"num_env_steps_sampled": 23800, "num_env_steps_trained": 23800, "num_agent_steps_sampled": 23800, "num_agent_steps_trained": 23800}, "done": false, "episodes_total": 1261, "training_iteration": 17, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-13", "timestamp": 1702021153, "time_this_iter_s": 1.8447041511535645, "time_total_s": 18.44312071800232, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.44312071800232, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 97.5, "ram_util_percent": 98.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0973069667816162, "total_loss": 1.0973069667816162, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "sampler_results": {"episode_reward_max": 13.543000000000001, "episode_reward_min": 5.728999999999999, "episode_reward_mean": 8.602079999999999, "episode_len_mean": 18.4, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 6.888666666666666, 8.238, 10.203666666666665, 8.643, 7.461333333333334, 8.681333333333333, 9.366666666666665, 6.774, 7.198999999999999, 7.3420000000000005, 7.481666666666665, 9.06433333333333, 6.754666666666665, 9.274666666666667, 10.744666666666665, 6.177333333333333, 8.210666666666663, 9.816999999999997, 7.694333333333333, 6.055333333333332, 7.485333333333331, 8.999999999999998, 8.309333333333335, 8.922999999999996, 6.951999999999999, 7.686666666666666, 7.130333333333332, 7.766666666666666, 11.950666666666667, 7.248666666666665, 7.798333333333335, 13.543000000000001, 6.438999999999999, 7.151333333333332, 7.8343333333333325, 7.518666666666666, 9.619000000000002, 8.908999999999999, 10.018333333333333, 8.725333333333332, 9.611999999999998, 7.9833333333333325, 9.715666666666664, 7.226999999999999, 10.336666666666668, 8.213333333333333, 9.955999999999996, 7.2909999999999995, 7.443, 11.280666666666665, 9.881333333333334, 9.91333333333333, 8.189333333333332, 8.211999999999998, 9.347333333333331, 8.740333333333332, 8.600666666666665, 9.933999999999997, 7.025, 8.811333333333334, 7.499999999999998, 8.224999999999998, 8.049999999999999, 9.347666666666663, 7.020666666666665, 9.560666666666666, 7.596333333333334, 8.601333333333333, 9.586666666666666, 7.554333333333332, 10.329999999999997, 7.972, 10.622, 9.928333333333333, 9.735666666666665, 7.357999999999999, 7.470666666666666, 8.649333333333331, 8.855333333333332, 9.102, 11.993, 11.048666666666664, 7.312666666666667, 8.45133333333333, 9.684000000000001, 12.801999999999996, 7.696, 10.838999999999999, 7.984999999999999, 8.876666666666663, 9.767333333333335, 7.609, 9.194333333333335, 9.046000000000001, 5.999666666666666, 7.774, 5.728999999999999, 8.532, 7.841000000000001], "episode_lengths": [19, 15, 17, 22, 20, 16, 18, 20, 15, 16, 18, 17, 19, 14, 19, 21, 13, 18, 21, 19, 13, 16, 19, 18, 20, 16, 15, 15, 16, 24, 15, 16, 26, 14, 16, 19, 17, 24, 21, 22, 20, 20, 18, 20, 15, 22, 16, 19, 16, 15, 21, 20, 19, 20, 17, 19, 20, 18, 20, 16, 18, 17, 17, 17, 19, 16, 22, 17, 17, 21, 15, 23, 17, 22, 21, 19, 16, 16, 20, 19, 18, 25, 23, 17, 19, 20, 31, 16, 22, 17, 20, 20, 17, 18, 20, 14, 16, 13, 18, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5097732188488486, "mean_inference_ms": 2.772140843025286, "mean_action_processing_ms": 0.5536210054103234, "mean_env_wait_ms": 0.13640050773835535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040276288986206055, "StateBufferConnector_ms": 0.07229733467102051, "ViewRequirementAgentConnector_ms": 0.6944339275360107}}, "episode_reward_max": 13.543000000000001, "episode_reward_min": 5.728999999999999, "episode_reward_mean": 8.602079999999999, "episode_len_mean": 18.4, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 6.888666666666666, 8.238, 10.203666666666665, 8.643, 7.461333333333334, 8.681333333333333, 9.366666666666665, 6.774, 7.198999999999999, 7.3420000000000005, 7.481666666666665, 9.06433333333333, 6.754666666666665, 9.274666666666667, 10.744666666666665, 6.177333333333333, 8.210666666666663, 9.816999999999997, 7.694333333333333, 6.055333333333332, 7.485333333333331, 8.999999999999998, 8.309333333333335, 8.922999999999996, 6.951999999999999, 7.686666666666666, 7.130333333333332, 7.766666666666666, 11.950666666666667, 7.248666666666665, 7.798333333333335, 13.543000000000001, 6.438999999999999, 7.151333333333332, 7.8343333333333325, 7.518666666666666, 9.619000000000002, 8.908999999999999, 10.018333333333333, 8.725333333333332, 9.611999999999998, 7.9833333333333325, 9.715666666666664, 7.226999999999999, 10.336666666666668, 8.213333333333333, 9.955999999999996, 7.2909999999999995, 7.443, 11.280666666666665, 9.881333333333334, 9.91333333333333, 8.189333333333332, 8.211999999999998, 9.347333333333331, 8.740333333333332, 8.600666666666665, 9.933999999999997, 7.025, 8.811333333333334, 7.499999999999998, 8.224999999999998, 8.049999999999999, 9.347666666666663, 7.020666666666665, 9.560666666666666, 7.596333333333334, 8.601333333333333, 9.586666666666666, 7.554333333333332, 10.329999999999997, 7.972, 10.622, 9.928333333333333, 9.735666666666665, 7.357999999999999, 7.470666666666666, 8.649333333333331, 8.855333333333332, 9.102, 11.993, 11.048666666666664, 7.312666666666667, 8.45133333333333, 9.684000000000001, 12.801999999999996, 7.696, 10.838999999999999, 7.984999999999999, 8.876666666666663, 9.767333333333335, 7.609, 9.194333333333335, 9.046000000000001, 5.999666666666666, 7.774, 5.728999999999999, 8.532, 7.841000000000001], "episode_lengths": [19, 15, 17, 22, 20, 16, 18, 20, 15, 16, 18, 17, 19, 14, 19, 21, 13, 18, 21, 19, 13, 16, 19, 18, 20, 16, 15, 15, 16, 24, 15, 16, 26, 14, 16, 19, 17, 24, 21, 22, 20, 20, 18, 20, 15, 22, 16, 19, 16, 15, 21, 20, 19, 20, 17, 19, 20, 18, 20, 16, 18, 17, 17, 17, 19, 16, 22, 17, 17, 21, 15, 23, 17, 22, 21, 19, 16, 16, 20, 19, 18, 25, 23, 17, 19, 20, 31, 16, 22, 17, 20, 20, 17, 18, 20, 14, 16, 13, 18, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5097732188488486, "mean_inference_ms": 2.772140843025286, "mean_action_processing_ms": 0.5536210054103234, "mean_env_wait_ms": 0.13640050773835535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040276288986206055, "StateBufferConnector_ms": 0.07229733467102051, "ViewRequirementAgentConnector_ms": 0.6944339275360107}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 826.005441315256, "num_env_steps_trained_throughput_per_sec": 826.005441315256, "timesteps_total": 25200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 1146.111, "sample_time_ms": 1112.632, "load_time_ms": 0.416, "load_throughput": 3365636.27, "learn_time_ms": 12.86, "learn_throughput": 108860.962, "synch_weights_time_ms": 19.882}, "counters": {"num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "done": false, "episodes_total": 1336, "training_iteration": 18, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-15", "timestamp": 1702021155, "time_this_iter_s": 1.7301647663116455, "time_total_s": 20.173285484313965, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 20.173285484313965, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 100.0, "ram_util_percent": 97.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0981545448303223, "total_loss": 1.0981545448303223, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 26600, "num_env_steps_trained": 26600, "num_agent_steps_sampled": 26600, "num_agent_steps_trained": 26600}, "sampler_results": {"episode_reward_max": 12.801999999999996, "episode_reward_min": 5.728999999999999, "episode_reward_mean": 8.97974, "episode_len_mean": 19.3, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.329999999999997, 7.972, 10.622, 9.928333333333333, 9.735666666666665, 7.357999999999999, 7.470666666666666, 8.649333333333331, 8.855333333333332, 9.102, 11.993, 11.048666666666664, 7.312666666666667, 8.45133333333333, 9.684000000000001, 12.801999999999996, 7.696, 10.838999999999999, 7.984999999999999, 8.876666666666663, 9.767333333333335, 7.609, 9.194333333333335, 9.046000000000001, 5.999666666666666, 7.774, 5.728999999999999, 8.532, 7.841000000000001, 8.369333333333334, 8.44533333333333, 7.3870000000000005, 9.174333333333335, 7.404666666666665, 9.078999999999997, 8.471666666666666, 8.096666666666666, 8.282, 12.123333333333331, 7.840333333333334, 7.539, 6.280333333333333, 9.98033333333333, 8.854999999999997, 8.857333333333333, 8.014999999999999, 10.277333333333335, 10.454666666666666, 8.760999999999997, 9.003, 7.923333333333334, 11.349666666666666, 8.343666666666667, 10.675666666666665, 7.810666666666664, 8.854666666666663, 8.559333333333331, 7.378333333333332, 8.508666666666667, 8.126999999999999, 8.722333333333333, 11.99666666666666, 10.415333333333333, 8.531666666666666, 9.748, 9.577999999999994, 9.116999999999996, 7.773666666666665, 11.467333333333332, 11.196, 8.584, 7.926666666666666, 8.200333333333331, 9.192666666666664, 8.760333333333332, 6.5843333333333325, 9.891666666666667, 8.071999999999997, 9.398666666666667, 9.939666666666666, 7.623333333333333, 9.399666666666668, 8.756666666666666, 12.219999999999999, 8.677333333333332, 12.571, 5.883666666666667, 7.761333333333334, 7.833333333333332, 7.860666666666666, 10.846999999999998, 9.182333333333332, 12.652333333333333, 9.856666666666664, 10.290333333333331, 7.050999999999998, 10.087999999999997, 8.73, 8.408333333333333, 8.753], "episode_lengths": [23, 17, 22, 21, 19, 16, 16, 20, 19, 18, 25, 23, 17, 19, 20, 31, 16, 22, 17, 20, 20, 17, 18, 20, 14, 16, 13, 18, 17, 19, 18, 20, 20, 17, 19, 18, 18, 17, 26, 17, 20, 15, 24, 20, 21, 17, 23, 21, 19, 18, 18, 22, 19, 21, 19, 18, 20, 16, 18, 16, 20, 29, 20, 17, 19, 22, 19, 17, 22, 24, 17, 18, 16, 22, 20, 14, 20, 18, 22, 21, 17, 19, 21, 27, 19, 24, 13, 16, 17, 17, 22, 18, 23, 22, 22, 15, 19, 18, 18, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.549279108024117, "mean_inference_ms": 2.8187291071894434, "mean_action_processing_ms": 0.5676184206961196, "mean_env_wait_ms": 0.14131775769785007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020296335220336914, "StateBufferConnector_ms": 0.03043079376220703, "ViewRequirementAgentConnector_ms": 0.7391002178192139}}, "episode_reward_max": 12.801999999999996, "episode_reward_min": 5.728999999999999, "episode_reward_mean": 8.97974, "episode_len_mean": 19.3, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.329999999999997, 7.972, 10.622, 9.928333333333333, 9.735666666666665, 7.357999999999999, 7.470666666666666, 8.649333333333331, 8.855333333333332, 9.102, 11.993, 11.048666666666664, 7.312666666666667, 8.45133333333333, 9.684000000000001, 12.801999999999996, 7.696, 10.838999999999999, 7.984999999999999, 8.876666666666663, 9.767333333333335, 7.609, 9.194333333333335, 9.046000000000001, 5.999666666666666, 7.774, 5.728999999999999, 8.532, 7.841000000000001, 8.369333333333334, 8.44533333333333, 7.3870000000000005, 9.174333333333335, 7.404666666666665, 9.078999999999997, 8.471666666666666, 8.096666666666666, 8.282, 12.123333333333331, 7.840333333333334, 7.539, 6.280333333333333, 9.98033333333333, 8.854999999999997, 8.857333333333333, 8.014999999999999, 10.277333333333335, 10.454666666666666, 8.760999999999997, 9.003, 7.923333333333334, 11.349666666666666, 8.343666666666667, 10.675666666666665, 7.810666666666664, 8.854666666666663, 8.559333333333331, 7.378333333333332, 8.508666666666667, 8.126999999999999, 8.722333333333333, 11.99666666666666, 10.415333333333333, 8.531666666666666, 9.748, 9.577999999999994, 9.116999999999996, 7.773666666666665, 11.467333333333332, 11.196, 8.584, 7.926666666666666, 8.200333333333331, 9.192666666666664, 8.760333333333332, 6.5843333333333325, 9.891666666666667, 8.071999999999997, 9.398666666666667, 9.939666666666666, 7.623333333333333, 9.399666666666668, 8.756666666666666, 12.219999999999999, 8.677333333333332, 12.571, 5.883666666666667, 7.761333333333334, 7.833333333333332, 7.860666666666666, 10.846999999999998, 9.182333333333332, 12.652333333333333, 9.856666666666664, 10.290333333333331, 7.050999999999998, 10.087999999999997, 8.73, 8.408333333333333, 8.753], "episode_lengths": [23, 17, 22, 21, 19, 16, 16, 20, 19, 18, 25, 23, 17, 19, 20, 31, 16, 22, 17, 20, 20, 17, 18, 20, 14, 16, 13, 18, 17, 19, 18, 20, 20, 17, 19, 18, 18, 17, 26, 17, 20, 15, 24, 20, 21, 17, 23, 21, 19, 18, 18, 22, 19, 21, 19, 18, 20, 16, 18, 16, 20, 29, 20, 17, 19, 22, 19, 17, 22, 24, 17, 18, 16, 22, 20, 14, 20, 18, 22, 21, 17, 19, 21, 27, 19, 24, 13, 16, 17, 17, 22, 18, 23, 22, 22, 15, 19, 18, 18, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.549279108024117, "mean_inference_ms": 2.8187291071894434, "mean_action_processing_ms": 0.5676184206961196, "mean_env_wait_ms": 0.14131775769785007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020296335220336914, "StateBufferConnector_ms": 0.03043079376220703, "ViewRequirementAgentConnector_ms": 0.7391002178192139}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26600, "num_agent_steps_trained": 26600, "num_env_steps_sampled": 26600, "num_env_steps_trained": 26600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 936.5030122028745, "num_env_steps_trained_throughput_per_sec": 936.5030122028745, "timesteps_total": 26600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 26600, "timers": {"training_iteration_time_ms": 1207.869, "sample_time_ms": 1174.044, "load_time_ms": 0.516, "load_throughput": 2712878.54, "learn_time_ms": 12.807, "learn_throughput": 109316.951, "synch_weights_time_ms": 20.282}, "counters": {"num_env_steps_sampled": 26600, "num_env_steps_trained": 26600, "num_agent_steps_sampled": 26600, "num_agent_steps_trained": 26600}, "done": false, "episodes_total": 1407, "training_iteration": 19, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-16", "timestamp": 1702021156, "time_this_iter_s": 1.5179197788238525, "time_total_s": 21.691205263137817, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.691205263137817, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.8, "ram_util_percent": 96.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.096483826637268, "total_loss": 1.096483826637268, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 12.652333333333333, "episode_reward_min": 5.883666666666667, "episode_reward_mean": 8.817396666666664, "episode_len_mean": 18.81, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.071999999999997, 9.398666666666667, 9.939666666666666, 7.623333333333333, 9.399666666666668, 8.756666666666666, 12.219999999999999, 8.677333333333332, 12.571, 5.883666666666667, 7.761333333333334, 7.833333333333332, 7.860666666666666, 10.846999999999998, 9.182333333333332, 12.652333333333333, 9.856666666666664, 10.290333333333331, 7.050999999999998, 10.087999999999997, 8.73, 8.408333333333333, 8.753, 8.239333333333331, 10.272333333333332, 8.402666666666665, 10.873333333333333, 7.798999999999998, 7.531333333333331, 8.825, 11.70966666666666, 7.355333333333332, 8.070999999999998, 8.725999999999996, 9.006666666666668, 7.196333333333332, 11.590666666666666, 9.271999999999998, 7.778999999999999, 7.068333333333333, 11.038666666666668, 8.769999999999998, 7.355666666666666, 8.440666666666667, 7.295999999999998, 6.928333333333332, 9.909333333333329, 9.638666666666666, 9.173666666666666, 8.702666666666666, 8.329999999999998, 9.528, 11.656333333333327, 7.579999999999997, 7.280999999999999, 8.814666666666664, 7.343999999999998, 9.873, 11.548333333333334, 6.606666666666666, 8.217999999999998, 8.568333333333332, 7.561666666666664, 9.578000000000001, 9.732333333333333, 9.717666666666668, 8.626666666666665, 7.537666666666666, 9.825333333333331, 9.527333333333331, 8.728666666666665, 8.008666666666667, 6.853999999999999, 6.811333333333334, 11.576666666666666, 6.409666666666666, 6.977666666666665, 9.705666666666666, 9.925333333333334, 8.815, 9.777, 12.363666666666667, 8.201333333333332, 7.566333333333334, 8.783333333333331, 8.434000000000001, 9.264666666666665, 9.26633333333333, 8.981999999999998, 8.228666666666665, 7.547333333333332, 8.620999999999999, 8.554333333333332, 6.375666666666667, 9.549333333333331, 9.225333333333332, 7.953333333333335, 7.223, 7.084666666666668, 8.642666666666663], "episode_lengths": [18, 22, 21, 17, 19, 21, 27, 19, 24, 13, 16, 17, 17, 22, 18, 23, 22, 22, 15, 19, 18, 18, 18, 19, 22, 19, 22, 17, 17, 19, 25, 15, 17, 20, 20, 16, 21, 20, 19, 15, 22, 19, 17, 18, 15, 17, 20, 18, 22, 17, 18, 20, 24, 15, 17, 18, 16, 23, 27, 16, 17, 18, 18, 20, 20, 21, 18, 16, 18, 20, 17, 17, 16, 14, 22, 14, 16, 21, 22, 18, 20, 24, 16, 19, 19, 19, 19, 21, 21, 15, 18, 17, 19, 15, 18, 23, 17, 16, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.564489719668486, "mean_inference_ms": 2.8537413427147, "mean_action_processing_ms": 0.5704396024009936, "mean_env_wait_ms": 0.1409779682181175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07422757148742676, "StateBufferConnector_ms": 0.0336155891418457, "ViewRequirementAgentConnector_ms": 0.5256383419036865}}, "episode_reward_max": 12.652333333333333, "episode_reward_min": 5.883666666666667, "episode_reward_mean": 8.817396666666664, "episode_len_mean": 18.81, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.071999999999997, 9.398666666666667, 9.939666666666666, 7.623333333333333, 9.399666666666668, 8.756666666666666, 12.219999999999999, 8.677333333333332, 12.571, 5.883666666666667, 7.761333333333334, 7.833333333333332, 7.860666666666666, 10.846999999999998, 9.182333333333332, 12.652333333333333, 9.856666666666664, 10.290333333333331, 7.050999999999998, 10.087999999999997, 8.73, 8.408333333333333, 8.753, 8.239333333333331, 10.272333333333332, 8.402666666666665, 10.873333333333333, 7.798999999999998, 7.531333333333331, 8.825, 11.70966666666666, 7.355333333333332, 8.070999999999998, 8.725999999999996, 9.006666666666668, 7.196333333333332, 11.590666666666666, 9.271999999999998, 7.778999999999999, 7.068333333333333, 11.038666666666668, 8.769999999999998, 7.355666666666666, 8.440666666666667, 7.295999999999998, 6.928333333333332, 9.909333333333329, 9.638666666666666, 9.173666666666666, 8.702666666666666, 8.329999999999998, 9.528, 11.656333333333327, 7.579999999999997, 7.280999999999999, 8.814666666666664, 7.343999999999998, 9.873, 11.548333333333334, 6.606666666666666, 8.217999999999998, 8.568333333333332, 7.561666666666664, 9.578000000000001, 9.732333333333333, 9.717666666666668, 8.626666666666665, 7.537666666666666, 9.825333333333331, 9.527333333333331, 8.728666666666665, 8.008666666666667, 6.853999999999999, 6.811333333333334, 11.576666666666666, 6.409666666666666, 6.977666666666665, 9.705666666666666, 9.925333333333334, 8.815, 9.777, 12.363666666666667, 8.201333333333332, 7.566333333333334, 8.783333333333331, 8.434000000000001, 9.264666666666665, 9.26633333333333, 8.981999999999998, 8.228666666666665, 7.547333333333332, 8.620999999999999, 8.554333333333332, 6.375666666666667, 9.549333333333331, 9.225333333333332, 7.953333333333335, 7.223, 7.084666666666668, 8.642666666666663], "episode_lengths": [18, 22, 21, 17, 19, 21, 27, 19, 24, 13, 16, 17, 17, 22, 18, 23, 22, 22, 15, 19, 18, 18, 18, 19, 22, 19, 22, 17, 17, 19, 25, 15, 17, 20, 20, 16, 21, 20, 19, 15, 22, 19, 17, 18, 15, 17, 20, 18, 22, 17, 18, 20, 24, 15, 17, 18, 16, 23, 27, 16, 17, 18, 18, 20, 20, 21, 18, 16, 18, 20, 17, 17, 16, 14, 22, 14, 16, 21, 22, 18, 20, 24, 16, 19, 19, 19, 19, 21, 21, 15, 18, 17, 19, 15, 18, 23, 17, 16, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.564489719668486, "mean_inference_ms": 2.8537413427147, "mean_action_processing_ms": 0.5704396024009936, "mean_env_wait_ms": 0.1409779682181175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07422757148742676, "StateBufferConnector_ms": 0.0336155891418457, "ViewRequirementAgentConnector_ms": 0.5256383419036865}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1121.9872233115523, "num_env_steps_trained_throughput_per_sec": 1121.9872233115523, "timesteps_total": 28000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 1233.293, "sample_time_ms": 1199.251, "load_time_ms": 0.616, "load_throughput": 2272983.51, "learn_time_ms": 12.81, "learn_throughput": 109289.891, "synch_weights_time_ms": 20.395}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 1484, "training_iteration": 20, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-18", "timestamp": 1702021158, "time_this_iter_s": 1.2737512588500977, "time_total_s": 22.964956521987915, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.964956521987915, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 98.2, "ram_util_percent": 97.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0981882810592651, "total_loss": 1.0981882810592651, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}}, "num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400}, "sampler_results": {"episode_reward_max": 13.48433333333333, "episode_reward_min": 5.667333333333334, "episode_reward_mean": 8.729823333333332, "episode_len_mean": 18.73, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.811333333333334, 11.576666666666666, 6.409666666666666, 6.977666666666665, 9.705666666666666, 9.925333333333334, 8.815, 9.777, 12.363666666666667, 8.201333333333332, 7.566333333333334, 8.783333333333331, 8.434000000000001, 9.264666666666665, 9.26633333333333, 8.981999999999998, 8.228666666666665, 7.547333333333332, 8.620999999999999, 8.554333333333332, 6.375666666666667, 9.549333333333331, 9.225333333333332, 7.953333333333335, 7.223, 7.084666666666668, 8.642666666666663, 9.40933333333333, 11.078, 7.828666666666668, 8.604, 8.162666666666663, 7.753333333333334, 8.171, 8.511666666666667, 8.646333333333333, 9.200999999999999, 8.448666666666664, 5.865333333333332, 6.037666666666666, 7.779333333333332, 12.195666666666664, 8.207999999999998, 12.909999999999995, 9.674333333333331, 10.134333333333332, 9.274666666666668, 8.986666666666666, 8.369999999999997, 12.546333333333331, 10.301999999999998, 7.806666666666667, 8.518666666666665, 8.193333333333332, 8.366999999999999, 7.970999999999999, 10.738666666666663, 7.880333333333332, 8.872333333333332, 8.947999999999999, 6.583333333333332, 10.983333333333329, 7.244333333333334, 7.8, 8.358333333333333, 8.157333333333332, 6.853999999999998, 6.537666666666665, 9.835666666666665, 8.394999999999998, 11.20233333333333, 10.442666666666668, 9.559333333333335, 9.493333333333332, 8.42933333333333, 11.89633333333333, 6.2589999999999995, 6.961, 10.125333333333332, 13.019666666666666, 8.438666666666666, 5.667333333333334, 9.387999999999998, 7.757333333333333, 7.402666666666666, 13.233, 6.570333333333333, 7.810666666666667, 6.468666666666667, 7.017333333333331, 8.513666666666666, 7.2443333333333335, 10.243333333333332, 7.5603333333333325, 6.911333333333333, 13.48433333333333, 8.845999999999997, 8.630666666666666, 8.44733333333333, 7.949333333333332], "episode_lengths": [14, 22, 14, 16, 21, 22, 18, 20, 24, 16, 19, 19, 19, 19, 21, 21, 15, 18, 17, 19, 15, 18, 23, 17, 16, 17, 17, 21, 22, 17, 18, 18, 18, 17, 19, 18, 19, 16, 15, 15, 17, 24, 19, 26, 19, 21, 21, 18, 19, 27, 22, 16, 19, 18, 17, 16, 21, 17, 17, 20, 16, 24, 15, 16, 17, 17, 14, 15, 21, 19, 21, 20, 18, 23, 19, 25, 13, 15, 21, 25, 18, 13, 19, 19, 16, 29, 14, 16, 14, 17, 20, 17, 25, 16, 18, 27, 20, 19, 19, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5707694969094468, "mean_inference_ms": 2.869603515898307, "mean_action_processing_ms": 0.5789224908975638, "mean_env_wait_ms": 0.1411462156367849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030468463897705078, "StateBufferConnector_ms": 0.03986334800720215, "ViewRequirementAgentConnector_ms": 0.528799295425415}}, "episode_reward_max": 13.48433333333333, "episode_reward_min": 5.667333333333334, "episode_reward_mean": 8.729823333333332, "episode_len_mean": 18.73, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.811333333333334, 11.576666666666666, 6.409666666666666, 6.977666666666665, 9.705666666666666, 9.925333333333334, 8.815, 9.777, 12.363666666666667, 8.201333333333332, 7.566333333333334, 8.783333333333331, 8.434000000000001, 9.264666666666665, 9.26633333333333, 8.981999999999998, 8.228666666666665, 7.547333333333332, 8.620999999999999, 8.554333333333332, 6.375666666666667, 9.549333333333331, 9.225333333333332, 7.953333333333335, 7.223, 7.084666666666668, 8.642666666666663, 9.40933333333333, 11.078, 7.828666666666668, 8.604, 8.162666666666663, 7.753333333333334, 8.171, 8.511666666666667, 8.646333333333333, 9.200999999999999, 8.448666666666664, 5.865333333333332, 6.037666666666666, 7.779333333333332, 12.195666666666664, 8.207999999999998, 12.909999999999995, 9.674333333333331, 10.134333333333332, 9.274666666666668, 8.986666666666666, 8.369999999999997, 12.546333333333331, 10.301999999999998, 7.806666666666667, 8.518666666666665, 8.193333333333332, 8.366999999999999, 7.970999999999999, 10.738666666666663, 7.880333333333332, 8.872333333333332, 8.947999999999999, 6.583333333333332, 10.983333333333329, 7.244333333333334, 7.8, 8.358333333333333, 8.157333333333332, 6.853999999999998, 6.537666666666665, 9.835666666666665, 8.394999999999998, 11.20233333333333, 10.442666666666668, 9.559333333333335, 9.493333333333332, 8.42933333333333, 11.89633333333333, 6.2589999999999995, 6.961, 10.125333333333332, 13.019666666666666, 8.438666666666666, 5.667333333333334, 9.387999999999998, 7.757333333333333, 7.402666666666666, 13.233, 6.570333333333333, 7.810666666666667, 6.468666666666667, 7.017333333333331, 8.513666666666666, 7.2443333333333335, 10.243333333333332, 7.5603333333333325, 6.911333333333333, 13.48433333333333, 8.845999999999997, 8.630666666666666, 8.44733333333333, 7.949333333333332], "episode_lengths": [14, 22, 14, 16, 21, 22, 18, 20, 24, 16, 19, 19, 19, 19, 21, 21, 15, 18, 17, 19, 15, 18, 23, 17, 16, 17, 17, 21, 22, 17, 18, 18, 18, 17, 19, 18, 19, 16, 15, 15, 17, 24, 19, 26, 19, 21, 21, 18, 19, 27, 22, 16, 19, 18, 17, 16, 21, 17, 17, 20, 16, 24, 15, 16, 17, 17, 14, 15, 21, 19, 21, 20, 18, 23, 19, 25, 13, 15, 21, 25, 18, 13, 19, 19, 16, 29, 14, 16, 14, 17, 20, 17, 25, 16, 18, 27, 20, 19, 19, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5707694969094468, "mean_inference_ms": 2.869603515898307, "mean_action_processing_ms": 0.5789224908975638, "mean_env_wait_ms": 0.1411462156367849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030468463897705078, "StateBufferConnector_ms": 0.03986334800720215, "ViewRequirementAgentConnector_ms": 0.528799295425415}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400, "num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1109.6851735595226, "num_env_steps_trained_throughput_per_sec": 1109.6851735595226, "timesteps_total": 29400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 29400, "timers": {"training_iteration_time_ms": 1268.739, "sample_time_ms": 1234.39, "load_time_ms": 0.616, "load_throughput": 2272983.51, "learn_time_ms": 13.02, "learn_throughput": 107524.791, "synch_weights_time_ms": 20.492}, "counters": {"num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400}, "done": false, "episodes_total": 1557, "training_iteration": 21, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-19", "timestamp": 1702021159, "time_this_iter_s": 1.2786204814910889, "time_total_s": 24.243577003479004, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.243577003479004, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 93.8, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0986859798431396, "total_loss": 1.0986859798431396, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 30800, "num_env_steps_trained": 30800, "num_agent_steps_sampled": 30800, "num_agent_steps_trained": 30800}, "sampler_results": {"episode_reward_max": 15.162666666666667, "episode_reward_min": 5.667333333333334, "episode_reward_mean": 8.902663333333331, "episode_len_mean": 19.02, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.42933333333333, 11.89633333333333, 6.2589999999999995, 6.961, 10.125333333333332, 13.019666666666666, 8.438666666666666, 5.667333333333334, 9.387999999999998, 7.757333333333333, 7.402666666666666, 13.233, 6.570333333333333, 7.810666666666667, 6.468666666666667, 7.017333333333331, 8.513666666666666, 7.2443333333333335, 10.243333333333332, 7.5603333333333325, 6.911333333333333, 13.48433333333333, 8.845999999999997, 8.630666666666666, 8.44733333333333, 7.949333333333332, 9.083666666666664, 8.395999999999997, 7.047333333333332, 8.266999999999998, 7.105333333333333, 6.710666666666667, 12.984333333333328, 10.645666666666664, 7.547333333333333, 10.800000000000002, 9.58433333333333, 9.567333333333334, 6.944666666666667, 7.487, 15.162666666666667, 12.241, 8.96733333333333, 8.14033333333333, 10.665333333333331, 12.275666666666666, 10.036333333333332, 7.4226666666666645, 9.289666666666665, 8.493333333333332, 6.490666666666668, 14.544666666666666, 12.517666666666665, 8.020333333333333, 8.954666666666663, 9.575, 8.643999999999998, 8.889333333333333, 9.967666666666668, 9.531666666666668, 8.392333333333331, 9.254333333333328, 8.537999999999997, 5.94, 6.090000000000001, 7.104666666666665, 8.470999999999997, 7.988666666666666, 7.828333333333333, 9.323666666666666, 8.581999999999997, 10.122333333333328, 8.761666666666665, 9.735999999999997, 9.406333333333333, 6.4206666666666665, 10.21733333333333, 7.295333333333335, 11.247999999999998, 10.859999999999998, 6.825999999999998, 10.345333333333329, 8.038666666666666, 7.698666666666665, 8.955, 7.717333333333331, 8.543, 6.957666666666666, 6.879666666666665, 10.260999999999996, 7.627333333333332, 11.442999999999996, 8.53533333333333, 7.021666666666665, 7.133666666666665, 7.098999999999999, 10.354666666666665, 9.268333333333333, 13.482666666666667, 8.221666666666666], "episode_lengths": [19, 25, 13, 15, 21, 25, 18, 13, 19, 19, 16, 29, 14, 16, 14, 17, 20, 17, 25, 16, 18, 27, 20, 19, 19, 19, 18, 18, 15, 16, 15, 14, 27, 22, 17, 25, 20, 21, 15, 17, 31, 25, 20, 19, 23, 24, 20, 15, 21, 19, 14, 25, 22, 19, 20, 21, 17, 18, 24, 24, 19, 22, 20, 14, 14, 17, 19, 16, 17, 19, 19, 25, 18, 20, 19, 14, 20, 17, 22, 20, 14, 21, 17, 15, 17, 17, 17, 15, 14, 23, 17, 21, 19, 16, 15, 15, 21, 18, 28, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.569652209341724, "mean_inference_ms": 2.8706251366968365, "mean_action_processing_ms": 0.5816763213792673, "mean_env_wait_ms": 0.1414470622683771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029511213302612305, "StateBufferConnector_ms": 0.022229909896850586, "ViewRequirementAgentConnector_ms": 0.47272539138793945}}, "episode_reward_max": 15.162666666666667, "episode_reward_min": 5.667333333333334, "episode_reward_mean": 8.902663333333331, "episode_len_mean": 19.02, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.42933333333333, 11.89633333333333, 6.2589999999999995, 6.961, 10.125333333333332, 13.019666666666666, 8.438666666666666, 5.667333333333334, 9.387999999999998, 7.757333333333333, 7.402666666666666, 13.233, 6.570333333333333, 7.810666666666667, 6.468666666666667, 7.017333333333331, 8.513666666666666, 7.2443333333333335, 10.243333333333332, 7.5603333333333325, 6.911333333333333, 13.48433333333333, 8.845999999999997, 8.630666666666666, 8.44733333333333, 7.949333333333332, 9.083666666666664, 8.395999999999997, 7.047333333333332, 8.266999999999998, 7.105333333333333, 6.710666666666667, 12.984333333333328, 10.645666666666664, 7.547333333333333, 10.800000000000002, 9.58433333333333, 9.567333333333334, 6.944666666666667, 7.487, 15.162666666666667, 12.241, 8.96733333333333, 8.14033333333333, 10.665333333333331, 12.275666666666666, 10.036333333333332, 7.4226666666666645, 9.289666666666665, 8.493333333333332, 6.490666666666668, 14.544666666666666, 12.517666666666665, 8.020333333333333, 8.954666666666663, 9.575, 8.643999999999998, 8.889333333333333, 9.967666666666668, 9.531666666666668, 8.392333333333331, 9.254333333333328, 8.537999999999997, 5.94, 6.090000000000001, 7.104666666666665, 8.470999999999997, 7.988666666666666, 7.828333333333333, 9.323666666666666, 8.581999999999997, 10.122333333333328, 8.761666666666665, 9.735999999999997, 9.406333333333333, 6.4206666666666665, 10.21733333333333, 7.295333333333335, 11.247999999999998, 10.859999999999998, 6.825999999999998, 10.345333333333329, 8.038666666666666, 7.698666666666665, 8.955, 7.717333333333331, 8.543, 6.957666666666666, 6.879666666666665, 10.260999999999996, 7.627333333333332, 11.442999999999996, 8.53533333333333, 7.021666666666665, 7.133666666666665, 7.098999999999999, 10.354666666666665, 9.268333333333333, 13.482666666666667, 8.221666666666666], "episode_lengths": [19, 25, 13, 15, 21, 25, 18, 13, 19, 19, 16, 29, 14, 16, 14, 17, 20, 17, 25, 16, 18, 27, 20, 19, 19, 19, 18, 18, 15, 16, 15, 14, 27, 22, 17, 25, 20, 21, 15, 17, 31, 25, 20, 19, 23, 24, 20, 15, 21, 19, 14, 25, 22, 19, 20, 21, 17, 18, 24, 24, 19, 22, 20, 14, 14, 17, 19, 16, 17, 19, 19, 25, 18, 20, 19, 14, 20, 17, 22, 20, 14, 21, 17, 15, 17, 17, 17, 15, 14, 23, 17, 21, 19, 16, 15, 15, 21, 18, 28, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.569652209341724, "mean_inference_ms": 2.8706251366968365, "mean_action_processing_ms": 0.5816763213792673, "mean_env_wait_ms": 0.1414470622683771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029511213302612305, "StateBufferConnector_ms": 0.022229909896850586, "ViewRequirementAgentConnector_ms": 0.47272539138793945}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30800, "num_agent_steps_trained": 30800, "num_env_steps_sampled": 30800, "num_env_steps_trained": 30800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1269.4868956100202, "num_env_steps_trained_throughput_per_sec": 1269.4868956100202, "timesteps_total": 30800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 30800, "timers": {"training_iteration_time_ms": 1287.102, "sample_time_ms": 1252.553, "load_time_ms": 0.673, "load_throughput": 2078887.488, "learn_time_ms": 12.809, "learn_throughput": 109295.993, "synch_weights_time_ms": 20.746}, "counters": {"num_env_steps_sampled": 30800, "num_env_steps_trained": 30800, "num_agent_steps_sampled": 30800, "num_agent_steps_trained": 30800}, "done": false, "episodes_total": 1631, "training_iteration": 22, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-20", "timestamp": 1702021160, "time_this_iter_s": 1.1267685890197754, "time_total_s": 25.37034559249878, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.37034559249878, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 95.85, "ram_util_percent": 97.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0982342958450317, "total_loss": 1.0982342958450317, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 32200, "num_env_steps_trained": 32200, "num_agent_steps_sampled": 32200, "num_agent_steps_trained": 32200}, "sampler_results": {"episode_reward_max": 13.482666666666667, "episode_reward_min": 6.2396666666666665, "episode_reward_mean": 8.895933333333334, "episode_len_mean": 18.64, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.406333333333333, 6.4206666666666665, 10.21733333333333, 7.295333333333335, 11.247999999999998, 10.859999999999998, 6.825999999999998, 10.345333333333329, 8.038666666666666, 7.698666666666665, 8.955, 7.717333333333331, 8.543, 6.957666666666666, 6.879666666666665, 10.260999999999996, 7.627333333333332, 11.442999999999996, 8.53533333333333, 7.021666666666665, 7.133666666666665, 7.098999999999999, 10.354666666666665, 9.268333333333333, 13.482666666666667, 8.221666666666666, 8.697, 12.095, 8.591666666666663, 9.321666666666664, 9.483333333333336, 7.308666666666668, 8.367333333333333, 9.223333333333333, 9.180333333333332, 8.231, 9.052999999999999, 7.552333333333331, 8.668333333333333, 8.313666666666666, 7.297999999999999, 8.561, 8.665333333333331, 6.328666666666667, 9.191666666666665, 8.489333333333331, 9.145999999999999, 9.086666666666666, 9.180333333333332, 7.153, 10.165666666666667, 8.81733333333333, 8.106666666666666, 7.922000000000001, 12.52866666666667, 10.249666666666663, 10.331999999999997, 8.905666666666665, 6.746666666666665, 7.324333333333333, 9.83433333333333, 8.488666666666667, 7.805, 7.797333333333333, 10.319666666666665, 7.663999999999999, 9.696, 6.543333333333333, 8.240333333333332, 8.299999999999997, 6.434666666666666, 9.472333333333333, 10.89033333333333, 9.53433333333333, 8.954666666666665, 8.026, 9.769666666666664, 10.470333333333333, 10.769999999999998, 8.87, 9.570333333333329, 7.8859999999999975, 8.241666666666667, 11.816333333333333, 6.2396666666666665, 8.505333333333331, 8.710333333333335, 12.03, 10.263666666666666, 6.9559999999999995, 9.903666666666666, 9.415333333333333, 8.233, 8.45633333333333, 10.86266666666666, 11.530666666666667, 9.900333333333334, 9.321666666666665, 7.809333333333331, 9.917333333333334], "episode_lengths": [19, 14, 20, 17, 22, 20, 14, 21, 17, 15, 17, 17, 17, 15, 14, 23, 17, 21, 19, 16, 15, 15, 21, 18, 28, 17, 18, 24, 19, 21, 19, 15, 16, 18, 18, 19, 22, 16, 17, 16, 16, 19, 17, 14, 23, 17, 21, 21, 20, 15, 21, 18, 16, 16, 24, 23, 23, 19, 14, 17, 20, 19, 18, 18, 21, 17, 21, 15, 17, 18, 13, 21, 23, 20, 18, 18, 20, 22, 22, 20, 22, 16, 16, 21, 13, 17, 18, 26, 22, 15, 19, 20, 16, 17, 22, 27, 19, 19, 17, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5787255176075439, "mean_inference_ms": 2.880559568819931, "mean_action_processing_ms": 0.5840461895461344, "mean_env_wait_ms": 0.1413722485353839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03794503211975098, "StateBufferConnector_ms": 0.019338130950927734, "ViewRequirementAgentConnector_ms": 0.5802183151245117}}, "episode_reward_max": 13.482666666666667, "episode_reward_min": 6.2396666666666665, "episode_reward_mean": 8.895933333333334, "episode_len_mean": 18.64, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.406333333333333, 6.4206666666666665, 10.21733333333333, 7.295333333333335, 11.247999999999998, 10.859999999999998, 6.825999999999998, 10.345333333333329, 8.038666666666666, 7.698666666666665, 8.955, 7.717333333333331, 8.543, 6.957666666666666, 6.879666666666665, 10.260999999999996, 7.627333333333332, 11.442999999999996, 8.53533333333333, 7.021666666666665, 7.133666666666665, 7.098999999999999, 10.354666666666665, 9.268333333333333, 13.482666666666667, 8.221666666666666, 8.697, 12.095, 8.591666666666663, 9.321666666666664, 9.483333333333336, 7.308666666666668, 8.367333333333333, 9.223333333333333, 9.180333333333332, 8.231, 9.052999999999999, 7.552333333333331, 8.668333333333333, 8.313666666666666, 7.297999999999999, 8.561, 8.665333333333331, 6.328666666666667, 9.191666666666665, 8.489333333333331, 9.145999999999999, 9.086666666666666, 9.180333333333332, 7.153, 10.165666666666667, 8.81733333333333, 8.106666666666666, 7.922000000000001, 12.52866666666667, 10.249666666666663, 10.331999999999997, 8.905666666666665, 6.746666666666665, 7.324333333333333, 9.83433333333333, 8.488666666666667, 7.805, 7.797333333333333, 10.319666666666665, 7.663999999999999, 9.696, 6.543333333333333, 8.240333333333332, 8.299999999999997, 6.434666666666666, 9.472333333333333, 10.89033333333333, 9.53433333333333, 8.954666666666665, 8.026, 9.769666666666664, 10.470333333333333, 10.769999999999998, 8.87, 9.570333333333329, 7.8859999999999975, 8.241666666666667, 11.816333333333333, 6.2396666666666665, 8.505333333333331, 8.710333333333335, 12.03, 10.263666666666666, 6.9559999999999995, 9.903666666666666, 9.415333333333333, 8.233, 8.45633333333333, 10.86266666666666, 11.530666666666667, 9.900333333333334, 9.321666666666665, 7.809333333333331, 9.917333333333334], "episode_lengths": [19, 14, 20, 17, 22, 20, 14, 21, 17, 15, 17, 17, 17, 15, 14, 23, 17, 21, 19, 16, 15, 15, 21, 18, 28, 17, 18, 24, 19, 21, 19, 15, 16, 18, 18, 19, 22, 16, 17, 16, 16, 19, 17, 14, 23, 17, 21, 21, 20, 15, 21, 18, 16, 16, 24, 23, 23, 19, 14, 17, 20, 19, 18, 18, 21, 17, 21, 15, 17, 18, 13, 21, 23, 20, 18, 18, 20, 22, 22, 20, 22, 16, 16, 21, 13, 17, 18, 26, 22, 15, 19, 20, 16, 17, 22, 27, 19, 19, 17, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5787255176075439, "mean_inference_ms": 2.880559568819931, "mean_action_processing_ms": 0.5840461895461344, "mean_env_wait_ms": 0.1413722485353839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03794503211975098, "StateBufferConnector_ms": 0.019338130950927734, "ViewRequirementAgentConnector_ms": 0.5802183151245117}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32200, "num_agent_steps_trained": 32200, "num_env_steps_sampled": 32200, "num_env_steps_trained": 32200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1102.4712935337675, "num_env_steps_trained_throughput_per_sec": 1102.4712935337675, "timesteps_total": 32200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 32200, "timers": {"training_iteration_time_ms": 1323.758, "sample_time_ms": 1288.361, "load_time_ms": 0.574, "load_throughput": 2440981.709, "learn_time_ms": 13.383, "learn_throughput": 104612.508, "synch_weights_time_ms": 21.12}, "counters": {"num_env_steps_sampled": 32200, "num_env_steps_trained": 32200, "num_agent_steps_sampled": 32200, "num_agent_steps_trained": 32200}, "done": false, "episodes_total": 1705, "training_iteration": 23, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-22", "timestamp": 1702021162, "time_this_iter_s": 1.2957003116607666, "time_total_s": 26.666045904159546, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 26.666045904159546, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 93.1, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0970808267593384, "total_loss": 1.0970808267593384, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": 14.751666666666665, "episode_reward_min": 5.836666666666666, "episode_reward_mean": 8.880483333333332, "episode_len_mean": 18.86, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.470333333333333, 10.769999999999998, 8.87, 9.570333333333329, 7.8859999999999975, 8.241666666666667, 11.816333333333333, 6.2396666666666665, 8.505333333333331, 8.710333333333335, 12.03, 10.263666666666666, 6.9559999999999995, 9.903666666666666, 9.415333333333333, 8.233, 8.45633333333333, 10.86266666666666, 11.530666666666667, 9.900333333333334, 9.321666666666665, 7.809333333333331, 9.917333333333334, 12.100666666666667, 7.179666666666665, 6.186333333333333, 7.317666666666666, 7.337333333333332, 8.474, 8.754999999999999, 7.416666666666666, 8.155999999999999, 9.096333333333332, 9.030333333333333, 10.919333333333332, 8.274333333333333, 10.656666666666665, 8.676999999999998, 6.627333333333332, 9.639999999999997, 7.330999999999999, 11.331999999999999, 7.269666666666664, 7.778333333333332, 9.342999999999998, 7.613999999999999, 6.500333333333332, 7.444333333333332, 9.140666666666663, 7.821999999999997, 11.327999999999998, 7.732333333333333, 8.328333333333333, 11.607999999999997, 10.833333333333334, 6.228999999999999, 8.125333333333334, 7.494666666666665, 8.814, 11.128999999999998, 10.05733333333333, 9.591666666666661, 13.65666666666666, 8.336666666666664, 9.775333333333332, 7.705, 9.957333333333331, 8.064, 8.974666666666666, 8.923666666666666, 7.456333333333332, 8.535999999999998, 7.487333333333331, 7.046333333333332, 10.216999999999997, 8.559333333333335, 6.558333333333334, 9.009666666666664, 8.409999999999998, 8.802999999999997, 7.077999999999999, 10.433666666666666, 8.550999999999998, 7.155666666666667, 8.605666666666668, 8.362666666666666, 9.303666666666665, 9.991999999999997, 8.243666666666664, 7.613, 6.4206666666666665, 10.210999999999997, 9.461666666666666, 14.751666666666665, 10.377999999999997, 10.954666666666665, 9.238666666666665, 5.836666666666666, 7.366, 6.242666666666667], "episode_lengths": [22, 22, 20, 22, 16, 16, 21, 13, 17, 18, 26, 22, 15, 19, 20, 16, 17, 22, 27, 19, 19, 17, 20, 25, 15, 13, 16, 18, 17, 17, 18, 17, 19, 18, 25, 19, 21, 17, 16, 19, 16, 26, 15, 16, 19, 16, 15, 16, 20, 16, 22, 17, 19, 24, 24, 14, 15, 17, 18, 21, 21, 21, 27, 20, 21, 16, 22, 16, 20, 19, 17, 18, 15, 17, 22, 18, 15, 19, 19, 18, 16, 23, 20, 16, 18, 18, 19, 22, 18, 17, 15, 21, 20, 31, 21, 23, 20, 14, 16, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5804196512779918, "mean_inference_ms": 2.888456297708325, "mean_action_processing_ms": 0.5853920234639944, "mean_env_wait_ms": 0.14149022661825877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022975683212280273, "StateBufferConnector_ms": 0.016153335571289062, "ViewRequirementAgentConnector_ms": 0.549760103225708}}, "episode_reward_max": 14.751666666666665, "episode_reward_min": 5.836666666666666, "episode_reward_mean": 8.880483333333332, "episode_len_mean": 18.86, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.470333333333333, 10.769999999999998, 8.87, 9.570333333333329, 7.8859999999999975, 8.241666666666667, 11.816333333333333, 6.2396666666666665, 8.505333333333331, 8.710333333333335, 12.03, 10.263666666666666, 6.9559999999999995, 9.903666666666666, 9.415333333333333, 8.233, 8.45633333333333, 10.86266666666666, 11.530666666666667, 9.900333333333334, 9.321666666666665, 7.809333333333331, 9.917333333333334, 12.100666666666667, 7.179666666666665, 6.186333333333333, 7.317666666666666, 7.337333333333332, 8.474, 8.754999999999999, 7.416666666666666, 8.155999999999999, 9.096333333333332, 9.030333333333333, 10.919333333333332, 8.274333333333333, 10.656666666666665, 8.676999999999998, 6.627333333333332, 9.639999999999997, 7.330999999999999, 11.331999999999999, 7.269666666666664, 7.778333333333332, 9.342999999999998, 7.613999999999999, 6.500333333333332, 7.444333333333332, 9.140666666666663, 7.821999999999997, 11.327999999999998, 7.732333333333333, 8.328333333333333, 11.607999999999997, 10.833333333333334, 6.228999999999999, 8.125333333333334, 7.494666666666665, 8.814, 11.128999999999998, 10.05733333333333, 9.591666666666661, 13.65666666666666, 8.336666666666664, 9.775333333333332, 7.705, 9.957333333333331, 8.064, 8.974666666666666, 8.923666666666666, 7.456333333333332, 8.535999999999998, 7.487333333333331, 7.046333333333332, 10.216999999999997, 8.559333333333335, 6.558333333333334, 9.009666666666664, 8.409999999999998, 8.802999999999997, 7.077999999999999, 10.433666666666666, 8.550999999999998, 7.155666666666667, 8.605666666666668, 8.362666666666666, 9.303666666666665, 9.991999999999997, 8.243666666666664, 7.613, 6.4206666666666665, 10.210999999999997, 9.461666666666666, 14.751666666666665, 10.377999999999997, 10.954666666666665, 9.238666666666665, 5.836666666666666, 7.366, 6.242666666666667], "episode_lengths": [22, 22, 20, 22, 16, 16, 21, 13, 17, 18, 26, 22, 15, 19, 20, 16, 17, 22, 27, 19, 19, 17, 20, 25, 15, 13, 16, 18, 17, 17, 18, 17, 19, 18, 25, 19, 21, 17, 16, 19, 16, 26, 15, 16, 19, 16, 15, 16, 20, 16, 22, 17, 19, 24, 24, 14, 15, 17, 18, 21, 21, 21, 27, 20, 21, 16, 22, 16, 20, 19, 17, 18, 15, 17, 22, 18, 15, 19, 19, 18, 16, 23, 20, 16, 18, 18, 19, 22, 18, 17, 15, 21, 20, 31, 21, 23, 20, 14, 16, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5804196512779918, "mean_inference_ms": 2.888456297708325, "mean_action_processing_ms": 0.5853920234639944, "mean_env_wait_ms": 0.14149022661825877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022975683212280273, "StateBufferConnector_ms": 0.016153335571289062, "ViewRequirementAgentConnector_ms": 0.549760103225708}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1222.7494542733887, "num_env_steps_trained_throughput_per_sec": 1222.7494542733887, "timesteps_total": 33600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1345.195, "sample_time_ms": 1309.686, "load_time_ms": 0.546, "load_throughput": 2563755.501, "learn_time_ms": 13.522, "learn_throughput": 103533.116, "synch_weights_time_ms": 21.22}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 1782, "training_iteration": 24, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-23", "timestamp": 1702021163, "time_this_iter_s": 1.1609561443328857, "time_total_s": 27.82700204849243, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.82700204849243, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 96.9, "ram_util_percent": 96.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0970067977905273, "total_loss": 1.0970067977905273, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 35000}, "sampler_results": {"episode_reward_max": 14.751666666666665, "episode_reward_min": 5.756666666666666, "episode_reward_mean": 8.79194, "episode_len_mean": 18.88, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.487333333333331, 7.046333333333332, 10.216999999999997, 8.559333333333335, 6.558333333333334, 9.009666666666664, 8.409999999999998, 8.802999999999997, 7.077999999999999, 10.433666666666666, 8.550999999999998, 7.155666666666667, 8.605666666666668, 8.362666666666666, 9.303666666666665, 9.991999999999997, 8.243666666666664, 7.613, 6.4206666666666665, 10.210999999999997, 9.461666666666666, 14.751666666666665, 10.377999999999997, 10.954666666666665, 9.238666666666665, 5.836666666666666, 7.366, 6.242666666666667, 6.546999999999999, 6.810999999999998, 7.092999999999999, 8.546999999999999, 5.756666666666666, 9.36, 9.15533333333333, 7.711999999999999, 7.575333333333331, 10.586, 8.392333333333333, 7.141333333333334, 9.641666666666664, 8.495333333333331, 11.474333333333332, 9.91133333333333, 9.810666666666666, 7.55133333333333, 8.814666666666668, 6.675666666666666, 7.615333333333332, 10.222999999999999, 8.774666666666665, 9.959666666666672, 7.360999999999997, 9.927666666666667, 7.960333333333333, 6.597, 10.090666666666666, 9.645666666666667, 8.331666666666665, 10.652999999999999, 8.986999999999998, 11.295333333333334, 7.4626666666666654, 10.456666666666665, 8.653333333333332, 10.124999999999996, 7.696333333333333, 9.242333333333333, 7.062333333333334, 9.887666666666668, 7.041999999999998, 8.809000000000001, 9.442666666666666, 8.614999999999998, 7.524666666666665, 6.843666666666666, 9.079999999999998, 7.067333333333332, 11.884333333333334, 9.586666666666666, 7.983999999999999, 6.585666666666666, 9.608, 9.466666666666665, 8.171, 10.345999999999998, 9.712999999999997, 9.994666666666665, 12.036333333333333, 11.327666666666666, 13.533333333333333, 7.222666666666668, 9.725000000000001, 8.152666666666667, 9.515666666666668, 7.104, 8.379999999999999, 10.101666666666665, 6.233999999999998, 10.744666666666665], "episode_lengths": [15, 17, 22, 18, 15, 19, 19, 18, 16, 23, 20, 16, 18, 18, 19, 22, 18, 17, 15, 21, 20, 31, 21, 23, 20, 14, 16, 15, 14, 15, 16, 18, 14, 21, 19, 15, 16, 20, 19, 15, 20, 18, 25, 21, 21, 17, 17, 15, 17, 25, 19, 21, 17, 22, 17, 15, 21, 19, 17, 23, 18, 23, 16, 21, 19, 23, 17, 20, 16, 20, 15, 18, 19, 20, 16, 18, 18, 15, 24, 24, 16, 15, 21, 19, 18, 24, 21, 22, 23, 21, 30, 15, 21, 17, 20, 17, 18, 21, 14, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5736421256964932, "mean_inference_ms": 2.866148292729305, "mean_action_processing_ms": 0.5824056060271126, "mean_env_wait_ms": 0.14166608333710162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026052236557006836, "StateBufferConnector_ms": 0.012071371078491211, "ViewRequirementAgentConnector_ms": 0.45427846908569336}}, "episode_reward_max": 14.751666666666665, "episode_reward_min": 5.756666666666666, "episode_reward_mean": 8.79194, "episode_len_mean": 18.88, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.487333333333331, 7.046333333333332, 10.216999999999997, 8.559333333333335, 6.558333333333334, 9.009666666666664, 8.409999999999998, 8.802999999999997, 7.077999999999999, 10.433666666666666, 8.550999999999998, 7.155666666666667, 8.605666666666668, 8.362666666666666, 9.303666666666665, 9.991999999999997, 8.243666666666664, 7.613, 6.4206666666666665, 10.210999999999997, 9.461666666666666, 14.751666666666665, 10.377999999999997, 10.954666666666665, 9.238666666666665, 5.836666666666666, 7.366, 6.242666666666667, 6.546999999999999, 6.810999999999998, 7.092999999999999, 8.546999999999999, 5.756666666666666, 9.36, 9.15533333333333, 7.711999999999999, 7.575333333333331, 10.586, 8.392333333333333, 7.141333333333334, 9.641666666666664, 8.495333333333331, 11.474333333333332, 9.91133333333333, 9.810666666666666, 7.55133333333333, 8.814666666666668, 6.675666666666666, 7.615333333333332, 10.222999999999999, 8.774666666666665, 9.959666666666672, 7.360999999999997, 9.927666666666667, 7.960333333333333, 6.597, 10.090666666666666, 9.645666666666667, 8.331666666666665, 10.652999999999999, 8.986999999999998, 11.295333333333334, 7.4626666666666654, 10.456666666666665, 8.653333333333332, 10.124999999999996, 7.696333333333333, 9.242333333333333, 7.062333333333334, 9.887666666666668, 7.041999999999998, 8.809000000000001, 9.442666666666666, 8.614999999999998, 7.524666666666665, 6.843666666666666, 9.079999999999998, 7.067333333333332, 11.884333333333334, 9.586666666666666, 7.983999999999999, 6.585666666666666, 9.608, 9.466666666666665, 8.171, 10.345999999999998, 9.712999999999997, 9.994666666666665, 12.036333333333333, 11.327666666666666, 13.533333333333333, 7.222666666666668, 9.725000000000001, 8.152666666666667, 9.515666666666668, 7.104, 8.379999999999999, 10.101666666666665, 6.233999999999998, 10.744666666666665], "episode_lengths": [15, 17, 22, 18, 15, 19, 19, 18, 16, 23, 20, 16, 18, 18, 19, 22, 18, 17, 15, 21, 20, 31, 21, 23, 20, 14, 16, 15, 14, 15, 16, 18, 14, 21, 19, 15, 16, 20, 19, 15, 20, 18, 25, 21, 21, 17, 17, 15, 17, 25, 19, 21, 17, 22, 17, 15, 21, 19, 17, 23, 18, 23, 16, 21, 19, 23, 17, 20, 16, 20, 15, 18, 19, 20, 16, 18, 18, 15, 24, 24, 16, 15, 21, 19, 18, 24, 21, 22, 23, 21, 30, 15, 21, 17, 20, 17, 18, 21, 14, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5736421256964932, "mean_inference_ms": 2.866148292729305, "mean_action_processing_ms": 0.5824056060271126, "mean_env_wait_ms": 0.14166608333710162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026052236557006836, "StateBufferConnector_ms": 0.012071371078491211, "ViewRequirementAgentConnector_ms": 0.45427846908569336}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 35000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1577.6282965960506, "num_env_steps_trained_throughput_per_sec": 1577.6282965960506, "timesteps_total": 35000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 1295.235, "sample_time_ms": 1259.617, "load_time_ms": 0.645, "load_throughput": 2172169.423, "learn_time_ms": 13.458, "learn_throughput": 104028.53, "synch_weights_time_ms": 21.22}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 35000}, "done": false, "episodes_total": 1854, "training_iteration": 25, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-24", "timestamp": 1702021164, "time_this_iter_s": 0.9046671390533447, "time_total_s": 28.731669187545776, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 28.731669187545776, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 90.6, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.1000945568084717, "total_loss": 1.1000945568084717, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 36400, "num_env_steps_trained": 36400, "num_agent_steps_sampled": 36400, "num_agent_steps_trained": 36400}, "sampler_results": {"episode_reward_max": 13.533333333333333, "episode_reward_min": 5.960333333333333, "episode_reward_mean": 8.716469999999997, "episode_len_mean": 18.68, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.079999999999998, 7.067333333333332, 11.884333333333334, 9.586666666666666, 7.983999999999999, 6.585666666666666, 9.608, 9.466666666666665, 8.171, 10.345999999999998, 9.712999999999997, 9.994666666666665, 12.036333333333333, 11.327666666666666, 13.533333333333333, 7.222666666666668, 9.725000000000001, 8.152666666666667, 9.515666666666668, 7.104, 8.379999999999999, 10.101666666666665, 6.233999999999998, 10.744666666666665, 7.971666666666664, 8.812333333333333, 9.024333333333331, 10.658666666666665, 8.912333333333333, 8.459666666666665, 7.406999999999999, 8.991666666666667, 7.263333333333332, 7.860666666666665, 8.857666666666663, 11.732666666666663, 7.6433333333333335, 8.963999999999999, 6.661333333333333, 9.844, 10.504666666666663, 9.076333333333332, 9.345999999999998, 7.646333333333334, 10.936999999999996, 6.985333333333332, 13.159333333333333, 7.806666666666667, 10.087666666666667, 8.767666666666663, 8.924999999999999, 8.428333333333333, 9.573333333333332, 10.026666666666662, 9.134999999999998, 6.794, 7.413333333333332, 8.374000000000002, 7.459333333333333, 9.546999999999995, 8.104666666666665, 7.946999999999999, 8.770333333333337, 9.036333333333333, 8.957333333333331, 8.616666666666664, 6.271666666666666, 9.890999999999998, 7.591666666666667, 10.314999999999998, 6.9353333333333325, 9.381666666666666, 10.649999999999997, 11.443333333333335, 8.598333333333333, 8.360666666666665, 8.557999999999998, 7.937999999999999, 8.444999999999999, 7.872666666666667, 7.710333333333334, 7.4736666666666665, 6.664999999999999, 6.250999999999999, 9.783999999999999, 9.538999999999998, 9.555666666666667, 7.977, 5.960333333333333, 8.968000000000002, 8.059666666666665, 7.9723333333333315, 7.366666666666665, 8.347666666666667, 8.333333333333332, 6.347333333333332, 6.995333333333332, 6.605999999999998, 8.548333333333332, 6.879], "episode_lengths": [18, 15, 24, 24, 16, 15, 21, 19, 18, 24, 21, 22, 23, 21, 30, 15, 21, 17, 20, 17, 18, 21, 14, 20, 17, 20, 18, 23, 21, 19, 16, 17, 18, 16, 18, 23, 15, 20, 14, 22, 23, 19, 20, 16, 27, 15, 27, 18, 20, 19, 19, 18, 19, 20, 19, 14, 18, 17, 16, 20, 18, 19, 19, 18, 21, 17, 15, 20, 15, 23, 14, 20, 23, 24, 20, 16, 18, 17, 17, 16, 17, 15, 15, 14, 20, 21, 21, 18, 13, 22, 17, 19, 18, 16, 17, 16, 15, 15, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5717748252835941, "mean_inference_ms": 2.863006890792178, "mean_action_processing_ms": 0.5840372121006598, "mean_env_wait_ms": 0.14147241660217752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041507720947265625, "StateBufferConnector_ms": 0.020644426345825195, "ViewRequirementAgentConnector_ms": 0.4867854118347168}}, "episode_reward_max": 13.533333333333333, "episode_reward_min": 5.960333333333333, "episode_reward_mean": 8.716469999999997, "episode_len_mean": 18.68, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.079999999999998, 7.067333333333332, 11.884333333333334, 9.586666666666666, 7.983999999999999, 6.585666666666666, 9.608, 9.466666666666665, 8.171, 10.345999999999998, 9.712999999999997, 9.994666666666665, 12.036333333333333, 11.327666666666666, 13.533333333333333, 7.222666666666668, 9.725000000000001, 8.152666666666667, 9.515666666666668, 7.104, 8.379999999999999, 10.101666666666665, 6.233999999999998, 10.744666666666665, 7.971666666666664, 8.812333333333333, 9.024333333333331, 10.658666666666665, 8.912333333333333, 8.459666666666665, 7.406999999999999, 8.991666666666667, 7.263333333333332, 7.860666666666665, 8.857666666666663, 11.732666666666663, 7.6433333333333335, 8.963999999999999, 6.661333333333333, 9.844, 10.504666666666663, 9.076333333333332, 9.345999999999998, 7.646333333333334, 10.936999999999996, 6.985333333333332, 13.159333333333333, 7.806666666666667, 10.087666666666667, 8.767666666666663, 8.924999999999999, 8.428333333333333, 9.573333333333332, 10.026666666666662, 9.134999999999998, 6.794, 7.413333333333332, 8.374000000000002, 7.459333333333333, 9.546999999999995, 8.104666666666665, 7.946999999999999, 8.770333333333337, 9.036333333333333, 8.957333333333331, 8.616666666666664, 6.271666666666666, 9.890999999999998, 7.591666666666667, 10.314999999999998, 6.9353333333333325, 9.381666666666666, 10.649999999999997, 11.443333333333335, 8.598333333333333, 8.360666666666665, 8.557999999999998, 7.937999999999999, 8.444999999999999, 7.872666666666667, 7.710333333333334, 7.4736666666666665, 6.664999999999999, 6.250999999999999, 9.783999999999999, 9.538999999999998, 9.555666666666667, 7.977, 5.960333333333333, 8.968000000000002, 8.059666666666665, 7.9723333333333315, 7.366666666666665, 8.347666666666667, 8.333333333333332, 6.347333333333332, 6.995333333333332, 6.605999999999998, 8.548333333333332, 6.879], "episode_lengths": [18, 15, 24, 24, 16, 15, 21, 19, 18, 24, 21, 22, 23, 21, 30, 15, 21, 17, 20, 17, 18, 21, 14, 20, 17, 20, 18, 23, 21, 19, 16, 17, 18, 16, 18, 23, 15, 20, 14, 22, 23, 19, 20, 16, 27, 15, 27, 18, 20, 19, 19, 18, 19, 20, 19, 14, 18, 17, 16, 20, 18, 19, 19, 18, 21, 17, 15, 20, 15, 23, 14, 20, 23, 24, 20, 16, 18, 17, 17, 16, 17, 15, 15, 14, 20, 21, 21, 18, 13, 22, 17, 19, 18, 16, 17, 16, 15, 15, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5717748252835941, "mean_inference_ms": 2.863006890792178, "mean_action_processing_ms": 0.5840372121006598, "mean_env_wait_ms": 0.14147241660217752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041507720947265625, "StateBufferConnector_ms": 0.020644426345825195, "ViewRequirementAgentConnector_ms": 0.4867854118347168}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36400, "num_agent_steps_trained": 36400, "num_env_steps_sampled": 36400, "num_env_steps_trained": 36400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1129.477443922132, "num_env_steps_trained_throughput_per_sec": 1129.477443922132, "timesteps_total": 36400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 36400, "timers": {"training_iteration_time_ms": 1315.923, "sample_time_ms": 1279.192, "load_time_ms": 0.577, "load_throughput": 2427961.795, "learn_time_ms": 14.065, "learn_throughput": 99540.873, "synch_weights_time_ms": 21.795}, "counters": {"num_env_steps_sampled": 36400, "num_env_steps_trained": 36400, "num_agent_steps_sampled": 36400, "num_agent_steps_trained": 36400}, "done": false, "episodes_total": 1930, "training_iteration": 26, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-25", "timestamp": 1702021165, "time_this_iter_s": 1.2644214630126953, "time_total_s": 29.99609065055847, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.99609065055847, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 96.2, "ram_util_percent": 97.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0968552827835083, "total_loss": 1.0968552827835083, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 37800, "num_env_steps_trained": 37800, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37800}, "sampler_results": {"episode_reward_max": 13.067, "episode_reward_min": 5.960333333333333, "episode_reward_mean": 8.658506666666664, "episode_len_mean": 18.65, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.443333333333335, 8.598333333333333, 8.360666666666665, 8.557999999999998, 7.937999999999999, 8.444999999999999, 7.872666666666667, 7.710333333333334, 7.4736666666666665, 6.664999999999999, 6.250999999999999, 9.783999999999999, 9.538999999999998, 9.555666666666667, 7.977, 5.960333333333333, 8.968000000000002, 8.059666666666665, 7.9723333333333315, 7.366666666666665, 8.347666666666667, 8.333333333333332, 6.347333333333332, 6.995333333333332, 6.605999999999998, 8.548333333333332, 6.879, 7.463333333333331, 10.362333333333332, 9.241999999999999, 7.548333333333332, 7.6916666666666655, 11.237666666666668, 7.945999999999999, 8.372333333333332, 8.203999999999999, 8.462333333333333, 9.358, 8.553333333333335, 10.218000000000004, 9.157, 8.600333333333332, 10.433333333333334, 9.955333333333334, 6.6339999999999995, 9.727999999999998, 7.113333333333334, 8.679666666666664, 9.425666666666666, 8.972, 8.768666666666666, 13.067, 8.141000000000002, 6.4673333333333325, 8.532, 7.0009999999999994, 7.859666666666666, 8.974666666666668, 8.261333333333333, 9.473, 8.45033333333333, 8.393333333333333, 10.463666666666661, 9.496666666666666, 8.520666666666667, 7.212666666666666, 10.15933333333333, 8.062666666666665, 8.250666666666666, 8.021999999999998, 11.112666666666668, 8.304666666666664, 8.416333333333329, 7.369000000000001, 8.691333333333334, 7.428333333333331, 10.627666666666666, 11.290333333333333, 8.269333333333332, 8.128, 10.890333333333329, 9.040000000000001, 9.631666666666668, 8.271666666666665, 8.99933333333333, 12.946333333333333, 9.562999999999995, 8.882666666666667, 8.854333333333333, 10.229666666666665, 6.208666666666666, 9.931666666666668, 8.02, 10.028, 10.626666666666669, 10.605333333333329, 8.006999999999998, 7.600333333333333, 7.710333333333334, 6.674666666666666], "episode_lengths": [24, 20, 16, 18, 17, 17, 16, 17, 15, 15, 14, 20, 21, 21, 18, 13, 22, 17, 19, 18, 16, 17, 16, 15, 15, 19, 15, 16, 22, 20, 17, 15, 24, 18, 18, 18, 19, 20, 20, 21, 18, 19, 26, 19, 14, 19, 16, 19, 19, 17, 18, 29, 17, 14, 18, 15, 17, 19, 17, 19, 19, 19, 22, 20, 19, 17, 21, 20, 17, 17, 26, 17, 19, 16, 17, 18, 23, 23, 17, 18, 21, 21, 19, 18, 19, 26, 21, 20, 20, 23, 14, 23, 18, 20, 22, 21, 17, 17, 17, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5882410012693127, "mean_inference_ms": 2.8892367883448458, "mean_action_processing_ms": 0.5885882725528424, "mean_env_wait_ms": 0.14440791393374316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10727047920227051, "StateBufferConnector_ms": 0.025038480758666992, "ViewRequirementAgentConnector_ms": 0.571258544921875}}, "episode_reward_max": 13.067, "episode_reward_min": 5.960333333333333, "episode_reward_mean": 8.658506666666664, "episode_len_mean": 18.65, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.443333333333335, 8.598333333333333, 8.360666666666665, 8.557999999999998, 7.937999999999999, 8.444999999999999, 7.872666666666667, 7.710333333333334, 7.4736666666666665, 6.664999999999999, 6.250999999999999, 9.783999999999999, 9.538999999999998, 9.555666666666667, 7.977, 5.960333333333333, 8.968000000000002, 8.059666666666665, 7.9723333333333315, 7.366666666666665, 8.347666666666667, 8.333333333333332, 6.347333333333332, 6.995333333333332, 6.605999999999998, 8.548333333333332, 6.879, 7.463333333333331, 10.362333333333332, 9.241999999999999, 7.548333333333332, 7.6916666666666655, 11.237666666666668, 7.945999999999999, 8.372333333333332, 8.203999999999999, 8.462333333333333, 9.358, 8.553333333333335, 10.218000000000004, 9.157, 8.600333333333332, 10.433333333333334, 9.955333333333334, 6.6339999999999995, 9.727999999999998, 7.113333333333334, 8.679666666666664, 9.425666666666666, 8.972, 8.768666666666666, 13.067, 8.141000000000002, 6.4673333333333325, 8.532, 7.0009999999999994, 7.859666666666666, 8.974666666666668, 8.261333333333333, 9.473, 8.45033333333333, 8.393333333333333, 10.463666666666661, 9.496666666666666, 8.520666666666667, 7.212666666666666, 10.15933333333333, 8.062666666666665, 8.250666666666666, 8.021999999999998, 11.112666666666668, 8.304666666666664, 8.416333333333329, 7.369000000000001, 8.691333333333334, 7.428333333333331, 10.627666666666666, 11.290333333333333, 8.269333333333332, 8.128, 10.890333333333329, 9.040000000000001, 9.631666666666668, 8.271666666666665, 8.99933333333333, 12.946333333333333, 9.562999999999995, 8.882666666666667, 8.854333333333333, 10.229666666666665, 6.208666666666666, 9.931666666666668, 8.02, 10.028, 10.626666666666669, 10.605333333333329, 8.006999999999998, 7.600333333333333, 7.710333333333334, 6.674666666666666], "episode_lengths": [24, 20, 16, 18, 17, 17, 16, 17, 15, 15, 14, 20, 21, 21, 18, 13, 22, 17, 19, 18, 16, 17, 16, 15, 15, 19, 15, 16, 22, 20, 17, 15, 24, 18, 18, 18, 19, 20, 20, 21, 18, 19, 26, 19, 14, 19, 16, 19, 19, 17, 18, 29, 17, 14, 18, 15, 17, 19, 17, 19, 19, 19, 22, 20, 19, 17, 21, 20, 17, 17, 26, 17, 19, 16, 17, 18, 23, 23, 17, 18, 21, 21, 19, 18, 19, 26, 21, 20, 20, 23, 14, 23, 18, 20, 22, 21, 17, 17, 17, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5882410012693127, "mean_inference_ms": 2.8892367883448458, "mean_action_processing_ms": 0.5885882725528424, "mean_env_wait_ms": 0.14440791393374316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10727047920227051, "StateBufferConnector_ms": 0.025038480758666992, "ViewRequirementAgentConnector_ms": 0.571258544921875}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37800, "num_env_steps_sampled": 37800, "num_env_steps_trained": 37800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 945.417145786488, "num_env_steps_trained_throughput_per_sec": 945.417145786488, "timesteps_total": 37800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 37800, "timers": {"training_iteration_time_ms": 1282.361, "sample_time_ms": 1246.517, "load_time_ms": 0.577, "load_throughput": 2426055.859, "learn_time_ms": 13.601, "learn_throughput": 102936.366, "synch_weights_time_ms": 21.399}, "counters": {"num_env_steps_sampled": 37800, "num_env_steps_trained": 37800, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37800}, "done": false, "episodes_total": 2003, "training_iteration": 27, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-27", "timestamp": 1702021167, "time_this_iter_s": 1.5060393810272217, "time_total_s": 31.502130031585693, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.502130031585693, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.2, "ram_util_percent": 97.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0982143878936768, "total_loss": 1.0982143878936768, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 39200, "num_env_steps_trained": 39200, "num_agent_steps_sampled": 39200, "num_agent_steps_trained": 39200}, "sampler_results": {"episode_reward_max": 12.946333333333333, "episode_reward_min": 5.954666666666665, "episode_reward_mean": 8.784703333333333, "episode_len_mean": 18.66, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.290333333333333, 8.269333333333332, 8.128, 10.890333333333329, 9.040000000000001, 9.631666666666668, 8.271666666666665, 8.99933333333333, 12.946333333333333, 9.562999999999995, 8.882666666666667, 8.854333333333333, 10.229666666666665, 6.208666666666666, 9.931666666666668, 8.02, 10.028, 10.626666666666669, 10.605333333333329, 8.006999999999998, 7.600333333333333, 7.710333333333334, 6.674666666666666, 8.660333333333332, 8.758666666666665, 9.132333333333333, 7.570666666666666, 9.217666666666664, 6.461666666666666, 10.234333333333332, 7.673999999999999, 7.534666666666665, 9.661999999999999, 9.160999999999998, 9.138666666666667, 7.077333333333333, 8.488999999999999, 9.609, 7.928333333333332, 8.499333333333333, 10.094333333333331, 9.85333333333333, 11.390333333333334, 10.194333333333331, 8.847333333333331, 6.782333333333332, 6.629999999999999, 7.4243333333333315, 9.523333333333332, 9.721999999999996, 7.212333333333332, 7.991333333333333, 8.065333333333333, 9.077333333333334, 7.864999999999999, 10.169333333333332, 10.819333333333333, 8.964333333333332, 7.236333333333333, 8.843, 8.036999999999999, 11.72033333333333, 7.438666666666668, 7.599999999999999, 7.760999999999999, 9.709666666666669, 10.485666666666663, 8.435666666666664, 7.883999999999999, 6.756333333333331, 8.489666666666665, 11.29733333333333, 9.330666666666666, 7.3326666666666656, 7.4929999999999986, 9.520666666666667, 8.515, 8.793666666666667, 10.905666666666665, 7.485333333333332, 8.099666666666664, 8.203333333333333, 7.763333333333333, 8.293, 7.087999999999999, 9.622666666666666, 10.126333333333331, 10.474333333333332, 6.521999999999999, 9.170333333333332, 10.419999999999998, 8.884999999999998, 8.165333333333333, 11.43533333333333, 5.969333333333332, 7.870666666666667, 12.04, 7.265999999999999, 8.185333333333334, 5.954666666666665], "episode_lengths": [23, 17, 18, 21, 21, 19, 18, 19, 26, 21, 20, 20, 23, 14, 23, 18, 20, 22, 21, 17, 17, 17, 15, 18, 18, 19, 16, 21, 13, 21, 17, 16, 20, 19, 19, 16, 18, 20, 18, 18, 20, 20, 23, 21, 19, 15, 14, 17, 20, 19, 15, 17, 16, 18, 17, 26, 21, 21, 16, 17, 16, 25, 17, 17, 17, 20, 23, 19, 19, 14, 18, 21, 21, 16, 15, 20, 18, 19, 20, 15, 18, 18, 16, 16, 16, 22, 22, 23, 16, 20, 20, 19, 18, 24, 13, 16, 23, 16, 16, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5918409154115347, "mean_inference_ms": 2.8936911396463882, "mean_action_processing_ms": 0.5934159933441603, "mean_env_wait_ms": 0.1453866540179739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02109551429748535, "StateBufferConnector_ms": 0.016054630279541016, "ViewRequirementAgentConnector_ms": 0.5352728366851807}}, "episode_reward_max": 12.946333333333333, "episode_reward_min": 5.954666666666665, "episode_reward_mean": 8.784703333333333, "episode_len_mean": 18.66, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.290333333333333, 8.269333333333332, 8.128, 10.890333333333329, 9.040000000000001, 9.631666666666668, 8.271666666666665, 8.99933333333333, 12.946333333333333, 9.562999999999995, 8.882666666666667, 8.854333333333333, 10.229666666666665, 6.208666666666666, 9.931666666666668, 8.02, 10.028, 10.626666666666669, 10.605333333333329, 8.006999999999998, 7.600333333333333, 7.710333333333334, 6.674666666666666, 8.660333333333332, 8.758666666666665, 9.132333333333333, 7.570666666666666, 9.217666666666664, 6.461666666666666, 10.234333333333332, 7.673999999999999, 7.534666666666665, 9.661999999999999, 9.160999999999998, 9.138666666666667, 7.077333333333333, 8.488999999999999, 9.609, 7.928333333333332, 8.499333333333333, 10.094333333333331, 9.85333333333333, 11.390333333333334, 10.194333333333331, 8.847333333333331, 6.782333333333332, 6.629999999999999, 7.4243333333333315, 9.523333333333332, 9.721999999999996, 7.212333333333332, 7.991333333333333, 8.065333333333333, 9.077333333333334, 7.864999999999999, 10.169333333333332, 10.819333333333333, 8.964333333333332, 7.236333333333333, 8.843, 8.036999999999999, 11.72033333333333, 7.438666666666668, 7.599999999999999, 7.760999999999999, 9.709666666666669, 10.485666666666663, 8.435666666666664, 7.883999999999999, 6.756333333333331, 8.489666666666665, 11.29733333333333, 9.330666666666666, 7.3326666666666656, 7.4929999999999986, 9.520666666666667, 8.515, 8.793666666666667, 10.905666666666665, 7.485333333333332, 8.099666666666664, 8.203333333333333, 7.763333333333333, 8.293, 7.087999999999999, 9.622666666666666, 10.126333333333331, 10.474333333333332, 6.521999999999999, 9.170333333333332, 10.419999999999998, 8.884999999999998, 8.165333333333333, 11.43533333333333, 5.969333333333332, 7.870666666666667, 12.04, 7.265999999999999, 8.185333333333334, 5.954666666666665], "episode_lengths": [23, 17, 18, 21, 21, 19, 18, 19, 26, 21, 20, 20, 23, 14, 23, 18, 20, 22, 21, 17, 17, 17, 15, 18, 18, 19, 16, 21, 13, 21, 17, 16, 20, 19, 19, 16, 18, 20, 18, 18, 20, 20, 23, 21, 19, 15, 14, 17, 20, 19, 15, 17, 16, 18, 17, 26, 21, 21, 16, 17, 16, 25, 17, 17, 17, 20, 23, 19, 19, 14, 18, 21, 21, 16, 15, 20, 18, 19, 20, 15, 18, 18, 16, 16, 16, 22, 22, 23, 16, 20, 20, 19, 18, 24, 13, 16, 23, 16, 16, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5918409154115347, "mean_inference_ms": 2.8936911396463882, "mean_action_processing_ms": 0.5934159933441603, "mean_env_wait_ms": 0.1453866540179739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02109551429748535, "StateBufferConnector_ms": 0.016054630279541016, "ViewRequirementAgentConnector_ms": 0.5352728366851807}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39200, "num_agent_steps_trained": 39200, "num_env_steps_sampled": 39200, "num_env_steps_trained": 39200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1220.2544734849334, "num_env_steps_trained_throughput_per_sec": 1220.2544734849334, "timesteps_total": 39200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 39200, "timers": {"training_iteration_time_ms": 1227.601, "sample_time_ms": 1192.201, "load_time_ms": 0.555, "load_throughput": 2520290.828, "learn_time_ms": 13.622, "learn_throughput": 102775.839, "synch_weights_time_ms": 20.955}, "counters": {"num_env_steps_sampled": 39200, "num_env_steps_trained": 39200, "num_agent_steps_sampled": 39200, "num_agent_steps_trained": 39200}, "done": false, "episodes_total": 2080, "training_iteration": 28, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-28", "timestamp": 1702021168, "time_this_iter_s": 1.1642985343933105, "time_total_s": 32.666428565979004, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 32.666428565979004, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 97.7, "ram_util_percent": 97.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0961906909942627, "total_loss": 1.0961906909942627, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 40600, "num_env_steps_trained": 40600, "num_agent_steps_sampled": 40600, "num_agent_steps_trained": 40600}, "sampler_results": {"episode_reward_max": 13.146333333333331, "episode_reward_min": 5.954666666666665, "episode_reward_mean": 8.792863333333333, "episode_len_mean": 18.73, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.4929999999999986, 9.520666666666667, 8.515, 8.793666666666667, 10.905666666666665, 7.485333333333332, 8.099666666666664, 8.203333333333333, 7.763333333333333, 8.293, 7.087999999999999, 9.622666666666666, 10.126333333333331, 10.474333333333332, 6.521999999999999, 9.170333333333332, 10.419999999999998, 8.884999999999998, 8.165333333333333, 11.43533333333333, 5.969333333333332, 7.870666666666667, 12.04, 7.265999999999999, 8.185333333333334, 5.954666666666665, 7.533333333333331, 8.62833333333333, 7.063666666666665, 10.938333333333334, 8.995, 7.341333333333332, 9.268999999999998, 11.407666666666666, 8.024999999999999, 10.855999999999996, 10.392666666666667, 8.378666666666664, 7.655666666666667, 6.5426666666666655, 7.988666666666666, 7.332666666666666, 6.979999999999999, 9.933, 7.5169999999999995, 10.279333333333332, 6.766, 8.095333333333333, 6.594999999999999, 9.561, 10.762666666666668, 6.709, 8.730666666666666, 7.121999999999998, 9.120999999999999, 10.746, 9.379, 7.431333333333331, 7.183999999999999, 6.450666666666666, 10.864333333333335, 13.131000000000002, 8.775333333333332, 7.334666666666666, 11.964333333333332, 9.187666666666665, 7.7573333333333325, 8.861333333333333, 7.134333333333333, 7.9959999999999996, 10.277000000000001, 8.400999999999998, 8.066666666666666, 12.751666666666662, 8.149333333333333, 7.776666666666664, 8.745999999999999, 9.436000000000002, 8.348333333333333, 9.287999999999998, 8.932666666666666, 8.183333333333334, 13.082666666666661, 8.259666666666664, 6.813999999999999, 10.32033333333333, 7.715999999999999, 8.537333333333333, 9.096, 9.699333333333334, 9.998333333333333, 8.491333333333335, 10.131333333333338, 6.487333333333332, 9.228, 10.745666666666663, 9.062999999999997, 13.146333333333331, 7.345666666666667, 7.7813333333333325], "episode_lengths": [15, 20, 18, 19, 20, 15, 18, 18, 16, 16, 16, 22, 22, 23, 16, 20, 20, 19, 18, 24, 13, 16, 23, 16, 16, 15, 17, 18, 15, 22, 22, 15, 20, 24, 17, 23, 20, 18, 15, 14, 17, 15, 14, 21, 17, 21, 18, 18, 16, 21, 22, 16, 21, 18, 21, 23, 19, 18, 16, 14, 25, 25, 17, 16, 27, 19, 16, 18, 15, 17, 22, 18, 17, 25, 17, 17, 21, 21, 16, 19, 18, 17, 28, 18, 15, 22, 18, 20, 19, 21, 20, 16, 22, 15, 19, 21, 20, 26, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5844437579727975, "mean_inference_ms": 2.870770897787296, "mean_action_processing_ms": 0.590530426974083, "mean_env_wait_ms": 0.1446635348696092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0173795223236084, "StateBufferConnector_ms": 0.028969764709472656, "ViewRequirementAgentConnector_ms": 0.4437849521636963}}, "episode_reward_max": 13.146333333333331, "episode_reward_min": 5.954666666666665, "episode_reward_mean": 8.792863333333333, "episode_len_mean": 18.73, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.4929999999999986, 9.520666666666667, 8.515, 8.793666666666667, 10.905666666666665, 7.485333333333332, 8.099666666666664, 8.203333333333333, 7.763333333333333, 8.293, 7.087999999999999, 9.622666666666666, 10.126333333333331, 10.474333333333332, 6.521999999999999, 9.170333333333332, 10.419999999999998, 8.884999999999998, 8.165333333333333, 11.43533333333333, 5.969333333333332, 7.870666666666667, 12.04, 7.265999999999999, 8.185333333333334, 5.954666666666665, 7.533333333333331, 8.62833333333333, 7.063666666666665, 10.938333333333334, 8.995, 7.341333333333332, 9.268999999999998, 11.407666666666666, 8.024999999999999, 10.855999999999996, 10.392666666666667, 8.378666666666664, 7.655666666666667, 6.5426666666666655, 7.988666666666666, 7.332666666666666, 6.979999999999999, 9.933, 7.5169999999999995, 10.279333333333332, 6.766, 8.095333333333333, 6.594999999999999, 9.561, 10.762666666666668, 6.709, 8.730666666666666, 7.121999999999998, 9.120999999999999, 10.746, 9.379, 7.431333333333331, 7.183999999999999, 6.450666666666666, 10.864333333333335, 13.131000000000002, 8.775333333333332, 7.334666666666666, 11.964333333333332, 9.187666666666665, 7.7573333333333325, 8.861333333333333, 7.134333333333333, 7.9959999999999996, 10.277000000000001, 8.400999999999998, 8.066666666666666, 12.751666666666662, 8.149333333333333, 7.776666666666664, 8.745999999999999, 9.436000000000002, 8.348333333333333, 9.287999999999998, 8.932666666666666, 8.183333333333334, 13.082666666666661, 8.259666666666664, 6.813999999999999, 10.32033333333333, 7.715999999999999, 8.537333333333333, 9.096, 9.699333333333334, 9.998333333333333, 8.491333333333335, 10.131333333333338, 6.487333333333332, 9.228, 10.745666666666663, 9.062999999999997, 13.146333333333331, 7.345666666666667, 7.7813333333333325], "episode_lengths": [15, 20, 18, 19, 20, 15, 18, 18, 16, 16, 16, 22, 22, 23, 16, 20, 20, 19, 18, 24, 13, 16, 23, 16, 16, 15, 17, 18, 15, 22, 22, 15, 20, 24, 17, 23, 20, 18, 15, 14, 17, 15, 14, 21, 17, 21, 18, 18, 16, 21, 22, 16, 21, 18, 21, 23, 19, 18, 16, 14, 25, 25, 17, 16, 27, 19, 16, 18, 15, 17, 22, 18, 17, 25, 17, 17, 21, 21, 16, 19, 18, 17, 28, 18, 15, 22, 18, 20, 19, 21, 20, 16, 22, 15, 19, 21, 20, 26, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5844437579727975, "mean_inference_ms": 2.870770897787296, "mean_action_processing_ms": 0.590530426974083, "mean_env_wait_ms": 0.1446635348696092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0173795223236084, "StateBufferConnector_ms": 0.028969764709472656, "ViewRequirementAgentConnector_ms": 0.4437849521636963}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40600, "num_agent_steps_trained": 40600, "num_env_steps_sampled": 40600, "num_env_steps_trained": 40600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1615.8013233443198, "num_env_steps_trained_throughput_per_sec": 1615.8013233443198, "timesteps_total": 40600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 40600, "timers": {"training_iteration_time_ms": 1164.854, "sample_time_ms": 1129.881, "load_time_ms": 0.455, "load_throughput": 3074198.0, "learn_time_ms": 13.528, "learn_throughput": 103490.418, "synch_weights_time_ms": 20.723}, "counters": {"num_env_steps_sampled": 40600, "num_env_steps_trained": 40600, "num_agent_steps_sampled": 40600, "num_agent_steps_trained": 40600}, "done": false, "episodes_total": 2154, "training_iteration": 29, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-29", "timestamp": 1702021169, "time_this_iter_s": 0.880767822265625, "time_total_s": 33.54719638824463, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.54719638824463, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 88.3, "ram_util_percent": 97.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.097746729850769, "total_loss": 1.097746729850769, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": 14.37466666666667, "episode_reward_min": 6.127999999999999, "episode_reward_mean": 8.79504, "episode_len_mean": 18.69, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.745999999999999, 9.436000000000002, 8.348333333333333, 9.287999999999998, 8.932666666666666, 8.183333333333334, 13.082666666666661, 8.259666666666664, 6.813999999999999, 10.32033333333333, 7.715999999999999, 8.537333333333333, 9.096, 9.699333333333334, 9.998333333333333, 8.491333333333335, 10.131333333333338, 6.487333333333332, 9.228, 10.745666666666663, 9.062999999999997, 13.146333333333331, 7.345666666666667, 7.7813333333333325, 8.345333333333333, 11.066333333333333, 9.002666666666666, 8.612666666666666, 9.88933333333333, 10.868666666666666, 7.89433333333333, 6.286666666666666, 10.86, 7.9943333333333335, 8.083333333333332, 8.714333333333332, 9.628999999999998, 6.935999999999999, 7.102666666666666, 10.936333333333328, 8.792333333333332, 8.775999999999998, 7.7813333333333325, 14.37466666666667, 9.990666666666664, 8.222666666666663, 8.186333333333332, 8.12533333333333, 7.908666666666666, 9.256000000000002, 8.706999999999999, 6.756333333333331, 12.035666666666664, 7.915666666666667, 10.362666666666664, 9.010666666666664, 8.593666666666667, 8.660999999999998, 7.866666666666667, 8.740666666666664, 11.977999999999994, 8.998666666666667, 7.421999999999999, 7.534333333333333, 6.690666666666665, 7.124333333333333, 11.088333333333335, 10.17, 6.866333333333332, 8.682666666666666, 9.509666666666664, 7.363333333333333, 6.7333333333333325, 9.698666666666664, 7.863999999999998, 11.274333333333335, 6.127999999999999, 6.808333333333334, 6.664666666666666, 7.589666666666666, 8.331666666666665, 7.572999999999999, 8.674666666666663, 8.012333333333332, 8.898000000000001, 10.191333333333331, 9.022999999999998, 8.271333333333333, 7.754333333333332, 9.186666666666667, 7.554333333333331, 8.069666666666667, 6.77, 10.486666666666666, 8.282, 8.056333333333331, 7.397999999999999, 10.369, 9.971, 9.277333333333331], "episode_lengths": [21, 21, 16, 19, 18, 17, 28, 18, 15, 22, 18, 20, 19, 21, 20, 16, 22, 15, 19, 21, 20, 26, 15, 15, 17, 21, 19, 18, 21, 23, 17, 14, 21, 18, 16, 17, 24, 15, 17, 23, 17, 18, 16, 27, 20, 17, 18, 17, 16, 20, 18, 15, 24, 17, 23, 18, 17, 18, 17, 19, 26, 18, 16, 16, 16, 17, 22, 21, 16, 23, 19, 17, 14, 20, 18, 21, 13, 15, 15, 20, 19, 17, 18, 18, 19, 21, 21, 19, 17, 17, 17, 16, 14, 23, 19, 16, 15, 23, 22, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5752446509648796, "mean_inference_ms": 2.8571919712510994, "mean_action_processing_ms": 0.589963681622844, "mean_env_wait_ms": 0.1435102639105922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024973392486572266, "StateBufferConnector_ms": 0.018100500106811523, "ViewRequirementAgentConnector_ms": 0.47251367568969727}}, "episode_reward_max": 14.37466666666667, "episode_reward_min": 6.127999999999999, "episode_reward_mean": 8.79504, "episode_len_mean": 18.69, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.745999999999999, 9.436000000000002, 8.348333333333333, 9.287999999999998, 8.932666666666666, 8.183333333333334, 13.082666666666661, 8.259666666666664, 6.813999999999999, 10.32033333333333, 7.715999999999999, 8.537333333333333, 9.096, 9.699333333333334, 9.998333333333333, 8.491333333333335, 10.131333333333338, 6.487333333333332, 9.228, 10.745666666666663, 9.062999999999997, 13.146333333333331, 7.345666666666667, 7.7813333333333325, 8.345333333333333, 11.066333333333333, 9.002666666666666, 8.612666666666666, 9.88933333333333, 10.868666666666666, 7.89433333333333, 6.286666666666666, 10.86, 7.9943333333333335, 8.083333333333332, 8.714333333333332, 9.628999999999998, 6.935999999999999, 7.102666666666666, 10.936333333333328, 8.792333333333332, 8.775999999999998, 7.7813333333333325, 14.37466666666667, 9.990666666666664, 8.222666666666663, 8.186333333333332, 8.12533333333333, 7.908666666666666, 9.256000000000002, 8.706999999999999, 6.756333333333331, 12.035666666666664, 7.915666666666667, 10.362666666666664, 9.010666666666664, 8.593666666666667, 8.660999999999998, 7.866666666666667, 8.740666666666664, 11.977999999999994, 8.998666666666667, 7.421999999999999, 7.534333333333333, 6.690666666666665, 7.124333333333333, 11.088333333333335, 10.17, 6.866333333333332, 8.682666666666666, 9.509666666666664, 7.363333333333333, 6.7333333333333325, 9.698666666666664, 7.863999999999998, 11.274333333333335, 6.127999999999999, 6.808333333333334, 6.664666666666666, 7.589666666666666, 8.331666666666665, 7.572999999999999, 8.674666666666663, 8.012333333333332, 8.898000000000001, 10.191333333333331, 9.022999999999998, 8.271333333333333, 7.754333333333332, 9.186666666666667, 7.554333333333331, 8.069666666666667, 6.77, 10.486666666666666, 8.282, 8.056333333333331, 7.397999999999999, 10.369, 9.971, 9.277333333333331], "episode_lengths": [21, 21, 16, 19, 18, 17, 28, 18, 15, 22, 18, 20, 19, 21, 20, 16, 22, 15, 19, 21, 20, 26, 15, 15, 17, 21, 19, 18, 21, 23, 17, 14, 21, 18, 16, 17, 24, 15, 17, 23, 17, 18, 16, 27, 20, 17, 18, 17, 16, 20, 18, 15, 24, 17, 23, 18, 17, 18, 17, 19, 26, 18, 16, 16, 16, 17, 22, 21, 16, 23, 19, 17, 14, 20, 18, 21, 13, 15, 15, 20, 19, 17, 18, 18, 19, 21, 21, 19, 17, 17, 17, 16, 14, 23, 19, 16, 15, 23, 22, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5752446509648796, "mean_inference_ms": 2.8571919712510994, "mean_action_processing_ms": 0.589963681622844, "mean_env_wait_ms": 0.1435102639105922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024973392486572266, "StateBufferConnector_ms": 0.018100500106811523, "ViewRequirementAgentConnector_ms": 0.47251367568969727}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1381.1328015023046, "num_env_steps_trained_throughput_per_sec": 1381.1328015023046, "timesteps_total": 42000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 1141.441, "sample_time_ms": 1106.514, "load_time_ms": 0.455, "load_throughput": 3076775.269, "learn_time_ms": 13.425, "learn_throughput": 104286.075, "synch_weights_time_ms": 20.781}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 2230, "training_iteration": 30, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-30", "timestamp": 1702021170, "time_this_iter_s": 1.029658555984497, "time_total_s": 34.576854944229126, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.576854944229126, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 95.55, "ram_util_percent": 97.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0979573726654053, "total_loss": 1.0979573726654053, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 43400, "num_env_steps_trained": 43400, "num_agent_steps_sampled": 43400, "num_agent_steps_trained": 43400}, "sampler_results": {"episode_reward_max": 15.159666666666668, "episode_reward_min": 5.895333333333333, "episode_reward_mean": 8.70507, "episode_len_mean": 18.71, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.274333333333335, 6.127999999999999, 6.808333333333334, 6.664666666666666, 7.589666666666666, 8.331666666666665, 7.572999999999999, 8.674666666666663, 8.012333333333332, 8.898000000000001, 10.191333333333331, 9.022999999999998, 8.271333333333333, 7.754333333333332, 9.186666666666667, 7.554333333333331, 8.069666666666667, 6.77, 10.486666666666666, 8.282, 8.056333333333331, 7.397999999999999, 10.369, 9.971, 9.277333333333331, 7.603333333333334, 10.375333333333332, 9.158666666666667, 9.810333333333336, 7.653666666666667, 8.057666666666664, 6.037, 6.5316666666666645, 12.132333333333333, 9.433000000000002, 7.272333333333332, 9.12633333333333, 8.145666666666667, 11.01533333333333, 8.136333333333333, 6.8053333333333335, 6.8966666666666665, 9.834000000000003, 11.126666666666667, 6.695333333333333, 6.9799999999999995, 15.159666666666668, 12.453999999999995, 8.159666666666666, 8.402333333333333, 9.455666666666664, 9.822999999999999, 8.611, 8.667333333333334, 9.082, 7.4819999999999975, 9.106666666666666, 9.376999999999999, 7.991333333333332, 8.177999999999999, 8.354666666666665, 7.665333333333331, 9.405999999999999, 8.380666666666666, 8.281333333333333, 10.843999999999996, 10.029333333333334, 7.921666666666666, 9.114666666666666, 7.6596666666666655, 8.349999999999998, 14.462333333333337, 9.789666666666664, 6.988666666666664, 7.816999999999998, 6.157666666666666, 10.080666666666666, 6.773666666666666, 6.1499999999999995, 11.098666666666668, 10.385333333333334, 7.645999999999997, 9.800666666666663, 8.333666666666666, 13.505999999999997, 8.312999999999999, 8.23033333333333, 7.731666666666666, 6.748999999999999, 7.917000000000001, 8.581, 7.145, 9.443999999999999, 10.782666666666664, 9.150333333333332, 7.324, 7.524333333333331, 5.895333333333333, 11.101999999999997, 8.227666666666664], "episode_lengths": [21, 13, 15, 15, 20, 19, 17, 18, 18, 19, 21, 21, 19, 17, 17, 17, 16, 14, 23, 19, 16, 15, 23, 22, 20, 18, 21, 20, 21, 17, 18, 15, 15, 28, 20, 15, 20, 18, 26, 17, 14, 14, 22, 23, 14, 15, 30, 24, 16, 19, 21, 21, 19, 22, 22, 18, 18, 21, 19, 17, 17, 15, 18, 17, 20, 22, 22, 18, 19, 15, 17, 28, 21, 16, 16, 14, 20, 15, 13, 24, 22, 19, 21, 18, 26, 19, 18, 17, 15, 16, 19, 15, 19, 22, 20, 16, 16, 13, 22, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5677127094608538, "mean_inference_ms": 2.8384213459310867, "mean_action_processing_ms": 0.5877244692561373, "mean_env_wait_ms": 0.14236110677243155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014928579330444336, "StateBufferConnector_ms": 0.01596379280090332, "ViewRequirementAgentConnector_ms": 0.4666569232940674}}, "episode_reward_max": 15.159666666666668, "episode_reward_min": 5.895333333333333, "episode_reward_mean": 8.70507, "episode_len_mean": 18.71, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.274333333333335, 6.127999999999999, 6.808333333333334, 6.664666666666666, 7.589666666666666, 8.331666666666665, 7.572999999999999, 8.674666666666663, 8.012333333333332, 8.898000000000001, 10.191333333333331, 9.022999999999998, 8.271333333333333, 7.754333333333332, 9.186666666666667, 7.554333333333331, 8.069666666666667, 6.77, 10.486666666666666, 8.282, 8.056333333333331, 7.397999999999999, 10.369, 9.971, 9.277333333333331, 7.603333333333334, 10.375333333333332, 9.158666666666667, 9.810333333333336, 7.653666666666667, 8.057666666666664, 6.037, 6.5316666666666645, 12.132333333333333, 9.433000000000002, 7.272333333333332, 9.12633333333333, 8.145666666666667, 11.01533333333333, 8.136333333333333, 6.8053333333333335, 6.8966666666666665, 9.834000000000003, 11.126666666666667, 6.695333333333333, 6.9799999999999995, 15.159666666666668, 12.453999999999995, 8.159666666666666, 8.402333333333333, 9.455666666666664, 9.822999999999999, 8.611, 8.667333333333334, 9.082, 7.4819999999999975, 9.106666666666666, 9.376999999999999, 7.991333333333332, 8.177999999999999, 8.354666666666665, 7.665333333333331, 9.405999999999999, 8.380666666666666, 8.281333333333333, 10.843999999999996, 10.029333333333334, 7.921666666666666, 9.114666666666666, 7.6596666666666655, 8.349999999999998, 14.462333333333337, 9.789666666666664, 6.988666666666664, 7.816999999999998, 6.157666666666666, 10.080666666666666, 6.773666666666666, 6.1499999999999995, 11.098666666666668, 10.385333333333334, 7.645999999999997, 9.800666666666663, 8.333666666666666, 13.505999999999997, 8.312999999999999, 8.23033333333333, 7.731666666666666, 6.748999999999999, 7.917000000000001, 8.581, 7.145, 9.443999999999999, 10.782666666666664, 9.150333333333332, 7.324, 7.524333333333331, 5.895333333333333, 11.101999999999997, 8.227666666666664], "episode_lengths": [21, 13, 15, 15, 20, 19, 17, 18, 18, 19, 21, 21, 19, 17, 17, 17, 16, 14, 23, 19, 16, 15, 23, 22, 20, 18, 21, 20, 21, 17, 18, 15, 15, 28, 20, 15, 20, 18, 26, 17, 14, 14, 22, 23, 14, 15, 30, 24, 16, 19, 21, 21, 19, 22, 22, 18, 18, 21, 19, 17, 17, 15, 18, 17, 20, 22, 22, 18, 19, 15, 17, 28, 21, 16, 16, 14, 20, 15, 13, 24, 22, 19, 21, 18, 26, 19, 18, 17, 15, 16, 19, 15, 19, 22, 20, 16, 16, 13, 22, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5677127094608538, "mean_inference_ms": 2.8384213459310867, "mean_action_processing_ms": 0.5877244692561373, "mean_env_wait_ms": 0.14236110677243155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014928579330444336, "StateBufferConnector_ms": 0.01596379280090332, "ViewRequirementAgentConnector_ms": 0.4666569232940674}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43400, "num_agent_steps_trained": 43400, "num_env_steps_sampled": 43400, "num_env_steps_trained": 43400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1540.7312249127176, "num_env_steps_trained_throughput_per_sec": 1540.7312249127176, "timesteps_total": 43400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 43400, "timers": {"training_iteration_time_ms": 1106.145, "sample_time_ms": 1071.325, "load_time_ms": 0.455, "load_throughput": 3076775.269, "learn_time_ms": 13.415, "learn_throughput": 104363.921, "synch_weights_time_ms": 20.684}, "counters": {"num_env_steps_sampled": 43400, "num_env_steps_trained": 43400, "num_agent_steps_sampled": 43400, "num_agent_steps_trained": 43400}, "done": false, "episodes_total": 2305, "training_iteration": 31, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-31", "timestamp": 1702021171, "time_this_iter_s": 0.9286580085754395, "time_total_s": 35.505512952804565, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.505512952804565, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 93.0, "ram_util_percent": 97.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0949445962905884, "total_loss": 1.0949445962905884, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 44800, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "sampler_results": {"episode_reward_max": 15.132333333333335, "episode_reward_min": 5.895333333333333, "episode_reward_mean": 8.683643333333332, "episode_len_mean": 18.62, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.988666666666664, 7.816999999999998, 6.157666666666666, 10.080666666666666, 6.773666666666666, 6.1499999999999995, 11.098666666666668, 10.385333333333334, 7.645999999999997, 9.800666666666663, 8.333666666666666, 13.505999999999997, 8.312999999999999, 8.23033333333333, 7.731666666666666, 6.748999999999999, 7.917000000000001, 8.581, 7.145, 9.443999999999999, 10.782666666666664, 9.150333333333332, 7.324, 7.524333333333331, 5.895333333333333, 11.101999999999997, 8.227666666666664, 8.692333333333332, 6.125333333333333, 8.612999999999998, 9.196999999999997, 8.470333333333333, 7.683999999999999, 8.686666666666666, 8.22433333333333, 7.057666666666666, 10.586000000000002, 7.232333333333332, 10.452999999999998, 8.390999999999998, 9.341, 7.789666666666667, 7.6436666666666655, 10.638666666666664, 9.531666666666665, 9.812, 9.059999999999999, 7.237999999999998, 8.169666666666663, 7.512666666666665, 9.385666666666665, 8.005666666666668, 7.643666666666664, 7.891333333333334, 6.625666666666667, 6.301333333333332, 7.352666666666664, 12.774333333333326, 8.948333333333332, 8.738666666666665, 10.008333333333335, 10.174333333333328, 7.476666666666665, 7.617, 7.942, 7.883333333333333, 8.285, 15.132333333333335, 8.631, 6.619666666666666, 7.173333333333333, 11.262, 6.979666666666665, 11.742999999999995, 10.285333333333332, 8.035666666666666, 8.943333333333332, 10.798666666666666, 8.244333333333332, 7.897666666666665, 10.693999999999997, 10.00233333333333, 9.230999999999998, 7.866333333333331, 7.397666666666664, 11.042333333333328, 11.112666666666664, 7.5649999999999995, 7.308333333333333, 7.075333333333332, 8.875, 9.774333333333331, 10.806666666666665, 7.512999999999999, 9.789333333333332, 6.3629999999999995, 9.876333333333331, 11.33933333333333, 7.4369999999999985, 7.489999999999999], "episode_lengths": [16, 16, 14, 20, 15, 13, 24, 22, 19, 21, 18, 26, 19, 18, 17, 15, 16, 19, 15, 19, 22, 20, 16, 16, 13, 22, 18, 17, 15, 19, 18, 18, 15, 17, 21, 14, 20, 18, 23, 17, 21, 18, 16, 22, 18, 18, 20, 17, 21, 15, 20, 20, 18, 17, 15, 14, 15, 25, 20, 19, 22, 20, 15, 16, 18, 16, 17, 32, 19, 15, 15, 23, 16, 25, 20, 19, 19, 23, 18, 17, 22, 19, 19, 17, 18, 23, 24, 17, 16, 15, 21, 25, 21, 18, 20, 14, 22, 21, 17, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5611180008482552, "mean_inference_ms": 2.8180903398985304, "mean_action_processing_ms": 0.585668163763919, "mean_env_wait_ms": 0.14173776308938985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012914896011352539, "StateBufferConnector_ms": 0.016379594802856445, "ViewRequirementAgentConnector_ms": 0.41657400131225586}}, "episode_reward_max": 15.132333333333335, "episode_reward_min": 5.895333333333333, "episode_reward_mean": 8.683643333333332, "episode_len_mean": 18.62, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.988666666666664, 7.816999999999998, 6.157666666666666, 10.080666666666666, 6.773666666666666, 6.1499999999999995, 11.098666666666668, 10.385333333333334, 7.645999999999997, 9.800666666666663, 8.333666666666666, 13.505999999999997, 8.312999999999999, 8.23033333333333, 7.731666666666666, 6.748999999999999, 7.917000000000001, 8.581, 7.145, 9.443999999999999, 10.782666666666664, 9.150333333333332, 7.324, 7.524333333333331, 5.895333333333333, 11.101999999999997, 8.227666666666664, 8.692333333333332, 6.125333333333333, 8.612999999999998, 9.196999999999997, 8.470333333333333, 7.683999999999999, 8.686666666666666, 8.22433333333333, 7.057666666666666, 10.586000000000002, 7.232333333333332, 10.452999999999998, 8.390999999999998, 9.341, 7.789666666666667, 7.6436666666666655, 10.638666666666664, 9.531666666666665, 9.812, 9.059999999999999, 7.237999999999998, 8.169666666666663, 7.512666666666665, 9.385666666666665, 8.005666666666668, 7.643666666666664, 7.891333333333334, 6.625666666666667, 6.301333333333332, 7.352666666666664, 12.774333333333326, 8.948333333333332, 8.738666666666665, 10.008333333333335, 10.174333333333328, 7.476666666666665, 7.617, 7.942, 7.883333333333333, 8.285, 15.132333333333335, 8.631, 6.619666666666666, 7.173333333333333, 11.262, 6.979666666666665, 11.742999999999995, 10.285333333333332, 8.035666666666666, 8.943333333333332, 10.798666666666666, 8.244333333333332, 7.897666666666665, 10.693999999999997, 10.00233333333333, 9.230999999999998, 7.866333333333331, 7.397666666666664, 11.042333333333328, 11.112666666666664, 7.5649999999999995, 7.308333333333333, 7.075333333333332, 8.875, 9.774333333333331, 10.806666666666665, 7.512999999999999, 9.789333333333332, 6.3629999999999995, 9.876333333333331, 11.33933333333333, 7.4369999999999985, 7.489999999999999], "episode_lengths": [16, 16, 14, 20, 15, 13, 24, 22, 19, 21, 18, 26, 19, 18, 17, 15, 16, 19, 15, 19, 22, 20, 16, 16, 13, 22, 18, 17, 15, 19, 18, 18, 15, 17, 21, 14, 20, 18, 23, 17, 21, 18, 16, 22, 18, 18, 20, 17, 21, 15, 20, 20, 18, 17, 15, 14, 15, 25, 20, 19, 22, 20, 15, 16, 18, 16, 17, 32, 19, 15, 15, 23, 16, 25, 20, 19, 19, 23, 18, 17, 22, 19, 19, 17, 18, 23, 24, 17, 16, 15, 21, 25, 21, 18, 20, 14, 22, 21, 17, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5611180008482552, "mean_inference_ms": 2.8180903398985304, "mean_action_processing_ms": 0.585668163763919, "mean_env_wait_ms": 0.14173776308938985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012914896011352539, "StateBufferConnector_ms": 0.016379594802856445, "ViewRequirementAgentConnector_ms": 0.41657400131225586}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800, "num_env_steps_sampled": 44800, "num_env_steps_trained": 44800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1501.301130496299, "num_env_steps_trained_throughput_per_sec": 1501.301130496299, "timesteps_total": 44800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 44800, "timers": {"training_iteration_time_ms": 1089.117, "sample_time_ms": 1054.501, "load_time_ms": 0.398, "load_throughput": 3521877.047, "learn_time_ms": 13.479, "learn_throughput": 103864.948, "synch_weights_time_ms": 20.573}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 44800, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "done": false, "episodes_total": 2378, "training_iteration": 32, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-32", "timestamp": 1702021172, "time_this_iter_s": 0.9606151580810547, "time_total_s": 36.46612811088562, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 36.46612811088562, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 92.3, "ram_util_percent": 97.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0960514545440674, "total_loss": 1.0960514545440674, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 46200, "num_env_steps_trained": 46200, "num_agent_steps_sampled": 46200, "num_agent_steps_trained": 46200}, "sampler_results": {"episode_reward_max": 13.949333333333332, "episode_reward_min": 5.887666666666667, "episode_reward_mean": 8.85295333333333, "episode_len_mean": 19.02, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.285333333333332, 8.035666666666666, 8.943333333333332, 10.798666666666666, 8.244333333333332, 7.897666666666665, 10.693999999999997, 10.00233333333333, 9.230999999999998, 7.866333333333331, 7.397666666666664, 11.042333333333328, 11.112666666666664, 7.5649999999999995, 7.308333333333333, 7.075333333333332, 8.875, 9.774333333333331, 10.806666666666665, 7.512999999999999, 9.789333333333332, 6.3629999999999995, 9.876333333333331, 11.33933333333333, 7.4369999999999985, 7.489999999999999, 10.483999999999996, 9.080666666666668, 9.11, 7.551333333333333, 6.751999999999999, 7.333333333333334, 10.768333333333333, 9.046666666666663, 10.51933333333333, 7.758666666666668, 10.700666666666665, 13.134333333333336, 9.242333333333333, 8.065333333333333, 6.840000000000001, 8.860333333333331, 7.808999999999998, 7.098999999999998, 8.404666666666666, 8.599333333333332, 8.485333333333333, 8.932333333333332, 8.330333333333332, 10.009333333333332, 7.407333333333332, 12.069333333333333, 7.6469999999999985, 10.638666666666666, 7.647666666666668, 11.73033333333333, 6.283666666666667, 7.395333333333332, 9.225333333333332, 7.887333333333332, 9.469333333333331, 5.887666666666667, 7.806333333333333, 9.414, 8.280666666666667, 10.909999999999995, 13.111666666666665, 10.18133333333333, 7.395333333333333, 10.497, 7.573666666666663, 8.331666666666665, 7.865, 6.855666666666665, 7.575333333333331, 8.87733333333333, 7.425, 8.915, 6.2206666666666655, 7.061666666666667, 8.183666666666666, 7.849999999999999, 7.931333333333332, 9.177999999999997, 13.949333333333332, 10.088333333333333, 8.034333333333333, 13.698, 8.64033333333333, 7.851333333333334, 11.364666666666666, 13.208333333333336, 8.373333333333333, 7.485999999999999, 7.787333333333333, 6.700333333333333, 8.026666666666666, 6.053000000000001, 6.463999999999998, 11.16], "episode_lengths": [20, 19, 19, 23, 18, 17, 22, 19, 19, 17, 18, 23, 24, 17, 16, 15, 21, 25, 21, 18, 20, 14, 22, 21, 17, 18, 22, 21, 22, 16, 16, 17, 24, 20, 23, 17, 24, 28, 18, 19, 15, 22, 17, 17, 18, 19, 17, 19, 18, 20, 17, 26, 16, 21, 16, 24, 14, 19, 19, 16, 19, 14, 17, 22, 16, 22, 25, 22, 19, 21, 15, 17, 17, 15, 15, 19, 15, 19, 14, 14, 17, 19, 16, 17, 30, 19, 16, 28, 20, 16, 25, 27, 18, 16, 18, 14, 18, 14, 14, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.560769312506836, "mean_inference_ms": 2.8112969121947327, "mean_action_processing_ms": 0.5853884680640955, "mean_env_wait_ms": 0.14142994107194007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020138978958129883, "StateBufferConnector_ms": 0.01225733757019043, "ViewRequirementAgentConnector_ms": 0.5232648849487305}}, "episode_reward_max": 13.949333333333332, "episode_reward_min": 5.887666666666667, "episode_reward_mean": 8.85295333333333, "episode_len_mean": 19.02, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.285333333333332, 8.035666666666666, 8.943333333333332, 10.798666666666666, 8.244333333333332, 7.897666666666665, 10.693999999999997, 10.00233333333333, 9.230999999999998, 7.866333333333331, 7.397666666666664, 11.042333333333328, 11.112666666666664, 7.5649999999999995, 7.308333333333333, 7.075333333333332, 8.875, 9.774333333333331, 10.806666666666665, 7.512999999999999, 9.789333333333332, 6.3629999999999995, 9.876333333333331, 11.33933333333333, 7.4369999999999985, 7.489999999999999, 10.483999999999996, 9.080666666666668, 9.11, 7.551333333333333, 6.751999999999999, 7.333333333333334, 10.768333333333333, 9.046666666666663, 10.51933333333333, 7.758666666666668, 10.700666666666665, 13.134333333333336, 9.242333333333333, 8.065333333333333, 6.840000000000001, 8.860333333333331, 7.808999999999998, 7.098999999999998, 8.404666666666666, 8.599333333333332, 8.485333333333333, 8.932333333333332, 8.330333333333332, 10.009333333333332, 7.407333333333332, 12.069333333333333, 7.6469999999999985, 10.638666666666666, 7.647666666666668, 11.73033333333333, 6.283666666666667, 7.395333333333332, 9.225333333333332, 7.887333333333332, 9.469333333333331, 5.887666666666667, 7.806333333333333, 9.414, 8.280666666666667, 10.909999999999995, 13.111666666666665, 10.18133333333333, 7.395333333333333, 10.497, 7.573666666666663, 8.331666666666665, 7.865, 6.855666666666665, 7.575333333333331, 8.87733333333333, 7.425, 8.915, 6.2206666666666655, 7.061666666666667, 8.183666666666666, 7.849999999999999, 7.931333333333332, 9.177999999999997, 13.949333333333332, 10.088333333333333, 8.034333333333333, 13.698, 8.64033333333333, 7.851333333333334, 11.364666666666666, 13.208333333333336, 8.373333333333333, 7.485999999999999, 7.787333333333333, 6.700333333333333, 8.026666666666666, 6.053000000000001, 6.463999999999998, 11.16], "episode_lengths": [20, 19, 19, 23, 18, 17, 22, 19, 19, 17, 18, 23, 24, 17, 16, 15, 21, 25, 21, 18, 20, 14, 22, 21, 17, 18, 22, 21, 22, 16, 16, 17, 24, 20, 23, 17, 24, 28, 18, 19, 15, 22, 17, 17, 18, 19, 17, 19, 18, 20, 17, 26, 16, 21, 16, 24, 14, 19, 19, 16, 19, 14, 17, 22, 16, 22, 25, 22, 19, 21, 15, 17, 17, 15, 15, 19, 15, 19, 14, 14, 17, 19, 16, 17, 30, 19, 16, 28, 20, 16, 25, 27, 18, 16, 18, 14, 18, 14, 14, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.560769312506836, "mean_inference_ms": 2.8112969121947327, "mean_action_processing_ms": 0.5853884680640955, "mean_env_wait_ms": 0.14142994107194007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020138978958129883, "StateBufferConnector_ms": 0.01225733757019043, "ViewRequirementAgentConnector_ms": 0.5232648849487305}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46200, "num_agent_steps_trained": 46200, "num_env_steps_sampled": 46200, "num_env_steps_trained": 46200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1079.5357354737168, "num_env_steps_trained_throughput_per_sec": 1079.5357354737168, "timesteps_total": 46200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 46200, "timers": {"training_iteration_time_ms": 1091.815, "sample_time_ms": 1056.606, "load_time_ms": 0.497, "load_throughput": 2814294.56, "learn_time_ms": 13.69, "learn_throughput": 102264.822, "synch_weights_time_ms": 20.854}, "counters": {"num_env_steps_sampled": 46200, "num_env_steps_trained": 46200, "num_agent_steps_sampled": 46200, "num_agent_steps_trained": 46200}, "done": false, "episodes_total": 2452, "training_iteration": 33, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-34", "timestamp": 1702021174, "time_this_iter_s": 1.3508496284484863, "time_total_s": 37.816977739334106, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.816977739334106, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 94.25, "ram_util_percent": 97.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0964895486831665, "total_loss": 1.0964895486831665, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 47600, "num_env_steps_trained": 47600, "num_agent_steps_sampled": 47600, "num_agent_steps_trained": 47600}, "sampler_results": {"episode_reward_max": 15.530999999999999, "episode_reward_min": 5.875666666666667, "episode_reward_mean": 8.728066666666667, "episode_len_mean": 18.54, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.425, 8.915, 6.2206666666666655, 7.061666666666667, 8.183666666666666, 7.849999999999999, 7.931333333333332, 9.177999999999997, 13.949333333333332, 10.088333333333333, 8.034333333333333, 13.698, 8.64033333333333, 7.851333333333334, 11.364666666666666, 13.208333333333336, 8.373333333333333, 7.485999999999999, 7.787333333333333, 6.700333333333333, 8.026666666666666, 6.053000000000001, 6.463999999999998, 11.16, 10.598666666666665, 6.655999999999999, 6.446333333333333, 12.375, 8.360666666666665, 15.530999999999999, 9.626999999999999, 9.25233333333333, 6.639666666666665, 12.311999999999994, 7.667, 9.376000000000001, 8.786999999999999, 10.673333333333328, 8.805333333333333, 7.9303333333333335, 6.853, 8.992666666666667, 7.033333333333331, 7.995, 8.615333333333336, 10.238999999999997, 5.875666666666667, 7.986666666666665, 9.927666666666669, 10.629000000000003, 11.342333333333334, 6.045666666666666, 7.601333333333333, 8.277999999999999, 10.009666666666666, 7.941666666666665, 7.386666666666667, 11.691666666666665, 7.855, 7.244333333333331, 8.904666666666666, 8.033333333333333, 7.83533333333333, 7.542999999999999, 8.434666666666667, 8.103333333333333, 9.269999999999998, 7.282666666666667, 8.312000000000001, 8.048666666666664, 11.490333333333334, 9.776333333333332, 9.320333333333334, 7.138666666666666, 7.627333333333333, 10.065666666666667, 6.9933333333333305, 8.802666666666669, 8.163, 11.771, 6.827999999999998, 8.070666666666666, 10.666999999999998, 8.441666666666663, 9.356, 7.918333333333331, 6.188999999999999, 8.064666666666666, 7.365666666666665, 9.283333333333333, 7.109666666666666, 12.001333333333337, 7.383000000000001, 6.898999999999999, 8.628333333333332, 8.596, 7.939333333333333, 10.169666666666664, 8.650666666666666, 8.097], "episode_lengths": [15, 19, 14, 14, 17, 19, 16, 17, 30, 19, 16, 28, 20, 16, 25, 27, 18, 16, 18, 14, 18, 14, 14, 23, 21, 14, 14, 24, 17, 31, 21, 17, 15, 25, 19, 20, 18, 22, 17, 16, 16, 20, 18, 17, 19, 22, 13, 18, 20, 22, 25, 13, 16, 18, 20, 21, 15, 23, 18, 16, 19, 16, 17, 17, 16, 16, 21, 16, 17, 17, 25, 19, 21, 15, 17, 20, 14, 19, 18, 23, 16, 18, 23, 20, 20, 17, 14, 16, 16, 20, 16, 27, 16, 16, 17, 18, 18, 22, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5666727564904057, "mean_inference_ms": 2.8204527741208576, "mean_action_processing_ms": 0.5864954928295323, "mean_env_wait_ms": 0.14216755301142808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03456258773803711, "StateBufferConnector_ms": 0.022128820419311523, "ViewRequirementAgentConnector_ms": 0.5836505889892578}}, "episode_reward_max": 15.530999999999999, "episode_reward_min": 5.875666666666667, "episode_reward_mean": 8.728066666666667, "episode_len_mean": 18.54, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.425, 8.915, 6.2206666666666655, 7.061666666666667, 8.183666666666666, 7.849999999999999, 7.931333333333332, 9.177999999999997, 13.949333333333332, 10.088333333333333, 8.034333333333333, 13.698, 8.64033333333333, 7.851333333333334, 11.364666666666666, 13.208333333333336, 8.373333333333333, 7.485999999999999, 7.787333333333333, 6.700333333333333, 8.026666666666666, 6.053000000000001, 6.463999999999998, 11.16, 10.598666666666665, 6.655999999999999, 6.446333333333333, 12.375, 8.360666666666665, 15.530999999999999, 9.626999999999999, 9.25233333333333, 6.639666666666665, 12.311999999999994, 7.667, 9.376000000000001, 8.786999999999999, 10.673333333333328, 8.805333333333333, 7.9303333333333335, 6.853, 8.992666666666667, 7.033333333333331, 7.995, 8.615333333333336, 10.238999999999997, 5.875666666666667, 7.986666666666665, 9.927666666666669, 10.629000000000003, 11.342333333333334, 6.045666666666666, 7.601333333333333, 8.277999999999999, 10.009666666666666, 7.941666666666665, 7.386666666666667, 11.691666666666665, 7.855, 7.244333333333331, 8.904666666666666, 8.033333333333333, 7.83533333333333, 7.542999999999999, 8.434666666666667, 8.103333333333333, 9.269999999999998, 7.282666666666667, 8.312000000000001, 8.048666666666664, 11.490333333333334, 9.776333333333332, 9.320333333333334, 7.138666666666666, 7.627333333333333, 10.065666666666667, 6.9933333333333305, 8.802666666666669, 8.163, 11.771, 6.827999999999998, 8.070666666666666, 10.666999999999998, 8.441666666666663, 9.356, 7.918333333333331, 6.188999999999999, 8.064666666666666, 7.365666666666665, 9.283333333333333, 7.109666666666666, 12.001333333333337, 7.383000000000001, 6.898999999999999, 8.628333333333332, 8.596, 7.939333333333333, 10.169666666666664, 8.650666666666666, 8.097], "episode_lengths": [15, 19, 14, 14, 17, 19, 16, 17, 30, 19, 16, 28, 20, 16, 25, 27, 18, 16, 18, 14, 18, 14, 14, 23, 21, 14, 14, 24, 17, 31, 21, 17, 15, 25, 19, 20, 18, 22, 17, 16, 16, 20, 18, 17, 19, 22, 13, 18, 20, 22, 25, 13, 16, 18, 20, 21, 15, 23, 18, 16, 19, 16, 17, 17, 16, 16, 21, 16, 17, 17, 25, 19, 21, 15, 17, 20, 14, 19, 18, 23, 16, 18, 23, 20, 20, 17, 14, 16, 16, 20, 16, 27, 16, 16, 17, 18, 18, 22, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5666727564904057, "mean_inference_ms": 2.8204527741208576, "mean_action_processing_ms": 0.5864954928295323, "mean_env_wait_ms": 0.14216755301142808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03456258773803711, "StateBufferConnector_ms": 0.022128820419311523, "ViewRequirementAgentConnector_ms": 0.5836505889892578}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47600, "num_agent_steps_trained": 47600, "num_env_steps_sampled": 47600, "num_env_steps_trained": 47600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1099.307057662822, "num_env_steps_trained_throughput_per_sec": 1099.307057662822, "timesteps_total": 47600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 47600, "timers": {"training_iteration_time_ms": 1104.672, "sample_time_ms": 1068.24, "load_time_ms": 0.598, "load_throughput": 2342906.117, "learn_time_ms": 14.278, "learn_throughput": 98051.594, "synch_weights_time_ms": 21.39}, "counters": {"num_env_steps_sampled": 47600, "num_env_steps_trained": 47600, "num_agent_steps_sampled": 47600, "num_agent_steps_trained": 47600}, "done": false, "episodes_total": 2528, "training_iteration": 34, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-35", "timestamp": 1702021175, "time_this_iter_s": 1.3155670166015625, "time_total_s": 39.13254475593567, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.13254475593567, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 98.35, "ram_util_percent": 98.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0975334644317627, "total_loss": 1.0975334644317627, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 49000, "num_env_steps_trained": 49000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 49000}, "sampler_results": {"episode_reward_max": 13.286999999999999, "episode_reward_min": 5.821, "episode_reward_mean": 8.623679999999998, "episode_len_mean": 18.34, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.802666666666669, 8.163, 11.771, 6.827999999999998, 8.070666666666666, 10.666999999999998, 8.441666666666663, 9.356, 7.918333333333331, 6.188999999999999, 8.064666666666666, 7.365666666666665, 9.283333333333333, 7.109666666666666, 12.001333333333337, 7.383000000000001, 6.898999999999999, 8.628333333333332, 8.596, 7.939333333333333, 10.169666666666664, 8.650666666666666, 8.097, 8.972333333333333, 10.275999999999998, 9.800999999999998, 9.764999999999993, 6.575333333333333, 7.043999999999998, 9.720666666666663, 6.600666666666665, 6.4113333333333316, 8.998333333333333, 8.861999999999998, 9.147, 9.18133333333333, 10.681999999999999, 7.8756666666666675, 8.586333333333334, 9.154666666666664, 6.679333333333334, 9.023333333333332, 9.479, 8.243999999999998, 8.272, 8.816333333333333, 8.803666666666665, 8.538999999999998, 8.073666666666666, 9.887333333333329, 13.286999999999999, 7.402666666666665, 8.637999999999998, 9.34, 10.741333333333333, 6.329666666666665, 8.821, 6.858666666666666, 8.97033333333333, 12.033666666666667, 8.376999999999999, 8.220666666666666, 8.601333333333331, 7.914666666666665, 7.924999999999998, 8.436666666666667, 8.78933333333333, 7.009999999999998, 11.050666666666665, 6.889999999999998, 10.263666666666671, 9.057999999999998, 11.961, 9.822999999999997, 7.047999999999999, 9.228333333333335, 6.746333333333332, 7.130333333333333, 8.98, 8.543999999999999, 7.243666666666667, 9.928999999999998, 6.689333333333333, 7.783666666666667, 8.57333333333333, 9.506666666666668, 9.656666666666663, 8.856333333333332, 7.758333333333332, 5.821, 10.891666666666664, 9.451666666666664, 10.298666666666666, 8.471333333333334, 7.9926666666666675, 7.467333333333332, 9.06333333333333, 8.329666666666665, 7.7559999999999985, 6.540999999999999], "episode_lengths": [19, 18, 23, 16, 18, 23, 20, 20, 17, 14, 16, 16, 20, 16, 27, 16, 16, 17, 18, 18, 22, 16, 17, 20, 24, 21, 20, 14, 14, 21, 14, 15, 18, 17, 17, 22, 20, 17, 20, 21, 14, 18, 20, 17, 18, 18, 18, 16, 18, 19, 24, 15, 18, 19, 22, 14, 20, 15, 19, 24, 19, 17, 20, 18, 17, 17, 18, 15, 20, 15, 22, 18, 26, 20, 17, 22, 15, 16, 20, 18, 15, 22, 14, 16, 20, 20, 21, 20, 17, 13, 21, 19, 22, 19, 18, 16, 20, 16, 17, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.576155601817564, "mean_inference_ms": 2.8520612937042324, "mean_action_processing_ms": 0.590500959623559, "mean_env_wait_ms": 0.14396200263395706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027272939682006836, "StateBufferConnector_ms": 0.01660609245300293, "ViewRequirementAgentConnector_ms": 0.5354530811309814}}, "episode_reward_max": 13.286999999999999, "episode_reward_min": 5.821, "episode_reward_mean": 8.623679999999998, "episode_len_mean": 18.34, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.802666666666669, 8.163, 11.771, 6.827999999999998, 8.070666666666666, 10.666999999999998, 8.441666666666663, 9.356, 7.918333333333331, 6.188999999999999, 8.064666666666666, 7.365666666666665, 9.283333333333333, 7.109666666666666, 12.001333333333337, 7.383000000000001, 6.898999999999999, 8.628333333333332, 8.596, 7.939333333333333, 10.169666666666664, 8.650666666666666, 8.097, 8.972333333333333, 10.275999999999998, 9.800999999999998, 9.764999999999993, 6.575333333333333, 7.043999999999998, 9.720666666666663, 6.600666666666665, 6.4113333333333316, 8.998333333333333, 8.861999999999998, 9.147, 9.18133333333333, 10.681999999999999, 7.8756666666666675, 8.586333333333334, 9.154666666666664, 6.679333333333334, 9.023333333333332, 9.479, 8.243999999999998, 8.272, 8.816333333333333, 8.803666666666665, 8.538999999999998, 8.073666666666666, 9.887333333333329, 13.286999999999999, 7.402666666666665, 8.637999999999998, 9.34, 10.741333333333333, 6.329666666666665, 8.821, 6.858666666666666, 8.97033333333333, 12.033666666666667, 8.376999999999999, 8.220666666666666, 8.601333333333331, 7.914666666666665, 7.924999999999998, 8.436666666666667, 8.78933333333333, 7.009999999999998, 11.050666666666665, 6.889999999999998, 10.263666666666671, 9.057999999999998, 11.961, 9.822999999999997, 7.047999999999999, 9.228333333333335, 6.746333333333332, 7.130333333333333, 8.98, 8.543999999999999, 7.243666666666667, 9.928999999999998, 6.689333333333333, 7.783666666666667, 8.57333333333333, 9.506666666666668, 9.656666666666663, 8.856333333333332, 7.758333333333332, 5.821, 10.891666666666664, 9.451666666666664, 10.298666666666666, 8.471333333333334, 7.9926666666666675, 7.467333333333332, 9.06333333333333, 8.329666666666665, 7.7559999999999985, 6.540999999999999], "episode_lengths": [19, 18, 23, 16, 18, 23, 20, 20, 17, 14, 16, 16, 20, 16, 27, 16, 16, 17, 18, 18, 22, 16, 17, 20, 24, 21, 20, 14, 14, 21, 14, 15, 18, 17, 17, 22, 20, 17, 20, 21, 14, 18, 20, 17, 18, 18, 18, 16, 18, 19, 24, 15, 18, 19, 22, 14, 20, 15, 19, 24, 19, 17, 20, 18, 17, 17, 18, 15, 20, 15, 22, 18, 26, 20, 17, 22, 15, 16, 20, 18, 15, 22, 14, 16, 20, 20, 21, 20, 17, 13, 21, 19, 22, 19, 18, 16, 20, 16, 17, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.576155601817564, "mean_inference_ms": 2.8520612937042324, "mean_action_processing_ms": 0.590500959623559, "mean_env_wait_ms": 0.14396200263395706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027272939682006836, "StateBufferConnector_ms": 0.01660609245300293, "ViewRequirementAgentConnector_ms": 0.5354530811309814}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 49000, "num_env_steps_sampled": 49000, "num_env_steps_trained": 49000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 919.8831916361177, "num_env_steps_trained_throughput_per_sec": 919.8831916361177, "timesteps_total": 49000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 49000, "timers": {"training_iteration_time_ms": 1168.124, "sample_time_ms": 1131.33, "load_time_ms": 0.599, "load_throughput": 2336194.788, "learn_time_ms": 14.619, "learn_throughput": 95764.738, "synch_weights_time_ms": 21.576}, "counters": {"num_env_steps_sampled": 49000, "num_env_steps_trained": 49000, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 49000}, "done": false, "episodes_total": 2605, "training_iteration": 35, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-37", "timestamp": 1702021177, "time_this_iter_s": 1.5532658100128174, "time_total_s": 40.685810565948486, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 40.685810565948486, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 100.0, "ram_util_percent": 99.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0981637239456177, "total_loss": 1.0981637239456177, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "sampler_results": {"episode_reward_max": 12.195999999999996, "episode_reward_min": 5.821, "episode_reward_mean": 8.499196666666666, "episode_len_mean": 18.15, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.746333333333332, 7.130333333333333, 8.98, 8.543999999999999, 7.243666666666667, 9.928999999999998, 6.689333333333333, 7.783666666666667, 8.57333333333333, 9.506666666666668, 9.656666666666663, 8.856333333333332, 7.758333333333332, 5.821, 10.891666666666664, 9.451666666666664, 10.298666666666666, 8.471333333333334, 7.9926666666666675, 7.467333333333332, 9.06333333333333, 8.329666666666665, 7.7559999999999985, 6.540999999999999, 7.619, 10.002999999999998, 8.533666666666665, 7.656666666666665, 8.117999999999999, 11.401999999999996, 7.081, 8.416999999999998, 11.326666666666668, 8.458999999999998, 10.685333333333332, 7.56233333333333, 7.799999999999998, 11.227999999999993, 9.03633333333333, 8.028666666666666, 6.326666666666666, 7.6916666666666655, 12.195999999999996, 9.521333333333331, 6.131333333333334, 7.342, 8.632666666666665, 6.266333333333333, 9.262999999999998, 6.362666666666666, 7.8660000000000005, 7.627666666666667, 12.151999999999997, 8.259, 7.614999999999999, 8.741666666666665, 9.394333333333332, 8.656, 8.475666666666664, 6.546333333333332, 10.660666666666668, 8.819666666666665, 8.935666666666664, 7.681999999999998, 7.746666666666668, 11.863666666666667, 8.681666666666665, 8.254999999999997, 8.776666666666667, 6.396333333333334, 6.494999999999999, 9.767333333333331, 6.899999999999999, 7.725666666666666, 8.804, 7.871333333333331, 6.333666666666668, 10.97433333333333, 7.760999999999998, 8.737333333333332, 10.945333333333329, 8.295666666666666, 9.227333333333332, 7.729999999999996, 8.723666666666666, 8.135333333333332, 8.386999999999999, 11.188333333333333, 8.239999999999997, 6.668333333333332, 7.141666666666666, 8.403999999999998, 9.18, 8.562333333333333, 8.794666666666664, 8.693333333333333, 7.948666666666665, 9.96533333333333, 9.562, 7.432999999999999], "episode_lengths": [15, 16, 20, 18, 15, 22, 14, 16, 20, 20, 21, 20, 17, 13, 21, 19, 22, 19, 18, 16, 20, 16, 17, 14, 17, 20, 19, 15, 17, 23, 15, 18, 21, 19, 23, 18, 16, 23, 21, 18, 13, 17, 25, 21, 14, 17, 17, 15, 20, 14, 16, 16, 23, 20, 17, 18, 21, 21, 18, 13, 22, 19, 19, 17, 17, 23, 20, 17, 20, 14, 15, 20, 16, 19, 16, 19, 14, 21, 17, 18, 20, 19, 18, 20, 18, 16, 18, 22, 19, 14, 15, 16, 19, 18, 20, 19, 17, 20, 21, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.583603990167843, "mean_inference_ms": 2.8874740849036846, "mean_action_processing_ms": 0.5935927544082918, "mean_env_wait_ms": 0.14510748875828758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026737213134765625, "StateBufferConnector_ms": 0.027657747268676758, "ViewRequirementAgentConnector_ms": 0.5240271091461182}}, "episode_reward_max": 12.195999999999996, "episode_reward_min": 5.821, "episode_reward_mean": 8.499196666666666, "episode_len_mean": 18.15, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.746333333333332, 7.130333333333333, 8.98, 8.543999999999999, 7.243666666666667, 9.928999999999998, 6.689333333333333, 7.783666666666667, 8.57333333333333, 9.506666666666668, 9.656666666666663, 8.856333333333332, 7.758333333333332, 5.821, 10.891666666666664, 9.451666666666664, 10.298666666666666, 8.471333333333334, 7.9926666666666675, 7.467333333333332, 9.06333333333333, 8.329666666666665, 7.7559999999999985, 6.540999999999999, 7.619, 10.002999999999998, 8.533666666666665, 7.656666666666665, 8.117999999999999, 11.401999999999996, 7.081, 8.416999999999998, 11.326666666666668, 8.458999999999998, 10.685333333333332, 7.56233333333333, 7.799999999999998, 11.227999999999993, 9.03633333333333, 8.028666666666666, 6.326666666666666, 7.6916666666666655, 12.195999999999996, 9.521333333333331, 6.131333333333334, 7.342, 8.632666666666665, 6.266333333333333, 9.262999999999998, 6.362666666666666, 7.8660000000000005, 7.627666666666667, 12.151999999999997, 8.259, 7.614999999999999, 8.741666666666665, 9.394333333333332, 8.656, 8.475666666666664, 6.546333333333332, 10.660666666666668, 8.819666666666665, 8.935666666666664, 7.681999999999998, 7.746666666666668, 11.863666666666667, 8.681666666666665, 8.254999999999997, 8.776666666666667, 6.396333333333334, 6.494999999999999, 9.767333333333331, 6.899999999999999, 7.725666666666666, 8.804, 7.871333333333331, 6.333666666666668, 10.97433333333333, 7.760999999999998, 8.737333333333332, 10.945333333333329, 8.295666666666666, 9.227333333333332, 7.729999999999996, 8.723666666666666, 8.135333333333332, 8.386999999999999, 11.188333333333333, 8.239999999999997, 6.668333333333332, 7.141666666666666, 8.403999999999998, 9.18, 8.562333333333333, 8.794666666666664, 8.693333333333333, 7.948666666666665, 9.96533333333333, 9.562, 7.432999999999999], "episode_lengths": [15, 16, 20, 18, 15, 22, 14, 16, 20, 20, 21, 20, 17, 13, 21, 19, 22, 19, 18, 16, 20, 16, 17, 14, 17, 20, 19, 15, 17, 23, 15, 18, 21, 19, 23, 18, 16, 23, 21, 18, 13, 17, 25, 21, 14, 17, 17, 15, 20, 14, 16, 16, 23, 20, 17, 18, 21, 21, 18, 13, 22, 19, 19, 17, 17, 23, 20, 17, 20, 14, 15, 20, 16, 19, 16, 19, 14, 21, 17, 18, 20, 19, 18, 20, 18, 16, 18, 22, 19, 14, 15, 16, 19, 18, 20, 19, 17, 20, 21, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.583603990167843, "mean_inference_ms": 2.8874740849036846, "mean_action_processing_ms": 0.5935927544082918, "mean_env_wait_ms": 0.14510748875828758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026737213134765625, "StateBufferConnector_ms": 0.027657747268676758, "ViewRequirementAgentConnector_ms": 0.5240271091461182}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 939.3030216408266, "num_env_steps_trained_throughput_per_sec": 939.3030216408266, "timesteps_total": 50400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 50400, "timers": {"training_iteration_time_ms": 1193.212, "sample_time_ms": 1156.432, "load_time_ms": 0.697, "load_throughput": 2008285.372, "learn_time_ms": 14.186, "learn_throughput": 98689.672, "synch_weights_time_ms": 21.898}, "counters": {"num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "done": false, "episodes_total": 2681, "training_iteration": 36, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-38", "timestamp": 1702021178, "time_this_iter_s": 1.525467872619629, "time_total_s": 42.211278438568115, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 42.211278438568115, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.35, "ram_util_percent": 98.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0952818393707275, "total_loss": 1.0952818393707275, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 51800, "num_env_steps_trained": 51800, "num_agent_steps_sampled": 51800, "num_agent_steps_trained": 51800}, "sampler_results": {"episode_reward_max": 17.282666666666657, "episode_reward_min": 5.925333333333333, "episode_reward_mean": 8.74089, "episode_len_mean": 18.65, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.804, 7.871333333333331, 6.333666666666668, 10.97433333333333, 7.760999999999998, 8.737333333333332, 10.945333333333329, 8.295666666666666, 9.227333333333332, 7.729999999999996, 8.723666666666666, 8.135333333333332, 8.386999999999999, 11.188333333333333, 8.239999999999997, 6.668333333333332, 7.141666666666666, 8.403999999999998, 9.18, 8.562333333333333, 8.794666666666664, 8.693333333333333, 7.948666666666665, 9.96533333333333, 9.562, 7.432999999999999, 7.733666666666666, 9.417333333333334, 9.181999999999997, 10.143666666666663, 7.335666666666666, 12.019666666666664, 9.349, 8.87133333333333, 10.543999999999995, 8.411333333333332, 7.505666666666665, 8.561666666666666, 6.764666666666665, 8.463999999999997, 5.925333333333333, 10.113, 8.794333333333332, 12.48133333333333, 8.738666666666667, 7.063999999999998, 9.144, 9.563666666666665, 9.961333333333332, 9.048000000000002, 6.880666666666667, 7.992333333333334, 9.29733333333333, 8.426333333333332, 10.444666666666665, 6.855333333333333, 6.922666666666667, 10.374333333333333, 8.768666666666665, 10.862, 7.368333333333332, 7.623333333333332, 9.062666666666665, 8.309666666666667, 9.709999999999996, 7.561666666666666, 10.780333333333331, 8.657666666666666, 7.24, 10.292000000000002, 12.369666666666667, 7.265333333333334, 17.282666666666657, 8.562666666666665, 6.570000000000001, 7.498333333333332, 8.740666666666664, 6.988333333333333, 7.536333333333332, 10.588666666666667, 9.545999999999998, 9.558666666666666, 7.202666666666665, 9.669666666666664, 8.654666666666666, 8.248666666666667, 7.158, 6.9593333333333325, 10.159, 6.3456666666666655, 7.415999999999998, 8.952666666666667, 9.03833333333333, 10.290333333333333, 9.053999999999998, 6.791666666666667, 8.791, 7.042333333333333, 7.711666666666666, 9.820999999999998], "episode_lengths": [16, 19, 14, 21, 17, 18, 20, 19, 18, 20, 18, 16, 18, 22, 19, 14, 15, 16, 19, 18, 20, 19, 17, 20, 21, 15, 20, 19, 19, 22, 16, 25, 21, 17, 22, 21, 16, 17, 16, 17, 14, 21, 20, 24, 18, 17, 22, 20, 19, 20, 17, 18, 18, 19, 22, 14, 16, 23, 17, 22, 17, 17, 19, 18, 21, 17, 21, 18, 18, 21, 26, 16, 33, 18, 15, 15, 17, 16, 16, 21, 20, 21, 16, 19, 19, 18, 15, 15, 21, 16, 17, 19, 19, 22, 23, 15, 19, 16, 16, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5955983219861394, "mean_inference_ms": 2.9192254549223495, "mean_action_processing_ms": 0.5960684156535675, "mean_env_wait_ms": 0.14606771506657562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028429746627807617, "StateBufferConnector_ms": 0.045770883560180664, "ViewRequirementAgentConnector_ms": 0.700251579284668}}, "episode_reward_max": 17.282666666666657, "episode_reward_min": 5.925333333333333, "episode_reward_mean": 8.74089, "episode_len_mean": 18.65, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.804, 7.871333333333331, 6.333666666666668, 10.97433333333333, 7.760999999999998, 8.737333333333332, 10.945333333333329, 8.295666666666666, 9.227333333333332, 7.729999999999996, 8.723666666666666, 8.135333333333332, 8.386999999999999, 11.188333333333333, 8.239999999999997, 6.668333333333332, 7.141666666666666, 8.403999999999998, 9.18, 8.562333333333333, 8.794666666666664, 8.693333333333333, 7.948666666666665, 9.96533333333333, 9.562, 7.432999999999999, 7.733666666666666, 9.417333333333334, 9.181999999999997, 10.143666666666663, 7.335666666666666, 12.019666666666664, 9.349, 8.87133333333333, 10.543999999999995, 8.411333333333332, 7.505666666666665, 8.561666666666666, 6.764666666666665, 8.463999999999997, 5.925333333333333, 10.113, 8.794333333333332, 12.48133333333333, 8.738666666666667, 7.063999999999998, 9.144, 9.563666666666665, 9.961333333333332, 9.048000000000002, 6.880666666666667, 7.992333333333334, 9.29733333333333, 8.426333333333332, 10.444666666666665, 6.855333333333333, 6.922666666666667, 10.374333333333333, 8.768666666666665, 10.862, 7.368333333333332, 7.623333333333332, 9.062666666666665, 8.309666666666667, 9.709999999999996, 7.561666666666666, 10.780333333333331, 8.657666666666666, 7.24, 10.292000000000002, 12.369666666666667, 7.265333333333334, 17.282666666666657, 8.562666666666665, 6.570000000000001, 7.498333333333332, 8.740666666666664, 6.988333333333333, 7.536333333333332, 10.588666666666667, 9.545999999999998, 9.558666666666666, 7.202666666666665, 9.669666666666664, 8.654666666666666, 8.248666666666667, 7.158, 6.9593333333333325, 10.159, 6.3456666666666655, 7.415999999999998, 8.952666666666667, 9.03833333333333, 10.290333333333333, 9.053999999999998, 6.791666666666667, 8.791, 7.042333333333333, 7.711666666666666, 9.820999999999998], "episode_lengths": [16, 19, 14, 21, 17, 18, 20, 19, 18, 20, 18, 16, 18, 22, 19, 14, 15, 16, 19, 18, 20, 19, 17, 20, 21, 15, 20, 19, 19, 22, 16, 25, 21, 17, 22, 21, 16, 17, 16, 17, 14, 21, 20, 24, 18, 17, 22, 20, 19, 20, 17, 18, 18, 19, 22, 14, 16, 23, 17, 22, 17, 17, 19, 18, 21, 17, 21, 18, 18, 21, 26, 16, 33, 18, 15, 15, 17, 16, 16, 21, 20, 21, 16, 19, 19, 18, 15, 15, 21, 16, 17, 19, 19, 22, 23, 15, 19, 16, 16, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5955983219861394, "mean_inference_ms": 2.9192254549223495, "mean_action_processing_ms": 0.5960684156535675, "mean_env_wait_ms": 0.14606771506657562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028429746627807617, "StateBufferConnector_ms": 0.045770883560180664, "ViewRequirementAgentConnector_ms": 0.700251579284668}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51800, "num_agent_steps_trained": 51800, "num_env_steps_sampled": 51800, "num_env_steps_trained": 51800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 888.506345938256, "num_env_steps_trained_throughput_per_sec": 888.506345938256, "timesteps_total": 51800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 51800, "timers": {"training_iteration_time_ms": 1202.697, "sample_time_ms": 1164.285, "load_time_ms": 0.647, "load_throughput": 2164403.096, "learn_time_ms": 15.266, "learn_throughput": 91708.988, "synch_weights_time_ms": 22.5}, "counters": {"num_env_steps_sampled": 51800, "num_env_steps_trained": 51800, "num_agent_steps_sampled": 51800, "num_agent_steps_trained": 51800}, "done": false, "episodes_total": 2755, "training_iteration": 37, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-40", "timestamp": 1702021180, "time_this_iter_s": 1.6107177734375, "time_total_s": 43.821996212005615, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.821996212005615, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 97.05, "ram_util_percent": 98.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.095187783241272, "total_loss": 1.095187783241272, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 53200, "num_env_steps_trained": 53200, "num_agent_steps_sampled": 53200, "num_agent_steps_trained": 53200}, "sampler_results": {"episode_reward_max": 12.16133333333333, "episode_reward_min": 6.136000000000001, "episode_reward_mean": 8.667883333333332, "episode_len_mean": 18.53, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.740666666666664, 6.988333333333333, 7.536333333333332, 10.588666666666667, 9.545999999999998, 9.558666666666666, 7.202666666666665, 9.669666666666664, 8.654666666666666, 8.248666666666667, 7.158, 6.9593333333333325, 10.159, 6.3456666666666655, 7.415999999999998, 8.952666666666667, 9.03833333333333, 10.290333333333333, 9.053999999999998, 6.791666666666667, 8.791, 7.042333333333333, 7.711666666666666, 9.820999999999998, 8.767999999999999, 8.610666666666663, 11.391999999999998, 8.744333333333332, 10.471666666666664, 8.339333333333332, 9.850333333333332, 6.429999999999998, 10.832666666666665, 7.817666666666663, 6.4273333333333325, 8.331333333333333, 9.862333333333334, 8.83, 6.309333333333331, 9.626999999999999, 9.778666666666664, 7.434666666666666, 7.393999999999999, 9.040333333333333, 9.926, 11.96233333333333, 8.368333333333334, 11.497, 8.448666666666664, 6.929666666666666, 7.687333333333332, 9.062666666666665, 10.184000000000001, 7.470333333333331, 6.750000000000001, 6.542, 6.697, 9.532666666666664, 9.495666666666668, 8.918333333333331, 8.675666666666665, 8.954333333333333, 9.040666666666667, 9.24733333333333, 8.53833333333333, 9.422999999999998, 7.710333333333333, 7.414000000000001, 6.313666666666665, 8.838999999999995, 9.903333333333334, 8.673333333333332, 7.783333333333333, 10.545333333333335, 12.16133333333333, 7.892666666666667, 6.136000000000001, 9.908999999999999, 7.327666666666666, 9.628666666666666, 8.742666666666667, 7.447333333333331, 7.311333333333332, 9.883333333333333, 8.266666666666667, 6.810999999999998, 7.321999999999999, 9.132666666666665, 7.702666666666666, 8.959333333333333, 11.795666666666666, 11.838666666666665, 9.060333333333332, 9.261666666666668, 7.9096666666666655, 7.8553333333333315, 6.633333333333333, 10.945999999999996, 11.208666666666664, 8.553999999999998], "episode_lengths": [17, 16, 16, 21, 20, 21, 16, 19, 19, 18, 15, 15, 21, 16, 17, 19, 19, 22, 23, 15, 19, 16, 16, 21, 19, 17, 22, 21, 23, 17, 21, 14, 20, 18, 14, 18, 21, 17, 14, 21, 20, 15, 17, 20, 21, 24, 19, 25, 18, 16, 17, 17, 21, 17, 14, 15, 14, 20, 22, 19, 19, 20, 17, 19, 18, 19, 17, 15, 13, 19, 24, 18, 17, 22, 23, 17, 14, 23, 15, 20, 19, 15, 17, 21, 16, 16, 17, 17, 18, 22, 25, 23, 18, 23, 18, 16, 14, 20, 23, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6062941377277744, "mean_inference_ms": 2.9458735345267995, "mean_action_processing_ms": 0.5993458185000178, "mean_env_wait_ms": 0.14668084962609346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03038334846496582, "StateBufferConnector_ms": 0.03222775459289551, "ViewRequirementAgentConnector_ms": 0.6923794746398926}}, "episode_reward_max": 12.16133333333333, "episode_reward_min": 6.136000000000001, "episode_reward_mean": 8.667883333333332, "episode_len_mean": 18.53, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.740666666666664, 6.988333333333333, 7.536333333333332, 10.588666666666667, 9.545999999999998, 9.558666666666666, 7.202666666666665, 9.669666666666664, 8.654666666666666, 8.248666666666667, 7.158, 6.9593333333333325, 10.159, 6.3456666666666655, 7.415999999999998, 8.952666666666667, 9.03833333333333, 10.290333333333333, 9.053999999999998, 6.791666666666667, 8.791, 7.042333333333333, 7.711666666666666, 9.820999999999998, 8.767999999999999, 8.610666666666663, 11.391999999999998, 8.744333333333332, 10.471666666666664, 8.339333333333332, 9.850333333333332, 6.429999999999998, 10.832666666666665, 7.817666666666663, 6.4273333333333325, 8.331333333333333, 9.862333333333334, 8.83, 6.309333333333331, 9.626999999999999, 9.778666666666664, 7.434666666666666, 7.393999999999999, 9.040333333333333, 9.926, 11.96233333333333, 8.368333333333334, 11.497, 8.448666666666664, 6.929666666666666, 7.687333333333332, 9.062666666666665, 10.184000000000001, 7.470333333333331, 6.750000000000001, 6.542, 6.697, 9.532666666666664, 9.495666666666668, 8.918333333333331, 8.675666666666665, 8.954333333333333, 9.040666666666667, 9.24733333333333, 8.53833333333333, 9.422999999999998, 7.710333333333333, 7.414000000000001, 6.313666666666665, 8.838999999999995, 9.903333333333334, 8.673333333333332, 7.783333333333333, 10.545333333333335, 12.16133333333333, 7.892666666666667, 6.136000000000001, 9.908999999999999, 7.327666666666666, 9.628666666666666, 8.742666666666667, 7.447333333333331, 7.311333333333332, 9.883333333333333, 8.266666666666667, 6.810999999999998, 7.321999999999999, 9.132666666666665, 7.702666666666666, 8.959333333333333, 11.795666666666666, 11.838666666666665, 9.060333333333332, 9.261666666666668, 7.9096666666666655, 7.8553333333333315, 6.633333333333333, 10.945999999999996, 11.208666666666664, 8.553999999999998], "episode_lengths": [17, 16, 16, 21, 20, 21, 16, 19, 19, 18, 15, 15, 21, 16, 17, 19, 19, 22, 23, 15, 19, 16, 16, 21, 19, 17, 22, 21, 23, 17, 21, 14, 20, 18, 14, 18, 21, 17, 14, 21, 20, 15, 17, 20, 21, 24, 19, 25, 18, 16, 17, 17, 21, 17, 14, 15, 14, 20, 22, 19, 19, 20, 17, 19, 18, 19, 17, 15, 13, 19, 24, 18, 17, 22, 23, 17, 14, 23, 15, 20, 19, 15, 17, 21, 16, 16, 17, 17, 18, 22, 25, 23, 18, 23, 18, 16, 14, 20, 23, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6062941377277744, "mean_inference_ms": 2.9458735345267995, "mean_action_processing_ms": 0.5993458185000178, "mean_env_wait_ms": 0.14668084962609346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03038334846496582, "StateBufferConnector_ms": 0.03222775459289551, "ViewRequirementAgentConnector_ms": 0.6923794746398926}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53200, "num_agent_steps_trained": 53200, "num_env_steps_sampled": 53200, "num_env_steps_trained": 53200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 967.913382679338, "num_env_steps_trained_throughput_per_sec": 967.913382679338, "timesteps_total": 53200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 53200, "timers": {"training_iteration_time_ms": 1232.608, "sample_time_ms": 1192.606, "load_time_ms": 0.682, "load_throughput": 2054161.338, "learn_time_ms": 16.56, "learn_throughput": 84543.466, "synch_weights_time_ms": 22.661}, "counters": {"num_env_steps_sampled": 53200, "num_env_steps_trained": 53200, "num_agent_steps_sampled": 53200, "num_agent_steps_trained": 53200}, "done": false, "episodes_total": 2831, "training_iteration": 38, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-42", "timestamp": 1702021182, "time_this_iter_s": 1.478510856628418, "time_total_s": 45.30050706863403, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 45.30050706863403, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 98.8, "ram_util_percent": 99.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0961841344833374, "total_loss": 1.0961841344833374, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "sampler_results": {"episode_reward_max": 12.640333333333336, "episode_reward_min": 6.136000000000001, "episode_reward_mean": 8.668383333333331, "episode_len_mean": 18.66, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.892666666666667, 6.136000000000001, 9.908999999999999, 7.327666666666666, 9.628666666666666, 8.742666666666667, 7.447333333333331, 7.311333333333332, 9.883333333333333, 8.266666666666667, 6.810999999999998, 7.321999999999999, 9.132666666666665, 7.702666666666666, 8.959333333333333, 11.795666666666666, 11.838666666666665, 9.060333333333332, 9.261666666666668, 7.9096666666666655, 7.8553333333333315, 6.633333333333333, 10.945999999999996, 11.208666666666664, 8.553999999999998, 11.767000000000001, 7.822666666666666, 9.902333333333331, 7.355, 8.869, 9.073666666666664, 8.71133333333333, 6.892999999999998, 12.640333333333336, 10.861666666666665, 10.32933333333333, 9.558, 8.179333333333332, 9.37266666666667, 10.126666666666665, 9.141999999999998, 9.491999999999999, 11.851666666666667, 8.15333333333333, 6.472333333333333, 7.372, 8.318999999999999, 6.2443333333333335, 11.328999999999999, 7.0826666666666656, 8.578666666666667, 7.136666666666665, 8.570666666666666, 9.132666666666665, 9.139333333333333, 7.225333333333332, 8.685999999999998, 6.595333333333333, 7.9380000000000015, 10.077666666666664, 7.558999999999998, 9.768666666666663, 6.184666666666665, 8.805333333333333, 7.938666666666667, 8.643666666666665, 9.405666666666667, 10.441, 8.426333333333332, 8.370333333333333, 9.019999999999998, 8.330333333333332, 7.573, 8.536666666666667, 8.769333333333332, 6.792333333333332, 8.258999999999999, 11.043333333333335, 6.200666666666666, 7.346, 8.131666666666666, 7.9193333333333324, 11.414333333333333, 7.900333333333331, 6.457666666666666, 8.26933333333333, 7.152666666666665, 8.540333333333331, 6.76, 6.540333333333333, 9.404999999999998, 7.3966666666666665, 12.130333333333333, 8.834666666666665, 7.799666666666666, 10.000666666666667, 9.189999999999998, 8.925666666666665, 10.10433333333333, 9.014333333333333], "episode_lengths": [17, 14, 23, 15, 20, 19, 15, 17, 21, 16, 16, 17, 17, 18, 22, 25, 23, 18, 23, 18, 16, 14, 20, 23, 21, 23, 16, 21, 17, 21, 18, 21, 14, 24, 24, 24, 21, 16, 21, 20, 18, 19, 22, 20, 15, 16, 17, 16, 23, 14, 19, 15, 20, 19, 18, 15, 17, 14, 17, 20, 16, 20, 15, 18, 17, 18, 21, 21, 17, 20, 17, 21, 17, 20, 20, 16, 20, 24, 14, 17, 18, 18, 24, 18, 16, 17, 15, 19, 15, 16, 18, 15, 26, 20, 17, 23, 20, 19, 21, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6101341503084643, "mean_inference_ms": 2.9524533946375606, "mean_action_processing_ms": 0.6016006432431225, "mean_env_wait_ms": 0.1468032635475445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02584695816040039, "StateBufferConnector_ms": 0.010244131088256836, "ViewRequirementAgentConnector_ms": 0.5664563179016113}}, "episode_reward_max": 12.640333333333336, "episode_reward_min": 6.136000000000001, "episode_reward_mean": 8.668383333333331, "episode_len_mean": 18.66, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.892666666666667, 6.136000000000001, 9.908999999999999, 7.327666666666666, 9.628666666666666, 8.742666666666667, 7.447333333333331, 7.311333333333332, 9.883333333333333, 8.266666666666667, 6.810999999999998, 7.321999999999999, 9.132666666666665, 7.702666666666666, 8.959333333333333, 11.795666666666666, 11.838666666666665, 9.060333333333332, 9.261666666666668, 7.9096666666666655, 7.8553333333333315, 6.633333333333333, 10.945999999999996, 11.208666666666664, 8.553999999999998, 11.767000000000001, 7.822666666666666, 9.902333333333331, 7.355, 8.869, 9.073666666666664, 8.71133333333333, 6.892999999999998, 12.640333333333336, 10.861666666666665, 10.32933333333333, 9.558, 8.179333333333332, 9.37266666666667, 10.126666666666665, 9.141999999999998, 9.491999999999999, 11.851666666666667, 8.15333333333333, 6.472333333333333, 7.372, 8.318999999999999, 6.2443333333333335, 11.328999999999999, 7.0826666666666656, 8.578666666666667, 7.136666666666665, 8.570666666666666, 9.132666666666665, 9.139333333333333, 7.225333333333332, 8.685999999999998, 6.595333333333333, 7.9380000000000015, 10.077666666666664, 7.558999999999998, 9.768666666666663, 6.184666666666665, 8.805333333333333, 7.938666666666667, 8.643666666666665, 9.405666666666667, 10.441, 8.426333333333332, 8.370333333333333, 9.019999999999998, 8.330333333333332, 7.573, 8.536666666666667, 8.769333333333332, 6.792333333333332, 8.258999999999999, 11.043333333333335, 6.200666666666666, 7.346, 8.131666666666666, 7.9193333333333324, 11.414333333333333, 7.900333333333331, 6.457666666666666, 8.26933333333333, 7.152666666666665, 8.540333333333331, 6.76, 6.540333333333333, 9.404999999999998, 7.3966666666666665, 12.130333333333333, 8.834666666666665, 7.799666666666666, 10.000666666666667, 9.189999999999998, 8.925666666666665, 10.10433333333333, 9.014333333333333], "episode_lengths": [17, 14, 23, 15, 20, 19, 15, 17, 21, 16, 16, 17, 17, 18, 22, 25, 23, 18, 23, 18, 16, 14, 20, 23, 21, 23, 16, 21, 17, 21, 18, 21, 14, 24, 24, 24, 21, 16, 21, 20, 18, 19, 22, 20, 15, 16, 17, 16, 23, 14, 19, 15, 20, 19, 18, 15, 17, 14, 17, 20, 16, 20, 15, 18, 17, 18, 21, 21, 17, 20, 17, 21, 17, 20, 20, 16, 20, 24, 14, 17, 18, 18, 24, 18, 16, 17, 15, 19, 15, 16, 18, 15, 26, 20, 17, 23, 20, 19, 21, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6101341503084643, "mean_inference_ms": 2.9524533946375606, "mean_action_processing_ms": 0.6016006432431225, "mean_env_wait_ms": 0.1468032635475445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02584695816040039, "StateBufferConnector_ms": 0.010244131088256836, "ViewRequirementAgentConnector_ms": 0.5664563179016113}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1113.516479953093, "num_env_steps_trained_throughput_per_sec": 1113.516479953093, "timesteps_total": 54600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 54600, "timers": {"training_iteration_time_ms": 1271.692, "sample_time_ms": 1229.546, "load_time_ms": 0.782, "load_throughput": 1790961.54, "learn_time_ms": 17.458, "learn_throughput": 80190.446, "synch_weights_time_ms": 23.805}, "counters": {"num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "done": false, "episodes_total": 2906, "training_iteration": 39, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-43", "timestamp": 1702021183, "time_this_iter_s": 1.3096749782562256, "time_total_s": 46.61018204689026, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 46.61018204689026, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 99.5, "ram_util_percent": 99.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0954747200012207, "total_loss": 1.0954747200012207, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 12.970333333333333, "episode_reward_min": 5.7653333333333325, "episode_reward_mean": 8.442326666666666, "episode_len_mean": 18.27, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.258999999999999, 11.043333333333335, 6.200666666666666, 7.346, 8.131666666666666, 7.9193333333333324, 11.414333333333333, 7.900333333333331, 6.457666666666666, 8.26933333333333, 7.152666666666665, 8.540333333333331, 6.76, 6.540333333333333, 9.404999999999998, 7.3966666666666665, 12.130333333333333, 8.834666666666665, 7.799666666666666, 10.000666666666667, 9.189999999999998, 8.925666666666665, 10.10433333333333, 9.014333333333333, 10.476999999999999, 10.261666666666665, 7.334666666666667, 10.374666666666666, 7.429666666666667, 7.043333333333332, 6.409666666666666, 8.511333333333333, 8.433999999999997, 6.1933333333333325, 7.079, 9.564333333333334, 10.151333333333332, 9.372666666666666, 8.435999999999998, 9.657999999999998, 9.204333333333329, 8.337333333333332, 8.009333333333332, 8.549333333333333, 7.7286666666666655, 12.970333333333333, 10.295333333333332, 6.970666666666665, 8.93533333333333, 11.464666666666666, 8.036666666666664, 7.9286666666666665, 8.77433333333333, 7.4239999999999995, 7.2863333333333316, 10.612999999999998, 10.84066666666666, 10.312333333333333, 7.6179999999999986, 7.399, 7.501999999999998, 6.856999999999999, 8.319666666666667, 6.990666666666666, 9.327, 8.112666666666662, 7.88, 8.745666666666668, 8.716000000000001, 9.815666666666667, 6.906666666666666, 9.738, 5.7653333333333325, 7.258333333333334, 7.852666666666664, 7.276333333333333, 10.998333333333328, 5.966666666666666, 7.682, 9.611333333333333, 6.790999999999999, 6.225, 7.247333333333333, 7.595999999999998, 6.956999999999999, 8.493333333333332, 8.318666666666665, 6.693999999999998, 10.175333333333334, 7.801999999999998, 7.9306666666666645, 8.587333333333332, 8.001999999999999, 6.943, 10.476333333333333, 10.982666666666667, 6.775666666666667, 7.7780000000000005, 9.610666666666665, 9.359333333333332], "episode_lengths": [20, 24, 14, 17, 18, 18, 24, 18, 16, 17, 15, 19, 15, 16, 18, 15, 26, 20, 17, 23, 20, 19, 21, 19, 22, 22, 17, 20, 16, 17, 13, 18, 17, 14, 17, 20, 23, 21, 19, 22, 19, 18, 17, 18, 17, 27, 23, 15, 21, 22, 21, 16, 20, 16, 16, 19, 21, 22, 18, 16, 16, 16, 16, 14, 20, 18, 19, 19, 17, 23, 16, 22, 14, 15, 21, 16, 21, 13, 16, 20, 15, 14, 15, 17, 14, 20, 16, 14, 19, 16, 16, 18, 16, 19, 21, 25, 16, 16, 20, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6181140179231845, "mean_inference_ms": 2.9622793151375064, "mean_action_processing_ms": 0.6052686356987125, "mean_env_wait_ms": 0.1466122400354781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021314382553100586, "StateBufferConnector_ms": 0.03266191482543945, "ViewRequirementAgentConnector_ms": 0.7100696563720703}}, "episode_reward_max": 12.970333333333333, "episode_reward_min": 5.7653333333333325, "episode_reward_mean": 8.442326666666666, "episode_len_mean": 18.27, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.258999999999999, 11.043333333333335, 6.200666666666666, 7.346, 8.131666666666666, 7.9193333333333324, 11.414333333333333, 7.900333333333331, 6.457666666666666, 8.26933333333333, 7.152666666666665, 8.540333333333331, 6.76, 6.540333333333333, 9.404999999999998, 7.3966666666666665, 12.130333333333333, 8.834666666666665, 7.799666666666666, 10.000666666666667, 9.189999999999998, 8.925666666666665, 10.10433333333333, 9.014333333333333, 10.476999999999999, 10.261666666666665, 7.334666666666667, 10.374666666666666, 7.429666666666667, 7.043333333333332, 6.409666666666666, 8.511333333333333, 8.433999999999997, 6.1933333333333325, 7.079, 9.564333333333334, 10.151333333333332, 9.372666666666666, 8.435999999999998, 9.657999999999998, 9.204333333333329, 8.337333333333332, 8.009333333333332, 8.549333333333333, 7.7286666666666655, 12.970333333333333, 10.295333333333332, 6.970666666666665, 8.93533333333333, 11.464666666666666, 8.036666666666664, 7.9286666666666665, 8.77433333333333, 7.4239999999999995, 7.2863333333333316, 10.612999999999998, 10.84066666666666, 10.312333333333333, 7.6179999999999986, 7.399, 7.501999999999998, 6.856999999999999, 8.319666666666667, 6.990666666666666, 9.327, 8.112666666666662, 7.88, 8.745666666666668, 8.716000000000001, 9.815666666666667, 6.906666666666666, 9.738, 5.7653333333333325, 7.258333333333334, 7.852666666666664, 7.276333333333333, 10.998333333333328, 5.966666666666666, 7.682, 9.611333333333333, 6.790999999999999, 6.225, 7.247333333333333, 7.595999999999998, 6.956999999999999, 8.493333333333332, 8.318666666666665, 6.693999999999998, 10.175333333333334, 7.801999999999998, 7.9306666666666645, 8.587333333333332, 8.001999999999999, 6.943, 10.476333333333333, 10.982666666666667, 6.775666666666667, 7.7780000000000005, 9.610666666666665, 9.359333333333332], "episode_lengths": [20, 24, 14, 17, 18, 18, 24, 18, 16, 17, 15, 19, 15, 16, 18, 15, 26, 20, 17, 23, 20, 19, 21, 19, 22, 22, 17, 20, 16, 17, 13, 18, 17, 14, 17, 20, 23, 21, 19, 22, 19, 18, 17, 18, 17, 27, 23, 15, 21, 22, 21, 16, 20, 16, 16, 19, 21, 22, 18, 16, 16, 16, 16, 14, 20, 18, 19, 19, 17, 23, 16, 22, 14, 15, 21, 16, 21, 13, 16, 20, 15, 14, 15, 17, 14, 20, 16, 14, 19, 16, 16, 18, 16, 19, 21, 25, 16, 16, 20, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6181140179231845, "mean_inference_ms": 2.9622793151375064, "mean_action_processing_ms": 0.6052686356987125, "mean_env_wait_ms": 0.1466122400354781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021314382553100586, "StateBufferConnector_ms": 0.03266191482543945, "ViewRequirementAgentConnector_ms": 0.7100696563720703}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 999.3016831318713, "num_env_steps_trained_throughput_per_sec": 999.3016831318713, "timesteps_total": 56000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 1310.423, "sample_time_ms": 1268.472, "load_time_ms": 0.682, "load_throughput": 2052151.255, "learn_time_ms": 17.554, "learn_throughput": 79755.216, "synch_weights_time_ms": 23.615}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 2982, "training_iteration": 40, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-44", "timestamp": 1702021184, "time_this_iter_s": 1.4228816032409668, "time_total_s": 48.033063650131226, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.033063650131226, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 98.25, "ram_util_percent": 99.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0977684259414673, "total_loss": 1.0977684259414673, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 57400, "num_env_steps_trained": 57400, "num_agent_steps_sampled": 57400, "num_agent_steps_trained": 57400}, "sampler_results": {"episode_reward_max": 14.980333333333332, "episode_reward_min": 5.8196666666666665, "episode_reward_mean": 8.616649999999998, "episode_len_mean": 18.28, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.998333333333328, 5.966666666666666, 7.682, 9.611333333333333, 6.790999999999999, 6.225, 7.247333333333333, 7.595999999999998, 6.956999999999999, 8.493333333333332, 8.318666666666665, 6.693999999999998, 10.175333333333334, 7.801999999999998, 7.9306666666666645, 8.587333333333332, 8.001999999999999, 6.943, 10.476333333333333, 10.982666666666667, 6.775666666666667, 7.7780000000000005, 9.610666666666665, 9.359333333333332, 8.84333333333333, 9.155999999999997, 10.2, 10.251333333333335, 8.808, 7.115333333333331, 6.789999999999999, 10.341333333333333, 11.078666666666665, 8.384666666666664, 8.432, 8.243333333333332, 9.327, 12.674333333333326, 10.859999999999996, 8.525999999999998, 9.602666666666664, 8.543, 6.858333333333331, 6.172333333333333, 9.265333333333333, 9.219666666666663, 8.264, 8.97033333333333, 9.630666666666663, 10.348666666666666, 9.687333333333331, 10.13433333333333, 8.436666666666666, 8.357666666666665, 7.648, 9.152666666666669, 8.966999999999999, 8.40333333333333, 9.569333333333335, 8.133333333333331, 7.687999999999999, 9.37, 7.721333333333332, 8.36933333333333, 14.980333333333332, 7.3919999999999995, 6.770666666666667, 10.590666666666664, 7.507666666666665, 7.172999999999998, 8.74733333333333, 7.810999999999998, 7.696666666666665, 14.022333333333338, 8.02, 8.629333333333332, 6.1466666666666665, 7.280666666666666, 9.829666666666666, 8.711333333333332, 8.742666666666667, 6.463333333333332, 11.356666666666666, 8.079333333333333, 7.575666666666665, 9.089666666666664, 9.512333333333332, 8.092333333333332, 9.494, 7.110666666666665, 6.601666666666667, 8.721999999999998, 9.414999999999997, 9.048999999999998, 5.8196666666666665, 9.508666666666668, 7.147666666666666, 7.937666666666666, 7.209000000000001, 8.880333333333333], "episode_lengths": [21, 13, 16, 20, 15, 14, 15, 17, 14, 20, 16, 14, 19, 16, 16, 18, 16, 19, 21, 25, 16, 16, 20, 19, 19, 18, 20, 20, 21, 15, 14, 20, 22, 18, 17, 18, 20, 27, 21, 18, 20, 20, 14, 13, 19, 19, 17, 19, 19, 22, 19, 21, 18, 18, 15, 18, 18, 19, 21, 19, 17, 21, 18, 20, 27, 15, 14, 22, 15, 17, 18, 16, 17, 32, 16, 18, 14, 16, 25, 20, 19, 14, 21, 17, 15, 19, 20, 18, 20, 18, 15, 18, 20, 19, 14, 22, 16, 17, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.626967528312058, "mean_inference_ms": 2.973988796569513, "mean_action_processing_ms": 0.6082096068120572, "mean_env_wait_ms": 0.14859892833092267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025911569595336914, "StateBufferConnector_ms": 0.0167236328125, "ViewRequirementAgentConnector_ms": 0.6358070373535156}}, "episode_reward_max": 14.980333333333332, "episode_reward_min": 5.8196666666666665, "episode_reward_mean": 8.616649999999998, "episode_len_mean": 18.28, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.998333333333328, 5.966666666666666, 7.682, 9.611333333333333, 6.790999999999999, 6.225, 7.247333333333333, 7.595999999999998, 6.956999999999999, 8.493333333333332, 8.318666666666665, 6.693999999999998, 10.175333333333334, 7.801999999999998, 7.9306666666666645, 8.587333333333332, 8.001999999999999, 6.943, 10.476333333333333, 10.982666666666667, 6.775666666666667, 7.7780000000000005, 9.610666666666665, 9.359333333333332, 8.84333333333333, 9.155999999999997, 10.2, 10.251333333333335, 8.808, 7.115333333333331, 6.789999999999999, 10.341333333333333, 11.078666666666665, 8.384666666666664, 8.432, 8.243333333333332, 9.327, 12.674333333333326, 10.859999999999996, 8.525999999999998, 9.602666666666664, 8.543, 6.858333333333331, 6.172333333333333, 9.265333333333333, 9.219666666666663, 8.264, 8.97033333333333, 9.630666666666663, 10.348666666666666, 9.687333333333331, 10.13433333333333, 8.436666666666666, 8.357666666666665, 7.648, 9.152666666666669, 8.966999999999999, 8.40333333333333, 9.569333333333335, 8.133333333333331, 7.687999999999999, 9.37, 7.721333333333332, 8.36933333333333, 14.980333333333332, 7.3919999999999995, 6.770666666666667, 10.590666666666664, 7.507666666666665, 7.172999999999998, 8.74733333333333, 7.810999999999998, 7.696666666666665, 14.022333333333338, 8.02, 8.629333333333332, 6.1466666666666665, 7.280666666666666, 9.829666666666666, 8.711333333333332, 8.742666666666667, 6.463333333333332, 11.356666666666666, 8.079333333333333, 7.575666666666665, 9.089666666666664, 9.512333333333332, 8.092333333333332, 9.494, 7.110666666666665, 6.601666666666667, 8.721999999999998, 9.414999999999997, 9.048999999999998, 5.8196666666666665, 9.508666666666668, 7.147666666666666, 7.937666666666666, 7.209000000000001, 8.880333333333333], "episode_lengths": [21, 13, 16, 20, 15, 14, 15, 17, 14, 20, 16, 14, 19, 16, 16, 18, 16, 19, 21, 25, 16, 16, 20, 19, 19, 18, 20, 20, 21, 15, 14, 20, 22, 18, 17, 18, 20, 27, 21, 18, 20, 20, 14, 13, 19, 19, 17, 19, 19, 22, 19, 21, 18, 18, 15, 18, 18, 19, 21, 19, 17, 21, 18, 20, 27, 15, 14, 22, 15, 17, 18, 16, 17, 32, 16, 18, 14, 16, 25, 20, 19, 14, 21, 17, 15, 19, 20, 18, 20, 18, 15, 18, 20, 19, 14, 22, 16, 17, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.626967528312058, "mean_inference_ms": 2.973988796569513, "mean_action_processing_ms": 0.6082096068120572, "mean_env_wait_ms": 0.14859892833092267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025911569595336914, "StateBufferConnector_ms": 0.0167236328125, "ViewRequirementAgentConnector_ms": 0.6358070373535156}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57400, "num_agent_steps_trained": 57400, "num_env_steps_sampled": 57400, "num_env_steps_trained": 57400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1028.1418640487916, "num_env_steps_trained_throughput_per_sec": 1028.1418640487916, "timesteps_total": 57400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 57400, "timers": {"training_iteration_time_ms": 1355.725, "sample_time_ms": 1313.674, "load_time_ms": 0.682, "load_throughput": 2052151.255, "learn_time_ms": 17.493, "learn_throughput": 80031.424, "synch_weights_time_ms": 23.776}, "counters": {"num_env_steps_sampled": 57400, "num_env_steps_trained": 57400, "num_agent_steps_sampled": 57400, "num_agent_steps_trained": 57400}, "done": false, "episodes_total": 3058, "training_iteration": 41, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-46", "timestamp": 1702021186, "time_this_iter_s": 1.3836743831634521, "time_total_s": 49.41673803329468, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.41673803329468, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 96.85, "ram_util_percent": 99.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0966706275939941, "total_loss": 1.0966706275939941, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "sampler_results": {"episode_reward_max": 14.022333333333338, "episode_reward_min": 5.8196666666666665, "episode_reward_mean": 8.774423333333333, "episode_len_mean": 18.93, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.022333333333338, 8.02, 8.629333333333332, 6.1466666666666665, 7.280666666666666, 9.829666666666666, 8.711333333333332, 8.742666666666667, 6.463333333333332, 11.356666666666666, 8.079333333333333, 7.575666666666665, 9.089666666666664, 9.512333333333332, 8.092333333333332, 9.494, 7.110666666666665, 6.601666666666667, 8.721999999999998, 9.414999999999997, 9.048999999999998, 5.8196666666666665, 9.508666666666668, 7.147666666666666, 7.937666666666666, 7.209000000000001, 8.880333333333333, 9.164999999999997, 9.003, 8.928666666666665, 7.587000000000001, 7.4093333333333335, 9.939333333333332, 10.186666666666671, 10.30933333333333, 8.280666666666665, 7.472666666666667, 9.203, 8.380333333333335, 9.596999999999994, 11.794666666666668, 7.377333333333332, 9.065999999999999, 7.281666666666667, 6.46, 9.252666666666665, 8.142333333333335, 7.782999999999997, 7.408333333333334, 6.684666666666666, 11.443666666666665, 8.005999999999998, 8.353333333333333, 9.984999999999996, 7.817999999999998, 9.884666666666668, 7.370333333333335, 9.625333333333334, 10.167, 8.314666666666666, 7.175666666666666, 7.855999999999998, 10.797666666666665, 7.585333333333332, 8.466666666666665, 9.277999999999999, 8.298666666666666, 8.343333333333332, 11.938999999999998, 7.9430000000000005, 11.331999999999999, 8.605333333333332, 9.60833333333333, 7.633666666666665, 10.220999999999998, 8.033, 6.813333333333333, 7.897666666666666, 11.646333333333335, 7.136333333333332, 7.949999999999999, 10.75233333333333, 8.341333333333333, 10.148666666666665, 9.574666666666667, 7.648999999999999, 9.03833333333333, 11.947333333333331, 8.215, 10.666999999999998, 6.661333333333334, 9.928666666666667, 9.972666666666669, 9.546666666666665, 10.188, 7.622333333333331, 6.7589999999999995, 11.263000000000002, 6.188666666666665, 12.289999999999997], "episode_lengths": [32, 16, 18, 14, 16, 25, 20, 19, 14, 21, 17, 15, 19, 20, 18, 20, 18, 15, 18, 20, 19, 14, 22, 16, 17, 17, 19, 22, 20, 21, 17, 17, 20, 26, 23, 18, 18, 21, 20, 21, 24, 15, 18, 15, 15, 18, 17, 18, 17, 14, 23, 18, 17, 21, 16, 22, 15, 20, 20, 16, 15, 18, 24, 16, 19, 18, 19, 19, 24, 17, 24, 17, 21, 16, 23, 20, 16, 17, 23, 15, 17, 21, 20, 20, 22, 16, 19, 23, 18, 23, 14, 20, 22, 22, 20, 17, 15, 23, 14, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.634503865568554, "mean_inference_ms": 2.974715470546454, "mean_action_processing_ms": 0.6102915342556928, "mean_env_wait_ms": 0.15019030552551801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030770063400268555, "StateBufferConnector_ms": 0.02404022216796875, "ViewRequirementAgentConnector_ms": 0.5382301807403564}}, "episode_reward_max": 14.022333333333338, "episode_reward_min": 5.8196666666666665, "episode_reward_mean": 8.774423333333333, "episode_len_mean": 18.93, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.022333333333338, 8.02, 8.629333333333332, 6.1466666666666665, 7.280666666666666, 9.829666666666666, 8.711333333333332, 8.742666666666667, 6.463333333333332, 11.356666666666666, 8.079333333333333, 7.575666666666665, 9.089666666666664, 9.512333333333332, 8.092333333333332, 9.494, 7.110666666666665, 6.601666666666667, 8.721999999999998, 9.414999999999997, 9.048999999999998, 5.8196666666666665, 9.508666666666668, 7.147666666666666, 7.937666666666666, 7.209000000000001, 8.880333333333333, 9.164999999999997, 9.003, 8.928666666666665, 7.587000000000001, 7.4093333333333335, 9.939333333333332, 10.186666666666671, 10.30933333333333, 8.280666666666665, 7.472666666666667, 9.203, 8.380333333333335, 9.596999999999994, 11.794666666666668, 7.377333333333332, 9.065999999999999, 7.281666666666667, 6.46, 9.252666666666665, 8.142333333333335, 7.782999999999997, 7.408333333333334, 6.684666666666666, 11.443666666666665, 8.005999999999998, 8.353333333333333, 9.984999999999996, 7.817999999999998, 9.884666666666668, 7.370333333333335, 9.625333333333334, 10.167, 8.314666666666666, 7.175666666666666, 7.855999999999998, 10.797666666666665, 7.585333333333332, 8.466666666666665, 9.277999999999999, 8.298666666666666, 8.343333333333332, 11.938999999999998, 7.9430000000000005, 11.331999999999999, 8.605333333333332, 9.60833333333333, 7.633666666666665, 10.220999999999998, 8.033, 6.813333333333333, 7.897666666666666, 11.646333333333335, 7.136333333333332, 7.949999999999999, 10.75233333333333, 8.341333333333333, 10.148666666666665, 9.574666666666667, 7.648999999999999, 9.03833333333333, 11.947333333333331, 8.215, 10.666999999999998, 6.661333333333334, 9.928666666666667, 9.972666666666669, 9.546666666666665, 10.188, 7.622333333333331, 6.7589999999999995, 11.263000000000002, 6.188666666666665, 12.289999999999997], "episode_lengths": [32, 16, 18, 14, 16, 25, 20, 19, 14, 21, 17, 15, 19, 20, 18, 20, 18, 15, 18, 20, 19, 14, 22, 16, 17, 17, 19, 22, 20, 21, 17, 17, 20, 26, 23, 18, 18, 21, 20, 21, 24, 15, 18, 15, 15, 18, 17, 18, 17, 14, 23, 18, 17, 21, 16, 22, 15, 20, 20, 16, 15, 18, 24, 16, 19, 18, 19, 19, 24, 17, 24, 17, 21, 16, 23, 20, 16, 17, 23, 15, 17, 21, 20, 20, 22, 16, 19, 23, 18, 23, 14, 20, 22, 22, 20, 17, 15, 23, 14, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.634503865568554, "mean_inference_ms": 2.974715470546454, "mean_action_processing_ms": 0.6102915342556928, "mean_env_wait_ms": 0.15019030552551801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030770063400268555, "StateBufferConnector_ms": 0.02404022216796875, "ViewRequirementAgentConnector_ms": 0.5382301807403564}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1120.1837459605267, "num_env_steps_trained_throughput_per_sec": 1120.1837459605267, "timesteps_total": 58800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 58800, "timers": {"training_iteration_time_ms": 1387.453, "sample_time_ms": 1345.675, "load_time_ms": 0.682, "load_throughput": 2052151.255, "learn_time_ms": 17.286, "learn_throughput": 80989.1, "synch_weights_time_ms": 23.709}, "counters": {"num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "done": false, "episodes_total": 3131, "training_iteration": 42, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-47", "timestamp": 1702021187, "time_this_iter_s": 1.2645385265350342, "time_total_s": 50.68127655982971, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.68127655982971, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 92.4, "ram_util_percent": 96.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0955466032028198, "total_loss": 1.0955466032028198, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 60200, "num_env_steps_trained": 60200, "num_agent_steps_sampled": 60200, "num_agent_steps_trained": 60200}, "sampler_results": {"episode_reward_max": 18.18933333333333, "episode_reward_min": 6.188666666666665, "episode_reward_mean": 8.874116666666666, "episode_len_mean": 19.03, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.813333333333333, 7.897666666666666, 11.646333333333335, 7.136333333333332, 7.949999999999999, 10.75233333333333, 8.341333333333333, 10.148666666666665, 9.574666666666667, 7.648999999999999, 9.03833333333333, 11.947333333333331, 8.215, 10.666999999999998, 6.661333333333334, 9.928666666666667, 9.972666666666669, 9.546666666666665, 10.188, 7.622333333333331, 6.7589999999999995, 11.263000000000002, 6.188666666666665, 12.289999999999997, 9.674999999999997, 6.6240000000000006, 8.150333333333334, 9.452, 7.762999999999998, 8.044999999999998, 6.709666666666666, 7.336666666666668, 6.261666666666667, 10.799, 8.499333333333333, 10.033999999999999, 7.292999999999999, 7.124333333333332, 9.270000000000001, 8.440666666666665, 7.84, 11.922666666666665, 8.343333333333334, 7.625666666666666, 10.163333333333329, 10.690333333333328, 7.205666666666665, 7.7733333333333325, 8.92133333333333, 9.264, 9.411666666666664, 8.322999999999999, 12.38633333333333, 9.632666666666667, 9.908666666666665, 11.392333333333328, 18.18933333333333, 8.915333333333333, 6.764999999999998, 10.670999999999996, 9.386333333333333, 8.469666666666665, 9.338666666666665, 8.605333333333332, 9.614333333333333, 9.397666666666664, 10.468999999999998, 8.442666666666666, 8.338666666666665, 7.552666666666665, 9.786333333333333, 7.531999999999998, 8.404666666666666, 8.233999999999998, 9.831666666666663, 7.874333333333332, 7.727999999999998, 7.463666666666665, 8.112333333333334, 6.774333333333333, 7.725666666666666, 7.8203333333333305, 7.275666666666666, 9.796333333333331, 7.213999999999997, 7.150666666666666, 7.907333333333332, 12.097666666666667, 7.888999999999999, 8.046666666666663, 7.952666666666666, 9.010999999999997, 8.254666666666665, 6.616999999999999, 9.532666666666666, 9.208000000000002, 9.818, 6.355333333333331, 12.84666666666667, 8.515666666666664], "episode_lengths": [16, 17, 23, 15, 17, 21, 20, 20, 22, 16, 19, 23, 18, 23, 14, 20, 22, 22, 20, 17, 15, 23, 14, 24, 20, 14, 17, 23, 17, 19, 17, 17, 14, 20, 18, 20, 18, 16, 19, 22, 17, 28, 17, 15, 19, 22, 20, 18, 19, 18, 19, 19, 28, 20, 19, 27, 33, 17, 15, 23, 20, 22, 20, 21, 22, 19, 21, 18, 20, 16, 21, 19, 16, 18, 21, 17, 17, 17, 18, 15, 16, 16, 17, 21, 15, 16, 18, 25, 17, 17, 20, 18, 16, 14, 22, 19, 18, 13, 23, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6291524723664417, "mean_inference_ms": 2.96409141331696, "mean_action_processing_ms": 0.6093566191955615, "mean_env_wait_ms": 0.14936947520710647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02156209945678711, "StateBufferConnector_ms": 0.019257307052612305, "ViewRequirementAgentConnector_ms": 0.404024600982666}}, "episode_reward_max": 18.18933333333333, "episode_reward_min": 6.188666666666665, "episode_reward_mean": 8.874116666666666, "episode_len_mean": 19.03, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.813333333333333, 7.897666666666666, 11.646333333333335, 7.136333333333332, 7.949999999999999, 10.75233333333333, 8.341333333333333, 10.148666666666665, 9.574666666666667, 7.648999999999999, 9.03833333333333, 11.947333333333331, 8.215, 10.666999999999998, 6.661333333333334, 9.928666666666667, 9.972666666666669, 9.546666666666665, 10.188, 7.622333333333331, 6.7589999999999995, 11.263000000000002, 6.188666666666665, 12.289999999999997, 9.674999999999997, 6.6240000000000006, 8.150333333333334, 9.452, 7.762999999999998, 8.044999999999998, 6.709666666666666, 7.336666666666668, 6.261666666666667, 10.799, 8.499333333333333, 10.033999999999999, 7.292999999999999, 7.124333333333332, 9.270000000000001, 8.440666666666665, 7.84, 11.922666666666665, 8.343333333333334, 7.625666666666666, 10.163333333333329, 10.690333333333328, 7.205666666666665, 7.7733333333333325, 8.92133333333333, 9.264, 9.411666666666664, 8.322999999999999, 12.38633333333333, 9.632666666666667, 9.908666666666665, 11.392333333333328, 18.18933333333333, 8.915333333333333, 6.764999999999998, 10.670999999999996, 9.386333333333333, 8.469666666666665, 9.338666666666665, 8.605333333333332, 9.614333333333333, 9.397666666666664, 10.468999999999998, 8.442666666666666, 8.338666666666665, 7.552666666666665, 9.786333333333333, 7.531999999999998, 8.404666666666666, 8.233999999999998, 9.831666666666663, 7.874333333333332, 7.727999999999998, 7.463666666666665, 8.112333333333334, 6.774333333333333, 7.725666666666666, 7.8203333333333305, 7.275666666666666, 9.796333333333331, 7.213999999999997, 7.150666666666666, 7.907333333333332, 12.097666666666667, 7.888999999999999, 8.046666666666663, 7.952666666666666, 9.010999999999997, 8.254666666666665, 6.616999999999999, 9.532666666666666, 9.208000000000002, 9.818, 6.355333333333331, 12.84666666666667, 8.515666666666664], "episode_lengths": [16, 17, 23, 15, 17, 21, 20, 20, 22, 16, 19, 23, 18, 23, 14, 20, 22, 22, 20, 17, 15, 23, 14, 24, 20, 14, 17, 23, 17, 19, 17, 17, 14, 20, 18, 20, 18, 16, 19, 22, 17, 28, 17, 15, 19, 22, 20, 18, 19, 18, 19, 19, 28, 20, 19, 27, 33, 17, 15, 23, 20, 22, 20, 21, 22, 19, 21, 18, 20, 16, 21, 19, 16, 18, 21, 17, 17, 17, 18, 15, 16, 16, 17, 21, 15, 16, 18, 25, 17, 17, 20, 18, 16, 14, 22, 19, 18, 13, 23, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6291524723664417, "mean_inference_ms": 2.96409141331696, "mean_action_processing_ms": 0.6093566191955615, "mean_env_wait_ms": 0.14936947520710647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02156209945678711, "StateBufferConnector_ms": 0.019257307052612305, "ViewRequirementAgentConnector_ms": 0.404024600982666}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60200, "num_agent_steps_trained": 60200, "num_env_steps_sampled": 60200, "num_env_steps_trained": 60200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1396.5837123658957, "num_env_steps_trained_throughput_per_sec": 1396.5837123658957, "timesteps_total": 60200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 60200, "timers": {"training_iteration_time_ms": 1358.012, "sample_time_ms": 1316.628, "load_time_ms": 0.682, "load_throughput": 2052222.976, "learn_time_ms": 16.785, "learn_throughput": 83406.611, "synch_weights_time_ms": 23.817}, "counters": {"num_env_steps_sampled": 60200, "num_env_steps_trained": 60200, "num_agent_steps_sampled": 60200, "num_agent_steps_trained": 60200}, "done": false, "episodes_total": 3207, "training_iteration": 43, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-48", "timestamp": 1702021188, "time_this_iter_s": 1.0334434509277344, "time_total_s": 51.714720010757446, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 51.714720010757446, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 95.1, "ram_util_percent": 95.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0943111181259155, "total_loss": 1.0943111181259155, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 61600, "num_env_steps_trained": 61600, "num_agent_steps_sampled": 61600, "num_agent_steps_trained": 61600}, "sampler_results": {"episode_reward_max": 12.84666666666667, "episode_reward_min": 6.131, "episode_reward_mean": 8.742143333333333, "episode_len_mean": 18.57, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.404666666666666, 8.233999999999998, 9.831666666666663, 7.874333333333332, 7.727999999999998, 7.463666666666665, 8.112333333333334, 6.774333333333333, 7.725666666666666, 7.8203333333333305, 7.275666666666666, 9.796333333333331, 7.213999999999997, 7.150666666666666, 7.907333333333332, 12.097666666666667, 7.888999999999999, 8.046666666666663, 7.952666666666666, 9.010999999999997, 8.254666666666665, 6.616999999999999, 9.532666666666666, 9.208000000000002, 9.818, 6.355333333333331, 12.84666666666667, 8.515666666666664, 8.980999999999998, 8.842, 8.459, 8.99433333333333, 10.023000000000001, 8.056666666666663, 8.925999999999998, 10.524333333333331, 10.237999999999998, 8.431666666666667, 9.492999999999999, 7.219666666666666, 10.26233333333333, 6.131, 11.573000000000002, 6.435999999999999, 7.5216666666666665, 9.825999999999999, 7.247333333333334, 7.450333333333334, 7.466333333333331, 10.310666666666666, 7.053333333333331, 9.261, 9.069333333333331, 11.474666666666662, 10.177666666666664, 7.857666666666665, 7.006, 10.090666666666666, 11.26666666666666, 9.915666666666665, 8.706999999999997, 7.275333333333331, 10.294333333333332, 8.283333333333333, 10.038999999999996, 11.760333333333332, 8.645666666666667, 12.312666666666669, 9.847333333333333, 8.894666666666666, 6.833999999999999, 7.1400000000000015, 7.012, 7.125333333333332, 10.495333333333335, 7.5826666666666656, 6.7253333333333325, 8.037666666666667, 6.234666666666667, 9.429333333333332, 7.281333333333332, 6.945333333333331, 12.215333333333332, 9.283333333333331, 8.879333333333328, 7.199666666666667, 11.660333333333332, 10.56333333333333, 7.425333333333332, 7.263333333333332, 8.370666666666667, 7.586, 7.331333333333333, 11.387, 8.283333333333333, 10.292666666666667, 10.154666666666664, 9.374333333333333, 8.553666666666665, 10.443999999999999], "episode_lengths": [16, 18, 21, 17, 17, 17, 18, 15, 16, 16, 17, 21, 15, 16, 18, 25, 17, 17, 20, 18, 16, 14, 22, 19, 18, 13, 23, 19, 18, 19, 17, 20, 22, 17, 20, 22, 20, 18, 22, 16, 21, 14, 25, 14, 17, 23, 16, 16, 18, 20, 17, 20, 20, 23, 20, 16, 14, 19, 23, 20, 19, 16, 22, 18, 20, 24, 19, 27, 20, 18, 14, 16, 16, 16, 23, 16, 15, 17, 16, 19, 17, 16, 26, 19, 19, 16, 23, 23, 16, 14, 17, 16, 15, 23, 19, 20, 21, 19, 19, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6238487670259707, "mean_inference_ms": 2.9534964873291165, "mean_action_processing_ms": 0.6073918819862573, "mean_env_wait_ms": 0.14912405649607116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020275592803955078, "StateBufferConnector_ms": 0.011792421340942383, "ViewRequirementAgentConnector_ms": 0.46788835525512695}}, "episode_reward_max": 12.84666666666667, "episode_reward_min": 6.131, "episode_reward_mean": 8.742143333333333, "episode_len_mean": 18.57, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.404666666666666, 8.233999999999998, 9.831666666666663, 7.874333333333332, 7.727999999999998, 7.463666666666665, 8.112333333333334, 6.774333333333333, 7.725666666666666, 7.8203333333333305, 7.275666666666666, 9.796333333333331, 7.213999999999997, 7.150666666666666, 7.907333333333332, 12.097666666666667, 7.888999999999999, 8.046666666666663, 7.952666666666666, 9.010999999999997, 8.254666666666665, 6.616999999999999, 9.532666666666666, 9.208000000000002, 9.818, 6.355333333333331, 12.84666666666667, 8.515666666666664, 8.980999999999998, 8.842, 8.459, 8.99433333333333, 10.023000000000001, 8.056666666666663, 8.925999999999998, 10.524333333333331, 10.237999999999998, 8.431666666666667, 9.492999999999999, 7.219666666666666, 10.26233333333333, 6.131, 11.573000000000002, 6.435999999999999, 7.5216666666666665, 9.825999999999999, 7.247333333333334, 7.450333333333334, 7.466333333333331, 10.310666666666666, 7.053333333333331, 9.261, 9.069333333333331, 11.474666666666662, 10.177666666666664, 7.857666666666665, 7.006, 10.090666666666666, 11.26666666666666, 9.915666666666665, 8.706999999999997, 7.275333333333331, 10.294333333333332, 8.283333333333333, 10.038999999999996, 11.760333333333332, 8.645666666666667, 12.312666666666669, 9.847333333333333, 8.894666666666666, 6.833999999999999, 7.1400000000000015, 7.012, 7.125333333333332, 10.495333333333335, 7.5826666666666656, 6.7253333333333325, 8.037666666666667, 6.234666666666667, 9.429333333333332, 7.281333333333332, 6.945333333333331, 12.215333333333332, 9.283333333333331, 8.879333333333328, 7.199666666666667, 11.660333333333332, 10.56333333333333, 7.425333333333332, 7.263333333333332, 8.370666666666667, 7.586, 7.331333333333333, 11.387, 8.283333333333333, 10.292666666666667, 10.154666666666664, 9.374333333333333, 8.553666666666665, 10.443999999999999], "episode_lengths": [16, 18, 21, 17, 17, 17, 18, 15, 16, 16, 17, 21, 15, 16, 18, 25, 17, 17, 20, 18, 16, 14, 22, 19, 18, 13, 23, 19, 18, 19, 17, 20, 22, 17, 20, 22, 20, 18, 22, 16, 21, 14, 25, 14, 17, 23, 16, 16, 18, 20, 17, 20, 20, 23, 20, 16, 14, 19, 23, 20, 19, 16, 22, 18, 20, 24, 19, 27, 20, 18, 14, 16, 16, 16, 23, 16, 15, 17, 16, 19, 17, 16, 26, 19, 19, 16, 23, 23, 16, 14, 17, 16, 15, 23, 19, 20, 21, 19, 19, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6238487670259707, "mean_inference_ms": 2.9534964873291165, "mean_action_processing_ms": 0.6073918819862573, "mean_env_wait_ms": 0.14912405649607116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020275592803955078, "StateBufferConnector_ms": 0.011792421340942383, "ViewRequirementAgentConnector_ms": 0.46788835525512695}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61600, "num_agent_steps_trained": 61600, "num_env_steps_sampled": 61600, "num_env_steps_trained": 61600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1400.622787833049, "num_env_steps_trained_throughput_per_sec": 1400.622787833049, "timesteps_total": 61600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 61600, "timers": {"training_iteration_time_ms": 1330.614, "sample_time_ms": 1290.366, "load_time_ms": 0.582, "load_throughput": 2405089.33, "learn_time_ms": 16.385, "learn_throughput": 85444.092, "synch_weights_time_ms": 23.081}, "counters": {"num_env_steps_sampled": 61600, "num_env_steps_trained": 61600, "num_agent_steps_sampled": 61600, "num_agent_steps_trained": 61600}, "done": false, "episodes_total": 3279, "training_iteration": 44, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-49", "timestamp": 1702021189, "time_this_iter_s": 1.0145535469055176, "time_total_s": 52.729273557662964, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 52.729273557662964, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 88.2, "ram_util_percent": 95.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.094192385673523, "total_loss": 1.094192385673523, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 63000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 63000}, "sampler_results": {"episode_reward_max": 14.742333333333335, "episode_reward_min": 6.106666666666667, "episode_reward_mean": 8.763606666666666, "episode_len_mean": 18.57, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.7253333333333325, 8.037666666666667, 6.234666666666667, 9.429333333333332, 7.281333333333332, 6.945333333333331, 12.215333333333332, 9.283333333333331, 8.879333333333328, 7.199666666666667, 11.660333333333332, 10.56333333333333, 7.425333333333332, 7.263333333333332, 8.370666666666667, 7.586, 7.331333333333333, 11.387, 8.283333333333333, 10.292666666666667, 10.154666666666664, 9.374333333333333, 8.553666666666665, 10.443999999999999, 8.394666666666666, 7.367, 8.745999999999997, 12.930333333333332, 10.009, 7.689666666666667, 10.929666666666666, 8.294999999999998, 6.1416666666666675, 8.043333333333333, 7.170333333333332, 7.106666666666667, 7.701666666666665, 7.493333333333333, 7.394333333333333, 8.686333333333332, 7.9066666666666645, 14.742333333333335, 7.57, 10.243333333333332, 8.063666666666666, 7.298666666666665, 9.077333333333332, 9.946999999999997, 7.374999999999999, 7.128333333333331, 6.776333333333333, 6.918999999999997, 7.658333333333333, 11.136333333333331, 7.576333333333333, 8.074, 8.373333333333333, 8.473999999999998, 7.911, 11.832999999999993, 8.703999999999999, 8.53533333333333, 6.106666666666667, 8.55, 7.109666666666667, 6.8726666666666665, 7.1246666666666645, 13.072333333333331, 8.838666666666665, 11.298666666666666, 8.857333333333333, 13.963333333333331, 9.339666666666664, 8.950999999999997, 8.273666666666665, 8.420333333333332, 8.869, 11.216000000000001, 9.970666666666668, 13.695333333333332, 8.481666666666667, 7.18, 8.595666666666663, 7.319, 11.147999999999998, 10.183999999999997, 7.4129999999999985, 6.832, 11.404333333333334, 9.754666666666667, 8.558999999999997, 8.326333333333332, 8.151, 8.450999999999997, 6.380666666666666, 9.146999999999997, 7.572999999999999, 8.377666666666666, 8.807999999999996, 7.4013333333333335], "episode_lengths": [15, 17, 16, 19, 17, 16, 26, 19, 19, 16, 23, 23, 16, 14, 17, 16, 15, 23, 19, 20, 21, 19, 19, 22, 18, 17, 19, 25, 19, 17, 23, 17, 13, 17, 15, 16, 17, 18, 17, 20, 17, 28, 16, 22, 17, 17, 19, 20, 17, 16, 14, 15, 16, 22, 17, 17, 17, 18, 16, 23, 18, 17, 15, 18, 15, 16, 16, 26, 19, 24, 18, 28, 19, 17, 17, 18, 19, 26, 20, 28, 18, 15, 21, 15, 23, 21, 16, 16, 22, 19, 19, 17, 17, 18, 14, 19, 17, 19, 20, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6189699785010632, "mean_inference_ms": 2.9480031785405196, "mean_action_processing_ms": 0.6071871245684763, "mean_env_wait_ms": 0.1489927979564567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019840478897094727, "StateBufferConnector_ms": 0.007544279098510742, "ViewRequirementAgentConnector_ms": 0.4743068218231201}}, "episode_reward_max": 14.742333333333335, "episode_reward_min": 6.106666666666667, "episode_reward_mean": 8.763606666666666, "episode_len_mean": 18.57, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.7253333333333325, 8.037666666666667, 6.234666666666667, 9.429333333333332, 7.281333333333332, 6.945333333333331, 12.215333333333332, 9.283333333333331, 8.879333333333328, 7.199666666666667, 11.660333333333332, 10.56333333333333, 7.425333333333332, 7.263333333333332, 8.370666666666667, 7.586, 7.331333333333333, 11.387, 8.283333333333333, 10.292666666666667, 10.154666666666664, 9.374333333333333, 8.553666666666665, 10.443999999999999, 8.394666666666666, 7.367, 8.745999999999997, 12.930333333333332, 10.009, 7.689666666666667, 10.929666666666666, 8.294999999999998, 6.1416666666666675, 8.043333333333333, 7.170333333333332, 7.106666666666667, 7.701666666666665, 7.493333333333333, 7.394333333333333, 8.686333333333332, 7.9066666666666645, 14.742333333333335, 7.57, 10.243333333333332, 8.063666666666666, 7.298666666666665, 9.077333333333332, 9.946999999999997, 7.374999999999999, 7.128333333333331, 6.776333333333333, 6.918999999999997, 7.658333333333333, 11.136333333333331, 7.576333333333333, 8.074, 8.373333333333333, 8.473999999999998, 7.911, 11.832999999999993, 8.703999999999999, 8.53533333333333, 6.106666666666667, 8.55, 7.109666666666667, 6.8726666666666665, 7.1246666666666645, 13.072333333333331, 8.838666666666665, 11.298666666666666, 8.857333333333333, 13.963333333333331, 9.339666666666664, 8.950999999999997, 8.273666666666665, 8.420333333333332, 8.869, 11.216000000000001, 9.970666666666668, 13.695333333333332, 8.481666666666667, 7.18, 8.595666666666663, 7.319, 11.147999999999998, 10.183999999999997, 7.4129999999999985, 6.832, 11.404333333333334, 9.754666666666667, 8.558999999999997, 8.326333333333332, 8.151, 8.450999999999997, 6.380666666666666, 9.146999999999997, 7.572999999999999, 8.377666666666666, 8.807999999999996, 7.4013333333333335], "episode_lengths": [15, 17, 16, 19, 17, 16, 26, 19, 19, 16, 23, 23, 16, 14, 17, 16, 15, 23, 19, 20, 21, 19, 19, 22, 18, 17, 19, 25, 19, 17, 23, 17, 13, 17, 15, 16, 17, 18, 17, 20, 17, 28, 16, 22, 17, 17, 19, 20, 17, 16, 14, 15, 16, 22, 17, 17, 17, 18, 16, 23, 18, 17, 15, 18, 15, 16, 16, 26, 19, 24, 18, 28, 19, 17, 17, 18, 19, 26, 20, 28, 18, 15, 21, 15, 23, 21, 16, 16, 22, 19, 19, 17, 17, 18, 14, 19, 17, 19, 20, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6189699785010632, "mean_inference_ms": 2.9480031785405196, "mean_action_processing_ms": 0.6071871245684763, "mean_env_wait_ms": 0.1489927979564567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019840478897094727, "StateBufferConnector_ms": 0.007544279098510742, "ViewRequirementAgentConnector_ms": 0.4743068218231201}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 63000, "num_env_steps_sampled": 63000, "num_env_steps_trained": 63000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1317.7993475216076, "num_env_steps_trained_throughput_per_sec": 1317.7993475216076, "timesteps_total": 63000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 1284.659, "sample_time_ms": 1244.806, "load_time_ms": 0.59, "load_throughput": 2372727.332, "learn_time_ms": 15.968, "learn_throughput": 87675.411, "synch_weights_time_ms": 23.095}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 63000, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 63000}, "done": false, "episodes_total": 3355, "training_iteration": 45, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-51", "timestamp": 1702021191, "time_this_iter_s": 1.079371452331543, "time_total_s": 53.80864500999451, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.80864500999451, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 97.35, "ram_util_percent": 95.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0944132804870605, "total_loss": 1.0944132804870605, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 64400, "num_env_steps_trained": 64400, "num_agent_steps_sampled": 64400, "num_agent_steps_trained": 64400}, "sampler_results": {"episode_reward_max": 14.723999999999995, "episode_reward_min": 5.9623333333333335, "episode_reward_mean": 8.572633333333334, "episode_len_mean": 18.44, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.869, 11.216000000000001, 9.970666666666668, 13.695333333333332, 8.481666666666667, 7.18, 8.595666666666663, 7.319, 11.147999999999998, 10.183999999999997, 7.4129999999999985, 6.832, 11.404333333333334, 9.754666666666667, 8.558999999999997, 8.326333333333332, 8.151, 8.450999999999997, 6.380666666666666, 9.146999999999997, 7.572999999999999, 8.377666666666666, 8.807999999999996, 7.4013333333333335, 8.94233333333333, 9.116999999999999, 8.605999999999998, 7.855333333333333, 7.359, 8.211666666666666, 8.107666666666667, 8.663333333333334, 7.129999999999998, 11.08933333333333, 8.733, 9.524666666666665, 9.294, 7.358666666666667, 14.723999999999995, 6.657333333333333, 7.922666666666666, 8.306666666666667, 7.983666666666665, 7.389, 6.926333333333334, 8.517000000000001, 10.473, 8.618333333333332, 7.242333333333333, 7.148, 8.707, 10.888333333333332, 6.163999999999999, 7.835999999999998, 7.542000000000001, 10.164666666666664, 10.345333333333333, 7.549666666666665, 8.203666666666665, 7.158333333333331, 7.165999999999999, 7.969666666666668, 7.511333333333335, 8.197, 7.362666666666666, 10.552666666666665, 7.381333333333332, 6.082333333333334, 8.380333333333333, 9.064666666666666, 8.078666666666665, 7.462999999999999, 8.190333333333333, 8.170666666666666, 8.395333333333333, 8.333666666666666, 8.497333333333334, 7.7973333333333334, 5.9623333333333335, 6.704666666666666, 8.462333333333333, 9.233333333333334, 8.466666666666667, 9.376, 6.7796666666666665, 7.263333333333331, 12.839666666666666, 9.13233333333333, 6.860333333333333, 7.863666666666666, 7.931333333333332, 10.055666666666667, 7.7446666666666655, 8.16933333333333, 9.192, 8.385333333333332, 12.253666666666668, 7.787333333333332, 10.689333333333334, 11.818333333333333], "episode_lengths": [19, 26, 20, 28, 18, 15, 21, 15, 23, 21, 16, 16, 22, 19, 19, 17, 17, 18, 14, 19, 17, 19, 20, 18, 19, 19, 19, 18, 15, 17, 18, 18, 16, 22, 21, 20, 19, 15, 31, 14, 16, 17, 18, 17, 15, 17, 21, 19, 17, 17, 17, 25, 14, 17, 17, 22, 20, 17, 20, 17, 17, 18, 16, 16, 16, 22, 15, 15, 18, 23, 18, 16, 17, 17, 18, 19, 18, 16, 14, 14, 19, 19, 19, 21, 15, 16, 25, 20, 16, 16, 17, 21, 16, 17, 21, 19, 23, 17, 21, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6224719390752795, "mean_inference_ms": 2.946493483739151, "mean_action_processing_ms": 0.6077337620029986, "mean_env_wait_ms": 0.14893801388183206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016979217529296875, "StateBufferConnector_ms": 0.02136087417602539, "ViewRequirementAgentConnector_ms": 0.5688028335571289}}, "episode_reward_max": 14.723999999999995, "episode_reward_min": 5.9623333333333335, "episode_reward_mean": 8.572633333333334, "episode_len_mean": 18.44, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.869, 11.216000000000001, 9.970666666666668, 13.695333333333332, 8.481666666666667, 7.18, 8.595666666666663, 7.319, 11.147999999999998, 10.183999999999997, 7.4129999999999985, 6.832, 11.404333333333334, 9.754666666666667, 8.558999999999997, 8.326333333333332, 8.151, 8.450999999999997, 6.380666666666666, 9.146999999999997, 7.572999999999999, 8.377666666666666, 8.807999999999996, 7.4013333333333335, 8.94233333333333, 9.116999999999999, 8.605999999999998, 7.855333333333333, 7.359, 8.211666666666666, 8.107666666666667, 8.663333333333334, 7.129999999999998, 11.08933333333333, 8.733, 9.524666666666665, 9.294, 7.358666666666667, 14.723999999999995, 6.657333333333333, 7.922666666666666, 8.306666666666667, 7.983666666666665, 7.389, 6.926333333333334, 8.517000000000001, 10.473, 8.618333333333332, 7.242333333333333, 7.148, 8.707, 10.888333333333332, 6.163999999999999, 7.835999999999998, 7.542000000000001, 10.164666666666664, 10.345333333333333, 7.549666666666665, 8.203666666666665, 7.158333333333331, 7.165999999999999, 7.969666666666668, 7.511333333333335, 8.197, 7.362666666666666, 10.552666666666665, 7.381333333333332, 6.082333333333334, 8.380333333333333, 9.064666666666666, 8.078666666666665, 7.462999999999999, 8.190333333333333, 8.170666666666666, 8.395333333333333, 8.333666666666666, 8.497333333333334, 7.7973333333333334, 5.9623333333333335, 6.704666666666666, 8.462333333333333, 9.233333333333334, 8.466666666666667, 9.376, 6.7796666666666665, 7.263333333333331, 12.839666666666666, 9.13233333333333, 6.860333333333333, 7.863666666666666, 7.931333333333332, 10.055666666666667, 7.7446666666666655, 8.16933333333333, 9.192, 8.385333333333332, 12.253666666666668, 7.787333333333332, 10.689333333333334, 11.818333333333333], "episode_lengths": [19, 26, 20, 28, 18, 15, 21, 15, 23, 21, 16, 16, 22, 19, 19, 17, 17, 18, 14, 19, 17, 19, 20, 18, 19, 19, 19, 18, 15, 17, 18, 18, 16, 22, 21, 20, 19, 15, 31, 14, 16, 17, 18, 17, 15, 17, 21, 19, 17, 17, 17, 25, 14, 17, 17, 22, 20, 17, 20, 17, 17, 18, 16, 16, 16, 22, 15, 15, 18, 23, 18, 16, 17, 17, 18, 19, 18, 16, 14, 14, 19, 19, 19, 21, 15, 16, 25, 20, 16, 16, 17, 21, 16, 17, 21, 19, 23, 17, 21, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6224719390752795, "mean_inference_ms": 2.946493483739151, "mean_action_processing_ms": 0.6077337620029986, "mean_env_wait_ms": 0.14893801388183206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016979217529296875, "StateBufferConnector_ms": 0.02136087417602539, "ViewRequirementAgentConnector_ms": 0.5688028335571289}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64400, "num_agent_steps_trained": 64400, "num_env_steps_sampled": 64400, "num_env_steps_trained": 64400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1167.9187329409924, "num_env_steps_trained_throughput_per_sec": 1167.9187329409924, "timesteps_total": 64400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 64400, "timers": {"training_iteration_time_ms": 1255.491, "sample_time_ms": 1216.634, "load_time_ms": 0.592, "load_throughput": 2364796.263, "learn_time_ms": 15.769, "learn_throughput": 88780.149, "synch_weights_time_ms": 22.296}, "counters": {"num_env_steps_sampled": 64400, "num_env_steps_trained": 64400, "num_agent_steps_sampled": 64400, "num_agent_steps_trained": 64400}, "done": false, "episodes_total": 3431, "training_iteration": 46, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-52", "timestamp": 1702021192, "time_this_iter_s": 1.2147085666656494, "time_total_s": 55.023353576660156, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.023353576660156, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 96.15, "ram_util_percent": 95.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.093911051750183, "total_loss": 1.093911051750183, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 65800, "num_env_steps_trained": 65800, "num_agent_steps_sampled": 65800, "num_agent_steps_trained": 65800}, "sampler_results": {"episode_reward_max": 13.06533333333333, "episode_reward_min": 5.884666666666666, "episode_reward_mean": 8.480789999999999, "episode_len_mean": 18.12, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.233333333333334, 8.466666666666667, 9.376, 6.7796666666666665, 7.263333333333331, 12.839666666666666, 9.13233333333333, 6.860333333333333, 7.863666666666666, 7.931333333333332, 10.055666666666667, 7.7446666666666655, 8.16933333333333, 9.192, 8.385333333333332, 12.253666666666668, 7.787333333333332, 10.689333333333334, 11.818333333333333, 7.827333333333332, 6.450666666666666, 6.267666666666666, 7.674666666666665, 10.405, 7.623666666666666, 8.930666666666665, 12.075999999999999, 7.477, 5.9896666666666665, 6.599999999999999, 9.281999999999998, 8.248666666666667, 6.112666666666666, 10.813333333333333, 6.644666666666664, 9.867999999999997, 9.025666666666666, 6.3246666666666655, 7.983333333333332, 6.753333333333333, 7.701, 10.326666666666664, 10.176, 7.6499999999999995, 7.826999999999999, 7.916666666666665, 8.516999999999998, 8.576666666666666, 9.45133333333333, 8.560666666666666, 12.663666666666668, 7.938666666666665, 7.9786666666666655, 8.904999999999996, 9.213666666666665, 7.011333333333333, 6.556666666666666, 8.35, 10.141666666666666, 10.219999999999999, 8.806666666666665, 7.531666666666666, 13.06533333333333, 7.995, 6.209333333333333, 7.642666666666667, 9.316666666666665, 8.817999999999998, 8.286666666666665, 9.012666666666666, 9.135333333333332, 7.977999999999999, 10.699999999999998, 10.208333333333336, 7.2, 8.816999999999998, 6.437, 8.992666666666667, 6.868999999999999, 7.999666666666667, 8.064666666666664, 6.139666666666667, 8.433333333333332, 8.255666666666666, 10.311666666666664, 8.227333333333332, 7.068, 5.884666666666666, 8.839999999999996, 9.011999999999999, 7.178666666666665, 6.392, 9.584999999999999, 8.902333333333331, 9.148666666666667, 8.219, 9.449333333333332, 8.239999999999998, 6.998333333333334, 6.8039999999999985], "episode_lengths": [19, 19, 21, 15, 16, 25, 20, 16, 16, 17, 21, 16, 17, 21, 19, 23, 17, 21, 25, 17, 14, 14, 18, 20, 18, 20, 22, 17, 13, 15, 18, 17, 14, 22, 14, 21, 18, 14, 20, 14, 18, 22, 25, 16, 16, 17, 17, 20, 20, 20, 24, 17, 18, 20, 21, 16, 17, 19, 21, 21, 16, 16, 26, 16, 13, 18, 19, 21, 17, 20, 17, 18, 20, 22, 17, 18, 13, 19, 15, 18, 16, 13, 18, 17, 20, 16, 15, 14, 19, 19, 15, 14, 23, 19, 20, 17, 22, 16, 15, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6209222044100773, "mean_inference_ms": 2.9432017253301446, "mean_action_processing_ms": 0.6085465138889306, "mean_env_wait_ms": 0.14823829663275642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021883249282836914, "StateBufferConnector_ms": 0.01801919937133789, "ViewRequirementAgentConnector_ms": 0.5088005065917969}}, "episode_reward_max": 13.06533333333333, "episode_reward_min": 5.884666666666666, "episode_reward_mean": 8.480789999999999, "episode_len_mean": 18.12, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.233333333333334, 8.466666666666667, 9.376, 6.7796666666666665, 7.263333333333331, 12.839666666666666, 9.13233333333333, 6.860333333333333, 7.863666666666666, 7.931333333333332, 10.055666666666667, 7.7446666666666655, 8.16933333333333, 9.192, 8.385333333333332, 12.253666666666668, 7.787333333333332, 10.689333333333334, 11.818333333333333, 7.827333333333332, 6.450666666666666, 6.267666666666666, 7.674666666666665, 10.405, 7.623666666666666, 8.930666666666665, 12.075999999999999, 7.477, 5.9896666666666665, 6.599999999999999, 9.281999999999998, 8.248666666666667, 6.112666666666666, 10.813333333333333, 6.644666666666664, 9.867999999999997, 9.025666666666666, 6.3246666666666655, 7.983333333333332, 6.753333333333333, 7.701, 10.326666666666664, 10.176, 7.6499999999999995, 7.826999999999999, 7.916666666666665, 8.516999999999998, 8.576666666666666, 9.45133333333333, 8.560666666666666, 12.663666666666668, 7.938666666666665, 7.9786666666666655, 8.904999999999996, 9.213666666666665, 7.011333333333333, 6.556666666666666, 8.35, 10.141666666666666, 10.219999999999999, 8.806666666666665, 7.531666666666666, 13.06533333333333, 7.995, 6.209333333333333, 7.642666666666667, 9.316666666666665, 8.817999999999998, 8.286666666666665, 9.012666666666666, 9.135333333333332, 7.977999999999999, 10.699999999999998, 10.208333333333336, 7.2, 8.816999999999998, 6.437, 8.992666666666667, 6.868999999999999, 7.999666666666667, 8.064666666666664, 6.139666666666667, 8.433333333333332, 8.255666666666666, 10.311666666666664, 8.227333333333332, 7.068, 5.884666666666666, 8.839999999999996, 9.011999999999999, 7.178666666666665, 6.392, 9.584999999999999, 8.902333333333331, 9.148666666666667, 8.219, 9.449333333333332, 8.239999999999998, 6.998333333333334, 6.8039999999999985], "episode_lengths": [19, 19, 21, 15, 16, 25, 20, 16, 16, 17, 21, 16, 17, 21, 19, 23, 17, 21, 25, 17, 14, 14, 18, 20, 18, 20, 22, 17, 13, 15, 18, 17, 14, 22, 14, 21, 18, 14, 20, 14, 18, 22, 25, 16, 16, 17, 17, 20, 20, 20, 24, 17, 18, 20, 21, 16, 17, 19, 21, 21, 16, 16, 26, 16, 13, 18, 19, 21, 17, 20, 17, 18, 20, 22, 17, 18, 13, 19, 15, 18, 16, 13, 18, 17, 20, 16, 15, 14, 19, 19, 15, 14, 23, 19, 20, 17, 22, 16, 15, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6209222044100773, "mean_inference_ms": 2.9432017253301446, "mean_action_processing_ms": 0.6085465138889306, "mean_env_wait_ms": 0.14823829663275642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021883249282836914, "StateBufferConnector_ms": 0.01801919937133789, "ViewRequirementAgentConnector_ms": 0.5088005065917969}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65800, "num_agent_steps_trained": 65800, "num_env_steps_sampled": 65800, "num_env_steps_trained": 65800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1339.565204398007, "num_env_steps_trained_throughput_per_sec": 1339.565204398007, "timesteps_total": 65800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 65800, "timers": {"training_iteration_time_ms": 1202.435, "sample_time_ms": 1165.34, "load_time_ms": 0.642, "load_throughput": 2180801.307, "learn_time_ms": 14.646, "learn_throughput": 95588.425, "synch_weights_time_ms": 21.607}, "counters": {"num_env_steps_sampled": 65800, "num_env_steps_trained": 65800, "num_agent_steps_sampled": 65800, "num_agent_steps_trained": 65800}, "done": false, "episodes_total": 3512, "training_iteration": 47, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-53", "timestamp": 1702021193, "time_this_iter_s": 1.0628306865692139, "time_total_s": 56.08618426322937, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 56.08618426322937, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 92.5, "ram_util_percent": 95.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0895951986312866, "total_loss": 1.0895951986312866, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "sampler_results": {"episode_reward_max": 14.717999999999998, "episode_reward_min": 5.384, "episode_reward_mean": 8.300089999999999, "episode_len_mean": 17.86, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.437, 8.992666666666667, 6.868999999999999, 7.999666666666667, 8.064666666666664, 6.139666666666667, 8.433333333333332, 8.255666666666666, 10.311666666666664, 8.227333333333332, 7.068, 5.884666666666666, 8.839999999999996, 9.011999999999999, 7.178666666666665, 6.392, 9.584999999999999, 8.902333333333331, 9.148666666666667, 8.219, 9.449333333333332, 8.239999999999998, 6.998333333333334, 6.8039999999999985, 7.749999999999997, 7.414666666666665, 7.202333333333331, 8.707, 7.067666666666666, 7.671999999999999, 8.348666666666666, 6.423, 9.999, 7.860333333333332, 7.470666666666666, 7.0633333333333335, 11.353333333333332, 14.717999999999998, 6.712, 9.795999999999998, 7.936333333333332, 6.477666666666666, 6.49, 5.698333333333332, 7.882333333333332, 9.540666666666661, 7.984333333333333, 6.986999999999999, 8.389333333333333, 6.335999999999999, 5.384, 6.7513333333333305, 8.247333333333332, 6.585666666666666, 7.411666666666666, 8.393666666666665, 7.577, 6.452333333333333, 10.158666666666665, 8.313666666666666, 10.026666666666666, 10.242333333333333, 11.614999999999998, 9.583, 10.232333333333331, 8.952, 6.903333333333332, 6.343333333333334, 9.059333333333335, 7.969, 7.572666666666666, 8.014999999999997, 5.420999999999999, 6.6563333333333325, 8.627666666666666, 10.500999999999998, 8.378999999999998, 8.17, 7.074333333333334, 9.252333333333333, 12.014000000000001, 10.65366666666667, 9.50233333333333, 7.699333333333332, 7.178999999999999, 7.909666666666666, 8.481333333333334, 10.315666666666665, 7.828666666666664, 10.444666666666663, 11.263000000000002, 8.155, 9.012999999999998, 12.463000000000001, 6.419666666666665, 12.717999999999998, 7.744333333333331, 8.769, 8.081999999999997, 6.749999999999999], "episode_lengths": [13, 19, 15, 18, 16, 13, 18, 17, 20, 16, 15, 14, 19, 19, 15, 14, 23, 19, 20, 17, 22, 16, 15, 16, 18, 16, 15, 19, 16, 16, 18, 14, 19, 17, 16, 17, 22, 27, 16, 22, 17, 15, 14, 13, 19, 20, 19, 16, 17, 15, 14, 14, 19, 14, 17, 18, 17, 13, 20, 18, 20, 24, 25, 17, 23, 18, 15, 13, 19, 19, 15, 17, 12, 16, 17, 23, 17, 17, 15, 20, 24, 22, 21, 16, 16, 19, 17, 21, 17, 25, 24, 18, 21, 25, 14, 26, 18, 19, 18, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6200854141135337, "mean_inference_ms": 2.93784770363985, "mean_action_processing_ms": 0.6083412729526719, "mean_env_wait_ms": 0.14842836289046718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02914714813232422, "StateBufferConnector_ms": 0.01255655288696289, "ViewRequirementAgentConnector_ms": 0.5024116039276123}}, "episode_reward_max": 14.717999999999998, "episode_reward_min": 5.384, "episode_reward_mean": 8.300089999999999, "episode_len_mean": 17.86, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.437, 8.992666666666667, 6.868999999999999, 7.999666666666667, 8.064666666666664, 6.139666666666667, 8.433333333333332, 8.255666666666666, 10.311666666666664, 8.227333333333332, 7.068, 5.884666666666666, 8.839999999999996, 9.011999999999999, 7.178666666666665, 6.392, 9.584999999999999, 8.902333333333331, 9.148666666666667, 8.219, 9.449333333333332, 8.239999999999998, 6.998333333333334, 6.8039999999999985, 7.749999999999997, 7.414666666666665, 7.202333333333331, 8.707, 7.067666666666666, 7.671999999999999, 8.348666666666666, 6.423, 9.999, 7.860333333333332, 7.470666666666666, 7.0633333333333335, 11.353333333333332, 14.717999999999998, 6.712, 9.795999999999998, 7.936333333333332, 6.477666666666666, 6.49, 5.698333333333332, 7.882333333333332, 9.540666666666661, 7.984333333333333, 6.986999999999999, 8.389333333333333, 6.335999999999999, 5.384, 6.7513333333333305, 8.247333333333332, 6.585666666666666, 7.411666666666666, 8.393666666666665, 7.577, 6.452333333333333, 10.158666666666665, 8.313666666666666, 10.026666666666666, 10.242333333333333, 11.614999999999998, 9.583, 10.232333333333331, 8.952, 6.903333333333332, 6.343333333333334, 9.059333333333335, 7.969, 7.572666666666666, 8.014999999999997, 5.420999999999999, 6.6563333333333325, 8.627666666666666, 10.500999999999998, 8.378999999999998, 8.17, 7.074333333333334, 9.252333333333333, 12.014000000000001, 10.65366666666667, 9.50233333333333, 7.699333333333332, 7.178999999999999, 7.909666666666666, 8.481333333333334, 10.315666666666665, 7.828666666666664, 10.444666666666663, 11.263000000000002, 8.155, 9.012999999999998, 12.463000000000001, 6.419666666666665, 12.717999999999998, 7.744333333333331, 8.769, 8.081999999999997, 6.749999999999999], "episode_lengths": [13, 19, 15, 18, 16, 13, 18, 17, 20, 16, 15, 14, 19, 19, 15, 14, 23, 19, 20, 17, 22, 16, 15, 16, 18, 16, 15, 19, 16, 16, 18, 14, 19, 17, 16, 17, 22, 27, 16, 22, 17, 15, 14, 13, 19, 20, 19, 16, 17, 15, 14, 14, 19, 14, 17, 18, 17, 13, 20, 18, 20, 24, 25, 17, 23, 18, 15, 13, 19, 19, 15, 17, 12, 16, 17, 23, 17, 17, 15, 20, 24, 22, 21, 16, 16, 19, 17, 21, 17, 25, 24, 18, 21, 25, 14, 26, 18, 19, 18, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6200854141135337, "mean_inference_ms": 2.93784770363985, "mean_action_processing_ms": 0.6083412729526719, "mean_env_wait_ms": 0.14842836289046718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02914714813232422, "StateBufferConnector_ms": 0.01255655288696289, "ViewRequirementAgentConnector_ms": 0.5024116039276123}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1230.0259075172019, "num_env_steps_trained_throughput_per_sec": 1230.0259075172019, "timesteps_total": 67200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1171.613, "sample_time_ms": 1135.608, "load_time_ms": 0.508, "load_throughput": 2757725.825, "learn_time_ms": 13.652, "learn_throughput": 102552.011, "synch_weights_time_ms": 21.745}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "done": false, "episodes_total": 3588, "training_iteration": 48, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-54", "timestamp": 1702021194, "time_this_iter_s": 1.1601831912994385, "time_total_s": 57.24636745452881, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.24636745452881, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 94.55, "ram_util_percent": 95.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0954103469848633, "total_loss": 1.0954103469848633, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 68600, "num_env_steps_trained": 68600, "num_agent_steps_sampled": 68600, "num_agent_steps_trained": 68600}, "sampler_results": {"episode_reward_max": 13.422666666666668, "episode_reward_min": 5.733333333333332, "episode_reward_mean": 8.634169999999997, "episode_len_mean": 18.64, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.500999999999998, 8.378999999999998, 8.17, 7.074333333333334, 9.252333333333333, 12.014000000000001, 10.65366666666667, 9.50233333333333, 7.699333333333332, 7.178999999999999, 7.909666666666666, 8.481333333333334, 10.315666666666665, 7.828666666666664, 10.444666666666663, 11.263000000000002, 8.155, 9.012999999999998, 12.463000000000001, 6.419666666666665, 12.717999999999998, 7.744333333333331, 8.769, 8.081999999999997, 6.749999999999999, 6.587999999999999, 9.038666666666666, 7.6579999999999995, 5.733333333333332, 8.341999999999999, 7.214666666666666, 7.766666666666666, 8.241, 7.796666666666668, 9.123666666666667, 8.432999999999998, 6.715666666666666, 10.734666666666666, 10.173333333333334, 8.143333333333333, 7.038666666666667, 9.806333333333331, 7.209999999999999, 6.077333333333333, 7.088000000000001, 9.033, 7.127, 10.235333333333331, 7.508666666666667, 10.452666666666666, 8.724333333333332, 9.576333333333334, 10.232333333333331, 7.321333333333334, 8.492333333333333, 7.642333333333332, 6.745333333333332, 7.987333333333332, 7.439333333333332, 8.722999999999997, 7.488333333333332, 8.293333333333331, 7.270333333333332, 7.354333333333332, 7.511666666666664, 8.75233333333333, 8.280999999999999, 8.050666666666665, 11.215333333333334, 7.093666666666666, 8.626999999999999, 7.409666666666668, 9.002666666666663, 9.996999999999998, 10.934666666666669, 10.213333333333331, 8.120333333333333, 6.940666666666668, 8.070333333333332, 9.023999999999997, 7.783999999999999, 8.595333333333333, 7.034666666666665, 7.798, 9.444333333333333, 13.422666666666668, 6.903999999999999, 8.80433333333333, 8.481666666666666, 6.8629999999999995, 10.142999999999997, 12.28066666666667, 8.614666666666665, 8.205, 7.275333333333333, 10.577, 8.312999999999997, 8.472999999999999, 8.424666666666667, 13.382333333333333], "episode_lengths": [23, 17, 17, 15, 20, 24, 22, 21, 16, 16, 19, 17, 21, 17, 25, 24, 18, 21, 25, 14, 26, 18, 19, 18, 17, 15, 19, 16, 13, 19, 16, 18, 18, 18, 19, 18, 15, 23, 21, 16, 15, 22, 17, 14, 16, 20, 16, 21, 16, 20, 18, 21, 20, 16, 16, 17, 14, 18, 17, 19, 17, 19, 17, 17, 17, 21, 17, 19, 23, 16, 19, 17, 21, 20, 22, 23, 18, 16, 17, 19, 16, 19, 16, 15, 19, 26, 15, 19, 21, 15, 20, 26, 18, 17, 16, 24, 19, 19, 17, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6203948973853353, "mean_inference_ms": 2.936544741568307, "mean_action_processing_ms": 0.6095040510934229, "mean_env_wait_ms": 0.14858788091306155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047345638275146484, "StateBufferConnector_ms": 0.018864870071411133, "ViewRequirementAgentConnector_ms": 0.5437695980072021}}, "episode_reward_max": 13.422666666666668, "episode_reward_min": 5.733333333333332, "episode_reward_mean": 8.634169999999997, "episode_len_mean": 18.64, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.500999999999998, 8.378999999999998, 8.17, 7.074333333333334, 9.252333333333333, 12.014000000000001, 10.65366666666667, 9.50233333333333, 7.699333333333332, 7.178999999999999, 7.909666666666666, 8.481333333333334, 10.315666666666665, 7.828666666666664, 10.444666666666663, 11.263000000000002, 8.155, 9.012999999999998, 12.463000000000001, 6.419666666666665, 12.717999999999998, 7.744333333333331, 8.769, 8.081999999999997, 6.749999999999999, 6.587999999999999, 9.038666666666666, 7.6579999999999995, 5.733333333333332, 8.341999999999999, 7.214666666666666, 7.766666666666666, 8.241, 7.796666666666668, 9.123666666666667, 8.432999999999998, 6.715666666666666, 10.734666666666666, 10.173333333333334, 8.143333333333333, 7.038666666666667, 9.806333333333331, 7.209999999999999, 6.077333333333333, 7.088000000000001, 9.033, 7.127, 10.235333333333331, 7.508666666666667, 10.452666666666666, 8.724333333333332, 9.576333333333334, 10.232333333333331, 7.321333333333334, 8.492333333333333, 7.642333333333332, 6.745333333333332, 7.987333333333332, 7.439333333333332, 8.722999999999997, 7.488333333333332, 8.293333333333331, 7.270333333333332, 7.354333333333332, 7.511666666666664, 8.75233333333333, 8.280999999999999, 8.050666666666665, 11.215333333333334, 7.093666666666666, 8.626999999999999, 7.409666666666668, 9.002666666666663, 9.996999999999998, 10.934666666666669, 10.213333333333331, 8.120333333333333, 6.940666666666668, 8.070333333333332, 9.023999999999997, 7.783999999999999, 8.595333333333333, 7.034666666666665, 7.798, 9.444333333333333, 13.422666666666668, 6.903999999999999, 8.80433333333333, 8.481666666666666, 6.8629999999999995, 10.142999999999997, 12.28066666666667, 8.614666666666665, 8.205, 7.275333333333333, 10.577, 8.312999999999997, 8.472999999999999, 8.424666666666667, 13.382333333333333], "episode_lengths": [23, 17, 17, 15, 20, 24, 22, 21, 16, 16, 19, 17, 21, 17, 25, 24, 18, 21, 25, 14, 26, 18, 19, 18, 17, 15, 19, 16, 13, 19, 16, 18, 18, 18, 19, 18, 15, 23, 21, 16, 15, 22, 17, 14, 16, 20, 16, 21, 16, 20, 18, 21, 20, 16, 16, 17, 14, 18, 17, 19, 17, 19, 17, 17, 17, 21, 17, 19, 23, 16, 19, 17, 21, 20, 22, 23, 18, 16, 17, 19, 16, 19, 16, 15, 19, 26, 15, 19, 21, 15, 20, 26, 18, 17, 16, 24, 19, 19, 17, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6203948973853353, "mean_inference_ms": 2.936544741568307, "mean_action_processing_ms": 0.6095040510934229, "mean_env_wait_ms": 0.14858788091306155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047345638275146484, "StateBufferConnector_ms": 0.018864870071411133, "ViewRequirementAgentConnector_ms": 0.5437695980072021}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68600, "num_agent_steps_trained": 68600, "num_env_steps_sampled": 68600, "num_env_steps_trained": 68600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1106.3943928357508, "num_env_steps_trained_throughput_per_sec": 1106.3943928357508, "timesteps_total": 68600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 68600, "timers": {"training_iteration_time_ms": 1172.322, "sample_time_ms": 1136.535, "load_time_ms": 0.408, "load_throughput": 3435540.37, "learn_time_ms": 13.046, "learn_throughput": 107312.763, "synch_weights_time_ms": 22.234}, "counters": {"num_env_steps_sampled": 68600, "num_env_steps_trained": 68600, "num_agent_steps_sampled": 68600, "num_agent_steps_trained": 68600}, "done": false, "episodes_total": 3663, "training_iteration": 49, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-56", "timestamp": 1702021196, "time_this_iter_s": 1.2813689708709717, "time_total_s": 58.52773642539978, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 58.52773642539978, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 89.85, "ram_util_percent": 95.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0935105085372925, "total_loss": 1.0935105085372925, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "sampler_results": {"episode_reward_max": 13.453000000000001, "episode_reward_min": 6.040666666666667, "episode_reward_mean": 8.863216666666665, "episode_len_mean": 18.88, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.120333333333333, 6.940666666666668, 8.070333333333332, 9.023999999999997, 7.783999999999999, 8.595333333333333, 7.034666666666665, 7.798, 9.444333333333333, 13.422666666666668, 6.903999999999999, 8.80433333333333, 8.481666666666666, 6.8629999999999995, 10.142999999999997, 12.28066666666667, 8.614666666666665, 8.205, 7.275333333333333, 10.577, 8.312999999999997, 8.472999999999999, 8.424666666666667, 13.382333333333333, 8.214333333333332, 6.977000000000001, 11.108, 10.698333333333338, 6.9386666666666645, 7.282666666666666, 13.453000000000001, 8.937333333333333, 6.9256666666666655, 11.389000000000001, 7.068333333333333, 9.449999999999998, 7.127333333333333, 9.233666666666668, 9.285333333333332, 10.677999999999997, 8.57933333333333, 9.291666666666666, 9.681333333333331, 9.443666666666662, 8.524333333333333, 8.459999999999999, 9.944333333333335, 8.32933333333333, 9.026666666666667, 6.8149999999999995, 9.033333333333333, 10.924333333333331, 7.387666666666666, 8.115666666666666, 11.046, 11.889333333333328, 9.460999999999999, 11.98, 8.86933333333333, 6.382999999999998, 9.616000000000003, 10.372, 8.338999999999999, 9.491333333333332, 6.254999999999999, 7.546333333333333, 11.239999999999998, 8.664666666666667, 8.691333333333333, 8.578333333333333, 7.418666666666665, 7.165333333333333, 10.164333333333333, 7.476333333333333, 8.976666666666665, 7.789333333333332, 7.6786666666666665, 11.022999999999998, 8.699666666666667, 8.291666666666664, 8.336666666666664, 8.185333333333332, 9.923333333333332, 8.879333333333332, 7.7703333333333315, 7.211999999999999, 8.361999999999998, 8.39833333333333, 7.419999999999997, 10.577999999999998, 9.452333333333334, 10.319999999999997, 9.935333333333329, 8.879333333333333, 7.067999999999999, 8.194666666666667, 8.672, 6.040666666666667, 8.298333333333334, 9.989999999999998], "episode_lengths": [18, 16, 17, 19, 16, 19, 16, 15, 19, 26, 15, 19, 21, 15, 20, 26, 18, 17, 16, 24, 19, 19, 17, 25, 18, 15, 25, 21, 15, 18, 28, 18, 15, 24, 17, 21, 15, 18, 20, 22, 19, 19, 20, 22, 19, 19, 23, 17, 18, 14, 19, 23, 15, 17, 22, 23, 19, 24, 19, 15, 22, 20, 16, 21, 14, 17, 23, 19, 18, 18, 15, 14, 21, 15, 18, 17, 18, 21, 19, 16, 16, 18, 19, 18, 18, 15, 19, 19, 16, 24, 20, 24, 23, 21, 16, 21, 18, 17, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.617904661337091, "mean_inference_ms": 2.931865873745464, "mean_action_processing_ms": 0.6091398121674643, "mean_env_wait_ms": 0.14803877668109044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03995776176452637, "StateBufferConnector_ms": 0.01462411880493164, "ViewRequirementAgentConnector_ms": 0.46784019470214844}}, "episode_reward_max": 13.453000000000001, "episode_reward_min": 6.040666666666667, "episode_reward_mean": 8.863216666666665, "episode_len_mean": 18.88, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.120333333333333, 6.940666666666668, 8.070333333333332, 9.023999999999997, 7.783999999999999, 8.595333333333333, 7.034666666666665, 7.798, 9.444333333333333, 13.422666666666668, 6.903999999999999, 8.80433333333333, 8.481666666666666, 6.8629999999999995, 10.142999999999997, 12.28066666666667, 8.614666666666665, 8.205, 7.275333333333333, 10.577, 8.312999999999997, 8.472999999999999, 8.424666666666667, 13.382333333333333, 8.214333333333332, 6.977000000000001, 11.108, 10.698333333333338, 6.9386666666666645, 7.282666666666666, 13.453000000000001, 8.937333333333333, 6.9256666666666655, 11.389000000000001, 7.068333333333333, 9.449999999999998, 7.127333333333333, 9.233666666666668, 9.285333333333332, 10.677999999999997, 8.57933333333333, 9.291666666666666, 9.681333333333331, 9.443666666666662, 8.524333333333333, 8.459999999999999, 9.944333333333335, 8.32933333333333, 9.026666666666667, 6.8149999999999995, 9.033333333333333, 10.924333333333331, 7.387666666666666, 8.115666666666666, 11.046, 11.889333333333328, 9.460999999999999, 11.98, 8.86933333333333, 6.382999999999998, 9.616000000000003, 10.372, 8.338999999999999, 9.491333333333332, 6.254999999999999, 7.546333333333333, 11.239999999999998, 8.664666666666667, 8.691333333333333, 8.578333333333333, 7.418666666666665, 7.165333333333333, 10.164333333333333, 7.476333333333333, 8.976666666666665, 7.789333333333332, 7.6786666666666665, 11.022999999999998, 8.699666666666667, 8.291666666666664, 8.336666666666664, 8.185333333333332, 9.923333333333332, 8.879333333333332, 7.7703333333333315, 7.211999999999999, 8.361999999999998, 8.39833333333333, 7.419999999999997, 10.577999999999998, 9.452333333333334, 10.319999999999997, 9.935333333333329, 8.879333333333333, 7.067999999999999, 8.194666666666667, 8.672, 6.040666666666667, 8.298333333333334, 9.989999999999998], "episode_lengths": [18, 16, 17, 19, 16, 19, 16, 15, 19, 26, 15, 19, 21, 15, 20, 26, 18, 17, 16, 24, 19, 19, 17, 25, 18, 15, 25, 21, 15, 18, 28, 18, 15, 24, 17, 21, 15, 18, 20, 22, 19, 19, 20, 22, 19, 19, 23, 17, 18, 14, 19, 23, 15, 17, 22, 23, 19, 24, 19, 15, 22, 20, 16, 21, 14, 17, 23, 19, 18, 18, 15, 14, 21, 15, 18, 17, 18, 21, 19, 16, 16, 18, 19, 18, 18, 15, 19, 19, 16, 24, 20, 24, 23, 21, 16, 21, 18, 17, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.617904661337091, "mean_inference_ms": 2.931865873745464, "mean_action_processing_ms": 0.6091398121674643, "mean_env_wait_ms": 0.14803877668109044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03995776176452637, "StateBufferConnector_ms": 0.01462411880493164, "ViewRequirementAgentConnector_ms": 0.46784019470214844}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1378.3521721392863, "num_env_steps_trained_throughput_per_sec": 1378.3521721392863, "timesteps_total": 70000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 1133.794, "sample_time_ms": 1096.812, "load_time_ms": 0.408, "load_throughput": 3435540.37, "learn_time_ms": 13.353, "learn_throughput": 104848.987, "synch_weights_time_ms": 23.122}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "done": false, "episodes_total": 3739, "training_iteration": 50, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-57", "timestamp": 1702021197, "time_this_iter_s": 1.0487048625946045, "time_total_s": 59.576441287994385, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.576441287994385, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 93.8, "ram_util_percent": 95.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0918985605239868, "total_loss": 1.0918985605239868, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 71400, "num_env_steps_trained": 71400, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71400}, "sampler_results": {"episode_reward_max": 11.760666666666665, "episode_reward_min": 5.780666666666667, "episode_reward_mean": 8.599696666666667, "episode_len_mean": 18.41, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.789333333333332, 7.6786666666666665, 11.022999999999998, 8.699666666666667, 8.291666666666664, 8.336666666666664, 8.185333333333332, 9.923333333333332, 8.879333333333332, 7.7703333333333315, 7.211999999999999, 8.361999999999998, 8.39833333333333, 7.419999999999997, 10.577999999999998, 9.452333333333334, 10.319999999999997, 9.935333333333329, 8.879333333333333, 7.067999999999999, 8.194666666666667, 8.672, 6.040666666666667, 8.298333333333334, 9.989999999999998, 10.211666666666664, 8.482999999999999, 10.458666666666664, 10.866999999999997, 9.248999999999999, 10.858666666666663, 11.174, 10.026, 7.316666666666666, 9.837666666666665, 9.786666666666665, 9.819666666666668, 5.780666666666667, 8.032999999999998, 7.127999999999998, 11.347999999999995, 6.9753333333333325, 11.214333333333332, 6.902666666666666, 9.264666666666667, 7.413666666666665, 9.291333333333336, 7.865, 7.500666666666663, 10.49133333333333, 8.080666666666664, 8.431, 9.805999999999997, 9.307333333333332, 8.712666666666665, 7.880999999999998, 8.589666666666666, 6.818666666666665, 7.704000000000001, 7.558999999999999, 7.983666666666666, 9.204333333333334, 6.544666666666666, 7.476, 8.233999999999998, 8.809333333333335, 6.779333333333334, 8.759333333333332, 7.594666666666667, 7.256666666666665, 10.517333333333335, 6.840333333333334, 6.539000000000001, 6.841999999999999, 11.346666666666666, 8.447333333333335, 7.513, 8.007, 8.354333333333331, 8.683666666666666, 11.760666666666665, 7.3263333333333325, 5.837000000000001, 10.222666666666667, 7.256999999999999, 8.648999999999997, 8.146, 10.512999999999998, 9.087, 11.193000000000001, 9.097, 8.153, 7.520999999999997, 8.312333333333331, 7.248666666666665, 8.858666666666666, 8.975666666666664, 8.041333333333334, 7.7063333333333315, 8.745666666666667], "episode_lengths": [17, 18, 21, 19, 16, 16, 18, 19, 18, 18, 15, 19, 19, 16, 24, 20, 24, 23, 21, 16, 21, 18, 17, 17, 19, 20, 18, 23, 22, 18, 21, 24, 21, 16, 23, 19, 23, 13, 17, 15, 25, 16, 23, 15, 19, 17, 20, 19, 16, 21, 17, 17, 19, 22, 19, 16, 19, 15, 17, 15, 17, 20, 15, 15, 18, 20, 16, 17, 16, 15, 21, 14, 15, 14, 23, 19, 16, 15, 18, 22, 23, 16, 13, 24, 17, 17, 18, 21, 17, 26, 19, 17, 17, 17, 17, 17, 19, 16, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.617917151183849, "mean_inference_ms": 2.9308250659459985, "mean_action_processing_ms": 0.6099005845557034, "mean_env_wait_ms": 0.14765273285419217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0315251350402832, "StateBufferConnector_ms": 0.012939453125, "ViewRequirementAgentConnector_ms": 0.4645073413848877}}, "episode_reward_max": 11.760666666666665, "episode_reward_min": 5.780666666666667, "episode_reward_mean": 8.599696666666667, "episode_len_mean": 18.41, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.789333333333332, 7.6786666666666665, 11.022999999999998, 8.699666666666667, 8.291666666666664, 8.336666666666664, 8.185333333333332, 9.923333333333332, 8.879333333333332, 7.7703333333333315, 7.211999999999999, 8.361999999999998, 8.39833333333333, 7.419999999999997, 10.577999999999998, 9.452333333333334, 10.319999999999997, 9.935333333333329, 8.879333333333333, 7.067999999999999, 8.194666666666667, 8.672, 6.040666666666667, 8.298333333333334, 9.989999999999998, 10.211666666666664, 8.482999999999999, 10.458666666666664, 10.866999999999997, 9.248999999999999, 10.858666666666663, 11.174, 10.026, 7.316666666666666, 9.837666666666665, 9.786666666666665, 9.819666666666668, 5.780666666666667, 8.032999999999998, 7.127999999999998, 11.347999999999995, 6.9753333333333325, 11.214333333333332, 6.902666666666666, 9.264666666666667, 7.413666666666665, 9.291333333333336, 7.865, 7.500666666666663, 10.49133333333333, 8.080666666666664, 8.431, 9.805999999999997, 9.307333333333332, 8.712666666666665, 7.880999999999998, 8.589666666666666, 6.818666666666665, 7.704000000000001, 7.558999999999999, 7.983666666666666, 9.204333333333334, 6.544666666666666, 7.476, 8.233999999999998, 8.809333333333335, 6.779333333333334, 8.759333333333332, 7.594666666666667, 7.256666666666665, 10.517333333333335, 6.840333333333334, 6.539000000000001, 6.841999999999999, 11.346666666666666, 8.447333333333335, 7.513, 8.007, 8.354333333333331, 8.683666666666666, 11.760666666666665, 7.3263333333333325, 5.837000000000001, 10.222666666666667, 7.256999999999999, 8.648999999999997, 8.146, 10.512999999999998, 9.087, 11.193000000000001, 9.097, 8.153, 7.520999999999997, 8.312333333333331, 7.248666666666665, 8.858666666666666, 8.975666666666664, 8.041333333333334, 7.7063333333333315, 8.745666666666667], "episode_lengths": [17, 18, 21, 19, 16, 16, 18, 19, 18, 18, 15, 19, 19, 16, 24, 20, 24, 23, 21, 16, 21, 18, 17, 17, 19, 20, 18, 23, 22, 18, 21, 24, 21, 16, 23, 19, 23, 13, 17, 15, 25, 16, 23, 15, 19, 17, 20, 19, 16, 21, 17, 17, 19, 22, 19, 16, 19, 15, 17, 15, 17, 20, 15, 15, 18, 20, 16, 17, 16, 15, 21, 14, 15, 14, 23, 19, 16, 15, 18, 22, 23, 16, 13, 24, 17, 17, 18, 21, 17, 26, 19, 17, 17, 17, 17, 17, 19, 16, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.617917151183849, "mean_inference_ms": 2.9308250659459985, "mean_action_processing_ms": 0.6099005845557034, "mean_env_wait_ms": 0.14765273285419217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0315251350402832, "StateBufferConnector_ms": 0.012939453125, "ViewRequirementAgentConnector_ms": 0.4645073413848877}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71400, "num_env_steps_sampled": 71400, "num_env_steps_trained": 71400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1182.1577102639108, "num_env_steps_trained_throughput_per_sec": 1182.1577102639108, "timesteps_total": 71400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 71400, "timers": {"training_iteration_time_ms": 1116.054, "sample_time_ms": 1078.47, "load_time_ms": 0.408, "load_throughput": 3435540.37, "learn_time_ms": 13.613, "learn_throughput": 102839.918, "synch_weights_time_ms": 23.463}, "counters": {"num_env_steps_sampled": 71400, "num_env_steps_trained": 71400, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71400}, "done": false, "episodes_total": 3814, "training_iteration": 51, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-58", "timestamp": 1702021198, "time_this_iter_s": 1.2112531661987305, "time_total_s": 60.787694454193115, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 60.787694454193115, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 93.75, "ram_util_percent": 96.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0928709506988525, "total_loss": 1.0928709506988525, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 72800, "num_env_steps_trained": 72800, "num_agent_steps_sampled": 72800, "num_agent_steps_trained": 72800}, "sampler_results": {"episode_reward_max": 13.302333333333328, "episode_reward_min": 5.837000000000001, "episode_reward_mean": 8.526739999999998, "episode_len_mean": 18.03, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.354333333333331, 8.683666666666666, 11.760666666666665, 7.3263333333333325, 5.837000000000001, 10.222666666666667, 7.256999999999999, 8.648999999999997, 8.146, 10.512999999999998, 9.087, 11.193000000000001, 9.097, 8.153, 7.520999999999997, 8.312333333333331, 7.248666666666665, 8.858666666666666, 8.975666666666664, 8.041333333333334, 7.7063333333333315, 8.745666666666667, 8.991999999999997, 6.624666666666666, 8.809999999999999, 8.781666666666666, 9.176666666666666, 12.119999999999997, 7.257333333333332, 7.152999999999999, 7.753333333333334, 10.044333333333334, 8.585999999999999, 9.082999999999998, 10.428666666666665, 7.948999999999998, 7.550333333333331, 9.948333333333334, 6.243999999999999, 8.749333333333333, 9.460666666666667, 11.678666666666667, 12.445999999999996, 7.284999999999999, 13.302333333333328, 7.025999999999999, 7.196666666666666, 7.1259999999999994, 7.518666666666667, 9.939000000000002, 9.299999999999997, 8.958, 8.32, 8.287333333333335, 10.534999999999998, 7.9993333333333325, 9.545333333333334, 8.545666666666664, 7.592, 8.848666666666665, 7.335000000000001, 11.368666666666662, 8.833666666666668, 7.274666666666666, 9.360333333333333, 8.612999999999998, 9.287666666666667, 8.309333333333331, 7.4723333333333315, 7.175999999999999, 7.868666666666667, 8.380333333333333, 7.727, 7.531333333333333, 6.568666666666665, 7.078333333333333, 9.717333333333334, 7.111666666666665, 8.147666666666664, 7.217666666666666, 8.634999999999998, 7.107333333333331, 6.928333333333333, 8.663999999999998, 7.220000000000001, 8.388666666666666, 8.225999999999999, 8.523666666666665, 10.188666666666663, 8.695666666666666, 7.134999999999999, 10.772999999999994, 6.872333333333333, 11.18866666666667, 7.148, 9.673999999999996, 6.741999999999998, 8.178999999999998, 6.749333333333331, 7.4046666666666665], "episode_lengths": [18, 22, 23, 16, 13, 24, 17, 17, 18, 21, 17, 26, 19, 17, 17, 17, 17, 17, 19, 16, 16, 19, 17, 14, 18, 19, 19, 23, 16, 15, 16, 22, 18, 18, 20, 16, 16, 21, 13, 18, 20, 26, 26, 15, 27, 17, 15, 15, 16, 22, 20, 19, 19, 18, 20, 17, 20, 18, 16, 17, 17, 22, 20, 16, 18, 16, 19, 16, 16, 15, 16, 18, 16, 15, 14, 15, 19, 15, 19, 15, 19, 16, 15, 19, 16, 19, 19, 19, 22, 20, 16, 21, 15, 22, 15, 20, 14, 19, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6156548757605182, "mean_inference_ms": 2.929987026548049, "mean_action_processing_ms": 0.6103781296045577, "mean_env_wait_ms": 0.1477042349004736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499985694885254, "StateBufferConnector_ms": 0.015106201171875, "ViewRequirementAgentConnector_ms": 0.517268180847168}}, "episode_reward_max": 13.302333333333328, "episode_reward_min": 5.837000000000001, "episode_reward_mean": 8.526739999999998, "episode_len_mean": 18.03, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.354333333333331, 8.683666666666666, 11.760666666666665, 7.3263333333333325, 5.837000000000001, 10.222666666666667, 7.256999999999999, 8.648999999999997, 8.146, 10.512999999999998, 9.087, 11.193000000000001, 9.097, 8.153, 7.520999999999997, 8.312333333333331, 7.248666666666665, 8.858666666666666, 8.975666666666664, 8.041333333333334, 7.7063333333333315, 8.745666666666667, 8.991999999999997, 6.624666666666666, 8.809999999999999, 8.781666666666666, 9.176666666666666, 12.119999999999997, 7.257333333333332, 7.152999999999999, 7.753333333333334, 10.044333333333334, 8.585999999999999, 9.082999999999998, 10.428666666666665, 7.948999999999998, 7.550333333333331, 9.948333333333334, 6.243999999999999, 8.749333333333333, 9.460666666666667, 11.678666666666667, 12.445999999999996, 7.284999999999999, 13.302333333333328, 7.025999999999999, 7.196666666666666, 7.1259999999999994, 7.518666666666667, 9.939000000000002, 9.299999999999997, 8.958, 8.32, 8.287333333333335, 10.534999999999998, 7.9993333333333325, 9.545333333333334, 8.545666666666664, 7.592, 8.848666666666665, 7.335000000000001, 11.368666666666662, 8.833666666666668, 7.274666666666666, 9.360333333333333, 8.612999999999998, 9.287666666666667, 8.309333333333331, 7.4723333333333315, 7.175999999999999, 7.868666666666667, 8.380333333333333, 7.727, 7.531333333333333, 6.568666666666665, 7.078333333333333, 9.717333333333334, 7.111666666666665, 8.147666666666664, 7.217666666666666, 8.634999999999998, 7.107333333333331, 6.928333333333333, 8.663999999999998, 7.220000000000001, 8.388666666666666, 8.225999999999999, 8.523666666666665, 10.188666666666663, 8.695666666666666, 7.134999999999999, 10.772999999999994, 6.872333333333333, 11.18866666666667, 7.148, 9.673999999999996, 6.741999999999998, 8.178999999999998, 6.749333333333331, 7.4046666666666665], "episode_lengths": [18, 22, 23, 16, 13, 24, 17, 17, 18, 21, 17, 26, 19, 17, 17, 17, 17, 17, 19, 16, 16, 19, 17, 14, 18, 19, 19, 23, 16, 15, 16, 22, 18, 18, 20, 16, 16, 21, 13, 18, 20, 26, 26, 15, 27, 17, 15, 15, 16, 22, 20, 19, 19, 18, 20, 17, 20, 18, 16, 17, 17, 22, 20, 16, 18, 16, 19, 16, 16, 15, 16, 18, 16, 15, 14, 15, 19, 15, 19, 15, 19, 16, 15, 19, 16, 19, 19, 19, 22, 20, 16, 21, 15, 22, 15, 20, 14, 19, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6156548757605182, "mean_inference_ms": 2.929987026548049, "mean_action_processing_ms": 0.6103781296045577, "mean_env_wait_ms": 0.1477042349004736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499985694885254, "StateBufferConnector_ms": 0.015106201171875, "ViewRequirementAgentConnector_ms": 0.517268180847168}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72800, "num_agent_steps_trained": 72800, "num_env_steps_sampled": 72800, "num_env_steps_trained": 72800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1296.6553415916728, "num_env_steps_trained_throughput_per_sec": 1296.6553415916728, "timesteps_total": 72800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 72800, "timers": {"training_iteration_time_ms": 1099.045, "sample_time_ms": 1061.586, "load_time_ms": 0.408, "load_throughput": 3435540.37, "learn_time_ms": 13.513, "learn_throughput": 103600.519, "synch_weights_time_ms": 23.438}, "counters": {"num_env_steps_sampled": 72800, "num_env_steps_trained": 72800, "num_agent_steps_sampled": 72800, "num_agent_steps_trained": 72800}, "done": false, "episodes_total": 3892, "training_iteration": 52, "trial_id": "b37b2_00000", "date": "2023-12-07_23-39-59", "timestamp": 1702021199, "time_this_iter_s": 1.0996971130371094, "time_total_s": 61.887391567230225, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 61.887391567230225, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 89.2, "ram_util_percent": 96.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0914340019226074, "total_loss": 1.0914340019226074, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 74200, "num_env_steps_trained": 74200, "num_agent_steps_sampled": 74200, "num_agent_steps_trained": 74200}, "sampler_results": {"episode_reward_max": 13.492999999999999, "episode_reward_min": 6.116999999999999, "episode_reward_mean": 8.432003333333332, "episode_len_mean": 18.17, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.111666666666665, 8.147666666666664, 7.217666666666666, 8.634999999999998, 7.107333333333331, 6.928333333333333, 8.663999999999998, 7.220000000000001, 8.388666666666666, 8.225999999999999, 8.523666666666665, 10.188666666666663, 8.695666666666666, 7.134999999999999, 10.772999999999994, 6.872333333333333, 11.18866666666667, 7.148, 9.673999999999996, 6.741999999999998, 8.178999999999998, 6.749333333333331, 7.4046666666666665, 9.320666666666666, 8.246333333333332, 6.5313333333333325, 7.001999999999998, 8.719, 7.399000000000001, 8.856666666666667, 7.859666666666666, 8.613999999999999, 7.409999999999998, 8.948, 7.5809999999999995, 8.056, 7.758666666666664, 8.361666666666665, 10.357999999999999, 10.545666666666662, 8.81433333333333, 10.013666666666666, 6.689666666666667, 9.496666666666666, 13.444666666666668, 13.492999999999999, 9.889999999999995, 8.266666666666666, 7.470999999999997, 7.876666666666665, 6.402333333333332, 6.556333333333333, 8.271333333333331, 8.737666666666666, 8.825333333333331, 9.039666666666665, 8.858666666666664, 6.3423333333333325, 7.429666666666668, 9.096666666666668, 11.677666666666667, 7.987666666666665, 6.116999999999999, 10.444666666666667, 6.2606666666666655, 6.248999999999999, 8.974333333333332, 7.969666666666668, 9.383666666666668, 7.260666666666665, 8.510333333333334, 9.929666666666664, 7.7333333333333325, 10.048, 7.6819999999999995, 6.563000000000001, 7.7366666666666655, 7.158999999999999, 7.348333333333334, 10.495666666666668, 6.149, 10.266666666666666, 10.158999999999999, 7.301999999999999, 9.565999999999999, 6.956666666666666, 10.71133333333333, 7.238, 8.819666666666667, 8.975666666666667, 6.979666666666667, 12.543999999999997, 7.753666666666665, 7.7446666666666655, 7.487666666666668, 9.374666666666666, 8.198999999999996, 10.395, 8.424333333333335, 9.11833333333333], "episode_lengths": [15, 19, 15, 19, 16, 15, 19, 16, 19, 19, 19, 22, 20, 16, 21, 15, 22, 15, 20, 14, 19, 16, 16, 19, 17, 14, 15, 17, 15, 19, 17, 19, 15, 24, 15, 18, 16, 18, 21, 20, 20, 20, 17, 22, 26, 28, 21, 17, 16, 17, 15, 14, 18, 18, 19, 19, 22, 14, 16, 18, 22, 15, 15, 26, 15, 13, 20, 18, 19, 16, 20, 21, 16, 23, 16, 15, 17, 16, 15, 21, 14, 20, 21, 15, 20, 14, 22, 16, 17, 20, 17, 30, 18, 16, 16, 20, 18, 21, 19, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6143264299145061, "mean_inference_ms": 2.930064299852811, "mean_action_processing_ms": 0.6106949671502689, "mean_env_wait_ms": 0.14756509222907452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018373966217041016, "StateBufferConnector_ms": 0.01502227783203125, "ViewRequirementAgentConnector_ms": 0.5302639007568359}}, "episode_reward_max": 13.492999999999999, "episode_reward_min": 6.116999999999999, "episode_reward_mean": 8.432003333333332, "episode_len_mean": 18.17, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.111666666666665, 8.147666666666664, 7.217666666666666, 8.634999999999998, 7.107333333333331, 6.928333333333333, 8.663999999999998, 7.220000000000001, 8.388666666666666, 8.225999999999999, 8.523666666666665, 10.188666666666663, 8.695666666666666, 7.134999999999999, 10.772999999999994, 6.872333333333333, 11.18866666666667, 7.148, 9.673999999999996, 6.741999999999998, 8.178999999999998, 6.749333333333331, 7.4046666666666665, 9.320666666666666, 8.246333333333332, 6.5313333333333325, 7.001999999999998, 8.719, 7.399000000000001, 8.856666666666667, 7.859666666666666, 8.613999999999999, 7.409999999999998, 8.948, 7.5809999999999995, 8.056, 7.758666666666664, 8.361666666666665, 10.357999999999999, 10.545666666666662, 8.81433333333333, 10.013666666666666, 6.689666666666667, 9.496666666666666, 13.444666666666668, 13.492999999999999, 9.889999999999995, 8.266666666666666, 7.470999999999997, 7.876666666666665, 6.402333333333332, 6.556333333333333, 8.271333333333331, 8.737666666666666, 8.825333333333331, 9.039666666666665, 8.858666666666664, 6.3423333333333325, 7.429666666666668, 9.096666666666668, 11.677666666666667, 7.987666666666665, 6.116999999999999, 10.444666666666667, 6.2606666666666655, 6.248999999999999, 8.974333333333332, 7.969666666666668, 9.383666666666668, 7.260666666666665, 8.510333333333334, 9.929666666666664, 7.7333333333333325, 10.048, 7.6819999999999995, 6.563000000000001, 7.7366666666666655, 7.158999999999999, 7.348333333333334, 10.495666666666668, 6.149, 10.266666666666666, 10.158999999999999, 7.301999999999999, 9.565999999999999, 6.956666666666666, 10.71133333333333, 7.238, 8.819666666666667, 8.975666666666667, 6.979666666666667, 12.543999999999997, 7.753666666666665, 7.7446666666666655, 7.487666666666668, 9.374666666666666, 8.198999999999996, 10.395, 8.424333333333335, 9.11833333333333], "episode_lengths": [15, 19, 15, 19, 16, 15, 19, 16, 19, 19, 19, 22, 20, 16, 21, 15, 22, 15, 20, 14, 19, 16, 16, 19, 17, 14, 15, 17, 15, 19, 17, 19, 15, 24, 15, 18, 16, 18, 21, 20, 20, 20, 17, 22, 26, 28, 21, 17, 16, 17, 15, 14, 18, 18, 19, 19, 22, 14, 16, 18, 22, 15, 15, 26, 15, 13, 20, 18, 19, 16, 20, 21, 16, 23, 16, 15, 17, 16, 15, 21, 14, 20, 21, 15, 20, 14, 22, 16, 17, 20, 17, 30, 18, 16, 16, 20, 18, 21, 19, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6143264299145061, "mean_inference_ms": 2.930064299852811, "mean_action_processing_ms": 0.6106949671502689, "mean_env_wait_ms": 0.14756509222907452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018373966217041016, "StateBufferConnector_ms": 0.01502227783203125, "ViewRequirementAgentConnector_ms": 0.5302639007568359}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74200, "num_agent_steps_trained": 74200, "num_env_steps_sampled": 74200, "num_env_steps_trained": 74200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1196.4918815364094, "num_env_steps_trained_throughput_per_sec": 1196.4918815364094, "timesteps_total": 74200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 74200, "timers": {"training_iteration_time_ms": 1115.809, "sample_time_ms": 1079.358, "load_time_ms": 0.406, "load_throughput": 3448655.43, "learn_time_ms": 13.325, "learn_throughput": 105066.983, "synch_weights_time_ms": 22.531}, "counters": {"num_env_steps_sampled": 74200, "num_env_steps_trained": 74200, "num_agent_steps_sampled": 74200, "num_agent_steps_trained": 74200}, "done": false, "episodes_total": 3969, "training_iteration": 53, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-00", "timestamp": 1702021200, "time_this_iter_s": 1.1950902938842773, "time_total_s": 63.0824818611145, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 63.0824818611145, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 95.5, "ram_util_percent": 96.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.1012226343154907, "total_loss": 1.1012226343154907, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 75600, "num_env_steps_trained": 75600, "num_agent_steps_sampled": 75600, "num_agent_steps_trained": 75600}, "sampler_results": {"episode_reward_max": 14.335666666666661, "episode_reward_min": 5.777666666666667, "episode_reward_mean": 8.772566666666664, "episode_len_mean": 18.52, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.563000000000001, 7.7366666666666655, 7.158999999999999, 7.348333333333334, 10.495666666666668, 6.149, 10.266666666666666, 10.158999999999999, 7.301999999999999, 9.565999999999999, 6.956666666666666, 10.71133333333333, 7.238, 8.819666666666667, 8.975666666666667, 6.979666666666667, 12.543999999999997, 7.753666666666665, 7.7446666666666655, 7.487666666666668, 9.374666666666666, 8.198999999999996, 10.395, 8.424333333333335, 9.11833333333333, 7.442666666666667, 6.202666666666665, 8.28133333333333, 7.889333333333332, 7.562666666666662, 11.701999999999995, 9.275999999999994, 7.412333333333332, 7.069666666666666, 9.751333333333331, 8.878, 11.529999999999996, 8.600999999999997, 7.414999999999998, 9.088666666666667, 8.797999999999998, 7.312666666666668, 5.777666666666667, 9.170333333333332, 6.560333333333332, 9.143333333333333, 7.714666666666664, 10.99866666666667, 11.809, 8.315333333333331, 8.332333333333331, 6.561333333333332, 10.22733333333333, 7.650333333333331, 9.577333333333332, 9.528999999999998, 9.543666666666667, 8.058333333333334, 9.076999999999998, 11.655333333333328, 7.436333333333333, 13.301333333333332, 9.62, 6.927333333333333, 9.812666666666667, 11.244999999999997, 8.196, 13.051333333333332, 7.578666666666665, 13.000000000000002, 8.385333333333332, 9.338666666666665, 7.434333333333333, 6.861666666666666, 7.062666666666668, 7.463666666666665, 11.315333333333331, 6.905666666666665, 8.027666666666665, 8.193666666666665, 8.95133333333333, 8.220333333333333, 9.158, 8.190666666666665, 8.981333333333334, 9.084999999999999, 9.334999999999999, 7.272666666666666, 9.009999999999998, 8.353333333333332, 7.775999999999998, 8.895333333333333, 6.095333333333333, 7.854, 9.467, 11.822666666666663, 14.335666666666661, 7.945666666666665, 8.624999999999998, 9.342666666666666], "episode_lengths": [15, 17, 16, 15, 21, 14, 20, 21, 15, 20, 14, 22, 16, 17, 20, 17, 30, 18, 16, 16, 20, 18, 21, 19, 21, 17, 14, 17, 17, 18, 21, 20, 15, 16, 19, 18, 24, 17, 18, 18, 19, 16, 13, 20, 14, 21, 17, 23, 24, 16, 18, 14, 21, 18, 20, 20, 20, 16, 19, 25, 16, 27, 18, 18, 21, 24, 16, 25, 16, 25, 17, 21, 15, 15, 16, 18, 21, 15, 16, 19, 18, 16, 19, 17, 18, 18, 20, 16, 18, 19, 17, 18, 14, 17, 21, 22, 25, 18, 20, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6210839110632977, "mean_inference_ms": 2.946060948086907, "mean_action_processing_ms": 0.6114400262859865, "mean_env_wait_ms": 0.1478956598716006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027755260467529297, "StateBufferConnector_ms": 0.019775390625, "ViewRequirementAgentConnector_ms": 0.6091203689575195}}, "episode_reward_max": 14.335666666666661, "episode_reward_min": 5.777666666666667, "episode_reward_mean": 8.772566666666664, "episode_len_mean": 18.52, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.563000000000001, 7.7366666666666655, 7.158999999999999, 7.348333333333334, 10.495666666666668, 6.149, 10.266666666666666, 10.158999999999999, 7.301999999999999, 9.565999999999999, 6.956666666666666, 10.71133333333333, 7.238, 8.819666666666667, 8.975666666666667, 6.979666666666667, 12.543999999999997, 7.753666666666665, 7.7446666666666655, 7.487666666666668, 9.374666666666666, 8.198999999999996, 10.395, 8.424333333333335, 9.11833333333333, 7.442666666666667, 6.202666666666665, 8.28133333333333, 7.889333333333332, 7.562666666666662, 11.701999999999995, 9.275999999999994, 7.412333333333332, 7.069666666666666, 9.751333333333331, 8.878, 11.529999999999996, 8.600999999999997, 7.414999999999998, 9.088666666666667, 8.797999999999998, 7.312666666666668, 5.777666666666667, 9.170333333333332, 6.560333333333332, 9.143333333333333, 7.714666666666664, 10.99866666666667, 11.809, 8.315333333333331, 8.332333333333331, 6.561333333333332, 10.22733333333333, 7.650333333333331, 9.577333333333332, 9.528999999999998, 9.543666666666667, 8.058333333333334, 9.076999999999998, 11.655333333333328, 7.436333333333333, 13.301333333333332, 9.62, 6.927333333333333, 9.812666666666667, 11.244999999999997, 8.196, 13.051333333333332, 7.578666666666665, 13.000000000000002, 8.385333333333332, 9.338666666666665, 7.434333333333333, 6.861666666666666, 7.062666666666668, 7.463666666666665, 11.315333333333331, 6.905666666666665, 8.027666666666665, 8.193666666666665, 8.95133333333333, 8.220333333333333, 9.158, 8.190666666666665, 8.981333333333334, 9.084999999999999, 9.334999999999999, 7.272666666666666, 9.009999999999998, 8.353333333333332, 7.775999999999998, 8.895333333333333, 6.095333333333333, 7.854, 9.467, 11.822666666666663, 14.335666666666661, 7.945666666666665, 8.624999999999998, 9.342666666666666], "episode_lengths": [15, 17, 16, 15, 21, 14, 20, 21, 15, 20, 14, 22, 16, 17, 20, 17, 30, 18, 16, 16, 20, 18, 21, 19, 21, 17, 14, 17, 17, 18, 21, 20, 15, 16, 19, 18, 24, 17, 18, 18, 19, 16, 13, 20, 14, 21, 17, 23, 24, 16, 18, 14, 21, 18, 20, 20, 20, 16, 19, 25, 16, 27, 18, 18, 21, 24, 16, 25, 16, 25, 17, 21, 15, 15, 16, 18, 21, 15, 16, 19, 18, 16, 19, 17, 18, 18, 20, 16, 18, 19, 17, 18, 14, 17, 21, 22, 25, 18, 20, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6210839110632977, "mean_inference_ms": 2.946060948086907, "mean_action_processing_ms": 0.6114400262859865, "mean_env_wait_ms": 0.1478956598716006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027755260467529297, "StateBufferConnector_ms": 0.019775390625, "ViewRequirementAgentConnector_ms": 0.6091203689575195}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75600, "num_agent_steps_trained": 75600, "num_env_steps_sampled": 75600, "num_env_steps_trained": 75600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 934.6427187797744, "num_env_steps_trained_throughput_per_sec": 934.6427187797744, "timesteps_total": 75600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 75600, "timers": {"training_iteration_time_ms": 1165.643, "sample_time_ms": 1129.493, "load_time_ms": 0.453, "load_throughput": 3090539.789, "learn_time_ms": 13.078, "learn_throughput": 107050.218, "synch_weights_time_ms": 22.53}, "counters": {"num_env_steps_sampled": 75600, "num_env_steps_trained": 75600, "num_agent_steps_sampled": 75600, "num_agent_steps_trained": 75600}, "done": false, "episodes_total": 4044, "training_iteration": 54, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-02", "timestamp": 1702021202, "time_this_iter_s": 1.5128977298736572, "time_total_s": 64.59537959098816, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 64.59537959098816, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 97.6, "ram_util_percent": 96.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0958731174468994, "total_loss": 1.0958731174468994, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 77000, "num_env_steps_trained": 77000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 77000}, "sampler_results": {"episode_reward_max": 14.335666666666661, "episode_reward_min": 5.851666666666666, "episode_reward_mean": 8.597326666666666, "episode_len_mean": 18.34, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.463666666666665, 11.315333333333331, 6.905666666666665, 8.027666666666665, 8.193666666666665, 8.95133333333333, 8.220333333333333, 9.158, 8.190666666666665, 8.981333333333334, 9.084999999999999, 9.334999999999999, 7.272666666666666, 9.009999999999998, 8.353333333333332, 7.775999999999998, 8.895333333333333, 6.095333333333333, 7.854, 9.467, 11.822666666666663, 14.335666666666661, 7.945666666666665, 8.624999999999998, 9.342666666666666, 10.70966666666666, 8.754999999999999, 9.101666666666667, 8.97133333333333, 7.207333333333333, 6.011333333333332, 6.3953333333333315, 7.644333333333332, 9.232666666666665, 7.139333333333332, 9.141999999999996, 9.451, 7.122999999999999, 8.498, 7.347666666666668, 8.872, 8.409999999999997, 6.544333333333333, 11.796999999999999, 6.561333333333332, 10.185666666666666, 8.329999999999998, 8.215, 10.254666666666665, 7.760999999999999, 11.088333333333335, 7.744, 11.990000000000002, 8.602, 9.210666666666665, 8.436333333333334, 6.355999999999999, 9.752999999999997, 9.17633333333333, 5.851666666666666, 7.787999999999999, 8.913666666666666, 6.0520000000000005, 11.589999999999998, 7.021666666666667, 7.578333333333333, 8.842666666666668, 7.506666666666666, 10.304999999999998, 9.11233333333333, 8.957333333333333, 11.194333333333331, 8.004, 9.58433333333333, 8.241999999999999, 6.738666666666666, 6.687333333333332, 8.094666666666667, 7.063666666666666, 8.636, 8.950999999999997, 10.054333333333332, 6.808333333333334, 9.449666666666664, 8.278333333333332, 10.092666666666664, 8.254333333333332, 11.20833333333333, 6.0743333333333345, 7.2363333333333335, 9.903333333333332, 6.507666666666666, 6.915333333333334, 7.290666666666665, 10.151333333333337, 8.361999999999998, 11.166666666666664, 7.230666666666666, 9.45033333333333, 9.942333333333334], "episode_lengths": [18, 21, 15, 16, 19, 18, 16, 19, 17, 18, 18, 20, 16, 18, 19, 17, 18, 14, 17, 21, 22, 25, 18, 20, 20, 23, 20, 19, 20, 16, 13, 15, 15, 20, 16, 23, 19, 17, 19, 16, 16, 18, 15, 23, 16, 21, 19, 19, 23, 18, 26, 18, 23, 19, 20, 19, 14, 21, 20, 13, 17, 17, 13, 24, 15, 15, 18, 15, 22, 19, 21, 25, 16, 20, 16, 14, 15, 18, 16, 17, 19, 25, 16, 19, 17, 20, 16, 25, 13, 16, 20, 14, 14, 16, 21, 16, 23, 17, 20, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.617172951998019, "mean_inference_ms": 2.9457708882007267, "mean_action_processing_ms": 0.6105673437871805, "mean_env_wait_ms": 0.14735528097830758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020084619522094727, "StateBufferConnector_ms": 0.01725625991821289, "ViewRequirementAgentConnector_ms": 0.46217846870422363}}, "episode_reward_max": 14.335666666666661, "episode_reward_min": 5.851666666666666, "episode_reward_mean": 8.597326666666666, "episode_len_mean": 18.34, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.463666666666665, 11.315333333333331, 6.905666666666665, 8.027666666666665, 8.193666666666665, 8.95133333333333, 8.220333333333333, 9.158, 8.190666666666665, 8.981333333333334, 9.084999999999999, 9.334999999999999, 7.272666666666666, 9.009999999999998, 8.353333333333332, 7.775999999999998, 8.895333333333333, 6.095333333333333, 7.854, 9.467, 11.822666666666663, 14.335666666666661, 7.945666666666665, 8.624999999999998, 9.342666666666666, 10.70966666666666, 8.754999999999999, 9.101666666666667, 8.97133333333333, 7.207333333333333, 6.011333333333332, 6.3953333333333315, 7.644333333333332, 9.232666666666665, 7.139333333333332, 9.141999999999996, 9.451, 7.122999999999999, 8.498, 7.347666666666668, 8.872, 8.409999999999997, 6.544333333333333, 11.796999999999999, 6.561333333333332, 10.185666666666666, 8.329999999999998, 8.215, 10.254666666666665, 7.760999999999999, 11.088333333333335, 7.744, 11.990000000000002, 8.602, 9.210666666666665, 8.436333333333334, 6.355999999999999, 9.752999999999997, 9.17633333333333, 5.851666666666666, 7.787999999999999, 8.913666666666666, 6.0520000000000005, 11.589999999999998, 7.021666666666667, 7.578333333333333, 8.842666666666668, 7.506666666666666, 10.304999999999998, 9.11233333333333, 8.957333333333333, 11.194333333333331, 8.004, 9.58433333333333, 8.241999999999999, 6.738666666666666, 6.687333333333332, 8.094666666666667, 7.063666666666666, 8.636, 8.950999999999997, 10.054333333333332, 6.808333333333334, 9.449666666666664, 8.278333333333332, 10.092666666666664, 8.254333333333332, 11.20833333333333, 6.0743333333333345, 7.2363333333333335, 9.903333333333332, 6.507666666666666, 6.915333333333334, 7.290666666666665, 10.151333333333337, 8.361999999999998, 11.166666666666664, 7.230666666666666, 9.45033333333333, 9.942333333333334], "episode_lengths": [18, 21, 15, 16, 19, 18, 16, 19, 17, 18, 18, 20, 16, 18, 19, 17, 18, 14, 17, 21, 22, 25, 18, 20, 20, 23, 20, 19, 20, 16, 13, 15, 15, 20, 16, 23, 19, 17, 19, 16, 16, 18, 15, 23, 16, 21, 19, 19, 23, 18, 26, 18, 23, 19, 20, 19, 14, 21, 20, 13, 17, 17, 13, 24, 15, 15, 18, 15, 22, 19, 21, 25, 16, 20, 16, 14, 15, 18, 16, 17, 19, 25, 16, 19, 17, 20, 16, 25, 13, 16, 20, 14, 14, 16, 21, 16, 23, 17, 20, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.617172951998019, "mean_inference_ms": 2.9457708882007267, "mean_action_processing_ms": 0.6105673437871805, "mean_env_wait_ms": 0.14735528097830758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020084619522094727, "StateBufferConnector_ms": 0.01725625991821289, "ViewRequirementAgentConnector_ms": 0.46217846870422363}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 77000, "num_env_steps_sampled": 77000, "num_env_steps_trained": 77000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1476.5716228411961, "num_env_steps_trained_throughput_per_sec": 1476.5716228411961, "timesteps_total": 77000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 77000, "timers": {"training_iteration_time_ms": 1154.22, "sample_time_ms": 1118.489, "load_time_ms": 0.345, "load_throughput": 4059190.93, "learn_time_ms": 13.067, "learn_throughput": 107142.412, "synch_weights_time_ms": 22.23}, "counters": {"num_env_steps_sampled": 77000, "num_env_steps_trained": 77000, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 77000}, "done": false, "episodes_total": 4119, "training_iteration": 55, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-03", "timestamp": 1702021203, "time_this_iter_s": 0.9651143550872803, "time_total_s": 65.56049394607544, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 65.56049394607544, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 90.5, "ram_util_percent": 96.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0904356241226196, "total_loss": 1.0904356241226196, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 78400, "num_env_steps_trained": 78400, "num_agent_steps_sampled": 78400, "num_agent_steps_trained": 78400}, "sampler_results": {"episode_reward_max": 13.447999999999997, "episode_reward_min": 6.006666666666667, "episode_reward_mean": 8.720533333333332, "episode_len_mean": 18.64, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.094666666666667, 7.063666666666666, 8.636, 8.950999999999997, 10.054333333333332, 6.808333333333334, 9.449666666666664, 8.278333333333332, 10.092666666666664, 8.254333333333332, 11.20833333333333, 6.0743333333333345, 7.2363333333333335, 9.903333333333332, 6.507666666666666, 6.915333333333334, 7.290666666666665, 10.151333333333337, 8.361999999999998, 11.166666666666664, 7.230666666666666, 9.45033333333333, 9.942333333333334, 7.136666666666667, 9.173999999999998, 8.445999999999998, 10.319666666666667, 13.447999999999997, 7.807666666666667, 6.706333333333332, 6.006666666666667, 10.614666666666663, 6.599333333333331, 8.035666666666666, 10.409, 7.210666666666667, 6.288333333333335, 9.972999999999999, 9.017999999999999, 8.418666666666663, 8.183666666666666, 7.199666666666667, 9.829333333333333, 7.171, 9.733999999999998, 11.100333333333337, 8.400666666666666, 8.567000000000002, 8.317333333333334, 6.346, 10.038333333333334, 8.580666666666666, 9.873666666666667, 9.692666666666668, 8.507, 6.067999999999999, 8.755999999999998, 8.64333333333333, 9.69, 9.795333333333332, 8.528333333333332, 7.705666666666666, 7.000666666666667, 7.593333333333334, 9.155666666666663, 10.777666666666665, 9.804, 9.013666666666667, 7.4063333333333325, 9.673666666666668, 8.209333333333333, 8.370666666666667, 8.610666666666665, 8.525999999999998, 8.784666666666665, 8.497333333333332, 10.73333333333333, 7.294666666666666, 10.236666666666665, 9.500333333333332, 11.416666666666668, 9.403999999999998, 10.433000000000002, 7.425333333333333, 8.779666666666664, 9.086, 8.117333333333333, 12.268666666666668, 8.331, 9.864, 9.277, 9.97433333333333, 9.226666666666663, 6.995333333333333, 7.322, 8.290666666666665, 8.13133333333333, 8.991999999999997, 8.289666666666665, 7.777333333333335], "episode_lengths": [18, 16, 17, 19, 25, 16, 19, 17, 20, 16, 25, 13, 16, 20, 14, 14, 16, 21, 16, 23, 17, 20, 22, 15, 18, 18, 22, 26, 18, 15, 14, 23, 15, 16, 22, 15, 14, 23, 20, 19, 18, 17, 19, 16, 21, 24, 18, 20, 17, 14, 22, 19, 20, 19, 18, 18, 21, 19, 19, 21, 17, 16, 14, 16, 19, 22, 21, 20, 18, 20, 17, 18, 20, 18, 17, 20, 24, 16, 20, 20, 24, 18, 23, 19, 18, 20, 17, 24, 19, 22, 19, 19, 22, 15, 15, 16, 18, 18, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6256670175673236, "mean_inference_ms": 2.9653433013771586, "mean_action_processing_ms": 0.6176933281254352, "mean_env_wait_ms": 0.14823562374008495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003360748291016, "StateBufferConnector_ms": 0.0181884765625, "ViewRequirementAgentConnector_ms": 0.684114933013916}}, "episode_reward_max": 13.447999999999997, "episode_reward_min": 6.006666666666667, "episode_reward_mean": 8.720533333333332, "episode_len_mean": 18.64, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.094666666666667, 7.063666666666666, 8.636, 8.950999999999997, 10.054333333333332, 6.808333333333334, 9.449666666666664, 8.278333333333332, 10.092666666666664, 8.254333333333332, 11.20833333333333, 6.0743333333333345, 7.2363333333333335, 9.903333333333332, 6.507666666666666, 6.915333333333334, 7.290666666666665, 10.151333333333337, 8.361999999999998, 11.166666666666664, 7.230666666666666, 9.45033333333333, 9.942333333333334, 7.136666666666667, 9.173999999999998, 8.445999999999998, 10.319666666666667, 13.447999999999997, 7.807666666666667, 6.706333333333332, 6.006666666666667, 10.614666666666663, 6.599333333333331, 8.035666666666666, 10.409, 7.210666666666667, 6.288333333333335, 9.972999999999999, 9.017999999999999, 8.418666666666663, 8.183666666666666, 7.199666666666667, 9.829333333333333, 7.171, 9.733999999999998, 11.100333333333337, 8.400666666666666, 8.567000000000002, 8.317333333333334, 6.346, 10.038333333333334, 8.580666666666666, 9.873666666666667, 9.692666666666668, 8.507, 6.067999999999999, 8.755999999999998, 8.64333333333333, 9.69, 9.795333333333332, 8.528333333333332, 7.705666666666666, 7.000666666666667, 7.593333333333334, 9.155666666666663, 10.777666666666665, 9.804, 9.013666666666667, 7.4063333333333325, 9.673666666666668, 8.209333333333333, 8.370666666666667, 8.610666666666665, 8.525999999999998, 8.784666666666665, 8.497333333333332, 10.73333333333333, 7.294666666666666, 10.236666666666665, 9.500333333333332, 11.416666666666668, 9.403999999999998, 10.433000000000002, 7.425333333333333, 8.779666666666664, 9.086, 8.117333333333333, 12.268666666666668, 8.331, 9.864, 9.277, 9.97433333333333, 9.226666666666663, 6.995333333333333, 7.322, 8.290666666666665, 8.13133333333333, 8.991999999999997, 8.289666666666665, 7.777333333333335], "episode_lengths": [18, 16, 17, 19, 25, 16, 19, 17, 20, 16, 25, 13, 16, 20, 14, 14, 16, 21, 16, 23, 17, 20, 22, 15, 18, 18, 22, 26, 18, 15, 14, 23, 15, 16, 22, 15, 14, 23, 20, 19, 18, 17, 19, 16, 21, 24, 18, 20, 17, 14, 22, 19, 20, 19, 18, 18, 21, 19, 19, 21, 17, 16, 14, 16, 19, 22, 21, 20, 18, 20, 17, 18, 20, 18, 17, 20, 24, 16, 20, 20, 24, 18, 23, 19, 18, 20, 17, 24, 19, 22, 19, 19, 22, 15, 15, 16, 18, 18, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6256670175673236, "mean_inference_ms": 2.9653433013771586, "mean_action_processing_ms": 0.6176933281254352, "mean_env_wait_ms": 0.14823562374008495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003360748291016, "StateBufferConnector_ms": 0.0181884765625, "ViewRequirementAgentConnector_ms": 0.684114933013916}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78400, "num_agent_steps_trained": 78400, "num_env_steps_sampled": 78400, "num_env_steps_trained": 78400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 712.7513599812005, "num_env_steps_trained_throughput_per_sec": 712.7513599812005, "timesteps_total": 78400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 78400, "timers": {"training_iteration_time_ms": 1230.77, "sample_time_ms": 1193.941, "load_time_ms": 0.305, "load_throughput": 4595058.768, "learn_time_ms": 13.707, "learn_throughput": 102140.481, "synch_weights_time_ms": 22.53}, "counters": {"num_env_steps_sampled": 78400, "num_env_steps_trained": 78400, "num_agent_steps_sampled": 78400, "num_agent_steps_trained": 78400}, "done": false, "episodes_total": 4196, "training_iteration": 56, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-05", "timestamp": 1702021205, "time_this_iter_s": 2.019334077835083, "time_total_s": 67.57982802391052, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.57982802391052, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 96.2, "ram_util_percent": 97.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0894699096679688, "total_loss": 1.0894699096679688, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 79800, "num_env_steps_trained": 79800, "num_agent_steps_sampled": 79800, "num_agent_steps_trained": 79800}, "sampler_results": {"episode_reward_max": 13.17666666666667, "episode_reward_min": 6.040666666666665, "episode_reward_mean": 8.812823333333334, "episode_len_mean": 18.57, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73333333333333, 7.294666666666666, 10.236666666666665, 9.500333333333332, 11.416666666666668, 9.403999999999998, 10.433000000000002, 7.425333333333333, 8.779666666666664, 9.086, 8.117333333333333, 12.268666666666668, 8.331, 9.864, 9.277, 9.97433333333333, 9.226666666666663, 6.995333333333333, 7.322, 8.290666666666665, 8.13133333333333, 8.991999999999997, 8.289666666666665, 7.777333333333335, 9.694666666666665, 8.720666666666666, 10.782, 8.577666666666666, 9.290666666666667, 6.533666666666667, 7.821999999999999, 9.311999999999998, 6.322000000000001, 11.000333333333334, 7.203666666666665, 7.789999999999997, 8.824666666666664, 10.176333333333332, 9.381333333333334, 11.551666666666666, 8.514666666666665, 12.999666666666664, 7.525, 7.171666666666666, 8.176666666666666, 6.655333333333332, 8.562666666666665, 8.088333333333335, 13.17666666666667, 6.435, 10.47933333333333, 8.227999999999998, 7.710666666666667, 8.199666666666664, 9.176000000000002, 7.985999999999998, 11.11666666666667, 9.350666666666665, 11.787666666666668, 9.891, 9.936666666666664, 7.0443333333333324, 11.994666666666669, 7.448333333333332, 7.560333333333332, 6.469666666666666, 9.213333333333331, 10.299333333333337, 9.373666666666665, 7.908999999999999, 6.040666666666665, 7.278666666666665, 6.139999999999999, 6.269333333333334, 7.140666666666665, 8.133333333333333, 9.985999999999997, 7.911333333333333, 9.826333333333332, 7.124666666666665, 7.271999999999999, 6.929333333333333, 11.183333333333332, 10.570666666666666, 8.570666666666666, 8.53533333333333, 7.045666666666667, 9.163333333333334, 10.33333333333333, 8.351999999999999, 8.741666666666664, 10.967666666666664, 7.033, 8.831333333333333, 9.770999999999995, 8.047999999999998, 7.340666666666666, 7.273333333333332, 10.535999999999998, 10.301999999999998], "episode_lengths": [24, 16, 20, 20, 24, 18, 23, 19, 18, 20, 17, 24, 19, 22, 19, 19, 22, 15, 15, 16, 18, 18, 16, 16, 20, 20, 21, 19, 18, 14, 16, 20, 14, 21, 16, 19, 22, 21, 21, 21, 17, 27, 15, 14, 17, 14, 18, 18, 27, 14, 22, 16, 16, 21, 19, 18, 21, 18, 23, 20, 20, 16, 25, 20, 18, 14, 20, 21, 21, 18, 13, 15, 14, 13, 17, 18, 21, 17, 20, 15, 17, 16, 23, 20, 19, 17, 15, 19, 20, 20, 18, 21, 15, 16, 21, 16, 15, 15, 22, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.641210126923199, "mean_inference_ms": 2.996131978080523, "mean_action_processing_ms": 0.6238579136167541, "mean_env_wait_ms": 0.14939519027929213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0316922664642334, "StateBufferConnector_ms": 0.06296658515930176, "ViewRequirementAgentConnector_ms": 0.7718689441680908}}, "episode_reward_max": 13.17666666666667, "episode_reward_min": 6.040666666666665, "episode_reward_mean": 8.812823333333334, "episode_len_mean": 18.57, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73333333333333, 7.294666666666666, 10.236666666666665, 9.500333333333332, 11.416666666666668, 9.403999999999998, 10.433000000000002, 7.425333333333333, 8.779666666666664, 9.086, 8.117333333333333, 12.268666666666668, 8.331, 9.864, 9.277, 9.97433333333333, 9.226666666666663, 6.995333333333333, 7.322, 8.290666666666665, 8.13133333333333, 8.991999999999997, 8.289666666666665, 7.777333333333335, 9.694666666666665, 8.720666666666666, 10.782, 8.577666666666666, 9.290666666666667, 6.533666666666667, 7.821999999999999, 9.311999999999998, 6.322000000000001, 11.000333333333334, 7.203666666666665, 7.789999999999997, 8.824666666666664, 10.176333333333332, 9.381333333333334, 11.551666666666666, 8.514666666666665, 12.999666666666664, 7.525, 7.171666666666666, 8.176666666666666, 6.655333333333332, 8.562666666666665, 8.088333333333335, 13.17666666666667, 6.435, 10.47933333333333, 8.227999999999998, 7.710666666666667, 8.199666666666664, 9.176000000000002, 7.985999999999998, 11.11666666666667, 9.350666666666665, 11.787666666666668, 9.891, 9.936666666666664, 7.0443333333333324, 11.994666666666669, 7.448333333333332, 7.560333333333332, 6.469666666666666, 9.213333333333331, 10.299333333333337, 9.373666666666665, 7.908999999999999, 6.040666666666665, 7.278666666666665, 6.139999999999999, 6.269333333333334, 7.140666666666665, 8.133333333333333, 9.985999999999997, 7.911333333333333, 9.826333333333332, 7.124666666666665, 7.271999999999999, 6.929333333333333, 11.183333333333332, 10.570666666666666, 8.570666666666666, 8.53533333333333, 7.045666666666667, 9.163333333333334, 10.33333333333333, 8.351999999999999, 8.741666666666664, 10.967666666666664, 7.033, 8.831333333333333, 9.770999999999995, 8.047999999999998, 7.340666666666666, 7.273333333333332, 10.535999999999998, 10.301999999999998], "episode_lengths": [24, 16, 20, 20, 24, 18, 23, 19, 18, 20, 17, 24, 19, 22, 19, 19, 22, 15, 15, 16, 18, 18, 16, 16, 20, 20, 21, 19, 18, 14, 16, 20, 14, 21, 16, 19, 22, 21, 21, 21, 17, 27, 15, 14, 17, 14, 18, 18, 27, 14, 22, 16, 16, 21, 19, 18, 21, 18, 23, 20, 20, 16, 25, 20, 18, 14, 20, 21, 21, 18, 13, 15, 14, 13, 17, 18, 21, 17, 20, 15, 17, 16, 23, 20, 19, 17, 15, 19, 20, 20, 18, 21, 15, 16, 21, 16, 15, 15, 22, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.641210126923199, "mean_inference_ms": 2.996131978080523, "mean_action_processing_ms": 0.6238579136167541, "mean_env_wait_ms": 0.14939519027929213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0316922664642334, "StateBufferConnector_ms": 0.06296658515930176, "ViewRequirementAgentConnector_ms": 0.7718689441680908}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79800, "num_agent_steps_trained": 79800, "num_env_steps_sampled": 79800, "num_env_steps_trained": 79800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 759.3355842604075, "num_env_steps_trained_throughput_per_sec": 759.3355842604075, "timesteps_total": 79800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 79800, "timers": {"training_iteration_time_ms": 1310.63, "sample_time_ms": 1273.429, "load_time_ms": 0.305, "load_throughput": 4589671.408, "learn_time_ms": 13.907, "learn_throughput": 100668.186, "synch_weights_time_ms": 22.702}, "counters": {"num_env_steps_sampled": 79800, "num_env_steps_trained": 79800, "num_agent_steps_sampled": 79800, "num_agent_steps_trained": 79800}, "done": false, "episodes_total": 4272, "training_iteration": 57, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-07", "timestamp": 1702021207, "time_this_iter_s": 1.8757052421569824, "time_total_s": 69.4555332660675, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.4555332660675, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 98.3, "ram_util_percent": 96.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.092893362045288, "total_loss": 1.092893362045288, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 81200, "num_env_steps_trained": 81200, "num_agent_steps_sampled": 81200, "num_agent_steps_trained": 81200}, "sampler_results": {"episode_reward_max": 15.651666666666662, "episode_reward_min": 5.981333333333333, "episode_reward_mean": 8.723083333333332, "episode_len_mean": 18.5, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.133333333333333, 9.985999999999997, 7.911333333333333, 9.826333333333332, 7.124666666666665, 7.271999999999999, 6.929333333333333, 11.183333333333332, 10.570666666666666, 8.570666666666666, 8.53533333333333, 7.045666666666667, 9.163333333333334, 10.33333333333333, 8.351999999999999, 8.741666666666664, 10.967666666666664, 7.033, 8.831333333333333, 9.770999999999995, 8.047999999999998, 7.340666666666666, 7.273333333333332, 10.535999999999998, 10.301999999999998, 12.063333333333329, 7.855999999999999, 6.583999999999999, 8.759, 8.260333333333332, 9.924, 8.449333333333332, 9.161666666666665, 8.783333333333333, 9.503666666666664, 8.419999999999998, 9.851333333333331, 10.395666666666669, 8.324333333333334, 13.217000000000002, 7.363, 11.555666666666664, 13.618666666666666, 8.953999999999999, 10.437999999999997, 7.663999999999998, 8.888666666666666, 11.383, 7.812666666666665, 7.978666666666667, 6.890999999999999, 8.488, 7.550999999999999, 7.451333333333334, 8.273666666666667, 8.056000000000001, 8.44833333333333, 8.587666666666667, 8.145333333333333, 7.189666666666667, 10.061333333333334, 8.111666666666666, 8.696666666666665, 9.127666666666666, 10.117666666666661, 8.366999999999999, 10.404333333333332, 8.165999999999999, 8.597333333333335, 8.426, 7.821999999999998, 7.094333333333332, 9.660333333333329, 15.651666666666662, 8.786333333333332, 6.903666666666666, 9.786, 9.077333333333334, 8.594333333333333, 8.086666666666664, 7.1129999999999995, 7.299999999999998, 7.241666666666667, 8.561333333333334, 7.057999999999999, 7.752999999999997, 7.621999999999999, 7.136333333333333, 5.981333333333333, 7.289333333333333, 8.399000000000001, 9.483333333333333, 6.468333333333332, 7.7606666666666655, 8.116333333333333, 9.776999999999997, 6.8343333333333325, 9.205666666666666, 6.811666666666667, 10.78433333333333], "episode_lengths": [18, 21, 17, 20, 15, 17, 16, 23, 20, 19, 17, 15, 19, 20, 20, 18, 21, 15, 16, 21, 16, 15, 15, 22, 20, 24, 16, 14, 18, 16, 26, 21, 19, 18, 21, 17, 20, 21, 17, 27, 15, 23, 29, 20, 21, 16, 17, 22, 16, 17, 15, 18, 17, 16, 16, 16, 18, 18, 17, 18, 24, 17, 19, 19, 20, 17, 21, 18, 19, 18, 17, 16, 21, 31, 19, 15, 21, 21, 18, 18, 17, 17, 16, 17, 17, 18, 16, 15, 14, 17, 18, 23, 14, 15, 18, 21, 15, 19, 15, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.643961777254184, "mean_inference_ms": 3.006818690793953, "mean_action_processing_ms": 0.6275586272075523, "mean_env_wait_ms": 0.14992830345804134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03278923034667969, "StateBufferConnector_ms": 0.05949854850769043, "ViewRequirementAgentConnector_ms": 0.6503713130950928}}, "episode_reward_max": 15.651666666666662, "episode_reward_min": 5.981333333333333, "episode_reward_mean": 8.723083333333332, "episode_len_mean": 18.5, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.133333333333333, 9.985999999999997, 7.911333333333333, 9.826333333333332, 7.124666666666665, 7.271999999999999, 6.929333333333333, 11.183333333333332, 10.570666666666666, 8.570666666666666, 8.53533333333333, 7.045666666666667, 9.163333333333334, 10.33333333333333, 8.351999999999999, 8.741666666666664, 10.967666666666664, 7.033, 8.831333333333333, 9.770999999999995, 8.047999999999998, 7.340666666666666, 7.273333333333332, 10.535999999999998, 10.301999999999998, 12.063333333333329, 7.855999999999999, 6.583999999999999, 8.759, 8.260333333333332, 9.924, 8.449333333333332, 9.161666666666665, 8.783333333333333, 9.503666666666664, 8.419999999999998, 9.851333333333331, 10.395666666666669, 8.324333333333334, 13.217000000000002, 7.363, 11.555666666666664, 13.618666666666666, 8.953999999999999, 10.437999999999997, 7.663999999999998, 8.888666666666666, 11.383, 7.812666666666665, 7.978666666666667, 6.890999999999999, 8.488, 7.550999999999999, 7.451333333333334, 8.273666666666667, 8.056000000000001, 8.44833333333333, 8.587666666666667, 8.145333333333333, 7.189666666666667, 10.061333333333334, 8.111666666666666, 8.696666666666665, 9.127666666666666, 10.117666666666661, 8.366999999999999, 10.404333333333332, 8.165999999999999, 8.597333333333335, 8.426, 7.821999999999998, 7.094333333333332, 9.660333333333329, 15.651666666666662, 8.786333333333332, 6.903666666666666, 9.786, 9.077333333333334, 8.594333333333333, 8.086666666666664, 7.1129999999999995, 7.299999999999998, 7.241666666666667, 8.561333333333334, 7.057999999999999, 7.752999999999997, 7.621999999999999, 7.136333333333333, 5.981333333333333, 7.289333333333333, 8.399000000000001, 9.483333333333333, 6.468333333333332, 7.7606666666666655, 8.116333333333333, 9.776999999999997, 6.8343333333333325, 9.205666666666666, 6.811666666666667, 10.78433333333333], "episode_lengths": [18, 21, 17, 20, 15, 17, 16, 23, 20, 19, 17, 15, 19, 20, 20, 18, 21, 15, 16, 21, 16, 15, 15, 22, 20, 24, 16, 14, 18, 16, 26, 21, 19, 18, 21, 17, 20, 21, 17, 27, 15, 23, 29, 20, 21, 16, 17, 22, 16, 17, 15, 18, 17, 16, 16, 16, 18, 18, 17, 18, 24, 17, 19, 19, 20, 17, 21, 18, 19, 18, 17, 16, 21, 31, 19, 15, 21, 21, 18, 18, 17, 17, 16, 17, 17, 18, 16, 15, 14, 17, 18, 23, 14, 15, 18, 21, 15, 19, 15, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.643961777254184, "mean_inference_ms": 3.006818690793953, "mean_action_processing_ms": 0.6275586272075523, "mean_env_wait_ms": 0.14992830345804134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03278923034667969, "StateBufferConnector_ms": 0.05949854850769043, "ViewRequirementAgentConnector_ms": 0.6503713130950928}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81200, "num_agent_steps_trained": 81200, "num_env_steps_sampled": 81200, "num_env_steps_trained": 81200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1029.5282565000962, "num_env_steps_trained_throughput_per_sec": 1029.5282565000962, "timesteps_total": 81200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 81200, "timers": {"training_iteration_time_ms": 1332.796, "sample_time_ms": 1295.59, "load_time_ms": 0.305, "load_throughput": 4589671.408, "learn_time_ms": 14.012, "learn_throughput": 99915.358, "synch_weights_time_ms": 22.602}, "counters": {"num_env_steps_sampled": 81200, "num_env_steps_trained": 81200, "num_agent_steps_sampled": 81200, "num_agent_steps_trained": 81200}, "done": false, "episodes_total": 4347, "training_iteration": 58, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-09", "timestamp": 1702021209, "time_this_iter_s": 1.3898429870605469, "time_total_s": 70.84537625312805, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.84537625312805, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 98.85, "ram_util_percent": 96.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0974581241607666, "total_loss": 1.0974581241607666, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 82600, "num_env_steps_trained": 82600, "num_agent_steps_sampled": 82600, "num_agent_steps_trained": 82600}, "sampler_results": {"episode_reward_max": 12.743333333333329, "episode_reward_min": 5.841333333333332, "episode_reward_mean": 8.306869999999998, "episode_len_mean": 18.11, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.077333333333334, 8.594333333333333, 8.086666666666664, 7.1129999999999995, 7.299999999999998, 7.241666666666667, 8.561333333333334, 7.057999999999999, 7.752999999999997, 7.621999999999999, 7.136333333333333, 5.981333333333333, 7.289333333333333, 8.399000000000001, 9.483333333333333, 6.468333333333332, 7.7606666666666655, 8.116333333333333, 9.776999999999997, 6.8343333333333325, 9.205666666666666, 6.811666666666667, 10.78433333333333, 7.902666666666666, 9.878, 7.2076666666666656, 8.621333333333334, 9.649999999999995, 9.155999999999999, 8.211666666666664, 7.934666666666667, 6.059333333333333, 7.851666666666665, 9.321666666666665, 7.883333333333335, 12.361666666666665, 9.471999999999998, 7.221333333333332, 11.625999999999998, 7.886000000000001, 9.447666666666663, 7.487333333333332, 7.851666666666665, 9.092666666666664, 10.574666666666667, 7.729333333333332, 11.776333333333335, 9.181000000000001, 5.841333333333332, 9.68, 9.805000000000001, 8.643999999999998, 9.954333333333333, 11.933333333333334, 7.622666666666665, 12.716666666666665, 6.938666666666666, 7.4676666666666645, 7.146666666666665, 6.9013333333333335, 9.621999999999998, 10.377333333333336, 6.736999999999998, 7.042666666666665, 7.116, 10.025666666666664, 8.009999999999996, 8.173666666666668, 7.6789999999999985, 12.743333333333329, 7.388, 6.941333333333332, 7.601333333333333, 6.683666666666667, 6.941, 6.457999999999999, 9.934, 8.04533333333333, 9.782333333333332, 7.2079999999999975, 8.621666666666664, 8.274999999999999, 7.226, 10.019333333333332, 8.441333333333331, 9.03833333333333, 7.059, 7.116, 7.919333333333331, 7.273666666666665, 7.594666666666666, 7.257999999999997, 6.993666666666665, 8.152999999999999, 8.764999999999997, 8.468333333333334, 7.925333333333331, 8.59633333333333, 6.657333333333333, 6.283666666666665], "episode_lengths": [21, 18, 18, 17, 17, 16, 17, 17, 18, 16, 15, 14, 17, 18, 23, 14, 15, 18, 21, 15, 19, 15, 23, 18, 19, 15, 17, 23, 20, 16, 20, 15, 16, 21, 20, 25, 19, 15, 29, 17, 22, 17, 18, 17, 22, 17, 23, 22, 14, 19, 20, 21, 20, 23, 17, 27, 14, 16, 16, 16, 22, 24, 14, 14, 17, 19, 19, 16, 17, 25, 16, 15, 17, 15, 15, 18, 23, 18, 20, 16, 19, 19, 16, 19, 17, 19, 16, 17, 16, 18, 16, 16, 15, 19, 18, 18, 18, 17, 16, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6433645385309144, "mean_inference_ms": 3.009347552672084, "mean_action_processing_ms": 0.6279334233367608, "mean_env_wait_ms": 0.14878628618177864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021068334579467773, "StateBufferConnector_ms": 0.02078104019165039, "ViewRequirementAgentConnector_ms": 0.5688176155090332}}, "episode_reward_max": 12.743333333333329, "episode_reward_min": 5.841333333333332, "episode_reward_mean": 8.306869999999998, "episode_len_mean": 18.11, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.077333333333334, 8.594333333333333, 8.086666666666664, 7.1129999999999995, 7.299999999999998, 7.241666666666667, 8.561333333333334, 7.057999999999999, 7.752999999999997, 7.621999999999999, 7.136333333333333, 5.981333333333333, 7.289333333333333, 8.399000000000001, 9.483333333333333, 6.468333333333332, 7.7606666666666655, 8.116333333333333, 9.776999999999997, 6.8343333333333325, 9.205666666666666, 6.811666666666667, 10.78433333333333, 7.902666666666666, 9.878, 7.2076666666666656, 8.621333333333334, 9.649999999999995, 9.155999999999999, 8.211666666666664, 7.934666666666667, 6.059333333333333, 7.851666666666665, 9.321666666666665, 7.883333333333335, 12.361666666666665, 9.471999999999998, 7.221333333333332, 11.625999999999998, 7.886000000000001, 9.447666666666663, 7.487333333333332, 7.851666666666665, 9.092666666666664, 10.574666666666667, 7.729333333333332, 11.776333333333335, 9.181000000000001, 5.841333333333332, 9.68, 9.805000000000001, 8.643999999999998, 9.954333333333333, 11.933333333333334, 7.622666666666665, 12.716666666666665, 6.938666666666666, 7.4676666666666645, 7.146666666666665, 6.9013333333333335, 9.621999999999998, 10.377333333333336, 6.736999999999998, 7.042666666666665, 7.116, 10.025666666666664, 8.009999999999996, 8.173666666666668, 7.6789999999999985, 12.743333333333329, 7.388, 6.941333333333332, 7.601333333333333, 6.683666666666667, 6.941, 6.457999999999999, 9.934, 8.04533333333333, 9.782333333333332, 7.2079999999999975, 8.621666666666664, 8.274999999999999, 7.226, 10.019333333333332, 8.441333333333331, 9.03833333333333, 7.059, 7.116, 7.919333333333331, 7.273666666666665, 7.594666666666666, 7.257999999999997, 6.993666666666665, 8.152999999999999, 8.764999999999997, 8.468333333333334, 7.925333333333331, 8.59633333333333, 6.657333333333333, 6.283666666666665], "episode_lengths": [21, 18, 18, 17, 17, 16, 17, 17, 18, 16, 15, 14, 17, 18, 23, 14, 15, 18, 21, 15, 19, 15, 23, 18, 19, 15, 17, 23, 20, 16, 20, 15, 16, 21, 20, 25, 19, 15, 29, 17, 22, 17, 18, 17, 22, 17, 23, 22, 14, 19, 20, 21, 20, 23, 17, 27, 14, 16, 16, 16, 22, 24, 14, 14, 17, 19, 19, 16, 17, 25, 16, 15, 17, 15, 15, 18, 23, 18, 20, 16, 19, 19, 16, 19, 17, 19, 16, 17, 16, 18, 16, 16, 15, 19, 18, 18, 18, 17, 16, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6433645385309144, "mean_inference_ms": 3.009347552672084, "mean_action_processing_ms": 0.6279334233367608, "mean_env_wait_ms": 0.14878628618177864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021068334579467773, "StateBufferConnector_ms": 0.02078104019165039, "ViewRequirementAgentConnector_ms": 0.5688176155090332}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82600, "num_agent_steps_trained": 82600, "num_env_steps_sampled": 82600, "num_env_steps_trained": 82600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1227.0102391802805, "num_env_steps_trained_throughput_per_sec": 1227.0102391802805, "timesteps_total": 82600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 82600, "timers": {"training_iteration_time_ms": 1320.458, "sample_time_ms": 1284.232, "load_time_ms": 0.305, "load_throughput": 4589671.408, "learn_time_ms": 13.713, "learn_throughput": 102091.823, "synch_weights_time_ms": 21.902}, "counters": {"num_env_steps_sampled": 82600, "num_env_steps_trained": 82600, "num_agent_steps_sampled": 82600, "num_agent_steps_trained": 82600}, "done": false, "episodes_total": 4424, "training_iteration": 59, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-10", "timestamp": 1702021210, "time_this_iter_s": 1.1550655364990234, "time_total_s": 72.00044178962708, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.00044178962708, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 97.25, "ram_util_percent": 95.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0967402458190918, "total_loss": 1.0967402458190918, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 14.743999999999994, "episode_reward_min": 5.890000000000001, "episode_reward_mean": 8.596029999999999, "episode_len_mean": 18.41, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.457999999999999, 9.934, 8.04533333333333, 9.782333333333332, 7.2079999999999975, 8.621666666666664, 8.274999999999999, 7.226, 10.019333333333332, 8.441333333333331, 9.03833333333333, 7.059, 7.116, 7.919333333333331, 7.273666666666665, 7.594666666666666, 7.257999999999997, 6.993666666666665, 8.152999999999999, 8.764999999999997, 8.468333333333334, 7.925333333333331, 8.59633333333333, 6.657333333333333, 6.283666666666665, 6.2829999999999995, 7.0233333333333325, 8.416666666666666, 8.906999999999998, 9.143666666666666, 7.577999999999999, 8.303333333333333, 9.004999999999997, 10.131666666666664, 9.300999999999998, 8.963333333333333, 7.040999999999999, 12.399333333333335, 7.554666666666668, 8.112, 6.680666666666665, 9.343999999999998, 7.931999999999999, 8.237000000000002, 11.932999999999996, 7.185333333333332, 7.439333333333332, 7.461333333333331, 9.850333333333335, 8.404666666666666, 7.705, 7.908000000000001, 6.4626666666666654, 6.605, 7.2973333333333334, 8.582333333333333, 10.976666666666665, 9.514, 5.957999999999999, 10.748666666666663, 6.288333333333333, 10.526333333333332, 10.153666666666664, 13.214333333333336, 8.069999999999999, 7.660666666666667, 7.347999999999999, 8.363333333333333, 9.339666666666666, 8.067, 14.137333333333334, 12.480999999999996, 9.568333333333333, 7.756, 10.110999999999999, 11.224, 8.469333333333331, 8.703666666666663, 8.413666666666666, 10.624666666666664, 9.614333333333327, 7.573333333333331, 6.624666666666666, 7.219999999999999, 10.989333333333336, 14.743999999999994, 7.105333333333334, 6.673666666666666, 10.440333333333335, 10.763999999999998, 10.683666666666664, 10.889333333333333, 10.161333333333335, 5.890000000000001, 6.957999999999999, 9.993666666666666, 7.121, 6.651333333333331, 7.024999999999999, 8.459333333333333], "episode_lengths": [18, 23, 18, 20, 16, 19, 19, 16, 19, 17, 19, 16, 17, 16, 18, 16, 16, 15, 19, 18, 18, 18, 17, 16, 14, 15, 15, 17, 18, 19, 16, 17, 19, 20, 18, 20, 16, 24, 16, 17, 14, 21, 17, 19, 23, 15, 16, 16, 22, 18, 16, 17, 15, 14, 16, 19, 20, 24, 14, 22, 14, 21, 19, 28, 17, 16, 16, 19, 23, 19, 27, 26, 22, 19, 22, 21, 16, 19, 19, 22, 21, 18, 14, 14, 24, 29, 15, 15, 23, 23, 21, 22, 22, 13, 15, 20, 16, 14, 15, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6557306108671888, "mean_inference_ms": 3.024890485632856, "mean_action_processing_ms": 0.628647596695162, "mean_env_wait_ms": 0.14987028624878498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025422334671020508, "StateBufferConnector_ms": 0.015668392181396484, "ViewRequirementAgentConnector_ms": 0.7045257091522217}}, "episode_reward_max": 14.743999999999994, "episode_reward_min": 5.890000000000001, "episode_reward_mean": 8.596029999999999, "episode_len_mean": 18.41, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.457999999999999, 9.934, 8.04533333333333, 9.782333333333332, 7.2079999999999975, 8.621666666666664, 8.274999999999999, 7.226, 10.019333333333332, 8.441333333333331, 9.03833333333333, 7.059, 7.116, 7.919333333333331, 7.273666666666665, 7.594666666666666, 7.257999999999997, 6.993666666666665, 8.152999999999999, 8.764999999999997, 8.468333333333334, 7.925333333333331, 8.59633333333333, 6.657333333333333, 6.283666666666665, 6.2829999999999995, 7.0233333333333325, 8.416666666666666, 8.906999999999998, 9.143666666666666, 7.577999999999999, 8.303333333333333, 9.004999999999997, 10.131666666666664, 9.300999999999998, 8.963333333333333, 7.040999999999999, 12.399333333333335, 7.554666666666668, 8.112, 6.680666666666665, 9.343999999999998, 7.931999999999999, 8.237000000000002, 11.932999999999996, 7.185333333333332, 7.439333333333332, 7.461333333333331, 9.850333333333335, 8.404666666666666, 7.705, 7.908000000000001, 6.4626666666666654, 6.605, 7.2973333333333334, 8.582333333333333, 10.976666666666665, 9.514, 5.957999999999999, 10.748666666666663, 6.288333333333333, 10.526333333333332, 10.153666666666664, 13.214333333333336, 8.069999999999999, 7.660666666666667, 7.347999999999999, 8.363333333333333, 9.339666666666666, 8.067, 14.137333333333334, 12.480999999999996, 9.568333333333333, 7.756, 10.110999999999999, 11.224, 8.469333333333331, 8.703666666666663, 8.413666666666666, 10.624666666666664, 9.614333333333327, 7.573333333333331, 6.624666666666666, 7.219999999999999, 10.989333333333336, 14.743999999999994, 7.105333333333334, 6.673666666666666, 10.440333333333335, 10.763999999999998, 10.683666666666664, 10.889333333333333, 10.161333333333335, 5.890000000000001, 6.957999999999999, 9.993666666666666, 7.121, 6.651333333333331, 7.024999999999999, 8.459333333333333], "episode_lengths": [18, 23, 18, 20, 16, 19, 19, 16, 19, 17, 19, 16, 17, 16, 18, 16, 16, 15, 19, 18, 18, 18, 17, 16, 14, 15, 15, 17, 18, 19, 16, 17, 19, 20, 18, 20, 16, 24, 16, 17, 14, 21, 17, 19, 23, 15, 16, 16, 22, 18, 16, 17, 15, 14, 16, 19, 20, 24, 14, 22, 14, 21, 19, 28, 17, 16, 16, 19, 23, 19, 27, 26, 22, 19, 22, 21, 16, 19, 19, 22, 21, 18, 14, 14, 24, 29, 15, 15, 23, 23, 21, 22, 22, 13, 15, 20, 16, 14, 15, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6557306108671888, "mean_inference_ms": 3.024890485632856, "mean_action_processing_ms": 0.628647596695162, "mean_env_wait_ms": 0.14987028624878498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025422334671020508, "StateBufferConnector_ms": 0.015668392181396484, "ViewRequirementAgentConnector_ms": 0.7045257091522217}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 813.5568572901137, "num_env_steps_trained_throughput_per_sec": 813.5568572901137, "timesteps_total": 84000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 1390.971, "sample_time_ms": 1355.306, "load_time_ms": 0.406, "load_throughput": 3445619.998, "learn_time_ms": 13.717, "learn_throughput": 102060.948, "synch_weights_time_ms": 21.135}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 4499, "training_iteration": 60, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-12", "timestamp": 1702021212, "time_this_iter_s": 1.7438435554504395, "time_total_s": 73.74428534507751, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 73.74428534507751, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 100.0, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0901248455047607, "total_loss": 1.0901248455047607, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 85400, "num_env_steps_trained": 85400, "num_agent_steps_sampled": 85400, "num_agent_steps_trained": 85400}, "sampler_results": {"episode_reward_max": 14.743999999999994, "episode_reward_min": 5.841999999999999, "episode_reward_mean": 8.753876666666667, "episode_len_mean": 18.57, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.224, 8.469333333333331, 8.703666666666663, 8.413666666666666, 10.624666666666664, 9.614333333333327, 7.573333333333331, 6.624666666666666, 7.219999999999999, 10.989333333333336, 14.743999999999994, 7.105333333333334, 6.673666666666666, 10.440333333333335, 10.763999999999998, 10.683666666666664, 10.889333333333333, 10.161333333333335, 5.890000000000001, 6.957999999999999, 9.993666666666666, 7.121, 6.651333333333331, 7.024999999999999, 8.459333333333333, 7.729333333333333, 7.558333333333333, 8.670666666666666, 8.716666666666667, 11.373999999999997, 7.841333333333333, 8.877, 7.454666666666666, 10.694, 8.057333333333332, 8.851333333333333, 10.831666666666669, 6.621333333333332, 8.275333333333332, 9.364666666666665, 7.664999999999999, 9.909333333333333, 7.058333333333333, 7.188666666666665, 10.660666666666666, 9.350666666666665, 7.1466666666666665, 7.4079999999999995, 7.865999999999999, 8.627333333333333, 8.657666666666668, 8.824666666666666, 10.917333333333335, 6.626666666666667, 8.599333333333332, 10.684, 10.307666666666668, 9.386666666666667, 8.064, 10.756333333333338, 7.051999999999999, 9.407666666666666, 9.276999999999997, 8.997999999999998, 7.707666666666666, 9.533, 10.543999999999997, 10.357666666666667, 9.60533333333333, 8.503333333333334, 9.104333333333333, 7.643000000000001, 9.867333333333335, 9.643666666666665, 10.554333333333336, 9.213, 7.697333333333332, 9.006333333333332, 10.597333333333333, 12.461333333333332, 9.793666666666669, 8.048333333333336, 6.502333333333332, 8.042666666666664, 6.744666666666667, 6.353999999999998, 8.210666666666667, 7.444000000000001, 7.846, 10.220333333333334, 8.713333333333331, 5.841999999999999, 7.969666666666666, 7.019666666666666, 6.987333333333332, 9.370999999999999, 9.992333333333335, 7.962666666666666, 6.919333333333332, 8.990333333333334], "episode_lengths": [21, 16, 19, 19, 22, 21, 18, 14, 14, 24, 29, 15, 15, 23, 23, 21, 22, 22, 13, 15, 20, 16, 14, 15, 19, 18, 16, 19, 21, 20, 15, 19, 17, 21, 17, 18, 24, 15, 18, 18, 15, 22, 16, 15, 20, 20, 16, 16, 18, 17, 20, 18, 25, 14, 20, 22, 22, 20, 16, 22, 16, 19, 18, 17, 16, 18, 22, 24, 21, 18, 18, 16, 21, 21, 22, 19, 16, 22, 24, 25, 21, 17, 15, 17, 16, 14, 16, 15, 19, 22, 17, 13, 18, 15, 14, 22, 19, 17, 15, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6608858846619285, "mean_inference_ms": 3.030570162635499, "mean_action_processing_ms": 0.6295678252024421, "mean_env_wait_ms": 0.15117842359932848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034262657165527344, "StateBufferConnector_ms": 0.020168066024780273, "ViewRequirementAgentConnector_ms": 0.6014413833618164}}, "episode_reward_max": 14.743999999999994, "episode_reward_min": 5.841999999999999, "episode_reward_mean": 8.753876666666667, "episode_len_mean": 18.57, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.224, 8.469333333333331, 8.703666666666663, 8.413666666666666, 10.624666666666664, 9.614333333333327, 7.573333333333331, 6.624666666666666, 7.219999999999999, 10.989333333333336, 14.743999999999994, 7.105333333333334, 6.673666666666666, 10.440333333333335, 10.763999999999998, 10.683666666666664, 10.889333333333333, 10.161333333333335, 5.890000000000001, 6.957999999999999, 9.993666666666666, 7.121, 6.651333333333331, 7.024999999999999, 8.459333333333333, 7.729333333333333, 7.558333333333333, 8.670666666666666, 8.716666666666667, 11.373999999999997, 7.841333333333333, 8.877, 7.454666666666666, 10.694, 8.057333333333332, 8.851333333333333, 10.831666666666669, 6.621333333333332, 8.275333333333332, 9.364666666666665, 7.664999999999999, 9.909333333333333, 7.058333333333333, 7.188666666666665, 10.660666666666666, 9.350666666666665, 7.1466666666666665, 7.4079999999999995, 7.865999999999999, 8.627333333333333, 8.657666666666668, 8.824666666666666, 10.917333333333335, 6.626666666666667, 8.599333333333332, 10.684, 10.307666666666668, 9.386666666666667, 8.064, 10.756333333333338, 7.051999999999999, 9.407666666666666, 9.276999999999997, 8.997999999999998, 7.707666666666666, 9.533, 10.543999999999997, 10.357666666666667, 9.60533333333333, 8.503333333333334, 9.104333333333333, 7.643000000000001, 9.867333333333335, 9.643666666666665, 10.554333333333336, 9.213, 7.697333333333332, 9.006333333333332, 10.597333333333333, 12.461333333333332, 9.793666666666669, 8.048333333333336, 6.502333333333332, 8.042666666666664, 6.744666666666667, 6.353999999999998, 8.210666666666667, 7.444000000000001, 7.846, 10.220333333333334, 8.713333333333331, 5.841999999999999, 7.969666666666666, 7.019666666666666, 6.987333333333332, 9.370999999999999, 9.992333333333335, 7.962666666666666, 6.919333333333332, 8.990333333333334], "episode_lengths": [21, 16, 19, 19, 22, 21, 18, 14, 14, 24, 29, 15, 15, 23, 23, 21, 22, 22, 13, 15, 20, 16, 14, 15, 19, 18, 16, 19, 21, 20, 15, 19, 17, 21, 17, 18, 24, 15, 18, 18, 15, 22, 16, 15, 20, 20, 16, 16, 18, 17, 20, 18, 25, 14, 20, 22, 22, 20, 16, 22, 16, 19, 18, 17, 16, 18, 22, 24, 21, 18, 18, 16, 21, 21, 22, 19, 16, 22, 24, 25, 21, 17, 15, 17, 16, 14, 16, 15, 19, 22, 17, 13, 18, 15, 14, 22, 19, 17, 15, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6608858846619285, "mean_inference_ms": 3.030570162635499, "mean_action_processing_ms": 0.6295678252024421, "mean_env_wait_ms": 0.15117842359932848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034262657165527344, "StateBufferConnector_ms": 0.020168066024780273, "ViewRequirementAgentConnector_ms": 0.6014413833618164}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85400, "num_agent_steps_trained": 85400, "num_env_steps_sampled": 85400, "num_env_steps_trained": 85400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1130.1191412132753, "num_env_steps_trained_throughput_per_sec": 1130.1191412132753, "timesteps_total": 85400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 85400, "timers": {"training_iteration_time_ms": 1396.424, "sample_time_ms": 1361.461, "load_time_ms": 0.406, "load_throughput": 3445619.998, "learn_time_ms": 13.417, "learn_throughput": 104345.191, "synch_weights_time_ms": 20.733}, "counters": {"num_env_steps_sampled": 85400, "num_env_steps_trained": 85400, "num_agent_steps_sampled": 85400, "num_agent_steps_trained": 85400}, "done": false, "episodes_total": 4574, "training_iteration": 61, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-13", "timestamp": 1702021213, "time_this_iter_s": 1.2609045505523682, "time_total_s": 75.00518989562988, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 75.00518989562988, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 98.55, "ram_util_percent": 95.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0872795581817627, "total_loss": 1.0872795581817627, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 86800, "num_env_steps_trained": 86800, "num_agent_steps_sampled": 86800, "num_agent_steps_trained": 86800}, "sampler_results": {"episode_reward_max": 13.308666666666664, "episode_reward_min": 5.841999999999999, "episode_reward_mean": 8.521339999999999, "episode_len_mean": 18.28, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.213, 7.697333333333332, 9.006333333333332, 10.597333333333333, 12.461333333333332, 9.793666666666669, 8.048333333333336, 6.502333333333332, 8.042666666666664, 6.744666666666667, 6.353999999999998, 8.210666666666667, 7.444000000000001, 7.846, 10.220333333333334, 8.713333333333331, 5.841999999999999, 7.969666666666666, 7.019666666666666, 6.987333333333332, 9.370999999999999, 9.992333333333335, 7.962666666666666, 6.919333333333332, 8.990333333333334, 7.997333333333334, 9.844666666666665, 8.070333333333332, 9.559, 6.6339999999999995, 8.825999999999999, 7.737666666666667, 6.9140000000000015, 8.122666666666667, 8.213, 7.6596666666666655, 13.308666666666664, 9.050999999999998, 10.072999999999999, 8.376666666666667, 7.402333333333334, 7.580666666666665, 8.76333333333333, 9.582999999999998, 7.675333333333333, 6.7463333333333315, 9.062333333333333, 11.632999999999996, 7.968999999999997, 6.831666666666668, 6.703333333333332, 9.885333333333334, 8.906666666666663, 7.408999999999999, 7.173666666666666, 9.155999999999999, 8.575, 8.236666666666666, 9.211, 7.677666666666666, 6.7043333333333335, 6.948333333333332, 6.685999999999999, 7.403666666666666, 9.690333333333331, 12.824333333333332, 8.294666666666664, 8.476999999999999, 6.599999999999998, 8.403666666666664, 9.377666666666666, 9.807999999999998, 6.282333333333334, 11.649999999999993, 8.214333333333332, 7.497333333333334, 8.317, 8.031666666666666, 8.396666666666665, 10.600000000000001, 7.536999999999999, 9.372333333333332, 8.854000000000001, 6.78, 7.018666666666666, 8.543999999999999, 7.0749999999999975, 7.975, 8.471666666666666, 8.568666666666665, 10.333333333333329, 11.397333333333334, 12.915333333333336, 6.952333333333334, 9.664000000000001, 7.249666666666665, 11.824666666666666, 12.467333333333329, 6.871333333333333, 7.536333333333333], "episode_lengths": [19, 16, 22, 24, 25, 21, 17, 15, 17, 16, 14, 16, 15, 19, 22, 17, 13, 18, 15, 14, 22, 19, 17, 15, 22, 17, 20, 16, 20, 14, 21, 16, 15, 17, 19, 18, 26, 19, 25, 18, 16, 16, 18, 18, 16, 17, 21, 25, 16, 16, 14, 19, 21, 16, 16, 22, 18, 20, 22, 17, 15, 14, 15, 19, 20, 24, 17, 18, 14, 17, 22, 22, 15, 22, 20, 17, 19, 19, 17, 23, 16, 19, 17, 14, 15, 18, 15, 17, 17, 18, 22, 22, 23, 15, 21, 16, 23, 25, 15, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6581305778936537, "mean_inference_ms": 3.026826434544357, "mean_action_processing_ms": 0.6284864163274146, "mean_env_wait_ms": 0.1507887481771676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0171816349029541, "StateBufferConnector_ms": 0.02175164222717285, "ViewRequirementAgentConnector_ms": 0.48770880699157715}}, "episode_reward_max": 13.308666666666664, "episode_reward_min": 5.841999999999999, "episode_reward_mean": 8.521339999999999, "episode_len_mean": 18.28, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.213, 7.697333333333332, 9.006333333333332, 10.597333333333333, 12.461333333333332, 9.793666666666669, 8.048333333333336, 6.502333333333332, 8.042666666666664, 6.744666666666667, 6.353999999999998, 8.210666666666667, 7.444000000000001, 7.846, 10.220333333333334, 8.713333333333331, 5.841999999999999, 7.969666666666666, 7.019666666666666, 6.987333333333332, 9.370999999999999, 9.992333333333335, 7.962666666666666, 6.919333333333332, 8.990333333333334, 7.997333333333334, 9.844666666666665, 8.070333333333332, 9.559, 6.6339999999999995, 8.825999999999999, 7.737666666666667, 6.9140000000000015, 8.122666666666667, 8.213, 7.6596666666666655, 13.308666666666664, 9.050999999999998, 10.072999999999999, 8.376666666666667, 7.402333333333334, 7.580666666666665, 8.76333333333333, 9.582999999999998, 7.675333333333333, 6.7463333333333315, 9.062333333333333, 11.632999999999996, 7.968999999999997, 6.831666666666668, 6.703333333333332, 9.885333333333334, 8.906666666666663, 7.408999999999999, 7.173666666666666, 9.155999999999999, 8.575, 8.236666666666666, 9.211, 7.677666666666666, 6.7043333333333335, 6.948333333333332, 6.685999999999999, 7.403666666666666, 9.690333333333331, 12.824333333333332, 8.294666666666664, 8.476999999999999, 6.599999999999998, 8.403666666666664, 9.377666666666666, 9.807999999999998, 6.282333333333334, 11.649999999999993, 8.214333333333332, 7.497333333333334, 8.317, 8.031666666666666, 8.396666666666665, 10.600000000000001, 7.536999999999999, 9.372333333333332, 8.854000000000001, 6.78, 7.018666666666666, 8.543999999999999, 7.0749999999999975, 7.975, 8.471666666666666, 8.568666666666665, 10.333333333333329, 11.397333333333334, 12.915333333333336, 6.952333333333334, 9.664000000000001, 7.249666666666665, 11.824666666666666, 12.467333333333329, 6.871333333333333, 7.536333333333333], "episode_lengths": [19, 16, 22, 24, 25, 21, 17, 15, 17, 16, 14, 16, 15, 19, 22, 17, 13, 18, 15, 14, 22, 19, 17, 15, 22, 17, 20, 16, 20, 14, 21, 16, 15, 17, 19, 18, 26, 19, 25, 18, 16, 16, 18, 18, 16, 17, 21, 25, 16, 16, 14, 19, 21, 16, 16, 22, 18, 20, 22, 17, 15, 14, 15, 19, 20, 24, 17, 18, 14, 17, 22, 22, 15, 22, 20, 17, 19, 19, 17, 23, 16, 19, 17, 14, 15, 18, 15, 17, 17, 18, 22, 22, 23, 15, 21, 16, 23, 25, 15, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6581305778936537, "mean_inference_ms": 3.026826434544357, "mean_action_processing_ms": 0.6284864163274146, "mean_env_wait_ms": 0.1507887481771676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0171816349029541, "StateBufferConnector_ms": 0.02175164222717285, "ViewRequirementAgentConnector_ms": 0.48770880699157715}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86800, "num_agent_steps_trained": 86800, "num_env_steps_sampled": 86800, "num_env_steps_trained": 86800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1361.002984366149, "num_env_steps_trained_throughput_per_sec": 1361.002984366149, "timesteps_total": 86800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 86800, "timers": {"training_iteration_time_ms": 1391.319, "sample_time_ms": 1356.357, "load_time_ms": 0.406, "load_throughput": 3445619.998, "learn_time_ms": 13.517, "learn_throughput": 103575.301, "synch_weights_time_ms": 20.634}, "counters": {"num_env_steps_sampled": 86800, "num_env_steps_trained": 86800, "num_agent_steps_sampled": 86800, "num_agent_steps_trained": 86800}, "done": false, "episodes_total": 4649, "training_iteration": 62, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-14", "timestamp": 1702021214, "time_this_iter_s": 1.0482068061828613, "time_total_s": 76.05339670181274, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 76.05339670181274, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 94.8, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.095144271850586, "total_loss": 1.095144271850586, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 88200, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88200, "num_agent_steps_trained": 88200}, "sampler_results": {"episode_reward_max": 13.219000000000001, "episode_reward_min": 5.641333333333334, "episode_reward_mean": 8.757493333333333, "episode_len_mean": 18.63, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.317, 8.031666666666666, 8.396666666666665, 10.600000000000001, 7.536999999999999, 9.372333333333332, 8.854000000000001, 6.78, 7.018666666666666, 8.543999999999999, 7.0749999999999975, 7.975, 8.471666666666666, 8.568666666666665, 10.333333333333329, 11.397333333333334, 12.915333333333336, 6.952333333333334, 9.664000000000001, 7.249666666666665, 11.824666666666666, 12.467333333333329, 6.871333333333333, 7.536333333333333, 9.709666666666667, 8.014666666666663, 6.645666666666667, 9.040666666666665, 12.29633333333333, 8.114666666666665, 7.904999999999999, 8.417666666666666, 8.449333333333334, 8.476999999999999, 5.641333333333334, 8.517666666666667, 8.049333333333331, 8.350999999999997, 12.100666666666667, 8.966333333333335, 9.367999999999999, 9.210333333333331, 10.693000000000001, 10.668333333333331, 8.513333333333335, 8.296333333333331, 10.501666666666667, 9.316666666666665, 7.502, 9.915333333333333, 9.132, 6.215999999999999, 12.90066666666667, 7.383333333333332, 8.541666666666666, 7.955999999999999, 7.719999999999999, 8.057666666666666, 9.415999999999999, 8.179333333333332, 8.833333333333332, 11.322999999999997, 9.56333333333333, 7.458999999999998, 9.509333333333332, 9.584666666666665, 8.833333333333334, 6.968999999999999, 12.368333333333332, 8.311666666666664, 9.894333333333334, 6.380666666666666, 8.890999999999998, 10.136666666666667, 7.697333333333333, 6.726999999999999, 8.994666666666665, 6.841999999999999, 9.397, 6.904333333333333, 11.363666666666667, 9.203999999999997, 7.111333333333333, 6.590333333333334, 9.482999999999999, 7.125333333333331, 9.142333333333333, 7.766666666666666, 10.777333333333335, 10.519999999999994, 9.751999999999999, 7.847999999999998, 6.697666666666665, 7.022333333333333, 6.221000000000001, 6.901000000000001, 9.095666666666665, 13.219000000000001, 6.795666666666666, 7.554999999999998], "episode_lengths": [19, 19, 17, 23, 16, 19, 17, 14, 15, 18, 15, 17, 17, 18, 22, 22, 23, 15, 21, 16, 23, 25, 15, 16, 20, 17, 14, 19, 27, 17, 16, 18, 18, 17, 14, 17, 16, 18, 27, 19, 19, 20, 23, 23, 18, 20, 21, 19, 16, 21, 23, 14, 24, 16, 19, 17, 17, 16, 21, 20, 19, 25, 22, 17, 20, 19, 20, 17, 27, 16, 22, 14, 19, 20, 15, 15, 18, 14, 20, 15, 23, 21, 15, 14, 22, 16, 20, 16, 21, 22, 19, 17, 15, 15, 14, 17, 20, 27, 15, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6542511035854741, "mean_inference_ms": 3.0172648836307787, "mean_action_processing_ms": 0.6265114739430119, "mean_env_wait_ms": 0.15041802366025764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02605605125427246, "StateBufferConnector_ms": 0.018283367156982422, "ViewRequirementAgentConnector_ms": 0.4879579544067383}}, "episode_reward_max": 13.219000000000001, "episode_reward_min": 5.641333333333334, "episode_reward_mean": 8.757493333333333, "episode_len_mean": 18.63, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.317, 8.031666666666666, 8.396666666666665, 10.600000000000001, 7.536999999999999, 9.372333333333332, 8.854000000000001, 6.78, 7.018666666666666, 8.543999999999999, 7.0749999999999975, 7.975, 8.471666666666666, 8.568666666666665, 10.333333333333329, 11.397333333333334, 12.915333333333336, 6.952333333333334, 9.664000000000001, 7.249666666666665, 11.824666666666666, 12.467333333333329, 6.871333333333333, 7.536333333333333, 9.709666666666667, 8.014666666666663, 6.645666666666667, 9.040666666666665, 12.29633333333333, 8.114666666666665, 7.904999999999999, 8.417666666666666, 8.449333333333334, 8.476999999999999, 5.641333333333334, 8.517666666666667, 8.049333333333331, 8.350999999999997, 12.100666666666667, 8.966333333333335, 9.367999999999999, 9.210333333333331, 10.693000000000001, 10.668333333333331, 8.513333333333335, 8.296333333333331, 10.501666666666667, 9.316666666666665, 7.502, 9.915333333333333, 9.132, 6.215999999999999, 12.90066666666667, 7.383333333333332, 8.541666666666666, 7.955999999999999, 7.719999999999999, 8.057666666666666, 9.415999999999999, 8.179333333333332, 8.833333333333332, 11.322999999999997, 9.56333333333333, 7.458999999999998, 9.509333333333332, 9.584666666666665, 8.833333333333334, 6.968999999999999, 12.368333333333332, 8.311666666666664, 9.894333333333334, 6.380666666666666, 8.890999999999998, 10.136666666666667, 7.697333333333333, 6.726999999999999, 8.994666666666665, 6.841999999999999, 9.397, 6.904333333333333, 11.363666666666667, 9.203999999999997, 7.111333333333333, 6.590333333333334, 9.482999999999999, 7.125333333333331, 9.142333333333333, 7.766666666666666, 10.777333333333335, 10.519999999999994, 9.751999999999999, 7.847999999999998, 6.697666666666665, 7.022333333333333, 6.221000000000001, 6.901000000000001, 9.095666666666665, 13.219000000000001, 6.795666666666666, 7.554999999999998], "episode_lengths": [19, 19, 17, 23, 16, 19, 17, 14, 15, 18, 15, 17, 17, 18, 22, 22, 23, 15, 21, 16, 23, 25, 15, 16, 20, 17, 14, 19, 27, 17, 16, 18, 18, 17, 14, 17, 16, 18, 27, 19, 19, 20, 23, 23, 18, 20, 21, 19, 16, 21, 23, 14, 24, 16, 19, 17, 17, 16, 21, 20, 19, 25, 22, 17, 20, 19, 20, 17, 27, 16, 22, 14, 19, 20, 15, 15, 18, 14, 20, 15, 23, 21, 15, 14, 22, 16, 20, 16, 21, 22, 19, 17, 15, 15, 14, 17, 20, 27, 15, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6542511035854741, "mean_inference_ms": 3.0172648836307787, "mean_action_processing_ms": 0.6265114739430119, "mean_env_wait_ms": 0.15041802366025764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02605605125427246, "StateBufferConnector_ms": 0.018283367156982422, "ViewRequirementAgentConnector_ms": 0.4879579544067383}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88200, "num_agent_steps_trained": 88200, "num_env_steps_sampled": 88200, "num_env_steps_trained": 88200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1418.9274723893914, "num_env_steps_trained_throughput_per_sec": 1418.9274723893914, "timesteps_total": 88200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 88200, "timers": {"training_iteration_time_ms": 1372.977, "sample_time_ms": 1337.605, "load_time_ms": 0.308, "load_throughput": 4546318.984, "learn_time_ms": 13.69, "learn_throughput": 102262.684, "synch_weights_time_ms": 21.056}, "counters": {"num_env_steps_sampled": 88200, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88200, "num_agent_steps_trained": 88200}, "done": false, "episodes_total": 4725, "training_iteration": 63, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-15", "timestamp": 1702021215, "time_this_iter_s": 1.005713939666748, "time_total_s": 77.05911064147949, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.05911064147949, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 96.0, "ram_util_percent": 95.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0958929061889648, "total_loss": 1.0958929061889648, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600}, "sampler_results": {"episode_reward_max": 14.815999999999995, "episode_reward_min": 5.725, "episode_reward_mean": 8.501759999999999, "episode_len_mean": 18.13, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.841999999999999, 9.397, 6.904333333333333, 11.363666666666667, 9.203999999999997, 7.111333333333333, 6.590333333333334, 9.482999999999999, 7.125333333333331, 9.142333333333333, 7.766666666666666, 10.777333333333335, 10.519999999999994, 9.751999999999999, 7.847999999999998, 6.697666666666665, 7.022333333333333, 6.221000000000001, 6.901000000000001, 9.095666666666665, 13.219000000000001, 6.795666666666666, 7.554999999999998, 8.525666666666664, 8.693333333333332, 9.031333333333333, 8.759333333333334, 7.230999999999999, 7.223999999999999, 9.40833333333333, 7.288333333333333, 7.0906666666666665, 6.682666666666665, 8.528666666666664, 9.769999999999998, 9.893666666666665, 9.606000000000002, 7.611999999999998, 9.41433333333333, 8.70133333333333, 9.238666666666665, 6.908999999999998, 8.896333333333333, 6.859333333333334, 7.752666666666665, 5.725, 13.098666666666665, 8.460666666666665, 7.791666666666667, 7.225999999999998, 6.774333333333332, 8.634999999999998, 8.514333333333333, 7.699999999999998, 7.5473333333333334, 11.799333333333333, 7.879666666666667, 7.621999999999998, 6.638333333333332, 12.659999999999995, 9.669999999999998, 9.248999999999997, 8.559333333333333, 9.995333333333331, 8.579333333333333, 11.05733333333333, 7.045999999999998, 6.943999999999999, 6.179, 8.352333333333332, 7.369333333333333, 7.843333333333332, 9.524999999999999, 7.1323333333333325, 7.349666666666666, 8.667, 9.258333333333331, 8.880333333333333, 7.015666666666666, 7.934000000000001, 9.956333333333335, 7.628333333333335, 9.081333333333333, 9.902666666666667, 8.741333333333333, 8.760333333333332, 9.203999999999997, 7.640666666666665, 9.118666666666666, 14.815999999999995, 7.771333333333332, 11.395333333333332, 7.51, 9.74033333333333, 8.101333333333331, 7.394, 10.38733333333333, 6.409666666666666, 7.895999999999999, 7.5906666666666665], "episode_lengths": [14, 20, 15, 23, 21, 15, 14, 22, 16, 20, 16, 21, 22, 19, 17, 15, 15, 14, 17, 20, 27, 15, 17, 21, 20, 20, 19, 16, 17, 24, 15, 17, 15, 18, 21, 23, 20, 16, 21, 17, 19, 15, 19, 14, 20, 13, 24, 19, 17, 16, 16, 18, 20, 17, 15, 22, 16, 16, 15, 26, 19, 20, 19, 20, 19, 22, 17, 16, 14, 16, 15, 16, 20, 16, 17, 17, 18, 19, 15, 17, 19, 17, 18, 22, 18, 18, 17, 15, 21, 31, 16, 22, 16, 21, 18, 15, 20, 13, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6546509531615743, "mean_inference_ms": 3.016421151627569, "mean_action_processing_ms": 0.6260770203759312, "mean_env_wait_ms": 0.14998202597414695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019657611846923828, "StateBufferConnector_ms": 0.020082712173461914, "ViewRequirementAgentConnector_ms": 0.48887157440185547}}, "episode_reward_max": 14.815999999999995, "episode_reward_min": 5.725, "episode_reward_mean": 8.501759999999999, "episode_len_mean": 18.13, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.841999999999999, 9.397, 6.904333333333333, 11.363666666666667, 9.203999999999997, 7.111333333333333, 6.590333333333334, 9.482999999999999, 7.125333333333331, 9.142333333333333, 7.766666666666666, 10.777333333333335, 10.519999999999994, 9.751999999999999, 7.847999999999998, 6.697666666666665, 7.022333333333333, 6.221000000000001, 6.901000000000001, 9.095666666666665, 13.219000000000001, 6.795666666666666, 7.554999999999998, 8.525666666666664, 8.693333333333332, 9.031333333333333, 8.759333333333334, 7.230999999999999, 7.223999999999999, 9.40833333333333, 7.288333333333333, 7.0906666666666665, 6.682666666666665, 8.528666666666664, 9.769999999999998, 9.893666666666665, 9.606000000000002, 7.611999999999998, 9.41433333333333, 8.70133333333333, 9.238666666666665, 6.908999999999998, 8.896333333333333, 6.859333333333334, 7.752666666666665, 5.725, 13.098666666666665, 8.460666666666665, 7.791666666666667, 7.225999999999998, 6.774333333333332, 8.634999999999998, 8.514333333333333, 7.699999999999998, 7.5473333333333334, 11.799333333333333, 7.879666666666667, 7.621999999999998, 6.638333333333332, 12.659999999999995, 9.669999999999998, 9.248999999999997, 8.559333333333333, 9.995333333333331, 8.579333333333333, 11.05733333333333, 7.045999999999998, 6.943999999999999, 6.179, 8.352333333333332, 7.369333333333333, 7.843333333333332, 9.524999999999999, 7.1323333333333325, 7.349666666666666, 8.667, 9.258333333333331, 8.880333333333333, 7.015666666666666, 7.934000000000001, 9.956333333333335, 7.628333333333335, 9.081333333333333, 9.902666666666667, 8.741333333333333, 8.760333333333332, 9.203999999999997, 7.640666666666665, 9.118666666666666, 14.815999999999995, 7.771333333333332, 11.395333333333332, 7.51, 9.74033333333333, 8.101333333333331, 7.394, 10.38733333333333, 6.409666666666666, 7.895999999999999, 7.5906666666666665], "episode_lengths": [14, 20, 15, 23, 21, 15, 14, 22, 16, 20, 16, 21, 22, 19, 17, 15, 15, 14, 17, 20, 27, 15, 17, 21, 20, 20, 19, 16, 17, 24, 15, 17, 15, 18, 21, 23, 20, 16, 21, 17, 19, 15, 19, 14, 20, 13, 24, 19, 17, 16, 16, 18, 20, 17, 15, 22, 16, 16, 15, 26, 19, 20, 19, 20, 19, 22, 17, 16, 14, 16, 15, 16, 20, 16, 17, 17, 18, 19, 15, 17, 19, 17, 18, 22, 18, 18, 17, 15, 21, 31, 16, 22, 16, 21, 18, 15, 20, 13, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6546509531615743, "mean_inference_ms": 3.016421151627569, "mean_action_processing_ms": 0.6260770203759312, "mean_env_wait_ms": 0.14998202597414695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019657611846923828, "StateBufferConnector_ms": 0.020082712173461914, "ViewRequirementAgentConnector_ms": 0.48887157440185547}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600, "num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1163.762973116043, "num_env_steps_trained_throughput_per_sec": 1163.762973116043, "timesteps_total": 89600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 89600, "timers": {"training_iteration_time_ms": 1343.486, "sample_time_ms": 1307.79, "load_time_ms": 0.261, "load_throughput": 5366010.783, "learn_time_ms": 13.937, "learn_throughput": 100452.403, "synch_weights_time_ms": 21.181}, "counters": {"num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600}, "done": false, "episodes_total": 4802, "training_iteration": 64, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-17", "timestamp": 1702021217, "time_this_iter_s": 1.2177543640136719, "time_total_s": 78.27686500549316, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 78.27686500549316, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 98.8, "ram_util_percent": 94.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0912554264068604, "total_loss": 1.0912554264068604, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 91000, "num_env_steps_trained": 91000, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 91000}, "sampler_results": {"episode_reward_max": 14.815999999999995, "episode_reward_min": 5.501999999999999, "episode_reward_mean": 8.98762, "episode_len_mean": 18.73, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.349666666666666, 8.667, 9.258333333333331, 8.880333333333333, 7.015666666666666, 7.934000000000001, 9.956333333333335, 7.628333333333335, 9.081333333333333, 9.902666666666667, 8.741333333333333, 8.760333333333332, 9.203999999999997, 7.640666666666665, 9.118666666666666, 14.815999999999995, 7.771333333333332, 11.395333333333332, 7.51, 9.74033333333333, 8.101333333333331, 7.394, 10.38733333333333, 6.409666666666666, 7.895999999999999, 7.5906666666666665, 11.021333333333335, 8.595333333333333, 8.116999999999999, 9.144666666666666, 9.878333333333334, 7.823999999999999, 8.838666666666667, 6.717999999999998, 14.073333333333332, 7.827, 8.288999999999998, 8.604, 8.008666666666665, 8.912, 7.673, 7.661666666666666, 7.156999999999998, 8.486999999999998, 8.846999999999998, 8.51533333333333, 11.846333333333332, 9.895333333333332, 12.142999999999997, 8.402999999999999, 11.605999999999996, 9.309, 8.263333333333332, 6.711, 5.501999999999999, 7.737666666666667, 9.953333333333333, 8.157333333333332, 6.285, 8.482333333333333, 8.998999999999999, 10.922666666666661, 10.860000000000001, 12.952333333333328, 7.594666666666667, 8.055, 9.907999999999998, 11.754666666666663, 9.780666666666667, 7.365, 8.415999999999999, 13.115000000000004, 8.339333333333334, 7.848999999999998, 11.191, 8.438333333333333, 8.339666666666666, 8.88133333333333, 9.290666666666667, 8.132333333333332, 11.372666666666664, 7.222666666666666, 9.331333333333331, 11.366666666666667, 9.136999999999999, 7.197999999999998, 6.9243333333333315, 9.467333333333332, 10.31033333333333, 7.580666666666667, 6.899, 10.371333333333334, 8.449, 7.4270000000000005, 7.2866666666666635, 10.325666666666665, 12.381, 7.828999999999997, 9.426999999999998, 11.633], "episode_lengths": [17, 17, 18, 19, 15, 17, 19, 17, 18, 22, 18, 18, 17, 15, 21, 31, 16, 22, 16, 21, 18, 15, 20, 13, 16, 16, 24, 18, 17, 19, 19, 17, 18, 15, 29, 18, 20, 17, 16, 20, 17, 17, 15, 17, 19, 17, 22, 19, 25, 18, 24, 22, 16, 15, 14, 17, 21, 18, 13, 19, 18, 22, 23, 25, 19, 17, 18, 24, 19, 15, 19, 25, 18, 15, 23, 17, 16, 20, 21, 18, 23, 15, 18, 24, 18, 15, 17, 19, 22, 15, 15, 21, 18, 16, 17, 23, 21, 17, 22, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6497391352840594, "mean_inference_ms": 3.0057711138895864, "mean_action_processing_ms": 0.6245351048018698, "mean_env_wait_ms": 0.14962630479361183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01951432228088379, "StateBufferConnector_ms": 0.017423391342163086, "ViewRequirementAgentConnector_ms": 0.4298262596130371}}, "episode_reward_max": 14.815999999999995, "episode_reward_min": 5.501999999999999, "episode_reward_mean": 8.98762, "episode_len_mean": 18.73, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.349666666666666, 8.667, 9.258333333333331, 8.880333333333333, 7.015666666666666, 7.934000000000001, 9.956333333333335, 7.628333333333335, 9.081333333333333, 9.902666666666667, 8.741333333333333, 8.760333333333332, 9.203999999999997, 7.640666666666665, 9.118666666666666, 14.815999999999995, 7.771333333333332, 11.395333333333332, 7.51, 9.74033333333333, 8.101333333333331, 7.394, 10.38733333333333, 6.409666666666666, 7.895999999999999, 7.5906666666666665, 11.021333333333335, 8.595333333333333, 8.116999999999999, 9.144666666666666, 9.878333333333334, 7.823999999999999, 8.838666666666667, 6.717999999999998, 14.073333333333332, 7.827, 8.288999999999998, 8.604, 8.008666666666665, 8.912, 7.673, 7.661666666666666, 7.156999999999998, 8.486999999999998, 8.846999999999998, 8.51533333333333, 11.846333333333332, 9.895333333333332, 12.142999999999997, 8.402999999999999, 11.605999999999996, 9.309, 8.263333333333332, 6.711, 5.501999999999999, 7.737666666666667, 9.953333333333333, 8.157333333333332, 6.285, 8.482333333333333, 8.998999999999999, 10.922666666666661, 10.860000000000001, 12.952333333333328, 7.594666666666667, 8.055, 9.907999999999998, 11.754666666666663, 9.780666666666667, 7.365, 8.415999999999999, 13.115000000000004, 8.339333333333334, 7.848999999999998, 11.191, 8.438333333333333, 8.339666666666666, 8.88133333333333, 9.290666666666667, 8.132333333333332, 11.372666666666664, 7.222666666666666, 9.331333333333331, 11.366666666666667, 9.136999999999999, 7.197999999999998, 6.9243333333333315, 9.467333333333332, 10.31033333333333, 7.580666666666667, 6.899, 10.371333333333334, 8.449, 7.4270000000000005, 7.2866666666666635, 10.325666666666665, 12.381, 7.828999999999997, 9.426999999999998, 11.633], "episode_lengths": [17, 17, 18, 19, 15, 17, 19, 17, 18, 22, 18, 18, 17, 15, 21, 31, 16, 22, 16, 21, 18, 15, 20, 13, 16, 16, 24, 18, 17, 19, 19, 17, 18, 15, 29, 18, 20, 17, 16, 20, 17, 17, 15, 17, 19, 17, 22, 19, 25, 18, 24, 22, 16, 15, 14, 17, 21, 18, 13, 19, 18, 22, 23, 25, 19, 17, 18, 24, 19, 15, 19, 25, 18, 15, 23, 17, 16, 20, 21, 18, 23, 15, 18, 24, 18, 15, 17, 19, 22, 15, 15, 21, 18, 16, 17, 23, 21, 17, 22, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6497391352840594, "mean_inference_ms": 3.0057711138895864, "mean_action_processing_ms": 0.6245351048018698, "mean_env_wait_ms": 0.14962630479361183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01951432228088379, "StateBufferConnector_ms": 0.017423391342163086, "ViewRequirementAgentConnector_ms": 0.4298262596130371}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 91000, "num_env_steps_sampled": 91000, "num_env_steps_trained": 91000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1611.6963853913753, "num_env_steps_trained_throughput_per_sec": 1611.6963853913753, "timesteps_total": 91000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 91000, "timers": {"training_iteration_time_ms": 1335.537, "sample_time_ms": 1299.737, "load_time_ms": 0.261, "load_throughput": 5366010.783, "learn_time_ms": 13.94, "learn_throughput": 100428.695, "synch_weights_time_ms": 21.281}, "counters": {"num_env_steps_sampled": 91000, "num_env_steps_trained": 91000, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 91000}, "done": false, "episodes_total": 4876, "training_iteration": 65, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-17", "timestamp": 1702021217, "time_this_iter_s": 0.885643482208252, "time_total_s": 79.16250848770142, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.16250848770142, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 94.0, "ram_util_percent": 94.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0920929908752441, "total_loss": 1.0920929908752441, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 92400, "num_env_steps_trained": 92400, "num_agent_steps_sampled": 92400, "num_agent_steps_trained": 92400}, "sampler_results": {"episode_reward_max": 14.206333333333333, "episode_reward_min": 5.950333333333332, "episode_reward_mean": 8.77742, "episode_len_mean": 18.71, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.438333333333333, 8.339666666666666, 8.88133333333333, 9.290666666666667, 8.132333333333332, 11.372666666666664, 7.222666666666666, 9.331333333333331, 11.366666666666667, 9.136999999999999, 7.197999999999998, 6.9243333333333315, 9.467333333333332, 10.31033333333333, 7.580666666666667, 6.899, 10.371333333333334, 8.449, 7.4270000000000005, 7.2866666666666635, 10.325666666666665, 12.381, 7.828999999999997, 9.426999999999998, 11.633, 9.316666666666666, 14.206333333333333, 10.491999999999996, 5.950333333333332, 8.86233333333333, 8.823999999999998, 9.358999999999998, 9.974666666666666, 9.292999999999997, 8.519333333333334, 9.790666666666667, 6.158666666666667, 8.841999999999999, 9.064666666666664, 7.648333333333331, 11.541999999999998, 6.504333333333333, 10.561999999999996, 7.036666666666665, 9.659333333333333, 8.994666666666665, 11.821333333333337, 10.63833333333333, 6.771333333333333, 9.942, 9.327333333333332, 7.256333333333332, 9.373666666666665, 6.159999999999999, 8.108, 7.521333333333333, 7.304666666666666, 8.662333333333331, 8.065, 7.273666666666667, 9.710333333333333, 7.127999999999999, 7.298666666666666, 6.774000000000001, 7.945666666666668, 8.672666666666666, 7.4063333333333325, 10.308666666666664, 8.139000000000001, 6.456666666666667, 7.872333333333332, 9.772, 8.169666666666666, 9.605666666666664, 9.334999999999997, 9.460333333333331, 8.126999999999999, 12.398999999999994, 9.999666666666664, 7.0106666666666655, 6.419, 9.059666666666669, 12.931666666666672, 10.674999999999997, 8.649333333333331, 7.647666666666667, 8.312666666666663, 7.625333333333332, 7.063999999999998, 8.331999999999997, 7.089666666666666, 7.0343333333333335, 8.264666666666667, 8.566333333333333, 11.661999999999999, 7.265999999999999, 10.517, 8.373999999999999, 9.176999999999998, 7.635000000000001], "episode_lengths": [17, 16, 20, 21, 18, 23, 15, 18, 24, 18, 15, 17, 19, 22, 15, 15, 21, 18, 16, 17, 23, 21, 17, 22, 21, 19, 26, 22, 14, 18, 20, 24, 21, 18, 18, 21, 14, 18, 18, 20, 23, 15, 22, 16, 20, 20, 24, 21, 14, 21, 18, 17, 22, 14, 17, 16, 16, 18, 18, 16, 19, 16, 16, 14, 16, 17, 16, 23, 17, 15, 18, 20, 22, 19, 20, 21, 20, 23, 21, 16, 14, 19, 25, 21, 22, 18, 18, 16, 18, 17, 15, 15, 20, 18, 25, 19, 22, 18, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6429851564503815, "mean_inference_ms": 2.9963749391070293, "mean_action_processing_ms": 0.6235433896305079, "mean_env_wait_ms": 0.14910302389963842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016542911529541016, "StateBufferConnector_ms": 0.018206357955932617, "ViewRequirementAgentConnector_ms": 0.4299311637878418}}, "episode_reward_max": 14.206333333333333, "episode_reward_min": 5.950333333333332, "episode_reward_mean": 8.77742, "episode_len_mean": 18.71, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.438333333333333, 8.339666666666666, 8.88133333333333, 9.290666666666667, 8.132333333333332, 11.372666666666664, 7.222666666666666, 9.331333333333331, 11.366666666666667, 9.136999999999999, 7.197999999999998, 6.9243333333333315, 9.467333333333332, 10.31033333333333, 7.580666666666667, 6.899, 10.371333333333334, 8.449, 7.4270000000000005, 7.2866666666666635, 10.325666666666665, 12.381, 7.828999999999997, 9.426999999999998, 11.633, 9.316666666666666, 14.206333333333333, 10.491999999999996, 5.950333333333332, 8.86233333333333, 8.823999999999998, 9.358999999999998, 9.974666666666666, 9.292999999999997, 8.519333333333334, 9.790666666666667, 6.158666666666667, 8.841999999999999, 9.064666666666664, 7.648333333333331, 11.541999999999998, 6.504333333333333, 10.561999999999996, 7.036666666666665, 9.659333333333333, 8.994666666666665, 11.821333333333337, 10.63833333333333, 6.771333333333333, 9.942, 9.327333333333332, 7.256333333333332, 9.373666666666665, 6.159999999999999, 8.108, 7.521333333333333, 7.304666666666666, 8.662333333333331, 8.065, 7.273666666666667, 9.710333333333333, 7.127999999999999, 7.298666666666666, 6.774000000000001, 7.945666666666668, 8.672666666666666, 7.4063333333333325, 10.308666666666664, 8.139000000000001, 6.456666666666667, 7.872333333333332, 9.772, 8.169666666666666, 9.605666666666664, 9.334999999999997, 9.460333333333331, 8.126999999999999, 12.398999999999994, 9.999666666666664, 7.0106666666666655, 6.419, 9.059666666666669, 12.931666666666672, 10.674999999999997, 8.649333333333331, 7.647666666666667, 8.312666666666663, 7.625333333333332, 7.063999999999998, 8.331999999999997, 7.089666666666666, 7.0343333333333335, 8.264666666666667, 8.566333333333333, 11.661999999999999, 7.265999999999999, 10.517, 8.373999999999999, 9.176999999999998, 7.635000000000001], "episode_lengths": [17, 16, 20, 21, 18, 23, 15, 18, 24, 18, 15, 17, 19, 22, 15, 15, 21, 18, 16, 17, 23, 21, 17, 22, 21, 19, 26, 22, 14, 18, 20, 24, 21, 18, 18, 21, 14, 18, 18, 20, 23, 15, 22, 16, 20, 20, 24, 21, 14, 21, 18, 17, 22, 14, 17, 16, 16, 18, 18, 16, 19, 16, 16, 14, 16, 17, 16, 23, 17, 15, 18, 20, 22, 19, 20, 21, 20, 23, 21, 16, 14, 19, 25, 21, 22, 18, 18, 16, 18, 17, 15, 15, 20, 18, 25, 19, 22, 18, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6429851564503815, "mean_inference_ms": 2.9963749391070293, "mean_action_processing_ms": 0.6235433896305079, "mean_env_wait_ms": 0.14910302389963842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016542911529541016, "StateBufferConnector_ms": 0.018206357955932617, "ViewRequirementAgentConnector_ms": 0.4299311637878418}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92400, "num_agent_steps_trained": 92400, "num_env_steps_sampled": 92400, "num_env_steps_trained": 92400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1506.4950898018012, "num_env_steps_trained_throughput_per_sec": 1506.4950898018012, "timesteps_total": 92400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 92400, "timers": {"training_iteration_time_ms": 1231.86, "sample_time_ms": 1197.151, "load_time_ms": 0.201, "load_throughput": 6954904.181, "learn_time_ms": 13.312, "learn_throughput": 105166.338, "synch_weights_time_ms": 20.997}, "counters": {"num_env_steps_sampled": 92400, "num_env_steps_trained": 92400, "num_agent_steps_sampled": 92400, "num_agent_steps_trained": 92400}, "done": false, "episodes_total": 4951, "training_iteration": 66, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-18", "timestamp": 1702021218, "time_this_iter_s": 0.949303388595581, "time_total_s": 80.111811876297, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 80.111811876297, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 94.44999999999999, "ram_util_percent": 94.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0970655679702759, "total_loss": 1.0970655679702759, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 93800, "num_env_steps_trained": 93800, "num_agent_steps_sampled": 93800, "num_agent_steps_trained": 93800}, "sampler_results": {"episode_reward_max": 12.931666666666672, "episode_reward_min": 6.356333333333334, "episode_reward_mean": 8.859586666666667, "episode_len_mean": 18.95, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.460333333333331, 8.126999999999999, 12.398999999999994, 9.999666666666664, 7.0106666666666655, 6.419, 9.059666666666669, 12.931666666666672, 10.674999999999997, 8.649333333333331, 7.647666666666667, 8.312666666666663, 7.625333333333332, 7.063999999999998, 8.331999999999997, 7.089666666666666, 7.0343333333333335, 8.264666666666667, 8.566333333333333, 11.661999999999999, 7.265999999999999, 10.517, 8.373999999999999, 9.176999999999998, 7.635000000000001, 11.827333333333334, 10.789333333333332, 12.215666666666667, 8.232999999999999, 7.117999999999999, 9.66433333333333, 11.075999999999999, 9.773333333333332, 6.878333333333333, 8.24, 8.798000000000002, 7.881666666666666, 10.202000000000004, 8.196999999999997, 9.203, 8.299333333333331, 7.688999999999999, 7.6133333333333315, 9.86066666666667, 10.540333333333333, 6.409000000000001, 7.718, 10.32533333333333, 6.813, 8.126333333333331, 8.466333333333331, 8.734666666666666, 7.825333333333331, 8.298333333333332, 9.066333333333334, 10.496999999999996, 7.4463333333333335, 9.805333333333335, 7.623666666666667, 8.369333333333332, 9.686333333333334, 12.191666666666665, 8.904333333333332, 10.052666666666667, 8.446666666666665, 6.970333333333332, 11.477999999999996, 7.776333333333331, 8.527333333333333, 8.547333333333333, 9.464999999999998, 10.127333333333333, 7.586666666666666, 7.0266666666666655, 8.275, 12.828333333333331, 10.287333333333331, 9.628666666666668, 8.766666666666666, 10.165999999999999, 10.249333333333334, 9.970333333333333, 7.518999999999998, 8.009333333333332, 7.212333333333333, 8.908666666666665, 8.648333333333335, 8.102333333333334, 10.986666666666666, 10.509333333333334, 6.356333333333334, 9.016999999999998, 6.8, 7.250666666666666, 7.188333333333333, 9.859333333333332, 7.312999999999999, 9.073666666666666, 10.393999999999998, 6.929], "episode_lengths": [21, 20, 23, 21, 16, 14, 19, 25, 21, 22, 18, 18, 16, 18, 17, 15, 15, 20, 18, 25, 19, 22, 18, 19, 15, 25, 21, 24, 18, 16, 19, 23, 23, 16, 17, 21, 18, 25, 18, 21, 20, 17, 17, 22, 21, 15, 16, 20, 15, 17, 17, 19, 17, 18, 19, 23, 17, 18, 15, 18, 19, 23, 19, 20, 18, 16, 23, 19, 18, 18, 19, 20, 16, 15, 17, 25, 22, 20, 18, 22, 23, 20, 17, 17, 17, 20, 19, 18, 22, 24, 14, 19, 14, 16, 15, 20, 18, 19, 20, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6386939875762292, "mean_inference_ms": 2.9854469374257877, "mean_action_processing_ms": 0.6213736620591959, "mean_env_wait_ms": 0.14851580142703635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015443801879882812, "StateBufferConnector_ms": 0.027729511260986328, "ViewRequirementAgentConnector_ms": 0.4156050682067871}}, "episode_reward_max": 12.931666666666672, "episode_reward_min": 6.356333333333334, "episode_reward_mean": 8.859586666666667, "episode_len_mean": 18.95, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.460333333333331, 8.126999999999999, 12.398999999999994, 9.999666666666664, 7.0106666666666655, 6.419, 9.059666666666669, 12.931666666666672, 10.674999999999997, 8.649333333333331, 7.647666666666667, 8.312666666666663, 7.625333333333332, 7.063999999999998, 8.331999999999997, 7.089666666666666, 7.0343333333333335, 8.264666666666667, 8.566333333333333, 11.661999999999999, 7.265999999999999, 10.517, 8.373999999999999, 9.176999999999998, 7.635000000000001, 11.827333333333334, 10.789333333333332, 12.215666666666667, 8.232999999999999, 7.117999999999999, 9.66433333333333, 11.075999999999999, 9.773333333333332, 6.878333333333333, 8.24, 8.798000000000002, 7.881666666666666, 10.202000000000004, 8.196999999999997, 9.203, 8.299333333333331, 7.688999999999999, 7.6133333333333315, 9.86066666666667, 10.540333333333333, 6.409000000000001, 7.718, 10.32533333333333, 6.813, 8.126333333333331, 8.466333333333331, 8.734666666666666, 7.825333333333331, 8.298333333333332, 9.066333333333334, 10.496999999999996, 7.4463333333333335, 9.805333333333335, 7.623666666666667, 8.369333333333332, 9.686333333333334, 12.191666666666665, 8.904333333333332, 10.052666666666667, 8.446666666666665, 6.970333333333332, 11.477999999999996, 7.776333333333331, 8.527333333333333, 8.547333333333333, 9.464999999999998, 10.127333333333333, 7.586666666666666, 7.0266666666666655, 8.275, 12.828333333333331, 10.287333333333331, 9.628666666666668, 8.766666666666666, 10.165999999999999, 10.249333333333334, 9.970333333333333, 7.518999999999998, 8.009333333333332, 7.212333333333333, 8.908666666666665, 8.648333333333335, 8.102333333333334, 10.986666666666666, 10.509333333333334, 6.356333333333334, 9.016999999999998, 6.8, 7.250666666666666, 7.188333333333333, 9.859333333333332, 7.312999999999999, 9.073666666666666, 10.393999999999998, 6.929], "episode_lengths": [21, 20, 23, 21, 16, 14, 19, 25, 21, 22, 18, 18, 16, 18, 17, 15, 15, 20, 18, 25, 19, 22, 18, 19, 15, 25, 21, 24, 18, 16, 19, 23, 23, 16, 17, 21, 18, 25, 18, 21, 20, 17, 17, 22, 21, 15, 16, 20, 15, 17, 17, 19, 17, 18, 19, 23, 17, 18, 15, 18, 19, 23, 19, 20, 18, 16, 23, 19, 18, 18, 19, 20, 16, 15, 17, 25, 22, 20, 18, 22, 23, 20, 17, 17, 17, 20, 19, 18, 22, 24, 14, 19, 14, 16, 15, 20, 18, 19, 20, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6386939875762292, "mean_inference_ms": 2.9854469374257877, "mean_action_processing_ms": 0.6213736620591959, "mean_env_wait_ms": 0.14851580142703635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015443801879882812, "StateBufferConnector_ms": 0.027729511260986328, "ViewRequirementAgentConnector_ms": 0.4156050682067871}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93800, "num_agent_steps_trained": 93800, "num_env_steps_sampled": 93800, "num_env_steps_trained": 93800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1553.0190511126702, "num_env_steps_trained_throughput_per_sec": 1553.0190511126702, "timesteps_total": 93800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 93800, "timers": {"training_iteration_time_ms": 1137.635, "sample_time_ms": 1103.426, "load_time_ms": 0.101, "load_throughput": 13823035.782, "learn_time_ms": 13.111, "learn_throughput": 106780.993, "synch_weights_time_ms": 20.798}, "counters": {"num_env_steps_sampled": 93800, "num_env_steps_trained": 93800, "num_agent_steps_sampled": 93800, "num_agent_steps_trained": 93800}, "done": false, "episodes_total": 5026, "training_iteration": 67, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-19", "timestamp": 1702021219, "time_this_iter_s": 0.9174644947052002, "time_total_s": 81.0292763710022, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.0292763710022, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 89.3, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0954545736312866, "total_loss": 1.0954545736312866, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 95200, "num_env_steps_trained": 95200, "num_agent_steps_sampled": 95200, "num_agent_steps_trained": 95200}, "sampler_results": {"episode_reward_max": 15.419333333333332, "episode_reward_min": 6.072999999999999, "episode_reward_mean": 8.73095, "episode_len_mean": 18.68, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.828333333333331, 10.287333333333331, 9.628666666666668, 8.766666666666666, 10.165999999999999, 10.249333333333334, 9.970333333333333, 7.518999999999998, 8.009333333333332, 7.212333333333333, 8.908666666666665, 8.648333333333335, 8.102333333333334, 10.986666666666666, 10.509333333333334, 6.356333333333334, 9.016999999999998, 6.8, 7.250666666666666, 7.188333333333333, 9.859333333333332, 7.312999999999999, 9.073666666666666, 10.393999999999998, 6.929, 10.462333333333332, 9.365666666666664, 7.542333333333333, 9.239333333333331, 9.644999999999998, 7.345000000000001, 7.389666666666665, 7.164666666666666, 8.109666666666667, 8.477666666666666, 8.318333333333333, 9.754666666666663, 12.293333333333333, 8.584999999999999, 6.096, 9.564666666666664, 8.135666666666667, 8.57533333333333, 9.208666666666664, 7.7620000000000005, 8.64033333333333, 9.271666666666663, 7.849666666666668, 10.71333333333333, 7.364333333333332, 10.752999999999998, 7.357333333333334, 6.876, 7.228999999999999, 8.155999999999999, 8.596, 8.364666666666663, 11.014666666666661, 9.39033333333333, 7.582000000000001, 6.072999999999999, 8.450333333333335, 8.760000000000002, 8.885999999999997, 9.250999999999998, 7.217333333333332, 11.475666666666665, 8.316666666666666, 7.466666666666667, 8.933666666666666, 8.950333333333333, 15.419333333333332, 9.536999999999999, 6.669666666666665, 7.387333333333332, 8.985999999999999, 8.109, 7.254666666666667, 6.296666666666667, 8.326999999999998, 10.498999999999999, 10.095666666666665, 6.922333333333333, 7.264333333333331, 9.815333333333328, 8.125333333333334, 6.113666666666666, 9.419666666666666, 6.908666666666666, 8.989333333333333, 7.864666666666665, 7.604000000000001, 10.463999999999999, 9.223666666666665, 10.077666666666666, 12.771333333333335, 10.857999999999992, 6.197666666666666, 7.856666666666666, 10.08933333333333], "episode_lengths": [25, 22, 20, 18, 22, 23, 20, 17, 17, 17, 20, 19, 18, 22, 24, 14, 19, 14, 16, 15, 20, 18, 19, 20, 15, 20, 20, 18, 19, 23, 17, 16, 16, 19, 18, 18, 20, 24, 18, 14, 19, 17, 16, 19, 17, 18, 19, 17, 21, 16, 23, 16, 18, 15, 16, 19, 18, 22, 19, 15, 15, 20, 19, 17, 19, 15, 23, 20, 16, 20, 21, 29, 21, 16, 16, 20, 20, 16, 14, 17, 21, 21, 16, 15, 22, 17, 13, 19, 15, 18, 17, 17, 22, 21, 22, 28, 24, 16, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6323142728980826, "mean_inference_ms": 2.9746955234334984, "mean_action_processing_ms": 0.6195928255818938, "mean_env_wait_ms": 0.1483551741597898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013000965118408203, "StateBufferConnector_ms": 0.01281285285949707, "ViewRequirementAgentConnector_ms": 0.3926670551300049}}, "episode_reward_max": 15.419333333333332, "episode_reward_min": 6.072999999999999, "episode_reward_mean": 8.73095, "episode_len_mean": 18.68, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.828333333333331, 10.287333333333331, 9.628666666666668, 8.766666666666666, 10.165999999999999, 10.249333333333334, 9.970333333333333, 7.518999999999998, 8.009333333333332, 7.212333333333333, 8.908666666666665, 8.648333333333335, 8.102333333333334, 10.986666666666666, 10.509333333333334, 6.356333333333334, 9.016999999999998, 6.8, 7.250666666666666, 7.188333333333333, 9.859333333333332, 7.312999999999999, 9.073666666666666, 10.393999999999998, 6.929, 10.462333333333332, 9.365666666666664, 7.542333333333333, 9.239333333333331, 9.644999999999998, 7.345000000000001, 7.389666666666665, 7.164666666666666, 8.109666666666667, 8.477666666666666, 8.318333333333333, 9.754666666666663, 12.293333333333333, 8.584999999999999, 6.096, 9.564666666666664, 8.135666666666667, 8.57533333333333, 9.208666666666664, 7.7620000000000005, 8.64033333333333, 9.271666666666663, 7.849666666666668, 10.71333333333333, 7.364333333333332, 10.752999999999998, 7.357333333333334, 6.876, 7.228999999999999, 8.155999999999999, 8.596, 8.364666666666663, 11.014666666666661, 9.39033333333333, 7.582000000000001, 6.072999999999999, 8.450333333333335, 8.760000000000002, 8.885999999999997, 9.250999999999998, 7.217333333333332, 11.475666666666665, 8.316666666666666, 7.466666666666667, 8.933666666666666, 8.950333333333333, 15.419333333333332, 9.536999999999999, 6.669666666666665, 7.387333333333332, 8.985999999999999, 8.109, 7.254666666666667, 6.296666666666667, 8.326999999999998, 10.498999999999999, 10.095666666666665, 6.922333333333333, 7.264333333333331, 9.815333333333328, 8.125333333333334, 6.113666666666666, 9.419666666666666, 6.908666666666666, 8.989333333333333, 7.864666666666665, 7.604000000000001, 10.463999999999999, 9.223666666666665, 10.077666666666666, 12.771333333333335, 10.857999999999992, 6.197666666666666, 7.856666666666666, 10.08933333333333], "episode_lengths": [25, 22, 20, 18, 22, 23, 20, 17, 17, 17, 20, 19, 18, 22, 24, 14, 19, 14, 16, 15, 20, 18, 19, 20, 15, 20, 20, 18, 19, 23, 17, 16, 16, 19, 18, 18, 20, 24, 18, 14, 19, 17, 16, 19, 17, 18, 19, 17, 21, 16, 23, 16, 18, 15, 16, 19, 18, 22, 19, 15, 15, 20, 19, 17, 19, 15, 23, 20, 16, 20, 21, 29, 21, 16, 16, 20, 20, 16, 14, 17, 21, 21, 16, 15, 22, 17, 13, 19, 15, 18, 17, 17, 22, 21, 22, 28, 24, 16, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6323142728980826, "mean_inference_ms": 2.9746955234334984, "mean_action_processing_ms": 0.6195928255818938, "mean_env_wait_ms": 0.1483551741597898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013000965118408203, "StateBufferConnector_ms": 0.01281285285949707, "ViewRequirementAgentConnector_ms": 0.3926670551300049}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95200, "num_agent_steps_trained": 95200, "num_env_steps_sampled": 95200, "num_env_steps_trained": 95200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1572.2661177325515, "num_env_steps_trained_throughput_per_sec": 1572.2661177325515, "timesteps_total": 95200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 95200, "timers": {"training_iteration_time_ms": 1090.694, "sample_time_ms": 1057.29, "load_time_ms": 0.101, "load_throughput": 13823035.782, "learn_time_ms": 12.706, "learn_throughput": 110180.085, "synch_weights_time_ms": 20.298}, "counters": {"num_env_steps_sampled": 95200, "num_env_steps_trained": 95200, "num_agent_steps_sampled": 95200, "num_agent_steps_trained": 95200}, "done": false, "episodes_total": 5101, "training_iteration": 68, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-20", "timestamp": 1702021220, "time_this_iter_s": 0.9094259738922119, "time_total_s": 81.93870234489441, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.93870234489441, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 96.0, "ram_util_percent": 95.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0884888172149658, "total_loss": 1.0884888172149658, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 96600, "num_env_steps_trained": 96600, "num_agent_steps_sampled": 96600, "num_agent_steps_trained": 96600}, "sampler_results": {"episode_reward_max": 14.059999999999999, "episode_reward_min": 5.804666666666666, "episode_reward_mean": 8.500599999999999, "episode_len_mean": 18.06, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.254666666666667, 6.296666666666667, 8.326999999999998, 10.498999999999999, 10.095666666666665, 6.922333333333333, 7.264333333333331, 9.815333333333328, 8.125333333333334, 6.113666666666666, 9.419666666666666, 6.908666666666666, 8.989333333333333, 7.864666666666665, 7.604000000000001, 10.463999999999999, 9.223666666666665, 10.077666666666666, 12.771333333333335, 10.857999999999992, 6.197666666666666, 7.856666666666666, 10.08933333333333, 6.8116666666666665, 10.438333333333333, 8.742999999999999, 7.781333333333334, 7.600999999999998, 8.952666666666667, 6.3276666666666666, 6.932333333333332, 9.684666666666665, 6.127999999999998, 6.762999999999999, 6.957666666666666, 7.943999999999997, 6.416666666666666, 10.217333333333332, 8.511666666666665, 8.878999999999998, 8.655666666666665, 8.921666666666663, 6.693666666666665, 6.251999999999999, 10.226333333333331, 9.622333333333334, 9.996666666666666, 8.777, 8.281666666666666, 9.489333333333331, 8.424333333333331, 7.236999999999999, 9.07933333333333, 10.261666666666667, 8.172333333333333, 9.765666666666666, 6.885666666666666, 7.704333333333334, 7.8456666666666655, 7.2666666666666675, 5.804666666666666, 10.631999999999998, 9.196000000000002, 8.73133333333333, 8.397666666666664, 8.626666666666665, 8.303666666666667, 7.969999999999999, 9.930666666666665, 8.146666666666665, 11.363999999999997, 8.853999999999997, 7.680666666666666, 8.564999999999998, 10.749, 6.228333333333333, 7.0699999999999985, 14.059999999999999, 8.573333333333332, 7.045999999999997, 10.062333333333331, 6.084666666666667, 8.125, 8.170000000000002, 10.605333333333334, 8.568, 10.873666666666667, 8.585333333333333, 7.387333333333333, 10.321666666666667, 7.2846666666666655, 8.509333333333334, 6.6066666666666665, 11.540999999999995, 7.775666666666664, 8.067666666666666, 6.256333333333335, 6.704000000000001, 10.410999999999998, 8.502999999999998], "episode_lengths": [16, 14, 17, 21, 21, 16, 15, 22, 17, 13, 19, 15, 18, 17, 17, 22, 21, 22, 28, 24, 16, 17, 19, 14, 21, 17, 17, 17, 21, 13, 15, 20, 15, 16, 15, 18, 14, 21, 17, 21, 18, 18, 14, 13, 21, 21, 22, 18, 17, 21, 18, 16, 20, 21, 17, 19, 14, 18, 17, 15, 13, 21, 20, 17, 20, 18, 17, 17, 22, 17, 24, 18, 16, 20, 20, 14, 15, 28, 17, 16, 21, 15, 20, 16, 21, 17, 21, 19, 17, 21, 15, 17, 14, 21, 19, 17, 14, 14, 23, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.626770643222505, "mean_inference_ms": 2.9651870206934126, "mean_action_processing_ms": 0.6179721391659116, "mean_env_wait_ms": 0.1477756018965029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181282043457031, "StateBufferConnector_ms": 0.01495504379272461, "ViewRequirementAgentConnector_ms": 0.4286458492279053}}, "episode_reward_max": 14.059999999999999, "episode_reward_min": 5.804666666666666, "episode_reward_mean": 8.500599999999999, "episode_len_mean": 18.06, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.254666666666667, 6.296666666666667, 8.326999999999998, 10.498999999999999, 10.095666666666665, 6.922333333333333, 7.264333333333331, 9.815333333333328, 8.125333333333334, 6.113666666666666, 9.419666666666666, 6.908666666666666, 8.989333333333333, 7.864666666666665, 7.604000000000001, 10.463999999999999, 9.223666666666665, 10.077666666666666, 12.771333333333335, 10.857999999999992, 6.197666666666666, 7.856666666666666, 10.08933333333333, 6.8116666666666665, 10.438333333333333, 8.742999999999999, 7.781333333333334, 7.600999999999998, 8.952666666666667, 6.3276666666666666, 6.932333333333332, 9.684666666666665, 6.127999999999998, 6.762999999999999, 6.957666666666666, 7.943999999999997, 6.416666666666666, 10.217333333333332, 8.511666666666665, 8.878999999999998, 8.655666666666665, 8.921666666666663, 6.693666666666665, 6.251999999999999, 10.226333333333331, 9.622333333333334, 9.996666666666666, 8.777, 8.281666666666666, 9.489333333333331, 8.424333333333331, 7.236999999999999, 9.07933333333333, 10.261666666666667, 8.172333333333333, 9.765666666666666, 6.885666666666666, 7.704333333333334, 7.8456666666666655, 7.2666666666666675, 5.804666666666666, 10.631999999999998, 9.196000000000002, 8.73133333333333, 8.397666666666664, 8.626666666666665, 8.303666666666667, 7.969999999999999, 9.930666666666665, 8.146666666666665, 11.363999999999997, 8.853999999999997, 7.680666666666666, 8.564999999999998, 10.749, 6.228333333333333, 7.0699999999999985, 14.059999999999999, 8.573333333333332, 7.045999999999997, 10.062333333333331, 6.084666666666667, 8.125, 8.170000000000002, 10.605333333333334, 8.568, 10.873666666666667, 8.585333333333333, 7.387333333333333, 10.321666666666667, 7.2846666666666655, 8.509333333333334, 6.6066666666666665, 11.540999999999995, 7.775666666666664, 8.067666666666666, 6.256333333333335, 6.704000000000001, 10.410999999999998, 8.502999999999998], "episode_lengths": [16, 14, 17, 21, 21, 16, 15, 22, 17, 13, 19, 15, 18, 17, 17, 22, 21, 22, 28, 24, 16, 17, 19, 14, 21, 17, 17, 17, 21, 13, 15, 20, 15, 16, 15, 18, 14, 21, 17, 21, 18, 18, 14, 13, 21, 21, 22, 18, 17, 21, 18, 16, 20, 21, 17, 19, 14, 18, 17, 15, 13, 21, 20, 17, 20, 18, 17, 17, 22, 17, 24, 18, 16, 20, 20, 14, 15, 28, 17, 16, 21, 15, 20, 16, 21, 17, 21, 19, 17, 21, 15, 17, 14, 21, 19, 17, 14, 14, 23, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.626770643222505, "mean_inference_ms": 2.9651870206934126, "mean_action_processing_ms": 0.6179721391659116, "mean_env_wait_ms": 0.1477756018965029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181282043457031, "StateBufferConnector_ms": 0.01495504379272461, "ViewRequirementAgentConnector_ms": 0.4286458492279053}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96600, "num_agent_steps_trained": 96600, "num_env_steps_sampled": 96600, "num_env_steps_trained": 96600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1523.2019058617595, "num_env_steps_trained_throughput_per_sec": 1523.2019058617595, "timesteps_total": 96600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 96600, "timers": {"training_iteration_time_ms": 1068.507, "sample_time_ms": 1035.86, "load_time_ms": 0.201, "load_throughput": 6951610.749, "learn_time_ms": 12.706, "learn_throughput": 110181.532, "synch_weights_time_ms": 19.459}, "counters": {"num_env_steps_sampled": 96600, "num_env_steps_trained": 96600, "num_agent_steps_sampled": 96600, "num_agent_steps_trained": 96600}, "done": false, "episodes_total": 5178, "training_iteration": 69, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-21", "timestamp": 1702021221, "time_this_iter_s": 0.9344987869262695, "time_total_s": 82.87320113182068, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 82.87320113182068, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 96.55, "ram_util_percent": 95.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.096961498260498, "total_loss": 1.096961498260498, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "sampler_results": {"episode_reward_max": 14.662666666666663, "episode_reward_min": 6.060666666666668, "episode_reward_mean": 8.940233333333332, "episode_len_mean": 19.13, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.680666666666666, 8.564999999999998, 10.749, 6.228333333333333, 7.0699999999999985, 14.059999999999999, 8.573333333333332, 7.045999999999997, 10.062333333333331, 6.084666666666667, 8.125, 8.170000000000002, 10.605333333333334, 8.568, 10.873666666666667, 8.585333333333333, 7.387333333333333, 10.321666666666667, 7.2846666666666655, 8.509333333333334, 6.6066666666666665, 11.540999999999995, 7.775666666666664, 8.067666666666666, 6.256333333333335, 6.704000000000001, 10.410999999999998, 8.502999999999998, 10.905333333333331, 14.662666666666663, 11.390333333333334, 9.480666666666664, 9.035333333333332, 10.475333333333333, 7.168666666666665, 7.829666666666667, 9.389333333333333, 7.051, 6.9676666666666645, 8.395, 8.92, 7.1213333333333315, 8.974333333333332, 7.823999999999998, 9.891999999999996, 8.500666666666666, 10.009333333333334, 8.797666666666666, 7.365666666666665, 12.141999999999998, 9.992666666666661, 7.5233333333333325, 8.276333333333332, 12.672333333333333, 6.392333333333333, 10.16533333333333, 9.817999999999998, 9.384666666666664, 6.449333333333334, 7.031, 7.905000000000001, 7.443666666666665, 8.081333333333333, 9.402333333333333, 7.979666666666666, 11.753666666666664, 6.596333333333332, 10.06166666666667, 6.775666666666665, 7.079333333333333, 6.060666666666668, 10.531666666666665, 9.000999999999998, 6.278333333333332, 6.627999999999999, 11.872666666666667, 9.460666666666665, 8.812333333333333, 8.479666666666668, 9.338, 9.904333333333332, 7.173333333333332, 10.789333333333332, 10.989999999999997, 13.613999999999994, 14.530666666666669, 9.019333333333332, 10.157999999999998, 9.178999999999997, 10.010666666666665, 8.590666666666666, 7.1626666666666665, 11.225000000000001, 11.020333333333333, 6.124666666666666, 9.201666666666664, 7.153333333333331, 10.965333333333335, 8.298666666666664, 8.95233333333333], "episode_lengths": [16, 20, 20, 14, 15, 28, 17, 16, 21, 15, 20, 16, 21, 17, 21, 19, 17, 21, 15, 17, 14, 21, 19, 17, 14, 14, 23, 17, 22, 28, 23, 20, 20, 24, 17, 16, 18, 17, 17, 18, 18, 15, 18, 16, 20, 20, 23, 18, 16, 25, 21, 17, 17, 27, 14, 21, 22, 20, 14, 15, 17, 17, 16, 21, 17, 26, 15, 22, 16, 17, 14, 21, 18, 14, 16, 26, 18, 19, 20, 20, 21, 15, 22, 22, 30, 28, 20, 21, 20, 21, 21, 16, 21, 23, 14, 21, 19, 24, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6215926600066366, "mean_inference_ms": 2.955184978953057, "mean_action_processing_ms": 0.6162336873985632, "mean_env_wait_ms": 0.1476115399758823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022646188735961914, "StateBufferConnector_ms": 0.014409303665161133, "ViewRequirementAgentConnector_ms": 0.4136168956756592}}, "episode_reward_max": 14.662666666666663, "episode_reward_min": 6.060666666666668, "episode_reward_mean": 8.940233333333332, "episode_len_mean": 19.13, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.680666666666666, 8.564999999999998, 10.749, 6.228333333333333, 7.0699999999999985, 14.059999999999999, 8.573333333333332, 7.045999999999997, 10.062333333333331, 6.084666666666667, 8.125, 8.170000000000002, 10.605333333333334, 8.568, 10.873666666666667, 8.585333333333333, 7.387333333333333, 10.321666666666667, 7.2846666666666655, 8.509333333333334, 6.6066666666666665, 11.540999999999995, 7.775666666666664, 8.067666666666666, 6.256333333333335, 6.704000000000001, 10.410999999999998, 8.502999999999998, 10.905333333333331, 14.662666666666663, 11.390333333333334, 9.480666666666664, 9.035333333333332, 10.475333333333333, 7.168666666666665, 7.829666666666667, 9.389333333333333, 7.051, 6.9676666666666645, 8.395, 8.92, 7.1213333333333315, 8.974333333333332, 7.823999999999998, 9.891999999999996, 8.500666666666666, 10.009333333333334, 8.797666666666666, 7.365666666666665, 12.141999999999998, 9.992666666666661, 7.5233333333333325, 8.276333333333332, 12.672333333333333, 6.392333333333333, 10.16533333333333, 9.817999999999998, 9.384666666666664, 6.449333333333334, 7.031, 7.905000000000001, 7.443666666666665, 8.081333333333333, 9.402333333333333, 7.979666666666666, 11.753666666666664, 6.596333333333332, 10.06166666666667, 6.775666666666665, 7.079333333333333, 6.060666666666668, 10.531666666666665, 9.000999999999998, 6.278333333333332, 6.627999999999999, 11.872666666666667, 9.460666666666665, 8.812333333333333, 8.479666666666668, 9.338, 9.904333333333332, 7.173333333333332, 10.789333333333332, 10.989999999999997, 13.613999999999994, 14.530666666666669, 9.019333333333332, 10.157999999999998, 9.178999999999997, 10.010666666666665, 8.590666666666666, 7.1626666666666665, 11.225000000000001, 11.020333333333333, 6.124666666666666, 9.201666666666664, 7.153333333333331, 10.965333333333335, 8.298666666666664, 8.95233333333333], "episode_lengths": [16, 20, 20, 14, 15, 28, 17, 16, 21, 15, 20, 16, 21, 17, 21, 19, 17, 21, 15, 17, 14, 21, 19, 17, 14, 14, 23, 17, 22, 28, 23, 20, 20, 24, 17, 16, 18, 17, 17, 18, 18, 15, 18, 16, 20, 20, 23, 18, 16, 25, 21, 17, 17, 27, 14, 21, 22, 20, 14, 15, 17, 17, 16, 21, 17, 26, 15, 22, 16, 17, 14, 21, 18, 14, 16, 26, 18, 19, 20, 20, 21, 15, 22, 22, 30, 28, 20, 21, 20, 21, 21, 16, 21, 23, 14, 21, 19, 24, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6215926600066366, "mean_inference_ms": 2.955184978953057, "mean_action_processing_ms": 0.6162336873985632, "mean_env_wait_ms": 0.1476115399758823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022646188735961914, "StateBufferConnector_ms": 0.014409303665161133, "ViewRequirementAgentConnector_ms": 0.4136168956756592}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1569.7140604011147, "num_env_steps_trained_throughput_per_sec": 1569.7140604011147, "timesteps_total": 98000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 985.612, "sample_time_ms": 953.303, "load_time_ms": 0.1, "load_throughput": 13984342.939, "learn_time_ms": 12.5, "learn_throughput": 111999.786, "synch_weights_time_ms": 19.428}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "done": false, "episodes_total": 5250, "training_iteration": 70, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-22", "timestamp": 1702021222, "time_this_iter_s": 0.9133715629577637, "time_total_s": 83.78657269477844, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.78657269477844, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 91.4, "ram_util_percent": 94.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0947893857955933, "total_loss": 1.0947893857955933, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 99400, "num_env_steps_trained": 99400, "num_agent_steps_sampled": 99400, "num_agent_steps_trained": 99400}, "sampler_results": {"episode_reward_max": 14.530666666666669, "episode_reward_min": 5.469333333333332, "episode_reward_mean": 9.158799999999998, "episode_len_mean": 19.66, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.531666666666665, 9.000999999999998, 6.278333333333332, 6.627999999999999, 11.872666666666667, 9.460666666666665, 8.812333333333333, 8.479666666666668, 9.338, 9.904333333333332, 7.173333333333332, 10.789333333333332, 10.989999999999997, 13.613999999999994, 14.530666666666669, 9.019333333333332, 10.157999999999998, 9.178999999999997, 10.010666666666665, 8.590666666666666, 7.1626666666666665, 11.225000000000001, 11.020333333333333, 6.124666666666666, 9.201666666666664, 7.153333333333331, 10.965333333333335, 8.298666666666664, 8.95233333333333, 9.744999999999997, 7.423333333333332, 8.234666666666666, 9.985999999999999, 8.422666666666666, 14.247333333333328, 8.283999999999999, 8.341999999999997, 10.150333333333332, 6.0426666666666655, 11.979333333333331, 8.719666666666665, 8.668666666666665, 7.128666666666666, 8.543666666666665, 12.356666666666666, 9.461333333333334, 7.6853333333333325, 8.20133333333333, 7.481333333333332, 7.355, 9.119666666666667, 6.9719999999999995, 11.246666666666664, 12.19633333333333, 8.505333333333333, 9.11133333333333, 10.799333333333333, 8.214666666666666, 7.736, 9.150666666666663, 11.960666666666665, 9.041666666666666, 10.585999999999999, 8.306666666666665, 9.227, 7.774999999999999, 8.399, 9.347, 8.950999999999999, 10.418333333333333, 7.895999999999999, 8.821666666666664, 9.069333333333333, 7.411666666666665, 8.129666666666665, 13.449666666666666, 9.702, 8.290666666666667, 8.137666666666666, 8.336666666666664, 7.809333333333333, 7.8119999999999985, 11.292666666666664, 5.469333333333332, 8.304333333333332, 11.376333333333333, 8.298333333333332, 7.606999999999999, 8.186333333333332, 9.084, 11.860666666666669, 10.013999999999998, 7.707333333333333, 5.8103333333333325, 9.680333333333333, 9.856, 10.587999999999997, 8.128666666666664, 7.150666666666666, 10.610333333333331], "episode_lengths": [21, 18, 14, 16, 26, 18, 19, 20, 20, 21, 15, 22, 22, 30, 28, 20, 21, 20, 21, 21, 16, 21, 23, 14, 21, 19, 24, 21, 21, 21, 18, 17, 22, 18, 29, 21, 21, 21, 13, 24, 21, 18, 17, 17, 27, 21, 16, 19, 15, 15, 20, 14, 21, 22, 18, 20, 22, 19, 19, 21, 26, 21, 22, 17, 18, 19, 17, 21, 18, 21, 16, 18, 19, 16, 18, 26, 19, 17, 17, 18, 16, 17, 23, 13, 16, 25, 18, 17, 18, 19, 28, 18, 18, 13, 20, 21, 26, 16, 16, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6179781453117108, "mean_inference_ms": 2.9427661974768635, "mean_action_processing_ms": 0.6135984503554295, "mean_env_wait_ms": 0.14739906979192097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01781010627746582, "StateBufferConnector_ms": 0.01253819465637207, "ViewRequirementAgentConnector_ms": 0.4251227378845215}}, "episode_reward_max": 14.530666666666669, "episode_reward_min": 5.469333333333332, "episode_reward_mean": 9.158799999999998, "episode_len_mean": 19.66, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.531666666666665, 9.000999999999998, 6.278333333333332, 6.627999999999999, 11.872666666666667, 9.460666666666665, 8.812333333333333, 8.479666666666668, 9.338, 9.904333333333332, 7.173333333333332, 10.789333333333332, 10.989999999999997, 13.613999999999994, 14.530666666666669, 9.019333333333332, 10.157999999999998, 9.178999999999997, 10.010666666666665, 8.590666666666666, 7.1626666666666665, 11.225000000000001, 11.020333333333333, 6.124666666666666, 9.201666666666664, 7.153333333333331, 10.965333333333335, 8.298666666666664, 8.95233333333333, 9.744999999999997, 7.423333333333332, 8.234666666666666, 9.985999999999999, 8.422666666666666, 14.247333333333328, 8.283999999999999, 8.341999999999997, 10.150333333333332, 6.0426666666666655, 11.979333333333331, 8.719666666666665, 8.668666666666665, 7.128666666666666, 8.543666666666665, 12.356666666666666, 9.461333333333334, 7.6853333333333325, 8.20133333333333, 7.481333333333332, 7.355, 9.119666666666667, 6.9719999999999995, 11.246666666666664, 12.19633333333333, 8.505333333333333, 9.11133333333333, 10.799333333333333, 8.214666666666666, 7.736, 9.150666666666663, 11.960666666666665, 9.041666666666666, 10.585999999999999, 8.306666666666665, 9.227, 7.774999999999999, 8.399, 9.347, 8.950999999999999, 10.418333333333333, 7.895999999999999, 8.821666666666664, 9.069333333333333, 7.411666666666665, 8.129666666666665, 13.449666666666666, 9.702, 8.290666666666667, 8.137666666666666, 8.336666666666664, 7.809333333333333, 7.8119999999999985, 11.292666666666664, 5.469333333333332, 8.304333333333332, 11.376333333333333, 8.298333333333332, 7.606999999999999, 8.186333333333332, 9.084, 11.860666666666669, 10.013999999999998, 7.707333333333333, 5.8103333333333325, 9.680333333333333, 9.856, 10.587999999999997, 8.128666666666664, 7.150666666666666, 10.610333333333331], "episode_lengths": [21, 18, 14, 16, 26, 18, 19, 20, 20, 21, 15, 22, 22, 30, 28, 20, 21, 20, 21, 21, 16, 21, 23, 14, 21, 19, 24, 21, 21, 21, 18, 17, 22, 18, 29, 21, 21, 21, 13, 24, 21, 18, 17, 17, 27, 21, 16, 19, 15, 15, 20, 14, 21, 22, 18, 20, 22, 19, 19, 21, 26, 21, 22, 17, 18, 19, 17, 21, 18, 21, 16, 18, 19, 16, 18, 26, 19, 17, 17, 18, 16, 17, 23, 13, 16, 25, 18, 17, 18, 19, 28, 18, 18, 13, 20, 21, 26, 16, 16, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6179781453117108, "mean_inference_ms": 2.9427661974768635, "mean_action_processing_ms": 0.6135984503554295, "mean_env_wait_ms": 0.14739906979192097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01781010627746582, "StateBufferConnector_ms": 0.01253819465637207, "ViewRequirementAgentConnector_ms": 0.4251227378845215}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99400, "num_agent_steps_trained": 99400, "num_env_steps_sampled": 99400, "num_env_steps_trained": 99400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1552.1500038592117, "num_env_steps_trained_throughput_per_sec": 1552.1500038592117, "timesteps_total": 99400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 99400, "timers": {"training_iteration_time_ms": 951.928, "sample_time_ms": 919.418, "load_time_ms": 0.1, "load_throughput": 13984342.939, "learn_time_ms": 12.501, "learn_throughput": 111989.106, "synch_weights_time_ms": 19.628}, "counters": {"num_env_steps_sampled": 99400, "num_env_steps_trained": 99400, "num_agent_steps_sampled": 99400, "num_agent_steps_trained": 99400}, "done": false, "episodes_total": 5321, "training_iteration": 71, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-23", "timestamp": 1702021223, "time_this_iter_s": 0.9179704189300537, "time_total_s": 84.7045431137085, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 84.7045431137085, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 90.8, "ram_util_percent": 95.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0905430316925049, "total_loss": 1.0905430316925049, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}, "num_env_steps_sampled": 100800, "num_env_steps_trained": 100800, "num_agent_steps_sampled": 100800, "num_agent_steps_trained": 100800}, "sampler_results": {"episode_reward_max": 12.473999999999993, "episode_reward_min": 5.469333333333332, "episode_reward_mean": 8.681376666666665, "episode_len_mean": 18.58, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.137666666666666, 8.336666666666664, 7.809333333333333, 7.8119999999999985, 11.292666666666664, 5.469333333333332, 8.304333333333332, 11.376333333333333, 8.298333333333332, 7.606999999999999, 8.186333333333332, 9.084, 11.860666666666669, 10.013999999999998, 7.707333333333333, 5.8103333333333325, 9.680333333333333, 9.856, 10.587999999999997, 8.128666666666664, 7.150666666666666, 10.610333333333331, 6.315333333333333, 8.643999999999998, 11.092666666666668, 6.997333333333334, 8.861333333333334, 7.247, 7.393999999999999, 6.406666666666666, 8.838333333333331, 9.714333333333332, 7.423666666666667, 7.847333333333333, 9.008333333333335, 7.845333333333333, 8.430666666666667, 6.802333333333332, 9.832333333333333, 9.271666666666661, 9.701333333333334, 8.688333333333334, 7.075333333333333, 8.600333333333333, 8.539, 8.186333333333332, 9.459999999999999, 9.481, 9.866666666666665, 9.651333333333332, 12.473999999999993, 8.119333333333332, 9.267, 10.086000000000002, 6.975, 9.658666666666665, 10.094999999999997, 7.073666666666665, 9.397666666666666, 7.681666666666667, 11.896333333333333, 7.798333333333334, 8.316999999999998, 7.930333333333332, 8.183000000000002, 9.497666666666666, 9.704666666666666, 7.326999999999998, 7.450666666666667, 7.857999999999997, 9.924666666666665, 9.185333333333332, 7.621333333333332, 7.532333333333331, 8.979, 7.377666666666667, 8.746333333333332, 8.452333333333332, 8.958, 11.33933333333333, 9.71333333333333, 8.064333333333334, 11.34, 8.594666666666667, 7.0649999999999995, 8.390999999999998, 8.511333333333333, 8.550999999999998, 7.916666666666667, 8.378666666666666, 8.003666666666666, 8.635333333333332, 7.791666666666665, 6.614, 8.627999999999998, 10.237999999999996, 11.669666666666668, 8.298666666666666, 9.407, 7.075666666666665], "episode_lengths": [17, 18, 16, 17, 23, 13, 16, 25, 18, 17, 18, 19, 28, 18, 18, 13, 20, 21, 26, 16, 16, 24, 15, 19, 22, 15, 18, 15, 15, 14, 17, 21, 15, 17, 20, 16, 20, 15, 20, 21, 19, 19, 14, 20, 20, 17, 19, 20, 21, 21, 26, 16, 20, 22, 15, 18, 21, 15, 20, 17, 27, 15, 17, 18, 21, 20, 20, 16, 16, 17, 20, 18, 19, 16, 20, 16, 19, 18, 19, 22, 21, 16, 24, 19, 17, 18, 18, 19, 17, 18, 16, 19, 18, 14, 17, 22, 22, 19, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.612028380139556, "mean_inference_ms": 2.9356767225306744, "mean_action_processing_ms": 0.6122836171191672, "mean_env_wait_ms": 0.1461764500444233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024437427520751953, "StateBufferConnector_ms": 0.014509201049804688, "ViewRequirementAgentConnector_ms": 0.4399700164794922}}, "episode_reward_max": 12.473999999999993, "episode_reward_min": 5.469333333333332, "episode_reward_mean": 8.681376666666665, "episode_len_mean": 18.58, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.137666666666666, 8.336666666666664, 7.809333333333333, 7.8119999999999985, 11.292666666666664, 5.469333333333332, 8.304333333333332, 11.376333333333333, 8.298333333333332, 7.606999999999999, 8.186333333333332, 9.084, 11.860666666666669, 10.013999999999998, 7.707333333333333, 5.8103333333333325, 9.680333333333333, 9.856, 10.587999999999997, 8.128666666666664, 7.150666666666666, 10.610333333333331, 6.315333333333333, 8.643999999999998, 11.092666666666668, 6.997333333333334, 8.861333333333334, 7.247, 7.393999999999999, 6.406666666666666, 8.838333333333331, 9.714333333333332, 7.423666666666667, 7.847333333333333, 9.008333333333335, 7.845333333333333, 8.430666666666667, 6.802333333333332, 9.832333333333333, 9.271666666666661, 9.701333333333334, 8.688333333333334, 7.075333333333333, 8.600333333333333, 8.539, 8.186333333333332, 9.459999999999999, 9.481, 9.866666666666665, 9.651333333333332, 12.473999999999993, 8.119333333333332, 9.267, 10.086000000000002, 6.975, 9.658666666666665, 10.094999999999997, 7.073666666666665, 9.397666666666666, 7.681666666666667, 11.896333333333333, 7.798333333333334, 8.316999999999998, 7.930333333333332, 8.183000000000002, 9.497666666666666, 9.704666666666666, 7.326999999999998, 7.450666666666667, 7.857999999999997, 9.924666666666665, 9.185333333333332, 7.621333333333332, 7.532333333333331, 8.979, 7.377666666666667, 8.746333333333332, 8.452333333333332, 8.958, 11.33933333333333, 9.71333333333333, 8.064333333333334, 11.34, 8.594666666666667, 7.0649999999999995, 8.390999999999998, 8.511333333333333, 8.550999999999998, 7.916666666666667, 8.378666666666666, 8.003666666666666, 8.635333333333332, 7.791666666666665, 6.614, 8.627999999999998, 10.237999999999996, 11.669666666666668, 8.298666666666666, 9.407, 7.075666666666665], "episode_lengths": [17, 18, 16, 17, 23, 13, 16, 25, 18, 17, 18, 19, 28, 18, 18, 13, 20, 21, 26, 16, 16, 24, 15, 19, 22, 15, 18, 15, 15, 14, 17, 21, 15, 17, 20, 16, 20, 15, 20, 21, 19, 19, 14, 20, 20, 17, 19, 20, 21, 21, 26, 16, 20, 22, 15, 18, 21, 15, 20, 17, 27, 15, 17, 18, 21, 20, 20, 16, 16, 17, 20, 18, 19, 16, 20, 16, 19, 18, 19, 22, 21, 16, 24, 19, 17, 18, 18, 19, 17, 18, 16, 19, 18, 14, 17, 22, 22, 19, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.612028380139556, "mean_inference_ms": 2.9356767225306744, "mean_action_processing_ms": 0.6122836171191672, "mean_env_wait_ms": 0.1461764500444233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024437427520751953, "StateBufferConnector_ms": 0.014509201049804688, "ViewRequirementAgentConnector_ms": 0.4399700164794922}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100800, "num_agent_steps_trained": 100800, "num_env_steps_sampled": 100800, "num_env_steps_trained": 100800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1586.9996324403796, "num_env_steps_trained_throughput_per_sec": 1586.9996324403796, "timesteps_total": 100800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 100800, "timers": {"training_iteration_time_ms": 937.28, "sample_time_ms": 904.633, "load_time_ms": 0.1, "load_throughput": 13984342.939, "learn_time_ms": 12.632, "learn_throughput": 110826.393, "synch_weights_time_ms": 19.634}, "counters": {"num_env_steps_sampled": 100800, "num_env_steps_trained": 100800, "num_agent_steps_sampled": 100800, "num_agent_steps_trained": 100800}, "done": false, "episodes_total": 5399, "training_iteration": 72, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-24", "timestamp": 1702021224, "time_this_iter_s": 0.8989942073822021, "time_total_s": 85.6035373210907, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.6035373210907, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 96.5, "ram_util_percent": 95.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0942364931106567, "total_loss": 1.0942364931106567, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 102200, "num_env_steps_trained": 102200, "num_agent_steps_sampled": 102200, "num_agent_steps_trained": 102200}, "sampler_results": {"episode_reward_max": 15.255333333333331, "episode_reward_min": 5.872, "episode_reward_mean": 8.696556666666664, "episode_len_mean": 18.49, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.746333333333332, 8.452333333333332, 8.958, 11.33933333333333, 9.71333333333333, 8.064333333333334, 11.34, 8.594666666666667, 7.0649999999999995, 8.390999999999998, 8.511333333333333, 8.550999999999998, 7.916666666666667, 8.378666666666666, 8.003666666666666, 8.635333333333332, 7.791666666666665, 6.614, 8.627999999999998, 10.237999999999996, 11.669666666666668, 8.298666666666666, 9.407, 7.075666666666665, 12.481, 6.917999999999998, 9.598, 9.131333333333332, 9.339999999999998, 9.27533333333333, 7.382000000000001, 6.078333333333334, 6.907666666666667, 8.707666666666665, 7.832333333333331, 11.147333333333329, 7.629333333333331, 7.7506666666666675, 7.668666666666667, 12.584000000000001, 9.72833333333333, 8.729333333333333, 9.35733333333333, 8.40733333333333, 5.872, 7.724666666666666, 9.074999999999998, 10.427000000000001, 9.226999999999997, 9.640666666666666, 8.1, 7.560666666666667, 6.856, 7.2253333333333325, 9.548, 6.356666666666667, 6.304333333333333, 9.464, 7.342, 8.670666666666666, 7.0603333333333325, 7.619666666666666, 10.741666666666667, 8.457333333333331, 10.308, 6.571999999999999, 6.229666666666666, 10.604333333333335, 10.582000000000003, 7.638999999999998, 7.837333333333333, 8.702333333333332, 9.322, 8.918333333333333, 9.216333333333333, 9.466333333333331, 8.475333333333332, 7.7959999999999985, 7.723666666666665, 13.148666666666669, 7.419666666666668, 8.578333333333335, 9.474, 9.090999999999998, 9.657999999999998, 11.432333333333336, 7.802000000000001, 8.050666666666665, 8.306666666666667, 7.561666666666666, 9.110999999999995, 7.483666666666665, 7.973, 6.867333333333334, 7.629666666666664, 9.123666666666665, 6.947333333333332, 10.383666666666665, 15.255333333333331, 8.654666666666667], "episode_lengths": [19, 18, 19, 22, 21, 16, 24, 19, 17, 18, 18, 19, 17, 18, 16, 19, 18, 14, 17, 22, 22, 19, 21, 17, 24, 15, 19, 18, 19, 20, 16, 14, 20, 20, 16, 26, 18, 15, 16, 24, 22, 20, 20, 18, 13, 18, 20, 21, 21, 17, 19, 17, 15, 15, 18, 15, 15, 19, 15, 19, 15, 16, 23, 20, 22, 14, 13, 23, 23, 16, 16, 17, 18, 19, 18, 20, 18, 17, 15, 26, 17, 18, 19, 19, 19, 24, 18, 17, 17, 17, 21, 16, 17, 15, 17, 19, 15, 21, 30, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.608109354536752, "mean_inference_ms": 2.925389364709698, "mean_action_processing_ms": 0.6105142547929016, "mean_env_wait_ms": 0.14579326967368603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0236203670501709, "StateBufferConnector_ms": 0.016416072845458984, "ViewRequirementAgentConnector_ms": 0.4293537139892578}}, "episode_reward_max": 15.255333333333331, "episode_reward_min": 5.872, "episode_reward_mean": 8.696556666666664, "episode_len_mean": 18.49, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.746333333333332, 8.452333333333332, 8.958, 11.33933333333333, 9.71333333333333, 8.064333333333334, 11.34, 8.594666666666667, 7.0649999999999995, 8.390999999999998, 8.511333333333333, 8.550999999999998, 7.916666666666667, 8.378666666666666, 8.003666666666666, 8.635333333333332, 7.791666666666665, 6.614, 8.627999999999998, 10.237999999999996, 11.669666666666668, 8.298666666666666, 9.407, 7.075666666666665, 12.481, 6.917999999999998, 9.598, 9.131333333333332, 9.339999999999998, 9.27533333333333, 7.382000000000001, 6.078333333333334, 6.907666666666667, 8.707666666666665, 7.832333333333331, 11.147333333333329, 7.629333333333331, 7.7506666666666675, 7.668666666666667, 12.584000000000001, 9.72833333333333, 8.729333333333333, 9.35733333333333, 8.40733333333333, 5.872, 7.724666666666666, 9.074999999999998, 10.427000000000001, 9.226999999999997, 9.640666666666666, 8.1, 7.560666666666667, 6.856, 7.2253333333333325, 9.548, 6.356666666666667, 6.304333333333333, 9.464, 7.342, 8.670666666666666, 7.0603333333333325, 7.619666666666666, 10.741666666666667, 8.457333333333331, 10.308, 6.571999999999999, 6.229666666666666, 10.604333333333335, 10.582000000000003, 7.638999999999998, 7.837333333333333, 8.702333333333332, 9.322, 8.918333333333333, 9.216333333333333, 9.466333333333331, 8.475333333333332, 7.7959999999999985, 7.723666666666665, 13.148666666666669, 7.419666666666668, 8.578333333333335, 9.474, 9.090999999999998, 9.657999999999998, 11.432333333333336, 7.802000000000001, 8.050666666666665, 8.306666666666667, 7.561666666666666, 9.110999999999995, 7.483666666666665, 7.973, 6.867333333333334, 7.629666666666664, 9.123666666666665, 6.947333333333332, 10.383666666666665, 15.255333333333331, 8.654666666666667], "episode_lengths": [19, 18, 19, 22, 21, 16, 24, 19, 17, 18, 18, 19, 17, 18, 16, 19, 18, 14, 17, 22, 22, 19, 21, 17, 24, 15, 19, 18, 19, 20, 16, 14, 20, 20, 16, 26, 18, 15, 16, 24, 22, 20, 20, 18, 13, 18, 20, 21, 21, 17, 19, 17, 15, 15, 18, 15, 15, 19, 15, 19, 15, 16, 23, 20, 22, 14, 13, 23, 23, 16, 16, 17, 18, 19, 18, 20, 18, 17, 15, 26, 17, 18, 19, 19, 19, 24, 18, 17, 17, 17, 21, 16, 17, 15, 17, 19, 15, 21, 30, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.608109354536752, "mean_inference_ms": 2.925389364709698, "mean_action_processing_ms": 0.6105142547929016, "mean_env_wait_ms": 0.14579326967368603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0236203670501709, "StateBufferConnector_ms": 0.016416072845458984, "ViewRequirementAgentConnector_ms": 0.4293537139892578}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102200, "num_agent_steps_trained": 102200, "num_env_steps_sampled": 102200, "num_env_steps_trained": 102200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1579.1306106357424, "num_env_steps_trained_throughput_per_sec": 1579.1306106357424, "timesteps_total": 102200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 102200, "timers": {"training_iteration_time_ms": 927.27, "sample_time_ms": 895.007, "load_time_ms": 0.1, "load_throughput": 13984342.939, "learn_time_ms": 12.433, "learn_throughput": 112605.459, "synch_weights_time_ms": 19.349}, "counters": {"num_env_steps_sampled": 102200, "num_env_steps_trained": 102200, "num_agent_steps_sampled": 102200, "num_agent_steps_trained": 102200}, "done": false, "episodes_total": 5475, "training_iteration": 73, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-25", "timestamp": 1702021225, "time_this_iter_s": 0.9114334583282471, "time_total_s": 86.51497077941895, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 86.51497077941895, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 92.3, "ram_util_percent": 95.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0963941812515259, "total_loss": 1.0963941812515259, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 103600, "num_env_steps_trained": 103600, "num_agent_steps_sampled": 103600, "num_agent_steps_trained": 103600}, "sampler_results": {"episode_reward_max": 15.255333333333331, "episode_reward_min": 5.938666666666667, "episode_reward_mean": 8.640156666666666, "episode_len_mean": 18.63, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.466333333333331, 8.475333333333332, 7.7959999999999985, 7.723666666666665, 13.148666666666669, 7.419666666666668, 8.578333333333335, 9.474, 9.090999999999998, 9.657999999999998, 11.432333333333336, 7.802000000000001, 8.050666666666665, 8.306666666666667, 7.561666666666666, 9.110999999999995, 7.483666666666665, 7.973, 6.867333333333334, 7.629666666666664, 9.123666666666665, 6.947333333333332, 10.383666666666665, 15.255333333333331, 8.654666666666667, 9.472999999999997, 7.873333333333333, 5.998333333333334, 9.190666666666667, 8.720333333333333, 9.166333333333334, 7.556333333333332, 8.095666666666666, 8.943666666666664, 8.444666666666665, 6.636999999999999, 10.652999999999997, 6.644333333333334, 9.642999999999997, 7.569999999999999, 7.911666666666665, 12.346333333333328, 10.455, 10.37833333333333, 9.258666666666663, 7.302999999999998, 11.110999999999997, 8.590666666666666, 8.652333333333333, 8.245333333333333, 8.354, 9.945999999999998, 6.926999999999999, 6.371666666666667, 8.822, 10.143999999999998, 6.667333333333332, 7.348333333333332, 7.276666666666666, 6.007666666666665, 9.214999999999998, 8.466, 8.329666666666665, 10.977999999999998, 7.7669999999999995, 9.280999999999997, 9.016, 10.468333333333332, 6.6850000000000005, 8.485333333333331, 9.644666666666666, 7.743333333333332, 10.761999999999999, 11.487, 7.054999999999999, 6.670666666666665, 7.195333333333331, 9.013, 8.784666666666666, 7.936333333333333, 8.230333333333332, 8.691333333333333, 8.584999999999999, 6.179333333333332, 7.435666666666665, 6.814999999999999, 9.26533333333333, 6.762999999999999, 14.09733333333332, 8.418666666666665, 8.789, 9.005, 11.961999999999998, 6.575666666666665, 7.929999999999999, 7.627999999999999, 7.827666666666666, 5.938666666666667, 10.341666666666665, 8.413333333333334], "episode_lengths": [20, 18, 17, 15, 26, 17, 18, 19, 19, 19, 24, 18, 17, 17, 17, 21, 16, 17, 15, 17, 19, 15, 21, 30, 17, 20, 18, 13, 20, 18, 20, 16, 17, 20, 18, 15, 21, 15, 21, 16, 17, 25, 24, 19, 21, 15, 21, 19, 18, 18, 20, 21, 16, 14, 20, 22, 14, 16, 17, 14, 20, 16, 17, 25, 19, 20, 20, 22, 16, 20, 22, 18, 19, 22, 15, 14, 15, 21, 18, 19, 17, 19, 18, 14, 18, 14, 22, 16, 30, 18, 20, 18, 27, 15, 20, 17, 17, 14, 24, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6035040204471966, "mean_inference_ms": 2.916635477473048, "mean_action_processing_ms": 0.6089090570821072, "mean_env_wait_ms": 0.1456651526001451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024283409118652344, "StateBufferConnector_ms": 0.013067007064819336, "ViewRequirementAgentConnector_ms": 0.41923975944519043}}, "episode_reward_max": 15.255333333333331, "episode_reward_min": 5.938666666666667, "episode_reward_mean": 8.640156666666666, "episode_len_mean": 18.63, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.466333333333331, 8.475333333333332, 7.7959999999999985, 7.723666666666665, 13.148666666666669, 7.419666666666668, 8.578333333333335, 9.474, 9.090999999999998, 9.657999999999998, 11.432333333333336, 7.802000000000001, 8.050666666666665, 8.306666666666667, 7.561666666666666, 9.110999999999995, 7.483666666666665, 7.973, 6.867333333333334, 7.629666666666664, 9.123666666666665, 6.947333333333332, 10.383666666666665, 15.255333333333331, 8.654666666666667, 9.472999999999997, 7.873333333333333, 5.998333333333334, 9.190666666666667, 8.720333333333333, 9.166333333333334, 7.556333333333332, 8.095666666666666, 8.943666666666664, 8.444666666666665, 6.636999999999999, 10.652999999999997, 6.644333333333334, 9.642999999999997, 7.569999999999999, 7.911666666666665, 12.346333333333328, 10.455, 10.37833333333333, 9.258666666666663, 7.302999999999998, 11.110999999999997, 8.590666666666666, 8.652333333333333, 8.245333333333333, 8.354, 9.945999999999998, 6.926999999999999, 6.371666666666667, 8.822, 10.143999999999998, 6.667333333333332, 7.348333333333332, 7.276666666666666, 6.007666666666665, 9.214999999999998, 8.466, 8.329666666666665, 10.977999999999998, 7.7669999999999995, 9.280999999999997, 9.016, 10.468333333333332, 6.6850000000000005, 8.485333333333331, 9.644666666666666, 7.743333333333332, 10.761999999999999, 11.487, 7.054999999999999, 6.670666666666665, 7.195333333333331, 9.013, 8.784666666666666, 7.936333333333333, 8.230333333333332, 8.691333333333333, 8.584999999999999, 6.179333333333332, 7.435666666666665, 6.814999999999999, 9.26533333333333, 6.762999999999999, 14.09733333333332, 8.418666666666665, 8.789, 9.005, 11.961999999999998, 6.575666666666665, 7.929999999999999, 7.627999999999999, 7.827666666666666, 5.938666666666667, 10.341666666666665, 8.413333333333334], "episode_lengths": [20, 18, 17, 15, 26, 17, 18, 19, 19, 19, 24, 18, 17, 17, 17, 21, 16, 17, 15, 17, 19, 15, 21, 30, 17, 20, 18, 13, 20, 18, 20, 16, 17, 20, 18, 15, 21, 15, 21, 16, 17, 25, 24, 19, 21, 15, 21, 19, 18, 18, 20, 21, 16, 14, 20, 22, 14, 16, 17, 14, 20, 16, 17, 25, 19, 20, 20, 22, 16, 20, 22, 18, 19, 22, 15, 14, 15, 21, 18, 19, 17, 19, 18, 14, 18, 14, 22, 16, 30, 18, 20, 18, 27, 15, 20, 17, 17, 14, 24, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6035040204471966, "mean_inference_ms": 2.916635477473048, "mean_action_processing_ms": 0.6089090570821072, "mean_env_wait_ms": 0.1456651526001451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024283409118652344, "StateBufferConnector_ms": 0.013067007064819336, "ViewRequirementAgentConnector_ms": 0.41923975944519043}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103600, "num_agent_steps_trained": 103600, "num_env_steps_sampled": 103600, "num_env_steps_trained": 103600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1464.5847638454661, "num_env_steps_trained_throughput_per_sec": 1464.5847638454661, "timesteps_total": 103600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 103600, "timers": {"training_iteration_time_ms": 902.561, "sample_time_ms": 869.416, "load_time_ms": 0.1, "load_throughput": 13984342.939, "learn_time_ms": 12.939, "learn_throughput": 108197.423, "synch_weights_time_ms": 19.725}, "counters": {"num_env_steps_sampled": 103600, "num_env_steps_trained": 103600, "num_agent_steps_sampled": 103600, "num_agent_steps_trained": 103600}, "done": false, "episodes_total": 5550, "training_iteration": 74, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-26", "timestamp": 1702021226, "time_this_iter_s": 0.9759061336517334, "time_total_s": 87.49087691307068, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 87.49087691307068, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 92.5, "ram_util_percent": 95.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.091852068901062, "total_loss": 1.091852068901062, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "sampler_results": {"episode_reward_max": 14.09733333333332, "episode_reward_min": 5.893333333333333, "episode_reward_mean": 8.63744, "episode_len_mean": 18.89, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.054999999999999, 6.670666666666665, 7.195333333333331, 9.013, 8.784666666666666, 7.936333333333333, 8.230333333333332, 8.691333333333333, 8.584999999999999, 6.179333333333332, 7.435666666666665, 6.814999999999999, 9.26533333333333, 6.762999999999999, 14.09733333333332, 8.418666666666665, 8.789, 9.005, 11.961999999999998, 6.575666666666665, 7.929999999999999, 7.627999999999999, 7.827666666666666, 5.938666666666667, 10.341666666666665, 8.413333333333334, 8.79833333333333, 10.136666666666667, 7.615, 10.15, 9.843666666666667, 6.965999999999998, 10.176, 10.453, 7.211999999999999, 9.714333333333332, 6.921333333333333, 7.6836666666666655, 8.085333333333335, 8.383999999999999, 6.523666666666667, 8.494, 8.666999999999998, 11.04133333333333, 9.508666666666665, 7.4963333333333315, 8.675666666666666, 8.511333333333333, 8.15633333333333, 8.384, 13.316666666666668, 7.764, 8.287333333333331, 7.406666666666667, 10.078666666666663, 7.754666666666664, 12.117999999999997, 11.37733333333333, 9.323333333333332, 9.366666666666667, 9.920666666666664, 8.432333333333332, 7.727000000000001, 7.511333333333332, 7.583666666666666, 8.821999999999996, 8.574666666666666, 8.076666666666666, 7.332999999999999, 8.184999999999999, 9.017333333333333, 7.083333333333334, 5.893333333333333, 6.342666666666666, 6.054, 7.455333333333332, 6.197666666666667, 9.831666666666667, 9.997666666666666, 7.543999999999998, 8.471666666666666, 8.342666666666666, 11.627666666666665, 6.676333333333331, 9.699666666666664, 7.9689999999999985, 9.957666666666665, 9.970333333333334, 9.428333333333335, 7.599999999999998, 12.513666666666666, 7.663, 11.798000000000002, 9.44833333333333, 10.089333333333334, 10.390666666666666, 8.411333333333332, 8.482333333333333, 9.208666666666666, 8.474000000000002], "episode_lengths": [15, 14, 15, 21, 18, 19, 17, 19, 18, 14, 18, 14, 22, 16, 30, 18, 20, 18, 27, 15, 20, 17, 17, 14, 24, 19, 19, 21, 17, 24, 21, 14, 23, 22, 15, 18, 15, 18, 18, 18, 17, 17, 19, 22, 20, 18, 19, 19, 16, 17, 28, 16, 17, 17, 22, 18, 25, 23, 19, 21, 19, 19, 20, 16, 17, 22, 18, 20, 16, 17, 23, 15, 14, 14, 14, 17, 15, 21, 20, 16, 19, 20, 22, 16, 19, 19, 21, 23, 23, 17, 25, 18, 26, 19, 22, 23, 17, 18, 18, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999295739698693, "mean_inference_ms": 2.9093331073214865, "mean_action_processing_ms": 0.6066785785553164, "mean_env_wait_ms": 0.14543176678526354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02608346939086914, "StateBufferConnector_ms": 0.016926288604736328, "ViewRequirementAgentConnector_ms": 0.43646788597106934}}, "episode_reward_max": 14.09733333333332, "episode_reward_min": 5.893333333333333, "episode_reward_mean": 8.63744, "episode_len_mean": 18.89, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.054999999999999, 6.670666666666665, 7.195333333333331, 9.013, 8.784666666666666, 7.936333333333333, 8.230333333333332, 8.691333333333333, 8.584999999999999, 6.179333333333332, 7.435666666666665, 6.814999999999999, 9.26533333333333, 6.762999999999999, 14.09733333333332, 8.418666666666665, 8.789, 9.005, 11.961999999999998, 6.575666666666665, 7.929999999999999, 7.627999999999999, 7.827666666666666, 5.938666666666667, 10.341666666666665, 8.413333333333334, 8.79833333333333, 10.136666666666667, 7.615, 10.15, 9.843666666666667, 6.965999999999998, 10.176, 10.453, 7.211999999999999, 9.714333333333332, 6.921333333333333, 7.6836666666666655, 8.085333333333335, 8.383999999999999, 6.523666666666667, 8.494, 8.666999999999998, 11.04133333333333, 9.508666666666665, 7.4963333333333315, 8.675666666666666, 8.511333333333333, 8.15633333333333, 8.384, 13.316666666666668, 7.764, 8.287333333333331, 7.406666666666667, 10.078666666666663, 7.754666666666664, 12.117999999999997, 11.37733333333333, 9.323333333333332, 9.366666666666667, 9.920666666666664, 8.432333333333332, 7.727000000000001, 7.511333333333332, 7.583666666666666, 8.821999999999996, 8.574666666666666, 8.076666666666666, 7.332999999999999, 8.184999999999999, 9.017333333333333, 7.083333333333334, 5.893333333333333, 6.342666666666666, 6.054, 7.455333333333332, 6.197666666666667, 9.831666666666667, 9.997666666666666, 7.543999999999998, 8.471666666666666, 8.342666666666666, 11.627666666666665, 6.676333333333331, 9.699666666666664, 7.9689999999999985, 9.957666666666665, 9.970333333333334, 9.428333333333335, 7.599999999999998, 12.513666666666666, 7.663, 11.798000000000002, 9.44833333333333, 10.089333333333334, 10.390666666666666, 8.411333333333332, 8.482333333333333, 9.208666666666666, 8.474000000000002], "episode_lengths": [15, 14, 15, 21, 18, 19, 17, 19, 18, 14, 18, 14, 22, 16, 30, 18, 20, 18, 27, 15, 20, 17, 17, 14, 24, 19, 19, 21, 17, 24, 21, 14, 23, 22, 15, 18, 15, 18, 18, 18, 17, 17, 19, 22, 20, 18, 19, 19, 16, 17, 28, 16, 17, 17, 22, 18, 25, 23, 19, 21, 19, 19, 20, 16, 17, 22, 18, 20, 16, 17, 23, 15, 14, 14, 14, 17, 15, 21, 20, 16, 19, 20, 22, 16, 19, 19, 21, 23, 23, 17, 25, 18, 26, 19, 22, 23, 17, 18, 18, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999295739698693, "mean_inference_ms": 2.9093331073214865, "mean_action_processing_ms": 0.6066785785553164, "mean_env_wait_ms": 0.14543176678526354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02608346939086914, "StateBufferConnector_ms": 0.016926288604736328, "ViewRequirementAgentConnector_ms": 0.43646788597106934}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1493.046658775997, "num_env_steps_trained_throughput_per_sec": 1493.046658775997, "timesteps_total": 105000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 105000, "timers": {"training_iteration_time_ms": 909.464, "sample_time_ms": 875.964, "load_time_ms": 0.1, "load_throughput": 13984342.939, "learn_time_ms": 13.156, "learn_throughput": 106418.725, "synch_weights_time_ms": 19.864}, "counters": {"num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "done": false, "episodes_total": 5624, "training_iteration": 75, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-27", "timestamp": 1702021227, "time_this_iter_s": 0.9544229507446289, "time_total_s": 88.44529986381531, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 88.44529986381531, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 98.45, "ram_util_percent": 95.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0919442176818848, "total_loss": 1.0919442176818848, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}}, "num_env_steps_sampled": 106400, "num_env_steps_trained": 106400, "num_agent_steps_sampled": 106400, "num_agent_steps_trained": 106400}, "sampler_results": {"episode_reward_max": 14.069666666666667, "episode_reward_min": 5.893333333333333, "episode_reward_mean": 8.868063333333332, "episode_len_mean": 19.15, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.893333333333333, 6.342666666666666, 6.054, 7.455333333333332, 6.197666666666667, 9.831666666666667, 9.997666666666666, 7.543999999999998, 8.471666666666666, 8.342666666666666, 11.627666666666665, 6.676333333333331, 9.699666666666664, 7.9689999999999985, 9.957666666666665, 9.970333333333334, 9.428333333333335, 7.599999999999998, 12.513666666666666, 7.663, 11.798000000000002, 9.44833333333333, 10.089333333333334, 10.390666666666666, 8.411333333333332, 8.482333333333333, 9.208666666666666, 8.474000000000002, 11.387333333333329, 7.798333333333331, 10.668, 7.416333333333332, 7.7926666666666655, 9.206666666666663, 8.067666666666668, 8.666666666666666, 9.937333333333328, 6.828999999999998, 9.275333333333332, 8.103666666666665, 9.922, 8.918666666666665, 8.971666666666666, 7.568666666666665, 7.215666666666665, 8.958666666666666, 9.950999999999997, 8.659333333333333, 12.109666666666664, 10.550666666666665, 10.352333333333332, 8.501, 10.447999999999999, 7.739666666666666, 8.146999999999998, 11.10533333333333, 9.007999999999997, 7.539666666666664, 7.856333333333333, 8.072666666666667, 9.119333333333334, 6.503333333333333, 10.122666666666664, 11.367666666666668, 11.281333333333333, 9.885999999999996, 10.093999999999996, 14.069666666666667, 7.771999999999999, 7.570666666666667, 7.417333333333333, 8.861999999999998, 7.366666666666666, 8.545, 9.76033333333333, 9.440999999999999, 7.882999999999997, 10.60666666666667, 8.238333333333337, 6.650666666666666, 7.702333333333335, 8.787666666666668, 8.966666666666665, 8.922, 7.759333333333334, 7.676666666666666, 8.562333333333333, 8.306999999999999, 9.146333333333333, 8.912999999999998, 7.617333333333333, 5.894666666666666, 9.885, 7.922333333333333, 9.374000000000002, 8.483, 8.532666666666666, 10.380666666666665, 9.093666666666667, 10.038], "episode_lengths": [14, 14, 14, 17, 15, 21, 20, 16, 19, 20, 22, 16, 19, 19, 21, 23, 23, 17, 25, 18, 26, 19, 22, 23, 17, 18, 18, 19, 23, 17, 22, 16, 18, 19, 17, 18, 21, 15, 21, 17, 23, 20, 18, 16, 18, 24, 21, 17, 25, 20, 22, 16, 20, 16, 18, 24, 19, 17, 17, 19, 19, 14, 20, 22, 24, 21, 23, 27, 15, 17, 17, 18, 20, 18, 20, 25, 18, 26, 17, 14, 17, 18, 20, 19, 18, 16, 18, 19, 20, 18, 15, 15, 22, 16, 19, 19, 19, 23, 18, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5958830304345468, "mean_inference_ms": 2.901671084848711, "mean_action_processing_ms": 0.6054326774119321, "mean_env_wait_ms": 0.14509046460409095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020293235778808594, "StateBufferConnector_ms": 0.015281915664672852, "ViewRequirementAgentConnector_ms": 0.4207422733306885}}, "episode_reward_max": 14.069666666666667, "episode_reward_min": 5.893333333333333, "episode_reward_mean": 8.868063333333332, "episode_len_mean": 19.15, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.893333333333333, 6.342666666666666, 6.054, 7.455333333333332, 6.197666666666667, 9.831666666666667, 9.997666666666666, 7.543999999999998, 8.471666666666666, 8.342666666666666, 11.627666666666665, 6.676333333333331, 9.699666666666664, 7.9689999999999985, 9.957666666666665, 9.970333333333334, 9.428333333333335, 7.599999999999998, 12.513666666666666, 7.663, 11.798000000000002, 9.44833333333333, 10.089333333333334, 10.390666666666666, 8.411333333333332, 8.482333333333333, 9.208666666666666, 8.474000000000002, 11.387333333333329, 7.798333333333331, 10.668, 7.416333333333332, 7.7926666666666655, 9.206666666666663, 8.067666666666668, 8.666666666666666, 9.937333333333328, 6.828999999999998, 9.275333333333332, 8.103666666666665, 9.922, 8.918666666666665, 8.971666666666666, 7.568666666666665, 7.215666666666665, 8.958666666666666, 9.950999999999997, 8.659333333333333, 12.109666666666664, 10.550666666666665, 10.352333333333332, 8.501, 10.447999999999999, 7.739666666666666, 8.146999999999998, 11.10533333333333, 9.007999999999997, 7.539666666666664, 7.856333333333333, 8.072666666666667, 9.119333333333334, 6.503333333333333, 10.122666666666664, 11.367666666666668, 11.281333333333333, 9.885999999999996, 10.093999999999996, 14.069666666666667, 7.771999999999999, 7.570666666666667, 7.417333333333333, 8.861999999999998, 7.366666666666666, 8.545, 9.76033333333333, 9.440999999999999, 7.882999999999997, 10.60666666666667, 8.238333333333337, 6.650666666666666, 7.702333333333335, 8.787666666666668, 8.966666666666665, 8.922, 7.759333333333334, 7.676666666666666, 8.562333333333333, 8.306999999999999, 9.146333333333333, 8.912999999999998, 7.617333333333333, 5.894666666666666, 9.885, 7.922333333333333, 9.374000000000002, 8.483, 8.532666666666666, 10.380666666666665, 9.093666666666667, 10.038], "episode_lengths": [14, 14, 14, 17, 15, 21, 20, 16, 19, 20, 22, 16, 19, 19, 21, 23, 23, 17, 25, 18, 26, 19, 22, 23, 17, 18, 18, 19, 23, 17, 22, 16, 18, 19, 17, 18, 21, 15, 21, 17, 23, 20, 18, 16, 18, 24, 21, 17, 25, 20, 22, 16, 20, 16, 18, 24, 19, 17, 17, 19, 19, 14, 20, 22, 24, 21, 23, 27, 15, 17, 17, 18, 20, 18, 20, 25, 18, 26, 17, 14, 17, 18, 20, 19, 18, 16, 18, 19, 20, 18, 15, 15, 22, 16, 19, 19, 19, 23, 18, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5958830304345468, "mean_inference_ms": 2.901671084848711, "mean_action_processing_ms": 0.6054326774119321, "mean_env_wait_ms": 0.14509046460409095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020293235778808594, "StateBufferConnector_ms": 0.015281915664672852, "ViewRequirementAgentConnector_ms": 0.4207422733306885}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106400, "num_agent_steps_trained": 106400, "num_env_steps_sampled": 106400, "num_env_steps_trained": 106400, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1520.9558150275063, "num_env_steps_trained_throughput_per_sec": 1520.9558150275063, "timesteps_total": 106400, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 106400, "timers": {"training_iteration_time_ms": 908.767, "sample_time_ms": 874.756, "load_time_ms": 0.1, "load_throughput": 13984342.939, "learn_time_ms": 13.464, "learn_throughput": 103981.555, "synch_weights_time_ms": 20.146}, "counters": {"num_env_steps_sampled": 106400, "num_env_steps_trained": 106400, "num_agent_steps_sampled": 106400, "num_agent_steps_trained": 106400}, "done": false, "episodes_total": 5696, "training_iteration": 76, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-28", "timestamp": 1702021228, "time_this_iter_s": 0.9380896091461182, "time_total_s": 89.38338947296143, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 89.38338947296143, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 95.9, "ram_util_percent": 95.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0912811756134033, "total_loss": 1.0912811756134033, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 107800, "num_env_steps_trained": 107800, "num_agent_steps_sampled": 107800, "num_agent_steps_trained": 107800}, "sampler_results": {"episode_reward_max": 12.840666666666666, "episode_reward_min": 5.894666666666666, "episode_reward_mean": 8.919843333333334, "episode_len_mean": 18.97, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.76033333333333, 9.440999999999999, 7.882999999999997, 10.60666666666667, 8.238333333333337, 6.650666666666666, 7.702333333333335, 8.787666666666668, 8.966666666666665, 8.922, 7.759333333333334, 7.676666666666666, 8.562333333333333, 8.306999999999999, 9.146333333333333, 8.912999999999998, 7.617333333333333, 5.894666666666666, 9.885, 7.922333333333333, 9.374000000000002, 8.483, 8.532666666666666, 10.380666666666665, 9.093666666666667, 10.038, 10.114, 9.547, 9.789666666666665, 10.448999999999998, 6.447333333333333, 6.038666666666666, 6.139, 7.485333333333332, 9.979333333333331, 6.422999999999998, 8.448666666666666, 7.548333333333332, 8.236666666666665, 7.813333333333334, 8.361333333333333, 8.04133333333333, 9.790666666666667, 9.421999999999997, 9.090333333333334, 7.686333333333332, 11.238999999999994, 9.318999999999999, 7.295333333333334, 8.205000000000002, 9.463333333333333, 9.581999999999997, 10.227999999999998, 12.817666666666664, 6.1693333333333324, 9.935333333333332, 8.157999999999998, 7.294333333333333, 12.488000000000003, 6.804333333333335, 11.936333333333337, 9.025999999999998, 8.799666666666667, 9.19333333333333, 6.801666666666666, 9.612666666666666, 7.613999999999999, 8.558999999999997, 8.333666666666666, 7.941333333333333, 10.116999999999999, 8.74433333333333, 11.775999999999998, 8.349333333333332, 9.108333333333333, 7.987666666666666, 7.436, 12.840666666666666, 7.595999999999999, 12.068999999999997, 9.564666666666668, 10.247333333333332, 11.907666666666664, 8.587999999999997, 7.9289999999999985, 11.716, 9.742666666666667, 8.990666666666666, 9.331333333333331, 9.767, 9.225666666666664, 7.072666666666666, 11.178333333333331, 8.665666666666665, 7.650666666666666, 9.099333333333332, 8.868333333333334, 9.573333333333334, 10.730666666666668, 7.898666666666665], "episode_lengths": [20, 25, 18, 26, 17, 14, 17, 18, 20, 19, 18, 16, 18, 19, 20, 18, 15, 15, 22, 16, 19, 19, 19, 23, 18, 22, 18, 20, 22, 21, 15, 14, 14, 15, 19, 15, 19, 19, 18, 20, 19, 17, 22, 18, 17, 17, 23, 21, 16, 18, 19, 18, 19, 27, 14, 18, 18, 17, 24, 15, 24, 19, 17, 20, 15, 18, 18, 19, 20, 17, 19, 19, 24, 19, 19, 17, 15, 25, 16, 27, 19, 23, 22, 17, 17, 25, 20, 19, 22, 19, 17, 15, 24, 21, 17, 20, 17, 20, 22, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5916223646653258, "mean_inference_ms": 2.8939250909126737, "mean_action_processing_ms": 0.6036821287450806, "mean_env_wait_ms": 0.14467958113304286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018165111541748047, "StateBufferConnector_ms": 0.013412714004516602, "ViewRequirementAgentConnector_ms": 0.41283655166625977}}, "episode_reward_max": 12.840666666666666, "episode_reward_min": 5.894666666666666, "episode_reward_mean": 8.919843333333334, "episode_len_mean": 18.97, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.76033333333333, 9.440999999999999, 7.882999999999997, 10.60666666666667, 8.238333333333337, 6.650666666666666, 7.702333333333335, 8.787666666666668, 8.966666666666665, 8.922, 7.759333333333334, 7.676666666666666, 8.562333333333333, 8.306999999999999, 9.146333333333333, 8.912999999999998, 7.617333333333333, 5.894666666666666, 9.885, 7.922333333333333, 9.374000000000002, 8.483, 8.532666666666666, 10.380666666666665, 9.093666666666667, 10.038, 10.114, 9.547, 9.789666666666665, 10.448999999999998, 6.447333333333333, 6.038666666666666, 6.139, 7.485333333333332, 9.979333333333331, 6.422999999999998, 8.448666666666666, 7.548333333333332, 8.236666666666665, 7.813333333333334, 8.361333333333333, 8.04133333333333, 9.790666666666667, 9.421999999999997, 9.090333333333334, 7.686333333333332, 11.238999999999994, 9.318999999999999, 7.295333333333334, 8.205000000000002, 9.463333333333333, 9.581999999999997, 10.227999999999998, 12.817666666666664, 6.1693333333333324, 9.935333333333332, 8.157999999999998, 7.294333333333333, 12.488000000000003, 6.804333333333335, 11.936333333333337, 9.025999999999998, 8.799666666666667, 9.19333333333333, 6.801666666666666, 9.612666666666666, 7.613999999999999, 8.558999999999997, 8.333666666666666, 7.941333333333333, 10.116999999999999, 8.74433333333333, 11.775999999999998, 8.349333333333332, 9.108333333333333, 7.987666666666666, 7.436, 12.840666666666666, 7.595999999999999, 12.068999999999997, 9.564666666666668, 10.247333333333332, 11.907666666666664, 8.587999999999997, 7.9289999999999985, 11.716, 9.742666666666667, 8.990666666666666, 9.331333333333331, 9.767, 9.225666666666664, 7.072666666666666, 11.178333333333331, 8.665666666666665, 7.650666666666666, 9.099333333333332, 8.868333333333334, 9.573333333333334, 10.730666666666668, 7.898666666666665], "episode_lengths": [20, 25, 18, 26, 17, 14, 17, 18, 20, 19, 18, 16, 18, 19, 20, 18, 15, 15, 22, 16, 19, 19, 19, 23, 18, 22, 18, 20, 22, 21, 15, 14, 14, 15, 19, 15, 19, 19, 18, 20, 19, 17, 22, 18, 17, 17, 23, 21, 16, 18, 19, 18, 19, 27, 14, 18, 18, 17, 24, 15, 24, 19, 17, 20, 15, 18, 18, 19, 20, 17, 19, 19, 24, 19, 19, 17, 15, 25, 16, 27, 19, 23, 22, 17, 17, 25, 20, 19, 22, 19, 17, 15, 24, 21, 17, 20, 17, 20, 22, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5916223646653258, "mean_inference_ms": 2.8939250909126737, "mean_action_processing_ms": 0.6036821287450806, "mean_env_wait_ms": 0.14467958113304286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018165111541748047, "StateBufferConnector_ms": 0.013412714004516602, "ViewRequirementAgentConnector_ms": 0.41283655166625977}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107800, "num_agent_steps_trained": 107800, "num_env_steps_sampled": 107800, "num_env_steps_trained": 107800, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1578.3742171330268, "num_env_steps_trained_throughput_per_sec": 1578.3742171330268, "timesteps_total": 107800, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 107800, "timers": {"training_iteration_time_ms": 907.318, "sample_time_ms": 873.007, "load_time_ms": 0.203, "load_throughput": 6902580.933, "learn_time_ms": 13.562, "learn_throughput": 103227.164, "synch_weights_time_ms": 20.153}, "counters": {"num_env_steps_sampled": 107800, "num_env_steps_trained": 107800, "num_agent_steps_sampled": 107800, "num_agent_steps_trained": 107800}, "done": false, "episodes_total": 5770, "training_iteration": 77, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-29", "timestamp": 1702021229, "time_this_iter_s": 0.9020774364471436, "time_total_s": 90.28546690940857, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 90.28546690940857, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 94.8, "ram_util_percent": 95.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.094007968902588, "total_loss": 1.094007968902588, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 109200, "num_env_steps_trained": 109200, "num_agent_steps_sampled": 109200, "num_agent_steps_trained": 109200}, "sampler_results": {"episode_reward_max": 12.840666666666666, "episode_reward_min": 6.450999999999999, "episode_reward_mean": 8.845643333333332, "episode_len_mean": 18.81, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.436, 12.840666666666666, 7.595999999999999, 12.068999999999997, 9.564666666666668, 10.247333333333332, 11.907666666666664, 8.587999999999997, 7.9289999999999985, 11.716, 9.742666666666667, 8.990666666666666, 9.331333333333331, 9.767, 9.225666666666664, 7.072666666666666, 11.178333333333331, 8.665666666666665, 7.650666666666666, 9.099333333333332, 8.868333333333334, 9.573333333333334, 10.730666666666668, 7.898666666666665, 7.972666666666666, 10.447999999999997, 10.285666666666664, 8.658666666666665, 11.290666666666665, 7.653666666666666, 8.662333333333331, 11.235, 9.365, 8.979999999999999, 9.169333333333332, 7.476666666666665, 6.7056666666666676, 7.408666666666665, 7.056333333333332, 7.434333333333332, 6.921333333333333, 6.798666666666667, 8.696666666666664, 8.001, 11.008333333333335, 6.998999999999999, 7.609000000000001, 7.025333333333333, 7.409333333333333, 10.210333333333331, 8.294666666666664, 11.335999999999999, 7.551666666666665, 8.138666666666666, 7.708666666666665, 9.459666666666665, 10.13933333333333, 8.554333333333334, 7.667666666666667, 8.017333333333333, 10.605666666666666, 6.836666666666666, 9.41033333333333, 7.705, 9.469666666666663, 8.996666666666668, 11.973999999999997, 8.327333333333332, 10.807666666666664, 7.556666666666667, 6.684333333333332, 11.221000000000002, 10.72533333333333, 7.682999999999999, 8.357333333333333, 8.973333333333333, 7.525333333333332, 7.662666666666665, 6.450999999999999, 8.431, 10.901999999999996, 7.602666666666666, 8.675666666666665, 10.160666666666664, 7.207333333333333, 8.652, 7.479333333333332, 9.285666666666668, 8.304, 9.133999999999999, 10.435999999999996, 7.734, 8.291999999999998, 9.362333333333332, 7.88, 10.027999999999999, 8.343666666666666, 7.684666666666665, 9.123666666666661, 7.833666666666665], "episode_lengths": [15, 25, 16, 27, 19, 23, 22, 17, 17, 25, 20, 19, 22, 19, 17, 15, 24, 21, 17, 20, 17, 20, 22, 17, 17, 21, 21, 20, 23, 17, 20, 23, 21, 20, 18, 17, 15, 16, 16, 16, 15, 14, 18, 16, 22, 17, 18, 16, 16, 23, 20, 22, 17, 17, 15, 20, 20, 19, 16, 19, 24, 14, 21, 15, 19, 17, 24, 16, 21, 16, 15, 23, 22, 15, 20, 20, 18, 17, 14, 19, 22, 16, 20, 21, 15, 19, 15, 20, 15, 19, 23, 17, 17, 18, 19, 22, 21, 17, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.586828225559866, "mean_inference_ms": 2.8855563828469464, "mean_action_processing_ms": 0.6018547573060546, "mean_env_wait_ms": 0.14420599693771785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02140212059020996, "StateBufferConnector_ms": 0.016565799713134766, "ViewRequirementAgentConnector_ms": 0.37609267234802246}}, "episode_reward_max": 12.840666666666666, "episode_reward_min": 6.450999999999999, "episode_reward_mean": 8.845643333333332, "episode_len_mean": 18.81, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.436, 12.840666666666666, 7.595999999999999, 12.068999999999997, 9.564666666666668, 10.247333333333332, 11.907666666666664, 8.587999999999997, 7.9289999999999985, 11.716, 9.742666666666667, 8.990666666666666, 9.331333333333331, 9.767, 9.225666666666664, 7.072666666666666, 11.178333333333331, 8.665666666666665, 7.650666666666666, 9.099333333333332, 8.868333333333334, 9.573333333333334, 10.730666666666668, 7.898666666666665, 7.972666666666666, 10.447999999999997, 10.285666666666664, 8.658666666666665, 11.290666666666665, 7.653666666666666, 8.662333333333331, 11.235, 9.365, 8.979999999999999, 9.169333333333332, 7.476666666666665, 6.7056666666666676, 7.408666666666665, 7.056333333333332, 7.434333333333332, 6.921333333333333, 6.798666666666667, 8.696666666666664, 8.001, 11.008333333333335, 6.998999999999999, 7.609000000000001, 7.025333333333333, 7.409333333333333, 10.210333333333331, 8.294666666666664, 11.335999999999999, 7.551666666666665, 8.138666666666666, 7.708666666666665, 9.459666666666665, 10.13933333333333, 8.554333333333334, 7.667666666666667, 8.017333333333333, 10.605666666666666, 6.836666666666666, 9.41033333333333, 7.705, 9.469666666666663, 8.996666666666668, 11.973999999999997, 8.327333333333332, 10.807666666666664, 7.556666666666667, 6.684333333333332, 11.221000000000002, 10.72533333333333, 7.682999999999999, 8.357333333333333, 8.973333333333333, 7.525333333333332, 7.662666666666665, 6.450999999999999, 8.431, 10.901999999999996, 7.602666666666666, 8.675666666666665, 10.160666666666664, 7.207333333333333, 8.652, 7.479333333333332, 9.285666666666668, 8.304, 9.133999999999999, 10.435999999999996, 7.734, 8.291999999999998, 9.362333333333332, 7.88, 10.027999999999999, 8.343666666666666, 7.684666666666665, 9.123666666666661, 7.833666666666665], "episode_lengths": [15, 25, 16, 27, 19, 23, 22, 17, 17, 25, 20, 19, 22, 19, 17, 15, 24, 21, 17, 20, 17, 20, 22, 17, 17, 21, 21, 20, 23, 17, 20, 23, 21, 20, 18, 17, 15, 16, 16, 16, 15, 14, 18, 16, 22, 17, 18, 16, 16, 23, 20, 22, 17, 17, 15, 20, 20, 19, 16, 19, 24, 14, 21, 15, 19, 17, 24, 16, 21, 16, 15, 23, 22, 15, 20, 20, 18, 17, 14, 19, 22, 16, 20, 21, 15, 19, 15, 20, 15, 19, 23, 17, 17, 18, 19, 22, 21, 17, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.586828225559866, "mean_inference_ms": 2.8855563828469464, "mean_action_processing_ms": 0.6018547573060546, "mean_env_wait_ms": 0.14420599693771785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02140212059020996, "StateBufferConnector_ms": 0.016565799713134766, "ViewRequirementAgentConnector_ms": 0.37609267234802246}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109200, "num_agent_steps_trained": 109200, "num_env_steps_sampled": 109200, "num_env_steps_trained": 109200, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1616.5076869120157, "num_env_steps_trained_throughput_per_sec": 1616.5076869120157, "timesteps_total": 109200, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 109200, "timers": {"training_iteration_time_ms": 904.78, "sample_time_ms": 870.078, "load_time_ms": 0.261, "load_throughput": 5355732.944, "learn_time_ms": 13.595, "learn_throughput": 102978.789, "synch_weights_time_ms": 20.553}, "counters": {"num_env_steps_sampled": 109200, "num_env_steps_trained": 109200, "num_agent_steps_sampled": 109200, "num_agent_steps_trained": 109200}, "done": false, "episodes_total": 5846, "training_iteration": 78, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-30", "timestamp": 1702021230, "time_this_iter_s": 0.8820590972900391, "time_total_s": 91.16752600669861, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 91.16752600669861, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 98.6, "ram_util_percent": 95.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0940262079238892, "total_loss": 1.0940262079238892, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 110600, "num_env_steps_trained": 110600, "num_agent_steps_sampled": 110600, "num_agent_steps_trained": 110600}, "sampler_results": {"episode_reward_max": 12.492000000000003, "episode_reward_min": 5.502666666666667, "episode_reward_mean": 8.900273333333333, "episode_len_mean": 19.06, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.72533333333333, 7.682999999999999, 8.357333333333333, 8.973333333333333, 7.525333333333332, 7.662666666666665, 6.450999999999999, 8.431, 10.901999999999996, 7.602666666666666, 8.675666666666665, 10.160666666666664, 7.207333333333333, 8.652, 7.479333333333332, 9.285666666666668, 8.304, 9.133999999999999, 10.435999999999996, 7.734, 8.291999999999998, 9.362333333333332, 7.88, 10.027999999999999, 8.343666666666666, 7.684666666666665, 9.123666666666661, 7.833666666666665, 11.721999999999998, 9.911999999999999, 7.724333333333332, 9.744666666666664, 10.818666666666662, 8.232666666666667, 9.92, 7.340666666666666, 6.796999999999999, 7.856999999999999, 6.892666666666666, 6.898666666666665, 10.018666666666666, 9.087, 7.446666666666666, 10.846999999999998, 10.330666666666664, 9.149, 7.388333333333332, 11.444333333333333, 10.151333333333332, 8.470666666666666, 6.2236666666666665, 6.102666666666666, 11.795999999999998, 7.563333333333332, 6.64, 10.314666666666668, 8.304999999999998, 12.147999999999998, 8.962333333333333, 8.067666666666668, 8.771333333333333, 9.141000000000002, 9.784, 6.724333333333332, 7.649333333333334, 7.905333333333331, 7.325333333333332, 11.081999999999999, 12.492000000000003, 7.775333333333332, 9.227333333333332, 7.946333333333331, 7.934, 7.819, 10.805333333333335, 8.636999999999999, 11.256666666666666, 9.530666666666665, 7.113333333333334, 5.502666666666667, 10.31133333333333, 7.903666666666664, 12.079666666666665, 7.566333333333334, 7.183999999999999, 9.543666666666665, 11.991333333333332, 10.048666666666666, 7.694333333333332, 9.388333333333334, 11.298, 11.584333333333335, 10.054666666666664, 12.20433333333333, 8.538666666666668, 9.564, 8.342333333333332, 7.718666666666665, 10.06066666666667, 8.280333333333333], "episode_lengths": [22, 15, 20, 20, 18, 17, 14, 19, 22, 16, 20, 21, 15, 19, 15, 20, 15, 19, 23, 17, 17, 18, 19, 22, 21, 17, 21, 17, 23, 20, 18, 24, 21, 16, 24, 16, 16, 17, 14, 14, 20, 18, 16, 22, 20, 22, 17, 24, 22, 16, 13, 13, 23, 16, 14, 20, 17, 23, 17, 17, 19, 23, 21, 16, 18, 18, 18, 22, 32, 17, 21, 17, 17, 16, 23, 18, 25, 19, 16, 13, 20, 17, 26, 17, 17, 18, 23, 19, 16, 20, 26, 22, 20, 28, 18, 21, 17, 16, 23, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5824966771212934, "mean_inference_ms": 2.874957483608774, "mean_action_processing_ms": 0.5999440260008844, "mean_env_wait_ms": 0.1443399265053305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017213106155395508, "StateBufferConnector_ms": 0.017483234405517578, "ViewRequirementAgentConnector_ms": 0.40743160247802734}}, "episode_reward_max": 12.492000000000003, "episode_reward_min": 5.502666666666667, "episode_reward_mean": 8.900273333333333, "episode_len_mean": 19.06, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.72533333333333, 7.682999999999999, 8.357333333333333, 8.973333333333333, 7.525333333333332, 7.662666666666665, 6.450999999999999, 8.431, 10.901999999999996, 7.602666666666666, 8.675666666666665, 10.160666666666664, 7.207333333333333, 8.652, 7.479333333333332, 9.285666666666668, 8.304, 9.133999999999999, 10.435999999999996, 7.734, 8.291999999999998, 9.362333333333332, 7.88, 10.027999999999999, 8.343666666666666, 7.684666666666665, 9.123666666666661, 7.833666666666665, 11.721999999999998, 9.911999999999999, 7.724333333333332, 9.744666666666664, 10.818666666666662, 8.232666666666667, 9.92, 7.340666666666666, 6.796999999999999, 7.856999999999999, 6.892666666666666, 6.898666666666665, 10.018666666666666, 9.087, 7.446666666666666, 10.846999999999998, 10.330666666666664, 9.149, 7.388333333333332, 11.444333333333333, 10.151333333333332, 8.470666666666666, 6.2236666666666665, 6.102666666666666, 11.795999999999998, 7.563333333333332, 6.64, 10.314666666666668, 8.304999999999998, 12.147999999999998, 8.962333333333333, 8.067666666666668, 8.771333333333333, 9.141000000000002, 9.784, 6.724333333333332, 7.649333333333334, 7.905333333333331, 7.325333333333332, 11.081999999999999, 12.492000000000003, 7.775333333333332, 9.227333333333332, 7.946333333333331, 7.934, 7.819, 10.805333333333335, 8.636999999999999, 11.256666666666666, 9.530666666666665, 7.113333333333334, 5.502666666666667, 10.31133333333333, 7.903666666666664, 12.079666666666665, 7.566333333333334, 7.183999999999999, 9.543666666666665, 11.991333333333332, 10.048666666666666, 7.694333333333332, 9.388333333333334, 11.298, 11.584333333333335, 10.054666666666664, 12.20433333333333, 8.538666666666668, 9.564, 8.342333333333332, 7.718666666666665, 10.06066666666667, 8.280333333333333], "episode_lengths": [22, 15, 20, 20, 18, 17, 14, 19, 22, 16, 20, 21, 15, 19, 15, 20, 15, 19, 23, 17, 17, 18, 19, 22, 21, 17, 21, 17, 23, 20, 18, 24, 21, 16, 24, 16, 16, 17, 14, 14, 20, 18, 16, 22, 20, 22, 17, 24, 22, 16, 13, 13, 23, 16, 14, 20, 17, 23, 17, 17, 19, 23, 21, 16, 18, 18, 18, 22, 32, 17, 21, 17, 17, 16, 23, 18, 25, 19, 16, 13, 20, 17, 26, 17, 17, 18, 23, 19, 16, 20, 26, 22, 20, 28, 18, 21, 17, 16, 23, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5824966771212934, "mean_inference_ms": 2.874957483608774, "mean_action_processing_ms": 0.5999440260008844, "mean_env_wait_ms": 0.1443399265053305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017213106155395508, "StateBufferConnector_ms": 0.017483234405517578, "ViewRequirementAgentConnector_ms": 0.40743160247802734}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110600, "num_agent_steps_trained": 110600, "num_env_steps_sampled": 110600, "num_env_steps_trained": 110600, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1634.561698867837, "num_env_steps_trained_throughput_per_sec": 1634.561698867837, "timesteps_total": 110600, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 110600, "timers": {"training_iteration_time_ms": 898.518, "sample_time_ms": 863.873, "load_time_ms": 0.161, "load_throughput": 8680008.278, "learn_time_ms": 13.547, "learn_throughput": 103344.525, "synch_weights_time_ms": 20.604}, "counters": {"num_env_steps_sampled": 110600, "num_env_steps_trained": 110600, "num_agent_steps_sampled": 110600, "num_agent_steps_trained": 110600}, "done": false, "episodes_total": 5918, "training_iteration": 79, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-31", "timestamp": 1702021231, "time_this_iter_s": 0.87237548828125, "time_total_s": 92.03990149497986, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.03990149497986, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 93.4, "ram_util_percent": 95.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"policy_loss": 1.0925155878067017, "total_loss": 1.0925155878067017, "model": {}}, "custom_metrics": {}, "num_agent_steps_trained": 1400.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 13.054333333333332, "episode_reward_min": 5.502666666666667, "episode_reward_mean": 8.938409999999998, "episode_len_mean": 18.92, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.256666666666666, 9.530666666666665, 7.113333333333334, 5.502666666666667, 10.31133333333333, 7.903666666666664, 12.079666666666665, 7.566333333333334, 7.183999999999999, 9.543666666666665, 11.991333333333332, 10.048666666666666, 7.694333333333332, 9.388333333333334, 11.298, 11.584333333333335, 10.054666666666664, 12.20433333333333, 8.538666666666668, 9.564, 8.342333333333332, 7.718666666666665, 10.06066666666667, 8.280333333333333, 8.181999999999999, 13.054333333333332, 10.999333333333334, 8.128999999999998, 10.85333333333333, 8.357333333333333, 10.376999999999997, 8.159333333333333, 9.501999999999997, 10.059666666666663, 9.045666666666664, 9.768333333333334, 10.316, 8.985999999999999, 9.241333333333332, 9.043, 6.095333333333334, 8.984333333333334, 7.614, 11.20133333333333, 9.754333333333332, 8.096999999999998, 11.633999999999995, 9.806000000000001, 9.972666666666665, 11.910333333333336, 9.981999999999996, 7.043, 10.464666666666666, 11.933666666666664, 8.176666666666666, 8.876666666666665, 6.322, 8.658, 9.963666666666667, 7.6083333333333325, 7.779666666666666, 7.293666666666666, 8.952666666666664, 7.778666666666665, 8.104, 10.602333333333332, 8.295999999999998, 8.360333333333333, 5.992000000000001, 10.806333333333335, 8.031333333333333, 7.947666666666667, 8.401333333333332, 9.117333333333331, 6.8359999999999985, 8.876999999999999, 6.150666666666667, 10.054666666666666, 6.455, 7.772999999999997, 9.937, 6.423333333333332, 8.814999999999998, 12.111333333333334, 7.129666666666665, 7.108666666666667, 11.115999999999998, 10.722666666666665, 7.121666666666666, 9.331333333333331, 6.771333333333333, 6.856, 9.726333333333333, 6.857999999999998, 7.554, 8.167333333333332, 9.367666666666665, 6.7509999999999994, 8.453999999999999, 6.976666666666666], "episode_lengths": [25, 19, 16, 13, 20, 17, 26, 17, 17, 18, 23, 19, 16, 20, 26, 22, 20, 28, 18, 21, 17, 16, 23, 21, 18, 26, 23, 16, 21, 20, 22, 17, 21, 21, 19, 20, 19, 18, 20, 19, 13, 19, 16, 23, 19, 18, 22, 23, 18, 23, 22, 16, 21, 23, 19, 17, 14, 17, 23, 16, 15, 15, 18, 19, 17, 22, 18, 18, 13, 24, 18, 17, 18, 19, 15, 17, 15, 20, 15, 16, 21, 14, 19, 24, 17, 16, 23, 21, 15, 21, 18, 15, 21, 15, 17, 16, 19, 16, 17, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5778470119350636, "mean_inference_ms": 2.868007288355619, "mean_action_processing_ms": 0.5989901893803683, "mean_env_wait_ms": 0.143348470690165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02736639976501465, "StateBufferConnector_ms": 0.01308584213256836, "ViewRequirementAgentConnector_ms": 0.40359044075012207}}, "episode_reward_max": 13.054333333333332, "episode_reward_min": 5.502666666666667, "episode_reward_mean": 8.938409999999998, "episode_len_mean": 18.92, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.256666666666666, 9.530666666666665, 7.113333333333334, 5.502666666666667, 10.31133333333333, 7.903666666666664, 12.079666666666665, 7.566333333333334, 7.183999999999999, 9.543666666666665, 11.991333333333332, 10.048666666666666, 7.694333333333332, 9.388333333333334, 11.298, 11.584333333333335, 10.054666666666664, 12.20433333333333, 8.538666666666668, 9.564, 8.342333333333332, 7.718666666666665, 10.06066666666667, 8.280333333333333, 8.181999999999999, 13.054333333333332, 10.999333333333334, 8.128999999999998, 10.85333333333333, 8.357333333333333, 10.376999999999997, 8.159333333333333, 9.501999999999997, 10.059666666666663, 9.045666666666664, 9.768333333333334, 10.316, 8.985999999999999, 9.241333333333332, 9.043, 6.095333333333334, 8.984333333333334, 7.614, 11.20133333333333, 9.754333333333332, 8.096999999999998, 11.633999999999995, 9.806000000000001, 9.972666666666665, 11.910333333333336, 9.981999999999996, 7.043, 10.464666666666666, 11.933666666666664, 8.176666666666666, 8.876666666666665, 6.322, 8.658, 9.963666666666667, 7.6083333333333325, 7.779666666666666, 7.293666666666666, 8.952666666666664, 7.778666666666665, 8.104, 10.602333333333332, 8.295999999999998, 8.360333333333333, 5.992000000000001, 10.806333333333335, 8.031333333333333, 7.947666666666667, 8.401333333333332, 9.117333333333331, 6.8359999999999985, 8.876999999999999, 6.150666666666667, 10.054666666666666, 6.455, 7.772999999999997, 9.937, 6.423333333333332, 8.814999999999998, 12.111333333333334, 7.129666666666665, 7.108666666666667, 11.115999999999998, 10.722666666666665, 7.121666666666666, 9.331333333333331, 6.771333333333333, 6.856, 9.726333333333333, 6.857999999999998, 7.554, 8.167333333333332, 9.367666666666665, 6.7509999999999994, 8.453999999999999, 6.976666666666666], "episode_lengths": [25, 19, 16, 13, 20, 17, 26, 17, 17, 18, 23, 19, 16, 20, 26, 22, 20, 28, 18, 21, 17, 16, 23, 21, 18, 26, 23, 16, 21, 20, 22, 17, 21, 21, 19, 20, 19, 18, 20, 19, 13, 19, 16, 23, 19, 18, 22, 23, 18, 23, 22, 16, 21, 23, 19, 17, 14, 17, 23, 16, 15, 15, 18, 19, 17, 22, 18, 18, 13, 24, 18, 17, 18, 19, 15, 17, 15, 20, 15, 16, 21, 14, 19, 24, 17, 16, 23, 21, 15, 21, 18, 15, 21, 15, 17, 16, 19, 16, 17, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5778470119350636, "mean_inference_ms": 2.868007288355619, "mean_action_processing_ms": 0.5989901893803683, "mean_env_wait_ms": 0.143348470690165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02736639976501465, "StateBufferConnector_ms": 0.01308584213256836, "ViewRequirementAgentConnector_ms": 0.40359044075012207}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 1400, "num_env_steps_trained_this_iter": 1400, "num_env_steps_sampled_throughput_per_sec": 1562.6448606984823, "num_env_steps_trained_throughput_per_sec": 1562.6448606984823, "timesteps_total": 112000, "num_steps_trained_this_iter": 1400, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 898.922, "sample_time_ms": 864.577, "load_time_ms": 0.192, "load_throughput": 7295347.994, "learn_time_ms": 13.416, "learn_throughput": 104349.455, "synch_weights_time_ms": 20.504}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": true, "episodes_total": 5994, "training_iteration": 80, "trial_id": "b37b2_00000", "date": "2023-12-07_23-40-32", "timestamp": 1702021232, "time_this_iter_s": 0.9099183082580566, "time_total_s": 92.94981980323792, "pid": 7708, "hostname": "059Latitude3410", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "AgricultureEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000290C8742170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "beta": 0.0, "bc_logstd_coeff": 0.0, "moving_average_sqd_adv_norm_update_rate": 1e-08, "moving_average_sqd_adv_norm_start": 100.0, "vf_coeff": 1.0, "_set_off_policy_estimation_methods": false, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.94981980323792, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 92.0, "ram_util_percent": 96.0}}
